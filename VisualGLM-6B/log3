NCCL_DEBUG=info NCCL_IB_DISABLE=0 NCCL_NET_GDR_LEVEL=2 deepspeed --master_port 16666 --hostfile hostfile_single finetune_visualglm.py --experiment-name finetune-visualglm-6b --model-parallel-size 1 --mode finetune --train-iters 10000 --resume-dataloader --max_source_length 64 --max_target_length 256 --lora_rank 20 --layer_range 0 4 8 14 --pre_seq_len 4 --train-data ./finetune-data/train/dataset.json --valid-data ./finetune-data/test/dataset.json --distributed-backend nccl --lr-decay-style cosine --warmup .02 --checkpoint-activations --save-interval 300 --eval-interval 1000 --save ./checkpoints --split 1 --eval-iters 10 --eval-batch-size 8 --zero-stage 1 --lr 0.0001 --batch-size 4 --skip-init --fp16 --use_lora
[2024-06-18 15:00:43,097] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-18 15:00:45,577] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0: setting --include=localhost:0
[2024-06-18 15:00:45,578] [INFO] [runner.py:568:main] cmd = /DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/bin/python3.12 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=16666 --enable_each_rank_log=None finetune_visualglm.py --experiment-name finetune-visualglm-6b --model-parallel-size 1 --mode finetune --train-iters 10000 --resume-dataloader --max_source_length 64 --max_target_length 256 --lora_rank 20 --layer_range 0 4 8 14 --pre_seq_len 4 --train-data ./finetune-data/train/dataset.json --valid-data ./finetune-data/test/dataset.json --distributed-backend nccl --lr-decay-style cosine --warmup .02 --checkpoint-activations --save-interval 300 --eval-interval 1000 --save ./checkpoints --split 1 --eval-iters 10 --eval-batch-size 8 --zero-stage 1 --lr 0.0001 --batch-size 4 --skip-init --fp16 --use_lora
[2024-06-18 15:00:48,882] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-18 15:00:51,189] [INFO] [launch.py:139:main] 0 NCCL_IB_DISABLE=0
[2024-06-18 15:00:51,189] [INFO] [launch.py:139:main] 0 NCCL_DEBUG=info
[2024-06-18 15:00:51,189] [INFO] [launch.py:139:main] 0 NCCL_NET_GDR_LEVEL=2
[2024-06-18 15:00:51,189] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2024-06-18 15:00:51,191] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2024-06-18 15:00:51,192] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2024-06-18 15:00:51,193] [INFO] [launch.py:164:main] dist_world_size=1
[2024-06-18 15:00:51,193] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2024-06-18 15:00:51,195] [INFO] [launch.py:256:main] process 1062089 spawned with command: ['/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/bin/python3.12', '-u', 'finetune_visualglm.py', '--local_rank=0', '--experiment-name', 'finetune-visualglm-6b', '--model-parallel-size', '1', '--mode', 'finetune', '--train-iters', '10000', '--resume-dataloader', '--max_source_length', '64', '--max_target_length', '256', '--lora_rank', '20', '--layer_range', '0', '4', '8', '14', '--pre_seq_len', '4', '--train-data', './finetune-data/train/dataset.json', '--valid-data', './finetune-data/test/dataset.json', '--distributed-backend', 'nccl', '--lr-decay-style', 'cosine', '--warmup', '.02', '--checkpoint-activations', '--save-interval', '300', '--eval-interval', '1000', '--save', './checkpoints', '--split', '1', '--eval-iters', '10', '--eval-batch-size', '8', '--zero-stage', '1', '--lr', '0.0001', '--batch-size', '4', '--skip-init', '--fp16', '--use_lora']
[2024-06-18 15:00:54,682] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-18 15:00:59,631] [INFO] using world size: 1 and model-parallel size: 1 
[2024-06-18 15:00:59,631] [INFO] > padded vocab (size: 100) with 28 dummy tokens (new size: 128)
[2024-06-18 15:00:59,636] [INFO] [RANK 0] > initializing model parallel with size 1
[2024-06-18 15:00:59,638] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-06-18 15:00:59,639] [WARNING] [config_utils.py:69:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
[2024-06-18 15:00:59,640] [INFO] [checkpointing.py:1048:_configure_using_config_file] {'partition_activations': False, 'contiguous_memory_optimization': False, 'cpu_checkpointing': False, 'number_checkpoints': None, 'synchronize_checkpoint_boundary': False, 'profile': False}
[2024-06-18 15:00:59,647] [INFO] [checkpointing.py:229:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
[2024-06-18 15:00:59,654] [INFO] [RANK 0] building FineTuneVisualGLMModel model ...
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
replacing layer 0 attention with lora
replacing layer 4 attention with lora
replacing layer 8 attention with lora
replacing layer 14 attention with lora
[2024-06-18 15:01:11,639] [INFO] [RANK 0]  > number of parameters on model parallel rank 0: 7804814848
[2024-06-18 15:01:15,201] [INFO] [RANK 0] global rank 0 is loading checkpoint /DATA_EDS2/AIGC/2311/dingkr2311/.sat_models/visualglm-6b/1/mp_rank_00_model_states.pt
[2024-06-18 15:02:37,897] [INFO] [RANK 0] Will continue but found unexpected_keys! Check whether you are loading correct checkpoints: ['transformer.position_embeddings.weight'].
[2024-06-18 15:02:37,898] [INFO] [RANK 0] > successfully loaded /DATA_EDS2/AIGC/2311/dingkr2311/.sat_models/visualglm-6b/1/mp_rank_00_model_states.pt
[2024-06-18 15:02:45,534] [INFO] [RANK 0] Try to load tokenizer from Huggingface transformers...
[2024-06-18 15:02:47,433] [INFO] [RANK 0] > Set tokenizer as a THUDM/chatglm-6b tokenizer! Now you can get_tokenizer() everywhere.
discover-01:1062089:1062089 [0] NCCL INFO Bootstrap : Using enp196s0f0:10.0.0.14<0>
discover-01:1062089:1062089 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
discover-01:1062089:1062089 [0] NCCL INFO cudaDriverVersion 12030
NCCL version 2.20.5+cuda12.4
discover-01:1062089:1063309 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
discover-01:1062089:1063309 [0] NCCL INFO NET/IB : No device found.
discover-01:1062089:1063309 [0] NCCL INFO NET/Socket : Using [0]enp196s0f0:10.0.0.14<0> [1]tun0:198.18.1.50<0>
discover-01:1062089:1063309 [0] NCCL INFO Using non-device net plugin version 0
discover-01:1062089:1063309 [0] NCCL INFO Using network Socket
discover-01:1062089:1063309 [0] NCCL INFO comm 0x55a193dcd700 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x58236ac311dda381 - Init START
discover-01:1062089:1063309 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:1062089:1063309 [0] NCCL INFO comm 0x55a193dcd700 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:1062089:1063309 [0] NCCL INFO Channel 00/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 01/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 02/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 03/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 04/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 05/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 06/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 07/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 08/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 09/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 10/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 11/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 12/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 13/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 14/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 15/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 16/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 17/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 18/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 19/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 20/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 21/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 22/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 23/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 24/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 25/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 26/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 27/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 28/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 29/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 30/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Channel 31/32 :    0
discover-01:1062089:1063309 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:1062089:1063309 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:1062089:1063309 [0] NCCL INFO Connected all rings
discover-01:1062089:1063309 [0] NCCL INFO Connected all trees
discover-01:1062089:1063309 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:1062089:1063309 [0] NCCL INFO comm 0x55a193dcd700 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x58236ac311dda381 - Init COMPLETE
transformer.layers.0.attention.query_key_value.matrix_A.0
transformer.layers.0.attention.query_key_value.matrix_A.1
transformer.layers.0.attention.query_key_value.matrix_A.2
transformer.layers.0.attention.query_key_value.matrix_B.0
transformer.layers.0.attention.query_key_value.matrix_B.1
transformer.layers.0.attention.query_key_value.matrix_B.2
transformer.layers.0.attention.dense.matrix_A.0
transformer.layers.0.attention.dense.matrix_B.0
transformer.layers.4.attention.query_key_value.matrix_A.0
transformer.layers.4.attention.query_key_value.matrix_A.1
transformer.layers.4.attention.query_key_value.matrix_A.2
transformer.layers.4.attention.query_key_value.matrix_B.0
transformer.layers.4.attention.query_key_value.matrix_B.1
transformer.layers.4.attention.query_key_value.matrix_B.2
transformer.layers.4.attention.dense.matrix_A.0
transformer.layers.4.attention.dense.matrix_B.0
transformer.layers.8.attention.query_key_value.matrix_A.0
transformer.layers.8.attention.query_key_value.matrix_A.1
transformer.layers.8.attention.query_key_value.matrix_A.2
transformer.layers.8.attention.query_key_value.matrix_B.0
transformer.layers.8.attention.query_key_value.matrix_B.1
transformer.layers.8.attention.query_key_value.matrix_B.2
transformer.layers.8.attention.dense.matrix_A.0
transformer.layers.8.attention.dense.matrix_B.0
transformer.layers.14.attention.query_key_value.matrix_A.0
transformer.layers.14.attention.query_key_value.matrix_A.1
transformer.layers.14.attention.query_key_value.matrix_A.2
transformer.layers.14.attention.query_key_value.matrix_B.0
transformer.layers.14.attention.query_key_value.matrix_B.1
transformer.layers.14.attention.query_key_value.matrix_B.2
transformer.layers.14.attention.dense.matrix_A.0
transformer.layers.14.attention.dense.matrix_B.0
[2024-06-18 15:05:48,905] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.3, git-hash=unknown, git-branch=unknown
[2024-06-18 15:05:48,905] [WARNING] [config_utils.py:69:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
discover-01:1062089:1063315 [0] NCCL INFO Using non-device net plugin version 0
discover-01:1062089:1063315 [0] NCCL INFO Using network Socket
discover-01:1062089:1063315 [0] NCCL INFO bootstrapSplit: comm 0x55a1e9fe8540 parent 0x55a193dcd700 rank 0 nranks 1 color -1091263299 key 0 prev 0 next 0 - DONE
discover-01:1062089:1063315 [0] NCCL INFO comm 0x55a1e9fe8540 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xba25971b23b69f0f - Init START
discover-01:1062089:1063315 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:1062089:1063315 [0] NCCL INFO comm 0x55a1e9fe8540 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:1062089:1063315 [0] NCCL INFO Channel 00/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 01/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 02/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 03/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 04/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 05/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 06/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 07/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 08/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 09/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 10/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 11/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 12/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 13/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 14/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 15/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 16/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 17/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 18/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 19/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 20/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 21/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 22/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 23/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 24/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 25/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 26/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 27/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 28/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 29/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 30/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Channel 31/32 :    0
discover-01:1062089:1063315 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:1062089:1063315 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:1062089:1063315 [0] NCCL INFO Connected all rings
discover-01:1062089:1063315 [0] NCCL INFO Connected all trees
discover-01:1062089:1063315 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:1062089:1063315 [0] NCCL INFO comm 0x55a1e9fe8540 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xba25971b23b69f0f - Init COMPLETE
[2024-06-18 15:05:49,032] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /DATA_EDS2/AIGC/2311/dingkr2311/.cache/torch_extensions/py312_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /DATA_EDS2/AIGC/2311/dingkr2311/.cache/torch_extensions/py312_cu121/fused_adam/build.ninja...
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.6553797721862793 seconds
[2024-06-18 15:05:49,694] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-06-18 15:05:49,694] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-06-18 15:05:49,699] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-06-18 15:05:49,699] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-06-18 15:05:49,700] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 1 optimizer
[2024-06-18 15:05:49,700] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 40000000
[2024-06-18 15:05:49,701] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 100000000
[2024-06-18 15:05:49,701] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-06-18 15:05:49,701] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-06-18 15:05:50,292] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2024-06-18 15:05:50,293] [INFO] [utils.py:782:see_memory_usage] MA 14.57 GB         Max_MA 14.57 GB         CA 14.69 GB         Max_CA 15 GB 
[2024-06-18 15:05:50,293] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 28.99 GB, percent = 2.9%
[2024-06-18 15:05:50,432] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2024-06-18 15:05:50,433] [INFO] [utils.py:782:see_memory_usage] MA 14.57 GB         Max_MA 14.58 GB         CA 14.7 GB         Max_CA 15 GB 
[2024-06-18 15:05:50,433] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 28.99 GB, percent = 2.9%
[2024-06-18 15:05:50,434] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-06-18 15:05:50,565] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2024-06-18 15:05:50,566] [INFO] [utils.py:782:see_memory_usage] MA 14.57 GB         Max_MA 14.57 GB         CA 14.7 GB         Max_CA 15 GB 
[2024-06-18 15:05:50,566] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 28.99 GB, percent = 2.9%
[2024-06-18 15:05:50,568] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2024-06-18 15:05:50,569] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-06-18 15:05:50,569] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-06-18 15:05:50,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0001], mom=[[0.9, 0.95]]
[2024-06-18 15:05:50,572] [INFO] [config.py:1000:print] DeepSpeedEngine configuration:
[2024-06-18 15:05:50,572] [INFO] [config.py:1004:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-06-18 15:05:50,572] [INFO] [config.py:1004:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-06-18 15:05:50,573] [INFO] [config.py:1004:print]   amp_enabled .................. False
[2024-06-18 15:05:50,573] [INFO] [config.py:1004:print]   amp_params ................... False
[2024-06-18 15:05:50,574] [INFO] [config.py:1004:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-06-18 15:05:50,574] [INFO] [config.py:1004:print]   bfloat16_enabled ............. False
[2024-06-18 15:05:50,575] [INFO] [config.py:1004:print]   bfloat16_immediate_grad_update  False
[2024-06-18 15:05:50,575] [INFO] [config.py:1004:print]   checkpoint_parallel_write_pipeline  False
[2024-06-18 15:05:50,575] [INFO] [config.py:1004:print]   checkpoint_tag_validation_enabled  True
[2024-06-18 15:05:50,575] [INFO] [config.py:1004:print]   checkpoint_tag_validation_fail  False
[2024-06-18 15:05:50,576] [INFO] [config.py:1004:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f6ec8c23710>
[2024-06-18 15:05:50,577] [INFO] [config.py:1004:print]   communication_data_type ...... None
[2024-06-18 15:05:50,577] [INFO] [config.py:1004:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-06-18 15:05:50,578] [INFO] [config.py:1004:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-06-18 15:05:50,579] [INFO] [config.py:1004:print]   curriculum_enabled_legacy .... False
[2024-06-18 15:05:50,579] [INFO] [config.py:1004:print]   curriculum_params_legacy ..... False
[2024-06-18 15:05:50,579] [INFO] [config.py:1004:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-06-18 15:05:50,580] [INFO] [config.py:1004:print]   data_efficiency_enabled ...... False
[2024-06-18 15:05:50,580] [INFO] [config.py:1004:print]   dataloader_drop_last ......... False
[2024-06-18 15:05:50,580] [INFO] [config.py:1004:print]   disable_allgather ............ False
[2024-06-18 15:05:50,581] [INFO] [config.py:1004:print]   dump_state ................... False
[2024-06-18 15:05:50,581] [INFO] [config.py:1004:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 400, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2024-06-18 15:05:50,581] [INFO] [config.py:1004:print]   eigenvalue_enabled ........... False
[2024-06-18 15:05:50,581] [INFO] [config.py:1004:print]   eigenvalue_gas_boundary_resolution  1
[2024-06-18 15:05:50,582] [INFO] [config.py:1004:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-06-18 15:05:50,582] [INFO] [config.py:1004:print]   eigenvalue_layer_num ......... 0
[2024-06-18 15:05:50,582] [INFO] [config.py:1004:print]   eigenvalue_max_iter .......... 100
[2024-06-18 15:05:50,583] [INFO] [config.py:1004:print]   eigenvalue_stability ......... 1e-06
[2024-06-18 15:05:50,583] [INFO] [config.py:1004:print]   eigenvalue_tol ............... 0.01
[2024-06-18 15:05:50,584] [INFO] [config.py:1004:print]   eigenvalue_verbose ........... False
[2024-06-18 15:05:50,584] [INFO] [config.py:1004:print]   elasticity_enabled ........... False
[2024-06-18 15:05:50,584] [INFO] [config.py:1004:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-06-18 15:05:50,585] [INFO] [config.py:1004:print]   fp16_auto_cast ............... False
[2024-06-18 15:05:50,585] [INFO] [config.py:1004:print]   fp16_enabled ................. True
[2024-06-18 15:05:50,586] [INFO] [config.py:1004:print]   fp16_master_weights_and_gradients  False
[2024-06-18 15:05:50,586] [INFO] [config.py:1004:print]   global_rank .................. 0
[2024-06-18 15:05:50,587] [INFO] [config.py:1004:print]   grad_accum_dtype ............. None
[2024-06-18 15:05:50,587] [INFO] [config.py:1004:print]   gradient_accumulation_steps .. 1
[2024-06-18 15:05:50,588] [INFO] [config.py:1004:print]   gradient_clipping ............ 0.1
[2024-06-18 15:05:50,588] [INFO] [config.py:1004:print]   gradient_predivide_factor .... 1.0
[2024-06-18 15:05:50,589] [INFO] [config.py:1004:print]   graph_harvesting ............. False
[2024-06-18 15:05:50,589] [INFO] [config.py:1004:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-06-18 15:05:50,591] [INFO] [config.py:1004:print]   initial_dynamic_scale ........ 65536
[2024-06-18 15:05:50,591] [INFO] [config.py:1004:print]   load_universal_checkpoint .... False
[2024-06-18 15:05:50,591] [INFO] [config.py:1004:print]   loss_scale ................... 0
[2024-06-18 15:05:50,591] [INFO] [config.py:1004:print]   memory_breakdown ............. False
[2024-06-18 15:05:50,592] [INFO] [config.py:1004:print]   mics_hierarchial_params_gather  False
[2024-06-18 15:05:50,592] [INFO] [config.py:1004:print]   mics_shard_size .............. -1
[2024-06-18 15:05:50,593] [INFO] [config.py:1004:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-06-18 15:05:50,593] [INFO] [config.py:1004:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-06-18 15:05:50,594] [INFO] [config.py:1004:print]   optimizer_legacy_fusion ...... False
[2024-06-18 15:05:50,594] [INFO] [config.py:1004:print]   optimizer_name ............... adam
[2024-06-18 15:05:50,594] [INFO] [config.py:1004:print]   optimizer_params ............. {'lr': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'weight_decay': 0.01}
[2024-06-18 15:05:50,594] [INFO] [config.py:1004:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-06-18 15:05:50,595] [INFO] [config.py:1004:print]   pld_enabled .................. False
[2024-06-18 15:05:50,595] [INFO] [config.py:1004:print]   pld_params ................... False
[2024-06-18 15:05:50,595] [INFO] [config.py:1004:print]   prescale_gradients ........... False
[2024-06-18 15:05:50,595] [INFO] [config.py:1004:print]   scheduler_name ............... None
[2024-06-18 15:05:50,596] [INFO] [config.py:1004:print]   scheduler_params ............. None
[2024-06-18 15:05:50,596] [INFO] [config.py:1004:print]   seq_parallel_communication_data_type  torch.float32
[2024-06-18 15:05:50,596] [INFO] [config.py:1004:print]   sparse_attention ............. None
[2024-06-18 15:05:50,596] [INFO] [config.py:1004:print]   sparse_gradients_enabled ..... False
[2024-06-18 15:05:50,597] [INFO] [config.py:1004:print]   steps_per_print .............. 10
[2024-06-18 15:05:50,597] [INFO] [config.py:1004:print]   timers_config ................ enabled=True synchronized=True
[2024-06-18 15:05:50,598] [INFO] [config.py:1004:print]   train_batch_size ............. 4
[2024-06-18 15:05:50,598] [INFO] [config.py:1004:print]   train_micro_batch_size_per_gpu  4
[2024-06-18 15:05:50,598] [INFO] [config.py:1004:print]   use_data_before_expert_parallel_  False
[2024-06-18 15:05:50,599] [INFO] [config.py:1004:print]   use_node_local_storage ....... False
[2024-06-18 15:05:50,599] [INFO] [config.py:1004:print]   wall_clock_breakdown ......... False
[2024-06-18 15:05:50,599] [INFO] [config.py:1004:print]   weight_quantization_config ... None
[2024-06-18 15:05:50,600] [INFO] [config.py:1004:print]   world_size ................... 1
[2024-06-18 15:05:50,600] [INFO] [config.py:1004:print]   zero_allow_untested_optimizer  True
[2024-06-18 15:05:50,600] [INFO] [config.py:1004:print]   zero_config .................. stage=1 contiguous_gradients=False reduce_scatter=True reduce_bucket_size=40000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=100000000 overlap_comm=True load_from_fp32_weights=False elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-06-18 15:05:50,601] [INFO] [config.py:1004:print]   zero_enabled ................. True
[2024-06-18 15:05:50,601] [INFO] [config.py:1004:print]   zero_force_ds_cpu_optimizer .. True
[2024-06-18 15:05:50,601] [INFO] [config.py:1004:print]   zero_optimization_stage ...... 1
[2024-06-18 15:05:50,601] [INFO] [config.py:990:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "gradient_clipping": 0.1, 
    "zero_optimization": {
        "stage": 1, 
        "cpu_offload": false, 
        "contiguous_gradients": false, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 4.000000e+07, 
        "allgather_bucket_size": 1.000000e+08, 
        "load_from_fp32_weights": false
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 400, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "bf16": {
        "enabled": false
    }, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0001, 
            "betas": [0.9, 0.95], 
            "eps": 1e-08, 
            "weight_decay": 0.01
        }
    }, 
    "activation_checkpointing": {
        "partition_activations": false, 
        "contiguous_memory_optimization": false
    }, 
    "wall_clock_breakdown": false
}
[2024-06-18 15:05:50,602] [INFO] [RANK 0] learning rate decaying style cosine, ratio 10.0
[2024-06-18 15:05:50,602] [INFO] [RANK 0] Finetuning Model...
[2024-06-18 15:05:50,603] [INFO] [RANK 0] arguments:
[2024-06-18 15:05:50,603] [INFO] [RANK 0]   model_class .................. VisualGLMModel
[2024-06-18 15:05:50,604] [INFO] [RANK 0]   tokenizer_type ............... THUDM/chatglm-6b
[2024-06-18 15:05:50,604] [INFO] [RANK 0]   num_layers ................... 28
[2024-06-18 15:05:50,605] [INFO] [RANK 0]   hidden_size .................. 4096
[2024-06-18 15:05:50,605] [INFO] [RANK 0]   num_attention_heads .......... 32
[2024-06-18 15:05:50,605] [INFO] [RANK 0]   vocab_size ................... 130528
[2024-06-18 15:05:50,606] [INFO] [RANK 0]   layernorm_order .............. post
[2024-06-18 15:05:50,606] [INFO] [RANK 0]   model_parallel_size .......... 1
[2024-06-18 15:05:50,607] [INFO] [RANK 0]   max_sequence_length .......... 2048
[2024-06-18 15:05:50,607] [INFO] [RANK 0]   image_length ................. 32
[2024-06-18 15:05:50,607] [INFO] [RANK 0]   eva_args ..................... {'num_layers': 39, 'hidden_size': 1408, 'num_attention_heads': 16, 'vocab_size': 1, 'layernorm_order': 'pre', 'model_parallel_size': 1, 'max_sequence_length': 257, 'inner_hidden_size': 6144, 'use_final_layernorm': False, 'layernorm_epsilon': 1e-06, 'image_size': [224, 224], 'pre_len': 1, 'post_len': 0, 'in_channels': 3, 'num_classes': 0, 'patch_size': 14}
[2024-06-18 15:05:50,608] [INFO] [RANK 0]   qformer_args ................. {'num_layers': 12, 'hidden_size': 768, 'num_attention_heads': 12, 'vocab_size': 32, 'layernorm_order': 'post', 'model_parallel_size': 1, 'max_sequence_length': 0, 'is_decoder': [True, False, True, False, True, False, True, False, True, False, True, False], 'cross_attn_hidden_size': 1408, 'layernorm_epsilon': 1e-12}
[2024-06-18 15:05:50,608] [INFO] [RANK 0]   bos_token_id ................. 130004
[2024-06-18 15:05:50,609] [INFO] [RANK 0]   mask_token_id ................ 130000
[2024-06-18 15:05:50,610] [INFO] [RANK 0]   gmask_token_id ............... 130001
[2024-06-18 15:05:50,611] [INFO] [RANK 0]   pad_token_id ................. 3
[2024-06-18 15:05:50,611] [INFO] [RANK 0]   image_size ................... [224, 224]
[2024-06-18 15:05:50,611] [INFO] [RANK 0]   pre_len ...................... 1
[2024-06-18 15:05:50,612] [INFO] [RANK 0]   post_len ..................... 0
[2024-06-18 15:05:50,613] [INFO] [RANK 0]   in_channels .................. 3
[2024-06-18 15:05:50,614] [INFO] [RANK 0]   patch_size ................... 14
[2024-06-18 15:05:50,614] [INFO] [RANK 0]   inner_hidden_size ............ None
[2024-06-18 15:05:50,614] [INFO] [RANK 0]   hidden_size_per_attention_head  None
[2024-06-18 15:05:50,614] [INFO] [RANK 0]   skip_init .................... True
[2024-06-18 15:05:50,615] [INFO] [RANK 0]   use_gpu_initialization ....... False
[2024-06-18 15:05:50,616] [INFO] [RANK 0]   num_multi_query_heads ........ 0
[2024-06-18 15:05:50,617] [INFO] [RANK 0]   layernorm_epsilon ............ 1e-05
[2024-06-18 15:05:50,618] [INFO] [RANK 0]   hidden_dropout ............... 0.1
[2024-06-18 15:05:50,618] [INFO] [RANK 0]   attention_dropout ............ 0.1
[2024-06-18 15:05:50,619] [INFO] [RANK 0]   make_vocab_size_divisible_by . 128
[2024-06-18 15:05:50,621] [INFO] [RANK 0]   experiment_name .............. finetune-visualglm-6b-06-18-15-02
[2024-06-18 15:05:50,622] [INFO] [RANK 0]   train_iters .................. 10000
[2024-06-18 15:05:50,623] [INFO] [RANK 0]   batch_size ................... 4
[2024-06-18 15:05:50,623] [INFO] [RANK 0]   lr ........................... 0.0001
[2024-06-18 15:05:50,625] [INFO] [RANK 0]   mode ......................... finetune
[2024-06-18 15:05:50,625] [INFO] [RANK 0]   seed ......................... 1234
[2024-06-18 15:05:50,626] [INFO] [RANK 0]   zero_stage ................... 1
[2024-06-18 15:05:50,626] [INFO] [RANK 0]   checkpoint_activations ....... True
[2024-06-18 15:05:50,627] [INFO] [RANK 0]   checkpoint_num_layers ........ 1
[2024-06-18 15:05:50,627] [INFO] [RANK 0]   fp16 ......................... True
[2024-06-18 15:05:50,628] [INFO] [RANK 0]   bf16 ......................... False
[2024-06-18 15:05:50,628] [INFO] [RANK 0]   gradient_accumulation_steps .. 1
[2024-06-18 15:05:50,628] [INFO] [RANK 0]   epochs ....................... None
[2024-06-18 15:05:50,629] [INFO] [RANK 0]   log_interval ................. 50
[2024-06-18 15:05:50,629] [INFO] [RANK 0]   summary_dir .................. 
[2024-06-18 15:05:50,630] [INFO] [RANK 0]   save_args .................... False
[2024-06-18 15:05:50,630] [INFO] [RANK 0]   lr_decay_iters ............... None
[2024-06-18 15:05:50,630] [INFO] [RANK 0]   lr_decay_style ............... cosine
[2024-06-18 15:05:50,631] [INFO] [RANK 0]   lr_decay_ratio ............... 0.1
[2024-06-18 15:05:50,631] [INFO] [RANK 0]   warmup ....................... 0.02
[2024-06-18 15:05:50,632] [INFO] [RANK 0]   weight_decay ................. 0.01
[2024-06-18 15:05:50,632] [INFO] [RANK 0]   save ......................... ./checkpoints/finetune-visualglm-6b-06-18-15-02
[2024-06-18 15:05:50,633] [INFO] [RANK 0]   load ......................... None
[2024-06-18 15:05:50,633] [INFO] [RANK 0]   save_interval ................ 300
[2024-06-18 15:05:50,634] [INFO] [RANK 0]   no_save_rng .................. False
[2024-06-18 15:05:50,634] [INFO] [RANK 0]   no_load_rng .................. False
[2024-06-18 15:05:50,635] [INFO] [RANK 0]   resume_dataloader ............ True
[2024-06-18 15:05:50,635] [INFO] [RANK 0]   distributed_backend .......... nccl
[2024-06-18 15:05:50,636] [INFO] [RANK 0]   local_rank ................... 0
[2024-06-18 15:05:50,636] [INFO] [RANK 0]   exit_interval ................ None
[2024-06-18 15:05:50,637] [INFO] [RANK 0]   eval_batch_size .............. 8
[2024-06-18 15:05:50,637] [INFO] [RANK 0]   eval_iters ................... 10
[2024-06-18 15:05:50,638] [INFO] [RANK 0]   eval_interval ................ 1000
[2024-06-18 15:05:50,638] [INFO] [RANK 0]   strict_eval .................. False
[2024-06-18 15:05:50,638] [INFO] [RANK 0]   train_data ................... ['./finetune-data/train/dataset.json']
[2024-06-18 15:05:50,639] [INFO] [RANK 0]   train_data_weights ........... None
[2024-06-18 15:05:50,639] [INFO] [RANK 0]   iterable_dataset ............. False
[2024-06-18 15:05:50,641] [INFO] [RANK 0]   valid_data ................... ['./finetune-data/test/dataset.json']
[2024-06-18 15:05:50,641] [INFO] [RANK 0]   test_data .................... None
[2024-06-18 15:05:50,641] [INFO] [RANK 0]   split ........................ 1
[2024-06-18 15:05:50,641] [INFO] [RANK 0]   num_workers .................. 1
[2024-06-18 15:05:50,643] [INFO] [RANK 0]   block_size ................... 10000
[2024-06-18 15:05:50,643] [INFO] [RANK 0]   prefetch_factor .............. 4
[2024-06-18 15:05:50,643] [INFO] [RANK 0]   temperature .................. 1.0
[2024-06-18 15:05:50,644] [INFO] [RANK 0]   top_p ........................ 0.0
[2024-06-18 15:05:50,644] [INFO] [RANK 0]   top_k ........................ 0
[2024-06-18 15:05:50,645] [INFO] [RANK 0]   num_beams .................... 1
[2024-06-18 15:05:50,645] [INFO] [RANK 0]   length_penalty ............... 0.0
[2024-06-18 15:05:50,645] [INFO] [RANK 0]   no_repeat_ngram_size ......... 0
[2024-06-18 15:05:50,647] [INFO] [RANK 0]   min_tgt_length ............... 0
[2024-06-18 15:05:50,647] [INFO] [RANK 0]   out_seq_length ............... 256
[2024-06-18 15:05:50,648] [INFO] [RANK 0]   input_source ................. interactive
[2024-06-18 15:05:50,648] [INFO] [RANK 0]   output_path .................. ./samples
[2024-06-18 15:05:50,649] [INFO] [RANK 0]   with_id ...................... False
[2024-06-18 15:05:50,649] [INFO] [RANK 0]   max_inference_batch_size ..... 12
[2024-06-18 15:05:50,653] [INFO] [RANK 0]   device ....................... cpu
[2024-06-18 15:05:50,653] [INFO] [RANK 0]   deepspeed .................... True
[2024-06-18 15:05:50,658] [INFO] [RANK 0]   deepspeed_config ............. {'train_micro_batch_size_per_gpu': 4, 'gradient_accumulation_steps': 1, 'gradient_clipping': 0.1, 'zero_optimization': {'stage': 1, 'cpu_offload': False, 'contiguous_gradients': False, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 40000000.0, 'allgather_bucket_size': 100000000.0, 'load_from_fp32_weights': False}, 'zero_allow_untested_optimizer': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 400, 'hysteresis': 2, 'min_loss_scale': 1}, 'bf16': {'enabled': False}, 'optimizer': {'type': 'Adam', 'params': {'lr': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'weight_decay': 0.01}}, 'activation_checkpointing': {'partition_activations': False, 'contiguous_memory_optimization': False}, 'wall_clock_breakdown': False}
[2024-06-18 15:05:50,658] [INFO] [RANK 0]   deepscale .................... False
[2024-06-18 15:05:50,658] [INFO] [RANK 0]   deepscale_config ............. None
[2024-06-18 15:05:50,659] [INFO] [RANK 0]   cuda ......................... True
[2024-06-18 15:05:50,660] [INFO] [RANK 0]   rank ......................... 0
[2024-06-18 15:05:50,660] [INFO] [RANK 0]   world_size ................... 1
[2024-06-18 15:05:50,661] [INFO] [RANK 0]   deepspeed_activation_checkpointing  True
[2024-06-18 15:05:50,662] [INFO] [RANK 0]   master_ip .................... 127.0.0.1
[2024-06-18 15:05:50,663] [INFO] [RANK 0]   master_port .................. 16666
[2024-06-18 15:05:50,663] [INFO] [RANK 0]   max_source_length ............ 64
[2024-06-18 15:05:50,664] [INFO] [RANK 0]   max_target_length ............ 256
[2024-06-18 15:05:50,664] [INFO] [RANK 0]   ignore_pad_token_for_loss .... True
[2024-06-18 15:05:50,665] [INFO] [RANK 0]   source_prefix ................ 
[2024-06-18 15:05:50,665] [INFO] [RANK 0]   pre_seq_len .................. 4
[2024-06-18 15:05:50,666] [INFO] [RANK 0]   lora_rank .................... 20
[2024-06-18 15:05:50,667] [INFO] [RANK 0]   use_ptuning .................. False
[2024-06-18 15:05:50,667] [INFO] [RANK 0]   use_lora ..................... True
[2024-06-18 15:05:50,668] [INFO] [RANK 0]   use_qlora .................... False
[2024-06-18 15:05:50,668] [INFO] [RANK 0]   layer_range .................. [0, 4, 8, 14]
[2024-06-18 15:05:50,668] [INFO] [RANK 0]   do_train ..................... True
[2024-06-18 15:05:50,669] [INFO] [RANK 0]   val_last_shape ............... []
[2024-06-18 15:05:50,669] [INFO] [RANK 0]   val_drop_number .............. 0
[2024-06-18 15:05:50,671] [INFO] [RANK 0]   do_valid ..................... True
[2024-06-18 15:05:50,671] [INFO] [RANK 0]   do_test ...................... False
[2024-06-18 15:05:50,672] [INFO] [RANK 0]   iteration .................... 0
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/sat/mpu/data.py:49: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  sizes_cuda = torch.cuda.LongTensor(sizes)
discover-01:1062089:1063461 [0] NCCL INFO Using non-device net plugin version 0
discover-01:1062089:1063461 [0] NCCL INFO Using network Socket
discover-01:1062089:1063461 [0] NCCL INFO bootstrapSplit: comm 0x55a1da5a16d0 parent 0x55a193dcd700 rank 0 nranks 1 color -1091263299 key 0 prev 0 next 0 - DONE
discover-01:1062089:1063461 [0] NCCL INFO comm 0x55a1da5a16d0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xba25971b23b69f0f - Init START
discover-01:1062089:1063461 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:1062089:1063461 [0] NCCL INFO comm 0x55a1da5a16d0 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:1062089:1063461 [0] NCCL INFO Channel 00/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 01/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 02/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 03/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 04/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 05/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 06/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 07/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 08/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 09/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 10/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 11/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 12/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 13/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 14/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 15/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 16/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 17/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 18/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 19/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 20/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 21/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 22/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 23/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 24/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 25/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 26/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 27/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 28/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 29/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 30/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Channel 31/32 :    0
discover-01:1062089:1063461 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:1062089:1063461 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:1062089:1063461 [0] NCCL INFO Connected all rings
discover-01:1062089:1063461 [0] NCCL INFO Connected all trees
discover-01:1062089:1063461 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:1062089:1063461 [0] NCCL INFO comm 0x55a1da5a16d0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xba25971b23b69f0f - Init COMPLETE
[2024-06-18 15:05:51,888] [INFO] [checkpointing.py:541:forward] Activation Checkpointing Information
[2024-06-18 15:05:51,888] [INFO] [checkpointing.py:542:forward] ----Partition Activations False, CPU CHECKPOINTING False
[2024-06-18 15:05:51,888] [INFO] [checkpointing.py:543:forward] ----contiguous Memory Checkpointing False with 6 total layers
[2024-06-18 15:05:51,888] [INFO] [checkpointing.py:545:forward] ----Synchronization False
[2024-06-18 15:05:51,888] [INFO] [checkpointing.py:546:forward] ----Profiling time in checkpointing False
[2024-06-18 15:05:53,973] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 15:05:54,872] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 15:06:02,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:06:02,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=4.27990094900486, CurrSamplesPerSec=4.528825711154421, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:06:11,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:06:11,492] [INFO] [timer.py:258:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=4.398100556965268, CurrSamplesPerSec=4.498072317840738, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:06:20,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:06:20,521] [INFO] [timer.py:258:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=4.436654802929414, CurrSamplesPerSec=4.494548852440746, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:06:29,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:06:29,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=4.456182967052185, CurrSamplesPerSec=4.483624438685615, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:06:38,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:06:38,605] [INFO] [timer.py:258:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=4.461915294324593, CurrSamplesPerSec=4.487294009591778, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:06:38,606] [INFO] [RANK 0]  iteration       50/   10000 | elapsed time per iteration (ms): 955.5 | learning rate 5.000E-06 | total loss 2.016035E+00 | loss 2.016035E+00 | loss scale 32768.0 |speed 251.19 samples/(min*GPU)
[2024-06-18 15:06:38,608] [INFO] [RANK 0] after 50 iterations memory (MB) | allocated: 14960.763671875 | max allocated: 17800.44873046875 | cached: 19342.0 | max cached: 19342.0
[2024-06-18 15:06:38,608] [INFO] [RANK 0] time (ms) | forward: 385.03 | backward: 555.52 | allreduce: 0.00 | optimizer: 14.13 | batch generator: 16.05 | data loader: 0.32
[2024-06-18 15:06:47,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:06:47,699] [INFO] [timer.py:258:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=4.463744527956215, CurrSamplesPerSec=4.4767476021544255, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:06:56,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:06:56,808] [INFO] [timer.py:258:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=4.464441338066672, CurrSamplesPerSec=4.467800401582897, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:07:05,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:07:05,908] [INFO] [timer.py:258:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=4.464229181869405, CurrSamplesPerSec=4.453953924988067, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:07:15,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:07:15,009] [INFO] [timer.py:258:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=4.463445705695267, CurrSamplesPerSec=4.465557597951145, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:07:24,114] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-18 15:07:24,115] [INFO] [timer.py:258:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=4.46284841198113, CurrSamplesPerSec=4.466807153934731, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:07:24,115] [INFO] [RANK 0]  iteration      100/   10000 | elapsed time per iteration (ms): 910.2 | learning rate 5.000E-06 | total loss 2.017930E+00 | loss 2.017930E+00 | loss scale 32768.0 |speed 263.68 samples/(min*GPU)
[2024-06-18 15:07:24,117] [INFO] [RANK 0] time (ms) | forward: 355.46 | backward: 549.04 | allreduce: 0.00 | optimizer: 4.94 | batch generator: 13.56 | data loader: 0.09
[2024-06-18 15:07:33,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=2, lr=[5.4000000000000005e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:07:33,273] [INFO] [timer.py:258:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=4.460554014829485, CurrSamplesPerSec=4.440607866050313, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:07:42,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=2, lr=[5.9e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:07:42,420] [INFO] [timer.py:258:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=4.459099237989703, CurrSamplesPerSec=4.443691757914753, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:07:51,540] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=2, lr=[6.4e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:07:51,541] [INFO] [timer.py:258:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=4.458275811449226, CurrSamplesPerSec=4.4529148208200615, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:08:00,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=2, lr=[6.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:08:00,661] [INFO] [timer.py:258:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=4.457867501708532, CurrSamplesPerSec=4.458580803926753, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:08:09,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=2, lr=[7.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:08:09,782] [INFO] [timer.py:258:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=4.45731484185669, CurrSamplesPerSec=4.453835686187686, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:08:09,783] [INFO] [RANK 0]  iteration      150/   10000 | elapsed time per iteration (ms): 913.4 | learning rate 7.450E-05 | total loss 1.806406E+00 | loss 1.806406E+00 | loss scale 32768.0 |speed 262.77 samples/(min*GPU)
[2024-06-18 15:08:09,784] [INFO] [RANK 0] time (ms) | forward: 356.93 | backward: 550.36 | allreduce: 0.00 | optimizer: 5.28 | batch generator: 13.22 | data loader: 0.10
[2024-06-18 15:08:18,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=2, lr=[7.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:08:18,904] [INFO] [timer.py:258:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=4.457074096817097, CurrSamplesPerSec=4.450938433678236, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:08:27,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=2, lr=[8.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:08:27,991] [INFO] [timer.py:258:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=4.457129604223304, CurrSamplesPerSec=4.460256850275596, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:08:37,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=2, lr=[8.9e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:08:37,094] [INFO] [timer.py:258:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=4.4569530774000015, CurrSamplesPerSec=4.459794448575061, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:08:46,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=2, lr=[9.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:08:46,200] [INFO] [timer.py:258:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=4.456949213795317, CurrSamplesPerSec=4.458300005686738, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:08:55,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=2, lr=[9.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:08:55,288] [INFO] [timer.py:258:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=4.456905861259297, CurrSamplesPerSec=4.460660047948088, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:08:55,290] [INFO] [RANK 0]  iteration      200/   10000 | elapsed time per iteration (ms): 910.1 | learning rate 9.950E-05 | total loss 7.855859E-01 | loss 7.855859E-01 | loss scale 32768.0 |speed 263.70 samples/(min*GPU)
[2024-06-18 15:08:55,290] [INFO] [RANK 0] time (ms) | forward: 354.91 | backward: 549.54 | allreduce: 0.00 | optimizer: 4.98 | batch generator: 11.92 | data loader: 0.09
[2024-06-18 15:09:04,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=2, lr=[9.999985787777144e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:09:04,374] [INFO] [timer.py:258:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=4.456746315086675, CurrSamplesPerSec=4.455738910924879, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:09:13,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=2, lr=[9.999928050775647e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:09:13,489] [INFO] [timer.py:258:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=4.456506473121271, CurrSamplesPerSec=4.449704819978511, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:09:22,601] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=2, lr=[9.999825901300984e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:09:22,601] [INFO] [timer.py:258:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=4.4563588792357605, CurrSamplesPerSec=4.459994810873347, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:09:31,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=2, lr=[9.999679340361326e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:09:31,728] [INFO] [timer.py:258:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=4.456230763723741, CurrSamplesPerSec=4.461153471329408, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:09:40,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=2, lr=[9.999488369403173e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:09:40,846] [INFO] [timer.py:258:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=4.456241211540634, CurrSamplesPerSec=4.459176876899385, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:09:40,847] [INFO] [RANK 0]  iteration      250/   10000 | elapsed time per iteration (ms): 911.2 | learning rate 9.999E-05 | total loss 2.683337E-01 | loss 2.683337E-01 | loss scale 32768.0 |speed 263.40 samples/(min*GPU)
[2024-06-18 15:09:40,848] [INFO] [RANK 0] time (ms) | forward: 355.47 | backward: 549.94 | allreduce: 0.00 | optimizer: 4.99 | batch generator: 12.37 | data loader: 0.10
[2024-06-18 15:09:49,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=2, lr=[9.999252990311333e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:09:49,962] [INFO] [timer.py:258:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=4.456153178455261, CurrSamplesPerSec=4.454900061444275, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:09:59,087] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=2, lr=[9.998973205408901e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:09:59,087] [INFO] [timer.py:258:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=4.45600112169721, CurrSamplesPerSec=4.458912594265971, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:10:08,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=2, lr=[9.998649017457239e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:10:08,221] [INFO] [timer.py:258:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=4.455927929948019, CurrSamplesPerSec=4.446904872660382, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:10:17,330] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=2, lr=[9.998280429655952e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:10:17,330] [INFO] [timer.py:258:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=4.455981908933974, CurrSamplesPerSec=4.458175612708919, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:10:26,450] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=2, lr=[9.997867445642854e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:10:26,451] [INFO] [timer.py:258:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=4.45608155388108, CurrSamplesPerSec=4.457205585661888, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:10:26,452] [INFO] [RANK 0]  iteration      300/   10000 | elapsed time per iteration (ms): 912.1 | learning rate 9.998E-05 | total loss 2.516125E-01 | loss 2.516125E-01 | loss scale 32768.0 |speed 263.13 samples/(min*GPU)
[2024-06-18 15:10:26,452] [INFO] [RANK 0] time (ms) | forward: 356.81 | backward: 549.52 | allreduce: 0.00 | optimizer: 4.99 | batch generator: 13.72 | data loader: 0.10
[2024-06-18 15:10:26,452] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:10:26,467] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/300/mp_rank_00_model_states.pt
[2024-06-18 15:10:26,467] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/300/mp_rank_00_model_states.pt...
[2024-06-18 15:10:54,214] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/300/mp_rank_00_model_states.pt.
[2024-06-18 15:11:03,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=2, lr=[9.99741006949393e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:11:03,259] [INFO] [timer.py:258:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=4.457517034108199, CurrSamplesPerSec=4.511983752011635, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:11:12,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=2, lr=[9.9969083057233e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:11:12,267] [INFO] [timer.py:258:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=4.458824588997759, CurrSamplesPerSec=4.4825019824603025, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:11:21,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=2, lr=[9.996362159283164e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:11:21,325] [INFO] [timer.py:258:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=4.459691570730183, CurrSamplesPerSec=4.493593022900772, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:11:30,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=2, lr=[9.995771635563776e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:11:30,391] [INFO] [timer.py:258:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=4.460295977465083, CurrSamplesPerSec=4.45251420370103, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:11:39,470] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=2, lr=[9.995136740393356e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:11:39,470] [INFO] [timer.py:258:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=4.460611511793091, CurrSamplesPerSec=4.457636656674731, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:11:39,472] [INFO] [RANK 0]  iteration      350/   10000 | elapsed time per iteration (ms): 1460.4 | learning rate 9.995E-05 | total loss 2.050049E-01 | loss 2.050049E-01 | loss scale 32768.0 |speed 164.34 samples/(min*GPU)
[2024-06-18 15:11:39,473] [INFO] [RANK 0] time (ms) | forward: 353.34 | backward: 545.77 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 13.01 | data loader: 0.09
[2024-06-18 15:11:48,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=2, lr=[9.994457480038073e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:11:48,552] [INFO] [timer.py:258:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=4.460910913962648, CurrSamplesPerSec=4.471241521753615, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:11:57,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=2, lr=[9.993733861201945e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:11:57,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=4.460972917949328, CurrSamplesPerSec=4.4585701400563496, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:12:06,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=2, lr=[9.992965891026802e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:12:06,757] [INFO] [timer.py:258:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=4.460908823263504, CurrSamplesPerSec=4.46575610104079, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:12:15,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=2, lr=[9.992153577092197e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:12:15,865] [INFO] [timer.py:258:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=4.460855401304445, CurrSamplesPerSec=4.473244333527971, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:12:24,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=2, lr=[9.991296927415344e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:12:24,966] [INFO] [timer.py:258:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=4.460740729009917, CurrSamplesPerSec=4.4657216291781925, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:12:24,967] [INFO] [RANK 0]  iteration      400/   10000 | elapsed time per iteration (ms): 909.9 | learning rate 9.991E-05 | total loss 2.021765E-01 | loss 2.021765E-01 | loss scale 32768.0 |speed 263.76 samples/(min*GPU)
[2024-06-18 15:12:24,968] [INFO] [RANK 0] time (ms) | forward: 354.80 | backward: 549.44 | allreduce: 0.00 | optimizer: 4.96 | batch generator: 12.88 | data loader: 0.09
[2024-06-18 15:12:27,689] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 15:12:28,598] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 15:12:34,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=4, lr=[9.990579691606356e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:12:34,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=4.4607373910585, CurrSamplesPerSec=4.458259725295867, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:12:43,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=4, lr=[9.98964325919351e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:12:43,181] [INFO] [timer.py:258:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=4.460670682095902, CurrSamplesPerSec=4.4587834271569555, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:12:52,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=4, lr=[9.98866251581424e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:12:52,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=4.460605676291459, CurrSamplesPerSec=4.457838009614373, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:13:01,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=4, lr=[9.987637471148084e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:13:01,410] [INFO] [timer.py:258:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=4.460487274830731, CurrSamplesPerSec=4.453434903363273, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:13:10,528] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=4, lr=[9.986568135311822e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:13:10,528] [INFO] [timer.py:258:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=4.4604619976295545, CurrSamplesPerSec=4.462224907921418, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:13:10,530] [INFO] [RANK 0]  iteration      450/   10000 | elapsed time per iteration (ms): 911.2 | learning rate 9.986E-05 | total loss 1.972339E-01 | loss 1.972339E-01 | loss scale 32768.0 |speed 263.37 samples/(min*GPU)
[2024-06-18 15:13:10,530] [INFO] [RANK 0] time (ms) | forward: 355.98 | backward: 549.57 | allreduce: 0.00 | optimizer: 4.96 | batch generator: 13.39 | data loader: 0.10
[2024-06-18 15:13:19,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=4, lr=[9.985454518859362e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:13:19,668] [INFO] [timer.py:258:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=4.460227692992884, CurrSamplesPerSec=4.452874637679429, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:13:28,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=4, lr=[9.984296632781656e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:13:28,774] [INFO] [timer.py:258:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=4.460120749509013, CurrSamplesPerSec=4.460020894863745, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:13:37,883] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=4, lr=[9.983094488506567e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:13:37,884] [INFO] [timer.py:258:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=4.460059875073808, CurrSamplesPerSec=4.459018066538101, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:13:46,987] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=4, lr=[9.981848097898774e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:13:46,988] [INFO] [timer.py:258:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=4.459988095558587, CurrSamplesPerSec=4.451283259495568, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:13:56,081] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=4, lr=[9.98055747325965e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:13:56,081] [INFO] [timer.py:258:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=4.460011328793868, CurrSamplesPerSec=4.463565224493662, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:13:56,083] [INFO] [RANK 0]  iteration      500/   10000 | elapsed time per iteration (ms): 911.1 | learning rate 9.980E-05 | total loss 2.378967E-01 | loss 2.378967E-01 | loss scale 32768.0 |speed 263.43 samples/(min*GPU)
[2024-06-18 15:13:56,083] [INFO] [RANK 0] time (ms) | forward: 355.60 | backward: 549.64 | allreduce: 0.00 | optimizer: 5.07 | batch generator: 12.83 | data loader: 0.09
[2024-06-18 15:14:05,207] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=4, lr=[9.979222627327138e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:14:05,208] [INFO] [timer.py:258:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=4.459883392538471, CurrSamplesPerSec=4.45435834913946, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:14:14,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=4, lr=[9.977843573275632e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:14:14,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=4.459669043048997, CurrSamplesPerSec=4.449622210004506, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:14:23,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=4, lr=[9.976420324715835e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:14:23,494] [INFO] [timer.py:258:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=4.459547972317773, CurrSamplesPerSec=4.459724503846419, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:14:32,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=4, lr=[9.97495289569464e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:14:32,623] [INFO] [timer.py:258:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=4.459491643066808, CurrSamplesPerSec=4.462586915854042, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:14:41,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=4, lr=[9.973441300694973e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:14:41,747] [INFO] [timer.py:258:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=4.459422969661542, CurrSamplesPerSec=4.435843437920804, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:14:41,748] [INFO] [RANK 0]  iteration      550/   10000 | elapsed time per iteration (ms): 913.3 | learning rate 9.973E-05 | total loss 2.135437E-01 | loss 2.135437E-01 | loss scale 32768.0 |speed 262.78 samples/(min*GPU)
[2024-06-18 15:14:41,749] [INFO] [RANK 0] time (ms) | forward: 357.78 | backward: 549.71 | allreduce: 0.00 | optimizer: 5.08 | batch generator: 14.55 | data loader: 0.11
[2024-06-18 15:14:50,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=4, lr=[9.971885554635668e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:14:50,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=4.4595156982514395, CurrSamplesPerSec=4.456730793496131, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:14:59,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=4, lr=[9.970285672871313e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:14:59,981] [INFO] [timer.py:258:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=4.459509887073676, CurrSamplesPerSec=4.456567422080139, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:15:09,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=4, lr=[9.968641671192096e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:15:09,111] [INFO] [timer.py:258:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=4.459521034220912, CurrSamplesPerSec=4.456467984473618, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:15:18,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=4, lr=[9.966953565823649e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:15:18,230] [INFO] [timer.py:258:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=4.459456233375167, CurrSamplesPerSec=4.439046383296679, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:15:27,348] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=4, lr=[9.965221373426886e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:15:27,349] [INFO] [timer.py:258:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=4.459373419689687, CurrSamplesPerSec=4.460985030885084, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:15:27,350] [INFO] [RANK 0]  iteration      600/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 9.965E-05 | total loss 2.114368E-01 | loss 2.114368E-01 | loss scale 32768.0 |speed 263.15 samples/(min*GPU)
[2024-06-18 15:15:27,351] [INFO] [RANK 0] time (ms) | forward: 356.87 | backward: 549.44 | allreduce: 0.00 | optimizer: 4.99 | batch generator: 14.42 | data loader: 0.11
[2024-06-18 15:15:27,352] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:15:27,363] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/600/mp_rank_00_model_states.pt
[2024-06-18 15:15:27,363] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/600/mp_rank_00_model_states.pt...
[2024-06-18 15:15:59,981] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/600/mp_rank_00_model_states.pt.
[2024-06-18 15:16:09,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=4, lr=[9.963445111097852e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:16:09,054] [INFO] [timer.py:258:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=4.460069097227202, CurrSamplesPerSec=4.513537478800609, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:16:18,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=4, lr=[9.961624796367537e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:16:18,068] [INFO] [timer.py:258:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=4.460837171327386, CurrSamplesPerSec=4.511855131970803, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:16:27,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=4, lr=[9.959760447201712e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:16:27,138] [INFO] [timer.py:258:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=4.461160726703364, CurrSamplesPerSec=4.476517065350918, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:16:36,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=4, lr=[9.957852082000752e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:16:36,202] [INFO] [timer.py:258:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=4.461425576852661, CurrSamplesPerSec=4.478137298236848, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:16:45,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=4, lr=[9.955899719599449e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:16:45,290] [INFO] [timer.py:258:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=4.461498717337726, CurrSamplesPerSec=4.462861131445888, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:16:45,292] [INFO] [RANK 0]  iteration      650/   10000 | elapsed time per iteration (ms): 1558.9 | learning rate 9.956E-05 | total loss 2.334924E-01 | loss 2.334924E-01 | loss scale 32768.0 |speed 153.96 samples/(min*GPU)
[2024-06-18 15:16:45,293] [INFO] [RANK 0] time (ms) | forward: 354.55 | backward: 545.57 | allreduce: 0.00 | optimizer: 5.08 | batch generator: 13.92 | data loader: 0.11
[2024-06-18 15:16:54,388] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=4, lr=[9.953903379266834e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:16:54,389] [INFO] [timer.py:258:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=4.461486537210381, CurrSamplesPerSec=4.456808931885843, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:17:03,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=4, lr=[9.951863080705979e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:17:03,507] [INFO] [timer.py:258:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=4.46142903461833, CurrSamplesPerSec=4.462976288299715, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:17:12,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=4, lr=[9.949778844053809e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:17:12,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=4.461353770284105, CurrSamplesPerSec=4.458175612708919, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:17:21,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=4, lr=[9.947650689880895e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:17:21,743] [INFO] [timer.py:258:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=4.4612681072773475, CurrSamplesPerSec=4.448985036148035, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:17:30,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=4, lr=[9.945478639191261e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:17:30,862] [INFO] [timer.py:258:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=4.461206978763109, CurrSamplesPerSec=4.462029092044489, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:17:30,863] [INFO] [RANK 0]  iteration      700/   10000 | elapsed time per iteration (ms): 911.4 | learning rate 9.945E-05 | total loss 2.140747E-01 | loss 2.140747E-01 | loss scale 32768.0 |speed 263.33 samples/(min*GPU)
[2024-06-18 15:17:30,864] [INFO] [RANK 0] time (ms) | forward: 356.17 | backward: 549.46 | allreduce: 0.00 | optimizer: 5.04 | batch generator: 13.49 | data loader: 0.10
[2024-06-18 15:17:39,964] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=4, lr=[9.943262713422169e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:17:39,965] [INFO] [timer.py:258:stop] epoch=0/micro_step=710/global_step=710, RunningAvgSamplesPerSec=4.461123910900532, CurrSamplesPerSec=4.463700606796859, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:17:49,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=4, lr=[9.941002934443916e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:17:49,063] [INFO] [timer.py:258:stop] epoch=0/micro_step=720/global_step=720, RunningAvgSamplesPerSec=4.461068740673728, CurrSamplesPerSec=4.442478625960667, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:17:58,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=4, lr=[9.938699324559604e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:17:58,192] [INFO] [timer.py:258:stop] epoch=0/micro_step=730/global_step=730, RunningAvgSamplesPerSec=4.46100526568217, CurrSamplesPerSec=4.460314953679998, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:18:07,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=4, lr=[9.936351906504936e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:18:07,292] [INFO] [timer.py:258:stop] epoch=0/micro_step=740/global_step=740, RunningAvgSamplesPerSec=4.460946183826314, CurrSamplesPerSec=4.45203450342025, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:18:16,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=4, lr=[9.933960703447975e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:18:16,428] [INFO] [timer.py:258:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=4.460885659272363, CurrSamplesPerSec=4.453510561853944, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:18:16,429] [INFO] [RANK 0]  iteration      750/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 9.934E-05 | total loss 1.982263E-01 | loss 1.982263E-01 | loss scale 32768.0 |speed 263.35 samples/(min*GPU)
[2024-06-18 15:18:16,430] [INFO] [RANK 0] time (ms) | forward: 356.06 | backward: 549.60 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 13.24 | data loader: 0.09
[2024-06-18 15:18:25,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=4, lr=[9.931525738988936e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:18:25,563] [INFO] [timer.py:258:stop] epoch=0/micro_step=760/global_step=760, RunningAvgSamplesPerSec=4.460827121305282, CurrSamplesPerSec=4.4512773544942945, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:18:34,686] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=4, lr=[9.929047037159932e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:18:34,686] [INFO] [timer.py:258:stop] epoch=0/micro_step=770/global_step=770, RunningAvgSamplesPerSec=4.460764924949846, CurrSamplesPerSec=4.45765560676422, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:18:43,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=4, lr=[9.92652462242475e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:18:43,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=780/global_step=780, RunningAvgSamplesPerSec=4.46070359588996, CurrSamplesPerSec=4.452198724145828, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:18:52,937] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=4, lr=[9.923958519678604e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:18:52,938] [INFO] [timer.py:258:stop] epoch=0/micro_step=790/global_step=790, RunningAvgSamplesPerSec=4.46057213645489, CurrSamplesPerSec=4.4438894988405035, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:19:02,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=4, lr=[9.921348754247894e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:19:02,057] [INFO] [timer.py:258:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=4.460495137056146, CurrSamplesPerSec=4.457408083913074, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:19:02,058] [INFO] [RANK 0]  iteration      800/   10000 | elapsed time per iteration (ms): 912.6 | learning rate 9.921E-05 | total loss 1.857849E-01 | loss 1.857849E-01 | loss scale 32768.0 |speed 262.99 samples/(min*GPU)
[2024-06-18 15:19:02,059] [INFO] [RANK 0] time (ms) | forward: 357.22 | backward: 549.61 | allreduce: 0.00 | optimizer: 5.04 | batch generator: 14.12 | data loader: 0.09
[2024-06-18 15:19:06,617] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 15:19:07,530] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 15:19:11,184] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=6, lr=[9.91922952206489e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:19:11,185] [INFO] [timer.py:258:stop] epoch=0/micro_step=810/global_step=810, RunningAvgSamplesPerSec=4.460394534260963, CurrSamplesPerSec=4.4539078111091674, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:19:20,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=6, lr=[9.916541228999864e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:19:20,320] [INFO] [timer.py:258:stop] epoch=0/micro_step=820/global_step=820, RunningAvgSamplesPerSec=4.460285843804036, CurrSamplesPerSec=4.450081324275375, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:19:29,420] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=6, lr=[9.913809346455937e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:19:29,421] [INFO] [timer.py:258:stop] epoch=0/micro_step=830/global_step=830, RunningAvgSamplesPerSec=4.460253131147878, CurrSamplesPerSec=4.461802441792804, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:19:38,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=6, lr=[9.911033901395686e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:19:38,555] [INFO] [timer.py:258:stop] epoch=0/micro_step=840/global_step=840, RunningAvgSamplesPerSec=4.460192018840008, CurrSamplesPerSec=4.448805716417677, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:19:47,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=6, lr=[9.908214921211635e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:19:47,679] [INFO] [timer.py:258:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=4.460116515934581, CurrSamplesPerSec=4.453858151076682, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:19:47,681] [INFO] [RANK 0]  iteration      850/   10000 | elapsed time per iteration (ms): 912.5 | learning rate 9.908E-05 | total loss 2.091412E-01 | loss 2.091412E-01 | loss scale 32768.0 |speed 263.03 samples/(min*GPU)
[2024-06-18 15:19:47,682] [INFO] [RANK 0] time (ms) | forward: 357.17 | backward: 549.55 | allreduce: 0.00 | optimizer: 4.99 | batch generator: 13.84 | data loader: 0.11
[2024-06-18 15:19:56,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=6, lr=[9.90535243372598e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:19:56,815] [INFO] [timer.py:258:stop] epoch=0/micro_step=860/global_step=860, RunningAvgSamplesPerSec=4.46007183248688, CurrSamplesPerSec=4.4602189060122726, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:20:05,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=6, lr=[9.902446467190317e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:20:05,929] [INFO] [timer.py:258:stop] epoch=0/micro_step=870/global_step=870, RunningAvgSamplesPerSec=4.4599364959001155, CurrSamplesPerSec=4.445605168992826, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:20:15,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=6, lr=[9.899497050285361e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:20:15,072] [INFO] [timer.py:258:stop] epoch=0/micro_step=880/global_step=880, RunningAvgSamplesPerSec=4.459791663004077, CurrSamplesPerSec=4.449918439989072, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:20:24,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=6, lr=[9.896504212120668e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:20:24,192] [INFO] [timer.py:258:stop] epoch=0/micro_step=890/global_step=890, RunningAvgSamplesPerSec=4.459763260740931, CurrSamplesPerSec=4.462671194981402, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:20:33,301] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=6, lr=[9.893467982234342e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:20:33,301] [INFO] [timer.py:258:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=4.459721336833977, CurrSamplesPerSec=4.462764974090121, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:20:33,303] [INFO] [RANK 0]  iteration      900/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 9.893E-05 | total loss 1.817383E-01 | loss 1.817383E-01 | loss scale 32768.0 |speed 263.03 samples/(min*GPU)
[2024-06-18 15:20:33,303] [INFO] [RANK 0] time (ms) | forward: 356.96 | backward: 549.65 | allreduce: 0.00 | optimizer: 5.05 | batch generator: 13.58 | data loader: 0.10
[2024-06-18 15:20:33,304] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:20:33,317] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/900/mp_rank_00_model_states.pt
[2024-06-18 15:20:33,317] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/900/mp_rank_00_model_states.pt...
[2024-06-18 15:21:02,907] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/900/mp_rank_00_model_states.pt.
[2024-06-18 15:21:11,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=6, lr=[9.890388390592748e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:21:11,956] [INFO] [timer.py:258:stop] epoch=0/micro_step=910/global_step=910, RunningAvgSamplesPerSec=4.460118143202704, CurrSamplesPerSec=4.509298814002755, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:21:20,995] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=6, lr=[9.887265467590208e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:21:20,995] [INFO] [timer.py:258:stop] epoch=0/micro_step=920/global_step=920, RunningAvgSamplesPerSec=4.4605659374256845, CurrSamplesPerSec=4.4801678285525375, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:21:30,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=6, lr=[9.884099244048715e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:21:30,055] [INFO] [timer.py:258:stop] epoch=0/micro_step=930/global_step=930, RunningAvgSamplesPerSec=4.4608050211536865, CurrSamplesPerSec=4.479703681709896, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:21:39,144] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=6, lr=[9.880889751217614e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:21:39,144] [INFO] [timer.py:258:stop] epoch=0/micro_step=940/global_step=940, RunningAvgSamplesPerSec=4.461000840446835, CurrSamplesPerSec=4.467778985597943, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:21:48,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=6, lr=[9.877637020773307e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:21:48,234] [INFO] [timer.py:258:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=4.461017729228473, CurrSamplesPerSec=4.439719483837983, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:21:48,235] [INFO] [RANK 0]  iteration      950/   10000 | elapsed time per iteration (ms): 1498.7 | learning rate 9.877E-05 | total loss 1.786414E-01 | loss 1.786414E-01 | loss scale 32768.0 |speed 160.14 samples/(min*GPU)
[2024-06-18 15:21:48,236] [INFO] [RANK 0] time (ms) | forward: 354.55 | backward: 546.05 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 13.77 | data loader: 0.09
[2024-06-18 15:21:57,328] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=6, lr=[9.874341084818929e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:21:57,328] [INFO] [timer.py:258:stop] epoch=0/micro_step=960/global_step=960, RunningAvgSamplesPerSec=4.4610157572298075, CurrSamplesPerSec=4.452587467522299, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:22:06,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=6, lr=[9.871001975884035e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:22:06,416] [INFO] [timer.py:258:stop] epoch=0/micro_step=970/global_step=970, RunningAvgSamplesPerSec=4.4610408115263995, CurrSamplesPerSec=4.451553725345564, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:22:15,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=6, lr=[9.867619726924284e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:22:15,517] [INFO] [timer.py:258:stop] epoch=0/micro_step=980/global_step=980, RunningAvgSamplesPerSec=4.460996404908469, CurrSamplesPerSec=4.461968570613992, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:22:24,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=6, lr=[9.86419437132111e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:22:24,641] [INFO] [timer.py:258:stop] epoch=0/micro_step=990/global_step=990, RunningAvgSamplesPerSec=4.4609513001425425, CurrSamplesPerSec=4.4561093356904875, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:22:33,775] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=6, lr=[9.860725942881385e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:22:33,775] [INFO] [timer.py:258:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=4.460887708828688, CurrSamplesPerSec=4.462372077831576, MemAllocated=14.63GB, MaxMemAllocated=17.38GB
[2024-06-18 15:22:33,777] [INFO] [RANK 0]  iteration     1000/   10000 | elapsed time per iteration (ms): 910.8 | learning rate 9.860E-05 | total loss 1.926208E-01 | loss 1.926208E-01 | loss scale 32768.0 |speed 263.50 samples/(min*GPU)
[2024-06-18 15:22:33,777] [INFO] [RANK 0] time (ms) | forward: 355.56 | backward: 549.51 | allreduce: 0.00 | optimizer: 5.01 | batch generator: 13.10 | data loader: 0.10
[2024-06-18 15:22:41,293] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 15:22:41,293] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 15:22:41,293] [INFO] [RANK 0]  validation loss at iteration 1000 | loss: 1.629822E-01 | PPL: 1.177016E+00 loss 1.628418E-01 |
[2024-06-18 15:22:41,294] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 15:22:50,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=6, lr=[9.857214475837101e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:22:50,417] [INFO] [timer.py:258:stop] epoch=0/micro_step=1010/global_step=1010, RunningAvgSamplesPerSec=4.4608220275356505, CurrSamplesPerSec=4.458489570239773, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:22:59,553] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=6, lr=[9.853660004845018e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:22:59,553] [INFO] [timer.py:258:stop] epoch=0/micro_step=1020/global_step=1020, RunningAvgSamplesPerSec=4.460779516187759, CurrSamplesPerSec=4.455305840579276, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:23:08,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=6, lr=[9.850062564986333e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:23:08,659] [INFO] [timer.py:258:stop] epoch=0/micro_step=1030/global_step=1030, RunningAvgSamplesPerSec=4.460700248278722, CurrSamplesPerSec=4.441163873316353, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:23:17,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=6, lr=[9.846422191766323e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:23:17,767] [INFO] [timer.py:258:stop] epoch=0/micro_step=1040/global_step=1040, RunningAvgSamplesPerSec=4.460629979261641, CurrSamplesPerSec=4.459390222054945, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:23:26,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=6, lr=[9.842738921114001e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:23:26,872] [INFO] [timer.py:258:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=4.460562893410159, CurrSamplesPerSec=4.451430889619361, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:23:26,872] [INFO] [RANK 0]  iteration     1050/   10000 | elapsed time per iteration (ms): 1061.9 | learning rate 9.842E-05 | total loss 1.875061E-01 | loss 1.875061E-01 | loss scale 32768.0 |speed 226.01 samples/(min*GPU)
[2024-06-18 15:23:26,873] [INFO] [RANK 0] time (ms) | forward: 356.17 | backward: 549.62 | allreduce: 0.00 | optimizer: 5.05 | batch generator: 15.63 | data loader: 0.13
[2024-06-18 15:23:35,974] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=6, lr=[9.83901278938176e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:23:35,974] [INFO] [timer.py:258:stop] epoch=0/micro_step=1060/global_step=1060, RunningAvgSamplesPerSec=4.460535927886511, CurrSamplesPerSec=4.459784964415483, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:23:45,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=6, lr=[9.835243833345022e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:23:45,103] [INFO] [timer.py:258:stop] epoch=0/micro_step=1070/global_step=1070, RunningAvgSamplesPerSec=4.4604487165084805, CurrSamplesPerSec=4.437232495347142, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:23:54,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=6, lr=[9.831432090201855e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:23:54,223] [INFO] [timer.py:258:stop] epoch=0/micro_step=1080/global_step=1080, RunningAvgSamplesPerSec=4.460403302971147, CurrSamplesPerSec=4.460244992623955, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:24:03,336] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=6, lr=[9.827577597572628e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:24:03,337] [INFO] [timer.py:258:stop] epoch=0/micro_step=1090/global_step=1090, RunningAvgSamplesPerSec=4.46037789456688, CurrSamplesPerSec=4.461633952339289, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:24:12,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=6, lr=[9.823680393499628e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:24:12,451] [INFO] [timer.py:258:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=4.460318673075158, CurrSamplesPerSec=4.456915488651177, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:24:12,453] [INFO] [RANK 0]  iteration     1100/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 9.823E-05 | total loss 1.842480E-01 | loss 1.842480E-01 | loss scale 32768.0 |speed 263.27 samples/(min*GPU)
[2024-06-18 15:24:12,454] [INFO] [RANK 0] time (ms) | forward: 356.32 | backward: 549.58 | allreduce: 0.00 | optimizer: 5.02 | batch generator: 13.16 | data loader: 0.10
[2024-06-18 15:24:21,548] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=6, lr=[9.819740516446685e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:24:21,549] [INFO] [timer.py:258:stop] epoch=0/micro_step=1110/global_step=1110, RunningAvgSamplesPerSec=4.460264567414696, CurrSamplesPerSec=4.433782572765874, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:24:30,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=6, lr=[9.815758005298792e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:24:30,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=1120/global_step=1120, RunningAvgSamplesPerSec=4.460170731006834, CurrSamplesPerSec=4.461544966566101, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:24:39,797] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=6, lr=[9.81173289936173e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:24:39,798] [INFO] [timer.py:258:stop] epoch=0/micro_step=1130/global_step=1130, RunningAvgSamplesPerSec=4.460119582895761, CurrSamplesPerSec=4.459690125038245, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:24:48,912] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=6, lr=[9.807665238361669e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:24:48,913] [INFO] [timer.py:258:stop] epoch=0/micro_step=1140/global_step=1140, RunningAvgSamplesPerSec=4.460110127213893, CurrSamplesPerSec=4.457158220305167, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:24:58,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=6, lr=[9.803555062444779e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:24:58,027] [INFO] [timer.py:258:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=4.460067613606455, CurrSamplesPerSec=4.459372442512261, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:24:58,028] [INFO] [RANK 0]  iteration     1150/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 9.803E-05 | total loss 1.746759E-01 | loss 1.746759E-01 | loss scale 32768.0 |speed 263.30 samples/(min*GPU)
[2024-06-18 15:24:58,029] [INFO] [RANK 0] time (ms) | forward: 356.24 | backward: 549.59 | allreduce: 0.00 | optimizer: 4.99 | batch generator: 13.07 | data loader: 0.09
[2024-06-18 15:25:07,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=6, lr=[9.799402412176838e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:25:07,144] [INFO] [timer.py:258:stop] epoch=0/micro_step=1160/global_step=1160, RunningAvgSamplesPerSec=4.460001913396165, CurrSamplesPerSec=4.450749510681184, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:25:16,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=6, lr=[9.795207328542828e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:25:16,246] [INFO] [timer.py:258:stop] epoch=0/micro_step=1170/global_step=1170, RunningAvgSamplesPerSec=4.459980093083926, CurrSamplesPerSec=4.460681395738996, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:25:25,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=6, lr=[9.790969852946531e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:25:25,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=1180/global_step=1180, RunningAvgSamplesPerSec=4.459930802923491, CurrSamplesPerSec=4.457243478672084, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:25:34,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=6, lr=[9.78669002721012e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:25:34,491] [INFO] [timer.py:258:stop] epoch=0/micro_step=1190/global_step=1190, RunningAvgSamplesPerSec=4.459866595969372, CurrSamplesPerSec=4.45217745746974, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:25:43,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=6, lr=[9.782367893573747e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:25:43,604] [INFO] [timer.py:258:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=4.459851212865415, CurrSamplesPerSec=4.450227694240375, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:25:43,604] [INFO] [RANK 0]  iteration     1200/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 9.782E-05 | total loss 1.861292E-01 | loss 1.861292E-01 | loss scale 32768.0 |speed 263.29 samples/(min*GPU)
[2024-06-18 15:25:43,606] [INFO] [RANK 0] time (ms) | forward: 356.31 | backward: 549.52 | allreduce: 0.00 | optimizer: 4.97 | batch generator: 13.14 | data loader: 0.11
[2024-06-18 15:25:43,607] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:25:43,623] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/1200/mp_rank_00_model_states.pt
[2024-06-18 15:25:43,623] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/1200/mp_rank_00_model_states.pt...
[2024-06-18 15:26:07,721] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/1200/mp_rank_00_model_states.pt.
[2024-06-18 15:26:14,054] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 15:26:14,953] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 15:26:16,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=8, lr=[9.77887975362864e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:26:16,757] [INFO] [timer.py:258:stop] epoch=0/micro_step=1210/global_step=1210, RunningAvgSamplesPerSec=4.460185179192688, CurrSamplesPerSec=4.506535964390847, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:26:25,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=8, lr=[9.77448157355011e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:26:25,794] [INFO] [timer.py:258:stop] epoch=0/micro_step=1220/global_step=1220, RunningAvgSamplesPerSec=4.460470284182324, CurrSamplesPerSec=4.490653447643622, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:26:34,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=8, lr=[9.770041206064124e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:26:34,866] [INFO] [timer.py:258:stop] epoch=0/micro_step=1230/global_step=1230, RunningAvgSamplesPerSec=4.460630932648963, CurrSamplesPerSec=4.464155503982485, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:26:43,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=8, lr=[9.765558694995321e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:26:43,953] [INFO] [timer.py:258:stop] epoch=0/micro_step=1240/global_step=1240, RunningAvgSamplesPerSec=4.460747753955976, CurrSamplesPerSec=4.475989189679505, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:26:53,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=8, lr=[9.761034084584273e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:26:53,045] [INFO] [timer.py:258:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=4.460773013761183, CurrSamplesPerSec=4.460390846120757, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:26:53,047] [INFO] [RANK 0]  iteration     1250/   10000 | elapsed time per iteration (ms): 1388.8 | learning rate 9.761E-05 | total loss 1.741257E-01 | loss 1.741257E-01 | loss scale 32768.0 |speed 172.81 samples/(min*GPU)
[2024-06-18 15:26:53,047] [INFO] [RANK 0] time (ms) | forward: 354.28 | backward: 546.35 | allreduce: 0.00 | optimizer: 4.93 | batch generator: 13.51 | data loader: 0.09
[2024-06-18 15:27:02,149] [INFO] [logging.py:96:log_dist] [Rank 0] step=1260, skipped=8, lr=[9.75646741948706e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:27:02,149] [INFO] [timer.py:258:stop] epoch=0/micro_step=1260/global_step=1260, RunningAvgSamplesPerSec=4.460779942897866, CurrSamplesPerSec=4.461032477610702, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:27:11,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=1270, skipped=8, lr=[9.751858744774823e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:27:11,254] [INFO] [timer.py:258:stop] epoch=0/micro_step=1270/global_step=1270, RunningAvgSamplesPerSec=4.460821206185653, CurrSamplesPerSec=4.463357416761065, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:27:20,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=1280, skipped=8, lr=[9.747208105933319e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:27:20,354] [INFO] [timer.py:258:stop] epoch=0/micro_step=1280/global_step=1280, RunningAvgSamplesPerSec=4.460847493988419, CurrSamplesPerSec=4.457986074851856, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:27:29,470] [INFO] [logging.py:96:log_dist] [Rank 0] step=1290, skipped=8, lr=[9.742515548862475e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:27:29,470] [INFO] [timer.py:258:stop] epoch=0/micro_step=1290/global_step=1290, RunningAvgSamplesPerSec=4.460853264686336, CurrSamplesPerSec=4.45744242754657, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:27:38,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=8, lr=[9.73778111987594e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:27:38,599] [INFO] [timer.py:258:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=4.460770331533565, CurrSamplesPerSec=4.437482477234953, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:27:38,600] [INFO] [RANK 0]  iteration     1300/   10000 | elapsed time per iteration (ms): 911.1 | learning rate 9.737E-05 | total loss 1.879993E-01 | loss 1.879993E-01 | loss scale 32768.0 |speed 263.43 samples/(min*GPU)
[2024-06-18 15:27:38,600] [INFO] [RANK 0] time (ms) | forward: 356.22 | backward: 549.11 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 13.79 | data loader: 0.09
[2024-06-18 15:27:47,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=1310, skipped=8, lr=[9.733004865700612e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:27:47,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=1310/global_step=1310, RunningAvgSamplesPerSec=4.460685210327128, CurrSamplesPerSec=4.448783302467761, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:27:56,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=1320, skipped=8, lr=[9.728186833476192e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:27:56,881] [INFO] [timer.py:258:stop] epoch=0/micro_step=1320/global_step=1320, RunningAvgSamplesPerSec=4.460603903441516, CurrSamplesPerSec=4.455432439868238, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:28:06,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=1330, skipped=8, lr=[9.723327070754714e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:28:06,001] [INFO] [timer.py:258:stop] epoch=0/micro_step=1330/global_step=1330, RunningAvgSamplesPerSec=4.46054914078213, CurrSamplesPerSec=4.450121457017372, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:28:15,142] [INFO] [logging.py:96:log_dist] [Rank 0] step=1340, skipped=8, lr=[9.718425625500074e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:28:15,144] [INFO] [timer.py:258:stop] epoch=0/micro_step=1340/global_step=1340, RunningAvgSamplesPerSec=4.460364378480559, CurrSamplesPerSec=4.434809249089696, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:28:24,265] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=8, lr=[9.713482546087558e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:28:24,266] [INFO] [timer.py:258:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=4.460220807784212, CurrSamplesPerSec=4.42958237525739, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:28:24,267] [INFO] [RANK 0]  iteration     1350/   10000 | elapsed time per iteration (ms): 913.4 | learning rate 9.713E-05 | total loss 1.850943E-01 | loss 1.850943E-01 | loss scale 32768.0 |speed 262.77 samples/(min*GPU)
[2024-06-18 15:28:24,268] [INFO] [RANK 0] time (ms) | forward: 357.05 | backward: 549.97 | allreduce: 0.00 | optimizer: 5.43 | batch generator: 13.00 | data loader: 0.10
[2024-06-18 15:28:33,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=1360, skipped=8, lr=[9.708497881303363e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:28:33,379] [INFO] [timer.py:258:stop] epoch=0/micro_step=1360/global_step=1360, RunningAvgSamplesPerSec=4.460098749653977, CurrSamplesPerSec=4.43582936408788, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:28:42,515] [INFO] [logging.py:96:log_dist] [Rank 0] step=1370, skipped=8, lr=[9.703471680344118e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:28:42,516] [INFO] [timer.py:258:stop] epoch=0/micro_step=1370/global_step=1370, RunningAvgSamplesPerSec=4.459934199014872, CurrSamplesPerSec=4.433241297923879, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:28:51,658] [INFO] [logging.py:96:log_dist] [Rank 0] step=1380, skipped=8, lr=[9.6984039928164e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:28:51,658] [INFO] [timer.py:258:stop] epoch=0/micro_step=1380/global_step=1380, RunningAvgSamplesPerSec=4.459840012506054, CurrSamplesPerSec=4.4485568162775255, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:29:00,778] [INFO] [logging.py:96:log_dist] [Rank 0] step=1390, skipped=8, lr=[9.693294868736235e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:29:00,779] [INFO] [timer.py:258:stop] epoch=0/micro_step=1390/global_step=1390, RunningAvgSamplesPerSec=4.459812663672626, CurrSamplesPerSec=4.457743253023957, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:29:09,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=8, lr=[9.68814435852862e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:29:09,902] [INFO] [timer.py:258:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=4.45973437188845, CurrSamplesPerSec=4.426459635096832, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:29:09,904] [INFO] [RANK 0]  iteration     1400/   10000 | elapsed time per iteration (ms): 912.7 | learning rate 9.688E-05 | total loss 1.771185E-01 | loss 1.771185E-01 | loss scale 32768.0 |speed 262.95 samples/(min*GPU)
[2024-06-18 15:29:09,905] [INFO] [RANK 0] time (ms) | forward: 356.64 | backward: 549.89 | allreduce: 0.00 | optimizer: 5.34 | batch generator: 12.55 | data loader: 0.10
[2024-06-18 15:29:19,022] [INFO] [logging.py:96:log_dist] [Rank 0] step=1410, skipped=8, lr=[9.682952513027007e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:29:19,023] [INFO] [timer.py:258:stop] epoch=0/micro_step=1410/global_step=1410, RunningAvgSamplesPerSec=4.459696118053503, CurrSamplesPerSec=4.455872635445948, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:29:28,144] [INFO] [logging.py:96:log_dist] [Rank 0] step=1420, skipped=8, lr=[9.677719383472816e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:29:28,145] [INFO] [timer.py:258:stop] epoch=0/micro_step=1420/global_step=1420, RunningAvgSamplesPerSec=4.4596677367117055, CurrSamplesPerSec=4.45182658664432, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:29:37,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=1430, skipped=8, lr=[9.672445021514925e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:29:37,259] [INFO] [timer.py:258:stop] epoch=0/micro_step=1430/global_step=1430, RunningAvgSamplesPerSec=4.459629619722802, CurrSamplesPerSec=4.454756932505075, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:29:46,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=1440, skipped=8, lr=[9.667129479209156e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:29:46,384] [INFO] [timer.py:258:stop] epoch=0/micro_step=1440/global_step=1440, RunningAvgSamplesPerSec=4.459613063595027, CurrSamplesPerSec=4.461661242020931, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:29:55,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=8, lr=[9.661772809017767e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:29:55,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=4.459576914994462, CurrSamplesPerSec=4.454720264587381, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:29:55,500] [INFO] [RANK 0]  iteration     1450/   10000 | elapsed time per iteration (ms): 911.9 | learning rate 9.661E-05 | total loss 1.727750E-01 | loss 1.727750E-01 | loss scale 32768.0 |speed 263.18 samples/(min*GPU)
[2024-06-18 15:29:55,502] [INFO] [RANK 0] time (ms) | forward: 356.52 | backward: 549.63 | allreduce: 0.00 | optimizer: 5.05 | batch generator: 13.46 | data loader: 0.10
[2024-06-18 15:30:04,620] [INFO] [logging.py:96:log_dist] [Rank 0] step=1460, skipped=8, lr=[9.656375063808926e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:30:04,620] [INFO] [timer.py:258:stop] epoch=0/micro_step=1460/global_step=1460, RunningAvgSamplesPerSec=4.459540531925728, CurrSamplesPerSec=4.437785309921498, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:30:13,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=1470, skipped=8, lr=[9.6509362968562e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:30:13,721] [INFO] [timer.py:258:stop] epoch=0/micro_step=1470/global_step=1470, RunningAvgSamplesPerSec=4.459496534082614, CurrSamplesPerSec=4.441764705726618, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:30:22,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=1480, skipped=8, lr=[9.64545656183803e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:30:22,848] [INFO] [timer.py:258:stop] epoch=0/micro_step=1480/global_step=1480, RunningAvgSamplesPerSec=4.459440057657744, CurrSamplesPerSec=4.437223106904836, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:30:31,964] [INFO] [logging.py:96:log_dist] [Rank 0] step=1490, skipped=8, lr=[9.639935912837179e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:30:31,965] [INFO] [timer.py:258:stop] epoch=0/micro_step=1490/global_step=1490, RunningAvgSamplesPerSec=4.459356371743854, CurrSamplesPerSec=4.444050764885008, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:30:41,091] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=8, lr=[9.634374404340228e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:30:41,091] [INFO] [timer.py:258:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=4.459287145406894, CurrSamplesPerSec=4.450971496851702, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:30:41,092] [INFO] [RANK 0]  iteration     1500/   10000 | elapsed time per iteration (ms): 911.8 | learning rate 9.634E-05 | total loss 1.664990E-01 | loss 1.664990E-01 | loss scale 32768.0 |speed 263.20 samples/(min*GPU)
[2024-06-18 15:30:41,093] [INFO] [RANK 0] time (ms) | forward: 355.87 | backward: 549.94 | allreduce: 0.00 | optimizer: 5.26 | batch generator: 12.52 | data loader: 0.09
[2024-06-18 15:30:41,094] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:30:41,107] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/1500/mp_rank_00_model_states.pt
[2024-06-18 15:30:41,107] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/1500/mp_rank_00_model_states.pt...
[2024-06-18 15:31:10,489] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/1500/mp_rank_00_model_states.pt.
[2024-06-18 15:31:19,547] [INFO] [logging.py:96:log_dist] [Rank 0] step=1510, skipped=8, lr=[9.628772091237021e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:31:19,548] [INFO] [timer.py:258:stop] epoch=0/micro_step=1510/global_step=1510, RunningAvgSamplesPerSec=4.4595765235598295, CurrSamplesPerSec=4.514561338124908, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:31:28,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=1520, skipped=8, lr=[9.62312902882013e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:31:28,559] [INFO] [timer.py:258:stop] epoch=0/micro_step=1520/global_step=1520, RunningAvgSamplesPerSec=4.459860556099657, CurrSamplesPerSec=4.503108009051729, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:31:37,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=1530, skipped=8, lr=[9.617445272784296e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:31:37,636] [INFO] [timer.py:258:stop] epoch=0/micro_step=1530/global_step=1530, RunningAvgSamplesPerSec=4.459993819228376, CurrSamplesPerSec=4.478825893724759, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:31:46,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=1540, skipped=8, lr=[9.6117208792259e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:31:46,719] [INFO] [timer.py:258:stop] epoch=0/micro_step=1540/global_step=1540, RunningAvgSamplesPerSec=4.460066754582708, CurrSamplesPerSec=4.474290561920669, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:31:55,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=8, lr=[9.605955904642394e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:31:55,801] [INFO] [timer.py:258:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=4.460095333491623, CurrSamplesPerSec=4.452760001528734, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:31:55,802] [INFO] [RANK 0]  iteration     1550/   10000 | elapsed time per iteration (ms): 1494.2 | learning rate 9.605E-05 | total loss 1.811044E-01 | loss 1.811044E-01 | loss scale 32768.0 |speed 160.62 samples/(min*GPU)
[2024-06-18 15:31:55,803] [INFO] [RANK 0] time (ms) | forward: 354.06 | backward: 546.24 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 13.51 | data loader: 0.09
[2024-06-18 15:32:04,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=1560, skipped=8, lr=[9.600150405931751e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:32:04,905] [INFO] [timer.py:258:stop] epoch=0/micro_step=1560/global_step=1560, RunningAvgSamplesPerSec=4.460104192776961, CurrSamplesPerSec=4.450971496851702, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:32:14,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=1570, skipped=8, lr=[9.594304440391899e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:32:14,009] [INFO] [timer.py:258:stop] epoch=0/micro_step=1570/global_step=1570, RunningAvgSamplesPerSec=4.4600972786423245, CurrSamplesPerSec=4.46193415719944, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:32:23,118] [INFO] [logging.py:96:log_dist] [Rank 0] step=1580, skipped=8, lr=[9.588418065720158e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:32:23,119] [INFO] [timer.py:258:stop] epoch=0/micro_step=1580/global_step=1580, RunningAvgSamplesPerSec=4.460048517958878, CurrSamplesPerSec=4.449812217530607, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:32:32,240] [INFO] [logging.py:96:log_dist] [Rank 0] step=1590, skipped=8, lr=[9.58249134001267e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:32:32,240] [INFO] [timer.py:258:stop] epoch=0/micro_step=1590/global_step=1590, RunningAvgSamplesPerSec=4.460044984150829, CurrSamplesPerSec=4.451128553633989, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:32:41,365] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=8, lr=[9.576524321763824e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:32:41,366] [INFO] [timer.py:258:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=4.460002817964126, CurrSamplesPerSec=4.460392031960636, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:32:41,367] [INFO] [RANK 0]  iteration     1600/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 9.576E-05 | total loss 1.776785E-01 | loss 1.776785E-01 | loss scale 32768.0 |speed 263.36 samples/(min*GPU)
[2024-06-18 15:32:41,367] [INFO] [RANK 0] time (ms) | forward: 356.16 | backward: 549.29 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 13.30 | data loader: 0.11
[2024-06-18 15:32:49,589] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 15:32:50,500] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 15:32:50,500] [INFO] [logging.py:96:log_dist] [Rank 0] step=1610, skipped=10, lr=[9.571119603883084e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:32:50,502] [INFO] [timer.py:258:stop] epoch=0/micro_step=1610/global_step=1610, RunningAvgSamplesPerSec=4.459965855317439, CurrSamplesPerSec=4.4608960709947905, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:32:59,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=1620, skipped=10, lr=[9.565682339948657e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:32:59,616] [INFO] [timer.py:258:stop] epoch=0/micro_step=1620/global_step=1620, RunningAvgSamplesPerSec=4.459924722835378, CurrSamplesPerSec=4.45197425281061, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:33:08,735] [INFO] [logging.py:96:log_dist] [Rank 0] step=1630, skipped=10, lr=[9.559602817156913e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:33:08,736] [INFO] [timer.py:258:stop] epoch=0/micro_step=1630/global_step=1630, RunningAvgSamplesPerSec=4.459910591293633, CurrSamplesPerSec=4.460411005484451, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:33:17,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=1640, skipped=10, lr=[9.553483227724292e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:33:17,836] [INFO] [timer.py:258:stop] epoch=0/micro_step=1640/global_step=1640, RunningAvgSamplesPerSec=4.459907702863571, CurrSamplesPerSec=4.4504779619688914, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:33:26,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=10, lr=[9.547323632048671e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:33:26,976] [INFO] [timer.py:258:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=4.459865642925515, CurrSamplesPerSec=4.4581151957671175, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:33:26,977] [INFO] [RANK 0]  iteration     1650/   10000 | elapsed time per iteration (ms): 912.2 | learning rate 9.547E-05 | total loss 1.653926E-01 | loss 1.653926E-01 | loss scale 32768.0 |speed 263.10 samples/(min*GPU)
[2024-06-18 15:33:26,978] [INFO] [RANK 0] time (ms) | forward: 356.84 | backward: 549.70 | allreduce: 0.00 | optimizer: 4.97 | batch generator: 13.93 | data loader: 0.10
[2024-06-18 15:33:36,093] [INFO] [logging.py:96:log_dist] [Rank 0] step=1660, skipped=10, lr=[9.54112409092277e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:33:36,093] [INFO] [timer.py:258:stop] epoch=0/micro_step=1660/global_step=1660, RunningAvgSamplesPerSec=4.45983335664646, CurrSamplesPerSec=4.4455344906713075, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:33:45,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=1670, skipped=10, lr=[9.534884665533563e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:33:45,220] [INFO] [timer.py:258:stop] epoch=0/micro_step=1670/global_step=1670, RunningAvgSamplesPerSec=4.459818955904114, CurrSamplesPerSec=4.458589098083445, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:33:54,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=1680, skipped=10, lr=[9.528605417461653e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:33:54,333] [INFO] [timer.py:258:stop] epoch=0/micro_step=1680/global_step=1680, RunningAvgSamplesPerSec=4.459780503539714, CurrSamplesPerSec=4.424561498819702, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:34:03,448] [INFO] [logging.py:96:log_dist] [Rank 0] step=1690, skipped=10, lr=[9.522286408680687e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:34:03,449] [INFO] [timer.py:258:stop] epoch=0/micro_step=1690/global_step=1690, RunningAvgSamplesPerSec=4.4597528292587985, CurrSamplesPerSec=4.444706543730798, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:34:12,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=10, lr=[9.515927701556732e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:34:12,574] [INFO] [timer.py:258:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=4.459740087656465, CurrSamplesPerSec=4.460153690818055, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:34:12,575] [INFO] [RANK 0]  iteration     1700/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 9.515E-05 | total loss 1.643329E-01 | loss 1.643329E-01 | loss scale 32768.0 |speed 263.17 samples/(min*GPU)
[2024-06-18 15:34:12,576] [INFO] [RANK 0] time (ms) | forward: 356.50 | backward: 549.73 | allreduce: 0.00 | optimizer: 5.03 | batch generator: 13.67 | data loader: 0.09
[2024-06-18 15:34:21,677] [INFO] [logging.py:96:log_dist] [Rank 0] step=1710, skipped=10, lr=[9.509529358847655e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:34:21,678] [INFO] [timer.py:258:stop] epoch=0/micro_step=1710/global_step=1710, RunningAvgSamplesPerSec=4.459729326305816, CurrSamplesPerSec=4.460559241696081, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:34:30,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=1720, skipped=10, lr=[9.503091443702522e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:34:30,780] [INFO] [timer.py:258:stop] epoch=0/micro_step=1720/global_step=1720, RunningAvgSamplesPerSec=4.459727284011252, CurrSamplesPerSec=4.454982867509448, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:34:39,897] [INFO] [logging.py:96:log_dist] [Rank 0] step=1730, skipped=10, lr=[9.496614019660951e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:34:39,898] [INFO] [timer.py:258:stop] epoch=0/micro_step=1730/global_step=1730, RunningAvgSamplesPerSec=4.459716340615195, CurrSamplesPerSec=4.435518589704611, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:34:49,014] [INFO] [logging.py:96:log_dist] [Rank 0] step=1740, skipped=10, lr=[9.490097150652505e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:34:49,015] [INFO] [timer.py:258:stop] epoch=0/micro_step=1740/global_step=1740, RunningAvgSamplesPerSec=4.459677518061994, CurrSamplesPerSec=4.454948561766109, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:34:58,146] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=10, lr=[9.48354090099605e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:34:58,146] [INFO] [timer.py:258:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=4.459648136978927, CurrSamplesPerSec=4.462957292945469, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:34:58,148] [INFO] [RANK 0]  iteration     1750/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 9.483E-05 | total loss 2.144675E-01 | loss 2.144675E-01 | loss scale 32768.0 |speed 263.31 samples/(min*GPU)
[2024-06-18 15:34:58,149] [INFO] [RANK 0] time (ms) | forward: 356.23 | backward: 549.49 | allreduce: 0.00 | optimizer: 5.02 | batch generator: 13.28 | data loader: 0.08
[2024-06-18 15:35:07,265] [INFO] [logging.py:96:log_dist] [Rank 0] step=1760, skipped=10, lr=[9.476945335399122e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:35:07,266] [INFO] [timer.py:258:stop] epoch=0/micro_step=1760/global_step=1760, RunningAvgSamplesPerSec=4.459637424302466, CurrSamplesPerSec=4.447415299526662, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:35:16,389] [INFO] [logging.py:96:log_dist] [Rank 0] step=1770, skipped=10, lr=[9.470310518957292e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:35:16,390] [INFO] [timer.py:258:stop] epoch=0/micro_step=1770/global_step=1770, RunningAvgSamplesPerSec=4.459585294804552, CurrSamplesPerSec=4.442533914365614, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:35:25,533] [INFO] [logging.py:96:log_dist] [Rank 0] step=1780, skipped=10, lr=[9.463636517153516e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:35:25,534] [INFO] [timer.py:258:stop] epoch=0/micro_step=1780/global_step=1780, RunningAvgSamplesPerSec=4.459513800793639, CurrSamplesPerSec=4.445710012642433, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:35:34,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=1790, skipped=10, lr=[9.456923395857504e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:35:34,642] [INFO] [timer.py:258:stop] epoch=0/micro_step=1790/global_step=1790, RunningAvgSamplesPerSec=4.459498706190799, CurrSamplesPerSec=4.434946409661435, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:35:43,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=10, lr=[9.450171221325049e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:35:43,765] [INFO] [timer.py:258:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=4.459480266375845, CurrSamplesPerSec=4.459591733447597, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:35:43,767] [INFO] [RANK 0]  iteration     1800/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 9.449E-05 | total loss 1.477182E-01 | loss 1.477182E-01 | loss scale 32768.0 |speed 263.05 samples/(min*GPU)
[2024-06-18 15:35:43,768] [INFO] [RANK 0] time (ms) | forward: 357.07 | backward: 549.56 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 13.69 | data loader: 0.09
[2024-06-18 15:35:43,769] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:35:43,783] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/1800/mp_rank_00_model_states.pt
[2024-06-18 15:35:43,783] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/1800/mp_rank_00_model_states.pt...
[2024-06-18 15:36:12,582] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/1800/mp_rank_00_model_states.pt.
[2024-06-18 15:36:21,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=1810, skipped=10, lr=[9.443380060197387e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:36:21,630] [INFO] [timer.py:258:stop] epoch=0/micro_step=1810/global_step=1810, RunningAvgSamplesPerSec=4.45973982341129, CurrSamplesPerSec=4.512535930776218, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:36:30,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=1820, skipped=10, lr=[9.436549979500537e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:36:30,670] [INFO] [timer.py:258:stop] epoch=0/micro_step=1820/global_step=1820, RunningAvgSamplesPerSec=4.459980437287653, CurrSamplesPerSec=4.500401025982728, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:36:39,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=1830, skipped=10, lr=[9.429681046644642e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:36:39,720] [INFO] [timer.py:258:stop] epoch=0/micro_step=1830/global_step=1830, RunningAvgSamplesPerSec=4.460175176464704, CurrSamplesPerSec=4.488531744375562, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:36:48,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=1840, skipped=10, lr=[9.42277332942329e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:36:48,788] [INFO] [timer.py:258:stop] epoch=0/micro_step=1840/global_step=1840, RunningAvgSamplesPerSec=4.460279167734037, CurrSamplesPerSec=4.482466053979129, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:36:57,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=10, lr=[9.415826896012865e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:36:57,864] [INFO] [timer.py:258:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=4.460382893694614, CurrSamplesPerSec=4.471913694269723, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:36:57,866] [INFO] [RANK 0]  iteration     1850/   10000 | elapsed time per iteration (ms): 1482.0 | learning rate 9.415E-05 | total loss 1.758185E-01 | loss 1.758185E-01 | loss scale 32768.0 |speed 161.94 samples/(min*GPU)
[2024-06-18 15:36:57,867] [INFO] [RANK 0] time (ms) | forward: 354.27 | backward: 545.38 | allreduce: 0.00 | optimizer: 5.02 | batch generator: 14.57 | data loader: 0.11
[2024-06-18 15:37:06,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=1860, skipped=10, lr=[9.408841814971862e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:37:06,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=1860/global_step=1860, RunningAvgSamplesPerSec=4.4604528208210885, CurrSamplesPerSec=4.46177277723363, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:37:16,051] [INFO] [logging.py:96:log_dist] [Rank 0] step=1870, skipped=10, lr=[9.401818155240207e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:37:16,051] [INFO] [timer.py:258:stop] epoch=0/micro_step=1870/global_step=1870, RunningAvgSamplesPerSec=4.460502001670488, CurrSamplesPerSec=4.463146066459239, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:37:25,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=1880, skipped=10, lr=[9.394755986138586e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:37:25,153] [INFO] [timer.py:258:stop] epoch=0/micro_step=1880/global_step=1880, RunningAvgSamplesPerSec=4.460484562250035, CurrSamplesPerSec=4.464661582104328, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:37:34,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=1890, skipped=10, lr=[9.38765537736776e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:37:34,210] [INFO] [timer.py:258:stop] epoch=0/micro_step=1890/global_step=1890, RunningAvgSamplesPerSec=4.460535995596728, CurrSamplesPerSec=4.46869053631054, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:37:43,303] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=10, lr=[9.380516399007869e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:37:43,303] [INFO] [timer.py:258:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=4.4605703749613745, CurrSamplesPerSec=4.47138809533899, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:37:43,305] [INFO] [RANK 0]  iteration     1900/   10000 | elapsed time per iteration (ms): 908.8 | learning rate 9.380E-05 | total loss 1.735442E-01 | loss 1.735442E-01 | loss scale 32768.0 |speed 264.09 samples/(min*GPU)
[2024-06-18 15:37:43,306] [INFO] [RANK 0] time (ms) | forward: 354.51 | backward: 548.55 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 12.90 | data loader: 0.09
[2024-06-18 15:37:52,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=1910, skipped=10, lr=[9.373339121517747e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:37:52,376] [INFO] [timer.py:258:stop] epoch=0/micro_step=1910/global_step=1910, RunningAvgSamplesPerSec=4.460614073566059, CurrSamplesPerSec=4.468632214489454, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:38:01,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=1920, skipped=10, lr=[9.366123615734227e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:38:01,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=1920/global_step=1920, RunningAvgSamplesPerSec=4.460621145210173, CurrSamplesPerSec=4.432549080529373, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:38:10,592] [INFO] [logging.py:96:log_dist] [Rank 0] step=1930, skipped=10, lr=[9.358869952871436e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:38:10,592] [INFO] [timer.py:258:stop] epoch=0/micro_step=1930/global_step=1930, RunningAvgSamplesPerSec=4.460629499260392, CurrSamplesPerSec=4.458660192120947, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:38:19,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=1940, skipped=10, lr=[9.351578204520099e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:38:19,692] [INFO] [timer.py:258:stop] epoch=0/micro_step=1940/global_step=1940, RunningAvgSamplesPerSec=4.460639466530959, CurrSamplesPerSec=4.452920730166617, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:38:28,795] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=10, lr=[9.344248442646829e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:38:28,796] [INFO] [timer.py:258:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=4.460622182666582, CurrSamplesPerSec=4.465210557104829, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:38:28,797] [INFO] [RANK 0]  iteration     1950/   10000 | elapsed time per iteration (ms): 909.8 | learning rate 9.344E-05 | total loss 1.563837E-01 | loss 1.563837E-01 | loss scale 32768.0 |speed 263.78 samples/(min*GPU)
[2024-06-18 15:38:28,798] [INFO] [RANK 0] time (ms) | forward: 355.03 | backward: 548.98 | allreduce: 0.00 | optimizer: 5.13 | batch generator: 12.97 | data loader: 0.10
[2024-06-18 15:38:37,896] [INFO] [logging.py:96:log_dist] [Rank 0] step=1960, skipped=10, lr=[9.336880739593416e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:38:37,896] [INFO] [timer.py:258:stop] epoch=0/micro_step=1960/global_step=1960, RunningAvgSamplesPerSec=4.460653792776356, CurrSamplesPerSec=4.4758972421710155, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:38:47,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=1970, skipped=10, lr=[9.329475168076114e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:38:47,008] [INFO] [timer.py:258:stop] epoch=0/micro_step=1970/global_step=1970, RunningAvgSamplesPerSec=4.460671789689911, CurrSamplesPerSec=4.467458960059668, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:38:56,114] [INFO] [logging.py:96:log_dist] [Rank 0] step=1980, skipped=10, lr=[9.322031801184924e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:38:56,115] [INFO] [timer.py:258:stop] epoch=0/micro_step=1980/global_step=1980, RunningAvgSamplesPerSec=4.4606908849108455, CurrSamplesPerSec=4.4694988668552975, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:39:05,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=1990, skipped=10, lr=[9.314550712382876e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:39:05,229] [INFO] [timer.py:258:stop] epoch=0/micro_step=1990/global_step=1990, RunningAvgSamplesPerSec=4.46070095756785, CurrSamplesPerSec=4.466169804906734, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:39:14,315] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=10, lr=[9.30703197550529e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:39:14,316] [INFO] [timer.py:258:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=4.46071479733332, CurrSamplesPerSec=4.466823803548546, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:39:14,318] [INFO] [RANK 0]  iteration     2000/   10000 | elapsed time per iteration (ms): 910.4 | learning rate 9.306E-05 | total loss 1.612576E-01 | loss 1.612576E-01 | loss scale 32768.0 |speed 263.62 samples/(min*GPU)
[2024-06-18 15:39:14,318] [INFO] [RANK 0] time (ms) | forward: 355.63 | backward: 548.89 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 13.81 | data loader: 0.09
[2024-06-18 15:39:20,944] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 15:39:20,945] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 15:39:20,945] [INFO] [RANK 0]  validation loss at iteration 2000 | loss: 1.271240E-01 | PPL: 1.135558E+00 loss 1.271973E-01 |
[2024-06-18 15:39:20,945] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 15:39:30,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=2010, skipped=10, lr=[9.299475664759069e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:39:30,041] [INFO] [timer.py:258:stop] epoch=0/micro_step=2010/global_step=2010, RunningAvgSamplesPerSec=4.460751312011547, CurrSamplesPerSec=4.470817346665224, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:39:30,951] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 15:39:31,857] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 15:39:39,126] [INFO] [logging.py:96:log_dist] [Rank 0] step=2020, skipped=12, lr=[9.29340361308047e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:39:39,127] [INFO] [timer.py:258:stop] epoch=0/micro_step=2020/global_step=2020, RunningAvgSamplesPerSec=4.46078244025514, CurrSamplesPerSec=4.464181636662814, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:39:48,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=2030, skipped=12, lr=[9.285779857555331e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:39:48,230] [INFO] [timer.py:258:stop] epoch=0/micro_step=2030/global_step=2030, RunningAvgSamplesPerSec=4.460791122772126, CurrSamplesPerSec=4.466066371754444, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:39:57,315] [INFO] [logging.py:96:log_dist] [Rank 0] step=2040, skipped=12, lr=[9.278118737911378e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:39:57,316] [INFO] [timer.py:258:stop] epoch=0/micro_step=2040/global_step=2040, RunningAvgSamplesPerSec=4.460822624868005, CurrSamplesPerSec=4.4537139067861915, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:40:06,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=12, lr=[9.270420329760772e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:40:06,418] [INFO] [timer.py:258:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=4.460835315050494, CurrSamplesPerSec=4.454577147200943, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:40:06,421] [INFO] [RANK 0]  iteration     2050/   10000 | elapsed time per iteration (ms): 1042.1 | learning rate 9.270E-05 | total loss 1.394360E-01 | loss 1.394360E-01 | loss scale 32768.0 |speed 230.31 samples/(min*GPU)
[2024-06-18 15:40:06,422] [INFO] [RANK 0] time (ms) | forward: 354.87 | backward: 548.92 | allreduce: 0.00 | optimizer: 5.03 | batch generator: 15.76 | data loader: 0.14
[2024-06-18 15:40:15,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=2060, skipped=12, lr=[9.26268470908369e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:40:15,523] [INFO] [timer.py:258:stop] epoch=0/micro_step=2060/global_step=2060, RunningAvgSamplesPerSec=4.460838129957538, CurrSamplesPerSec=4.46971915488575, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:40:24,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=2070, skipped=12, lr=[9.254911952227588e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:40:24,619] [INFO] [timer.py:258:stop] epoch=0/micro_step=2070/global_step=2070, RunningAvgSamplesPerSec=4.460845842056878, CurrSamplesPerSec=4.453080288452479, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:40:33,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=2080, skipped=12, lr=[9.247102135906435e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:40:33,734] [INFO] [timer.py:258:stop] epoch=0/micro_step=2080/global_step=2080, RunningAvgSamplesPerSec=4.460828805745831, CurrSamplesPerSec=4.459327401638636, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:40:42,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=2090, skipped=12, lr=[9.239255337199968e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:40:42,848] [INFO] [timer.py:258:stop] epoch=0/micro_step=2090/global_step=2090, RunningAvgSamplesPerSec=4.46083777465138, CurrSamplesPerSec=4.456020570151872, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:40:51,964] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=12, lr=[9.23137163355292e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:40:51,965] [INFO] [timer.py:258:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=4.460834317899876, CurrSamplesPerSec=4.465740648071055, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:40:51,966] [INFO] [RANK 0]  iteration     2100/   10000 | elapsed time per iteration (ms): 910.9 | learning rate 9.231E-05 | total loss 1.578574E-01 | loss 1.578574E-01 | loss scale 32768.0 |speed 263.47 samples/(min*GPU)
[2024-06-18 15:40:51,967] [INFO] [RANK 0] time (ms) | forward: 356.05 | backward: 549.04 | allreduce: 0.00 | optimizer: 5.09 | batch generator: 13.65 | data loader: 0.11
[2024-06-18 15:40:51,968] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:40:51,981] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/2100/mp_rank_00_model_states.pt
[2024-06-18 15:40:51,981] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/2100/mp_rank_00_model_states.pt...
[2024-06-18 15:41:21,804] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/2100/mp_rank_00_model_states.pt.
[2024-06-18 15:41:30,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=2110, skipped=12, lr=[9.223451102774268e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:41:30,843] [INFO] [timer.py:258:stop] epoch=0/micro_step=2110/global_step=2110, RunningAvgSamplesPerSec=4.461024271145651, CurrSamplesPerSec=4.51212087390456, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:41:39,894] [INFO] [logging.py:96:log_dist] [Rank 0] step=2120, skipped=12, lr=[9.215493823036445e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:41:39,895] [INFO] [timer.py:258:stop] epoch=0/micro_step=2120/global_step=2120, RunningAvgSamplesPerSec=4.461188851734199, CurrSamplesPerSec=4.500254958411334, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:41:48,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=2130, skipped=12, lr=[9.207499872874597e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:41:48,934] [INFO] [timer.py:258:stop] epoch=0/micro_step=2130/global_step=2130, RunningAvgSamplesPerSec=4.461324773260393, CurrSamplesPerSec=4.493142936721336, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:41:57,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=2140, skipped=12, lr=[9.199469331185782e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:41:57,973] [INFO] [timer.py:258:stop] epoch=0/micro_step=2140/global_step=2140, RunningAvgSamplesPerSec=4.461423749625019, CurrSamplesPerSec=4.463855000147667, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:42:07,015] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=12, lr=[9.191402277228204e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:42:07,016] [INFO] [timer.py:258:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=4.461487153676866, CurrSamplesPerSec=4.48024918378105, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:42:07,017] [INFO] [RANK 0]  iteration     2150/   10000 | elapsed time per iteration (ms): 1501.0 | learning rate 9.191E-05 | total loss 1.675282E-01 | loss 1.675282E-01 | loss scale 32768.0 |speed 159.89 samples/(min*GPU)
[2024-06-18 15:42:07,018] [INFO] [RANK 0] time (ms) | forward: 353.03 | backward: 545.10 | allreduce: 0.00 | optimizer: 5.09 | batch generator: 12.36 | data loader: 0.10
[2024-06-18 15:42:16,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=2160, skipped=12, lr=[9.183298790620427e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:42:16,112] [INFO] [timer.py:258:stop] epoch=0/micro_step=2160/global_step=2160, RunningAvgSamplesPerSec=4.461513730844812, CurrSamplesPerSec=4.45265955202209, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:42:25,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=2170, skipped=12, lr=[9.175158951340598e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:42:25,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=2170/global_step=2170, RunningAvgSamplesPerSec=4.461547608177507, CurrSamplesPerSec=4.481348965632927, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:42:34,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=2180, skipped=12, lr=[9.166982839725638e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:42:34,308] [INFO] [timer.py:258:stop] epoch=0/micro_step=2180/global_step=2180, RunningAvgSamplesPerSec=4.461536958292992, CurrSamplesPerSec=4.469863246911406, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:42:43,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=12, lr=[9.158770536470473e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:42:43,405] [INFO] [timer.py:258:stop] epoch=0/micro_step=2190/global_step=2190, RunningAvgSamplesPerSec=4.461567889417356, CurrSamplesPerSec=4.466547911675465, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:42:52,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=12, lr=[9.150522122627216e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:42:52,524] [INFO] [timer.py:258:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=4.46156441088251, CurrSamplesPerSec=4.449835822083124, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:42:52,525] [INFO] [RANK 0]  iteration     2200/   10000 | elapsed time per iteration (ms): 910.2 | learning rate 9.150E-05 | total loss 1.378220E-01 | loss 1.378220E-01 | loss scale 32768.0 |speed 263.69 samples/(min*GPU)
[2024-06-18 15:42:52,526] [INFO] [RANK 0] time (ms) | forward: 355.72 | backward: 548.56 | allreduce: 0.00 | optimizer: 5.13 | batch generator: 13.70 | data loader: 0.10
[2024-06-18 15:43:01,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=12, lr=[9.142237679604388e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:43:01,619] [INFO] [timer.py:258:stop] epoch=0/micro_step=2210/global_step=2210, RunningAvgSamplesPerSec=4.461575888182508, CurrSamplesPerSec=4.4555519467327125, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:43:10,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=12, lr=[9.13391728916609e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:43:10,719] [INFO] [timer.py:258:stop] epoch=0/micro_step=2220/global_step=2220, RunningAvgSamplesPerSec=4.46156102653725, CurrSamplesPerSec=4.453410078481151, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:43:19,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=12, lr=[9.12556103343122e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:43:19,818] [INFO] [timer.py:258:stop] epoch=0/micro_step=2230/global_step=2230, RunningAvgSamplesPerSec=4.461564315211339, CurrSamplesPerSec=4.462572671808964, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:43:28,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=12, lr=[9.117168994872649e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:43:28,923] [INFO] [timer.py:258:stop] epoch=0/micro_step=2240/global_step=2240, RunningAvgSamplesPerSec=4.461515149571415, CurrSamplesPerSec=4.4572837407013814, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:43:38,006] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=12, lr=[9.108741256316407e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:43:38,007] [INFO] [timer.py:258:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=4.461539661310536, CurrSamplesPerSec=4.469825139025837, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:43:38,008] [INFO] [RANK 0]  iteration     2250/   10000 | elapsed time per iteration (ms): 909.7 | learning rate 9.108E-05 | total loss 1.437125E-01 | loss 1.437125E-01 | loss scale 32768.0 |speed 263.84 samples/(min*GPU)
[2024-06-18 15:43:38,009] [INFO] [RANK 0] time (ms) | forward: 354.56 | backward: 549.12 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 12.30 | data loader: 0.10
[2024-06-18 15:43:47,093] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=12, lr=[9.100277900940877e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:43:47,094] [INFO] [timer.py:258:stop] epoch=0/micro_step=2260/global_step=2260, RunningAvgSamplesPerSec=4.4615322776469055, CurrSamplesPerSec=4.458091503295762, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:43:56,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=12, lr=[9.091779012275951e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:43:56,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=2270/global_step=2270, RunningAvgSamplesPerSec=4.4615401046238325, CurrSamplesPerSec=4.472178328247319, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:44:05,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=12, lr=[9.083244674202236e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:44:05,319] [INFO] [timer.py:258:stop] epoch=0/micro_step=2280/global_step=2280, RunningAvgSamplesPerSec=4.461539342638659, CurrSamplesPerSec=4.463765925757223, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:44:14,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=12, lr=[9.074674970950201e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:44:14,419] [INFO] [timer.py:258:stop] epoch=0/micro_step=2290/global_step=2290, RunningAvgSamplesPerSec=4.461534797211701, CurrSamplesPerSec=4.46798363562474, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:44:23,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=12, lr=[9.066069987099359e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:44:23,514] [INFO] [timer.py:258:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=4.4615466677693885, CurrSamplesPerSec=4.461176010100204, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:44:23,516] [INFO] [RANK 0]  iteration     2300/   10000 | elapsed time per iteration (ms): 910.2 | learning rate 9.065E-05 | total loss 1.820447E-01 | loss 1.820447E-01 | loss scale 32768.0 |speed 263.69 samples/(min*GPU)
[2024-06-18 15:44:23,517] [INFO] [RANK 0] time (ms) | forward: 355.18 | backward: 549.07 | allreduce: 0.00 | optimizer: 5.18 | batch generator: 13.01 | data loader: 0.10
[2024-06-18 15:44:32,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=2310, skipped=12, lr=[9.057429807577423e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:44:32,610] [INFO] [timer.py:258:stop] epoch=0/micro_step=2310/global_step=2310, RunningAvgSamplesPerSec=4.461544383106685, CurrSamplesPerSec=4.461192617761259, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:44:41,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=2320, skipped=12, lr=[9.048754517659479e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:44:41,699] [INFO] [timer.py:258:stop] epoch=0/micro_step=2320/global_step=2320, RunningAvgSamplesPerSec=4.4615640246296575, CurrSamplesPerSec=4.465243832655983, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:44:50,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=2330, skipped=12, lr=[9.040044202967136e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:44:50,796] [INFO] [timer.py:258:stop] epoch=0/micro_step=2330/global_step=2330, RunningAvgSamplesPerSec=4.461535249697725, CurrSamplesPerSec=4.463030900843887, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:44:59,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=2340, skipped=12, lr=[9.031298949467681e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:44:59,909] [INFO] [timer.py:258:stop] epoch=0/micro_step=2340/global_step=2340, RunningAvgSamplesPerSec=4.461519288981813, CurrSamplesPerSec=4.448253691165198, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:45:08,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=12, lr=[9.022518843473241e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:45:08,999] [INFO] [timer.py:258:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=4.461503217746572, CurrSamplesPerSec=4.453635876884051, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:45:09,001] [INFO] [RANK 0]  iteration     2350/   10000 | elapsed time per iteration (ms): 909.7 | learning rate 9.022E-05 | total loss 1.524747E-01 | loss 1.524747E-01 | loss scale 32768.0 |speed 263.82 samples/(min*GPU)
[2024-06-18 15:45:09,002] [INFO] [RANK 0] time (ms) | forward: 354.74 | backward: 549.07 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 12.17 | data loader: 0.10
[2024-06-18 15:45:18,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=2360, skipped=12, lr=[9.013703971639914e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:45:18,129] [INFO] [timer.py:258:stop] epoch=0/micro_step=2360/global_step=2360, RunningAvgSamplesPerSec=4.46146727485036, CurrSamplesPerSec=4.445402563817216, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:45:27,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=2370, skipped=12, lr=[9.004854420966926e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:45:27,225] [INFO] [timer.py:258:stop] epoch=0/micro_step=2370/global_step=2370, RunningAvgSamplesPerSec=4.461474693862926, CurrSamplesPerSec=4.468160934815546, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:45:36,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=2380, skipped=12, lr=[8.995970278795771e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:45:36,342] [INFO] [timer.py:258:stop] epoch=0/micro_step=2380/global_step=2380, RunningAvgSamplesPerSec=4.461474135729394, CurrSamplesPerSec=4.457341766670183, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:45:45,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=2390, skipped=12, lr=[8.987051632809343e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:45:45,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=2390/global_step=2390, RunningAvgSamplesPerSec=4.461459704036322, CurrSamplesPerSec=4.46653839877046, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:45:54,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=12, lr=[8.97809857103108e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:45:54,577] [INFO] [timer.py:258:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=4.461444809989422, CurrSamplesPerSec=4.4577314087333955, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:45:54,578] [INFO] [RANK 0]  iteration     2400/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 8.977E-05 | total loss 1.660889E-01 | loss 1.660889E-01 | loss scale 32768.0 |speed 263.29 samples/(min*GPU)
[2024-06-18 15:45:54,580] [INFO] [RANK 0] time (ms) | forward: 356.42 | backward: 549.15 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 13.84 | data loader: 0.10
[2024-06-18 15:45:54,581] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:45:54,593] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/2400/mp_rank_00_model_states.pt
[2024-06-18 15:45:54,593] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/2400/mp_rank_00_model_states.pt...
[2024-06-18 15:46:20,115] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/2400/mp_rank_00_model_states.pt.
[2024-06-18 15:46:29,190] [INFO] [logging.py:96:log_dist] [Rank 0] step=2410, skipped=12, lr=[8.969111181824083e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:46:29,191] [INFO] [timer.py:258:stop] epoch=0/micro_step=2410/global_step=2410, RunningAvgSamplesPerSec=4.461563461124294, CurrSamplesPerSec=4.506061497265161, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:46:31,895] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 15:46:32,795] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 15:46:38,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=2420, skipped=14, lr=[8.96189661430612e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:46:38,212] [INFO] [timer.py:258:stop] epoch=0/micro_step=2420/global_step=2420, RunningAvgSamplesPerSec=4.461701130975737, CurrSamplesPerSec=4.475615452559007, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:46:47,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=2430, skipped=14, lr=[8.952847659483319e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:46:47,270] [INFO] [timer.py:258:stop] epoch=0/micro_step=2430/global_step=2430, RunningAvgSamplesPerSec=4.461791352479549, CurrSamplesPerSec=4.482021786026755, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:46:56,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=2440, skipped=14, lr=[8.94376462644809e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:46:56,346] [INFO] [timer.py:258:stop] epoch=0/micro_step=2440/global_step=2440, RunningAvgSamplesPerSec=4.461851459508451, CurrSamplesPerSec=4.477184851154267, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:47:05,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=14, lr=[8.934647604846301e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:47:05,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=4.461889260396966, CurrSamplesPerSec=4.476549315185091, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:47:05,451] [INFO] [RANK 0]  iteration     2450/   10000 | elapsed time per iteration (ms): 1417.4 | learning rate 8.934E-05 | total loss 1.684155E-01 | loss 1.684155E-01 | loss scale 32768.0 |speed 169.32 samples/(min*GPU)
[2024-06-18 15:47:05,452] [INFO] [RANK 0] time (ms) | forward: 354.48 | backward: 545.97 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 13.63 | data loader: 0.10
[2024-06-18 15:47:14,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=2460, skipped=14, lr=[8.925496684659279e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:47:14,551] [INFO] [timer.py:258:stop] epoch=0/micro_step=2460/global_step=2460, RunningAvgSamplesPerSec=4.461896730884299, CurrSamplesPerSec=4.441804688602445, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:47:23,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=2470, skipped=14, lr=[8.916311956202905e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:47:23,669] [INFO] [timer.py:258:stop] epoch=0/micro_step=2470/global_step=2470, RunningAvgSamplesPerSec=4.461900546308923, CurrSamplesPerSec=4.463057020359226, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:47:32,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=2480, skipped=14, lr=[8.907093510126747e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:47:32,767] [INFO] [timer.py:258:stop] epoch=0/micro_step=2480/global_step=2480, RunningAvgSamplesPerSec=4.4618881671636546, CurrSamplesPerSec=4.458096241769887, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:47:41,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=2490, skipped=14, lr=[8.897841437413139e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:47:41,881] [INFO] [timer.py:258:stop] epoch=0/micro_step=2490/global_step=2490, RunningAvgSamplesPerSec=4.461877419055287, CurrSamplesPerSec=4.4594091870567425, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:47:50,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=14, lr=[8.888555829376311e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:47:50,991] [INFO] [timer.py:258:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=4.461888382413662, CurrSamplesPerSec=4.463364541277277, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:47:50,993] [INFO] [RANK 0]  iteration     2500/   10000 | elapsed time per iteration (ms): 910.8 | learning rate 8.888E-05 | total loss 1.577388E-01 | loss 1.577388E-01 | loss scale 32768.0 |speed 263.49 samples/(min*GPU)
[2024-06-18 15:47:50,994] [INFO] [RANK 0] time (ms) | forward: 356.15 | backward: 548.72 | allreduce: 0.00 | optimizer: 5.19 | batch generator: 13.77 | data loader: 0.15
[2024-06-18 15:48:00,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=2510, skipped=14, lr=[8.879236777661462e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:48:00,114] [INFO] [timer.py:258:stop] epoch=0/micro_step=2510/global_step=2510, RunningAvgSamplesPerSec=4.461867542925865, CurrSamplesPerSec=4.442720964066246, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:48:09,235] [INFO] [logging.py:96:log_dist] [Rank 0] step=2520, skipped=14, lr=[8.86988437424387e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:48:09,236] [INFO] [timer.py:258:stop] epoch=0/micro_step=2520/global_step=2520, RunningAvgSamplesPerSec=4.461874422989252, CurrSamplesPerSec=4.467058100562229, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:48:18,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=2530, skipped=14, lr=[8.860498711427982e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:48:18,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=2530/global_step=2530, RunningAvgSamplesPerSec=4.461857625493523, CurrSamplesPerSec=4.445481483404977, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:48:27,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=2540, skipped=14, lr=[8.8510798818465e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:48:27,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=2540/global_step=2540, RunningAvgSamplesPerSec=4.461838131421774, CurrSamplesPerSec=4.448313841112104, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:48:36,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=14, lr=[8.841627978459472e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:48:36,591] [INFO] [timer.py:258:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=4.461819001494341, CurrSamplesPerSec=4.459892849110983, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:48:36,592] [INFO] [RANK 0]  iteration     2550/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 8.841E-05 | total loss 1.477295E-01 | loss 1.477295E-01 | loss scale 32768.0 |speed 263.16 samples/(min*GPU)
[2024-06-18 15:48:36,594] [INFO] [RANK 0] time (ms) | forward: 357.02 | backward: 549.02 | allreduce: 0.00 | optimizer: 5.21 | batch generator: 14.20 | data loader: 0.16
[2024-06-18 15:48:45,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=2560, skipped=14, lr=[8.832143094553364e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:48:45,700] [INFO] [timer.py:258:stop] epoch=0/micro_step=2560/global_step=2560, RunningAvgSamplesPerSec=4.461802036366772, CurrSamplesPerSec=4.458970662652396, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:48:54,801] [INFO] [logging.py:96:log_dist] [Rank 0] step=2570, skipped=14, lr=[8.822625323740153e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:48:54,802] [INFO] [timer.py:258:stop] epoch=0/micro_step=2570/global_step=2570, RunningAvgSamplesPerSec=4.461785290361962, CurrSamplesPerSec=4.4617858295910695, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:49:03,920] [INFO] [logging.py:96:log_dist] [Rank 0] step=2580, skipped=14, lr=[8.813074759956396e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:49:03,921] [INFO] [timer.py:258:stop] epoch=0/micro_step=2580/global_step=2580, RunningAvgSamplesPerSec=4.461774621073554, CurrSamplesPerSec=4.459246804451375, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:49:13,033] [INFO] [logging.py:96:log_dist] [Rank 0] step=2590, skipped=14, lr=[8.8034914974623e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:49:13,034] [INFO] [timer.py:258:stop] epoch=0/micro_step=2590/global_step=2590, RunningAvgSamplesPerSec=4.461751441002622, CurrSamplesPerSec=4.418580078325612, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:49:22,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=14, lr=[8.793875630840797e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:49:22,139] [INFO] [timer.py:258:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=4.461728032223701, CurrSamplesPerSec=4.455944826355311, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:49:22,140] [INFO] [RANK 0]  iteration     2600/   10000 | elapsed time per iteration (ms): 911.0 | learning rate 8.793E-05 | total loss 1.260596E-01 | loss 1.260596E-01 | loss scale 32768.0 |speed 263.46 samples/(min*GPU)
[2024-06-18 15:49:22,142] [INFO] [RANK 0] time (ms) | forward: 355.83 | backward: 549.21 | allreduce: 0.00 | optimizer: 5.18 | batch generator: 12.93 | data loader: 0.22
[2024-06-18 15:49:31,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=2610, skipped=14, lr=[8.784227254996609e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:49:31,261] [INFO] [timer.py:258:stop] epoch=0/micro_step=2610/global_step=2610, RunningAvgSamplesPerSec=4.461705817311096, CurrSamplesPerSec=4.443675280298618, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:49:40,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=2620, skipped=14, lr=[8.774546465155311e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:49:40,381] [INFO] [timer.py:258:stop] epoch=0/micro_step=2620/global_step=2620, RunningAvgSamplesPerSec=4.461690468645837, CurrSamplesPerSec=4.459594104278253, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:49:49,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=2630, skipped=14, lr=[8.76483335686239e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:49:49,502] [INFO] [timer.py:258:stop] epoch=0/micro_step=2630/global_step=2630, RunningAvgSamplesPerSec=4.461667527219081, CurrSamplesPerSec=4.440565554073651, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:49:58,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=2640, skipped=14, lr=[8.755088025982304e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:49:58,611] [INFO] [timer.py:258:stop] epoch=0/micro_step=2640/global_step=2640, RunningAvgSamplesPerSec=4.461651538075219, CurrSamplesPerSec=4.4540709875846725, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:50:07,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=14, lr=[8.745310568697534e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:50:07,719] [INFO] [timer.py:258:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=4.461641302561557, CurrSamplesPerSec=4.450862862554816, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:50:07,720] [INFO] [RANK 0]  iteration     2650/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 8.744E-05 | total loss 1.605230E-01 | loss 1.605230E-01 | loss scale 32768.0 |speed 263.28 samples/(min*GPU)
[2024-06-18 15:50:07,720] [INFO] [RANK 0] time (ms) | forward: 356.58 | backward: 549.10 | allreduce: 0.00 | optimizer: 5.18 | batch generator: 13.60 | data loader: 0.20
[2024-06-18 15:50:16,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=2660, skipped=14, lr=[8.735501081507633e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:50:16,828] [INFO] [timer.py:258:stop] epoch=0/micro_step=2660/global_step=2660, RunningAvgSamplesPerSec=4.461650864278208, CurrSamplesPerSec=4.453018827610644, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:50:25,938] [INFO] [logging.py:96:log_dist] [Rank 0] step=2670, skipped=14, lr=[8.725659661228286e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:50:25,939] [INFO] [timer.py:258:stop] epoch=0/micro_step=2670/global_step=2670, RunningAvgSamplesPerSec=4.461627926898711, CurrSamplesPerSec=4.462840949928883, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:50:35,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=2680, skipped=14, lr=[8.715786404990331e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:50:35,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=2680/global_step=2680, RunningAvgSamplesPerSec=4.461633972719809, CurrSamplesPerSec=4.465744214131502, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:50:44,164] [INFO] [logging.py:96:log_dist] [Rank 0] step=2690, skipped=14, lr=[8.705881410238825e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:50:44,165] [INFO] [timer.py:258:stop] epoch=0/micro_step=2690/global_step=2690, RunningAvgSamplesPerSec=4.4616397074045056, CurrSamplesPerSec=4.462042145901607, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:50:53,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=14, lr=[8.695944774732068e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:50:53,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=4.461633293123501, CurrSamplesPerSec=4.461614968409822, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:50:53,277] [INFO] [RANK 0]  iteration     2700/   10000 | elapsed time per iteration (ms): 911.1 | learning rate 8.695E-05 | total loss 1.392825E-01 | loss 1.392825E-01 | loss scale 32768.0 |speed 263.40 samples/(min*GPU)
[2024-06-18 15:50:53,278] [INFO] [RANK 0] time (ms) | forward: 356.17 | backward: 549.13 | allreduce: 0.00 | optimizer: 5.12 | batch generator: 13.99 | data loader: 0.24
[2024-06-18 15:50:53,278] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:50:53,290] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/2700/mp_rank_00_model_states.pt
[2024-06-18 15:50:53,290] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/2700/mp_rank_00_model_states.pt...
[2024-06-18 15:51:18,740] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/2700/mp_rank_00_model_states.pt.
[2024-06-18 15:51:27,834] [INFO] [logging.py:96:log_dist] [Rank 0] step=2710, skipped=14, lr=[8.685976596540638e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:51:27,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=2710/global_step=2710, RunningAvgSamplesPerSec=4.461742573684275, CurrSamplesPerSec=4.496362916163489, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:51:36,893] [INFO] [logging.py:96:log_dist] [Rank 0] step=2720, skipped=14, lr=[8.675976974046432e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:51:36,893] [INFO] [timer.py:258:stop] epoch=0/micro_step=2720/global_step=2720, RunningAvgSamplesPerSec=4.46185967258695, CurrSamplesPerSec=4.491029700590275, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:51:45,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=2730, skipped=14, lr=[8.665946005941686e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:51:45,942] [INFO] [timer.py:258:stop] epoch=0/micro_step=2730/global_step=2730, RunningAvgSamplesPerSec=4.461962169170622, CurrSamplesPerSec=4.496186986658206, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:51:54,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=2740, skipped=14, lr=[8.655883791228004e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:51:54,990] [INFO] [timer.py:258:stop] epoch=0/micro_step=2740/global_step=2740, RunningAvgSamplesPerSec=4.46203873658286, CurrSamplesPerSec=4.4901270397605435, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:52:04,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=14, lr=[8.645790429215386e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:52:04,057] [INFO] [timer.py:258:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=4.462096227720824, CurrSamplesPerSec=4.45485511086942, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:52:04,058] [INFO] [RANK 0]  iteration     2750/   10000 | elapsed time per iteration (ms): 1415.6 | learning rate 8.645E-05 | total loss 1.835580E-01 | loss 1.835580E-01 | loss scale 32768.0 |speed 169.54 samples/(min*GPU)
[2024-06-18 15:52:04,059] [INFO] [RANK 0] time (ms) | forward: 354.62 | backward: 545.54 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 13.95 | data loader: 0.19
[2024-06-18 15:52:13,151] [INFO] [logging.py:96:log_dist] [Rank 0] step=2760, skipped=14, lr=[8.635666019521238e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:52:13,151] [INFO] [timer.py:258:stop] epoch=0/micro_step=2760/global_step=2760, RunningAvgSamplesPerSec=4.4621145540709515, CurrSamplesPerSec=4.448037872392773, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:52:22,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=2770, skipped=14, lr=[8.625510662069396e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:52:22,264] [INFO] [timer.py:258:stop] epoch=0/micro_step=2770/global_step=2770, RunningAvgSamplesPerSec=4.462135649472948, CurrSamplesPerSec=4.470456384633893, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:52:31,355] [INFO] [logging.py:96:log_dist] [Rank 0] step=2780, skipped=14, lr=[8.61532445708914e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:52:31,356] [INFO] [timer.py:258:stop] epoch=0/micro_step=2780/global_step=2780, RunningAvgSamplesPerSec=4.4621447057913795, CurrSamplesPerSec=4.471661009974151, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:52:40,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=2790, skipped=14, lr=[8.605107505114198e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:52:40,465] [INFO] [timer.py:258:stop] epoch=0/micro_step=2790/global_step=2790, RunningAvgSamplesPerSec=4.462154786052264, CurrSamplesPerSec=4.447193667926649, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:52:49,572] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=14, lr=[8.594859906981766e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:52:49,572] [INFO] [timer.py:258:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=4.462154617176129, CurrSamplesPerSec=4.470499268160687, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:52:49,574] [INFO] [RANK 0]  iteration     2800/   10000 | elapsed time per iteration (ms): 910.3 | learning rate 8.594E-05 | total loss 1.229780E-01 | loss 1.229780E-01 | loss scale 32768.0 |speed 263.65 samples/(min*GPU)
[2024-06-18 15:52:49,575] [INFO] [RANK 0] time (ms) | forward: 355.86 | backward: 548.59 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 13.96 | data loader: 0.10
[2024-06-18 15:52:58,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=2810, skipped=14, lr=[8.584581763831497e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:52:58,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=2810/global_step=2810, RunningAvgSamplesPerSec=4.462170829036497, CurrSamplesPerSec=4.4741259006072545, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:53:03,204] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 15:53:04,113] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 15:53:07,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=2820, skipped=16, lr=[8.57633732505677e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:53:07,764] [INFO] [timer.py:258:stop] epoch=0/micro_step=2820/global_step=2820, RunningAvgSamplesPerSec=4.462191586381551, CurrSamplesPerSec=4.470277712127627, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:53:16,864] [INFO] [logging.py:96:log_dist] [Rank 0] step=2830, skipped=16, lr=[8.566004456707973e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:53:16,865] [INFO] [timer.py:258:stop] epoch=0/micro_step=2830/global_step=2830, RunningAvgSamplesPerSec=4.46220728412443, CurrSamplesPerSec=4.467115191883519, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:53:25,959] [INFO] [logging.py:96:log_dist] [Rank 0] step=2840, skipped=16, lr=[8.555641328132982e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:53:25,960] [INFO] [timer.py:258:stop] epoch=0/micro_step=2840/global_step=2840, RunningAvgSamplesPerSec=4.462228280184688, CurrSamplesPerSec=4.47064221919215, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:53:35,064] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=16, lr=[8.545248041611697e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:53:35,065] [INFO] [timer.py:258:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=4.462211810489864, CurrSamplesPerSec=4.436973154238171, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:53:35,066] [INFO] [RANK 0]  iteration     2850/   10000 | elapsed time per iteration (ms): 909.9 | learning rate 8.544E-05 | total loss 1.635373E-01 | loss 1.635373E-01 | loss scale 32768.0 |speed 263.78 samples/(min*GPU)
[2024-06-18 15:53:35,067] [INFO] [RANK 0] time (ms) | forward: 355.27 | backward: 548.87 | allreduce: 0.00 | optimizer: 5.01 | batch generator: 13.51 | data loader: 0.10
[2024-06-18 15:53:44,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=2860, skipped=16, lr=[8.534824699721658e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:53:44,176] [INFO] [timer.py:258:stop] epoch=0/micro_step=2860/global_step=2860, RunningAvgSamplesPerSec=4.462204237171949, CurrSamplesPerSec=4.463162688791453, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:53:53,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=2870, skipped=16, lr=[8.52437140533704e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:53:53,293] [INFO] [timer.py:258:stop] epoch=0/micro_step=2870/global_step=2870, RunningAvgSamplesPerSec=4.462186242420579, CurrSamplesPerSec=4.462709180980916, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:54:02,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=2880, skipped=16, lr=[8.513888261627641e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:54:02,373] [INFO] [timer.py:258:stop] epoch=0/micro_step=2880/global_step=2880, RunningAvgSamplesPerSec=4.462193140846902, CurrSamplesPerSec=4.465474398311888, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:54:11,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=2890, skipped=16, lr=[8.503375372057854e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:54:11,474] [INFO] [timer.py:258:stop] epoch=0/micro_step=2890/global_step=2890, RunningAvgSamplesPerSec=4.462181107153114, CurrSamplesPerSec=4.461916357365724, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:54:20,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=16, lr=[8.492832840385657e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:54:20,565] [INFO] [timer.py:258:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=4.462167146245226, CurrSamplesPerSec=4.461004009454218, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:54:20,573] [INFO] [RANK 0]  iteration     2900/   10000 | elapsed time per iteration (ms): 910.1 | learning rate 8.492E-05 | total loss 1.494974E-01 | loss 1.494974E-01 | loss scale 32768.0 |speed 263.70 samples/(min*GPU)
[2024-06-18 15:54:20,580] [INFO] [RANK 0] time (ms) | forward: 354.94 | backward: 549.09 | allreduce: 0.00 | optimizer: 5.34 | batch generator: 12.45 | data loader: 0.10
[2024-06-18 15:54:28,780] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
[2024-06-18 15:54:29,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=2910, skipped=17, lr=[8.483319303874855e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:54:29,691] [INFO] [timer.py:258:stop] epoch=0/micro_step=2910/global_step=2910, RunningAvgSamplesPerSec=4.462159665885315, CurrSamplesPerSec=4.456968768944597, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:54:38,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=2920, skipped=17, lr=[8.472720739108262e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:54:38,817] [INFO] [timer.py:258:stop] epoch=0/micro_step=2920/global_step=2920, RunningAvgSamplesPerSec=4.46216621381952, CurrSamplesPerSec=4.464691285089103, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:54:47,925] [INFO] [logging.py:96:log_dist] [Rank 0] step=2930, skipped=17, lr=[8.46209283478811e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:54:47,927] [INFO] [timer.py:258:stop] epoch=0/micro_step=2930/global_step=2930, RunningAvgSamplesPerSec=4.462181110906581, CurrSamplesPerSec=4.469838238538211, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:54:57,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=2940, skipped=17, lr=[8.451435695807522e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:54:57,048] [INFO] [timer.py:258:stop] epoch=0/micro_step=2940/global_step=2940, RunningAvgSamplesPerSec=4.462171714361289, CurrSamplesPerSec=4.454818441335467, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:55:06,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=17, lr=[8.440749427348162e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:55:06,154] [INFO] [timer.py:258:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=4.462156288687675, CurrSamplesPerSec=4.465246209500044, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:55:06,155] [INFO] [RANK 0]  iteration     2950/   10000 | elapsed time per iteration (ms): 911.7 | learning rate 8.440E-05 | total loss 1.607350E-01 | loss 1.607350E-01 | loss scale 16384.0 |speed 263.26 samples/(min*GPU)
[2024-06-18 15:55:06,156] [INFO] [RANK 0] time (ms) | forward: 356.47 | backward: 548.88 | allreduce: 0.00 | optimizer: 5.26 | batch generator: 14.08 | data loader: 0.10
[2024-06-18 15:55:15,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=2960, skipped=17, lr=[8.430034134879182e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:55:15,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=2960/global_step=2960, RunningAvgSamplesPerSec=4.4621300429788375, CurrSamplesPerSec=4.437463698274339, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:55:24,388] [INFO] [logging.py:96:log_dist] [Rank 0] step=2970, skipped=17, lr=[8.419289924156192e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:55:24,388] [INFO] [timer.py:258:stop] epoch=0/micro_step=2970/global_step=2970, RunningAvgSamplesPerSec=4.462120223140213, CurrSamplesPerSec=4.4454850171834055, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:55:33,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=2980, skipped=17, lr=[8.408516901220216e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:55:33,495] [INFO] [timer.py:258:stop] epoch=0/micro_step=2980/global_step=2980, RunningAvgSamplesPerSec=4.462106164225711, CurrSamplesPerSec=4.4679455597816045, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:55:42,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=2990, skipped=17, lr=[8.397715172396641e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:55:42,603] [INFO] [timer.py:258:stop] epoch=0/micro_step=2990/global_step=2990, RunningAvgSamplesPerSec=4.4620959714294335, CurrSamplesPerSec=4.468378710794656, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:55:51,712] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=17, lr=[8.38688484429417e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:55:51,713] [INFO] [timer.py:258:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=4.462096372991152, CurrSamplesPerSec=4.469557211300745, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:55:51,714] [INFO] [RANK 0]  iteration     3000/   10000 | elapsed time per iteration (ms): 911.2 | learning rate 8.386E-05 | total loss 1.235384E-01 | loss 1.235384E-01 | loss scale 16384.0 |speed 263.39 samples/(min*GPU)
[2024-06-18 15:55:51,715] [INFO] [RANK 0] time (ms) | forward: 356.17 | backward: 549.06 | allreduce: 0.00 | optimizer: 5.19 | batch generator: 13.47 | data loader: 0.10
[2024-06-18 15:55:51,716] [INFO] [RANK 0] Saving Model...
[2024-06-18 15:55:51,729] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/3000/mp_rank_00_model_states.pt
[2024-06-18 15:55:51,729] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/3000/mp_rank_00_model_states.pt...
[2024-06-18 15:56:15,563] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/3000/mp_rank_00_model_states.pt.
[2024-06-18 15:56:22,180] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 15:56:22,180] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 15:56:22,180] [INFO] [RANK 0]  validation loss at iteration 3000 | loss: 1.332520E-01 | PPL: 1.142538E+00 loss 1.331787E-01 |
[2024-06-18 15:56:22,180] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 15:56:31,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=3010, skipped=17, lr=[8.376026023803769e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:56:31,221] [INFO] [timer.py:258:stop] epoch=0/micro_step=3010/global_step=3010, RunningAvgSamplesPerSec=4.462200956324696, CurrSamplesPerSec=4.492340466665078, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:56:40,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=3020, skipped=17, lr=[8.36513881809761e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:56:40,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=3020/global_step=3020, RunningAvgSamplesPerSec=4.46227968179565, CurrSamplesPerSec=4.470401590213578, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:56:49,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=3030, skipped=17, lr=[8.35422333462802e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:56:49,344] [INFO] [timer.py:258:stop] epoch=0/micro_step=3030/global_step=3030, RunningAvgSamplesPerSec=4.462347645132638, CurrSamplesPerSec=4.4622486443471105, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:56:58,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=3040, skipped=17, lr=[8.343279681126414e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:56:58,405] [INFO] [timer.py:258:stop] epoch=0/micro_step=3040/global_step=3040, RunningAvgSamplesPerSec=4.462404117147299, CurrSamplesPerSec=4.480258755178656, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:57:07,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=17, lr=[8.332307965602234e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:57:07,497] [INFO] [timer.py:258:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=4.462414343391783, CurrSamplesPerSec=4.473282499737371, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:57:07,498] [INFO] [RANK 0]  iteration     3050/   10000 | elapsed time per iteration (ms): 1515.7 | learning rate 8.331E-05 | total loss 1.673280E-01 | loss 1.673280E-01 | loss scale 16384.0 |speed 158.35 samples/(min*GPU)
[2024-06-18 15:57:07,499] [INFO] [RANK 0] time (ms) | forward: 354.09 | backward: 546.36 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 15.80 | data loader: 0.14
[2024-06-18 15:57:16,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=3060, skipped=17, lr=[8.321308296341881e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:57:16,590] [INFO] [timer.py:258:stop] epoch=0/micro_step=3060/global_step=3060, RunningAvgSamplesPerSec=4.462431971334094, CurrSamplesPerSec=4.463914385049631, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:57:25,702] [INFO] [logging.py:96:log_dist] [Rank 0] step=3070, skipped=17, lr=[8.310280781907654e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:57:25,702] [INFO] [timer.py:258:stop] epoch=0/micro_step=3070/global_step=3070, RunningAvgSamplesPerSec=4.462437135463476, CurrSamplesPerSec=4.4533060534135025, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:57:34,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=3080, skipped=17, lr=[8.299225531136665e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:57:34,797] [INFO] [timer.py:258:stop] epoch=0/micro_step=3080/global_step=3080, RunningAvgSamplesPerSec=4.462435021465811, CurrSamplesPerSec=4.464807724600728, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:57:43,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=3090, skipped=17, lr=[8.288142653139775e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:57:43,899] [INFO] [timer.py:258:stop] epoch=0/micro_step=3090/global_step=3090, RunningAvgSamplesPerSec=4.462439096796668, CurrSamplesPerSec=4.465092908239889, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:57:53,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=17, lr=[8.27703225730052e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:57:53,012] [INFO] [timer.py:258:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=4.4624374927765125, CurrSamplesPerSec=4.4502902585336805, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:57:53,014] [INFO] [RANK 0]  iteration     3100/   10000 | elapsed time per iteration (ms): 910.3 | learning rate 8.276E-05 | total loss 1.349853E-01 | loss 1.349853E-01 | loss scale 16384.0 |speed 263.64 samples/(min*GPU)
[2024-06-18 15:57:53,014] [INFO] [RANK 0] time (ms) | forward: 355.54 | backward: 548.87 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 13.70 | data loader: 0.10
[2024-06-18 15:58:02,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=3110, skipped=17, lr=[8.265894453274016e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:58:02,125] [INFO] [timer.py:258:stop] epoch=0/micro_step=3110/global_step=3110, RunningAvgSamplesPerSec=4.46244176460028, CurrSamplesPerSec=4.455394577644548, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:58:11,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=3120, skipped=17, lr=[8.254729350985895e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:58:11,222] [INFO] [timer.py:258:stop] epoch=0/micro_step=3120/global_step=3120, RunningAvgSamplesPerSec=4.46243960881655, CurrSamplesPerSec=4.458877042939095, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:58:20,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=3130, skipped=17, lr=[8.243537060631212e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:58:20,322] [INFO] [timer.py:258:stop] epoch=0/micro_step=3130/global_step=3130, RunningAvgSamplesPerSec=4.4624287394236575, CurrSamplesPerSec=4.461073994323551, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:58:29,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=3140, skipped=17, lr=[8.232317692673348e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:58:29,437] [INFO] [timer.py:258:stop] epoch=0/micro_step=3140/global_step=3140, RunningAvgSamplesPerSec=4.462437613986583, CurrSamplesPerSec=4.461236510032135, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:58:38,540] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=17, lr=[8.221071357842942e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:58:38,541] [INFO] [timer.py:258:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=4.4624363169032275, CurrSamplesPerSec=4.466882078174356, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:58:38,542] [INFO] [RANK 0]  iteration     3150/   10000 | elapsed time per iteration (ms): 910.6 | learning rate 8.220E-05 | total loss 1.425778E-01 | loss 1.425778E-01 | loss scale 16384.0 |speed 263.58 samples/(min*GPU)
[2024-06-18 15:58:38,542] [INFO] [RANK 0] time (ms) | forward: 355.52 | backward: 549.10 | allreduce: 0.00 | optimizer: 5.18 | batch generator: 13.61 | data loader: 0.09
[2024-06-18 15:58:47,636] [INFO] [logging.py:96:log_dist] [Rank 0] step=3160, skipped=17, lr=[8.209798167136771e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:58:47,636] [INFO] [timer.py:258:stop] epoch=0/micro_step=3160/global_step=3160, RunningAvgSamplesPerSec=4.46242467270595, CurrSamplesPerSec=4.465192731120718, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:58:56,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=3170, skipped=17, lr=[8.198498231816682e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:58:56,752] [INFO] [timer.py:258:stop] epoch=0/micro_step=3170/global_step=3170, RunningAvgSamplesPerSec=4.462415865555926, CurrSamplesPerSec=4.467975306478601, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:59:05,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=3180, skipped=17, lr=[8.187171663408475e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:59:05,866] [INFO] [timer.py:258:stop] epoch=0/micro_step=3180/global_step=3180, RunningAvgSamplesPerSec=4.462381421741144, CurrSamplesPerSec=4.449842903497712, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:59:14,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=3190, skipped=17, lr=[8.175818573700802e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:59:14,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=3190/global_step=3190, RunningAvgSamplesPerSec=4.462356870162008, CurrSamplesPerSec=4.440157754971658, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:59:24,074] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=17, lr=[8.16443907474408e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:59:24,074] [INFO] [timer.py:258:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=4.462351427172086, CurrSamplesPerSec=4.45627859178416, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:59:24,076] [INFO] [RANK 0]  iteration     3200/   10000 | elapsed time per iteration (ms): 910.7 | learning rate 8.163E-05 | total loss 1.393292E-01 | loss 1.393292E-01 | loss scale 16384.0 |speed 263.54 samples/(min*GPU)
[2024-06-18 15:59:24,076] [INFO] [RANK 0] time (ms) | forward: 355.65 | backward: 549.07 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 12.65 | data loader: 0.10
[2024-06-18 15:59:33,216] [INFO] [logging.py:96:log_dist] [Rank 0] step=3210, skipped=17, lr=[8.153033278849368e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:59:33,217] [INFO] [timer.py:258:stop] epoch=0/micro_step=3210/global_step=3210, RunningAvgSamplesPerSec=4.462315019259752, CurrSamplesPerSec=4.42962564772243, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:59:42,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=3220, skipped=17, lr=[8.141601298587265e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:59:42,320] [INFO] [timer.py:258:stop] epoch=0/micro_step=3220/global_step=3220, RunningAvgSamplesPerSec=4.4622981600963145, CurrSamplesPerSec=4.467981255865531, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 15:59:51,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=3230, skipped=17, lr=[8.130143246786803e-05], mom=[[0.9, 0.95]]
[2024-06-18 15:59:51,420] [INFO] [timer.py:258:stop] epoch=0/micro_step=3230/global_step=3230, RunningAvgSamplesPerSec=4.462282142697233, CurrSamplesPerSec=4.4628979335056185, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:00:00,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=3240, skipped=17, lr=[8.118659236534328e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:00:00,536] [INFO] [timer.py:258:stop] epoch=0/micro_step=3240/global_step=3240, RunningAvgSamplesPerSec=4.4622697987879825, CurrSamplesPerSec=4.467897965890274, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:00:09,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=17, lr=[8.107149381172384e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:00:09,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=4.462263450509005, CurrSamplesPerSec=4.4601762194877175, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:00:09,639] [INFO] [RANK 0]  iteration     3250/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 8.106E-05 | total loss 1.266847E-01 | loss 1.266847E-01 | loss scale 16384.0 |speed 263.37 samples/(min*GPU)
[2024-06-18 16:00:09,640] [INFO] [RANK 0] time (ms) | forward: 356.16 | backward: 549.19 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 13.07 | data loader: 0.10
[2024-06-18 16:00:18,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=3260, skipped=17, lr=[8.095613794298593e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:00:18,733] [INFO] [timer.py:258:stop] epoch=0/micro_step=3260/global_step=3260, RunningAvgSamplesPerSec=4.462259240943176, CurrSamplesPerSec=4.462761412786151, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:00:27,853] [INFO] [logging.py:96:log_dist] [Rank 0] step=3270, skipped=17, lr=[8.08405258976455e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:00:27,854] [INFO] [timer.py:258:stop] epoch=0/micro_step=3270/global_step=3270, RunningAvgSamplesPerSec=4.4622443702465535, CurrSamplesPerSec=4.443864780262364, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:00:36,958] [INFO] [logging.py:96:log_dist] [Rank 0] step=3280, skipped=17, lr=[8.072465881674666e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:00:36,958] [INFO] [timer.py:258:stop] epoch=0/micro_step=3280/global_step=3280, RunningAvgSamplesPerSec=4.46224508857391, CurrSamplesPerSec=4.456646738590499, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:00:46,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=3290, skipped=17, lr=[8.060853784385078e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:00:46,057] [INFO] [timer.py:258:stop] epoch=0/micro_step=3290/global_step=3290, RunningAvgSamplesPerSec=4.4622445608409285, CurrSamplesPerSec=4.4599058904717355, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:00:55,158] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=17, lr=[8.049216412502496e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:00:55,158] [INFO] [timer.py:258:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=4.4622552859853, CurrSamplesPerSec=4.472226013375188, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:00:55,159] [INFO] [RANK 0]  iteration     3300/   10000 | elapsed time per iteration (ms): 910.4 | learning rate 8.048E-05 | total loss 1.358932E-01 | loss 1.358932E-01 | loss scale 16384.0 |speed 263.62 samples/(min*GPU)
[2024-06-18 16:00:55,159] [INFO] [RANK 0] time (ms) | forward: 355.52 | backward: 548.96 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 13.30 | data loader: 0.09
[2024-06-18 16:00:55,160] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:00:55,173] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/3300/mp_rank_00_model_states.pt
[2024-06-18 16:00:55,173] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/3300/mp_rank_00_model_states.pt...
[2024-06-18 16:01:24,591] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/3300/mp_rank_00_model_states.pt.
[2024-06-18 16:01:33,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=3310, skipped=17, lr=[8.037553880883082e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:01:33,655] [INFO] [timer.py:258:stop] epoch=0/micro_step=3310/global_step=3310, RunningAvgSamplesPerSec=4.462363752730944, CurrSamplesPerSec=4.4978612847090504, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:01:42,685] [INFO] [logging.py:96:log_dist] [Rank 0] step=3320, skipped=17, lr=[8.025866304631317e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:01:42,686] [INFO] [timer.py:258:stop] epoch=0/micro_step=3320/global_step=3320, RunningAvgSamplesPerSec=4.462457083615634, CurrSamplesPerSec=4.482728345136515, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:01:51,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=3330, skipped=17, lr=[8.01415379909886e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:01:51,766] [INFO] [timer.py:258:stop] epoch=0/micro_step=3330/global_step=3330, RunningAvgSamplesPerSec=4.462511198683595, CurrSamplesPerSec=4.481763169233868, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:02:00,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=3340, skipped=17, lr=[8.002416479883409e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:02:00,861] [INFO] [timer.py:258:stop] epoch=0/micro_step=3340/global_step=3340, RunningAvgSamplesPerSec=4.4625530166980445, CurrSamplesPerSec=4.478127735901433, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:02:09,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=17, lr=[7.990654462827568e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:02:09,949] [INFO] [timer.py:258:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=4.462573055421292, CurrSamplesPerSec=4.452986915919602, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:02:09,950] [INFO] [RANK 0]  iteration     3350/   10000 | elapsed time per iteration (ms): 1495.8 | learning rate 7.989E-05 | total loss 1.502135E-01 | loss 1.502135E-01 | loss scale 32768.0 |speed 160.45 samples/(min*GPU)
[2024-06-18 16:02:09,951] [INFO] [RANK 0] time (ms) | forward: 355.21 | backward: 545.41 | allreduce: 0.00 | optimizer: 5.43 | batch generator: 14.07 | data loader: 0.10
[2024-06-18 16:02:19,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=3360, skipped=17, lr=[7.978867864017696e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:02:19,038] [INFO] [timer.py:258:stop] epoch=0/micro_step=3360/global_step=3360, RunningAvgSamplesPerSec=4.462575438178084, CurrSamplesPerSec=4.465993852516291, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:02:28,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=3370, skipped=17, lr=[7.967056799782766e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:02:28,142] [INFO] [timer.py:258:stop] epoch=0/micro_step=3370/global_step=3370, RunningAvgSamplesPerSec=4.462564334277558, CurrSamplesPerSec=4.456392225466053, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:02:37,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=3380, skipped=17, lr=[7.955221386693215e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:02:37,233] [INFO] [timer.py:258:stop] epoch=0/micro_step=3380/global_step=3380, RunningAvgSamplesPerSec=4.462553431810141, CurrSamplesPerSec=4.44674693519792, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:02:46,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=3390, skipped=17, lr=[7.943361741559789e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:02:46,305] [INFO] [timer.py:258:stop] epoch=0/micro_step=3390/global_step=3390, RunningAvgSamplesPerSec=4.46255861284065, CurrSamplesPerSec=4.467497027609612, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:02:55,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=17, lr=[7.931477981432399e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:02:55,409] [INFO] [timer.py:258:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=4.462539634469984, CurrSamplesPerSec=4.456882337111509, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:02:55,410] [INFO] [RANK 0]  iteration     3400/   10000 | elapsed time per iteration (ms): 909.2 | learning rate 7.930E-05 | total loss 1.406355E-01 | loss 1.406355E-01 | loss scale 32768.0 |speed 263.97 samples/(min*GPU)
[2024-06-18 16:02:55,411] [INFO] [RANK 0] time (ms) | forward: 354.45 | backward: 548.77 | allreduce: 0.00 | optimizer: 5.21 | batch generator: 11.81 | data loader: 0.09
[2024-06-18 16:03:04,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=3410, skipped=17, lr=[7.91957022359896e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:03:04,522] [INFO] [timer.py:258:stop] epoch=0/micro_step=3410/global_step=3410, RunningAvgSamplesPerSec=4.462513486992233, CurrSamplesPerSec=4.467874169324845, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:03:13,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=3420, skipped=17, lr=[7.907638585584234e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:03:13,645] [INFO] [timer.py:258:stop] epoch=0/micro_step=3420/global_step=3420, RunningAvgSamplesPerSec=4.462497675021953, CurrSamplesPerSec=4.4573133455987355, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:03:22,760] [INFO] [logging.py:96:log_dist] [Rank 0] step=3430, skipped=17, lr=[7.895683185148671e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:03:22,760] [INFO] [timer.py:258:stop] epoch=0/micro_step=3430/global_step=3430, RunningAvgSamplesPerSec=4.462485878798991, CurrSamplesPerSec=4.449049925138546, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:03:31,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=3440, skipped=17, lr=[7.883704140287247e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:03:31,887] [INFO] [timer.py:258:stop] epoch=0/micro_step=3440/global_step=3440, RunningAvgSamplesPerSec=4.462464383304146, CurrSamplesPerSec=4.453728094334889, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:03:41,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=17, lr=[7.871701569228299e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:03:41,022] [INFO] [timer.py:258:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=4.462444871237614, CurrSamplesPerSec=4.453626418899889, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:03:41,023] [INFO] [RANK 0]  iteration     3450/   10000 | elapsed time per iteration (ms): 912.3 | learning rate 7.871E-05 | total loss 1.267694E-01 | loss 1.267694E-01 | loss scale 32768.0 |speed 263.08 samples/(min*GPU)
[2024-06-18 16:03:41,024] [INFO] [RANK 0] time (ms) | forward: 356.91 | backward: 549.35 | allreduce: 0.00 | optimizer: 5.21 | batch generator: 13.94 | data loader: 0.10
[2024-06-18 16:03:50,133] [INFO] [logging.py:96:log_dist] [Rank 0] step=3460, skipped=17, lr=[7.859675590432357e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:03:50,134] [INFO] [timer.py:258:stop] epoch=0/micro_step=3460/global_step=3460, RunningAvgSamplesPerSec=4.462439808659083, CurrSamplesPerSec=4.461222274606407, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:03:59,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=3470, skipped=17, lr=[7.847626322590978e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:03:59,249] [INFO] [timer.py:258:stop] epoch=0/micro_step=3470/global_step=3470, RunningAvgSamplesPerSec=4.462419681383531, CurrSamplesPerSec=4.446884835196759, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:04:08,365] [INFO] [logging.py:96:log_dist] [Rank 0] step=3480, skipped=17, lr=[7.835553884625569e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:04:08,365] [INFO] [timer.py:258:stop] epoch=0/micro_step=3480/global_step=3480, RunningAvgSamplesPerSec=4.462412826044233, CurrSamplesPerSec=4.4566076718967444, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:04:17,470] [INFO] [logging.py:96:log_dist] [Rank 0] step=3490, skipped=17, lr=[7.823458395686219e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:04:17,471] [INFO] [timer.py:258:stop] epoch=0/micro_step=3490/global_step=3490, RunningAvgSamplesPerSec=4.462413132534027, CurrSamplesPerSec=4.455888020197712, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:04:26,567] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=17, lr=[7.811339975150524e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:04:26,567] [INFO] [timer.py:258:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=4.462409158205173, CurrSamplesPerSec=4.446882477859968, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:04:26,570] [INFO] [RANK 0]  iteration     3500/   10000 | elapsed time per iteration (ms): 910.9 | learning rate 7.810E-05 | total loss 1.790807E-01 | loss 1.790807E-01 | loss scale 32768.0 |speed 263.47 samples/(min*GPU)
[2024-06-18 16:04:26,571] [INFO] [RANK 0] time (ms) | forward: 355.80 | backward: 549.18 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 13.49 | data loader: 0.09
[2024-06-18 16:04:35,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=3510, skipped=17, lr=[7.799198742622399e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:04:35,688] [INFO] [timer.py:258:stop] epoch=0/micro_step=3510/global_step=3510, RunningAvgSamplesPerSec=4.462404922671367, CurrSamplesPerSec=4.463634102183101, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:04:44,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=3520, skipped=17, lr=[7.787034817930907e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:04:44,804] [INFO] [timer.py:258:stop] epoch=0/micro_step=3520/global_step=3520, RunningAvgSamplesPerSec=4.462384154958623, CurrSamplesPerSec=4.462907430909884, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:04:53,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=3530, skipped=17, lr=[7.774848321129078e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:04:53,918] [INFO] [timer.py:258:stop] epoch=0/micro_step=3530/global_step=3530, RunningAvgSamplesPerSec=4.462386373414566, CurrSamplesPerSec=4.460446581276681, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:05:03,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=3540, skipped=17, lr=[7.762639372492711e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:05:03,024] [INFO] [timer.py:258:stop] epoch=0/micro_step=3540/global_step=3540, RunningAvgSamplesPerSec=4.462366530504691, CurrSamplesPerSec=4.455625310557893, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:05:12,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=17, lr=[7.750408092519203e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:05:12,139] [INFO] [timer.py:258:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=4.462351043693327, CurrSamplesPerSec=4.468141895301893, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:05:12,140] [INFO] [RANK 0]  iteration     3550/   10000 | elapsed time per iteration (ms): 911.4 | learning rate 7.749E-05 | total loss 1.463525E-01 | loss 1.463525E-01 | loss scale 32768.0 |speed 263.33 samples/(min*GPU)
[2024-06-18 16:05:12,141] [INFO] [RANK 0] time (ms) | forward: 356.23 | backward: 549.19 | allreduce: 0.00 | optimizer: 5.19 | batch generator: 13.62 | data loader: 0.10
[2024-06-18 16:05:21,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=3560, skipped=17, lr=[7.738154601926348e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:05:21,237] [INFO] [timer.py:258:stop] epoch=0/micro_step=3560/global_step=3560, RunningAvgSamplesPerSec=4.462348661331061, CurrSamplesPerSec=4.463558099336767, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:05:30,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=3570, skipped=17, lr=[7.725879021651151e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:05:30,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=3570/global_step=3570, RunningAvgSamplesPerSec=4.462317360328252, CurrSamplesPerSec=4.445273000421285, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:05:39,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=3580, skipped=17, lr=[7.713581472848634e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:05:39,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=3580/global_step=3580, RunningAvgSamplesPerSec=4.462294022554764, CurrSamplesPerSec=4.4540910898617305, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:05:48,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=3590, skipped=17, lr=[7.701262076890639e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:05:48,610] [INFO] [timer.py:258:stop] epoch=0/micro_step=3590/global_step=3590, RunningAvgSamplesPerSec=4.462246485036406, CurrSamplesPerSec=4.407157592010741, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:05:57,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=17, lr=[7.688920955364632e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:05:57,710] [INFO] [timer.py:258:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=4.462230664212353, CurrSamplesPerSec=4.454649296138894, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:05:57,712] [INFO] [RANK 0]  iteration     3600/   10000 | elapsed time per iteration (ms): 911.4 | learning rate 7.688E-05 | total loss 1.580344E-01 | loss 1.580344E-01 | loss scale 32768.0 |speed 263.32 samples/(min*GPU)
[2024-06-18 16:05:57,713] [INFO] [RANK 0] time (ms) | forward: 355.72 | backward: 549.63 | allreduce: 0.00 | optimizer: 5.26 | batch generator: 12.61 | data loader: 0.10
[2024-06-18 16:05:57,713] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:05:57,729] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/3600/mp_rank_00_model_states.pt
[2024-06-18 16:05:57,729] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/3600/mp_rank_00_model_states.pt...
[2024-06-18 16:06:23,866] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/3600/mp_rank_00_model_states.pt.
[2024-06-18 16:06:32,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=3610, skipped=17, lr=[7.676558230072497e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:06:32,931] [INFO] [timer.py:258:stop] epoch=0/micro_step=3610/global_step=3610, RunningAvgSamplesPerSec=4.46230438712523, CurrSamplesPerSec=4.501867055354784, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:06:41,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=3620, skipped=17, lr=[7.664174023029343e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:06:41,966] [INFO] [timer.py:258:stop] epoch=0/micro_step=3620/global_step=3620, RunningAvgSamplesPerSec=4.462378850153745, CurrSamplesPerSec=4.491994061444504, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:06:51,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=3630, skipped=17, lr=[7.651768456462295e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:06:51,001] [INFO] [timer.py:258:stop] epoch=0/micro_step=3630/global_step=3630, RunningAvgSamplesPerSec=4.46244702969856, CurrSamplesPerSec=4.485098740675769, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:07:00,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=3640, skipped=17, lr=[7.639341652809286e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:07:00,059] [INFO] [timer.py:258:stop] epoch=0/micro_step=3640/global_step=3640, RunningAvgSamplesPerSec=4.46249562483427, CurrSamplesPerSec=4.478175547986889, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:07:09,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=17, lr=[7.626893734717851e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:07:09,156] [INFO] [timer.py:258:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=4.46249220227619, CurrSamplesPerSec=4.451947081500603, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:07:09,158] [INFO] [RANK 0]  iteration     3650/   10000 | elapsed time per iteration (ms): 1428.9 | learning rate 7.626E-05 | total loss 1.142552E-01 | loss 1.142552E-01 | loss scale 32768.0 |speed 167.96 samples/(min*GPU)
[2024-06-18 16:07:09,160] [INFO] [RANK 0] time (ms) | forward: 353.46 | backward: 546.04 | allreduce: 0.00 | optimizer: 5.22 | batch generator: 12.31 | data loader: 0.10
[2024-06-18 16:07:18,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=3660, skipped=17, lr=[7.614424825043915e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:07:18,275] [INFO] [timer.py:258:stop] epoch=0/micro_step=3660/global_step=3660, RunningAvgSamplesPerSec=4.4624866175932345, CurrSamplesPerSec=4.4367631218945105, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:07:27,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=3670, skipped=17, lr=[7.601935046850585e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:07:27,366] [INFO] [timer.py:258:stop] epoch=0/micro_step=3670/global_step=3670, RunningAvgSamplesPerSec=4.46245335140699, CurrSamplesPerSec=4.433406478181272, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:07:36,480] [INFO] [logging.py:96:log_dist] [Rank 0] step=3680, skipped=17, lr=[7.589424523406927e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:07:36,481] [INFO] [timer.py:258:stop] epoch=0/micro_step=3680/global_step=3680, RunningAvgSamplesPerSec=4.462426510362647, CurrSamplesPerSec=4.464488124566583, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:07:45,626] [INFO] [logging.py:96:log_dist] [Rank 0] step=3690, skipped=17, lr=[7.57689337818676e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:07:45,626] [INFO] [timer.py:258:stop] epoch=0/micro_step=3690/global_step=3690, RunningAvgSamplesPerSec=4.462377581058188, CurrSamplesPerSec=4.448160520929443, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:07:54,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=17, lr=[7.564341734867424e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:07:54,773] [INFO] [timer.py:258:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=4.462337816742134, CurrSamplesPerSec=4.458285788995083, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:07:54,774] [INFO] [RANK 0]  iteration     3700/   10000 | elapsed time per iteration (ms): 912.3 | learning rate 7.563E-05 | total loss 1.301738E-01 | loss 1.301738E-01 | loss scale 32768.0 |speed 263.07 samples/(min*GPU)
[2024-06-18 16:07:54,774] [INFO] [RANK 0] time (ms) | forward: 356.72 | backward: 549.38 | allreduce: 0.00 | optimizer: 5.34 | batch generator: 12.93 | data loader: 0.14
[2024-06-18 16:08:03,940] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 16:08:03,941] [INFO] [logging.py:96:log_dist] [Rank 0] step=3710, skipped=18, lr=[7.551769717328572e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:08:03,943] [INFO] [timer.py:258:stop] epoch=0/micro_step=3710/global_step=3710, RunningAvgSamplesPerSec=4.462290193622147, CurrSamplesPerSec=4.438610680095825, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:08:04,853] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 16:08:13,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=3720, skipped=19, lr=[7.541697517234972e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:08:13,068] [INFO] [timer.py:258:stop] epoch=0/micro_step=3720/global_step=3720, RunningAvgSamplesPerSec=4.462276901429164, CurrSamplesPerSec=4.451996698925559, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:08:22,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=3730, skipped=19, lr=[7.529089138918801e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:08:22,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=3730/global_step=3730, RunningAvgSamplesPerSec=4.462235909863404, CurrSamplesPerSec=4.429536764655408, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:08:31,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=3740, skipped=19, lr=[7.516460734312006e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:08:31,338] [INFO] [timer.py:258:stop] epoch=0/micro_step=3740/global_step=3740, RunningAvgSamplesPerSec=4.462215471841598, CurrSamplesPerSec=4.429252596677615, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:08:40,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=19, lr=[7.503812428051841e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:08:40,457] [INFO] [timer.py:258:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=4.462186560954623, CurrSamplesPerSec=4.39586541913069, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:08:40,459] [INFO] [RANK 0]  iteration     3750/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 7.503E-05 | total loss 1.369989E-01 | loss 1.369989E-01 | loss scale 32768.0 |speed 262.67 samples/(min*GPU)
[2024-06-18 16:08:40,460] [INFO] [RANK 0] time (ms) | forward: 357.79 | backward: 549.58 | allreduce: 0.00 | optimizer: 5.41 | batch generator: 14.26 | data loader: 0.21
[2024-06-18 16:08:49,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=3760, skipped=19, lr=[7.491144344971983e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:08:49,595] [INFO] [timer.py:258:stop] epoch=0/micro_step=3760/global_step=3760, RunningAvgSamplesPerSec=4.462142631074662, CurrSamplesPerSec=4.458381753423333, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:08:58,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=3770, skipped=19, lr=[7.478456610101298e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:08:58,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=3770/global_step=3770, RunningAvgSamplesPerSec=4.4621223783459945, CurrSamplesPerSec=4.464602177320422, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:09:07,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=3780, skipped=19, lr=[7.465749348662606e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:09:07,862] [INFO] [timer.py:258:stop] epoch=0/micro_step=3780/global_step=3780, RunningAvgSamplesPerSec=4.46210312511799, CurrSamplesPerSec=4.459441190863061, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:09:16,973] [INFO] [logging.py:96:log_dist] [Rank 0] step=3790, skipped=19, lr=[7.45302268607145e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:09:16,974] [INFO] [timer.py:258:stop] epoch=0/micro_step=3790/global_step=3790, RunningAvgSamplesPerSec=4.462096370288781, CurrSamplesPerSec=4.4620065446530015, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:09:26,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=19, lr=[7.440276747934849e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:09:26,076] [INFO] [timer.py:258:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=4.4620941461799495, CurrSamplesPerSec=4.451361206980723, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:09:26,077] [INFO] [RANK 0]  iteration     3800/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 7.439E-05 | total loss 1.543507E-01 | loss 1.543507E-01 | loss scale 32768.0 |speed 263.05 samples/(min*GPU)
[2024-06-18 16:09:26,078] [INFO] [RANK 0] time (ms) | forward: 356.68 | backward: 549.58 | allreduce: 0.00 | optimizer: 5.27 | batch generator: 13.94 | data loader: 0.11
[2024-06-18 16:09:35,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=3810, skipped=19, lr=[7.427511660050066e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:09:35,188] [INFO] [timer.py:258:stop] epoch=0/micro_step=3810/global_step=3810, RunningAvgSamplesPerSec=4.462095331622809, CurrSamplesPerSec=4.439956821003263, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:09:44,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=3820, skipped=19, lr=[7.414727548403366e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:09:44,306] [INFO] [timer.py:258:stop] epoch=0/micro_step=3820/global_step=3820, RunningAvgSamplesPerSec=4.4620951027997675, CurrSamplesPerSec=4.457506379170904, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:09:53,432] [INFO] [logging.py:96:log_dist] [Rank 0] step=3830, skipped=19, lr=[7.40192453916877e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:09:53,433] [INFO] [timer.py:258:stop] epoch=0/micro_step=3830/global_step=3830, RunningAvgSamplesPerSec=4.462081818836523, CurrSamplesPerSec=4.460074249430767, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:10:02,554] [INFO] [logging.py:96:log_dist] [Rank 0] step=3840, skipped=19, lr=[7.38910275870681e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:10:02,555] [INFO] [timer.py:258:stop] epoch=0/micro_step=3840/global_step=3840, RunningAvgSamplesPerSec=4.462086594459031, CurrSamplesPerSec=4.466049727786634, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:10:11,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=19, lr=[7.376262333563284e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:10:11,651] [INFO] [timer.py:258:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=4.4620814380777345, CurrSamplesPerSec=4.465743025444053, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:10:11,652] [INFO] [RANK 0]  iteration     3850/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 7.375E-05 | total loss 1.259798E-01 | loss 1.259798E-01 | loss scale 32768.0 |speed 263.30 samples/(min*GPU)
[2024-06-18 16:10:11,653] [INFO] [RANK 0] time (ms) | forward: 356.12 | backward: 549.42 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 14.31 | data loader: 0.09
[2024-06-18 16:10:20,759] [INFO] [logging.py:96:log_dist] [Rank 0] step=3860, skipped=19, lr=[7.363403390468004e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:10:20,760] [INFO] [timer.py:258:stop] epoch=0/micro_step=3860/global_step=3860, RunningAvgSamplesPerSec=4.462084288314302, CurrSamplesPerSec=4.466464675130576, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:10:29,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=3870, skipped=19, lr=[7.350526056333546e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:10:29,887] [INFO] [timer.py:258:stop] epoch=0/micro_step=3870/global_step=3870, RunningAvgSamplesPerSec=4.462055599296247, CurrSamplesPerSec=4.457932770233286, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:10:39,004] [INFO] [logging.py:96:log_dist] [Rank 0] step=3880, skipped=19, lr=[7.337630458254e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:10:39,005] [INFO] [timer.py:258:stop] epoch=0/micro_step=3880/global_step=3880, RunningAvgSamplesPerSec=4.462046569933479, CurrSamplesPerSec=4.463948829016757, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:10:48,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=3890, skipped=19, lr=[7.324716723503712e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:10:48,142] [INFO] [timer.py:258:stop] epoch=0/micro_step=3890/global_step=3890, RunningAvgSamplesPerSec=4.462030398098256, CurrSamplesPerSec=4.451918729182897, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:10:57,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=19, lr=[7.311784979536031e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:10:57,279] [INFO] [timer.py:258:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=4.462017296815615, CurrSamplesPerSec=4.462883687475012, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:10:57,281] [INFO] [RANK 0]  iteration     3900/   10000 | elapsed time per iteration (ms): 912.6 | learning rate 7.310E-05 | total loss 1.155392E-01 | loss 1.155392E-01 | loss scale 32768.0 |speed 262.99 samples/(min*GPU)
[2024-06-18 16:10:57,282] [INFO] [RANK 0] time (ms) | forward: 357.10 | backward: 549.40 | allreduce: 0.00 | optimizer: 5.24 | batch generator: 14.52 | data loader: 0.10
[2024-06-18 16:10:57,283] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:10:57,297] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/3900/mp_rank_00_model_states.pt
[2024-06-18 16:10:57,297] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/3900/mp_rank_00_model_states.pt...
[2024-06-18 16:11:26,645] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/3900/mp_rank_00_model_states.pt.
[2024-06-18 16:11:35,702] [INFO] [logging.py:96:log_dist] [Rank 0] step=3910, skipped=19, lr=[7.298835353982049e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:11:35,702] [INFO] [timer.py:258:stop] epoch=0/micro_step=3910/global_step=3910, RunningAvgSamplesPerSec=4.462129869693377, CurrSamplesPerSec=4.509269726490792, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:11:44,737] [INFO] [logging.py:96:log_dist] [Rank 0] step=3920, skipped=19, lr=[7.285867974649343e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:11:44,738] [INFO] [timer.py:258:stop] epoch=0/micro_step=3920/global_step=3920, RunningAvgSamplesPerSec=4.462219428829319, CurrSamplesPerSec=4.496796773776805, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:11:53,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=3930, skipped=19, lr=[7.272882969520711e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:11:53,795] [INFO] [timer.py:258:stop] epoch=0/micro_step=3930/global_step=3930, RunningAvgSamplesPerSec=4.462290071299502, CurrSamplesPerSec=4.487932600289704, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:12:02,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=3940, skipped=19, lr=[7.259880466752911e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:12:02,871] [INFO] [timer.py:258:stop] epoch=0/micro_step=3940/global_step=3940, RunningAvgSamplesPerSec=4.462348781933007, CurrSamplesPerSec=4.4751104692817245, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:12:12,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=19, lr=[7.246860594675397e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:12:12,046] [INFO] [timer.py:258:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=4.462352509510835, CurrSamplesPerSec=4.467749241514994, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:12:12,047] [INFO] [RANK 0]  iteration     3950/   10000 | elapsed time per iteration (ms): 1495.3 | learning rate 7.246E-05 | total loss 1.315022E-01 | loss 1.315022E-01 | loss scale 32768.0 |speed 160.50 samples/(min*GPU)
[2024-06-18 16:12:12,048] [INFO] [RANK 0] time (ms) | forward: 356.25 | backward: 545.33 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 15.75 | data loader: 0.10
[2024-06-18 16:12:21,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=3960, skipped=19, lr=[7.23382348178905e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:12:21,147] [INFO] [timer.py:258:stop] epoch=0/micro_step=3960/global_step=3960, RunningAvgSamplesPerSec=4.462370193436911, CurrSamplesPerSec=4.471471515491369, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:12:30,246] [INFO] [logging.py:96:log_dist] [Rank 0] step=3970, skipped=19, lr=[7.22076925676491e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:12:30,247] [INFO] [timer.py:258:stop] epoch=0/micro_step=3970/global_step=3970, RunningAvgSamplesPerSec=4.462389493045529, CurrSamplesPerSec=4.474473135371272, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:12:39,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=3980, skipped=19, lr=[7.20769804844291e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:12:39,336] [INFO] [timer.py:258:stop] epoch=0/micro_step=3980/global_step=3980, RunningAvgSamplesPerSec=4.462387296253896, CurrSamplesPerSec=4.469153594176669, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:12:48,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=3990, skipped=19, lr=[7.194609985830596e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:12:48,431] [INFO] [timer.py:258:stop] epoch=0/micro_step=3990/global_step=3990, RunningAvgSamplesPerSec=4.462404202751482, CurrSamplesPerSec=4.473506739370992, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:12:57,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=19, lr=[7.181505198101863e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:12:57,525] [INFO] [timer.py:258:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=4.4624231641072285, CurrSamplesPerSec=4.467550561199356, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:12:57,527] [INFO] [RANK 0]  iteration     4000/   10000 | elapsed time per iteration (ms): 909.6 | learning rate 7.180E-05 | total loss 1.708834E-01 | loss 1.708834E-01 | loss scale 32768.0 |speed 263.85 samples/(min*GPU)
[2024-06-18 16:12:57,528] [INFO] [RANK 0] time (ms) | forward: 355.29 | backward: 548.42 | allreduce: 0.00 | optimizer: 5.13 | batch generator: 13.80 | data loader: 0.10
[2024-06-18 16:13:04,191] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 16:13:04,191] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 16:13:04,191] [INFO] [RANK 0]  validation loss at iteration 4000 | loss: 2.095520E-01 | PPL: 1.233125E+00 loss 2.095947E-01 |
[2024-06-18 16:13:04,191] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 16:13:13,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=4010, skipped=19, lr=[7.168383814595676e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:13:13,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=4010/global_step=4010, RunningAvgSamplesPerSec=4.462417571132169, CurrSamplesPerSec=4.439888672091569, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:13:22,426] [INFO] [logging.py:96:log_dist] [Rank 0] step=4020, skipped=19, lr=[7.155245964814794e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:13:22,427] [INFO] [timer.py:258:stop] epoch=0/micro_step=4020/global_step=4020, RunningAvgSamplesPerSec=4.46239949972434, CurrSamplesPerSec=4.465283050906552, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:13:31,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=4030, skipped=19, lr=[7.142091778424489e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:13:31,536] [INFO] [timer.py:258:stop] epoch=0/micro_step=4030/global_step=4030, RunningAvgSamplesPerSec=4.462403305600681, CurrSamplesPerSec=4.451274992498171, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:13:40,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=4040, skipped=19, lr=[7.12892138525127e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:13:40,678] [INFO] [timer.py:258:stop] epoch=0/micro_step=4040/global_step=4040, RunningAvgSamplesPerSec=4.462381717318571, CurrSamplesPerSec=4.46683093913532, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:13:49,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=19, lr=[7.1157349152816e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:13:49,808] [INFO] [timer.py:258:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=4.462363898897102, CurrSamplesPerSec=4.452468119629381, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:13:49,809] [INFO] [RANK 0]  iteration     4050/   10000 | elapsed time per iteration (ms): 1045.6 | learning rate 7.114E-05 | total loss 1.498225E-01 | loss 1.498225E-01 | loss scale 32768.0 |speed 229.52 samples/(min*GPU)
[2024-06-18 16:13:49,810] [INFO] [RANK 0] time (ms) | forward: 357.29 | backward: 549.15 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 17.37 | data loader: 0.16
[2024-06-18 16:13:58,951] [INFO] [logging.py:96:log_dist] [Rank 0] step=4060, skipped=19, lr=[7.102532498660615e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:13:58,951] [INFO] [timer.py:258:stop] epoch=0/micro_step=4060/global_step=4060, RunningAvgSamplesPerSec=4.4623584087121815, CurrSamplesPerSec=4.44926702206598, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:14:08,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=4070, skipped=19, lr=[7.089314265690837e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:14:08,081] [INFO] [timer.py:258:stop] epoch=0/micro_step=4070/global_step=4070, RunningAvgSamplesPerSec=4.4623431377220255, CurrSamplesPerSec=4.440787700947225, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:14:17,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=4080, skipped=19, lr=[7.07608034683089e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:14:17,188] [INFO] [timer.py:258:stop] epoch=0/micro_step=4080/global_step=4080, RunningAvgSamplesPerSec=4.462325769974861, CurrSamplesPerSec=4.44496678968745, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:14:26,290] [INFO] [logging.py:96:log_dist] [Rank 0] step=4090, skipped=19, lr=[7.062830872694207e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:14:26,291] [INFO] [timer.py:258:stop] epoch=0/micro_step=4090/global_step=4090, RunningAvgSamplesPerSec=4.462320016562383, CurrSamplesPerSec=4.466853535310506, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:14:35,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=19, lr=[7.049565974047752e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:14:35,412] [INFO] [timer.py:258:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=4.46229771201183, CurrSamplesPerSec=4.455329503451063, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:14:35,413] [INFO] [RANK 0]  iteration     4100/   10000 | elapsed time per iteration (ms): 912.1 | learning rate 7.048E-05 | total loss 1.416440E-01 | loss 1.416440E-01 | loss scale 32768.0 |speed 263.13 samples/(min*GPU)
[2024-06-18 16:14:35,414] [INFO] [RANK 0] time (ms) | forward: 356.77 | backward: 549.33 | allreduce: 0.00 | optimizer: 5.18 | batch generator: 14.01 | data loader: 0.09
[2024-06-18 16:14:44,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=4110, skipped=19, lr=[7.036285781810718e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:14:44,517] [INFO] [timer.py:258:stop] epoch=0/micro_step=4110/global_step=4110, RunningAvgSamplesPerSec=4.462292156679313, CurrSamplesPerSec=4.4608249056371, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:14:46,333] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 16:14:47,241] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 16:14:53,621] [INFO] [logging.py:96:log_dist] [Rank 0] step=4120, skipped=21, lr=[7.025650704709967e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:14:53,621] [INFO] [timer.py:258:stop] epoch=0/micro_step=4120/global_step=4120, RunningAvgSamplesPerSec=4.46228206886747, CurrSamplesPerSec=4.463428662946703, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:15:02,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=4130, skipped=21, lr=[7.01234331440724e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:15:02,754] [INFO] [timer.py:258:stop] epoch=0/micro_step=4130/global_step=4130, RunningAvgSamplesPerSec=4.462268686815687, CurrSamplesPerSec=4.463527223919749, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:15:11,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=4140, skipped=21, lr=[6.999020997886558e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:15:11,846] [INFO] [timer.py:258:stop] epoch=0/micro_step=4140/global_step=4140, RunningAvgSamplesPerSec=4.462254174374001, CurrSamplesPerSec=4.457232821197845, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:15:20,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=21, lr=[6.985683886633806e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:15:20,976] [INFO] [timer.py:258:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=4.462240349730885, CurrSamplesPerSec=4.466358850288791, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:15:20,978] [INFO] [RANK 0]  iteration     4150/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 6.984E-05 | total loss 1.501663E-01 | loss 1.501663E-01 | loss scale 32768.0 |speed 263.36 samples/(min*GPU)
[2024-06-18 16:15:20,979] [INFO] [RANK 0] time (ms) | forward: 356.24 | backward: 549.23 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 13.37 | data loader: 0.09
[2024-06-18 16:15:30,079] [INFO] [logging.py:96:log_dist] [Rank 0] step=4160, skipped=21, lr=[6.97233211228089e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:15:30,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=4160/global_step=4160, RunningAvgSamplesPerSec=4.462233672615721, CurrSamplesPerSec=4.454823172854313, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:15:39,184] [INFO] [logging.py:96:log_dist] [Rank 0] step=4170, skipped=21, lr=[6.958965806604427e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:15:39,184] [INFO] [timer.py:258:stop] epoch=0/micro_step=4170/global_step=4170, RunningAvgSamplesPerSec=4.462238081663442, CurrSamplesPerSec=4.467453012063592, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:15:48,300] [INFO] [logging.py:96:log_dist] [Rank 0] step=4180, skipped=21, lr=[6.945585101524465e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:15:48,301] [INFO] [timer.py:258:stop] epoch=0/micro_step=4180/global_step=4180, RunningAvgSamplesPerSec=4.462218025939137, CurrSamplesPerSec=4.447226675488375, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:15:57,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=4190, skipped=21, lr=[6.932190129103154e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:15:57,434] [INFO] [timer.py:258:stop] epoch=0/micro_step=4190/global_step=4190, RunningAvgSamplesPerSec=4.462210763670918, CurrSamplesPerSec=4.46542923409173, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:16:06,569] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=21, lr=[6.918781021543469e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:16:06,569] [INFO] [timer.py:258:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=4.462206418506379, CurrSamplesPerSec=4.464355070385132, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:16:06,571] [INFO] [RANK 0]  iteration     4200/   10000 | elapsed time per iteration (ms): 911.9 | learning rate 6.917E-05 | total loss 1.482155E-01 | loss 1.482155E-01 | loss scale 32768.0 |speed 263.20 samples/(min*GPU)
[2024-06-18 16:16:06,572] [INFO] [RANK 0] time (ms) | forward: 356.75 | backward: 549.18 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 14.30 | data loader: 0.09
[2024-06-18 16:16:06,573] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:16:06,588] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/4200/mp_rank_00_model_states.pt
[2024-06-18 16:16:06,588] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/4200/mp_rank_00_model_states.pt...
[2024-06-18 16:16:36,615] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/4200/mp_rank_00_model_states.pt.
[2024-06-18 16:16:45,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=4210, skipped=21, lr=[6.905357911187884e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:16:45,666] [INFO] [timer.py:258:stop] epoch=0/micro_step=4210/global_step=4210, RunningAvgSamplesPerSec=4.462301259674817, CurrSamplesPerSec=4.507046854469957, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:16:54,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=4220, skipped=21, lr=[6.891920930517085e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:16:54,716] [INFO] [timer.py:258:stop] epoch=0/micro_step=4220/global_step=4220, RunningAvgSamplesPerSec=4.462385404392168, CurrSamplesPerSec=4.491971210200769, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:17:03,769] [INFO] [logging.py:96:log_dist] [Rank 0] step=4230, skipped=21, lr=[6.87847021214864e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:17:03,769] [INFO] [timer.py:258:stop] epoch=0/micro_step=4230/global_step=4230, RunningAvgSamplesPerSec=4.462449302463299, CurrSamplesPerSec=4.483651998041617, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:17:12,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=4240, skipped=21, lr=[6.865005888835714e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:17:12,831] [INFO] [timer.py:258:stop] epoch=0/micro_step=4240/global_step=4240, RunningAvgSamplesPerSec=4.462497722898481, CurrSamplesPerSec=4.4857055236539916, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:17:21,937] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=21, lr=[6.851528093465738e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:17:21,937] [INFO] [timer.py:258:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=4.462502287285888, CurrSamplesPerSec=4.460807114652461, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:17:21,939] [INFO] [RANK 0]  iteration     4250/   10000 | elapsed time per iteration (ms): 1507.4 | learning rate 6.850E-05 | total loss 1.218289E-01 | loss 1.218289E-01 | loss scale 32768.0 |speed 159.22 samples/(min*GPU)
[2024-06-18 16:17:21,940] [INFO] [RANK 0] time (ms) | forward: 354.93 | backward: 545.22 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 14.11 | data loader: 0.10
[2024-06-18 16:17:31,006] [INFO] [logging.py:96:log_dist] [Rank 0] step=4260, skipped=21, lr=[6.838036959059116e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:17:31,007] [INFO] [timer.py:258:stop] epoch=0/micro_step=4260/global_step=4260, RunningAvgSamplesPerSec=4.462518383528884, CurrSamplesPerSec=4.474452848696526, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:17:40,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=4270, skipped=21, lr=[6.824532618767894e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:17:40,087] [INFO] [timer.py:258:stop] epoch=0/micro_step=4270/global_step=4270, RunningAvgSamplesPerSec=4.462537293204977, CurrSamplesPerSec=4.471364261581436, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:17:49,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=4280, skipped=21, lr=[6.811015205874461e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:17:49,193] [INFO] [timer.py:258:stop] epoch=0/micro_step=4280/global_step=4280, RunningAvgSamplesPerSec=4.462527152295087, CurrSamplesPerSec=4.452884092470803, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:17:58,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=4290, skipped=21, lr=[6.797484853790224e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:17:58,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=4290/global_step=4290, RunningAvgSamplesPerSec=4.462514303897438, CurrSamplesPerSec=4.460228392017578, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:18:07,398] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=21, lr=[6.783941696054296e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:18:07,399] [INFO] [timer.py:258:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=4.462506605661347, CurrSamplesPerSec=4.460816603159942, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:18:07,400] [INFO] [RANK 0]  iteration     4300/   10000 | elapsed time per iteration (ms): 909.2 | learning rate 6.783E-05 | total loss 1.301921E-01 | loss 1.301921E-01 | loss scale 32768.0 |speed 263.97 samples/(min*GPU)
[2024-06-18 16:18:07,400] [INFO] [RANK 0] time (ms) | forward: 354.53 | backward: 548.73 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 12.34 | data loader: 0.09
[2024-06-18 16:18:16,505] [INFO] [logging.py:96:log_dist] [Rank 0] step=4310, skipped=21, lr=[6.770385866332176e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:18:16,506] [INFO] [timer.py:258:stop] epoch=0/micro_step=4310/global_step=4310, RunningAvgSamplesPerSec=4.462497745484998, CurrSamplesPerSec=4.453064923082967, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:18:25,617] [INFO] [logging.py:96:log_dist] [Rank 0] step=4320, skipped=21, lr=[6.75681749841443e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:18:25,618] [INFO] [timer.py:258:stop] epoch=0/micro_step=4320/global_step=4320, RunningAvgSamplesPerSec=4.462488395853048, CurrSamplesPerSec=4.4366493137919125, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:18:34,725] [INFO] [logging.py:96:log_dist] [Rank 0] step=4330, skipped=21, lr=[6.743236726215373e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:18:34,726] [INFO] [timer.py:258:stop] epoch=0/micro_step=4330/global_step=4330, RunningAvgSamplesPerSec=4.462481217365251, CurrSamplesPerSec=4.459224285169795, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:18:43,853] [INFO] [logging.py:96:log_dist] [Rank 0] step=4340, skipped=21, lr=[6.729643683771743e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:18:43,854] [INFO] [timer.py:258:stop] epoch=0/micro_step=4340/global_step=4340, RunningAvgSamplesPerSec=4.462473141974615, CurrSamplesPerSec=4.46260709507356, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:18:52,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=21, lr=[6.716038505241382e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:18:52,972] [INFO] [timer.py:258:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=4.462450347280667, CurrSamplesPerSec=4.450941976137613, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:18:52,973] [INFO] [RANK 0]  iteration     4350/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 6.715E-05 | total loss 1.177128E-01 | loss 1.177128E-01 | loss scale 32768.0 |speed 263.31 samples/(min*GPU)
[2024-06-18 16:18:52,973] [INFO] [RANK 0] time (ms) | forward: 356.32 | backward: 549.22 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 13.41 | data loader: 0.10
[2024-06-18 16:19:02,070] [INFO] [logging.py:96:log_dist] [Rank 0] step=4360, skipped=21, lr=[6.702421324901911e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:19:02,070] [INFO] [timer.py:258:stop] epoch=0/micro_step=4360/global_step=4360, RunningAvgSamplesPerSec=4.462438852879004, CurrSamplesPerSec=4.454954476511749, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:19:11,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=4370, skipped=21, lr=[6.688792277149397e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:19:11,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=4370/global_step=4370, RunningAvgSamplesPerSec=4.462424557173275, CurrSamplesPerSec=4.450182837905298, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:19:20,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=4380, skipped=21, lr=[6.675151496497043e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:19:20,312] [INFO] [timer.py:258:stop] epoch=0/micro_step=4380/global_step=4380, RunningAvgSamplesPerSec=4.46241508835157, CurrSamplesPerSec=4.466423058021488, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:19:29,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=4390, skipped=21, lr=[6.661499117573847e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:19:29,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=4390/global_step=4390, RunningAvgSamplesPerSec=4.4624178991980985, CurrSamplesPerSec=4.47317038835055, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:19:38,476] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=21, lr=[6.647835275123276e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:19:38,477] [INFO] [timer.py:258:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=4.462414946193935, CurrSamplesPerSec=4.461540220757902, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:19:38,479] [INFO] [RANK 0]  iteration     4400/   10000 | elapsed time per iteration (ms): 910.1 | learning rate 6.646E-05 | total loss 1.608612E-01 | loss 1.608612E-01 | loss scale 32768.0 |speed 263.70 samples/(min*GPU)
[2024-06-18 16:19:38,480] [INFO] [RANK 0] time (ms) | forward: 355.24 | backward: 549.00 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 12.55 | data loader: 0.10
[2024-06-18 16:19:47,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=4410, skipped=21, lr=[6.634160104001941e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:19:47,591] [INFO] [timer.py:258:stop] epoch=0/micro_step=4410/global_step=4410, RunningAvgSamplesPerSec=4.4624079162105454, CurrSamplesPerSec=4.453988215414472, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:19:56,682] [INFO] [logging.py:96:log_dist] [Rank 0] step=4420, skipped=21, lr=[6.620473739178257e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:19:56,682] [INFO] [timer.py:258:stop] epoch=0/micro_step=4420/global_step=4420, RunningAvgSamplesPerSec=4.46240485599141, CurrSamplesPerSec=4.466678718228538, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:20:05,797] [INFO] [logging.py:96:log_dist] [Rank 0] step=4430, skipped=21, lr=[6.60677631573112e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:20:05,798] [INFO] [timer.py:258:stop] epoch=0/micro_step=4430/global_step=4430, RunningAvgSamplesPerSec=4.462408339484358, CurrSamplesPerSec=4.464988336675534, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:20:14,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=4440, skipped=21, lr=[6.593067968848572e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:20:14,908] [INFO] [timer.py:258:stop] epoch=0/micro_step=4440/global_step=4440, RunningAvgSamplesPerSec=4.462408994047494, CurrSamplesPerSec=4.462306799657319, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:20:24,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=21, lr=[6.579348833826461e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:20:24,017] [INFO] [timer.py:258:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=4.462404113772871, CurrSamplesPerSec=4.466149593454381, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:20:24,018] [INFO] [RANK 0]  iteration     4450/   10000 | elapsed time per iteration (ms): 910.8 | learning rate 6.578E-05 | total loss 1.140722E-01 | loss 1.140722E-01 | loss scale 32768.0 |speed 263.51 samples/(min*GPU)
[2024-06-18 16:20:24,019] [INFO] [RANK 0] time (ms) | forward: 355.70 | backward: 549.17 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 13.53 | data loader: 0.09
[2024-06-18 16:20:33,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=4460, skipped=21, lr=[6.565619046067112e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:20:33,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=4460/global_step=4460, RunningAvgSamplesPerSec=4.462402563997549, CurrSamplesPerSec=4.455620577334974, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:20:42,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=4470, skipped=21, lr=[6.551878741077984e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:20:42,251] [INFO] [timer.py:258:stop] epoch=0/micro_step=4470/global_step=4470, RunningAvgSamplesPerSec=4.462396526160267, CurrSamplesPerSec=4.43630323224305, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:20:51,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=4480, skipped=21, lr=[6.538128054470342e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:20:51,381] [INFO] [timer.py:258:stop] epoch=0/micro_step=4480/global_step=4480, RunningAvgSamplesPerSec=4.462374480774871, CurrSamplesPerSec=4.419763890648804, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:21:00,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=4490, skipped=21, lr=[6.524367121957913e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:21:00,516] [INFO] [timer.py:258:stop] epoch=0/micro_step=4490/global_step=4490, RunningAvgSamplesPerSec=4.462366814569152, CurrSamplesPerSec=4.453199669166323, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:21:09,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=21, lr=[6.510596079355544e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:21:09,637] [INFO] [timer.py:258:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=4.462358432295034, CurrSamplesPerSec=4.4538546039738796, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:21:09,638] [INFO] [RANK 0]  iteration     4500/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 6.509E-05 | total loss 1.256869E-01 | loss 1.256869E-01 | loss scale 32768.0 |speed 263.04 samples/(min*GPU)
[2024-06-18 16:21:09,639] [INFO] [RANK 0] time (ms) | forward: 357.11 | backward: 549.17 | allreduce: 0.00 | optimizer: 5.34 | batch generator: 14.45 | data loader: 0.13
[2024-06-18 16:21:09,639] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:21:09,653] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/4500/mp_rank_00_model_states.pt
[2024-06-18 16:21:09,653] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/4500/mp_rank_00_model_states.pt...
[2024-06-18 16:21:38,370] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/4500/mp_rank_00_model_states.pt.
[2024-06-18 16:21:47,443] [INFO] [logging.py:96:log_dist] [Rank 0] step=4510, skipped=21, lr=[6.496815062577865e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:21:47,444] [INFO] [timer.py:258:stop] epoch=0/micro_step=4510/global_step=4510, RunningAvgSamplesPerSec=4.462429240849135, CurrSamplesPerSec=4.487236401323928, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:21:51,067] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 16:21:51,983] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 16:21:56,522] [INFO] [logging.py:96:log_dist] [Rank 0] step=4520, skipped=23, lr=[6.485783159147009e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:21:56,522] [INFO] [timer.py:258:stop] epoch=0/micro_step=4520/global_step=4520, RunningAvgSamplesPerSec=4.462472007392135, CurrSamplesPerSec=4.49006575371355, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:22:05,597] [INFO] [logging.py:96:log_dist] [Rank 0] step=4530, skipped=23, lr=[6.471984531672012e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:22:05,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=4530/global_step=4530, RunningAvgSamplesPerSec=4.462512733047866, CurrSamplesPerSec=4.478644160459236, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:22:14,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=4540, skipped=23, lr=[6.458176311102093e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:22:14,683] [INFO] [timer.py:258:stop] epoch=0/micro_step=4540/global_step=4540, RunningAvgSamplesPerSec=4.4625324154004025, CurrSamplesPerSec=4.470452811043797, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:22:23,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=23, lr=[6.444358633718815e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:22:23,752] [INFO] [timer.py:258:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=4.462558118057131, CurrSamplesPerSec=4.467695703163696, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:22:23,753] [INFO] [RANK 0]  iteration     4550/   10000 | elapsed time per iteration (ms): 1482.3 | learning rate 6.443E-05 | total loss 1.615483E-01 | loss 1.615483E-01 | loss scale 32768.0 |speed 161.91 samples/(min*GPU)
[2024-06-18 16:22:23,754] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 545.79 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 14.09 | data loader: 0.25
[2024-06-18 16:22:32,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=4560, skipped=23, lr=[6.430531635897073e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:22:32,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=4560/global_step=4560, RunningAvgSamplesPerSec=4.462572184560895, CurrSamplesPerSec=4.479331715914118, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:22:41,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=4570, skipped=23, lr=[6.416695454103757e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:22:41,932] [INFO] [timer.py:258:stop] epoch=0/micro_step=4570/global_step=4570, RunningAvgSamplesPerSec=4.462573035340726, CurrSamplesPerSec=4.460746626366165, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:22:51,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=4580, skipped=23, lr=[6.402850224896394e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:22:51,042] [INFO] [timer.py:258:stop] epoch=0/micro_step=4580/global_step=4580, RunningAvgSamplesPerSec=4.462567151151024, CurrSamplesPerSec=4.4531370230431016, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:23:00,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=4590, skipped=23, lr=[6.388996084921807e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:23:00,156] [INFO] [timer.py:258:stop] epoch=0/micro_step=4590/global_step=4590, RunningAvgSamplesPerSec=4.4625648895734, CurrSamplesPerSec=4.450651513194074, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:23:09,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=23, lr=[6.375133170914762e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:23:09,268] [INFO] [timer.py:258:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=4.462572954231332, CurrSamplesPerSec=4.470436134365559, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:23:09,269] [INFO] [RANK 0]  iteration     4600/   10000 | elapsed time per iteration (ms): 910.3 | learning rate 6.374E-05 | total loss 1.282257E-01 | loss 1.282257E-01 | loss scale 32768.0 |speed 263.65 samples/(min*GPU)
[2024-06-18 16:23:09,269] [INFO] [RANK 0] time (ms) | forward: 355.73 | backward: 548.72 | allreduce: 0.00 | optimizer: 5.12 | batch generator: 13.73 | data loader: 0.11
[2024-06-18 16:23:18,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=4610, skipped=23, lr=[6.361261619696627e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:23:18,369] [INFO] [timer.py:258:stop] epoch=0/micro_step=4610/global_step=4610, RunningAvgSamplesPerSec=4.46257844169756, CurrSamplesPerSec=4.465573049654074, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:23:27,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=4620, skipped=23, lr=[6.347381568174011e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:23:27,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=4620/global_step=4620, RunningAvgSamplesPerSec=4.462574024084565, CurrSamplesPerSec=4.451502936675221, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:23:36,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=4630, skipped=23, lr=[6.33349315333742e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:23:36,563] [INFO] [timer.py:258:stop] epoch=0/micro_step=4630/global_step=4630, RunningAvgSamplesPerSec=4.462573433304968, CurrSamplesPerSec=4.455435989484701, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:23:45,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=4640, skipped=23, lr=[6.3195965122599e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:23:45,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=4640/global_step=4640, RunningAvgSamplesPerSec=4.462558763887831, CurrSamplesPerSec=4.469301221483165, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:23:54,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=23, lr=[6.305691782095686e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:23:54,781] [INFO] [timer.py:258:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=4.462555895793097, CurrSamplesPerSec=4.466107982216723, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:23:54,782] [INFO] [RANK 0]  iteration     4650/   10000 | elapsed time per iteration (ms): 910.3 | learning rate 6.304E-05 | total loss 1.350919E-01 | loss 1.350919E-01 | loss scale 32768.0 |speed 263.66 samples/(min*GPU)
[2024-06-18 16:23:54,782] [INFO] [RANK 0] time (ms) | forward: 355.21 | backward: 549.19 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 13.06 | data loader: 0.09
[2024-06-18 16:24:03,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=4660, skipped=23, lr=[6.291779100078856e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:24:03,888] [INFO] [timer.py:258:stop] epoch=0/micro_step=4660/global_step=4660, RunningAvgSamplesPerSec=4.462553401108247, CurrSamplesPerSec=4.467514871996975, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:24:13,006] [INFO] [logging.py:96:log_dist] [Rank 0] step=4670, skipped=23, lr=[6.277858603521962e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:24:13,006] [INFO] [timer.py:258:stop] epoch=0/micro_step=4670/global_step=4670, RunningAvgSamplesPerSec=4.462559758771702, CurrSamplesPerSec=4.467743292745929, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:24:22,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=4680, skipped=23, lr=[6.263930429814686e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:24:22,126] [INFO] [timer.py:258:stop] epoch=0/micro_step=4680/global_step=4680, RunningAvgSamplesPerSec=4.462566090286998, CurrSamplesPerSec=4.466625205530802, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:24:31,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=4690, skipped=23, lr=[6.249994716422478e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:24:31,223] [INFO] [timer.py:258:stop] epoch=0/micro_step=4690/global_step=4690, RunningAvgSamplesPerSec=4.462569913200462, CurrSamplesPerSec=4.469717964081268, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:24:40,336] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=23, lr=[6.236051600885203e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:24:40,336] [INFO] [timer.py:258:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=4.462566289356154, CurrSamplesPerSec=4.467344761302221, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:24:40,337] [INFO] [RANK 0]  iteration     4700/   10000 | elapsed time per iteration (ms): 911.1 | learning rate 6.235E-05 | total loss 1.347533E-01 | loss 1.347533E-01 | loss scale 32768.0 |speed 263.41 samples/(min*GPU)
[2024-06-18 16:24:40,338] [INFO] [RANK 0] time (ms) | forward: 356.03 | backward: 549.25 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 14.45 | data loader: 0.09
[2024-06-18 16:24:49,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=4710, skipped=23, lr=[6.222101220815784e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:24:49,451] [INFO] [timer.py:258:stop] epoch=0/micro_step=4710/global_step=4710, RunningAvgSamplesPerSec=4.4625504885336875, CurrSamplesPerSec=4.451948262855011, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:24:58,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=4720, skipped=23, lr=[6.208143713898841e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:24:58,571] [INFO] [timer.py:258:stop] epoch=0/micro_step=4720/global_step=4720, RunningAvgSamplesPerSec=4.462543782962851, CurrSamplesPerSec=4.457378477757231, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:25:07,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=4730, skipped=23, lr=[6.194179217889329e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:25:07,681] [INFO] [timer.py:258:stop] epoch=0/micro_step=4730/global_step=4730, RunningAvgSamplesPerSec=4.462546200460786, CurrSamplesPerSec=4.461705143513631, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:25:16,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=4740, skipped=23, lr=[6.18020787061119e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:25:16,792] [INFO] [timer.py:258:stop] epoch=0/micro_step=4740/global_step=4740, RunningAvgSamplesPerSec=4.462539131420343, CurrSamplesPerSec=4.460030380026807, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:25:25,919] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=23, lr=[6.166229809955979e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:25:25,919] [INFO] [timer.py:258:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=4.462525762803334, CurrSamplesPerSec=4.456579260186023, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:25:25,920] [INFO] [RANK 0]  iteration     4750/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 6.165E-05 | total loss 1.132280E-01 | loss 1.132280E-01 | loss scale 32768.0 |speed 263.26 samples/(min*GPU)
[2024-06-18 16:25:25,920] [INFO] [RANK 0] time (ms) | forward: 356.48 | backward: 549.27 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 13.98 | data loader: 0.09
[2024-06-18 16:25:35,025] [INFO] [logging.py:96:log_dist] [Rank 0] step=4760, skipped=23, lr=[6.152245173881511e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:25:35,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=4760/global_step=4760, RunningAvgSamplesPerSec=4.462521243470092, CurrSamplesPerSec=4.463605600812415, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:25:44,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=4770, skipped=23, lr=[6.138254100410498e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:25:44,155] [INFO] [timer.py:258:stop] epoch=0/micro_step=4770/global_step=4770, RunningAvgSamplesPerSec=4.462517410026891, CurrSamplesPerSec=4.458801202003126, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:25:53,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=4780, skipped=23, lr=[6.124256727629188e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:25:53,249] [INFO] [timer.py:258:stop] epoch=0/micro_step=4780/global_step=4780, RunningAvgSamplesPerSec=4.462511970678574, CurrSamplesPerSec=4.463888255498105, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:26:02,392] [INFO] [logging.py:96:log_dist] [Rank 0] step=4790, skipped=23, lr=[6.110253193685998e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:26:02,393] [INFO] [timer.py:258:stop] epoch=0/micro_step=4790/global_step=4790, RunningAvgSamplesPerSec=4.462488117513002, CurrSamplesPerSec=4.446459376390577, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:26:11,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=23, lr=[6.096243636790157e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:26:11,512] [INFO] [timer.py:258:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=4.462465431487202, CurrSamplesPerSec=4.449728423391632, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:26:11,513] [INFO] [RANK 0]  iteration     4800/   10000 | elapsed time per iteration (ms): 911.9 | learning rate 6.095E-05 | total loss 1.649391E-01 | loss 1.649391E-01 | loss scale 32768.0 |speed 263.19 samples/(min*GPU)
[2024-06-18 16:26:11,514] [INFO] [RANK 0] time (ms) | forward: 356.56 | backward: 549.32 | allreduce: 0.00 | optimizer: 5.24 | batch generator: 13.81 | data loader: 0.10
[2024-06-18 16:26:11,514] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:26:11,534] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/4800/mp_rank_00_model_states.pt
[2024-06-18 16:26:11,534] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/4800/mp_rank_00_model_states.pt...
[2024-06-18 16:26:41,062] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/4800/mp_rank_00_model_states.pt.
[2024-06-18 16:26:50,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=4810, skipped=23, lr=[6.082228195210334e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:26:50,094] [INFO] [timer.py:258:stop] epoch=0/micro_step=4810/global_step=4810, RunningAvgSamplesPerSec=4.462551828305387, CurrSamplesPerSec=4.5060687587641866, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:26:59,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=4820, skipped=23, lr=[6.0682070072732785e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:26:59,128] [INFO] [timer.py:258:stop] epoch=0/micro_step=4820/global_step=4820, RunningAvgSamplesPerSec=4.462632909051718, CurrSamplesPerSec=4.500774084545431, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:27:08,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=4830, skipped=23, lr=[6.0541802113624566e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:27:08,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=4830/global_step=4830, RunningAvgSamplesPerSec=4.462686377649368, CurrSamplesPerSec=4.477490737288608, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:27:17,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=4840, skipped=23, lr=[6.0401479459166806e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:27:17,287] [INFO] [timer.py:258:stop] epoch=0/micro_step=4840/global_step=4840, RunningAvgSamplesPerSec=4.462717096938708, CurrSamplesPerSec=4.474445688737594, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:27:26,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=23, lr=[6.026110349428743e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:27:26,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=4.462747991834014, CurrSamplesPerSec=4.472236742669099, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:27:26,378] [INFO] [RANK 0]  iteration     4850/   10000 | elapsed time per iteration (ms): 1497.3 | learning rate 6.025E-05 | total loss 1.139094E-01 | loss 1.139094E-01 | loss scale 32768.0 |speed 160.29 samples/(min*GPU)
[2024-06-18 16:27:26,379] [INFO] [RANK 0] time (ms) | forward: 354.73 | backward: 545.47 | allreduce: 0.00 | optimizer: 5.06 | batch generator: 14.60 | data loader: 0.11
[2024-06-18 16:27:35,480] [INFO] [logging.py:96:log_dist] [Rank 0] step=4860, skipped=23, lr=[6.012067560444058e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:27:35,481] [INFO] [timer.py:258:stop] epoch=0/micro_step=4860/global_step=4860, RunningAvgSamplesPerSec=4.462757475662975, CurrSamplesPerSec=4.4639025079428345, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:27:44,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=4870, skipped=23, lr=[5.99801971755928e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:27:44,581] [INFO] [timer.py:258:stop] epoch=0/micro_step=4870/global_step=4870, RunningAvgSamplesPerSec=4.462757232577525, CurrSamplesPerSec=4.4678824980939105, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:27:53,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=4880, skipped=23, lr=[5.983966959420948e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:27:53,727] [INFO] [timer.py:258:stop] epoch=0/micro_step=4880/global_step=4880, RunningAvgSamplesPerSec=4.462737196118555, CurrSamplesPerSec=4.444565246474554, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:28:02,847] [INFO] [logging.py:96:log_dist] [Rank 0] step=4890, skipped=23, lr=[5.969909424724113e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:28:02,848] [INFO] [timer.py:258:stop] epoch=0/micro_step=4890/global_step=4890, RunningAvgSamplesPerSec=4.462709834259503, CurrSamplesPerSec=4.450133260902779, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:28:11,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=23, lr=[5.955847252210966e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:28:11,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=4.462690906730031, CurrSamplesPerSec=4.453254042702061, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:28:11,985] [INFO] [RANK 0]  iteration     4900/   10000 | elapsed time per iteration (ms): 912.1 | learning rate 5.954E-05 | total loss 1.020515E-01 | loss 1.020515E-01 | loss scale 32768.0 |speed 263.12 samples/(min*GPU)
[2024-06-18 16:28:11,985] [INFO] [RANK 0] time (ms) | forward: 357.32 | backward: 548.63 | allreduce: 0.00 | optimizer: 5.37 | batch generator: 14.13 | data loader: 0.10
[2024-06-18 16:28:21,118] [INFO] [logging.py:96:log_dist] [Rank 0] step=4910, skipped=23, lr=[5.941780580669472e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:28:21,118] [INFO] [timer.py:258:stop] epoch=0/micro_step=4910/global_step=4910, RunningAvgSamplesPerSec=4.462673721943565, CurrSamplesPerSec=4.451973071442408, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:28:26,598] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 16:28:27,510] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 16:28:30,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=4920, skipped=25, lr=[5.9305240974297634e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:28:30,254] [INFO] [timer.py:258:stop] epoch=0/micro_step=4920/global_step=4920, RunningAvgSamplesPerSec=4.46266636495304, CurrSamplesPerSec=4.463187622521928, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:28:39,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=4930, skipped=25, lr=[5.916449677523782e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:28:39,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=4930/global_step=4930, RunningAvgSamplesPerSec=4.462657725060791, CurrSamplesPerSec=4.465319892921001, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:28:48,469] [INFO] [logging.py:96:log_dist] [Rank 0] step=4940, skipped=25, lr=[5.902371147427609e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:28:48,470] [INFO] [timer.py:258:stop] epoch=0/micro_step=4940/global_step=4940, RunningAvgSamplesPerSec=4.462646056920987, CurrSamplesPerSec=4.457282556513667, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:28:57,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=4950, skipped=25, lr=[5.888288646090656e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:28:57,596] [INFO] [timer.py:258:stop] epoch=0/micro_step=4950/global_step=4950, RunningAvgSamplesPerSec=4.462639979416682, CurrSamplesPerSec=4.4581519195953945, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:28:57,597] [INFO] [RANK 0]  iteration     4950/   10000 | elapsed time per iteration (ms): 912.3 | learning rate 5.887E-05 | total loss 1.360741E-01 | loss 1.360741E-01 | loss scale 32768.0 |speed 263.09 samples/(min*GPU)
[2024-06-18 16:28:57,598] [INFO] [RANK 0] time (ms) | forward: 357.16 | backward: 549.14 | allreduce: 0.00 | optimizer: 5.18 | batch generator: 14.25 | data loader: 0.10
[2024-06-18 16:29:06,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=4960, skipped=25, lr=[5.874202312501525e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:29:06,715] [INFO] [timer.py:258:stop] epoch=0/micro_step=4960/global_step=4960, RunningAvgSamplesPerSec=4.4626308030047115, CurrSamplesPerSec=4.457370188104073, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:29:15,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=4970, skipped=25, lr=[5.86011228568664e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:29:15,869] [INFO] [timer.py:258:stop] epoch=0/micro_step=4970/global_step=4970, RunningAvgSamplesPerSec=4.462598781182431, CurrSamplesPerSec=4.468939313826737, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:29:24,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=4980, skipped=25, lr=[5.84601870470888e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:29:24,981] [INFO] [timer.py:258:stop] epoch=0/micro_step=4980/global_step=4980, RunningAvgSamplesPerSec=4.462598227745099, CurrSamplesPerSec=4.457932770233286, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:29:34,117] [INFO] [logging.py:96:log_dist] [Rank 0] step=4990, skipped=25, lr=[5.831921708666196e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:29:34,118] [INFO] [timer.py:258:stop] epoch=0/micro_step=4990/global_step=4990, RunningAvgSamplesPerSec=4.462572843862093, CurrSamplesPerSec=4.451299793582485, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:29:43,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=5000, skipped=25, lr=[5.817821436690251e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:29:43,221] [INFO] [timer.py:258:stop] epoch=0/micro_step=5000/global_step=5000, RunningAvgSamplesPerSec=4.462570331059555, CurrSamplesPerSec=4.461993491004187, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:29:43,224] [INFO] [RANK 0]  iteration     5000/   10000 | elapsed time per iteration (ms): 912.5 | learning rate 5.816E-05 | total loss 1.600702E-01 | loss 1.600702E-01 | loss scale 32768.0 |speed 263.00 samples/(min*GPU)
[2024-06-18 16:29:43,225] [INFO] [RANK 0] time (ms) | forward: 357.34 | backward: 549.10 | allreduce: 0.00 | optimizer: 5.29 | batch generator: 14.17 | data loader: 0.10
[2024-06-18 16:29:49,907] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 16:29:49,907] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 16:29:49,907] [INFO] [RANK 0]  validation loss at iteration 5000 | loss: 1.293716E-01 | PPL: 1.138113E+00 loss 1.292725E-01 |
[2024-06-18 16:29:49,907] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 16:29:59,015] [INFO] [logging.py:96:log_dist] [Rank 0] step=5010, skipped=25, lr=[5.803718027945035e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:29:59,016] [INFO] [timer.py:258:stop] epoch=0/micro_step=5010/global_step=5010, RunningAvgSamplesPerSec=4.462554723484075, CurrSamplesPerSec=4.457220979619575, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:30:08,144] [INFO] [logging.py:96:log_dist] [Rank 0] step=5020, skipped=25, lr=[5.789611621625499e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:30:08,145] [INFO] [timer.py:258:stop] epoch=0/micro_step=5020/global_step=5020, RunningAvgSamplesPerSec=4.462545521419685, CurrSamplesPerSec=4.45892800001701, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:30:17,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=5030, skipped=25, lr=[5.7755023569561794e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:30:17,248] [INFO] [timer.py:258:stop] epoch=0/micro_step=5030/global_step=5030, RunningAvgSamplesPerSec=4.46254073045393, CurrSamplesPerSec=4.463374040667606, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:30:26,371] [INFO] [logging.py:96:log_dist] [Rank 0] step=5040, skipped=25, lr=[5.7613903731898214e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:30:26,371] [INFO] [timer.py:258:stop] epoch=0/micro_step=5040/global_step=5040, RunningAvgSamplesPerSec=4.462527419720042, CurrSamplesPerSec=4.451837218281035, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:30:35,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=5050, skipped=25, lr=[5.747275809606007e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:30:35,495] [INFO] [timer.py:258:stop] epoch=0/micro_step=5050/global_step=5050, RunningAvgSamplesPerSec=4.462523360829239, CurrSamplesPerSec=4.469002405350907, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:30:35,496] [INFO] [RANK 0]  iteration     5050/   10000 | elapsed time per iteration (ms): 1045.4 | learning rate 5.746E-05 | total loss 1.478521E-01 | loss 1.478521E-01 | loss scale 32768.0 |speed 229.57 samples/(min*GPU)
[2024-06-18 16:30:35,497] [INFO] [RANK 0] time (ms) | forward: 356.98 | backward: 548.88 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 16.99 | data loader: 0.15
[2024-06-18 16:30:44,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=5060, skipped=25, lr=[5.733158805509782e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:30:44,615] [INFO] [timer.py:258:stop] epoch=0/micro_step=5060/global_step=5060, RunningAvgSamplesPerSec=4.462523597010713, CurrSamplesPerSec=4.4663255581171235, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:30:53,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=5070, skipped=25, lr=[5.719039500230275e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:30:53,711] [INFO] [timer.py:258:stop] epoch=0/micro_step=5070/global_step=5070, RunningAvgSamplesPerSec=4.462518023636735, CurrSamplesPerSec=4.462561988834828, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:31:02,806] [INFO] [logging.py:96:log_dist] [Rank 0] step=5080, skipped=25, lr=[5.704918033119332e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:31:02,807] [INFO] [timer.py:258:stop] epoch=0/micro_step=5080/global_step=5080, RunningAvgSamplesPerSec=4.462515642542279, CurrSamplesPerSec=4.457969491056143, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:31:11,941] [INFO] [logging.py:96:log_dist] [Rank 0] step=5090, skipped=25, lr=[5.690794543550129e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:31:11,942] [INFO] [timer.py:258:stop] epoch=0/micro_step=5090/global_step=5090, RunningAvgSamplesPerSec=4.462503752221152, CurrSamplesPerSec=4.460724091933816, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:31:21,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=5100, skipped=25, lr=[5.6766691709158096e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:31:21,070] [INFO] [timer.py:258:stop] epoch=0/micro_step=5100/global_step=5100, RunningAvgSamplesPerSec=4.462488070677021, CurrSamplesPerSec=4.458621090119752, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:31:21,076] [INFO] [RANK 0]  iteration     5100/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 5.675E-05 | total loss 1.198116E-01 | loss 1.198116E-01 | loss scale 32768.0 |speed 263.28 samples/(min*GPU)
[2024-06-18 16:31:21,080] [INFO] [RANK 0] time (ms) | forward: 356.63 | backward: 548.97 | allreduce: 0.00 | optimizer: 5.26 | batch generator: 13.75 | data loader: 0.11
[2024-06-18 16:31:21,083] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:31:21,104] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/5100/mp_rank_00_model_states.pt
[2024-06-18 16:31:21,104] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/5100/mp_rank_00_model_states.pt...
[2024-06-18 16:31:49,246] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/5100/mp_rank_00_model_states.pt.
[2024-06-18 16:31:58,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=5110, skipped=25, lr=[5.6625420546280967e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:31:58,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=5110/global_step=5110, RunningAvgSamplesPerSec=4.462576536998385, CurrSamplesPerSec=4.496837753545265, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:32:07,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=5120, skipped=25, lr=[5.6484133341159264e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:32:07,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=5120/global_step=5120, RunningAvgSamplesPerSec=4.462650522784929, CurrSamplesPerSec=4.501746259013037, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:32:16,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=5130, skipped=25, lr=[5.634283148824064e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:32:16,367] [INFO] [timer.py:258:stop] epoch=0/micro_step=5130/global_step=5130, RunningAvgSamplesPerSec=4.462702443752275, CurrSamplesPerSec=4.486474431142048, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:32:25,441] [INFO] [logging.py:96:log_dist] [Rank 0] step=5140, skipped=25, lr=[5.620151638211737e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:32:25,442] [INFO] [timer.py:258:stop] epoch=0/micro_step=5140/global_step=5140, RunningAvgSamplesPerSec=4.462747170630649, CurrSamplesPerSec=4.477905423114844, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:32:34,537] [INFO] [logging.py:96:log_dist] [Rank 0] step=5150, skipped=25, lr=[5.606018941751247e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:32:34,537] [INFO] [timer.py:258:stop] epoch=0/micro_step=5150/global_step=5150, RunningAvgSamplesPerSec=4.46277603390757, CurrSamplesPerSec=4.476936349442572, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:32:34,539] [INFO] [RANK 0]  iteration     5150/   10000 | elapsed time per iteration (ms): 1469.3 | learning rate 5.605E-05 | total loss 1.568573E-01 | loss 1.568573E-01 | loss scale 32768.0 |speed 163.35 samples/(min*GPU)
[2024-06-18 16:32:34,540] [INFO] [RANK 0] time (ms) | forward: 354.40 | backward: 545.31 | allreduce: 0.00 | optimizer: 5.18 | batch generator: 14.49 | data loader: 0.11
[2024-06-18 16:32:43,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=5160, skipped=25, lr=[5.591885198926603e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:32:43,628] [INFO] [timer.py:258:stop] epoch=0/micro_step=5160/global_step=5160, RunningAvgSamplesPerSec=4.462775973109985, CurrSamplesPerSec=4.471458406404149, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:32:52,722] [INFO] [logging.py:96:log_dist] [Rank 0] step=5170, skipped=25, lr=[5.5777505492321413e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:32:52,723] [INFO] [timer.py:258:stop] epoch=0/micro_step=5170/global_step=5170, RunningAvgSamplesPerSec=4.46278251745414, CurrSamplesPerSec=4.4562714898714555, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:33:01,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=5180, skipped=25, lr=[5.563615132171149e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:33:01,840] [INFO] [timer.py:258:stop] epoch=0/micro_step=5180/global_step=5180, RunningAvgSamplesPerSec=4.46278011600007, CurrSamplesPerSec=4.465757289735199, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:33:10,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=5190, skipped=25, lr=[5.549479087254483e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:33:10,942] [INFO] [timer.py:258:stop] epoch=0/micro_step=5190/global_step=5190, RunningAvgSamplesPerSec=4.462772295557677, CurrSamplesPerSec=4.4583142224690615, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:33:20,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=5200, skipped=25, lr=[5.5353425539992014e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:33:20,057] [INFO] [timer.py:258:stop] epoch=0/micro_step=5200/global_step=5200, RunningAvgSamplesPerSec=4.462763766662648, CurrSamplesPerSec=4.466861860274782, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:33:20,059] [INFO] [RANK 0]  iteration     5200/   10000 | elapsed time per iteration (ms): 910.4 | learning rate 5.534E-05 | total loss 9.640678E-02 | loss 9.640678E-02 | loss scale 32768.0 |speed 263.62 samples/(min*GPU)
[2024-06-18 16:33:20,060] [INFO] [RANK 0] time (ms) | forward: 355.89 | backward: 548.71 | allreduce: 0.00 | optimizer: 5.05 | batch generator: 13.30 | data loader: 0.09
[2024-06-18 16:33:29,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=5210, skipped=25, lr=[5.52120567192718e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:33:29,177] [INFO] [timer.py:258:stop] epoch=0/micro_step=5210/global_step=5210, RunningAvgSamplesPerSec=4.462744615880509, CurrSamplesPerSec=4.44811570625687, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:33:38,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=5220, skipped=25, lr=[5.507068580563739e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:33:38,287] [INFO] [timer.py:258:stop] epoch=0/micro_step=5220/global_step=5220, RunningAvgSamplesPerSec=4.462727858683969, CurrSamplesPerSec=4.455165051689021, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:33:47,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=5230, skipped=25, lr=[5.492931419436262e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:33:47,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=5230/global_step=5230, RunningAvgSamplesPerSec=4.462728567041316, CurrSamplesPerSec=4.462290183699725, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:33:56,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=5240, skipped=25, lr=[5.478794328072821e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:33:56,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=5240/global_step=5240, RunningAvgSamplesPerSec=4.4627202095878715, CurrSamplesPerSec=4.467175853011384, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:34:05,575] [INFO] [logging.py:96:log_dist] [Rank 0] step=5250, skipped=25, lr=[5.464657446000801e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:34:05,576] [INFO] [timer.py:258:stop] epoch=0/micro_step=5250/global_step=5250, RunningAvgSamplesPerSec=4.462715388691558, CurrSamplesPerSec=4.462424301746114, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:34:05,577] [INFO] [RANK 0]  iteration     5250/   10000 | elapsed time per iteration (ms): 910.4 | learning rate 5.463E-05 | total loss 1.079652E-01 | loss 1.079652E-01 | loss scale 32768.0 |speed 263.63 samples/(min*GPU)
[2024-06-18 16:34:05,578] [INFO] [RANK 0] time (ms) | forward: 355.36 | backward: 548.94 | allreduce: 0.00 | optimizer: 5.30 | batch generator: 12.41 | data loader: 0.09
[2024-06-18 16:34:14,686] [INFO] [logging.py:96:log_dist] [Rank 0] step=5260, skipped=25, lr=[5.4505209127455195e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:34:14,686] [INFO] [timer.py:258:stop] epoch=0/micro_step=5260/global_step=5260, RunningAvgSamplesPerSec=4.46270914756769, CurrSamplesPerSec=4.4446029248644745, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:34:23,797] [INFO] [logging.py:96:log_dist] [Rank 0] step=5270, skipped=25, lr=[5.436384867828854e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:34:23,798] [INFO] [timer.py:258:stop] epoch=0/micro_step=5270/global_step=5270, RunningAvgSamplesPerSec=4.462709469636969, CurrSamplesPerSec=4.461911610767385, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:34:32,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=5280, skipped=25, lr=[5.4222494507678604e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:34:32,917] [INFO] [timer.py:258:stop] epoch=0/micro_step=5280/global_step=5280, RunningAvgSamplesPerSec=4.4627030324121915, CurrSamplesPerSec=4.458092687913349, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:34:42,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=5290, skipped=25, lr=[5.408114801073399e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:34:42,039] [INFO] [timer.py:258:stop] epoch=0/micro_step=5290/global_step=5290, RunningAvgSamplesPerSec=4.462687789757037, CurrSamplesPerSec=4.456136557830888, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:34:51,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=5300, skipped=25, lr=[5.393981058248756e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:34:51,153] [INFO] [timer.py:258:stop] epoch=0/micro_step=5300/global_step=5300, RunningAvgSamplesPerSec=4.462676412819862, CurrSamplesPerSec=4.4587158840339525, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:34:51,154] [INFO] [RANK 0]  iteration     5300/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 5.393E-05 | total loss 1.461273E-01 | loss 1.461273E-01 | loss scale 32768.0 |speed 263.29 samples/(min*GPU)
[2024-06-18 16:34:51,155] [INFO] [RANK 0] time (ms) | forward: 356.83 | backward: 548.76 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 13.78 | data loader: 0.10
[2024-06-18 16:35:00,264] [INFO] [logging.py:96:log_dist] [Rank 0] step=5310, skipped=25, lr=[5.3798483617882654e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:35:00,265] [INFO] [timer.py:258:stop] epoch=0/micro_step=5310/global_step=5310, RunningAvgSamplesPerSec=4.462671912401268, CurrSamplesPerSec=4.465097661609198, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:35:07,561] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 16:35:08,473] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 16:35:09,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=5320, skipped=27, lr=[5.3685430517357e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:35:09,383] [INFO] [timer.py:258:stop] epoch=0/micro_step=5320/global_step=5320, RunningAvgSamplesPerSec=4.462666644544178, CurrSamplesPerSec=4.460775091237722, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:35:18,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=5330, skipped=27, lr=[5.354412590222568e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:35:18,538] [INFO] [timer.py:258:stop] epoch=0/micro_step=5330/global_step=5330, RunningAvgSamplesPerSec=4.462640299973689, CurrSamplesPerSec=4.447343384724843, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:35:27,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=5340, skipped=27, lr=[5.340283565598395e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:35:27,643] [INFO] [timer.py:258:stop] epoch=0/micro_step=5340/global_step=5340, RunningAvgSamplesPerSec=4.462636734925642, CurrSamplesPerSec=4.462532314175041, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:35:36,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=5350, skipped=27, lr=[5.32615611731095e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:35:36,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=5350/global_step=5350, RunningAvgSamplesPerSec=4.462634432840232, CurrSamplesPerSec=4.452926639528856, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:35:36,745] [INFO] [RANK 0]  iteration     5350/   10000 | elapsed time per iteration (ms): 911.8 | learning rate 5.325E-05 | total loss 1.451300E-01 | loss 1.451300E-01 | loss scale 32768.0 |speed 263.21 samples/(min*GPU)
[2024-06-18 16:35:36,746] [INFO] [RANK 0] time (ms) | forward: 356.78 | backward: 548.86 | allreduce: 0.00 | optimizer: 5.42 | batch generator: 13.64 | data loader: 0.09
[2024-06-18 16:35:45,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=5360, skipped=27, lr=[5.3120303847924434e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:35:45,873] [INFO] [timer.py:258:stop] epoch=0/micro_step=5360/global_step=5360, RunningAvgSamplesPerSec=4.462629392652096, CurrSamplesPerSec=4.459852539932671, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:35:55,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=5370, skipped=27, lr=[5.297906507458153e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:35:55,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=5370/global_step=5370, RunningAvgSamplesPerSec=4.462605684273591, CurrSamplesPerSec=4.454114739831756, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:36:04,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=5380, skipped=27, lr=[5.2837846247050444e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:36:04,123] [INFO] [timer.py:258:stop] epoch=0/micro_step=5380/global_step=5380, RunningAvgSamplesPerSec=4.462597899121957, CurrSamplesPerSec=4.4724131873311075, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:36:13,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=5390, skipped=27, lr=[5.2696648759104006e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:36:13,239] [INFO] [timer.py:258:stop] epoch=0/micro_step=5390/global_step=5390, RunningAvgSamplesPerSec=4.462593408495145, CurrSamplesPerSec=4.4329917936409045, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:36:22,340] [INFO] [logging.py:96:log_dist] [Rank 0] step=5400, skipped=27, lr=[5.255547400430441e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:36:22,340] [INFO] [timer.py:258:stop] epoch=0/micro_step=5400/global_step=5400, RunningAvgSamplesPerSec=4.46259580523448, CurrSamplesPerSec=4.4680026737896705, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:36:22,345] [INFO] [RANK 0]  iteration     5400/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 5.254E-05 | total loss 1.049630E-01 | loss 1.049630E-01 | loss scale 32768.0 |speed 263.16 samples/(min*GPU)
[2024-06-18 16:36:22,346] [INFO] [RANK 0] time (ms) | forward: 357.03 | backward: 548.94 | allreduce: 0.00 | optimizer: 5.24 | batch generator: 14.16 | data loader: 0.09
[2024-06-18 16:36:22,346] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:36:22,363] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/5400/mp_rank_00_model_states.pt
[2024-06-18 16:36:22,363] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/5400/mp_rank_00_model_states.pt...
[2024-06-18 16:36:46,117] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/5400/mp_rank_00_model_states.pt.
[2024-06-18 16:36:55,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=5410, skipped=27, lr=[5.241432337598951e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:36:55,187] [INFO] [timer.py:258:stop] epoch=0/micro_step=5410/global_step=5410, RunningAvgSamplesPerSec=4.462653177890576, CurrSamplesPerSec=4.496634067360464, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:37:04,216] [INFO] [logging.py:96:log_dist] [Rank 0] step=5420, skipped=27, lr=[5.2273198267258994e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:37:04,217] [INFO] [timer.py:258:stop] epoch=0/micro_step=5420/global_step=5420, RunningAvgSamplesPerSec=4.462705534098839, CurrSamplesPerSec=4.499810778110984, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:37:13,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=5430, skipped=27, lr=[5.213210007096074e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:37:13,256] [INFO] [timer.py:258:stop] epoch=0/micro_step=5430/global_step=5430, RunningAvgSamplesPerSec=4.462742934075045, CurrSamplesPerSec=4.487637289520163, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:37:22,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=5440, skipped=27, lr=[5.1991030179676965e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:37:22,326] [INFO] [timer.py:258:stop] epoch=0/micro_step=5440/global_step=5440, RunningAvgSamplesPerSec=4.462772399713152, CurrSamplesPerSec=4.481862541600349, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:37:31,407] [INFO] [logging.py:96:log_dist] [Rank 0] step=5450, skipped=27, lr=[5.184998998571054e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:37:31,407] [INFO] [timer.py:258:stop] epoch=0/micro_step=5450/global_step=5450, RunningAvgSamplesPerSec=4.462794718303692, CurrSamplesPerSec=4.47112712953443, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:37:31,409] [INFO] [RANK 0]  iteration     5450/   10000 | elapsed time per iteration (ms): 1381.3 | learning rate 5.184E-05 | total loss 1.222034E-01 | loss 1.222034E-01 | loss scale 32768.0 |speed 173.75 samples/(min*GPU)
[2024-06-18 16:37:31,409] [INFO] [RANK 0] time (ms) | forward: 353.98 | backward: 545.64 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 12.94 | data loader: 0.09
[2024-06-18 16:37:40,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=5460, skipped=27, lr=[5.170898088107125e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:37:40,512] [INFO] [timer.py:258:stop] epoch=0/micro_step=5460/global_step=5460, RunningAvgSamplesPerSec=4.462804687342686, CurrSamplesPerSec=4.472571760966151, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:37:49,633] [INFO] [logging.py:96:log_dist] [Rank 0] step=5470, skipped=27, lr=[5.1568004257462016e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:37:49,634] [INFO] [timer.py:258:stop] epoch=0/micro_step=5470/global_step=5470, RunningAvgSamplesPerSec=4.462796855872874, CurrSamplesPerSec=4.433140555724814, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:37:58,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=5480, skipped=27, lr=[5.142706150626522e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:37:58,745] [INFO] [timer.py:258:stop] epoch=0/micro_step=5480/global_step=5480, RunningAvgSamplesPerSec=4.462791464527724, CurrSamplesPerSec=4.45690009680357, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:38:07,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=5490, skipped=27, lr=[5.128615401852889e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:38:07,849] [INFO] [timer.py:258:stop] epoch=0/micro_step=5490/global_step=5490, RunningAvgSamplesPerSec=4.462782928435277, CurrSamplesPerSec=4.452569742183156, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:38:16,939] [INFO] [logging.py:96:log_dist] [Rank 0] step=5500, skipped=27, lr=[5.114528318495307e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:38:16,939] [INFO] [timer.py:258:stop] epoch=0/micro_step=5500/global_step=5500, RunningAvgSamplesPerSec=4.462784142916093, CurrSamplesPerSec=4.462943046535897, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:38:16,942] [INFO] [RANK 0]  iteration     5500/   10000 | elapsed time per iteration (ms): 910.7 | learning rate 5.113E-05 | total loss 1.605913E-01 | loss 1.605913E-01 | loss scale 32768.0 |speed 263.54 samples/(min*GPU)
[2024-06-18 16:38:16,943] [INFO] [RANK 0] time (ms) | forward: 356.37 | backward: 548.40 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 13.55 | data loader: 0.09
[2024-06-18 16:38:26,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=5510, skipped=27, lr=[5.1004450395876e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:38:26,050] [INFO] [timer.py:258:stop] epoch=0/micro_step=5510/global_step=5510, RunningAvgSamplesPerSec=4.462781022442912, CurrSamplesPerSec=4.461141608909937, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:38:35,169] [INFO] [logging.py:96:log_dist] [Rank 0] step=5520, skipped=27, lr=[5.086365704126046e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:38:35,170] [INFO] [timer.py:258:stop] epoch=0/micro_step=5520/global_step=5520, RunningAvgSamplesPerSec=4.462771732279179, CurrSamplesPerSec=4.463751674184645, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:38:44,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=5530, skipped=27, lr=[5.072290451068001e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:38:44,292] [INFO] [timer.py:258:stop] epoch=0/micro_step=5530/global_step=5530, RunningAvgSamplesPerSec=4.46276661151019, CurrSamplesPerSec=4.469872773984327, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:38:53,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=5540, skipped=27, lr=[5.0582194193305294e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:38:53,402] [INFO] [timer.py:258:stop] epoch=0/micro_step=5540/global_step=5540, RunningAvgSamplesPerSec=4.462756923544878, CurrSamplesPerSec=4.453501104402026, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:39:02,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=5550, skipped=27, lr=[5.044152747789036e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:39:02,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=5550/global_step=5550, RunningAvgSamplesPerSec=4.462756446355694, CurrSamplesPerSec=4.454340609698108, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:39:02,505] [INFO] [RANK 0]  iteration     5550/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 5.043E-05 | total loss 1.254360E-01 | loss 1.254360E-01 | loss scale 32768.0 |speed 263.37 samples/(min*GPU)
[2024-06-18 16:39:02,506] [INFO] [RANK 0] time (ms) | forward: 356.49 | backward: 548.81 | allreduce: 0.00 | optimizer: 5.22 | batch generator: 13.70 | data loader: 0.10
[2024-06-18 16:39:11,634] [INFO] [logging.py:96:log_dist] [Rank 0] step=5560, skipped=27, lr=[5.0300905752758883e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:39:11,635] [INFO] [timer.py:258:stop] epoch=0/micro_step=5560/global_step=5560, RunningAvgSamplesPerSec=4.462735553669372, CurrSamplesPerSec=4.4603837310947245, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:39:20,741] [INFO] [logging.py:96:log_dist] [Rank 0] step=5570, skipped=27, lr=[5.016033040579054e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:39:20,742] [INFO] [timer.py:258:stop] epoch=0/micro_step=5570/global_step=5570, RunningAvgSamplesPerSec=4.462726346696472, CurrSamplesPerSec=4.460325625898427, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:39:29,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=5580, skipped=27, lr=[5.001980282440722e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:39:29,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=5580/global_step=5580, RunningAvgSamplesPerSec=4.462721193898428, CurrSamplesPerSec=4.460316139479524, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:39:38,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=5590, skipped=27, lr=[4.987932439555945e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:39:38,991] [INFO] [timer.py:258:stop] epoch=0/micro_step=5590/global_step=5590, RunningAvgSamplesPerSec=4.4627092317522745, CurrSamplesPerSec=4.4606398863331815, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:39:48,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=5600, skipped=27, lr=[4.973889650571257e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:39:48,123] [INFO] [timer.py:258:stop] epoch=0/micro_step=5600/global_step=5600, RunningAvgSamplesPerSec=4.462697236068454, CurrSamplesPerSec=4.4598715088669945, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:39:48,124] [INFO] [RANK 0]  iteration     5600/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 4.972E-05 | total loss 1.269311E-01 | loss 1.269311E-01 | loss scale 32768.0 |speed 263.04 samples/(min*GPU)
[2024-06-18 16:39:48,126] [INFO] [RANK 0] time (ms) | forward: 357.53 | backward: 548.87 | allreduce: 0.00 | optimizer: 5.23 | batch generator: 14.13 | data loader: 0.11
[2024-06-18 16:39:57,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=5610, skipped=27, lr=[4.959852054083321e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:39:57,234] [INFO] [timer.py:258:stop] epoch=0/micro_step=5610/global_step=5610, RunningAvgSamplesPerSec=4.462684293660259, CurrSamplesPerSec=4.468396562226089, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:40:06,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=5620, skipped=27, lr=[4.945819788637545e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:40:06,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=5620/global_step=5620, RunningAvgSamplesPerSec=4.462682031245048, CurrSamplesPerSec=4.460566357282059, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:40:15,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=5630, skipped=27, lr=[4.9317929927267225e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:40:15,480] [INFO] [timer.py:258:stop] epoch=0/micro_step=5630/global_step=5630, RunningAvgSamplesPerSec=4.462676992520701, CurrSamplesPerSec=4.447039246199841, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:40:24,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=5640, skipped=27, lr=[4.917771804789668e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:40:24,574] [INFO] [timer.py:258:stop] epoch=0/micro_step=5640/global_step=5640, RunningAvgSamplesPerSec=4.462667611298828, CurrSamplesPerSec=4.457051651933108, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:40:33,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=5650, skipped=27, lr=[4.9037563632098444e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:40:33,682] [INFO] [timer.py:258:stop] epoch=0/micro_step=5650/global_step=5650, RunningAvgSamplesPerSec=4.46265125918987, CurrSamplesPerSec=4.458410188121388, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:40:33,683] [INFO] [RANK 0]  iteration     5650/   10000 | elapsed time per iteration (ms): 911.2 | learning rate 4.902E-05 | total loss 1.393304E-01 | loss 1.393304E-01 | loss scale 32768.0 |speed 263.39 samples/(min*GPU)
[2024-06-18 16:40:33,684] [INFO] [RANK 0] time (ms) | forward: 356.10 | backward: 549.06 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 13.17 | data loader: 0.09
[2024-06-18 16:40:42,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=5660, skipped=27, lr=[4.8897468063140035e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:40:42,801] [INFO] [timer.py:258:stop] epoch=0/micro_step=5660/global_step=5660, RunningAvgSamplesPerSec=4.462642185397296, CurrSamplesPerSec=4.448368095400716, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:40:51,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=5670, skipped=27, lr=[4.8757432723708144e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:40:51,904] [INFO] [timer.py:258:stop] epoch=0/micro_step=5670/global_step=5670, RunningAvgSamplesPerSec=4.462641410804501, CurrSamplesPerSec=4.4648326767148285, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:41:01,006] [INFO] [logging.py:96:log_dist] [Rank 0] step=5680, skipped=27, lr=[4.8617458995895036e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:41:01,007] [INFO] [timer.py:258:stop] epoch=0/micro_step=5680/global_step=5680, RunningAvgSamplesPerSec=4.462631835071636, CurrSamplesPerSec=4.453553120884657, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:41:10,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=5690, skipped=27, lr=[4.8477548261184916e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:41:10,127] [INFO] [timer.py:258:stop] epoch=0/micro_step=5690/global_step=5690, RunningAvgSamplesPerSec=4.462626044248057, CurrSamplesPerSec=4.471414312765767, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:41:19,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=5700, skipped=27, lr=[4.833770190044023e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:41:19,219] [INFO] [timer.py:258:stop] epoch=0/micro_step=5700/global_step=5700, RunningAvgSamplesPerSec=4.46262276052003, CurrSamplesPerSec=4.45906310116311, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:41:19,222] [INFO] [RANK 0]  iteration     5700/   10000 | elapsed time per iteration (ms): 910.8 | learning rate 4.832E-05 | total loss 1.079591E-01 | loss 1.079591E-01 | loss scale 32768.0 |speed 263.51 samples/(min*GPU)
[2024-06-18 16:41:19,223] [INFO] [RANK 0] time (ms) | forward: 355.74 | backward: 549.07 | allreduce: 0.00 | optimizer: 5.19 | batch generator: 13.18 | data loader: 0.09
[2024-06-18 16:41:19,225] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:41:19,246] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/5700/mp_rank_00_model_states.pt
[2024-06-18 16:41:19,246] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/5700/mp_rank_00_model_states.pt...
[2024-06-18 16:41:43,077] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/5700/mp_rank_00_model_states.pt.
[2024-06-18 16:41:52,150] [INFO] [logging.py:96:log_dist] [Rank 0] step=5710, skipped=27, lr=[4.8197921293888116e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:41:52,151] [INFO] [timer.py:258:stop] epoch=0/micro_step=5710/global_step=5710, RunningAvgSamplesPerSec=4.462665479751593, CurrSamplesPerSec=4.500131834435262, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:42:01,203] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 16:42:01,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=5720, skipped=28, lr=[4.8058207821106725e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:42:01,205] [INFO] [timer.py:258:stop] epoch=0/micro_step=5720/global_step=5720, RunningAvgSamplesPerSec=4.462710367431012, CurrSamplesPerSec=4.495824326124082, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:42:02,112] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 16:42:10,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=5730, skipped=29, lr=[4.7946486305850384e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:42:10,295] [INFO] [timer.py:258:stop] epoch=0/micro_step=5730/global_step=5730, RunningAvgSamplesPerSec=4.46274485934625, CurrSamplesPerSec=4.481109576502269, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:42:19,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=5740, skipped=29, lr=[4.7806897148269577e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:42:19,387] [INFO] [timer.py:258:stop] epoch=0/micro_step=5740/global_step=5740, RunningAvgSamplesPerSec=4.462774771118956, CurrSamplesPerSec=4.478351266171653, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:42:28,479] [INFO] [logging.py:96:log_dist] [Rank 0] step=5750, skipped=29, lr=[4.766737898370994e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:42:28,480] [INFO] [timer.py:258:stop] epoch=0/micro_step=5750/global_step=5750, RunningAvgSamplesPerSec=4.462781324480521, CurrSamplesPerSec=4.467079509636701, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:42:28,591] [INFO] [RANK 0]  iteration     5750/   10000 | elapsed time per iteration (ms): 1387.4 | learning rate 4.765E-05 | total loss 1.222157E-01 | loss 1.222157E-01 | loss scale 32768.0 |speed 172.99 samples/(min*GPU)
[2024-06-18 16:42:28,593] [INFO] [RANK 0] time (ms) | forward: 356.21 | backward: 545.61 | allreduce: 0.00 | optimizer: 7.33 | batch generator: 14.48 | data loader: 0.10
[2024-06-18 16:42:37,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=5760, skipped=29, lr=[4.752793318915943e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:42:37,695] [INFO] [timer.py:258:stop] epoch=0/micro_step=5760/global_step=5760, RunningAvgSamplesPerSec=4.4627861742128045, CurrSamplesPerSec=4.475162991782792, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:42:46,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=5770, skipped=29, lr=[4.738856114089176e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:42:46,819] [INFO] [timer.py:258:stop] epoch=0/micro_step=5770/global_step=5770, RunningAvgSamplesPerSec=4.462772321664316, CurrSamplesPerSec=4.454384367242364, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:42:55,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=5780, skipped=29, lr=[4.7249264214452754e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:42:55,930] [INFO] [timer.py:258:stop] epoch=0/micro_step=5780/global_step=5780, RunningAvgSamplesPerSec=4.462768948153755, CurrSamplesPerSec=4.471670544712132, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:43:05,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=5790, skipped=29, lr=[4.711004378464687e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:43:05,047] [INFO] [timer.py:258:stop] epoch=0/micro_step=5790/global_step=5790, RunningAvgSamplesPerSec=4.462771284117784, CurrSamplesPerSec=4.462256952155763, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:43:14,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=5800, skipped=29, lr=[4.697090122552352e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:43:14,166] [INFO] [timer.py:258:stop] epoch=0/micro_step=5800/global_step=5800, RunningAvgSamplesPerSec=4.462766389072253, CurrSamplesPerSec=4.459213618221063, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:43:14,168] [INFO] [RANK 0]  iteration     5800/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 4.696E-05 | total loss 1.442424E-01 | loss 1.442424E-01 | loss scale 32768.0 |speed 263.29 samples/(min*GPU)
[2024-06-18 16:43:14,169] [INFO] [RANK 0] time (ms) | forward: 357.11 | backward: 548.39 | allreduce: 0.00 | optimizer: 5.26 | batch generator: 14.15 | data loader: 0.09
[2024-06-18 16:43:23,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=5810, skipped=29, lr=[4.683183791036359e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:43:23,296] [INFO] [timer.py:258:stop] epoch=0/micro_step=5810/global_step=5810, RunningAvgSamplesPerSec=4.4627560949588805, CurrSamplesPerSec=4.457734962013955, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:43:32,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=5820, skipped=29, lr=[4.669285521166586e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:43:32,417] [INFO] [timer.py:258:stop] epoch=0/micro_step=5820/global_step=5820, RunningAvgSamplesPerSec=4.4627514438585765, CurrSamplesPerSec=4.452358230692719, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:43:41,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=5830, skipped=29, lr=[4.655395450113347e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:43:41,538] [INFO] [timer.py:258:stop] epoch=0/micro_step=5830/global_step=5830, RunningAvgSamplesPerSec=4.462741040297574, CurrSamplesPerSec=4.458855712415084, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:43:50,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=5840, skipped=29, lr=[4.641513714966035e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:43:50,641] [INFO] [timer.py:258:stop] epoch=0/micro_step=5840/global_step=5840, RunningAvgSamplesPerSec=4.462732554314542, CurrSamplesPerSec=4.465968887421872, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:43:59,757] [INFO] [logging.py:96:log_dist] [Rank 0] step=5850, skipped=29, lr=[4.627640452731771e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:43:59,758] [INFO] [timer.py:258:stop] epoch=0/micro_step=5850/global_step=5850, RunningAvgSamplesPerSec=4.462724582732548, CurrSamplesPerSec=4.441257926366655, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:43:59,760] [INFO] [RANK 0]  iteration     5850/   10000 | elapsed time per iteration (ms): 911.8 | learning rate 4.626E-05 | total loss 1.204063E-01 | loss 1.204063E-01 | loss scale 32768.0 |speed 263.21 samples/(min*GPU)
[2024-06-18 16:43:59,761] [INFO] [RANK 0] time (ms) | forward: 356.73 | backward: 548.99 | allreduce: 0.00 | optimizer: 5.32 | batch generator: 13.81 | data loader: 0.09
[2024-06-18 16:44:08,882] [INFO] [logging.py:96:log_dist] [Rank 0] step=5860, skipped=29, lr=[4.6137758003340524e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:44:08,882] [INFO] [timer.py:258:stop] epoch=0/micro_step=5860/global_step=5860, RunningAvgSamplesPerSec=4.462716058636389, CurrSamplesPerSec=4.461007567953908, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:44:17,987] [INFO] [logging.py:96:log_dist] [Rank 0] step=5870, skipped=29, lr=[4.599919894611401e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:44:17,988] [INFO] [timer.py:258:stop] epoch=0/micro_step=5870/global_step=5870, RunningAvgSamplesPerSec=4.4627083248646535, CurrSamplesPerSec=4.463805118051053, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:44:27,092] [INFO] [logging.py:96:log_dist] [Rank 0] step=5880, skipped=29, lr=[4.5860728723160135e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:44:27,093] [INFO] [timer.py:258:stop] epoch=0/micro_step=5880/global_step=5880, RunningAvgSamplesPerSec=4.4627085581617, CurrSamplesPerSec=4.476120549816443, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:44:36,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=5890, skipped=29, lr=[4.57223487011241e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:44:36,187] [INFO] [timer.py:258:stop] epoch=0/micro_step=5890/global_step=5890, RunningAvgSamplesPerSec=4.462709412629435, CurrSamplesPerSec=4.455976780455467, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:44:45,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=5900, skipped=29, lr=[4.558406024576082e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:44:45,293] [INFO] [timer.py:258:stop] epoch=0/micro_step=5900/global_step=5900, RunningAvgSamplesPerSec=4.462710819898454, CurrSamplesPerSec=4.463732672229432, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:44:45,294] [INFO] [RANK 0]  iteration     5900/   10000 | elapsed time per iteration (ms): 910.7 | learning rate 4.557E-05 | total loss 1.734904E-01 | loss 1.734904E-01 | loss scale 32768.0 |speed 263.53 samples/(min*GPU)
[2024-06-18 16:44:45,295] [INFO] [RANK 0] time (ms) | forward: 355.81 | backward: 548.93 | allreduce: 0.00 | optimizer: 5.19 | batch generator: 13.44 | data loader: 0.09
[2024-06-18 16:44:54,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=5910, skipped=29, lr=[4.5445864721921566e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:44:54,406] [INFO] [timer.py:258:stop] epoch=0/micro_step=5910/global_step=5910, RunningAvgSamplesPerSec=4.462696892161231, CurrSamplesPerSec=4.457511116401261, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:45:03,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=5920, skipped=29, lr=[4.5307763493540334e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:45:03,532] [INFO] [timer.py:258:stop] epoch=0/micro_step=5920/global_step=5920, RunningAvgSamplesPerSec=4.462685202564395, CurrSamplesPerSec=4.461491576805967, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:45:12,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=5930, skipped=29, lr=[4.5169757923620526e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:45:12,644] [INFO] [timer.py:258:stop] epoch=0/micro_step=5930/global_step=5930, RunningAvgSamplesPerSec=4.462687286127167, CurrSamplesPerSec=4.464390709120364, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:45:21,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=5940, skipped=29, lr=[4.503184937422136e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:45:21,765] [INFO] [timer.py:258:stop] epoch=0/micro_step=5940/global_step=5940, RunningAvgSamplesPerSec=4.462676186884089, CurrSamplesPerSec=4.442125753671584, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:45:30,901] [INFO] [logging.py:96:log_dist] [Rank 0] step=5950, skipped=29, lr=[4.489403920644456e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:45:30,902] [INFO] [timer.py:258:stop] epoch=0/micro_step=5950/global_step=5950, RunningAvgSamplesPerSec=4.462662414443265, CurrSamplesPerSec=4.461413274135784, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:45:30,903] [INFO] [RANK 0]  iteration     5950/   10000 | elapsed time per iteration (ms): 912.2 | learning rate 4.488E-05 | total loss 1.344710E-01 | loss 1.344710E-01 | loss scale 32768.0 |speed 263.11 samples/(min*GPU)
[2024-06-18 16:45:30,904] [INFO] [RANK 0] time (ms) | forward: 356.94 | backward: 549.15 | allreduce: 0.00 | optimizer: 5.28 | batch generator: 14.07 | data loader: 0.10
[2024-06-18 16:45:40,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=5960, skipped=29, lr=[4.4756328780420874e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:45:40,063] [INFO] [timer.py:258:stop] epoch=0/micro_step=5960/global_step=5960, RunningAvgSamplesPerSec=4.462633213812445, CurrSamplesPerSec=4.458946961087505, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:45:49,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=5970, skipped=29, lr=[4.461871945529657e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:45:49,193] [INFO] [timer.py:258:stop] epoch=0/micro_step=5970/global_step=5970, RunningAvgSamplesPerSec=4.462632325122676, CurrSamplesPerSec=4.455211191605605, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:45:58,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=5980, skipped=29, lr=[4.448121258922019e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:45:58,326] [INFO] [timer.py:258:stop] epoch=0/micro_step=5980/global_step=5980, RunningAvgSamplesPerSec=4.462619163654886, CurrSamplesPerSec=4.436372444233371, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:46:07,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=5990, skipped=29, lr=[4.43438095393289e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:46:07,456] [INFO] [timer.py:258:stop] epoch=0/micro_step=5990/global_step=5990, RunningAvgSamplesPerSec=4.462606447248715, CurrSamplesPerSec=4.449263482272259, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:46:16,600] [INFO] [logging.py:96:log_dist] [Rank 0] step=6000, skipped=29, lr=[4.4206511661735404e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:46:16,601] [INFO] [timer.py:258:stop] epoch=0/micro_step=6000/global_step=6000, RunningAvgSamplesPerSec=4.462605865902418, CurrSamplesPerSec=4.465732327285494, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:46:16,602] [INFO] [RANK 0]  iteration     6000/   10000 | elapsed time per iteration (ms): 914.0 | learning rate 4.419E-05 | total loss 9.336786E-02 | loss 9.336786E-02 | loss scale 32768.0 |speed 262.59 samples/(min*GPU)
[2024-06-18 16:46:16,604] [INFO] [RANK 0] time (ms) | forward: 358.27 | backward: 549.22 | allreduce: 0.00 | optimizer: 5.68 | batch generator: 15.26 | data loader: 0.11
[2024-06-18 16:46:16,604] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:46:16,622] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/6000/mp_rank_00_model_states.pt
[2024-06-18 16:46:16,622] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/6000/mp_rank_00_model_states.pt...
[2024-06-18 16:46:39,833] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/6000/mp_rank_00_model_states.pt.
[2024-06-18 16:46:46,465] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 16:46:46,465] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 16:46:46,465] [INFO] [RANK 0]  validation loss at iteration 6000 | loss: 1.830078E-01 | PPL: 1.200824E+00 loss 1.829834E-01 |
[2024-06-18 16:46:46,465] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 16:46:55,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=6010, skipped=29, lr=[4.4069320311514286e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:46:55,520] [INFO] [timer.py:258:stop] epoch=0/micro_step=6010/global_step=6010, RunningAvgSamplesPerSec=4.462662032093889, CurrSamplesPerSec=4.490048930385467, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:47:04,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=6020, skipped=29, lr=[4.393223684268881e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:47:04,589] [INFO] [timer.py:258:stop] epoch=0/micro_step=6020/global_step=6020, RunningAvgSamplesPerSec=4.462691557815827, CurrSamplesPerSec=4.484948868979801, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:47:13,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=6030, skipped=29, lr=[4.3795262608217456e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:47:13,691] [INFO] [timer.py:258:stop] epoch=0/micro_step=6030/global_step=6030, RunningAvgSamplesPerSec=4.462693465321601, CurrSamplesPerSec=4.473136994555625, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:47:22,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=6040, skipped=29, lr=[4.365839895998061e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:47:22,793] [INFO] [timer.py:258:stop] epoch=0/micro_step=6040/global_step=6040, RunningAvgSamplesPerSec=4.462698989048232, CurrSamplesPerSec=4.465680025914825, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:47:31,874] [INFO] [logging.py:96:log_dist] [Rank 0] step=6050, skipped=29, lr=[4.3521647248767256e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:47:31,874] [INFO] [timer.py:258:stop] epoch=0/micro_step=6050/global_step=6050, RunningAvgSamplesPerSec=4.462707128728058, CurrSamplesPerSec=4.458653082615171, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:47:31,876] [INFO] [RANK 0]  iteration     6050/   10000 | elapsed time per iteration (ms): 1505.5 | learning rate 4.351E-05 | total loss 1.060253E-01 | loss 1.060253E-01 | loss scale 32768.0 |speed 159.42 samples/(min*GPU)
[2024-06-18 16:47:31,877] [INFO] [RANK 0] time (ms) | forward: 355.55 | backward: 546.28 | allreduce: 0.00 | optimizer: 5.25 | batch generator: 16.71 | data loader: 0.14
[2024-06-18 16:47:40,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=6060, skipped=29, lr=[4.338500882426155e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:47:40,989] [INFO] [timer.py:258:stop] epoch=0/micro_step=6060/global_step=6060, RunningAvgSamplesPerSec=4.462703645953212, CurrSamplesPerSec=4.462728174223176, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:47:50,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=6070, skipped=29, lr=[4.324848503502959e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:47:50,148] [INFO] [timer.py:258:stop] epoch=0/micro_step=6070/global_step=6070, RunningAvgSamplesPerSec=4.462687369117772, CurrSamplesPerSec=4.459038213494736, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:47:59,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=6080, skipped=29, lr=[4.311207722850605e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:47:59,274] [INFO] [timer.py:258:stop] epoch=0/micro_step=6080/global_step=6080, RunningAvgSamplesPerSec=4.462681810512593, CurrSamplesPerSec=4.452498842237818, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:48:08,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=6090, skipped=29, lr=[4.2975786750980933e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:48:08,406] [INFO] [timer.py:258:stop] epoch=0/micro_step=6090/global_step=6090, RunningAvgSamplesPerSec=4.462670705185861, CurrSamplesPerSec=4.454767578142633, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:48:17,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=6100, skipped=29, lr=[4.283961494758619e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:48:17,526] [INFO] [timer.py:258:stop] epoch=0/micro_step=6100/global_step=6100, RunningAvgSamplesPerSec=4.462665696159766, CurrSamplesPerSec=4.458436253579897, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:48:17,527] [INFO] [RANK 0]  iteration     6100/   10000 | elapsed time per iteration (ms): 913.0 | learning rate 4.283E-05 | total loss 1.321929E-01 | loss 1.321929E-01 | loss scale 32768.0 |speed 262.86 samples/(min*GPU)
[2024-06-18 16:48:17,528] [INFO] [RANK 0] time (ms) | forward: 357.68 | backward: 548.73 | allreduce: 0.00 | optimizer: 5.80 | batch generator: 14.69 | data loader: 0.10
[2024-06-18 16:48:26,631] [INFO] [logging.py:96:log_dist] [Rank 0] step=6110, skipped=29, lr=[4.2703563162282576e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:48:26,632] [INFO] [timer.py:258:stop] epoch=0/micro_step=6110/global_step=6110, RunningAvgSamplesPerSec=4.462664523166191, CurrSamplesPerSec=4.468234714463583, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:48:35,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=6120, skipped=29, lr=[4.2567632737846283e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:48:35,745] [INFO] [timer.py:258:stop] epoch=0/micro_step=6120/global_step=6120, RunningAvgSamplesPerSec=4.462651842502631, CurrSamplesPerSec=4.448631129516687, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:48:37,564] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 16:48:38,467] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 16:48:44,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=6130, skipped=31, lr=[4.2458976679702993e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:48:44,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=6130/global_step=6130, RunningAvgSamplesPerSec=4.4626574428049945, CurrSamplesPerSec=4.462429049435321, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:48:53,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=6140, skipped=31, lr=[4.23232680847921e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:48:53,947] [INFO] [timer.py:258:stop] epoch=0/micro_step=6140/global_step=6140, RunningAvgSamplesPerSec=4.4626480160571464, CurrSamplesPerSec=4.465393578773777, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:49:03,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=6150, skipped=31, lr=[4.218768460410741e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:49:03,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=6150/global_step=6150, RunningAvgSamplesPerSec=4.462638580627362, CurrSamplesPerSec=4.467790883342015, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:49:03,086] [INFO] [RANK 0]  iteration     6150/   10000 | elapsed time per iteration (ms): 911.2 | learning rate 4.217E-05 | total loss 1.105403E-01 | loss 1.105403E-01 | loss scale 32768.0 |speed 263.40 samples/(min*GPU)
[2024-06-18 16:49:03,086] [INFO] [RANK 0] time (ms) | forward: 356.40 | backward: 548.79 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 13.49 | data loader: 0.09
[2024-06-18 16:49:12,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=6160, skipped=31, lr=[4.2052227575803136e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:49:12,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=6160/global_step=6160, RunningAvgSamplesPerSec=4.46263788701826, CurrSamplesPerSec=4.467557699108258, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:49:21,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=6170, skipped=31, lr=[4.1916898336785456e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:49:21,300] [INFO] [timer.py:258:stop] epoch=0/micro_step=6170/global_step=6170, RunningAvgSamplesPerSec=4.462633764654682, CurrSamplesPerSec=4.469707246869487, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:49:30,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=6180, skipped=31, lr=[4.178169822269933e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:49:30,411] [INFO] [timer.py:258:stop] epoch=0/micro_step=6180/global_step=6180, RunningAvgSamplesPerSec=4.462628851929712, CurrSamplesPerSec=4.471471515491369, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:49:39,512] [INFO] [logging.py:96:log_dist] [Rank 0] step=6190, skipped=31, lr=[4.16466285679153e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:49:39,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=6190/global_step=6190, RunningAvgSamplesPerSec=4.462625497577482, CurrSamplesPerSec=4.447155945598918, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:49:48,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=6200, skipped=31, lr=[4.1511690705516344e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:49:48,642] [INFO] [timer.py:258:stop] epoch=0/micro_step=6200/global_step=6200, RunningAvgSamplesPerSec=4.462606116233757, CurrSamplesPerSec=4.431682649434299, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:49:48,644] [INFO] [RANK 0]  iteration     6200/   10000 | elapsed time per iteration (ms): 911.2 | learning rate 4.150E-05 | total loss 1.235012E-01 | loss 1.235012E-01 | loss scale 32768.0 |speed 263.40 samples/(min*GPU)
[2024-06-18 16:49:48,644] [INFO] [RANK 0] time (ms) | forward: 356.17 | backward: 548.97 | allreduce: 0.00 | optimizer: 5.23 | batch generator: 13.39 | data loader: 0.09
[2024-06-18 16:49:57,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=6210, skipped=31, lr=[4.137688596728467e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:49:57,793] [INFO] [timer.py:258:stop] epoch=0/micro_step=6210/global_step=6210, RunningAvgSamplesPerSec=4.462586364606889, CurrSamplesPerSec=4.45075069140011, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:50:06,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=6220, skipped=31, lr=[4.124221568368862e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:50:06,917] [INFO] [timer.py:258:stop] epoch=0/micro_step=6220/global_step=6220, RunningAvgSamplesPerSec=4.462583017898767, CurrSamplesPerSec=4.467378068670042, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:50:16,032] [INFO] [logging.py:96:log_dist] [Rank 0] step=6230, skipped=31, lr=[4.110768118386952e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:50:16,033] [INFO] [timer.py:258:stop] epoch=0/micro_step=6230/global_step=6230, RunningAvgSamplesPerSec=4.462575728888688, CurrSamplesPerSec=4.4507022824378195, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:50:25,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=6240, skipped=31, lr=[4.097328379562859e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:50:25,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=6240/global_step=6240, RunningAvgSamplesPerSec=4.462570144630758, CurrSamplesPerSec=4.460031565675027, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:50:34,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=6250, skipped=31, lr=[4.0839024845413785e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:50:34,229] [INFO] [timer.py:258:stop] epoch=0/micro_step=6250/global_step=6250, RunningAvgSamplesPerSec=4.462555968380581, CurrSamplesPerSec=4.436229330298498, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:50:34,231] [INFO] [RANK 0]  iteration     6250/   10000 | elapsed time per iteration (ms): 911.7 | learning rate 4.083E-05 | total loss 1.301151E-01 | loss 1.301151E-01 | loss scale 32768.0 |speed 263.23 samples/(min*GPU)
[2024-06-18 16:50:34,231] [INFO] [RANK 0] time (ms) | forward: 356.63 | backward: 549.08 | allreduce: 0.00 | optimizer: 5.24 | batch generator: 13.56 | data loader: 0.10
[2024-06-18 16:50:43,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=6260, skipped=31, lr=[4.070490565830674e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:50:43,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=6260/global_step=6260, RunningAvgSamplesPerSec=4.46255450630702, CurrSamplesPerSec=4.465874973614224, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:50:52,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=6270, skipped=31, lr=[4.057092755800968e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:50:52,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=6270/global_step=6270, RunningAvgSamplesPerSec=4.462549615949768, CurrSamplesPerSec=4.450207626820796, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:51:01,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=6280, skipped=31, lr=[4.043709186683236e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:51:01,570] [INFO] [timer.py:258:stop] epoch=0/micro_step=6280/global_step=6280, RunningAvgSamplesPerSec=4.462543747616847, CurrSamplesPerSec=4.45954668814409, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:51:10,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=6290, skipped=31, lr=[4.030339990567905e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:51:10,670] [INFO] [timer.py:258:stop] epoch=0/micro_step=6290/global_step=6290, RunningAvgSamplesPerSec=4.46253601272609, CurrSamplesPerSec=4.4532528606545565, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:51:19,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=6300, skipped=31, lr=[4.0169852994035405e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:51:19,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=6300/global_step=6300, RunningAvgSamplesPerSec=4.462532417833057, CurrSamplesPerSec=4.445900864338568, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:51:19,791] [INFO] [RANK 0]  iteration     6300/   10000 | elapsed time per iteration (ms): 911.2 | learning rate 4.016E-05 | total loss 1.599073E-01 | loss 1.599073E-01 | loss scale 32768.0 |speed 263.39 samples/(min*GPU)
[2024-06-18 16:51:19,791] [INFO] [RANK 0] time (ms) | forward: 355.99 | backward: 549.29 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 13.68 | data loader: 0.09
[2024-06-18 16:51:19,791] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:51:19,808] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/6300/mp_rank_00_model_states.pt
[2024-06-18 16:51:19,808] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/6300/mp_rank_00_model_states.pt...
[2024-06-18 16:51:43,254] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/6300/mp_rank_00_model_states.pt.
[2024-06-18 16:51:52,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=6310, skipped=31, lr=[4.0036452449955534e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:51:52,313] [INFO] [timer.py:258:stop] epoch=0/micro_step=6310/global_step=6310, RunningAvgSamplesPerSec=4.462582913376578, CurrSamplesPerSec=4.484818189035714, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:52:01,351] [INFO] [logging.py:96:log_dist] [Rank 0] step=6320, skipped=31, lr=[3.990319959004896e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:52:01,352] [INFO] [timer.py:258:stop] epoch=0/micro_step=6320/global_step=6320, RunningAvgSamplesPerSec=4.462634557487263, CurrSamplesPerSec=4.490488781684545, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:52:10,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=6330, skipped=31, lr=[3.977009572946761e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:52:10,434] [INFO] [timer.py:258:stop] epoch=0/micro_step=6330/global_step=6330, RunningAvgSamplesPerSec=4.462666144011707, CurrSamplesPerSec=4.470631497547673, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:52:19,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=6340, skipped=31, lr=[3.963714218189283e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:52:19,546] [INFO] [timer.py:258:stop] epoch=0/micro_step=6340/global_step=6340, RunningAvgSamplesPerSec=4.462674612114136, CurrSamplesPerSec=4.467720687567955, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:52:28,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=6350, skipped=31, lr=[3.950434025952249e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:52:28,644] [INFO] [timer.py:258:stop] epoch=0/micro_step=6350/global_step=6350, RunningAvgSamplesPerSec=4.462682035369038, CurrSamplesPerSec=4.459334513295036, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:52:28,645] [INFO] [RANK 0]  iteration     6350/   10000 | elapsed time per iteration (ms): 1377.1 | learning rate 3.949E-05 | total loss 1.319602E-01 | loss 1.319602E-01 | loss scale 32768.0 |speed 174.28 samples/(min*GPU)
[2024-06-18 16:52:28,646] [INFO] [RANK 0] time (ms) | forward: 355.63 | backward: 545.82 | allreduce: 0.00 | optimizer: 5.22 | batch generator: 14.34 | data loader: 0.11
[2024-06-18 16:52:37,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=6360, skipped=31, lr=[3.937169127305794e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:52:37,764] [INFO] [timer.py:258:stop] epoch=0/micro_step=6360/global_step=6360, RunningAvgSamplesPerSec=4.462676461482356, CurrSamplesPerSec=4.460849813254007, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:52:46,890] [INFO] [logging.py:96:log_dist] [Rank 0] step=6370, skipped=31, lr=[3.923919653169112e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:52:46,891] [INFO] [timer.py:258:stop] epoch=0/micro_step=6370/global_step=6370, RunningAvgSamplesPerSec=4.462665502058433, CurrSamplesPerSec=4.462150139831032, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:52:56,015] [INFO] [logging.py:96:log_dist] [Rank 0] step=6380, skipped=31, lr=[3.9106857343091636e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:52:56,016] [INFO] [timer.py:258:stop] epoch=0/micro_step=6380/global_step=6380, RunningAvgSamplesPerSec=4.462660227150597, CurrSamplesPerSec=4.461849905907959, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:53:05,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=6390, skipped=31, lr=[3.8974675013393864e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:53:05,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=6390/global_step=6390, RunningAvgSamplesPerSec=4.462647739484817, CurrSamplesPerSec=4.456340142642485, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:53:14,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=6400, skipped=31, lr=[3.8842650847184014e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:53:14,245] [INFO] [timer.py:258:stop] epoch=0/micro_step=6400/global_step=6400, RunningAvgSamplesPerSec=4.462640625345143, CurrSamplesPerSec=4.459183988075684, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:53:14,246] [INFO] [RANK 0]  iteration     6400/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 3.883E-05 | total loss 1.353365E-01 | loss 1.353365E-01 | loss scale 32768.0 |speed 263.15 samples/(min*GPU)
[2024-06-18 16:53:14,247] [INFO] [RANK 0] time (ms) | forward: 357.41 | backward: 548.68 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 14.05 | data loader: 0.18
[2024-06-18 16:53:23,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=6410, skipped=31, lr=[3.871078614748732e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:53:23,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=6410/global_step=6410, RunningAvgSamplesPerSec=4.462620992011095, CurrSamplesPerSec=4.455214740869543, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:53:32,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=6420, skipped=31, lr=[3.857908221575512e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:53:32,474] [INFO] [timer.py:258:stop] epoch=0/micro_step=6420/global_step=6420, RunningAvgSamplesPerSec=4.462606857410985, CurrSamplesPerSec=4.44987949116547, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:53:41,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=6430, skipped=31, lr=[3.844754035185207e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:53:41,602] [INFO] [timer.py:258:stop] epoch=0/micro_step=6430/global_step=6430, RunningAvgSamplesPerSec=4.462595679008006, CurrSamplesPerSec=4.4604904588686765, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:53:50,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=6440, skipped=31, lr=[3.831616185404325e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:53:50,716] [INFO] [timer.py:258:stop] epoch=0/micro_step=6440/global_step=6440, RunningAvgSamplesPerSec=4.462595443407768, CurrSamplesPerSec=4.469063117744725, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:53:59,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=6450, skipped=31, lr=[3.818494801898138e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:53:59,816] [INFO] [timer.py:258:stop] epoch=0/micro_step=6450/global_step=6450, RunningAvgSamplesPerSec=4.462587853604927, CurrSamplesPerSec=4.464217272629062, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:53:59,818] [INFO] [RANK 0]  iteration     6450/   10000 | elapsed time per iteration (ms): 911.4 | learning rate 3.817E-05 | total loss 1.270967E-01 | loss 1.270967E-01 | loss scale 32768.0 |speed 263.32 samples/(min*GPU)
[2024-06-18 16:53:59,818] [INFO] [RANK 0] time (ms) | forward: 356.50 | backward: 549.00 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 13.08 | data loader: 0.11
[2024-06-18 16:54:08,913] [INFO] [logging.py:96:log_dist] [Rank 0] step=6460, skipped=31, lr=[3.8053900141694055e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:54:08,914] [INFO] [timer.py:258:stop] epoch=0/micro_step=6460/global_step=6460, RunningAvgSamplesPerSec=4.46258217591628, CurrSamplesPerSec=4.4602758226493595, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:54:17,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=6470, skipped=31, lr=[3.792301951557092e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:54:17,999] [INFO] [timer.py:258:stop] epoch=0/micro_step=6470/global_step=6470, RunningAvgSamplesPerSec=4.462583067992919, CurrSamplesPerSec=4.471939917860448, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:54:27,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=6480, skipped=31, lr=[3.779230743235092e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:54:27,114] [INFO] [timer.py:258:stop] epoch=0/micro_step=6480/global_step=6480, RunningAvgSamplesPerSec=4.462585597832623, CurrSamplesPerSec=4.45993434461448, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:54:36,216] [INFO] [logging.py:96:log_dist] [Rank 0] step=6490, skipped=31, lr=[3.766176518210951e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:54:36,217] [INFO] [timer.py:258:stop] epoch=0/micro_step=6490/global_step=6490, RunningAvgSamplesPerSec=4.4625828548209805, CurrSamplesPerSec=4.465367431902493, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:54:45,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=6500, skipped=31, lr=[3.7531394053246044e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:54:45,327] [INFO] [timer.py:258:stop] epoch=0/micro_step=6500/global_step=6500, RunningAvgSamplesPerSec=4.462575823809412, CurrSamplesPerSec=4.464719800326314, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:54:45,329] [INFO] [RANK 0]  iteration     6500/   10000 | elapsed time per iteration (ms): 910.2 | learning rate 3.752E-05 | total loss 1.414305E-01 | loss 1.414305E-01 | loss scale 32768.0 |speed 263.67 samples/(min*GPU)
[2024-06-18 16:54:45,329] [INFO] [RANK 0] time (ms) | forward: 354.76 | backward: 549.14 | allreduce: 0.00 | optimizer: 5.58 | batch generator: 12.61 | data loader: 0.09
[2024-06-18 16:54:54,434] [INFO] [logging.py:96:log_dist] [Rank 0] step=6510, skipped=31, lr=[3.7401195332470904e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:54:54,435] [INFO] [timer.py:258:stop] epoch=0/micro_step=6510/global_step=6510, RunningAvgSamplesPerSec=4.462569978079409, CurrSamplesPerSec=4.449513641560579, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:55:03,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=6520, skipped=31, lr=[3.7271170304792915e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:55:03,530] [INFO] [timer.py:258:stop] epoch=0/micro_step=6520/global_step=6520, RunningAvgSamplesPerSec=4.46256725182582, CurrSamplesPerSec=4.450217070289819, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:55:07,149] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 16:55:08,060] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 16:55:12,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=6530, skipped=33, lr=[3.71672762041123e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:55:12,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=6530/global_step=6530, RunningAvgSamplesPerSec=4.462569222456638, CurrSamplesPerSec=4.45861872032354, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:55:21,730] [INFO] [logging.py:96:log_dist] [Rank 0] step=6540, skipped=33, lr=[3.70375670567513e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:55:21,730] [INFO] [timer.py:258:stop] epoch=0/micro_step=6540/global_step=6540, RunningAvgSamplesPerSec=4.462559800939277, CurrSamplesPerSec=4.4597363587307575, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:55:30,842] [INFO] [logging.py:96:log_dist] [Rank 0] step=6550, skipped=33, lr=[3.690803519135171e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:55:30,843] [INFO] [timer.py:258:stop] epoch=0/micro_step=6550/global_step=6550, RunningAvgSamplesPerSec=4.462551392561284, CurrSamplesPerSec=4.4573950571560506, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:55:30,844] [INFO] [RANK 0]  iteration     6550/   10000 | elapsed time per iteration (ms): 910.3 | learning rate 3.690E-05 | total loss 1.261707E-01 | loss 1.261707E-01 | loss scale 32768.0 |speed 263.65 samples/(min*GPU)
[2024-06-18 16:55:30,845] [INFO] [RANK 0] time (ms) | forward: 355.60 | backward: 548.99 | allreduce: 0.00 | optimizer: 5.01 | batch generator: 12.83 | data loader: 0.10
[2024-06-18 16:55:39,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=6560, skipped=33, lr=[3.677868188634077e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:55:39,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=6560/global_step=6560, RunningAvgSamplesPerSec=4.462537078202855, CurrSamplesPerSec=4.44963637149649, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:55:49,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=6570, skipped=33, lr=[3.664950841838337e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:55:49,105] [INFO] [timer.py:258:stop] epoch=0/micro_step=6570/global_step=6570, RunningAvgSamplesPerSec=4.462514314390999, CurrSamplesPerSec=4.444409829868476, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:55:58,220] [INFO] [logging.py:96:log_dist] [Rank 0] step=6580, skipped=33, lr=[3.652051606236949e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:55:58,221] [INFO] [timer.py:258:stop] epoch=0/micro_step=6580/global_step=6580, RunningAvgSamplesPerSec=4.462501266368193, CurrSamplesPerSec=4.460074249430767, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:56:07,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=6590, skipped=33, lr=[3.639170609140159e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:56:07,327] [INFO] [timer.py:258:stop] epoch=0/micro_step=6590/global_step=6590, RunningAvgSamplesPerSec=4.462498976687978, CurrSamplesPerSec=4.456986529325489, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:56:16,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=6600, skipped=33, lr=[3.6263079776782106e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:56:16,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=6600/global_step=6600, RunningAvgSamplesPerSec=4.462477976299489, CurrSamplesPerSec=4.418244954648855, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:56:16,466] [INFO] [RANK 0]  iteration     6600/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 3.625E-05 | total loss 1.150672E-01 | loss 1.150672E-01 | loss scale 32768.0 |speed 263.03 samples/(min*GPU)
[2024-06-18 16:56:16,467] [INFO] [RANK 0] time (ms) | forward: 357.09 | backward: 549.07 | allreduce: 0.00 | optimizer: 5.42 | batch generator: 13.54 | data loader: 0.10
[2024-06-18 16:56:16,468] [INFO] [RANK 0] Saving Model...
[2024-06-18 16:56:16,485] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/6600/mp_rank_00_model_states.pt
[2024-06-18 16:56:16,485] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/6600/mp_rank_00_model_states.pt...
[2024-06-18 16:56:41,605] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/6600/mp_rank_00_model_states.pt.
[2024-06-18 16:56:50,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=6610, skipped=33, lr=[3.613463838800081e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:56:50,657] [INFO] [timer.py:258:stop] epoch=0/micro_step=6610/global_step=6610, RunningAvgSamplesPerSec=4.462538075015925, CurrSamplesPerSec=4.5039445584636795, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:56:59,695] [INFO] [logging.py:96:log_dist] [Rank 0] step=6620, skipped=33, lr=[3.600638319272239e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:56:59,696] [INFO] [timer.py:258:stop] epoch=0/micro_step=6620/global_step=6620, RunningAvgSamplesPerSec=4.462588534403449, CurrSamplesPerSec=4.5015336731956, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:57:08,748] [INFO] [logging.py:96:log_dist] [Rank 0] step=6630, skipped=33, lr=[3.5878315456773826e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:57:08,748] [INFO] [timer.py:258:stop] epoch=0/micro_step=6630/global_step=6630, RunningAvgSamplesPerSec=4.46262966662329, CurrSamplesPerSec=4.492038561902156, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:57:17,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=6640, skipped=33, lr=[3.575043644413195e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:57:17,817] [INFO] [timer.py:258:stop] epoch=0/micro_step=6640/global_step=6640, RunningAvgSamplesPerSec=4.462654337041478, CurrSamplesPerSec=4.475217902988491, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:57:26,893] [INFO] [logging.py:96:log_dist] [Rank 0] step=6650, skipped=33, lr=[3.562274741691103e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:57:26,894] [INFO] [timer.py:258:stop] epoch=0/micro_step=6650/global_step=6650, RunningAvgSamplesPerSec=4.4626701213134945, CurrSamplesPerSec=4.461607849477921, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:57:26,895] [INFO] [RANK 0]  iteration     6650/   10000 | elapsed time per iteration (ms): 1408.6 | learning rate 3.561E-05 | total loss 1.118880E-01 | loss 1.118880E-01 | loss scale 32768.0 |speed 170.38 samples/(min*GPU)
[2024-06-18 16:57:26,896] [INFO] [RANK 0] time (ms) | forward: 354.17 | backward: 545.59 | allreduce: 0.00 | optimizer: 5.02 | batch generator: 13.72 | data loader: 0.10
[2024-06-18 16:57:36,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=6660, skipped=33, lr=[3.549524963535016e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:57:36,018] [INFO] [timer.py:258:stop] epoch=0/micro_step=6660/global_step=6660, RunningAvgSamplesPerSec=4.462664247580063, CurrSamplesPerSec=4.462427862512072, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:57:45,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=6670, skipped=33, lr=[3.536794435780103e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:57:45,126] [INFO] [timer.py:258:stop] epoch=0/micro_step=6670/global_step=6670, RunningAvgSamplesPerSec=4.462657974019955, CurrSamplesPerSec=4.461310061179018, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:57:54,239] [INFO] [logging.py:96:log_dist] [Rank 0] step=6680, skipped=33, lr=[3.524083284071529e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:57:54,239] [INFO] [timer.py:258:stop] epoch=0/micro_step=6680/global_step=6680, RunningAvgSamplesPerSec=4.462653527026286, CurrSamplesPerSec=4.4622664468321025, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:58:03,367] [INFO] [logging.py:96:log_dist] [Rank 0] step=6690, skipped=33, lr=[3.511391633863233e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:58:03,367] [INFO] [timer.py:258:stop] epoch=0/micro_step=6690/global_step=6690, RunningAvgSamplesPerSec=4.462636613474295, CurrSamplesPerSec=4.454991148285274, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:58:12,480] [INFO] [logging.py:96:log_dist] [Rank 0] step=6700, skipped=33, lr=[3.498719610416675e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:58:12,481] [INFO] [timer.py:258:stop] epoch=0/micro_step=6700/global_step=6700, RunningAvgSamplesPerSec=4.4626236807826825, CurrSamplesPerSec=4.454149032734401, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:58:12,482] [INFO] [RANK 0]  iteration     6700/   10000 | elapsed time per iteration (ms): 911.7 | learning rate 3.497E-05 | total loss 1.065317E-01 | loss 1.065317E-01 | loss scale 32768.0 |speed 263.23 samples/(min*GPU)
[2024-06-18 16:58:12,483] [INFO] [RANK 0] time (ms) | forward: 356.99 | backward: 548.82 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 13.53 | data loader: 0.10
[2024-06-18 16:58:21,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=6710, skipped=33, lr=[3.486067338799615e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:58:21,587] [INFO] [timer.py:258:stop] epoch=0/micro_step=6710/global_step=6710, RunningAvgSamplesPerSec=4.462616388448018, CurrSamplesPerSec=4.473878931360162, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:58:30,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=6720, skipped=33, lr=[3.473434943884863e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:58:30,722] [INFO] [timer.py:258:stop] epoch=0/micro_step=6720/global_step=6720, RunningAvgSamplesPerSec=4.462599212671212, CurrSamplesPerSec=4.434061462906938, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:58:39,853] [INFO] [logging.py:96:log_dist] [Rank 0] step=6730, skipped=33, lr=[3.460822550349055e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:58:39,854] [INFO] [timer.py:258:stop] epoch=0/micro_step=6730/global_step=6730, RunningAvgSamplesPerSec=4.4625925562641475, CurrSamplesPerSec=4.458871117773064, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:58:48,994] [INFO] [logging.py:96:log_dist] [Rank 0] step=6740, skipped=33, lr=[3.4482302826714286e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:58:48,995] [INFO] [timer.py:258:stop] epoch=0/micro_step=6740/global_step=6740, RunningAvgSamplesPerSec=4.46257953732305, CurrSamplesPerSec=4.457444796092526, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:58:58,118] [INFO] [logging.py:96:log_dist] [Rank 0] step=6750, skipped=33, lr=[3.435658265132579e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:58:58,118] [INFO] [timer.py:258:stop] epoch=0/micro_step=6750/global_step=6750, RunningAvgSamplesPerSec=4.462561211519056, CurrSamplesPerSec=4.458718253933452, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:58:58,120] [INFO] [RANK 0]  iteration     6750/   10000 | elapsed time per iteration (ms): 912.8 | learning rate 3.434E-05 | total loss 1.618382E-01 | loss 1.618382E-01 | loss scale 32768.0 |speed 262.94 samples/(min*GPU)
[2024-06-18 16:58:58,120] [INFO] [RANK 0] time (ms) | forward: 357.83 | backward: 548.85 | allreduce: 0.00 | optimizer: 5.26 | batch generator: 14.07 | data loader: 0.10
[2024-06-18 16:59:07,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=6760, skipped=33, lr=[3.423106621813244e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:59:07,238] [INFO] [timer.py:258:stop] epoch=0/micro_step=6760/global_step=6760, RunningAvgSamplesPerSec=4.462557772532537, CurrSamplesPerSec=4.463672104576874, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:59:16,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=6770, skipped=33, lr=[3.410575476593075e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:59:16,350] [INFO] [timer.py:258:stop] epoch=0/micro_step=6770/global_step=6770, RunningAvgSamplesPerSec=4.462554236028801, CurrSamplesPerSec=4.465355547062224, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:59:25,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=6780, skipped=33, lr=[3.398064953149418e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:59:25,485] [INFO] [timer.py:258:stop] epoch=0/micro_step=6780/global_step=6780, RunningAvgSamplesPerSec=4.462548606381267, CurrSamplesPerSec=4.466717961688476, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:59:34,612] [INFO] [logging.py:96:log_dist] [Rank 0] step=6790, skipped=33, lr=[3.385575174956086e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:59:34,613] [INFO] [timer.py:258:stop] epoch=0/micro_step=6790/global_step=6790, RunningAvgSamplesPerSec=4.462536172732818, CurrSamplesPerSec=4.443658802804684, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:59:43,737] [INFO] [logging.py:96:log_dist] [Rank 0] step=6800, skipped=33, lr=[3.3731062652821515e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:59:43,738] [INFO] [timer.py:258:stop] epoch=0/micro_step=6800/global_step=6800, RunningAvgSamplesPerSec=4.462531252215419, CurrSamplesPerSec=4.464854064463179, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 16:59:43,740] [INFO] [RANK 0]  iteration     6800/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 3.372E-05 | total loss 1.254050E-01 | loss 1.254050E-01 | loss scale 32768.0 |speed 263.04 samples/(min*GPU)
[2024-06-18 16:59:43,741] [INFO] [RANK 0] time (ms) | forward: 357.49 | backward: 548.92 | allreduce: 0.00 | optimizer: 5.22 | batch generator: 14.64 | data loader: 0.10
[2024-06-18 16:59:52,859] [INFO] [logging.py:96:log_dist] [Rank 0] step=6810, skipped=33, lr=[3.360658347190715e-05], mom=[[0.9, 0.95]]
[2024-06-18 16:59:52,860] [INFO] [timer.py:258:stop] epoch=0/micro_step=6810/global_step=6810, RunningAvgSamplesPerSec=4.462523363384805, CurrSamplesPerSec=4.451254915632334, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:00:01,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=6820, skipped=33, lr=[3.348231543537707e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:00:01,998] [INFO] [timer.py:258:stop] epoch=0/micro_step=6820/global_step=6820, RunningAvgSamplesPerSec=4.462514468308458, CurrSamplesPerSec=4.456240715177983, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:00:11,126] [INFO] [logging.py:96:log_dist] [Rank 0] step=6830, skipped=33, lr=[3.335825976970658e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:00:11,127] [INFO] [timer.py:258:stop] epoch=0/micro_step=6830/global_step=6830, RunningAvgSamplesPerSec=4.462502022265216, CurrSamplesPerSec=4.451919910522259, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:00:20,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=6840, skipped=33, lr=[3.323441769927506e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:00:20,264] [INFO] [timer.py:258:stop] epoch=0/micro_step=6840/global_step=6840, RunningAvgSamplesPerSec=4.462496115096194, CurrSamplesPerSec=4.450251303200999, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:00:29,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=6850, skipped=33, lr=[3.311079044635372e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:00:29,397] [INFO] [timer.py:258:stop] epoch=0/micro_step=6850/global_step=6850, RunningAvgSamplesPerSec=4.462488168128894, CurrSamplesPerSec=4.456509416270393, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:00:29,400] [INFO] [RANK 0]  iteration     6850/   10000 | elapsed time per iteration (ms): 913.2 | learning rate 3.310E-05 | total loss 1.443258E-01 | loss 1.443258E-01 | loss scale 32768.0 |speed 262.82 samples/(min*GPU)
[2024-06-18 17:00:29,401] [INFO] [RANK 0] time (ms) | forward: 358.36 | backward: 548.82 | allreduce: 0.00 | optimizer: 5.21 | batch generator: 15.00 | data loader: 0.10
[2024-06-18 17:00:38,540] [INFO] [logging.py:96:log_dist] [Rank 0] step=6860, skipped=33, lr=[3.298737923109363e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:00:38,542] [INFO] [timer.py:258:stop] epoch=0/micro_step=6860/global_step=6860, RunningAvgSamplesPerSec=4.462468150930808, CurrSamplesPerSec=4.445263577923458, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:00:47,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=6870, skipped=33, lr=[3.286418527151369e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:00:47,678] [INFO] [timer.py:258:stop] epoch=0/micro_step=6870/global_step=6870, RunningAvgSamplesPerSec=4.462453380809787, CurrSamplesPerSec=4.46061616701957, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:00:56,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=6880, skipped=33, lr=[3.274120978348852e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:00:56,809] [INFO] [timer.py:258:stop] epoch=0/micro_step=6880/global_step=6880, RunningAvgSamplesPerSec=4.4624448118635485, CurrSamplesPerSec=4.45522302250739, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:01:05,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=6890, skipped=33, lr=[3.2618453980736553e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:01:05,931] [INFO] [timer.py:258:stop] epoch=0/micro_step=6890/global_step=6890, RunningAvgSamplesPerSec=4.462433822465371, CurrSamplesPerSec=4.45623242975621, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:01:15,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=6900, skipped=33, lr=[3.249591907480799e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:01:15,050] [INFO] [timer.py:258:stop] epoch=0/micro_step=6900/global_step=6900, RunningAvgSamplesPerSec=4.462424526638238, CurrSamplesPerSec=4.432772768430039, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:01:15,053] [INFO] [RANK 0]  iteration     6900/   10000 | elapsed time per iteration (ms): 913.1 | learning rate 3.248E-05 | total loss 1.135469E-01 | loss 1.135469E-01 | loss scale 32768.0 |speed 262.85 samples/(min*GPU)
[2024-06-18 17:01:15,053] [INFO] [RANK 0] time (ms) | forward: 358.01 | backward: 548.89 | allreduce: 0.00 | optimizer: 5.33 | batch generator: 14.21 | data loader: 0.11
[2024-06-18 17:01:15,054] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:01:15,066] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/6900/mp_rank_00_model_states.pt
[2024-06-18 17:01:15,066] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/6900/mp_rank_00_model_states.pt...
[2024-06-18 17:01:44,421] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/6900/mp_rank_00_model_states.pt.
[2024-06-18 17:01:53,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=6910, skipped=33, lr=[3.2373606275072914e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:01:53,472] [INFO] [timer.py:258:stop] epoch=0/micro_step=6910/global_step=6910, RunningAvgSamplesPerSec=4.462471481840783, CurrSamplesPerSec=4.507620835971947, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:02:02,519] [INFO] [logging.py:96:log_dist] [Rank 0] step=6920, skipped=33, lr=[3.225151678870924e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:02:02,520] [INFO] [timer.py:258:stop] epoch=0/micro_step=6920/global_step=6920, RunningAvgSamplesPerSec=4.462524804378211, CurrSamplesPerSec=4.4897245051451735, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:02:07,968] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 17:02:08,872] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 17:02:11,597] [INFO] [logging.py:96:log_dist] [Rank 0] step=6930, skipped=35, lr=[3.215400679506259e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:02:11,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=6930/global_step=6930, RunningAvgSamplesPerSec=4.462571048422618, CurrSamplesPerSec=4.488574975386328, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:02:20,667] [INFO] [logging.py:96:log_dist] [Rank 0] step=6940, skipped=35, lr=[3.2032322307813117e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:02:20,668] [INFO] [timer.py:258:stop] epoch=0/micro_step=6940/global_step=6940, RunningAvgSamplesPerSec=4.462597846170674, CurrSamplesPerSec=4.476650845474951, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:02:29,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=6950, skipped=35, lr=[3.1910864502270054e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:02:29,764] [INFO] [timer.py:258:stop] epoch=0/micro_step=6950/global_step=6950, RunningAvgSamplesPerSec=4.462599226051456, CurrSamplesPerSec=4.463233928760499, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:02:29,765] [INFO] [RANK 0]  iteration     6950/   10000 | elapsed time per iteration (ms): 1494.2 | learning rate 3.190E-05 | total loss 1.742360E-01 | loss 1.742360E-01 | loss scale 32768.0 |speed 160.62 samples/(min*GPU)
[2024-06-18 17:02:29,766] [INFO] [RANK 0] time (ms) | forward: 354.88 | backward: 545.52 | allreduce: 0.00 | optimizer: 5.35 | batch generator: 14.16 | data loader: 0.10
[2024-06-18 17:02:38,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=6960, skipped=35, lr=[3.178963457717287e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:02:38,866] [INFO] [timer.py:258:stop] epoch=0/micro_step=6960/global_step=6960, RunningAvgSamplesPerSec=4.4625983519623675, CurrSamplesPerSec=4.463001219947552, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:02:47,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=6970, skipped=35, lr=[3.1668633729012026e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:02:47,970] [INFO] [timer.py:258:stop] epoch=0/micro_step=6970/global_step=6970, RunningAvgSamplesPerSec=4.4625949298728775, CurrSamplesPerSec=4.449452279131444, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:02:57,077] [INFO] [logging.py:96:log_dist] [Rank 0] step=6980, skipped=35, lr=[3.1547863152017005e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:02:57,077] [INFO] [timer.py:258:stop] epoch=0/micro_step=6980/global_step=6980, RunningAvgSamplesPerSec=4.462596199129698, CurrSamplesPerSec=4.462255765324062, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:03:06,150] [INFO] [logging.py:96:log_dist] [Rank 0] step=6990, skipped=35, lr=[3.142732403814469e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:03:06,150] [INFO] [timer.py:258:stop] epoch=0/micro_step=6990/global_step=6990, RunningAvgSamplesPerSec=4.462600896529785, CurrSamplesPerSec=4.458704034574244, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:03:15,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=7000, skipped=35, lr=[3.1307017577067416e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:03:15,279] [INFO] [timer.py:258:stop] epoch=0/micro_step=7000/global_step=7000, RunningAvgSamplesPerSec=4.462596188373234, CurrSamplesPerSec=4.462808897306442, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:03:15,280] [INFO] [RANK 0]  iteration     7000/   10000 | elapsed time per iteration (ms): 910.3 | learning rate 3.129E-05 | total loss 1.150831E-01 | loss 1.150831E-01 | loss scale 32768.0 |speed 263.65 samples/(min*GPU)
[2024-06-18 17:03:15,281] [INFO] [RANK 0] time (ms) | forward: 355.60 | backward: 548.90 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 13.39 | data loader: 0.10
[2024-06-18 17:03:21,923] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 17:03:21,924] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 17:03:21,924] [INFO] [RANK 0]  validation loss at iteration 7000 | loss: 1.686203E-01 | PPL: 1.183671E+00 loss 1.687012E-01 |
[2024-06-18 17:03:21,924] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 17:03:31,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=7010, skipped=35, lr=[3.118694495616143e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:03:31,034] [INFO] [timer.py:258:stop] epoch=0/micro_step=7010/global_step=7010, RunningAvgSamplesPerSec=4.462587776299175, CurrSamplesPerSec=4.460604307457358, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:03:40,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=7020, skipped=35, lr=[3.106710736049501e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:03:40,145] [INFO] [timer.py:258:stop] epoch=0/micro_step=7020/global_step=7020, RunningAvgSamplesPerSec=4.4625903041897805, CurrSamplesPerSec=4.46237682540966, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:03:49,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=7030, skipped=35, lr=[3.094750597281683e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:03:49,245] [INFO] [timer.py:258:stop] epoch=0/micro_step=7030/global_step=7030, RunningAvgSamplesPerSec=4.462589746061505, CurrSamplesPerSec=4.461813121130669, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:03:58,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=7040, skipped=35, lr=[3.082814197354432e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:03:58,365] [INFO] [timer.py:258:stop] epoch=0/micro_step=7040/global_step=7040, RunningAvgSamplesPerSec=4.46257535023434, CurrSamplesPerSec=4.453183120962472, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:04:07,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=7050, skipped=35, lr=[3.070901654075195e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:04:07,497] [INFO] [timer.py:258:stop] epoch=0/micro_step=7050/global_step=7050, RunningAvgSamplesPerSec=4.462568607247225, CurrSamplesPerSec=4.445930318220316, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:04:07,499] [INFO] [RANK 0]  iteration     7050/   10000 | elapsed time per iteration (ms): 1044.4 | learning rate 3.070E-05 | total loss 1.626494E-01 | loss 1.626494E-01 | loss scale 32768.0 |speed 229.80 samples/(min*GPU)
[2024-06-18 17:04:07,499] [INFO] [RANK 0] time (ms) | forward: 356.44 | backward: 549.10 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 16.16 | data loader: 0.13
[2024-06-18 17:04:16,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=7060, skipped=35, lr=[3.059013085015967e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:04:16,615] [INFO] [timer.py:258:stop] epoch=0/micro_step=7060/global_step=7060, RunningAvgSamplesPerSec=4.4625677068650615, CurrSamplesPerSec=4.463438162609975, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:04:25,734] [INFO] [logging.py:96:log_dist] [Rank 0] step=7070, skipped=35, lr=[3.0471486075121214e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:04:25,734] [INFO] [timer.py:258:stop] epoch=0/micro_step=7070/global_step=7070, RunningAvgSamplesPerSec=4.462554587934378, CurrSamplesPerSec=4.405171868283984, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:04:34,854] [INFO] [logging.py:96:log_dist] [Rank 0] step=7080, skipped=35, lr=[3.0353083386612657e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:04:34,854] [INFO] [timer.py:258:stop] epoch=0/micro_step=7080/global_step=7080, RunningAvgSamplesPerSec=4.4625435230836485, CurrSamplesPerSec=4.457475587419013, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:04:43,962] [INFO] [logging.py:96:log_dist] [Rank 0] step=7090, skipped=35, lr=[3.023492395322069e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:04:43,963] [INFO] [timer.py:258:stop] epoch=0/micro_step=7090/global_step=7090, RunningAvgSamplesPerSec=4.462535787195107, CurrSamplesPerSec=4.453660704283603, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:04:53,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=7100, skipped=35, lr=[3.0117008941131262e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:04:53,103] [INFO] [timer.py:258:stop] epoch=0/micro_step=7100/global_step=7100, RunningAvgSamplesPerSec=4.46252209728686, CurrSamplesPerSec=4.451330500069779, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:04:53,104] [INFO] [RANK 0]  iteration     7100/   10000 | elapsed time per iteration (ms): 912.1 | learning rate 3.011E-05 | total loss 1.383733E-01 | loss 1.383733E-01 | loss scale 32768.0 |speed 263.13 samples/(min*GPU)
[2024-06-18 17:04:53,104] [INFO] [RANK 0] time (ms) | forward: 357.04 | backward: 549.05 | allreduce: 0.00 | optimizer: 5.21 | batch generator: 13.85 | data loader: 0.10
[2024-06-18 17:05:02,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=7110, skipped=35, lr=[2.9999339514117912e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:05:02,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=7110/global_step=7110, RunningAvgSamplesPerSec=4.462515588494986, CurrSamplesPerSec=4.4627436063515535, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:05:11,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=7120, skipped=35, lr=[2.9881916833530368e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:05:11,322] [INFO] [timer.py:258:stop] epoch=0/micro_step=7120/global_step=7120, RunningAvgSamplesPerSec=4.46250551460271, CurrSamplesPerSec=4.464271915548994, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:05:20,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=7130, skipped=35, lr=[2.9764742058283115e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:05:20,434] [INFO] [timer.py:258:stop] epoch=0/micro_step=7130/global_step=7130, RunningAvgSamplesPerSec=4.462487868700745, CurrSamplesPerSec=4.452201087122379, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:05:29,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=7140, skipped=35, lr=[2.9647816344843838e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:05:29,547] [INFO] [timer.py:258:stop] epoch=0/micro_step=7140/global_step=7140, RunningAvgSamplesPerSec=4.462482504869486, CurrSamplesPerSec=4.435666348698056, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:05:38,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=7150, skipped=35, lr=[2.9531140847222163e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:05:38,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=7150/global_step=7150, RunningAvgSamplesPerSec=4.462469195476866, CurrSamplesPerSec=4.458858082463229, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:05:38,685] [INFO] [RANK 0]  iteration     7150/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 2.952E-05 | total loss 1.240082E-01 | loss 1.240082E-01 | loss scale 32768.0 |speed 263.26 samples/(min*GPU)
[2024-06-18 17:05:38,686] [INFO] [RANK 0] time (ms) | forward: 356.06 | backward: 549.14 | allreduce: 0.00 | optimizer: 5.65 | batch generator: 12.90 | data loader: 0.10
[2024-06-18 17:05:47,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=7160, skipped=35, lr=[2.941471671695812e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:05:47,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=7160/global_step=7160, RunningAvgSamplesPerSec=4.462454626308959, CurrSamplesPerSec=4.45099157116096, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:05:56,922] [INFO] [logging.py:96:log_dist] [Rank 0] step=7170, skipped=35, lr=[2.9298545103110903e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:05:56,923] [INFO] [timer.py:258:stop] epoch=0/micro_step=7170/global_step=7170, RunningAvgSamplesPerSec=4.462448586236365, CurrSamplesPerSec=4.465513620612697, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:06:06,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=7180, skipped=35, lr=[2.9182627152247397e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:06:06,058] [INFO] [timer.py:258:stop] epoch=0/micro_step=7180/global_step=7180, RunningAvgSamplesPerSec=4.462438670349595, CurrSamplesPerSec=4.46549341509896, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:06:15,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=7190, skipped=35, lr=[2.9066964008431023e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:06:15,195] [INFO] [timer.py:258:stop] epoch=0/micro_step=7190/global_step=7190, RunningAvgSamplesPerSec=4.4624321931007005, CurrSamplesPerSec=4.433533007554641, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:06:24,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=7200, skipped=35, lr=[2.8951556813210283e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:06:24,308] [INFO] [timer.py:258:stop] epoch=0/micro_step=7200/global_step=7200, RunningAvgSamplesPerSec=4.462421383749312, CurrSamplesPerSec=4.4576212598456575, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:06:24,310] [INFO] [RANK 0]  iteration     7200/   10000 | elapsed time per iteration (ms): 912.5 | learning rate 2.894E-05 | total loss 1.124989E-01 | loss 1.124989E-01 | loss scale 32768.0 |speed 263.02 samples/(min*GPU)
[2024-06-18 17:06:24,310] [INFO] [RANK 0] time (ms) | forward: 357.14 | backward: 549.03 | allreduce: 0.00 | optimizer: 5.50 | batch generator: 13.88 | data loader: 0.11
[2024-06-18 17:06:24,311] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:06:24,325] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/7200/mp_rank_00_model_states.pt
[2024-06-18 17:06:24,325] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/7200/mp_rank_00_model_states.pt...
[2024-06-18 17:06:53,068] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/7200/mp_rank_00_model_states.pt.
[2024-06-18 17:07:02,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=7210, skipped=35, lr=[2.8836406705607624e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:07:02,121] [INFO] [timer.py:258:stop] epoch=0/micro_step=7210/global_step=7210, RunningAvgSamplesPerSec=4.462473378045725, CurrSamplesPerSec=4.483574113779284, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:07:11,161] [INFO] [logging.py:96:log_dist] [Rank 0] step=7220, skipped=35, lr=[2.872151482210812e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:07:11,162] [INFO] [timer.py:258:stop] epoch=0/micro_step=7220/global_step=7220, RunningAvgSamplesPerSec=4.462521848298703, CurrSamplesPerSec=4.493349917027962, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:07:20,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=7230, skipped=35, lr=[2.8606882296648244e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:07:20,219] [INFO] [timer.py:258:stop] epoch=0/micro_step=7230/global_step=7230, RunningAvgSamplesPerSec=4.4625503966209505, CurrSamplesPerSec=4.4816985196988375, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:07:29,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=7240, skipped=35, lr=[2.849251026060479e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:07:29,292] [INFO] [timer.py:258:stop] epoch=0/micro_step=7240/global_step=7240, RunningAvgSamplesPerSec=4.4625616826565775, CurrSamplesPerSec=4.4525059321307445, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:07:38,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=7250, skipped=35, lr=[2.8378399842783535e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:07:38,383] [INFO] [timer.py:258:stop] epoch=0/micro_step=7250/global_step=7250, RunningAvgSamplesPerSec=4.462571103227052, CurrSamplesPerSec=4.473221672649283, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:07:38,385] [INFO] [RANK 0]  iteration     7250/   10000 | elapsed time per iteration (ms): 1481.5 | learning rate 2.837E-05 | total loss 1.017452E-01 | loss 1.017452E-01 | loss scale 32768.0 |speed 162.00 samples/(min*GPU)
[2024-06-18 17:07:38,386] [INFO] [RANK 0] time (ms) | forward: 354.52 | backward: 545.59 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 13.43 | data loader: 0.11
[2024-06-18 17:07:47,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=7260, skipped=35, lr=[2.826455216940827e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:07:47,472] [INFO] [timer.py:258:stop] epoch=0/micro_step=7260/global_step=7260, RunningAvgSamplesPerSec=4.462580856203471, CurrSamplesPerSec=4.468488201819547, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:07:56,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=7270, skipped=35, lr=[2.8150968364109545e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:07:56,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=7270/global_step=7270, RunningAvgSamplesPerSec=4.462586138942387, CurrSamplesPerSec=4.461673107204032, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:08:05,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=7280, skipped=35, lr=[2.803764954791369e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:08:05,700] [INFO] [timer.py:258:stop] epoch=0/micro_step=7280/global_step=7280, RunningAvgSamplesPerSec=4.462581342894826, CurrSamplesPerSec=4.45019346169241, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:08:14,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=7290, skipped=35, lr=[2.792459683923164e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:08:14,809] [INFO] [timer.py:258:stop] epoch=0/micro_step=7290/global_step=7290, RunningAvgSamplesPerSec=4.462580428691337, CurrSamplesPerSec=4.465502923553235, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:08:23,911] [INFO] [logging.py:96:log_dist] [Rank 0] step=7300, skipped=35, lr=[2.7811811353848024e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:08:23,912] [INFO] [timer.py:258:stop] epoch=0/micro_step=7300/global_step=7300, RunningAvgSamplesPerSec=4.462571001909798, CurrSamplesPerSec=4.4526997312808945, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:08:23,913] [INFO] [RANK 0]  iteration     7300/   10000 | elapsed time per iteration (ms): 910.6 | learning rate 2.780E-05 | total loss 1.035243E-01 | loss 1.035243E-01 | loss scale 32768.0 |speed 263.57 samples/(min*GPU)
[2024-06-18 17:08:23,914] [INFO] [RANK 0] time (ms) | forward: 355.87 | backward: 548.77 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 13.65 | data loader: 0.10
[2024-06-18 17:08:33,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=7310, skipped=35, lr=[2.7699294204910024e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:08:33,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=7310/global_step=7310, RunningAvgSamplesPerSec=4.462560020907022, CurrSamplesPerSec=4.453187849008165, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:08:42,161] [INFO] [logging.py:96:log_dist] [Rank 0] step=7320, skipped=35, lr=[2.758704650291647e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:08:42,162] [INFO] [timer.py:258:stop] epoch=0/micro_step=7320/global_step=7320, RunningAvgSamplesPerSec=4.462545387034605, CurrSamplesPerSec=4.444353317433789, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:08:49,457] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 17:08:50,366] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 17:08:51,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=7330, skipped=37, lr=[2.749744308767941e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:08:51,279] [INFO] [timer.py:258:stop] epoch=0/micro_step=7330/global_step=7330, RunningAvgSamplesPerSec=4.462536119539347, CurrSamplesPerSec=4.4562537351887315, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:09:00,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=7340, skipped=37, lr=[2.7385683180147382e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:09:00,386] [INFO] [timer.py:258:stop] epoch=0/micro_step=7340/global_step=7340, RunningAvgSamplesPerSec=4.462532051803957, CurrSamplesPerSec=4.460841510684133, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:09:09,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=7350, skipped=37, lr=[2.7274195814774006e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:09:09,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=7350/global_step=7350, RunningAvgSamplesPerSec=4.462524116155426, CurrSamplesPerSec=4.454826721500044, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:09:09,485] [INFO] [RANK 0]  iteration     7350/   10000 | elapsed time per iteration (ms): 911.4 | learning rate 2.726E-05 | total loss 1.386979E-01 | loss 1.386979E-01 | loss scale 32768.0 |speed 263.32 samples/(min*GPU)
[2024-06-18 17:09:09,486] [INFO] [RANK 0] time (ms) | forward: 356.23 | backward: 549.24 | allreduce: 0.00 | optimizer: 5.19 | batch generator: 13.11 | data loader: 0.11
[2024-06-18 17:09:18,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=7360, skipped=37, lr=[2.716298209189459e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:09:18,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=7360/global_step=7360, RunningAvgSamplesPerSec=4.462517968687462, CurrSamplesPerSec=4.458323700374317, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:09:27,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=7370, skipped=37, lr=[2.7052043109143653e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:09:27,698] [INFO] [timer.py:258:stop] epoch=0/micro_step=7370/global_step=7370, RunningAvgSamplesPerSec=4.462511499457133, CurrSamplesPerSec=4.458470613059055, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:09:36,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=7380, skipped=37, lr=[2.6941379961444193e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:09:36,801] [INFO] [timer.py:258:stop] epoch=0/micro_step=7380/global_step=7380, RunningAvgSamplesPerSec=4.462511216045698, CurrSamplesPerSec=4.464890899399003, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:09:45,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=7390, skipped=37, lr=[2.6830993740996798e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:09:45,923] [INFO] [timer.py:258:stop] epoch=0/micro_step=7390/global_step=7390, RunningAvgSamplesPerSec=4.4625052673597745, CurrSamplesPerSec=4.444739514383291, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:09:55,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=7400, skipped=37, lr=[2.6720885537268868e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:09:55,050] [INFO] [timer.py:258:stop] epoch=0/micro_step=7400/global_step=7400, RunningAvgSamplesPerSec=4.462494836421868, CurrSamplesPerSec=4.458157842850166, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:09:55,051] [INFO] [RANK 0]  iteration     7400/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 2.671E-05 | total loss 1.292620E-01 | loss 1.292620E-01 | loss scale 32768.0 |speed 263.35 samples/(min*GPU)
[2024-06-18 17:09:55,052] [INFO] [RANK 0] time (ms) | forward: 356.39 | backward: 549.03 | allreduce: 0.00 | optimizer: 5.13 | batch generator: 13.53 | data loader: 0.10
[2024-06-18 17:10:04,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=7410, skipped=37, lr=[2.6611056436983965e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:10:04,174] [INFO] [timer.py:258:stop] epoch=0/micro_step=7410/global_step=7410, RunningAvgSamplesPerSec=4.462484729470731, CurrSamplesPerSec=4.459630852475758, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:10:13,300] [INFO] [logging.py:96:log_dist] [Rank 0] step=7420, skipped=37, lr=[2.6501507524110933e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:10:13,300] [INFO] [timer.py:258:stop] epoch=0/micro_step=7420/global_step=7420, RunningAvgSamplesPerSec=4.462466070621265, CurrSamplesPerSec=4.4518844706141465, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:10:22,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=7430, skipped=37, lr=[2.6392239879853344e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:10:22,419] [INFO] [timer.py:258:stop] epoch=0/micro_step=7430/global_step=7430, RunningAvgSamplesPerSec=4.462458434136357, CurrSamplesPerSec=4.457768126239009, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:10:31,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=7440, skipped=37, lr=[2.6283254582638708e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:10:31,531] [INFO] [timer.py:258:stop] epoch=0/micro_step=7440/global_step=7440, RunningAvgSamplesPerSec=4.462450769859296, CurrSamplesPerSec=4.457854592431868, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:10:40,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=7450, skipped=37, lr=[2.617455270810794e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:10:40,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=7450/global_step=7450, RunningAvgSamplesPerSec=4.4624459923235795, CurrSamplesPerSec=4.4715847335340815, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:10:40,654] [INFO] [RANK 0]  iteration     7450/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 2.616E-05 | total loss 1.494909E-01 | loss 1.494909E-01 | loss scale 32768.0 |speed 263.15 samples/(min*GPU)
[2024-06-18 17:10:40,654] [INFO] [RANK 0] time (ms) | forward: 356.90 | backward: 549.05 | allreduce: 0.00 | optimizer: 5.27 | batch generator: 13.64 | data loader: 0.10
[2024-06-18 17:10:49,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=7460, skipped=37, lr=[2.606613532910462e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:10:49,754] [INFO] [timer.py:258:stop] epoch=0/micro_step=7460/global_step=7460, RunningAvgSamplesPerSec=4.462442368387142, CurrSamplesPerSec=4.456096316523519, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:10:58,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=7470, skipped=37, lr=[2.595800351566455e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:10:58,843] [INFO] [timer.py:258:stop] epoch=0/micro_step=7470/global_step=7470, RunningAvgSamplesPerSec=4.462438132565985, CurrSamplesPerSec=4.461064504721057, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:11:07,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=7480, skipped=37, lr=[2.5850158335005048e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:11:07,943] [INFO] [timer.py:258:stop] epoch=0/micro_step=7480/global_step=7480, RunningAvgSamplesPerSec=4.462434725660851, CurrSamplesPerSec=4.457070597049025, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:11:17,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=7490, skipped=37, lr=[2.5742600851514507e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:11:17,061] [INFO] [timer.py:258:stop] epoch=0/micro_step=7490/global_step=7490, RunningAvgSamplesPerSec=4.462426120170754, CurrSamplesPerSec=4.456907200720024, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:11:26,212] [INFO] [logging.py:96:log_dist] [Rank 0] step=7500, skipped=37, lr=[2.563533212674186e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:11:26,213] [INFO] [timer.py:258:stop] epoch=0/micro_step=7500/global_step=7500, RunningAvgSamplesPerSec=4.462411075166562, CurrSamplesPerSec=4.437909741532184, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:11:26,215] [INFO] [RANK 0]  iteration     7500/   10000 | elapsed time per iteration (ms): 911.2 | learning rate 2.562E-05 | total loss 9.801493E-02 | loss 9.801493E-02 | loss scale 32768.0 |speed 263.38 samples/(min*GPU)
[2024-06-18 17:11:26,215] [INFO] [RANK 0] time (ms) | forward: 356.16 | backward: 549.11 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 13.14 | data loader: 0.10
[2024-06-18 17:11:26,216] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:11:26,234] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/7500/mp_rank_00_model_states.pt
[2024-06-18 17:11:26,235] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/7500/mp_rank_00_model_states.pt...
[2024-06-18 17:11:56,356] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/7500/mp_rank_00_model_states.pt.
[2024-06-18 17:12:05,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=7510, skipped=37, lr=[2.552835321938614e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:12:05,418] [INFO] [timer.py:258:stop] epoch=0/micro_step=7510/global_step=7510, RunningAvgSamplesPerSec=4.462458350736131, CurrSamplesPerSec=4.506155898578015, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:12:14,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=7520, skipped=37, lr=[2.5421665185285962e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:12:14,473] [INFO] [timer.py:258:stop] epoch=0/micro_step=7520/global_step=7520, RunningAvgSamplesPerSec=4.4625005258605315, CurrSamplesPerSec=4.4755271021061676, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:12:23,544] [INFO] [logging.py:96:log_dist] [Rank 0] step=7530, skipped=37, lr=[2.531526907740913e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:12:23,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=7530/global_step=7530, RunningAvgSamplesPerSec=4.462534468018573, CurrSamplesPerSec=4.482670854037064, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:12:32,620] [INFO] [logging.py:96:log_dist] [Rank 0] step=7540, skipped=37, lr=[2.5209165945842312e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:12:32,621] [INFO] [timer.py:258:stop] epoch=0/micro_step=7540/global_step=7540, RunningAvgSamplesPerSec=4.462546651497872, CurrSamplesPerSec=4.464724552901262, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:12:41,724] [INFO] [logging.py:96:log_dist] [Rank 0] step=7550, skipped=37, lr=[2.510335683778055e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:12:41,724] [INFO] [timer.py:258:stop] epoch=0/micro_step=7550/global_step=7550, RunningAvgSamplesPerSec=4.4625503142387535, CurrSamplesPerSec=4.461783456429492, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:12:41,726] [INFO] [RANK 0]  iteration     7550/   10000 | elapsed time per iteration (ms): 1510.2 | learning rate 2.509E-05 | total loss 1.044603E-01 | loss 1.044603E-01 | loss scale 32768.0 |speed 158.92 samples/(min*GPU)
[2024-06-18 17:12:41,727] [INFO] [RANK 0] time (ms) | forward: 355.20 | backward: 545.74 | allreduce: 0.00 | optimizer: 5.36 | batch generator: 14.32 | data loader: 0.10
[2024-06-18 17:12:50,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=7560, skipped=37, lr=[2.4997842797517046e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:12:50,824] [INFO] [timer.py:258:stop] epoch=0/micro_step=7560/global_step=7560, RunningAvgSamplesPerSec=4.462558554123922, CurrSamplesPerSec=4.470509989170937, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:12:59,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=7570, skipped=37, lr=[2.489262486643275e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:12:59,909] [INFO] [timer.py:258:stop] epoch=0/micro_step=7570/global_step=7570, RunningAvgSamplesPerSec=4.462560231713827, CurrSamplesPerSec=4.462497892064107, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:13:09,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=7580, skipped=37, lr=[2.4787704082986207e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:13:09,016] [INFO] [timer.py:258:stop] epoch=0/micro_step=7580/global_step=7580, RunningAvgSamplesPerSec=4.462553322133031, CurrSamplesPerSec=4.455045565577973, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:13:18,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=7590, skipped=37, lr=[2.4683081482703147e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:13:18,124] [INFO] [timer.py:258:stop] epoch=0/micro_step=7590/global_step=7590, RunningAvgSamplesPerSec=4.462538546759432, CurrSamplesPerSec=4.454740372725562, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:13:27,207] [INFO] [logging.py:96:log_dist] [Rank 0] step=7600, skipped=37, lr=[2.4578758098166437e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:13:27,208] [INFO] [timer.py:258:stop] epoch=0/micro_step=7600/global_step=7600, RunningAvgSamplesPerSec=4.4625414638327445, CurrSamplesPerSec=4.4700907168678805, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:13:27,209] [INFO] [RANK 0]  iteration     7600/   10000 | elapsed time per iteration (ms): 909.7 | learning rate 2.457E-05 | total loss 1.617736E-01 | loss 1.617736E-01 | loss scale 32768.0 |speed 263.84 samples/(min*GPU)
[2024-06-18 17:13:27,210] [INFO] [RANK 0] time (ms) | forward: 354.83 | backward: 548.92 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 12.49 | data loader: 0.10
[2024-06-18 17:13:36,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=7610, skipped=37, lr=[2.4474734959005747e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:13:36,309] [INFO] [timer.py:258:stop] epoch=0/micro_step=7610/global_step=7610, RunningAvgSamplesPerSec=4.462541601895476, CurrSamplesPerSec=4.460839138526987, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:13:45,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=7620, skipped=37, lr=[2.4371013091887442e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:13:45,394] [INFO] [timer.py:258:stop] epoch=0/micro_step=7620/global_step=7620, RunningAvgSamplesPerSec=4.462538535459309, CurrSamplesPerSec=4.458112826508649, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:13:54,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=7630, skipped=37, lr=[2.4267593520504516e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:13:54,490] [INFO] [timer.py:258:stop] epoch=0/micro_step=7630/global_step=7630, RunningAvgSamplesPerSec=4.462533463496678, CurrSamplesPerSec=4.450828620234363, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:14:03,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=7640, skipped=37, lr=[2.4164477265566353e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:14:03,608] [INFO] [timer.py:258:stop] epoch=0/micro_step=7640/global_step=7640, RunningAvgSamplesPerSec=4.462531672510532, CurrSamplesPerSec=4.451192324213065, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:14:12,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=7650, skipped=37, lr=[2.4061665344788798e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:14:12,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=7650/global_step=7650, RunningAvgSamplesPerSec=4.462514666786132, CurrSamplesPerSec=4.464715047761484, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:14:12,730] [INFO] [RANK 0]  iteration     7650/   10000 | elapsed time per iteration (ms): 910.4 | learning rate 2.405E-05 | total loss 1.043568E-01 | loss 1.043568E-01 | loss scale 32768.0 |speed 263.61 samples/(min*GPU)
[2024-06-18 17:14:12,731] [INFO] [RANK 0] time (ms) | forward: 355.23 | backward: 549.22 | allreduce: 0.00 | optimizer: 5.21 | batch generator: 12.69 | data loader: 0.09
[2024-06-18 17:14:21,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=7660, skipped=37, lr=[2.3959158772883955e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:14:21,831] [INFO] [timer.py:258:stop] epoch=0/micro_step=7660/global_step=7660, RunningAvgSamplesPerSec=4.46250439757019, CurrSamplesPerSec=4.455042016583579, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:14:30,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=7670, skipped=37, lr=[2.3856958561550342e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:14:30,921] [INFO] [timer.py:258:stop] epoch=0/micro_step=7670/global_step=7670, RunningAvgSamplesPerSec=4.4624974270630595, CurrSamplesPerSec=4.462731735474097, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:14:40,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=7680, skipped=37, lr=[2.3755065719462758e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:14:40,017] [INFO] [timer.py:258:stop] epoch=0/micro_step=7680/global_step=7680, RunningAvgSamplesPerSec=4.462489301692045, CurrSamplesPerSec=4.461044339449807, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:14:49,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=7690, skipped=37, lr=[2.3653481252262456e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:14:49,136] [INFO] [timer.py:258:stop] epoch=0/micro_step=7690/global_step=7690, RunningAvgSamplesPerSec=4.462471483591364, CurrSamplesPerSec=4.450715270104826, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:14:58,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=7700, skipped=37, lr=[2.355220616254707e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:14:58,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=7700/global_step=7700, RunningAvgSamplesPerSec=4.462462301428483, CurrSamplesPerSec=4.442635083946106, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:14:58,253] [INFO] [RANK 0]  iteration     7700/   10000 | elapsed time per iteration (ms): 910.4 | learning rate 2.354E-05 | total loss 1.194869E-01 | loss 1.194869E-01 | loss scale 32768.0 |speed 263.61 samples/(min*GPU)
[2024-06-18 17:14:58,253] [INFO] [RANK 0] time (ms) | forward: 355.24 | backward: 549.14 | allreduce: 0.00 | optimizer: 5.27 | batch generator: 11.84 | data loader: 0.11
[2024-06-18 17:15:07,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=7710, skipped=37, lr=[2.3451241449860888e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:15:07,386] [INFO] [timer.py:258:stop] epoch=0/micro_step=7710/global_step=7710, RunningAvgSamplesPerSec=4.462450510403905, CurrSamplesPerSec=4.457333477153571, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:15:16,505] [INFO] [logging.py:96:log_dist] [Rank 0] step=7720, skipped=37, lr=[2.3350588110684848e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:15:16,506] [INFO] [timer.py:258:stop] epoch=0/micro_step=7720/global_step=7720, RunningAvgSamplesPerSec=4.462445113099525, CurrSamplesPerSec=4.460009038466651, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:15:25,637] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 17:15:25,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=7730, skipped=38, lr=[2.3250247138426754e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:15:25,641] [INFO] [timer.py:258:stop] epoch=0/micro_step=7730/global_step=7730, RunningAvgSamplesPerSec=4.462434836002378, CurrSamplesPerSec=4.446632614332937, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:15:26,545] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 17:15:34,736] [INFO] [logging.py:96:log_dist] [Rank 0] step=7740, skipped=39, lr=[2.3170199930403376e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:15:34,736] [INFO] [timer.py:258:stop] epoch=0/micro_step=7740/global_step=7740, RunningAvgSamplesPerSec=4.462429469721038, CurrSamplesPerSec=4.437917958959641, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:15:43,859] [INFO] [logging.py:96:log_dist] [Rank 0] step=7750, skipped=39, lr=[2.3070423712138368e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:15:43,859] [INFO] [timer.py:258:stop] epoch=0/micro_step=7750/global_step=7750, RunningAvgSamplesPerSec=4.4624228075251615, CurrSamplesPerSec=4.449311859940638, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:15:43,861] [INFO] [RANK 0]  iteration     7750/   10000 | elapsed time per iteration (ms): 912.2 | learning rate 2.306E-05 | total loss 1.405508E-01 | loss 1.405508E-01 | loss scale 32768.0 |speed 263.11 samples/(min*GPU)
[2024-06-18 17:15:43,861] [INFO] [RANK 0] time (ms) | forward: 356.97 | backward: 549.18 | allreduce: 0.00 | optimizer: 5.19 | batch generator: 13.86 | data loader: 0.10
[2024-06-18 17:15:52,974] [INFO] [logging.py:96:log_dist] [Rank 0] step=7760, skipped=39, lr=[2.2970962625900824e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:15:52,975] [INFO] [timer.py:258:stop] epoch=0/micro_step=7760/global_step=7760, RunningAvgSamplesPerSec=4.462419622760798, CurrSamplesPerSec=4.4555756122188015, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:16:02,081] [INFO] [logging.py:96:log_dist] [Rank 0] step=7770, skipped=39, lr=[2.287181765333153e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:16:02,082] [INFO] [timer.py:258:stop] epoch=0/micro_step=7770/global_step=7770, RunningAvgSamplesPerSec=4.462412854129861, CurrSamplesPerSec=4.461993491004187, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:16:11,189] [INFO] [logging.py:96:log_dist] [Rank 0] step=7780, skipped=39, lr=[2.2772989772951307e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:16:11,189] [INFO] [timer.py:258:stop] epoch=0/micro_step=7780/global_step=7780, RunningAvgSamplesPerSec=4.462400343405088, CurrSamplesPerSec=4.460369501110758, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:16:20,301] [INFO] [logging.py:96:log_dist] [Rank 0] step=7790, skipped=39, lr=[2.2674479960151474e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:16:20,301] [INFO] [timer.py:258:stop] epoch=0/micro_step=7790/global_step=7790, RunningAvgSamplesPerSec=4.462395571370404, CurrSamplesPerSec=4.45666686412428, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:16:29,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=7800, skipped=39, lr=[2.257628918718409e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:16:29,429] [INFO] [timer.py:258:stop] epoch=0/micro_step=7800/global_step=7800, RunningAvgSamplesPerSec=4.462386915568688, CurrSamplesPerSec=4.467714738874929, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:16:29,430] [INFO] [RANK 0]  iteration     7800/   10000 | elapsed time per iteration (ms): 911.4 | learning rate 2.257E-05 | total loss 1.244300E-01 | loss 1.244300E-01 | loss scale 32768.0 |speed 263.34 samples/(min*GPU)
[2024-06-18 17:16:29,430] [INFO] [RANK 0] time (ms) | forward: 356.26 | backward: 549.20 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 13.34 | data loader: 0.11
[2024-06-18 17:16:29,431] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:16:29,445] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/7800/mp_rank_00_model_states.pt
[2024-06-18 17:16:29,445] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/7800/mp_rank_00_model_states.pt...
[2024-06-18 17:16:55,895] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/7800/mp_rank_00_model_states.pt.
[2024-06-18 17:17:04,958] [INFO] [logging.py:96:log_dist] [Rank 0] step=7810, skipped=39, lr=[2.2478418423152437e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:17:04,958] [INFO] [timer.py:258:stop] epoch=0/micro_step=7810/global_step=7810, RunningAvgSamplesPerSec=4.462433127056581, CurrSamplesPerSec=4.496860654329429, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:17:14,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=7820, skipped=39, lr=[2.2380868634001458e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:17:14,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=7820/global_step=7820, RunningAvgSamplesPerSec=4.462467531565954, CurrSamplesPerSec=4.497051101464464, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:17:23,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=7830, skipped=39, lr=[2.228364078250818e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:17:23,085] [INFO] [timer.py:258:stop] epoch=0/micro_step=7830/global_step=7830, RunningAvgSamplesPerSec=4.462495839297166, CurrSamplesPerSec=4.494115428463668, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:17:32,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=7840, skipped=39, lr=[2.218673582827226e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:17:32,170] [INFO] [timer.py:258:stop] epoch=0/micro_step=7840/global_step=7840, RunningAvgSamplesPerSec=4.462512581009783, CurrSamplesPerSec=4.4780835106313415, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:17:41,259] [INFO] [logging.py:96:log_dist] [Rank 0] step=7850, skipped=39, lr=[2.2090154727706457e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:17:41,260] [INFO] [timer.py:258:stop] epoch=0/micro_step=7850/global_step=7850, RunningAvgSamplesPerSec=4.462525951114235, CurrSamplesPerSec=4.469728681344445, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:17:41,261] [INFO] [RANK 0]  iteration     7850/   10000 | elapsed time per iteration (ms): 1436.6 | learning rate 2.208E-05 | total loss 1.216395E-01 | loss 1.216395E-01 | loss scale 32768.0 |speed 167.06 samples/(min*GPU)
[2024-06-18 17:17:41,262] [INFO] [RANK 0] time (ms) | forward: 355.06 | backward: 546.11 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 14.33 | data loader: 0.11
[2024-06-18 17:17:50,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=7860, skipped=39, lr=[2.1993898434027255e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:17:50,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=7860/global_step=7860, RunningAvgSamplesPerSec=4.462533057056337, CurrSamplesPerSec=4.458292897329576, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:17:59,456] [INFO] [logging.py:96:log_dist] [Rank 0] step=7870, skipped=39, lr=[2.1897967897245395e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:17:59,456] [INFO] [timer.py:258:stop] epoch=0/micro_step=7870/global_step=7870, RunningAvgSamplesPerSec=4.462540626208104, CurrSamplesPerSec=4.465205803495149, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:18:08,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=7880, skipped=39, lr=[2.1802364064156577e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:18:08,556] [INFO] [timer.py:258:stop] epoch=0/micro_step=7880/global_step=7880, RunningAvgSamplesPerSec=4.462542283882546, CurrSamplesPerSec=4.470501650602965, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:18:17,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=7890, skipped=39, lr=[2.1707087878332013e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:18:17,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=7890/global_step=7890, RunningAvgSamplesPerSec=4.462534644795297, CurrSamplesPerSec=4.463805118051053, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:18:26,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=7900, skipped=39, lr=[2.161214028010919e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:18:26,795] [INFO] [timer.py:258:stop] epoch=0/micro_step=7900/global_step=7900, RunningAvgSamplesPerSec=4.462524078380958, CurrSamplesPerSec=4.432217689173899, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:18:26,796] [INFO] [RANK 0]  iteration     7900/   10000 | elapsed time per iteration (ms): 910.7 | learning rate 2.160E-05 | total loss 1.087950E-01 | loss 1.087950E-01 | loss scale 32768.0 |speed 263.53 samples/(min*GPU)
[2024-06-18 17:18:26,796] [INFO] [RANK 0] time (ms) | forward: 356.12 | backward: 548.71 | allreduce: 0.00 | optimizer: 5.11 | batch generator: 13.75 | data loader: 0.10
[2024-06-18 17:18:35,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=7910, skipped=39, lr=[2.1517522206582583e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:18:35,925] [INFO] [timer.py:258:stop] epoch=0/micro_step=7910/global_step=7910, RunningAvgSamplesPerSec=4.462518558445505, CurrSamplesPerSec=4.459157913873471, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:18:45,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=7920, skipped=39, lr=[2.1423234591594365e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:18:45,045] [INFO] [timer.py:258:stop] epoch=0/micro_step=7920/global_step=7920, RunningAvgSamplesPerSec=4.462514875943007, CurrSamplesPerSec=4.474186752289468, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:18:54,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=7930, skipped=39, lr=[2.1329278365725258e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:18:54,144] [INFO] [timer.py:258:stop] epoch=0/micro_step=7930/global_step=7930, RunningAvgSamplesPerSec=4.46251446180837, CurrSamplesPerSec=4.461982810802875, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:19:03,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=7940, skipped=39, lr=[2.123565445628524e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:19:03,244] [INFO] [timer.py:258:stop] epoch=0/micro_step=7940/global_step=7940, RunningAvgSamplesPerSec=4.462508121806285, CurrSamplesPerSec=4.463114009453902, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:19:12,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=7950, skipped=39, lr=[2.1142363787304532e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:19:12,361] [INFO] [timer.py:258:stop] epoch=0/micro_step=7950/global_step=7950, RunningAvgSamplesPerSec=4.462499342461827, CurrSamplesPerSec=4.4496009679355435, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:19:12,362] [INFO] [RANK 0]  iteration     7950/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 2.113E-05 | total loss 1.369814E-01 | loss 1.369814E-01 | loss scale 32768.0 |speed 263.36 samples/(min*GPU)
[2024-06-18 17:19:12,362] [INFO] [RANK 0] time (ms) | forward: 356.37 | backward: 549.00 | allreduce: 0.00 | optimizer: 5.18 | batch generator: 13.50 | data loader: 0.14
[2024-06-18 17:19:21,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=7960, skipped=39, lr=[2.1049407279524353e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:19:21,472] [INFO] [timer.py:258:stop] epoch=0/micro_step=7960/global_step=7960, RunningAvgSamplesPerSec=4.462491588416518, CurrSamplesPerSec=4.451378922698981, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:19:30,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=7970, skipped=39, lr=[2.095678585038793e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:19:30,590] [INFO] [timer.py:258:stop] epoch=0/micro_step=7970/global_step=7970, RunningAvgSamplesPerSec=4.462482688210593, CurrSamplesPerSec=4.455896304338819, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:19:39,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=7980, skipped=39, lr=[2.0864500414031365e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:19:39,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=7980/global_step=7980, RunningAvgSamplesPerSec=4.462480325628341, CurrSamplesPerSec=4.461094159862901, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:19:48,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=7990, skipped=39, lr=[2.0772551881274638e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:19:48,781] [INFO] [timer.py:258:stop] epoch=0/micro_step=7990/global_step=7990, RunningAvgSamplesPerSec=4.462475943810106, CurrSamplesPerSec=4.4608059285918635, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:19:57,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=8000, skipped=39, lr=[2.068094115961268e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:19:57,903] [INFO] [timer.py:258:stop] epoch=0/micro_step=8000/global_step=8000, RunningAvgSamplesPerSec=4.462470495089753, CurrSamplesPerSec=4.458538148751203, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:19:57,904] [INFO] [RANK 0]  iteration     8000/   10000 | elapsed time per iteration (ms): 910.8 | learning rate 2.067E-05 | total loss 1.561397E-01 | loss 1.561397E-01 | loss scale 32768.0 |speed 263.49 samples/(min*GPU)
[2024-06-18 17:19:57,905] [INFO] [RANK 0] time (ms) | forward: 355.85 | backward: 549.06 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 12.89 | data loader: 0.10
[2024-06-18 17:20:04,566] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 17:20:04,566] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 17:20:04,566] [INFO] [RANK 0]  validation loss at iteration 8000 | loss: 1.483856E-01 | PPL: 1.159960E+00 loss 1.484375E-01 |
[2024-06-18 17:20:04,566] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 17:20:13,687] [INFO] [logging.py:96:log_dist] [Rank 0] step=8010, skipped=39, lr=[2.058966915320629e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:20:13,688] [INFO] [timer.py:258:stop] epoch=0/micro_step=8010/global_step=8010, RunningAvgSamplesPerSec=4.462468011341884, CurrSamplesPerSec=4.462108603085696, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:20:22,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=8020, skipped=39, lr=[2.0498736762873362e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:20:22,794] [INFO] [timer.py:258:stop] epoch=0/micro_step=8020/global_step=8020, RunningAvgSamplesPerSec=4.46246253742196, CurrSamplesPerSec=4.459800376195282, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:20:31,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=8030, skipped=39, lr=[2.0408144886079854e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:20:31,904] [INFO] [timer.py:258:stop] epoch=0/micro_step=8030/global_step=8030, RunningAvgSamplesPerSec=4.462452884874355, CurrSamplesPerSec=4.442362171907697, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:20:41,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=8040, skipped=39, lr=[2.0317894416931034e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:20:41,013] [INFO] [timer.py:258:stop] epoch=0/micro_step=8040/global_step=8040, RunningAvgSamplesPerSec=4.46244746528458, CurrSamplesPerSec=4.440424519974772, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:20:50,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=8050, skipped=39, lr=[2.0227986246162576e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:20:50,114] [INFO] [timer.py:258:stop] epoch=0/micro_step=8050/global_step=8050, RunningAvgSamplesPerSec=4.462437463659703, CurrSamplesPerSec=4.460667163855687, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:20:50,115] [INFO] [RANK 0]  iteration     8050/   10000 | elapsed time per iteration (ms): 1044.2 | learning rate 2.022E-05 | total loss 9.307158E-02 | loss 9.307158E-02 | loss scale 32768.0 |speed 229.84 samples/(min*GPU)
[2024-06-18 17:20:50,116] [INFO] [RANK 0] time (ms) | forward: 355.78 | backward: 549.27 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 15.63 | data loader: 0.15
[2024-06-18 17:20:59,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=8060, skipped=39, lr=[2.0138421261131842e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:20:59,202] [INFO] [timer.py:258:stop] epoch=0/micro_step=8060/global_step=8060, RunningAvgSamplesPerSec=4.462439300189163, CurrSamplesPerSec=4.465515997743982, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:21:08,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=8070, skipped=39, lr=[2.004920034580908e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:21:08,295] [INFO] [timer.py:258:stop] epoch=0/micro_step=8070/global_step=8070, RunningAvgSamplesPerSec=4.462439915226227, CurrSamplesPerSec=4.456054892407461, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:21:17,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=8080, skipped=39, lr=[1.9960324380768677e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:21:17,411] [INFO] [timer.py:258:stop] epoch=0/micro_step=8080/global_step=8080, RunningAvgSamplesPerSec=4.4624344711171515, CurrSamplesPerSec=4.455536564301565, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:21:26,515] [INFO] [logging.py:96:log_dist] [Rank 0] step=8090, skipped=39, lr=[1.9871794243180566e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:21:26,516] [INFO] [timer.py:258:stop] epoch=0/micro_step=8090/global_step=8090, RunningAvgSamplesPerSec=4.462430435060417, CurrSamplesPerSec=4.43209591822879, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:21:35,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=8100, skipped=39, lr=[1.9783610806801432e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:21:35,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=8100/global_step=8100, RunningAvgSamplesPerSec=4.462415815086283, CurrSamplesPerSec=4.457878282385164, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:21:35,639] [INFO] [RANK 0]  iteration     8100/   10000 | elapsed time per iteration (ms): 910.5 | learning rate 1.977E-05 | total loss 9.867203E-02 | loss 9.867203E-02 | loss scale 32768.0 |speed 263.60 samples/(min*GPU)
[2024-06-18 17:21:35,639] [INFO] [RANK 0] time (ms) | forward: 355.66 | backward: 548.88 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 12.83 | data loader: 0.09
[2024-06-18 17:21:35,640] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:21:35,658] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/8100/mp_rank_00_model_states.pt
[2024-06-18 17:21:35,658] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/8100/mp_rank_00_model_states.pt...
[2024-06-18 17:22:04,279] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/8100/mp_rank_00_model_states.pt.
[2024-06-18 17:22:13,365] [INFO] [logging.py:96:log_dist] [Rank 0] step=8110, skipped=39, lr=[1.969577494196621e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:22:13,366] [INFO] [timer.py:258:stop] epoch=0/micro_step=8110/global_step=8110, RunningAvgSamplesPerSec=4.462455654658386, CurrSamplesPerSec=4.492717002373126, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:22:22,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=8120, skipped=39, lr=[1.9608287515579412e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:22:22,421] [INFO] [timer.py:258:stop] epoch=0/micro_step=8120/global_step=8120, RunningAvgSamplesPerSec=4.462497015368877, CurrSamplesPerSec=4.4911739676415845, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:22:31,469] [INFO] [logging.py:96:log_dist] [Rank 0] step=8130, skipped=39, lr=[1.952114939110663e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:22:31,470] [INFO] [timer.py:258:stop] epoch=0/micro_step=8130/global_step=8130, RunningAvgSamplesPerSec=4.462535195169988, CurrSamplesPerSec=4.479172662581169, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:22:33,289] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 17:22:34,191] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 17:22:40,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=8140, skipped=41, lr=[1.9451690966954704e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:22:40,561] [INFO] [timer.py:258:stop] epoch=0/micro_step=8140/global_step=8140, RunningAvgSamplesPerSec=4.4625513706725854, CurrSamplesPerSec=4.466247085676195, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:22:49,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=8150, skipped=41, lr=[1.9365183750850647e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:22:49,681] [INFO] [timer.py:258:stop] epoch=0/micro_step=8150/global_step=8150, RunningAvgSamplesPerSec=4.462544290336581, CurrSamplesPerSec=4.467072373255742, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:22:49,682] [INFO] [RANK 0]  iteration     8150/   10000 | elapsed time per iteration (ms): 1480.9 | learning rate 1.936E-05 | total loss 1.211427E-01 | loss 1.211427E-01 | loss scale 32768.0 |speed 162.07 samples/(min*GPU)
[2024-06-18 17:22:49,683] [INFO] [RANK 0] time (ms) | forward: 356.06 | backward: 545.72 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 14.99 | data loader: 0.18
[2024-06-18 17:22:58,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=8160, skipped=41, lr=[1.927902823599662e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:22:58,775] [INFO] [timer.py:258:stop] epoch=0/micro_step=8160/global_step=8160, RunningAvgSamplesPerSec=4.462544465387622, CurrSamplesPerSec=4.456293979339339, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:23:07,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=8170, skipped=41, lr=[1.9193225272712767e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:23:07,880] [INFO] [timer.py:258:stop] epoch=0/micro_step=8170/global_step=8170, RunningAvgSamplesPerSec=4.462538322317194, CurrSamplesPerSec=4.4486912896716495, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:23:16,992] [INFO] [logging.py:96:log_dist] [Rank 0] step=8180, skipped=41, lr=[1.9107775707839683e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:23:16,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=8180/global_step=8180, RunningAvgSamplesPerSec=4.4625303904520965, CurrSamplesPerSec=4.44760276051623, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:23:26,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=8190, skipped=41, lr=[1.902268038473009e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:23:26,112] [INFO] [timer.py:258:stop] epoch=0/micro_step=8190/global_step=8190, RunningAvgSamplesPerSec=4.462529083908463, CurrSamplesPerSec=4.462355461387837, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:23:35,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=8200, skipped=41, lr=[1.8937940143240464e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:23:35,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=8200/global_step=8200, RunningAvgSamplesPerSec=4.462511926848274, CurrSamplesPerSec=4.460491644761523, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:23:35,263] [INFO] [RANK 0]  iteration     8200/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 1.893E-05 | total loss 1.162850E-01 | loss 1.162850E-01 | loss scale 32768.0 |speed 263.27 samples/(min*GPU)
[2024-06-18 17:23:35,263] [INFO] [RANK 0] time (ms) | forward: 356.74 | backward: 548.93 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 13.62 | data loader: 0.13
[2024-06-18 17:23:44,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=8210, skipped=41, lr=[1.8853555819722788e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:23:44,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=8210/global_step=8210, RunningAvgSamplesPerSec=4.462505387221247, CurrSamplesPerSec=4.461773963808423, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:23:53,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=8220, skipped=41, lr=[1.8769528247016248e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:23:53,469] [INFO] [timer.py:258:stop] epoch=0/micro_step=8220/global_step=8220, RunningAvgSamplesPerSec=4.462504661849373, CurrSamplesPerSec=4.466577639764782, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:24:02,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=8230, skipped=41, lr=[1.8685858254439097e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:24:02,590] [INFO] [timer.py:258:stop] epoch=0/micro_step=8230/global_step=8230, RunningAvgSamplesPerSec=4.462496090851308, CurrSamplesPerSec=4.456965216885403, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:24:11,717] [INFO] [logging.py:96:log_dist] [Rank 0] step=8240, skipped=41, lr=[1.8602546667780345e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:24:11,718] [INFO] [timer.py:258:stop] epoch=0/micro_step=8240/global_step=8240, RunningAvgSamplesPerSec=4.462486142658845, CurrSamplesPerSec=4.460491644761523, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:24:20,836] [INFO] [logging.py:96:log_dist] [Rank 0] step=8250, skipped=41, lr=[1.8519594309291758e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:24:20,837] [INFO] [timer.py:258:stop] epoch=0/micro_step=8250/global_step=8250, RunningAvgSamplesPerSec=4.462485966945291, CurrSamplesPerSec=4.4490652628128755, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:24:20,837] [INFO] [RANK 0]  iteration     8250/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 1.851E-05 | total loss 1.327935E-01 | loss 1.327935E-01 | loss scale 32768.0 |speed 263.30 samples/(min*GPU)
[2024-06-18 17:24:20,839] [INFO] [RANK 0] time (ms) | forward: 356.63 | backward: 549.03 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 13.73 | data loader: 0.09
[2024-06-18 17:24:29,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=8260, skipped=41, lr=[1.8437001997679586e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:24:29,953] [INFO] [timer.py:258:stop] epoch=0/micro_step=8260/global_step=8260, RunningAvgSamplesPerSec=4.4624798968543455, CurrSamplesPerSec=4.451801779689463, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:24:39,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=8270, skipped=41, lr=[1.8354770548096623e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:24:39,090] [INFO] [timer.py:258:stop] epoch=0/micro_step=8270/global_step=8270, RunningAvgSamplesPerSec=4.462470948747363, CurrSamplesPerSec=4.463697043999455, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:24:48,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=8280, skipped=41, lr=[1.8272900772134058e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:24:48,205] [INFO] [timer.py:258:stop] epoch=0/micro_step=8280/global_step=8280, RunningAvgSamplesPerSec=4.462464874511566, CurrSamplesPerSec=4.459174506512325, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:24:57,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=8290, skipped=41, lr=[1.819139347781356e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:24:57,322] [INFO] [timer.py:258:stop] epoch=0/micro_step=8290/global_step=8290, RunningAvgSamplesPerSec=4.462454452436562, CurrSamplesPerSec=4.443378704103179, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:25:06,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=8300, skipped=41, lr=[1.8110249469579198e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:25:06,418] [INFO] [timer.py:258:stop] epoch=0/micro_step=8300/global_step=8300, RunningAvgSamplesPerSec=4.462445745241249, CurrSamplesPerSec=4.4604928306549985, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:25:06,419] [INFO] [RANK 0]  iteration     8300/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 1.810E-05 | total loss 1.037518E-01 | loss 1.037518E-01 | loss scale 32768.0 |speed 263.26 samples/(min*GPU)
[2024-06-18 17:25:06,420] [INFO] [RANK 0] time (ms) | forward: 356.66 | backward: 549.01 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 13.28 | data loader: 0.10
[2024-06-18 17:25:15,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=8310, skipped=41, lr=[1.802946954828957e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:25:15,515] [INFO] [timer.py:258:stop] epoch=0/micro_step=8310/global_step=8310, RunningAvgSamplesPerSec=4.462434387026119, CurrSamplesPerSec=4.435006200258162, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:25:24,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=8320, skipped=41, lr=[1.79490545112099e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:25:24,616] [INFO] [timer.py:258:stop] epoch=0/micro_step=8320/global_step=8320, RunningAvgSamplesPerSec=4.462428970097801, CurrSamplesPerSec=4.466961762266547, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:25:33,707] [INFO] [logging.py:96:log_dist] [Rank 0] step=8330, skipped=41, lr=[1.7869005152004116e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:25:33,709] [INFO] [timer.py:258:stop] epoch=0/micro_step=8330/global_step=8330, RunningAvgSamplesPerSec=4.462422505972929, CurrSamplesPerSec=4.454823172854313, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:25:42,847] [INFO] [logging.py:96:log_dist] [Rank 0] step=8340, skipped=41, lr=[1.778932226072711e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:25:42,848] [INFO] [timer.py:258:stop] epoch=0/micro_step=8340/global_step=8340, RunningAvgSamplesPerSec=4.462411252770381, CurrSamplesPerSec=4.440294071409024, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:25:51,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=8350, skipped=41, lr=[1.7710006623816823e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:25:51,966] [INFO] [timer.py:258:stop] epoch=0/micro_step=8350/global_step=8350, RunningAvgSamplesPerSec=4.46240248969048, CurrSamplesPerSec=4.455595728079638, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:25:51,967] [INFO] [RANK 0]  iteration     8350/   10000 | elapsed time per iteration (ms): 911.0 | learning rate 1.770E-05 | total loss 1.373113E-01 | loss 1.373113E-01 | loss scale 32768.0 |speed 263.46 samples/(min*GPU)
[2024-06-18 17:25:51,968] [INFO] [RANK 0] time (ms) | forward: 355.98 | backward: 549.06 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 12.58 | data loader: 0.10
[2024-06-18 17:26:01,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=8360, skipped=41, lr=[1.7631059024086587e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:26:01,087] [INFO] [timer.py:258:stop] epoch=0/micro_step=8360/global_step=8360, RunningAvgSamplesPerSec=4.462397962280432, CurrSamplesPerSec=4.455124827926106, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:26:10,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=8370, skipped=41, lr=[1.7552480240717325e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:26:10,204] [INFO] [timer.py:258:stop] epoch=0/micro_step=8370/global_step=8370, RunningAvgSamplesPerSec=4.462391275714047, CurrSamplesPerSec=4.460507061425898, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:26:19,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=8380, skipped=41, lr=[1.747427104924992e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:26:19,307] [INFO] [timer.py:258:stop] epoch=0/micro_step=8380/global_step=8380, RunningAvgSamplesPerSec=4.462383972437744, CurrSamplesPerSec=4.4666680155864125, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:26:28,399] [INFO] [logging.py:96:log_dist] [Rank 0] step=8390, skipped=41, lr=[1.7396432221577506e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:26:28,400] [INFO] [timer.py:258:stop] epoch=0/micro_step=8390/global_step=8390, RunningAvgSamplesPerSec=4.46238229407972, CurrSamplesPerSec=4.466348149179485, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:26:37,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=8400, skipped=41, lr=[1.7318964525937885e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:26:37,498] [INFO] [timer.py:258:stop] epoch=0/micro_step=8400/global_step=8400, RunningAvgSamplesPerSec=4.46237461400824, CurrSamplesPerSec=4.4629026822026985, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:26:37,499] [INFO] [RANK 0]  iteration     8400/   10000 | elapsed time per iteration (ms): 910.6 | learning rate 1.731E-05 | total loss 1.295950E-01 | loss 1.295950E-01 | loss scale 32768.0 |speed 263.55 samples/(min*GPU)
[2024-06-18 17:26:37,500] [INFO] [RANK 0] time (ms) | forward: 355.74 | backward: 549.01 | allreduce: 0.00 | optimizer: 5.13 | batch generator: 12.78 | data loader: 0.10
[2024-06-18 17:26:37,500] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:26:37,512] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/8400/mp_rank_00_model_states.pt
[2024-06-18 17:26:37,512] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/8400/mp_rank_00_model_states.pt...
[2024-06-18 17:27:06,667] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/8400/mp_rank_00_model_states.pt.
[2024-06-18 17:27:15,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=8410, skipped=41, lr=[1.724186872690595e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:27:15,701] [INFO] [timer.py:258:stop] epoch=0/micro_step=8410/global_step=8410, RunningAvgSamplesPerSec=4.462426073658435, CurrSamplesPerSec=4.502275394980552, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:27:24,755] [INFO] [logging.py:96:log_dist] [Rank 0] step=8420, skipped=41, lr=[1.7165145585386102e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:27:24,755] [INFO] [timer.py:258:stop] epoch=0/micro_step=8420/global_step=8420, RunningAvgSamplesPerSec=4.4624650427808925, CurrSamplesPerSec=4.50091656335823, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:27:33,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=8430, skipped=41, lr=[1.7088795858604777e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:27:33,800] [INFO] [timer.py:258:stop] epoch=0/micro_step=8430/global_step=8430, RunningAvgSamplesPerSec=4.462494838897011, CurrSamplesPerSec=4.475663211012919, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:27:42,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=8440, skipped=41, lr=[1.7012820300102956e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:27:42,877] [INFO] [timer.py:258:stop] epoch=0/micro_step=8440/global_step=8440, RunningAvgSamplesPerSec=4.4625089577733545, CurrSamplesPerSec=4.47467243189728, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:27:51,994] [INFO] [logging.py:96:log_dist] [Rank 0] step=8450, skipped=41, lr=[1.693721965972873e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:27:51,994] [INFO] [timer.py:258:stop] epoch=0/micro_step=8450/global_step=8450, RunningAvgSamplesPerSec=4.462511222082708, CurrSamplesPerSec=4.459969912803487, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:27:51,996] [INFO] [RANK 0]  iteration     8450/   10000 | elapsed time per iteration (ms): 1489.9 | learning rate 1.693E-05 | total loss 1.390170E-01 | loss 1.390170E-01 | loss scale 32768.0 |speed 161.08 samples/(min*GPU)
[2024-06-18 17:27:51,997] [INFO] [RANK 0] time (ms) | forward: 354.84 | backward: 545.48 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 13.83 | data loader: 0.11
[2024-06-18 17:28:01,093] [INFO] [logging.py:96:log_dist] [Rank 0] step=8460, skipped=41, lr=[1.6861994683629893e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:28:01,093] [INFO] [timer.py:258:stop] epoch=0/micro_step=8460/global_step=8460, RunningAvgSamplesPerSec=4.462510156885292, CurrSamplesPerSec=4.465567106678754, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:28:10,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=8470, skipped=41, lr=[1.6787146114246598e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:28:10,199] [INFO] [timer.py:258:stop] epoch=0/micro_step=8470/global_step=8470, RunningAvgSamplesPerSec=4.462508862081407, CurrSamplesPerSec=4.458456395279311, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:28:19,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=8480, skipped=41, lr=[1.6712674690304004e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:28:19,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=8480/global_step=8480, RunningAvgSamplesPerSec=4.462507939666909, CurrSamplesPerSec=4.460067135414742, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:28:28,429] [INFO] [logging.py:96:log_dist] [Rank 0] step=8490, skipped=41, lr=[1.6638581146804987e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:28:28,430] [INFO] [timer.py:258:stop] epoch=0/micro_step=8490/global_step=8490, RunningAvgSamplesPerSec=4.4625028454748525, CurrSamplesPerSec=4.458971847737255, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:28:37,544] [INFO] [logging.py:96:log_dist] [Rank 0] step=8500, skipped=41, lr=[1.6564866215022934e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:28:37,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=8500/global_step=8500, RunningAvgSamplesPerSec=4.46249461249189, CurrSamplesPerSec=4.448628770328079, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:28:37,545] [INFO] [RANK 0]  iteration     8500/   10000 | elapsed time per iteration (ms): 911.0 | learning rate 1.656E-05 | total loss 1.599772E-01 | loss 1.599772E-01 | loss scale 32768.0 |speed 263.45 samples/(min*GPU)
[2024-06-18 17:28:37,546] [INFO] [RANK 0] time (ms) | forward: 356.29 | backward: 548.79 | allreduce: 0.00 | optimizer: 5.12 | batch generator: 13.48 | data loader: 0.10
[2024-06-18 17:28:46,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=8510, skipped=41, lr=[1.649153062249443e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:28:46,677] [INFO] [timer.py:258:stop] epoch=0/micro_step=8510/global_step=8510, RunningAvgSamplesPerSec=4.462486083041294, CurrSamplesPerSec=4.442669200308655, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:28:55,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=8520, skipped=41, lr=[1.6418575093012204e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:28:55,782] [INFO] [timer.py:258:stop] epoch=0/micro_step=8520/global_step=8520, RunningAvgSamplesPerSec=4.462476982265654, CurrSamplesPerSec=4.460058835758062, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:29:04,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=8530, skipped=41, lr=[1.6346000346617845e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:29:04,885] [INFO] [timer.py:258:stop] epoch=0/micro_step=8530/global_step=8530, RunningAvgSamplesPerSec=4.462477957958516, CurrSamplesPerSec=4.460396775326457, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:29:08,527] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 17:29:09,436] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 17:29:13,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=8540, skipped=43, lr=[1.6288215194794564e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:29:13,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=8540/global_step=8540, RunningAvgSamplesPerSec=4.462471474779701, CurrSamplesPerSec=4.440425695221912, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:29:23,110] [INFO] [logging.py:96:log_dist] [Rank 0] step=8550, skipped=43, lr=[1.6216327660462675e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:29:23,111] [INFO] [timer.py:258:stop] epoch=0/micro_step=8550/global_step=8550, RunningAvgSamplesPerSec=4.462464137826683, CurrSamplesPerSec=4.457337029799771, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:29:23,112] [INFO] [RANK 0]  iteration     8550/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 1.621E-05 | total loss 1.206359E-01 | loss 1.206359E-01 | loss scale 32768.0 |speed 263.35 samples/(min*GPU)
[2024-06-18 17:29:23,113] [INFO] [RANK 0] time (ms) | forward: 356.44 | backward: 549.08 | allreduce: 0.00 | optimizer: 5.09 | batch generator: 13.36 | data loader: 0.11
[2024-06-18 17:29:32,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=8560, skipped=43, lr=[1.6144822905319167e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:29:32,226] [INFO] [timer.py:258:stop] epoch=0/micro_step=8560/global_step=8560, RunningAvgSamplesPerSec=4.462459191922062, CurrSamplesPerSec=4.458702849631737, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:29:41,336] [INFO] [logging.py:96:log_dist] [Rank 0] step=8570, skipped=43, lr=[1.6073701635087124e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:29:41,337] [INFO] [timer.py:258:stop] epoch=0/micro_step=8570/global_step=8570, RunningAvgSamplesPerSec=4.462450104406135, CurrSamplesPerSec=4.448975597907096, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:29:50,458] [INFO] [logging.py:96:log_dist] [Rank 0] step=8580, skipped=43, lr=[1.600296455170476e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:29:50,459] [INFO] [timer.py:258:stop] epoch=0/micro_step=8580/global_step=8580, RunningAvgSamplesPerSec=4.46243916501364, CurrSamplesPerSec=4.463079578368508, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:29:59,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=8590, skipped=43, lr=[1.5932612353318523e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:29:59,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=8590/global_step=8590, RunningAvgSamplesPerSec=4.4624301982139905, CurrSamplesPerSec=4.459069026839385, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:30:08,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=8600, skipped=43, lr=[1.5862645734276226e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:30:08,708] [INFO] [timer.py:258:stop] epoch=0/micro_step=8600/global_step=8600, RunningAvgSamplesPerSec=4.462423112202514, CurrSamplesPerSec=4.457093094583361, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:30:08,710] [INFO] [RANK 0]  iteration     8600/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 1.586E-05 | total loss 1.062004E-01 | loss 1.062004E-01 | loss scale 32768.0 |speed 263.17 samples/(min*GPU)
[2024-06-18 17:30:08,710] [INFO] [RANK 0] time (ms) | forward: 357.02 | backward: 549.01 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 13.59 | data loader: 0.10
[2024-06-18 17:30:17,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=8610, skipped=43, lr=[1.5793065385120132e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:30:17,833] [INFO] [timer.py:258:stop] epoch=0/micro_step=8610/global_step=8610, RunningAvgSamplesPerSec=4.462414495604737, CurrSamplesPerSec=4.448215950852579, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:30:26,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=8620, skipped=43, lr=[1.572387199258022e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:30:26,951] [INFO] [timer.py:258:stop] epoch=0/micro_step=8620/global_step=8620, RunningAvgSamplesPerSec=4.462401156217272, CurrSamplesPerSec=4.452679641560851, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:30:36,079] [INFO] [logging.py:96:log_dist] [Rank 0] step=8630, skipped=43, lr=[1.565506623956731e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:30:36,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=8630/global_step=8630, RunningAvgSamplesPerSec=4.462393234152886, CurrSamplesPerSec=4.452509477085675, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:30:45,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=8640, skipped=43, lr=[1.5586648805166432e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:30:45,202] [INFO] [timer.py:258:stop] epoch=0/micro_step=8640/global_step=8640, RunningAvgSamplesPerSec=4.462382508309085, CurrSamplesPerSec=4.462818394331759, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:30:54,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=8650, skipped=43, lr=[1.551862036463003e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:30:54,319] [INFO] [timer.py:258:stop] epoch=0/micro_step=8650/global_step=8650, RunningAvgSamplesPerSec=4.462381812491099, CurrSamplesPerSec=4.459799190669977, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:30:54,320] [INFO] [RANK 0]  iteration     8650/   10000 | elapsed time per iteration (ms): 912.2 | learning rate 1.551E-05 | total loss 1.350038E-01 | loss 1.350038E-01 | loss scale 32768.0 |speed 263.10 samples/(min*GPU)
[2024-06-18 17:30:54,320] [INFO] [RANK 0] time (ms) | forward: 357.22 | backward: 548.96 | allreduce: 0.00 | optimizer: 5.24 | batch generator: 13.80 | data loader: 0.11
[2024-06-18 17:31:03,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=8660, skipped=43, lr=[1.545098158937136e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:31:03,449] [INFO] [timer.py:258:stop] epoch=0/micro_step=8660/global_step=8660, RunningAvgSamplesPerSec=4.462372202443034, CurrSamplesPerSec=4.441242642474908, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:31:12,587] [INFO] [logging.py:96:log_dist] [Rank 0] step=8670, skipped=43, lr=[1.5383733146957818e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:31:12,588] [INFO] [timer.py:258:stop] epoch=0/micro_step=8670/global_step=8670, RunningAvgSamplesPerSec=4.462361196862174, CurrSamplesPerSec=4.45316302688028, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:31:21,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=8680, skipped=43, lr=[1.531687570110437e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:31:21,690] [INFO] [timer.py:258:stop] epoch=0/micro_step=8680/global_step=8680, RunningAvgSamplesPerSec=4.46235272682313, CurrSamplesPerSec=4.460240249580952, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:31:30,810] [INFO] [logging.py:96:log_dist] [Rank 0] step=8690, skipped=43, lr=[1.5250409911667037e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:31:30,810] [INFO] [timer.py:258:stop] epoch=0/micro_step=8690/global_step=8690, RunningAvgSamplesPerSec=4.462342944764999, CurrSamplesPerSec=4.457319266625398, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:31:39,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=8700, skipped=43, lr=[1.5184336434636308e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:31:39,929] [INFO] [timer.py:258:stop] epoch=0/micro_step=8700/global_step=8700, RunningAvgSamplesPerSec=4.462333754389903, CurrSamplesPerSec=4.4499314230817895, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:31:39,930] [INFO] [RANK 0]  iteration     8700/   10000 | elapsed time per iteration (ms): 912.2 | learning rate 1.518E-05 | total loss 1.307932E-01 | loss 1.307932E-01 | loss scale 32768.0 |speed 263.10 samples/(min*GPU)
[2024-06-18 17:31:39,930] [INFO] [RANK 0] time (ms) | forward: 357.31 | backward: 548.93 | allreduce: 0.00 | optimizer: 5.17 | batch generator: 13.42 | data loader: 0.13
[2024-06-18 17:31:39,931] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:31:39,947] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/8700/mp_rank_00_model_states.pt
[2024-06-18 17:31:39,947] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/8700/mp_rank_00_model_states.pt...
[2024-06-18 17:32:08,870] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/8700/mp_rank_00_model_states.pt.
[2024-06-18 17:32:17,910] [INFO] [logging.py:96:log_dist] [Rank 0] step=8710, skipped=43, lr=[1.5118655922130748e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:32:17,911] [INFO] [timer.py:258:stop] epoch=0/micro_step=8710/global_step=8710, RunningAvgSamplesPerSec=4.4623799161385795, CurrSamplesPerSec=4.498358148567513, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:32:26,964] [INFO] [logging.py:96:log_dist] [Rank 0] step=8720, skipped=43, lr=[1.5053369022390471e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:32:26,964] [INFO] [timer.py:258:stop] epoch=0/micro_step=8720/global_step=8720, RunningAvgSamplesPerSec=4.462415537090727, CurrSamplesPerSec=4.479715643050001, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:32:36,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=8730, skipped=43, lr=[1.498847637977085e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:32:36,022] [INFO] [timer.py:258:stop] epoch=0/micro_step=8730/global_step=8730, RunningAvgSamplesPerSec=4.462443301946951, CurrSamplesPerSec=4.4742631175267675, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:32:45,120] [INFO] [logging.py:96:log_dist] [Rank 0] step=8740, skipped=43, lr=[1.4923978634736048e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:32:45,120] [INFO] [timer.py:258:stop] epoch=0/micro_step=8740/global_step=8740, RunningAvgSamplesPerSec=4.462448128450646, CurrSamplesPerSec=4.467575543980301, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:32:54,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=8750, skipped=43, lr=[1.4859876423852782e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:32:54,238] [INFO] [timer.py:258:stop] epoch=0/micro_step=8750/global_step=8750, RunningAvgSamplesPerSec=4.462444900782568, CurrSamplesPerSec=4.4533994393306795, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:32:54,239] [INFO] [RANK 0]  iteration     8750/   10000 | elapsed time per iteration (ms): 1486.2 | learning rate 1.485E-05 | total loss 1.277377E-01 | loss 1.277377E-01 | loss scale 32768.0 |speed 161.49 samples/(min*GPU)
[2024-06-18 17:32:54,240] [INFO] [RANK 0] time (ms) | forward: 355.15 | backward: 545.84 | allreduce: 0.00 | optimizer: 5.29 | batch generator: 13.98 | data loader: 0.10
[2024-06-18 17:33:03,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=8760, skipped=43, lr=[1.4796170379783987e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:33:03,359] [INFO] [timer.py:258:stop] epoch=0/micro_step=8760/global_step=8760, RunningAvgSamplesPerSec=4.4624409955453395, CurrSamplesPerSec=4.455543663871974, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:33:12,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=8770, skipped=43, lr=[1.4732861131282593e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:33:12,456] [INFO] [timer.py:258:stop] epoch=0/micro_step=8770/global_step=8770, RunningAvgSamplesPerSec=4.46244866638453, CurrSamplesPerSec=4.470122874174469, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:33:21,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=8780, skipped=43, lr=[1.4669949303185344e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:33:21,579] [INFO] [timer.py:258:stop] epoch=0/micro_step=8780/global_step=8780, RunningAvgSamplesPerSec=4.46244265163706, CurrSamplesPerSec=4.4537611989667045, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:33:30,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=8790, skipped=43, lr=[1.4607435516406561e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:33:30,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=8790/global_step=8790, RunningAvgSamplesPerSec=4.462440793769663, CurrSamplesPerSec=4.448944923900606, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:33:39,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=8800, skipped=43, lr=[1.45453203879321e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:33:39,843] [INFO] [timer.py:258:stop] epoch=0/micro_step=8800/global_step=8800, RunningAvgSamplesPerSec=4.462431640891106, CurrSamplesPerSec=4.450638525899162, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:33:39,845] [INFO] [RANK 0]  iteration     8800/   10000 | elapsed time per iteration (ms): 912.1 | learning rate 1.454E-05 | total loss 1.318350E-01 | loss 1.318350E-01 | loss scale 32768.0 |speed 263.13 samples/(min*GPU)
[2024-06-18 17:33:39,845] [INFO] [RANK 0] time (ms) | forward: 357.17 | backward: 548.86 | allreduce: 0.00 | optimizer: 5.29 | batch generator: 14.60 | data loader: 0.10
[2024-06-18 17:33:48,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=8810, skipped=43, lr=[1.4483604530813187e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:33:48,960] [INFO] [timer.py:258:stop] epoch=0/micro_step=8810/global_step=8810, RunningAvgSamplesPerSec=4.462421851903624, CurrSamplesPerSec=4.450112013954133, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:33:58,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=8820, skipped=43, lr=[1.4422288554160435e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:33:58,062] [INFO] [timer.py:258:stop] epoch=0/micro_step=8820/global_step=8820, RunningAvgSamplesPerSec=4.4624174343591525, CurrSamplesPerSec=4.457772864025729, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:34:07,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=8830, skipped=43, lr=[1.436137306313776e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:34:07,202] [INFO] [timer.py:258:stop] epoch=0/micro_step=8830/global_step=8830, RunningAvgSamplesPerSec=4.462402346369453, CurrSamplesPerSec=4.458954071530515, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:34:16,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=8840, skipped=43, lr=[1.4300858658956487e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:34:16,317] [INFO] [timer.py:258:stop] epoch=0/micro_step=8840/global_step=8840, RunningAvgSamplesPerSec=4.462395108218792, CurrSamplesPerSec=4.461314806497582, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:34:25,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=8850, skipped=43, lr=[1.4240745938869334e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:34:25,465] [INFO] [timer.py:258:stop] epoch=0/micro_step=8850/global_step=8850, RunningAvgSamplesPerSec=4.462377714508532, CurrSamplesPerSec=4.448775044753671, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:34:25,466] [INFO] [RANK 0]  iteration     8850/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 1.423E-05 | total loss 8.759010E-02 | loss 8.759010E-02 | loss scale 32768.0 |speed 263.04 samples/(min*GPU)
[2024-06-18 17:34:25,467] [INFO] [RANK 0] time (ms) | forward: 357.22 | backward: 549.16 | allreduce: 0.00 | optimizer: 5.24 | batch generator: 13.51 | data loader: 0.13
[2024-06-18 17:34:34,597] [INFO] [logging.py:96:log_dist] [Rank 0] step=8860, skipped=43, lr=[1.4181035496164586e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:34:34,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=8860/global_step=8860, RunningAvgSamplesPerSec=4.462361897210216, CurrSamplesPerSec=4.449753207244912, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:34:43,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=8870, skipped=43, lr=[1.4121727920160213e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:34:43,706] [INFO] [timer.py:258:stop] epoch=0/micro_step=8870/global_step=8870, RunningAvgSamplesPerSec=4.462356478296933, CurrSamplesPerSec=4.4579150023103695, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:34:52,825] [INFO] [logging.py:96:log_dist] [Rank 0] step=8880, skipped=43, lr=[1.4062823796198031e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:34:52,826] [INFO] [timer.py:258:stop] epoch=0/micro_step=8880/global_step=8880, RunningAvgSamplesPerSec=4.462352477334063, CurrSamplesPerSec=4.470456384633893, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:35:01,956] [INFO] [logging.py:96:log_dist] [Rank 0] step=8890, skipped=43, lr=[1.4004323705637988e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:35:01,957] [INFO] [timer.py:258:stop] epoch=0/micro_step=8890/global_step=8890, RunningAvgSamplesPerSec=4.462345406010321, CurrSamplesPerSec=4.457236373683595, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:35:11,095] [INFO] [logging.py:96:log_dist] [Rank 0] step=8900, skipped=43, lr=[1.3946228225852333e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:35:11,096] [INFO] [timer.py:258:stop] epoch=0/micro_step=8900/global_step=8900, RunningAvgSamplesPerSec=4.462339287245069, CurrSamplesPerSec=4.45186911349586, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:35:11,097] [INFO] [RANK 0]  iteration     8900/   10000 | elapsed time per iteration (ms): 912.6 | learning rate 1.394E-05 | total loss 1.181676E-01 | loss 1.181676E-01 | loss scale 32768.0 |speed 262.98 samples/(min*GPU)
[2024-06-18 17:35:11,098] [INFO] [RANK 0] time (ms) | forward: 357.54 | backward: 549.04 | allreduce: 0.00 | optimizer: 5.24 | batch generator: 14.24 | data loader: 0.10
[2024-06-18 17:35:20,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=8910, skipped=43, lr=[1.3888537930220021e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:35:20,200] [INFO] [timer.py:258:stop] epoch=0/micro_step=8910/global_step=8910, RunningAvgSamplesPerSec=4.462335639919839, CurrSamplesPerSec=4.460282937331133, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:35:29,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=8920, skipped=43, lr=[1.3831253388120965e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:35:29,317] [INFO] [timer.py:258:stop] epoch=0/micro_step=8920/global_step=8920, RunningAvgSamplesPerSec=4.462326041541195, CurrSamplesPerSec=4.457573885654088, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:35:38,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=8930, skipped=43, lr=[1.3774375164930476e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:35:38,452] [INFO] [timer.py:258:stop] epoch=0/micro_step=8930/global_step=8930, RunningAvgSamplesPerSec=4.462316319006239, CurrSamplesPerSec=4.431212108566337, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:35:43,922] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 17:35:44,833] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 17:35:47,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=8940, skipped=45, lr=[1.372916551336448e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:35:47,567] [INFO] [timer.py:258:stop] epoch=0/micro_step=8940/global_step=8940, RunningAvgSamplesPerSec=4.46230990012489, CurrSamplesPerSec=4.467751621027055, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:35:56,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=8950, skipped=45, lr=[1.3673020076151065e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:35:56,685] [INFO] [timer.py:258:stop] epoch=0/micro_step=8950/global_step=8950, RunningAvgSamplesPerSec=4.462301123223123, CurrSamplesPerSec=4.468127615773137, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:35:56,686] [INFO] [RANK 0]  iteration     8950/   10000 | elapsed time per iteration (ms): 911.8 | learning rate 1.367E-05 | total loss 8.458710E-02 | loss 8.458710E-02 | loss scale 32768.0 |speed 263.22 samples/(min*GPU)
[2024-06-18 17:35:56,687] [INFO] [RANK 0] time (ms) | forward: 356.84 | backward: 549.02 | allreduce: 0.00 | optimizer: 5.13 | batch generator: 13.43 | data loader: 0.11
[2024-06-18 17:36:05,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=8960, skipped=45, lr=[1.361728251954511e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:36:05,815] [INFO] [timer.py:258:stop] epoch=0/micro_step=8960/global_step=8960, RunningAvgSamplesPerSec=4.462292387679901, CurrSamplesPerSec=4.453588587364947, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:36:14,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=8970, skipped=45, lr=[1.3561953393653822e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:36:14,932] [INFO] [timer.py:258:stop] epoch=0/micro_step=8970/global_step=8970, RunningAvgSamplesPerSec=4.46228806290832, CurrSamplesPerSec=4.458180351361844, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:36:24,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=8980, skipped=45, lr=[1.350703324455331e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:36:24,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=8980/global_step=8980, RunningAvgSamplesPerSec=4.462279051294164, CurrSamplesPerSec=4.4585938376154095, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:36:33,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=8990, skipped=45, lr=[1.3452522614283298e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:36:33,166] [INFO] [timer.py:258:stop] epoch=0/micro_step=8990/global_step=8990, RunningAvgSamplesPerSec=4.462270339708618, CurrSamplesPerSec=4.442203380765298, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:36:42,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=9000, skipped=45, lr=[1.3398422040841683e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:36:42,302] [INFO] [timer.py:258:stop] epoch=0/micro_step=9000/global_step=9000, RunningAvgSamplesPerSec=4.462261581042851, CurrSamplesPerSec=4.455754294753236, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:36:42,303] [INFO] [RANK 0]  iteration     9000/   10000 | elapsed time per iteration (ms): 912.3 | learning rate 1.339E-05 | total loss 1.389545E-01 | loss 1.389545E-01 | loss scale 32768.0 |speed 263.06 samples/(min*GPU)
[2024-06-18 17:36:42,304] [INFO] [RANK 0] time (ms) | forward: 357.27 | backward: 549.06 | allreduce: 0.00 | optimizer: 5.23 | batch generator: 13.90 | data loader: 0.10
[2024-06-18 17:36:42,304] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:36:42,318] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/9000/mp_rank_00_model_states.pt
[2024-06-18 17:36:42,318] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/9000/mp_rank_00_model_states.pt...
[2024-06-18 17:37:11,490] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/9000/mp_rank_00_model_states.pt.
[2024-06-18 17:37:18,085] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 17:37:18,085] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 17:37:18,085] [INFO] [RANK 0]  validation loss at iteration 9000 | loss: 1.179001E-01 | PPL: 1.125132E+00 loss 1.178589E-01 |
[2024-06-18 17:37:18,085] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 17:37:27,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=9010, skipped=45, lr=[1.334473205817929e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:37:27,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=9010/global_step=9010, RunningAvgSamplesPerSec=4.4623008940952875, CurrSamplesPerSec=4.501410479240976, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:37:36,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=9020, skipped=45, lr=[1.3291453196194567e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:37:36,148] [INFO] [timer.py:258:stop] epoch=0/micro_step=9020/global_step=9020, RunningAvgSamplesPerSec=4.46233437553421, CurrSamplesPerSec=4.497037841964272, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:37:45,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=9030, skipped=45, lr=[1.323858598072838e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:37:45,216] [INFO] [timer.py:258:stop] epoch=0/micro_step=9030/global_step=9030, RunningAvgSamplesPerSec=4.462350553728706, CurrSamplesPerSec=4.452163279798553, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:37:54,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=9040, skipped=45, lr=[1.3186130933558795e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:37:54,309] [INFO] [timer.py:258:stop] epoch=0/micro_step=9040/global_step=9040, RunningAvgSamplesPerSec=4.46236168997896, CurrSamplesPerSec=4.480326952570353, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:38:03,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=9050, skipped=45, lr=[1.3134088572395957e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:38:03,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=9050/global_step=9050, RunningAvgSamplesPerSec=4.462364159714454, CurrSamplesPerSec=4.454435221684752, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:38:03,397] [INFO] [RANK 0]  iteration     9050/   10000 | elapsed time per iteration (ms): 1621.9 | learning rate 1.313E-05 | total loss 1.228125E-01 | loss 1.228125E-01 | loss scale 32768.0 |speed 147.98 samples/(min*GPU)
[2024-06-18 17:38:03,398] [INFO] [RANK 0] time (ms) | forward: 353.80 | backward: 546.69 | allreduce: 0.00 | optimizer: 5.01 | batch generator: 16.02 | data loader: 0.14
[2024-06-18 17:38:12,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=9060, skipped=45, lr=[1.3082459410876948e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:38:12,479] [INFO] [timer.py:258:stop] epoch=0/micro_step=9060/global_step=9060, RunningAvgSamplesPerSec=4.462366067636539, CurrSamplesPerSec=4.4587869821148525, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:38:21,577] [INFO] [logging.py:96:log_dist] [Rank 0] step=9070, skipped=45, lr=[1.3031243958560772e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:38:21,578] [INFO] [timer.py:258:stop] epoch=0/micro_step=9070/global_step=9070, RunningAvgSamplesPerSec=4.462368421344712, CurrSamplesPerSec=4.469358370155716, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:38:30,685] [INFO] [logging.py:96:log_dist] [Rank 0] step=9080, skipped=45, lr=[1.2980442720923245e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:38:30,685] [INFO] [timer.py:258:stop] epoch=0/micro_step=9080/global_step=9080, RunningAvgSamplesPerSec=4.462363137188367, CurrSamplesPerSec=4.452093574228556, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:38:39,806] [INFO] [logging.py:96:log_dist] [Rank 0] step=9090, skipped=45, lr=[1.2930056199352079e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:38:39,807] [INFO] [timer.py:258:stop] epoch=0/micro_step=9090/global_step=9090, RunningAvgSamplesPerSec=4.462357498734381, CurrSamplesPerSec=4.45783682513213, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:38:48,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=9100, skipped=45, lr=[1.288008489114191e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:38:48,927] [INFO] [timer.py:258:stop] epoch=0/micro_step=9100/global_step=9100, RunningAvgSamplesPerSec=4.462351250678643, CurrSamplesPerSec=4.464257660745266, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:38:48,929] [INFO] [RANK 0]  iteration     9100/   10000 | elapsed time per iteration (ms): 910.6 | learning rate 1.288E-05 | total loss 1.052317E-01 | loss 1.052317E-01 | loss scale 32768.0 |speed 263.56 samples/(min*GPU)
[2024-06-18 17:38:48,929] [INFO] [RANK 0] time (ms) | forward: 355.94 | backward: 548.86 | allreduce: 0.00 | optimizer: 5.07 | batch generator: 13.25 | data loader: 0.10
[2024-06-18 17:38:58,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=9110, skipped=45, lr=[1.2830529289489357e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:38:58,031] [INFO] [timer.py:258:stop] epoch=0/micro_step=9110/global_step=9110, RunningAvgSamplesPerSec=4.462348530087421, CurrSamplesPerSec=4.45810927262567, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:39:07,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=9120, skipped=45, lr=[1.2781389883488218e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:39:07,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=9120/global_step=9120, RunningAvgSamplesPerSec=4.462346043913311, CurrSamplesPerSec=4.467163958542739, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:39:16,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=9130, skipped=45, lr=[1.2732667158124584e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:39:16,231] [INFO] [timer.py:258:stop] epoch=0/micro_step=9130/global_step=9130, RunningAvgSamplesPerSec=4.462344979823949, CurrSamplesPerSec=4.460934026780682, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:39:25,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=9140, skipped=45, lr=[1.2684361594272092e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:39:25,363] [INFO] [timer.py:258:stop] epoch=0/micro_step=9140/global_step=9140, RunningAvgSamplesPerSec=4.462343095639877, CurrSamplesPerSec=4.4653163275381935, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:39:34,476] [INFO] [logging.py:96:log_dist] [Rank 0] step=9150, skipped=45, lr=[1.2636473668687148e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:39:34,476] [INFO] [timer.py:258:stop] epoch=0/micro_step=9150/global_step=9150, RunningAvgSamplesPerSec=4.462338745945313, CurrSamplesPerSec=4.46354384909122, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:39:34,477] [INFO] [RANK 0]  iteration     9150/   10000 | elapsed time per iteration (ms): 911.0 | learning rate 1.263E-05 | total loss 1.295294E-01 | loss 1.295294E-01 | loss scale 32768.0 |speed 263.46 samples/(min*GPU)
[2024-06-18 17:39:34,477] [INFO] [RANK 0] time (ms) | forward: 356.43 | backward: 548.77 | allreduce: 0.00 | optimizer: 5.03 | batch generator: 13.57 | data loader: 0.10
[2024-06-18 17:39:43,578] [INFO] [logging.py:96:log_dist] [Rank 0] step=9160, skipped=45, lr=[1.2589003854004248e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:39:43,579] [INFO] [timer.py:258:stop] epoch=0/micro_step=9160/global_step=9160, RunningAvgSamplesPerSec=4.462335950845498, CurrSamplesPerSec=4.455613477519453, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:39:52,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=9170, skipped=45, lr=[1.2541952618731295e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:39:52,699] [INFO] [timer.py:258:stop] epoch=0/micro_step=9170/global_step=9170, RunningAvgSamplesPerSec=4.4623285927545036, CurrSamplesPerSec=4.450078963548389, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:40:01,798] [INFO] [logging.py:96:log_dist] [Rank 0] step=9180, skipped=45, lr=[1.2495320427244986e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:40:01,799] [INFO] [timer.py:258:stop] epoch=0/micro_step=9180/global_step=9180, RunningAvgSamplesPerSec=4.462322980847113, CurrSamplesPerSec=4.456703564095004, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:40:10,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=9190, skipped=45, lr=[1.244910773978623e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:40:10,902] [INFO] [timer.py:258:stop] epoch=0/micro_step=9190/global_step=9190, RunningAvgSamplesPerSec=4.462317977572722, CurrSamplesPerSec=4.460558055767291, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:40:20,005] [INFO] [logging.py:96:log_dist] [Rank 0] step=9200, skipped=45, lr=[1.2403315012455589e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:40:20,006] [INFO] [timer.py:258:stop] epoch=0/micro_step=9200/global_step=9200, RunningAvgSamplesPerSec=4.462312508792238, CurrSamplesPerSec=4.462113350103167, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:40:20,010] [INFO] [RANK 0]  iteration     9200/   10000 | elapsed time per iteration (ms): 910.7 | learning rate 1.240E-05 | total loss 8.072522E-02 | loss 8.072522E-02 | loss scale 32768.0 |speed 263.54 samples/(min*GPU)
[2024-06-18 17:40:20,015] [INFO] [RANK 0] time (ms) | forward: 355.79 | backward: 548.95 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 12.64 | data loader: 0.12
[2024-06-18 17:40:29,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=9210, skipped=45, lr=[1.2357942697208805e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:40:29,128] [INFO] [timer.py:258:stop] epoch=0/micro_step=9210/global_step=9210, RunningAvgSamplesPerSec=4.462303328665944, CurrSamplesPerSec=4.461463102789701, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:40:38,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=9220, skipped=45, lr=[1.2312991241852295e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:40:38,257] [INFO] [timer.py:258:stop] epoch=0/micro_step=9220/global_step=9220, RunningAvgSamplesPerSec=4.4622950673250426, CurrSamplesPerSec=4.464805348223455, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:40:47,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=9230, skipped=45, lr=[1.226846109003879e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:40:47,393] [INFO] [timer.py:258:stop] epoch=0/micro_step=9230/global_step=9230, RunningAvgSamplesPerSec=4.462286028057683, CurrSamplesPerSec=4.448744373512586, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:40:56,518] [INFO] [logging.py:96:log_dist] [Rank 0] step=9240, skipped=45, lr=[1.22243526812629e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:40:56,518] [INFO] [timer.py:258:stop] epoch=0/micro_step=9240/global_step=9240, RunningAvgSamplesPerSec=4.4622715246196805, CurrSamplesPerSec=4.437814656370709, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:41:05,626] [INFO] [logging.py:96:log_dist] [Rank 0] step=9250, skipped=45, lr=[1.218066645085683e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:41:05,627] [INFO] [timer.py:258:stop] epoch=0/micro_step=9250/global_step=9250, RunningAvgSamplesPerSec=4.462267668833147, CurrSamplesPerSec=4.4610799253456115, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:41:05,628] [INFO] [RANK 0]  iteration     9250/   10000 | elapsed time per iteration (ms): 912.4 | learning rate 1.218E-05 | total loss 1.186753E-01 | loss 1.186753E-01 | loss scale 32768.0 |speed 263.05 samples/(min*GPU)
[2024-06-18 17:41:05,629] [INFO] [RANK 0] time (ms) | forward: 357.05 | backward: 549.08 | allreduce: 0.00 | optimizer: 5.35 | batch generator: 13.61 | data loader: 0.10
[2024-06-18 17:41:14,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=9260, skipped=45, lr=[1.2137402829986025e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:41:14,743] [INFO] [timer.py:258:stop] epoch=0/micro_step=9260/global_step=9260, RunningAvgSamplesPerSec=4.462263687674788, CurrSamplesPerSec=4.465047751736215, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:41:23,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=9270, skipped=45, lr=[1.2094562245644947e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:41:23,841] [INFO] [timer.py:258:stop] epoch=0/micro_step=9270/global_step=9270, RunningAvgSamplesPerSec=4.462265791817999, CurrSamplesPerSec=4.463195933827328, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:41:32,962] [INFO] [logging.py:96:log_dist] [Rank 0] step=9280, skipped=45, lr=[1.2052145120652885e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:41:32,963] [INFO] [timer.py:258:stop] epoch=0/micro_step=9280/global_step=9280, RunningAvgSamplesPerSec=4.462257928049646, CurrSamplesPerSec=4.438288948810736, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:41:42,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=9290, skipped=45, lr=[1.2010151873649731e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:41:42,085] [INFO] [timer.py:258:stop] epoch=0/micro_step=9290/global_step=9290, RunningAvgSamplesPerSec=4.4622499763340375, CurrSamplesPerSec=4.458225369067058, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:41:51,226] [INFO] [logging.py:96:log_dist] [Rank 0] step=9300, skipped=45, lr=[1.196858291909188e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:41:51,227] [INFO] [timer.py:258:stop] epoch=0/micro_step=9300/global_step=9300, RunningAvgSamplesPerSec=4.462235372417007, CurrSamplesPerSec=4.455118912728114, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:41:51,228] [INFO] [RANK 0]  iteration     9300/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 1.196E-05 | total loss 1.036092E-01 | loss 1.036092E-01 | loss scale 32768.0 |speed 263.16 samples/(min*GPU)
[2024-06-18 17:41:51,228] [INFO] [RANK 0] time (ms) | forward: 356.94 | backward: 549.09 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 13.80 | data loader: 0.09
[2024-06-18 17:41:51,229] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:41:51,243] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/9300/mp_rank_00_model_states.pt
[2024-06-18 17:41:51,243] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/9300/mp_rank_00_model_states.pt...
[2024-06-18 17:42:20,168] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/9300/mp_rank_00_model_states.pt.
[2024-06-18 17:42:29,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=9310, skipped=45, lr=[1.192743866724813e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:42:29,220] [INFO] [timer.py:258:stop] epoch=0/micro_step=9310/global_step=9310, RunningAvgSamplesPerSec=4.462279832323663, CurrSamplesPerSec=4.486077349277683, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:42:38,280] [INFO] [logging.py:96:log_dist] [Rank 0] step=9320, skipped=45, lr=[1.188671952419564e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:42:38,281] [INFO] [timer.py:258:stop] epoch=0/micro_step=9320/global_step=9320, RunningAvgSamplesPerSec=4.462309421752631, CurrSamplesPerSec=4.486703594959403, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:42:47,331] [INFO] [logging.py:96:log_dist] [Rank 0] step=9330, skipped=45, lr=[1.1846425891815909e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:42:47,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=9330/global_step=9330, RunningAvgSamplesPerSec=4.462328185098019, CurrSamplesPerSec=4.472440609035296, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:42:54,578] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 17:42:55,483] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 17:42:56,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=9340, skipped=47, lr=[1.1814497620979952e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:42:56,391] [INFO] [timer.py:258:stop] epoch=0/micro_step=9340/global_step=9340, RunningAvgSamplesPerSec=4.462346596123661, CurrSamplesPerSec=4.475946200763758, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:43:05,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=9350, skipped=47, lr=[1.1774970907144883e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:43:05,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=9350/global_step=9350, RunningAvgSamplesPerSec=4.462349252218511, CurrSamplesPerSec=4.449900735893821, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:43:05,485] [INFO] [RANK 0]  iteration     9350/   10000 | elapsed time per iteration (ms): 1485.1 | learning rate 1.177E-05 | total loss 1.207146E-01 | loss 1.207146E-01 | loss scale 32768.0 |speed 161.60 samples/(min*GPU)
[2024-06-18 17:43:05,486] [INFO] [RANK 0] time (ms) | forward: 354.29 | backward: 545.86 | allreduce: 0.00 | optimizer: 5.14 | batch generator: 13.40 | data loader: 0.11
[2024-06-18 17:43:14,577] [INFO] [logging.py:96:log_dist] [Rank 0] step=9360, skipped=47, lr=[1.1735870806896323e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:43:14,578] [INFO] [timer.py:258:stop] epoch=0/micro_step=9360/global_step=9360, RunningAvgSamplesPerSec=4.462353631851533, CurrSamplesPerSec=4.468039560695926, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:43:23,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=9370, skipped=47, lr=[1.1697197706136454e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:43:23,678] [INFO] [timer.py:258:stop] epoch=0/micro_step=9370/global_step=9370, RunningAvgSamplesPerSec=4.462346947206097, CurrSamplesPerSec=4.450403587015716, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:43:32,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=9380, skipped=47, lr=[1.1658951986553184e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:43:32,787] [INFO] [timer.py:258:stop] epoch=0/micro_step=9380/global_step=9380, RunningAvgSamplesPerSec=4.462343638136756, CurrSamplesPerSec=4.460926910021628, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:43:41,897] [INFO] [logging.py:96:log_dist] [Rank 0] step=9390, skipped=47, lr=[1.162113402561631e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:43:41,898] [INFO] [timer.py:258:stop] epoch=0/micro_step=9390/global_step=9390, RunningAvgSamplesPerSec=4.46234187496553, CurrSamplesPerSec=4.444167307487016, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:43:51,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=9400, skipped=47, lr=[1.1583744196573849e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:43:51,027] [INFO] [timer.py:258:stop] epoch=0/micro_step=9400/global_step=9400, RunningAvgSamplesPerSec=4.4623356994330186, CurrSamplesPerSec=4.455677376673712, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:43:51,028] [INFO] [RANK 0]  iteration     9400/   10000 | elapsed time per iteration (ms): 910.9 | learning rate 1.158E-05 | total loss 1.416996E-01 | loss 1.416996E-01 | loss scale 32768.0 |speed 263.49 samples/(min*GPU)
[2024-06-18 17:43:51,028] [INFO] [RANK 0] time (ms) | forward: 356.02 | backward: 548.93 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 13.41 | data loader: 0.10
[2024-06-18 17:44:00,117] [INFO] [logging.py:96:log_dist] [Rank 0] step=9410, skipped=47, lr=[1.154678286844832e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:44:00,117] [INFO] [timer.py:258:stop] epoch=0/micro_step=9410/global_step=9410, RunningAvgSamplesPerSec=4.462327957958389, CurrSamplesPerSec=4.456344877394321, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:44:09,217] [INFO] [logging.py:96:log_dist] [Rank 0] step=9420, skipped=47, lr=[1.1510250406033106e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:44:09,218] [INFO] [timer.py:258:stop] epoch=0/micro_step=9420/global_step=9420, RunningAvgSamplesPerSec=4.462324118558828, CurrSamplesPerSec=4.461196176561857, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:44:18,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=9430, skipped=47, lr=[1.147414716988886e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:44:18,314] [INFO] [timer.py:258:stop] epoch=0/micro_step=9430/global_step=9430, RunningAvgSamplesPerSec=4.462318495179279, CurrSamplesPerSec=4.4575845447593965, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:44:27,432] [INFO] [logging.py:96:log_dist] [Rank 0] step=9440, skipped=47, lr=[1.1438473516339948e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:44:27,434] [INFO] [timer.py:258:stop] epoch=0/micro_step=9440/global_step=9440, RunningAvgSamplesPerSec=4.462310627838974, CurrSamplesPerSec=4.445717080931572, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:44:36,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=9450, skipped=47, lr=[1.1403229797470932e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:44:36,558] [INFO] [timer.py:258:stop] epoch=0/micro_step=9450/global_step=9450, RunningAvgSamplesPerSec=4.4623007248040505, CurrSamplesPerSec=4.457130985680884, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:44:36,560] [INFO] [RANK 0]  iteration     9450/   10000 | elapsed time per iteration (ms): 910.6 | learning rate 1.140E-05 | total loss 9.559118E-02 | loss 9.559118E-02 | loss scale 32768.0 |speed 263.55 samples/(min*GPU)
[2024-06-18 17:44:36,560] [INFO] [RANK 0] time (ms) | forward: 355.51 | backward: 549.15 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 12.32 | data loader: 0.09
[2024-06-18 17:44:45,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=9460, skipped=47, lr=[1.1368416361123085e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:44:45,700] [INFO] [timer.py:258:stop] epoch=0/micro_step=9460/global_step=9460, RunningAvgSamplesPerSec=4.462290159355377, CurrSamplesPerSec=4.438131622755469, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:44:54,823] [INFO] [logging.py:96:log_dist] [Rank 0] step=9470, skipped=47, lr=[1.1334033550890973e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:44:54,824] [INFO] [timer.py:258:stop] epoch=0/micro_step=9470/global_step=9470, RunningAvgSamplesPerSec=4.462280227121018, CurrSamplesPerSec=4.453204397247155, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:45:03,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=9480, skipped=47, lr=[1.130008170611905e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:45:03,942] [INFO] [timer.py:258:stop] epoch=0/micro_step=9480/global_step=9480, RunningAvgSamplesPerSec=4.462268332649131, CurrSamplesPerSec=4.441154468230417, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:45:13,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=9490, skipped=47, lr=[1.1266561161898315e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:45:13,062] [INFO] [timer.py:258:stop] epoch=0/micro_step=9490/global_step=9490, RunningAvgSamplesPerSec=4.462255323014264, CurrSamplesPerSec=4.451022273395953, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:45:22,158] [INFO] [logging.py:96:log_dist] [Rank 0] step=9500, skipped=47, lr=[1.1233472249063011e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:45:22,159] [INFO] [timer.py:258:stop] epoch=0/micro_step=9500/global_step=9500, RunningAvgSamplesPerSec=4.462242930637988, CurrSamplesPerSec=4.439585552281619, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:45:22,160] [INFO] [RANK 0]  iteration     9500/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 1.123E-05 | total loss 1.500323E-01 | loss 1.500323E-01 | loss scale 32768.0 |speed 263.16 samples/(min*GPU)
[2024-06-18 17:45:22,161] [INFO] [RANK 0] time (ms) | forward: 356.80 | backward: 549.18 | allreduce: 0.00 | optimizer: 5.22 | batch generator: 12.68 | data loader: 0.10
[2024-06-18 17:45:31,265] [INFO] [logging.py:96:log_dist] [Rank 0] step=9510, skipped=47, lr=[1.1200815294187345e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:45:31,265] [INFO] [timer.py:258:stop] epoch=0/micro_step=9510/global_step=9510, RunningAvgSamplesPerSec=4.462242801338371, CurrSamplesPerSec=4.45916265461483, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:45:40,348] [INFO] [logging.py:96:log_dist] [Rank 0] step=9520, skipped=47, lr=[1.1168590619582276e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:45:40,349] [INFO] [timer.py:258:stop] epoch=0/micro_step=9520/global_step=9520, RunningAvgSamplesPerSec=4.46223927169573, CurrSamplesPerSec=4.457871175372738, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:45:49,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=9530, skipped=47, lr=[1.1136798543292344e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:45:49,434] [INFO] [timer.py:258:stop] epoch=0/micro_step=9530/global_step=9530, RunningAvgSamplesPerSec=4.46223787199441, CurrSamplesPerSec=4.460313767881103, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:45:58,537] [INFO] [logging.py:96:log_dist] [Rank 0] step=9540, skipped=47, lr=[1.1105439379092495e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:45:58,538] [INFO] [timer.py:258:stop] epoch=0/micro_step=9540/global_step=9540, RunningAvgSamplesPerSec=4.462233549862394, CurrSamplesPerSec=4.463531973956104, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:46:07,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=9550, skipped=47, lr=[1.107451343648502e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:46:07,660] [INFO] [timer.py:258:stop] epoch=0/micro_step=9550/global_step=9550, RunningAvgSamplesPerSec=4.462222602036085, CurrSamplesPerSec=4.451065965768329, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:46:07,662] [INFO] [RANK 0]  iteration     9550/   10000 | elapsed time per iteration (ms): 910.0 | learning rate 1.107E-05 | total loss 1.264170E-01 | loss 1.264170E-01 | loss scale 32768.0 |speed 263.73 samples/(min*GPU)
[2024-06-18 17:46:07,662] [INFO] [RANK 0] time (ms) | forward: 355.09 | backward: 549.09 | allreduce: 0.00 | optimizer: 5.12 | batch generator: 12.35 | data loader: 0.10
[2024-06-18 17:46:16,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=9560, skipped=47, lr=[1.1044021020696493e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:46:16,804] [INFO] [timer.py:258:stop] epoch=0/micro_step=9560/global_step=9560, RunningAvgSamplesPerSec=4.462213156522265, CurrSamplesPerSec=4.4497036398144285, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:46:25,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=9570, skipped=47, lr=[1.1013962432674742e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:46:25,953] [INFO] [timer.py:258:stop] epoch=0/micro_step=9570/global_step=9570, RunningAvgSamplesPerSec=4.462202622753511, CurrSamplesPerSec=4.461222274606407, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:46:35,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=9580, skipped=47, lr=[1.0984337969085906e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:46:35,085] [INFO] [timer.py:258:stop] epoch=0/micro_step=9580/global_step=9580, RunningAvgSamplesPerSec=4.46218926051228, CurrSamplesPerSec=4.435888005647574, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:46:44,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=9590, skipped=47, lr=[1.0955147922311467e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:46:44,210] [INFO] [timer.py:258:stop] epoch=0/micro_step=9590/global_step=9590, RunningAvgSamplesPerSec=4.4621761810837555, CurrSamplesPerSec=4.454384367242364, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:46:53,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=9600, skipped=47, lr=[1.0926392580445415e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:46:53,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=9600/global_step=9600, RunningAvgSamplesPerSec=4.462168517116978, CurrSamplesPerSec=4.4577468063233985, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:46:53,326] [INFO] [RANK 0]  iteration     9600/   10000 | elapsed time per iteration (ms): 913.3 | learning rate 1.092E-05 | total loss 1.425354E-01 | loss 1.425354E-01 | loss scale 32768.0 |speed 262.79 samples/(min*GPU)
[2024-06-18 17:46:53,326] [INFO] [RANK 0] time (ms) | forward: 358.09 | backward: 549.12 | allreduce: 0.00 | optimizer: 5.28 | batch generator: 14.12 | data loader: 0.12
[2024-06-18 17:46:53,327] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:46:53,340] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/9600/mp_rank_00_model_states.pt
[2024-06-18 17:46:53,340] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/9600/mp_rank_00_model_states.pt...
[2024-06-18 17:47:17,422] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/9600/mp_rank_00_model_states.pt.
[2024-06-18 17:47:26,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=9610, skipped=47, lr=[1.0898072227291352e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:47:26,485] [INFO] [timer.py:258:stop] epoch=0/micro_step=9610/global_step=9610, RunningAvgSamplesPerSec=4.462200169982548, CurrSamplesPerSec=4.494228592215819, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:47:35,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=9620, skipped=47, lr=[1.0870187142359746e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:47:35,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=9620/global_step=9620, RunningAvgSamplesPerSec=4.462226438392529, CurrSamplesPerSec=4.485531626373955, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:47:44,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=9630, skipped=47, lr=[1.0842737600865112e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:47:44,626] [INFO] [timer.py:258:stop] epoch=0/micro_step=9630/global_step=9630, RunningAvgSamplesPerSec=4.462242972284828, CurrSamplesPerSec=4.472167599233687, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:47:53,725] [INFO] [logging.py:96:log_dist] [Rank 0] step=9640, skipped=47, lr=[1.0815723873723347e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:47:53,726] [INFO] [timer.py:258:stop] epoch=0/micro_step=9640/global_step=9640, RunningAvgSamplesPerSec=4.462241983813585, CurrSamplesPerSec=4.4341528715111265, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:48:02,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=9650, skipped=47, lr=[1.0789146227549039e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:48:02,853] [INFO] [timer.py:258:stop] epoch=0/micro_step=9650/global_step=9650, RunningAvgSamplesPerSec=4.462239306833227, CurrSamplesPerSec=4.4565082324940795, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:48:02,854] [INFO] [RANK 0]  iteration     9650/   10000 | elapsed time per iteration (ms): 1390.6 | learning rate 1.079E-05 | total loss 1.039709E-01 | loss 1.039709E-01 | loss scale 32768.0 |speed 172.59 samples/(min*GPU)
[2024-06-18 17:48:02,855] [INFO] [RANK 0] time (ms) | forward: 355.91 | backward: 546.45 | allreduce: 0.00 | optimizer: 5.25 | batch generator: 14.11 | data loader: 0.10
[2024-06-18 17:48:11,992] [INFO] [logging.py:96:log_dist] [Rank 0] step=9660, skipped=47, lr=[1.0763004924652818e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:48:11,993] [INFO] [timer.py:258:stop] epoch=0/micro_step=9660/global_step=9660, RunningAvgSamplesPerSec=4.4622309111881195, CurrSamplesPerSec=4.4609447019618385, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:48:21,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=9670, skipped=47, lr=[1.0737300223038798e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:48:21,129] [INFO] [timer.py:258:stop] epoch=0/micro_step=9670/global_step=9670, RunningAvgSamplesPerSec=4.462221552360511, CurrSamplesPerSec=4.460924537773656, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:48:30,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=9680, skipped=47, lr=[1.0712032376401997e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:48:30,257] [INFO] [timer.py:258:stop] epoch=0/micro_step=9680/global_step=9680, RunningAvgSamplesPerSec=4.462216521381168, CurrSamplesPerSec=4.437598675588125, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:48:39,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=9690, skipped=47, lr=[1.0687201634125865e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:48:39,364] [INFO] [timer.py:258:stop] epoch=0/micro_step=9690/global_step=9690, RunningAvgSamplesPerSec=4.462214560555509, CurrSamplesPerSec=4.457883020406038, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:48:48,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=9700, skipped=47, lr=[1.0662808241279806e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:48:48,496] [INFO] [timer.py:258:stop] epoch=0/micro_step=9700/global_step=9700, RunningAvgSamplesPerSec=4.462206940437472, CurrSamplesPerSec=4.457242294505763, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:48:48,497] [INFO] [RANK 0]  iteration     9700/   10000 | elapsed time per iteration (ms): 912.9 | learning rate 1.066E-05 | total loss 1.217402E-01 | loss 1.217402E-01 | loss scale 32768.0 |speed 262.91 samples/(min*GPU)
[2024-06-18 17:48:48,500] [INFO] [RANK 0] time (ms) | forward: 357.67 | backward: 549.10 | allreduce: 0.00 | optimizer: 5.30 | batch generator: 14.63 | data loader: 0.09
[2024-06-18 17:48:57,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=9710, skipped=47, lr=[1.0638852438616758e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:48:57,620] [INFO] [timer.py:258:stop] epoch=0/micro_step=9710/global_step=9710, RunningAvgSamplesPerSec=4.46220069949681, CurrSamplesPerSec=4.454934366440653, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:49:06,734] [INFO] [logging.py:96:log_dist] [Rank 0] step=9720, skipped=47, lr=[1.0615334462570823e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:49:06,734] [INFO] [timer.py:258:stop] epoch=0/micro_step=9720/global_step=9720, RunningAvgSamplesPerSec=4.46219869556066, CurrSamplesPerSec=4.457528881104779, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:49:15,842] [INFO] [logging.py:96:log_dist] [Rank 0] step=9730, skipped=47, lr=[1.0592254545254925e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:49:15,843] [INFO] [timer.py:258:stop] epoch=0/micro_step=9730/global_step=9730, RunningAvgSamplesPerSec=4.462195236768428, CurrSamplesPerSec=4.462731735474097, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:49:24,950] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 17:49:24,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=9740, skipped=48, lr=[1.0569612914458534e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:49:24,951] [INFO] [timer.py:258:stop] epoch=0/micro_step=9740/global_step=9740, RunningAvgSamplesPerSec=4.462191549870747, CurrSamplesPerSec=4.459910632803647, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:49:25,858] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 17:49:34,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=9750, skipped=49, lr=[1.0551815326428509e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:49:34,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=9750/global_step=9750, RunningAvgSamplesPerSec=4.462186438427403, CurrSamplesPerSec=4.452820273408191, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:49:34,061] [INFO] [RANK 0]  iteration     9750/   10000 | elapsed time per iteration (ms): 911.3 | learning rate 1.055E-05 | total loss 1.308379E-01 | loss 1.308379E-01 | loss scale 32768.0 |speed 263.37 samples/(min*GPU)
[2024-06-18 17:49:34,062] [INFO] [RANK 0] time (ms) | forward: 356.33 | backward: 549.09 | allreduce: 0.00 | optimizer: 5.10 | batch generator: 13.48 | data loader: 0.10
[2024-06-18 17:49:43,178] [INFO] [logging.py:96:log_dist] [Rank 0] step=9760, skipped=49, lr=[1.0529963171587606e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:49:43,179] [INFO] [timer.py:258:stop] epoch=0/micro_step=9760/global_step=9760, RunningAvgSamplesPerSec=4.462176085578015, CurrSamplesPerSec=4.449872409634432, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:49:52,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=9770, skipped=49, lr=[1.050854991805692e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:49:52,303] [INFO] [timer.py:258:stop] epoch=0/micro_step=9770/global_step=9770, RunningAvgSamplesPerSec=4.462166606154701, CurrSamplesPerSec=4.439862823051634, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:50:01,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=9780, skipped=49, lr=[1.0487575777176611e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:50:01,434] [INFO] [timer.py:258:stop] epoch=0/micro_step=9780/global_step=9780, RunningAvgSamplesPerSec=4.462160053152094, CurrSamplesPerSec=4.447308017642679, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:50:10,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=9790, skipped=49, lr=[1.0467040955952996e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:50:10,553] [INFO] [timer.py:258:stop] epoch=0/micro_step=9790/global_step=9790, RunningAvgSamplesPerSec=4.462151086171694, CurrSamplesPerSec=4.458869932741749, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:50:19,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=9800, skipped=49, lr=[1.0446945657056462e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:50:19,641] [INFO] [timer.py:258:stop] epoch=0/micro_step=9800/global_step=9800, RunningAvgSamplesPerSec=4.462149011559121, CurrSamplesPerSec=4.462648641100154, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:50:19,642] [INFO] [RANK 0]  iteration     9800/   10000 | elapsed time per iteration (ms): 911.6 | learning rate 1.044E-05 | total loss 1.119171E-01 | loss 1.119171E-01 | loss scale 32768.0 |speed 263.27 samples/(min*GPU)
[2024-06-18 17:50:19,643] [INFO] [RANK 0] time (ms) | forward: 356.47 | backward: 549.24 | allreduce: 0.00 | optimizer: 5.15 | batch generator: 13.19 | data loader: 0.09
[2024-06-18 17:50:28,752] [INFO] [logging.py:96:log_dist] [Rank 0] step=9810, skipped=49, lr=[1.0427290078819494e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:50:28,753] [INFO] [timer.py:258:stop] epoch=0/micro_step=9810/global_step=9810, RunningAvgSamplesPerSec=4.462141705006806, CurrSamplesPerSec=4.446550118391152, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:50:37,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=9820, skipped=49, lr=[1.0408074415234714e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:50:37,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=9820/global_step=9820, RunningAvgSamplesPerSec=4.462139835653166, CurrSamplesPerSec=4.461663615052502, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:50:46,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=9830, skipped=49, lr=[1.0389298855952977e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:50:46,967] [INFO] [timer.py:258:stop] epoch=0/micro_step=9830/global_step=9830, RunningAvgSamplesPerSec=4.462135284058458, CurrSamplesPerSec=4.458354503844706, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:50:56,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=9840, skipped=49, lr=[1.0370963586281457e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:50:56,100] [INFO] [timer.py:258:stop] epoch=0/micro_step=9840/global_step=9840, RunningAvgSamplesPerSec=4.462133605500883, CurrSamplesPerSec=4.460757300650426, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:51:05,230] [INFO] [logging.py:96:log_dist] [Rank 0] step=9850, skipped=49, lr=[1.035306878718187e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:51:05,230] [INFO] [timer.py:258:stop] epoch=0/micro_step=9850/global_step=9850, RunningAvgSamplesPerSec=4.462126979999473, CurrSamplesPerSec=4.454637468283984, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:51:05,232] [INFO] [RANK 0]  iteration     9850/   10000 | elapsed time per iteration (ms): 911.8 | learning rate 1.035E-05 | total loss 1.180014E-01 | loss 1.180014E-01 | loss scale 32768.0 |speed 263.22 samples/(min*GPU)
[2024-06-18 17:51:05,233] [INFO] [RANK 0] time (ms) | forward: 356.81 | backward: 549.13 | allreduce: 0.00 | optimizer: 5.13 | batch generator: 13.97 | data loader: 0.09
[2024-06-18 17:51:14,343] [INFO] [logging.py:96:log_dist] [Rank 0] step=9860, skipped=49, lr=[1.0335614635268659e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:51:14,344] [INFO] [timer.py:258:stop] epoch=0/micro_step=9860/global_step=9860, RunningAvgSamplesPerSec=4.4621178785110684, CurrSamplesPerSec=4.45746374455079, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:51:23,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=9870, skipped=49, lr=[1.0318601302807253e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:51:23,460] [INFO] [timer.py:258:stop] epoch=0/micro_step=9870/global_step=9870, RunningAvgSamplesPerSec=4.462111359149509, CurrSamplesPerSec=4.46111669803439, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:51:32,584] [INFO] [logging.py:96:log_dist] [Rank 0] step=9880, skipped=49, lr=[1.0302028957712385e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:51:32,584] [INFO] [timer.py:258:stop] epoch=0/micro_step=9880/global_step=9880, RunningAvgSamplesPerSec=4.462101312098855, CurrSamplesPerSec=4.452592194303239, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:51:41,701] [INFO] [logging.py:96:log_dist] [Rank 0] step=9890, skipped=49, lr=[1.0285897763546393e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:51:41,702] [INFO] [timer.py:258:stop] epoch=0/micro_step=9890/global_step=9890, RunningAvgSamplesPerSec=4.462094084250464, CurrSamplesPerSec=4.443943645258296, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:51:50,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=9900, skipped=49, lr=[1.027020787951767e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:51:50,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=9900/global_step=9900, RunningAvgSamplesPerSec=4.462086479446172, CurrSamplesPerSec=4.443731775491269, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:51:50,836] [INFO] [RANK 0]  iteration     9900/   10000 | elapsed time per iteration (ms): 912.1 | learning rate 1.027E-05 | total loss 1.138564E-01 | loss 1.138564E-01 | loss scale 32768.0 |speed 263.14 samples/(min*GPU)
[2024-06-18 17:51:50,836] [INFO] [RANK 0] time (ms) | forward: 357.15 | backward: 548.93 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 13.43 | data loader: 0.11
[2024-06-18 17:51:50,837] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:51:50,854] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/9900/mp_rank_00_model_states.pt
[2024-06-18 17:51:50,854] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/9900/mp_rank_00_model_states.pt...
[2024-06-18 17:52:20,256] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/9900/mp_rank_00_model_states.pt.
[2024-06-18 17:52:29,310] [INFO] [logging.py:96:log_dist] [Rank 0] step=9910, skipped=49, lr=[1.0254959460479022e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:52:29,311] [INFO] [timer.py:258:stop] epoch=0/micro_step=9910/global_step=9910, RunningAvgSamplesPerSec=4.46212607170943, CurrSamplesPerSec=4.495553272571663, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:52:38,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=9920, skipped=49, lr=[1.0240152656926203e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:52:38,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=9920/global_step=9920, RunningAvgSamplesPerSec=4.4621534848931, CurrSamplesPerSec=4.4980566404129245, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:52:47,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=9930, skipped=49, lr=[1.0225787614996375e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:52:47,417] [INFO] [timer.py:258:stop] epoch=0/micro_step=9930/global_step=9930, RunningAvgSamplesPerSec=4.4621817043537755, CurrSamplesPerSec=4.484781024570948, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:52:56,500] [INFO] [logging.py:96:log_dist] [Rank 0] step=9940, skipped=49, lr=[1.0211864476466707e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:52:56,501] [INFO] [timer.py:258:stop] epoch=0/micro_step=9940/global_step=9940, RunningAvgSamplesPerSec=4.462197144768398, CurrSamplesPerSec=4.474610373590617, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:53:05,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=9950, skipped=49, lr=[1.0198383378752955e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:53:05,610] [INFO] [timer.py:258:stop] epoch=0/micro_step=9950/global_step=9950, RunningAvgSamplesPerSec=4.462204009076167, CurrSamplesPerSec=4.46684758892645, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:53:05,611] [INFO] [RANK 0]  iteration     9950/   10000 | elapsed time per iteration (ms): 1495.5 | learning rate 1.020E-05 | total loss 1.240639E-01 | loss 1.240639E-01 | loss scale 32768.0 |speed 160.48 samples/(min*GPU)
[2024-06-18 17:53:05,613] [INFO] [RANK 0] time (ms) | forward: 355.18 | backward: 545.73 | allreduce: 0.00 | optimizer: 5.13 | batch generator: 14.53 | data loader: 0.10
[2024-06-18 17:53:14,701] [INFO] [logging.py:96:log_dist] [Rank 0] step=9960, skipped=49, lr=[1.0185344454908107e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:53:14,701] [INFO] [timer.py:258:stop] epoch=0/micro_step=9960/global_step=9960, RunningAvgSamplesPerSec=4.46220271859631, CurrSamplesPerSec=4.469184547481245, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:53:23,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=9970, skipped=49, lr=[1.0172747833621082e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:53:23,804] [INFO] [timer.py:258:stop] epoch=0/micro_step=9970/global_step=9970, RunningAvgSamplesPerSec=4.462200960771759, CurrSamplesPerSec=4.459055990372369, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:53:32,913] [INFO] [logging.py:96:log_dist] [Rank 0] step=9980, skipped=49, lr=[1.0160593639215443e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:53:32,914] [INFO] [timer.py:258:stop] epoch=0/micro_step=9980/global_step=9980, RunningAvgSamplesPerSec=4.462193143421874, CurrSamplesPerSec=4.460507061425898, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:53:42,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=9990, skipped=49, lr=[1.0148881991648187e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:53:42,038] [INFO] [timer.py:258:stop] epoch=0/micro_step=9990/global_step=9990, RunningAvgSamplesPerSec=4.462192923320845, CurrSamplesPerSec=4.459782593381893, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:53:51,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=10000, skipped=49, lr=[1.0137613006508549e-05], mom=[[0.9, 0.95]]
[2024-06-18 17:53:51,147] [INFO] [timer.py:258:stop] epoch=0/micro_step=10000/global_step=10000, RunningAvgSamplesPerSec=4.462186454047004, CurrSamplesPerSec=4.4422857154961415, MemAllocated=14.63GB, MaxMemAllocated=18.96GB
[2024-06-18 17:53:51,148] [INFO] [RANK 0]  iteration    10000/   10000 | elapsed time per iteration (ms): 910.7 | learning rate 1.014E-05 | total loss 1.325340E-01 | loss 1.325340E-01 | loss scale 32768.0 |speed 263.52 samples/(min*GPU)
[2024-06-18 17:53:51,149] [INFO] [RANK 0] time (ms) | forward: 356.09 | backward: 548.76 | allreduce: 0.00 | optimizer: 5.12 | batch generator: 12.99 | data loader: 0.09
[2024-06-18 17:53:57,801] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 17:53:57,801] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-18 17:53:57,801] [INFO] [RANK 0]  validation loss at iteration 10000 | loss: 1.743713E-01 | PPL: 1.190498E+00 loss 1.744385E-01 |
[2024-06-18 17:53:57,801] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-18 17:53:58,044] [INFO] [RANK 0] Saving Model...
[2024-06-18 17:53:58,055] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-18-15-02/10000/mp_rank_00_model_states.pt
[2024-06-18 17:53:58,056] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-18-15-02/10000/mp_rank_00_model_states.pt...
[2024-06-18 17:54:26,987] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-18-15-02/10000/mp_rank_00_model_states.pt.
discover-01:1062089:1063311 [0] NCCL INFO [Service thread] Connection closed by localRank 0
discover-01:1062089:1086574 [0] NCCL INFO comm 0x55a193dcd700 rank 0 nranks 1 cudaDev 0 busId 1000 - Abort COMPLETE
[2024-06-18 17:54:29,661] [INFO] [launch.py:351:main] Process 1062089 exits successfully.
