NCCL_DEBUG=info NCCL_IB_DISABLE=0 NCCL_NET_GDR_LEVEL=2 deepspeed --master_port 16666 --hostfile hostfile_single finetune_visualglm.py --experiment-name finetune-visualglm-6b --model-parallel-size 1 --mode finetune --train-iters 10000 --resume-dataloader --max_source_length 64 --max_target_length 256 --layer_range 0 4 8 14 --pre_seq_len 4 --train-data ./finetune-data/train/dataset.json --valid-data ./finetune-data/test/dataset.json --distributed-backend nccl --lr-decay-style cosine --warmup .02 --checkpoint-activations --save-interval 300 --eval-interval 1000 --save ./checkpoints --split 1 --eval-iters 10 --eval-batch-size 8 --zero-stage 1 --lr 0.0001 --batch-size 4 --skip-init --fp16 --use_ptuning
[2024-06-17 21:53:25,982] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 21:53:28,787] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0: setting --include=localhost:0
[2024-06-17 21:53:28,788] [INFO] [runner.py:568:main] cmd = /DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/bin/python3.12 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=16666 --enable_each_rank_log=None finetune_visualglm.py --experiment-name finetune-visualglm-6b --model-parallel-size 1 --mode finetune --train-iters 10000 --resume-dataloader --max_source_length 64 --max_target_length 256 --layer_range 0 4 8 14 --pre_seq_len 4 --train-data ./finetune-data/train/dataset.json --valid-data ./finetune-data/test/dataset.json --distributed-backend nccl --lr-decay-style cosine --warmup .02 --checkpoint-activations --save-interval 300 --eval-interval 1000 --save ./checkpoints --split 1 --eval-iters 10 --eval-batch-size 8 --zero-stage 1 --lr 0.0001 --batch-size 4 --skip-init --fp16 --use_ptuning
[2024-06-17 21:53:31,745] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 21:53:33,651] [INFO] [launch.py:139:main] 0 NCCL_IB_DISABLE=0
[2024-06-17 21:53:33,651] [INFO] [launch.py:139:main] 0 NCCL_DEBUG=info
[2024-06-17 21:53:33,651] [INFO] [launch.py:139:main] 0 NCCL_NET_GDR_LEVEL=2
[2024-06-17 21:53:33,652] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2024-06-17 21:53:33,653] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2024-06-17 21:53:33,653] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2024-06-17 21:53:33,654] [INFO] [launch.py:164:main] dist_world_size=1
[2024-06-17 21:53:33,654] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2024-06-17 21:53:33,656] [INFO] [launch.py:256:main] process 761761 spawned with command: ['/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/bin/python3.12', '-u', 'finetune_visualglm.py', '--local_rank=0', '--experiment-name', 'finetune-visualglm-6b', '--model-parallel-size', '1', '--mode', 'finetune', '--train-iters', '10000', '--resume-dataloader', '--max_source_length', '64', '--max_target_length', '256', '--layer_range', '0', '4', '8', '14', '--pre_seq_len', '4', '--train-data', './finetune-data/train/dataset.json', '--valid-data', './finetune-data/test/dataset.json', '--distributed-backend', 'nccl', '--lr-decay-style', 'cosine', '--warmup', '.02', '--checkpoint-activations', '--save-interval', '300', '--eval-interval', '1000', '--save', './checkpoints', '--split', '1', '--eval-iters', '10', '--eval-batch-size', '8', '--zero-stage', '1', '--lr', '0.0001', '--batch-size', '4', '--skip-init', '--fp16', '--use_ptuning']
[2024-06-17 21:53:36,447] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 21:53:40,056] [INFO] using world size: 1 and model-parallel size: 1 
[2024-06-17 21:53:40,056] [INFO] > padded vocab (size: 100) with 28 dummy tokens (new size: 128)
[2024-06-17 21:53:40,059] [INFO] [RANK 0] > initializing model parallel with size 1
[2024-06-17 21:53:40,060] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-06-17 21:53:40,061] [WARNING] [config_utils.py:69:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
[2024-06-17 21:53:40,061] [INFO] [checkpointing.py:1048:_configure_using_config_file] {'partition_activations': False, 'contiguous_memory_optimization': False, 'cpu_checkpointing': False, 'number_checkpoints': None, 'synchronize_checkpoint_boundary': False, 'profile': False}
[2024-06-17 21:53:40,064] [INFO] [checkpointing.py:229:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
[2024-06-17 21:53:40,067] [INFO] [RANK 0] building FineTuneVisualGLMModel model ...
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
[2024-06-17 21:53:52,056] [INFO] [RANK 0]  > number of parameters on model parallel rank 0: 7803110912
[2024-06-17 21:54:00,700] [INFO] [RANK 0] global rank 0 is loading checkpoint /DATA_EDS2/AIGC/2311/dingkr2311/.sat_models/visualglm-6b/1/mp_rank_00_model_states.pt
[2024-06-17 21:54:23,313] [INFO] [RANK 0] Will continue but found unexpected_keys! Check whether you are loading correct checkpoints: ['transformer.position_embeddings.weight'].
[2024-06-17 21:54:23,313] [INFO] [RANK 0] > successfully loaded /DATA_EDS2/AIGC/2311/dingkr2311/.sat_models/visualglm-6b/1/mp_rank_00_model_states.pt
[2024-06-17 21:54:30,245] [INFO] [RANK 0] Try to load tokenizer from Huggingface transformers...
[2024-06-17 21:54:32,137] [INFO] [RANK 0] > Set tokenizer as a THUDM/chatglm-6b tokenizer! Now you can get_tokenizer() everywhere.
discover-01:761761:761761 [0] NCCL INFO Bootstrap : Using enp196s0f0:10.0.0.14<0>
discover-01:761761:761761 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
discover-01:761761:761761 [0] NCCL INFO cudaDriverVersion 12030
NCCL version 2.20.5+cuda12.4
discover-01:761761:763211 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
discover-01:761761:763211 [0] NCCL INFO NET/IB : No device found.
discover-01:761761:763211 [0] NCCL INFO NET/Socket : Using [0]enp196s0f0:10.0.0.14<0> [1]tun0:198.18.1.50<0>
discover-01:761761:763211 [0] NCCL INFO Using non-device net plugin version 0
discover-01:761761:763211 [0] NCCL INFO Using network Socket
discover-01:761761:763211 [0] NCCL INFO comm 0x556dfbabaf20 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x90ffbb23a1bd053e - Init START
discover-01:761761:763211 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:761761:763211 [0] NCCL INFO comm 0x556dfbabaf20 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:761761:763211 [0] NCCL INFO Channel 00/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 01/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 02/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 03/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 04/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 05/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 06/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 07/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 08/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 09/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 10/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 11/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 12/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 13/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 14/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 15/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 16/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 17/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 18/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 19/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 20/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 21/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 22/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 23/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 24/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 25/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 26/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 27/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 28/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 29/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 30/32 :    0
discover-01:761761:763211 [0] NCCL INFO Channel 31/32 :    0
discover-01:761761:763211 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:761761:763211 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:761761:763211 [0] NCCL INFO Connected all rings
discover-01:761761:763211 [0] NCCL INFO Connected all trees
discover-01:761761:763211 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:761761:763211 [0] NCCL INFO comm 0x556dfbabaf20 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x90ffbb23a1bd053e - Init COMPLETE
mixins.ptuning.prefix.0
mixins.ptuning.prefix.1
mixins.ptuning.prefix.2
mixins.ptuning.prefix.3
mixins.ptuning.prefix.4
mixins.ptuning.prefix.5
mixins.ptuning.prefix.6
mixins.ptuning.prefix.7
mixins.ptuning.prefix.8
mixins.ptuning.prefix.9
mixins.ptuning.prefix.10
mixins.ptuning.prefix.11
mixins.ptuning.prefix.12
mixins.ptuning.prefix.13
mixins.ptuning.prefix.14
mixins.ptuning.prefix.15
mixins.ptuning.prefix.16
mixins.ptuning.prefix.17
mixins.ptuning.prefix.18
mixins.ptuning.prefix.19
mixins.ptuning.prefix.20
mixins.ptuning.prefix.21
mixins.ptuning.prefix.22
mixins.ptuning.prefix.23
mixins.ptuning.prefix.24
mixins.ptuning.prefix.25
mixins.ptuning.prefix.26
mixins.ptuning.prefix.27
[2024-06-17 21:55:27,552] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.3, git-hash=unknown, git-branch=unknown
[2024-06-17 21:55:27,553] [WARNING] [config_utils.py:69:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
discover-01:761761:763216 [0] NCCL INFO Using non-device net plugin version 0
discover-01:761761:763216 [0] NCCL INFO Using network Socket
discover-01:761761:763216 [0] NCCL INFO bootstrapSplit: comm 0x556e0d020cf0 parent 0x556dfbabaf20 rank 0 nranks 1 color -1091263299 key 0 prev 0 next 0 - DONE
discover-01:761761:763216 [0] NCCL INFO comm 0x556e0d020cf0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x587128369a907a02 - Init START
discover-01:761761:763216 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:761761:763216 [0] NCCL INFO comm 0x556e0d020cf0 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:761761:763216 [0] NCCL INFO Channel 00/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 01/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 02/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 03/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 04/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 05/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 06/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 07/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 08/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 09/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 10/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 11/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 12/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 13/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 14/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 15/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 16/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 17/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 18/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 19/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 20/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 21/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 22/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 23/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 24/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 25/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 26/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 27/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 28/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 29/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 30/32 :    0
discover-01:761761:763216 [0] NCCL INFO Channel 31/32 :    0
discover-01:761761:763216 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:761761:763216 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:761761:763216 [0] NCCL INFO Connected all rings
discover-01:761761:763216 [0] NCCL INFO Connected all trees
discover-01:761761:763216 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:761761:763216 [0] NCCL INFO comm 0x556e0d020cf0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x587128369a907a02 - Init COMPLETE
[2024-06-17 21:55:27,664] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /DATA_EDS2/AIGC/2311/dingkr2311/.cache/torch_extensions/py312_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /DATA_EDS2/AIGC/2311/dingkr2311/.cache/torch_extensions/py312_cu121/fused_adam/build.ninja...
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.3072748184204102 seconds
[2024-06-17 21:55:28,983] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-06-17 21:55:28,986] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-06-17 21:55:28,990] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-06-17 21:55:28,990] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-06-17 21:55:28,990] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 1 optimizer
[2024-06-17 21:55:28,993] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 40000000
[2024-06-17 21:55:28,994] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 100000000
[2024-06-17 21:55:28,994] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-06-17 21:55:28,995] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-06-17 21:55:29,207] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2024-06-17 21:55:29,208] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 21:55:29,209] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 25.61 GB, percent = 2.5%
[2024-06-17 21:55:29,349] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2024-06-17 21:55:29,349] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 21:55:29,398] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 25.59 GB, percent = 2.5%
[2024-06-17 21:55:29,439] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-06-17 21:55:29,599] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2024-06-17 21:55:29,600] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 21:55:29,602] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 25.61 GB, percent = 2.5%
[2024-06-17 21:55:29,604] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2024-06-17 21:55:29,604] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-06-17 21:55:29,606] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-06-17 21:55:29,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0001], mom=[[0.9, 0.95]]
[2024-06-17 21:55:29,608] [INFO] [config.py:1000:print] DeepSpeedEngine configuration:
[2024-06-17 21:55:29,609] [INFO] [config.py:1004:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-06-17 21:55:29,610] [INFO] [config.py:1004:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-06-17 21:55:29,610] [INFO] [config.py:1004:print]   amp_enabled .................. False
[2024-06-17 21:55:29,610] [INFO] [config.py:1004:print]   amp_params ................... False
[2024-06-17 21:55:29,611] [INFO] [config.py:1004:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-06-17 21:55:29,611] [INFO] [config.py:1004:print]   bfloat16_enabled ............. False
[2024-06-17 21:55:29,612] [INFO] [config.py:1004:print]   bfloat16_immediate_grad_update  False
[2024-06-17 21:55:29,614] [INFO] [config.py:1004:print]   checkpoint_parallel_write_pipeline  False
[2024-06-17 21:55:29,614] [INFO] [config.py:1004:print]   checkpoint_tag_validation_enabled  True
[2024-06-17 21:55:29,614] [INFO] [config.py:1004:print]   checkpoint_tag_validation_fail  False
[2024-06-17 21:55:29,614] [INFO] [config.py:1004:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f3f4a087b60>
[2024-06-17 21:55:29,615] [INFO] [config.py:1004:print]   communication_data_type ...... None
[2024-06-17 21:55:29,615] [INFO] [config.py:1004:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-06-17 21:55:29,616] [INFO] [config.py:1004:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-06-17 21:55:29,617] [INFO] [config.py:1004:print]   curriculum_enabled_legacy .... False
[2024-06-17 21:55:29,617] [INFO] [config.py:1004:print]   curriculum_params_legacy ..... False
[2024-06-17 21:55:29,619] [INFO] [config.py:1004:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-06-17 21:55:29,619] [INFO] [config.py:1004:print]   data_efficiency_enabled ...... False
[2024-06-17 21:55:29,621] [INFO] [config.py:1004:print]   dataloader_drop_last ......... False
[2024-06-17 21:55:29,621] [INFO] [config.py:1004:print]   disable_allgather ............ False
[2024-06-17 21:55:29,621] [INFO] [config.py:1004:print]   dump_state ................... False
[2024-06-17 21:55:29,621] [INFO] [config.py:1004:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 400, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2024-06-17 21:55:29,622] [INFO] [config.py:1004:print]   eigenvalue_enabled ........... False
[2024-06-17 21:55:29,622] [INFO] [config.py:1004:print]   eigenvalue_gas_boundary_resolution  1
[2024-06-17 21:55:29,622] [INFO] [config.py:1004:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-06-17 21:55:29,622] [INFO] [config.py:1004:print]   eigenvalue_layer_num ......... 0
[2024-06-17 21:55:29,623] [INFO] [config.py:1004:print]   eigenvalue_max_iter .......... 100
[2024-06-17 21:55:29,623] [INFO] [config.py:1004:print]   eigenvalue_stability ......... 1e-06
[2024-06-17 21:55:29,625] [INFO] [config.py:1004:print]   eigenvalue_tol ............... 0.01
[2024-06-17 21:55:29,625] [INFO] [config.py:1004:print]   eigenvalue_verbose ........... False
[2024-06-17 21:55:29,625] [INFO] [config.py:1004:print]   elasticity_enabled ........... False
[2024-06-17 21:55:29,625] [INFO] [config.py:1004:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-06-17 21:55:29,626] [INFO] [config.py:1004:print]   fp16_auto_cast ............... False
[2024-06-17 21:55:29,626] [INFO] [config.py:1004:print]   fp16_enabled ................. True
[2024-06-17 21:55:29,626] [INFO] [config.py:1004:print]   fp16_master_weights_and_gradients  False
[2024-06-17 21:55:29,626] [INFO] [config.py:1004:print]   global_rank .................. 0
[2024-06-17 21:55:29,628] [INFO] [config.py:1004:print]   grad_accum_dtype ............. None
[2024-06-17 21:55:29,628] [INFO] [config.py:1004:print]   gradient_accumulation_steps .. 1
[2024-06-17 21:55:29,628] [INFO] [config.py:1004:print]   gradient_clipping ............ 0.1
[2024-06-17 21:55:29,628] [INFO] [config.py:1004:print]   gradient_predivide_factor .... 1.0
[2024-06-17 21:55:29,629] [INFO] [config.py:1004:print]   graph_harvesting ............. False
[2024-06-17 21:55:29,629] [INFO] [config.py:1004:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-06-17 21:55:29,629] [INFO] [config.py:1004:print]   initial_dynamic_scale ........ 65536
[2024-06-17 21:55:29,630] [INFO] [config.py:1004:print]   load_universal_checkpoint .... False
[2024-06-17 21:55:29,630] [INFO] [config.py:1004:print]   loss_scale ................... 0
[2024-06-17 21:55:29,630] [INFO] [config.py:1004:print]   memory_breakdown ............. False
[2024-06-17 21:55:29,630] [INFO] [config.py:1004:print]   mics_hierarchial_params_gather  False
[2024-06-17 21:55:29,631] [INFO] [config.py:1004:print]   mics_shard_size .............. -1
[2024-06-17 21:55:29,631] [INFO] [config.py:1004:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-06-17 21:55:29,632] [INFO] [config.py:1004:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-06-17 21:55:29,632] [INFO] [config.py:1004:print]   optimizer_legacy_fusion ...... False
[2024-06-17 21:55:29,633] [INFO] [config.py:1004:print]   optimizer_name ............... adam
[2024-06-17 21:55:29,633] [INFO] [config.py:1004:print]   optimizer_params ............. {'lr': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'weight_decay': 0.01}
[2024-06-17 21:55:29,634] [INFO] [config.py:1004:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-06-17 21:55:29,634] [INFO] [config.py:1004:print]   pld_enabled .................. False
[2024-06-17 21:55:29,634] [INFO] [config.py:1004:print]   pld_params ................... False
[2024-06-17 21:55:29,634] [INFO] [config.py:1004:print]   prescale_gradients ........... False
[2024-06-17 21:55:29,634] [INFO] [config.py:1004:print]   scheduler_name ............... None
[2024-06-17 21:55:29,634] [INFO] [config.py:1004:print]   scheduler_params ............. None
[2024-06-17 21:55:29,634] [INFO] [config.py:1004:print]   seq_parallel_communication_data_type  torch.float32
[2024-06-17 21:55:29,636] [INFO] [config.py:1004:print]   sparse_attention ............. None
[2024-06-17 21:55:29,636] [INFO] [config.py:1004:print]   sparse_gradients_enabled ..... False
[2024-06-17 21:55:29,637] [INFO] [config.py:1004:print]   steps_per_print .............. 10
[2024-06-17 21:55:29,637] [INFO] [config.py:1004:print]   timers_config ................ enabled=True synchronized=True
[2024-06-17 21:55:29,638] [INFO] [config.py:1004:print]   train_batch_size ............. 4
[2024-06-17 21:55:29,638] [INFO] [config.py:1004:print]   train_micro_batch_size_per_gpu  4
[2024-06-17 21:55:29,640] [INFO] [config.py:1004:print]   use_data_before_expert_parallel_  False
[2024-06-17 21:55:29,640] [INFO] [config.py:1004:print]   use_node_local_storage ....... False
[2024-06-17 21:55:29,640] [INFO] [config.py:1004:print]   wall_clock_breakdown ......... False
[2024-06-17 21:55:29,642] [INFO] [config.py:1004:print]   weight_quantization_config ... None
[2024-06-17 21:55:29,642] [INFO] [config.py:1004:print]   world_size ................... 1
[2024-06-17 21:55:29,642] [INFO] [config.py:1004:print]   zero_allow_untested_optimizer  True
[2024-06-17 21:55:29,642] [INFO] [config.py:1004:print]   zero_config .................. stage=1 contiguous_gradients=False reduce_scatter=True reduce_bucket_size=40000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=100000000 overlap_comm=True load_from_fp32_weights=False elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-06-17 21:55:29,643] [INFO] [config.py:1004:print]   zero_enabled ................. True
[2024-06-17 21:55:29,643] [INFO] [config.py:1004:print]   zero_force_ds_cpu_optimizer .. True
[2024-06-17 21:55:29,644] [INFO] [config.py:1004:print]   zero_optimization_stage ...... 1
[2024-06-17 21:55:29,644] [INFO] [config.py:990:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "gradient_clipping": 0.1, 
    "zero_optimization": {
        "stage": 1, 
        "cpu_offload": false, 
        "contiguous_gradients": false, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 4.000000e+07, 
        "allgather_bucket_size": 1.000000e+08, 
        "load_from_fp32_weights": false
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 400, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "bf16": {
        "enabled": false
    }, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0001, 
            "betas": [0.9, 0.95], 
            "eps": 1e-08, 
            "weight_decay": 0.01
        }
    }, 
    "activation_checkpointing": {
        "partition_activations": false, 
        "contiguous_memory_optimization": false
    }, 
    "wall_clock_breakdown": false
}
[2024-06-17 21:55:29,645] [INFO] [RANK 0] learning rate decaying style cosine, ratio 10.0
[2024-06-17 21:55:29,646] [INFO] [RANK 0] Finetuning Model...
[2024-06-17 21:55:29,646] [INFO] [RANK 0] arguments:
[2024-06-17 21:55:29,646] [INFO] [RANK 0]   model_class .................. VisualGLMModel
[2024-06-17 21:55:29,646] [INFO] [RANK 0]   tokenizer_type ............... THUDM/chatglm-6b
[2024-06-17 21:55:29,646] [INFO] [RANK 0]   num_layers ................... 28
[2024-06-17 21:55:29,646] [INFO] [RANK 0]   hidden_size .................. 4096
[2024-06-17 21:55:29,648] [INFO] [RANK 0]   num_attention_heads .......... 32
[2024-06-17 21:55:29,648] [INFO] [RANK 0]   vocab_size ................... 130528
[2024-06-17 21:55:29,648] [INFO] [RANK 0]   layernorm_order .............. post
[2024-06-17 21:55:29,649] [INFO] [RANK 0]   model_parallel_size .......... 1
[2024-06-17 21:55:29,649] [INFO] [RANK 0]   max_sequence_length .......... 2048
[2024-06-17 21:55:29,649] [INFO] [RANK 0]   image_length ................. 32
[2024-06-17 21:55:29,649] [INFO] [RANK 0]   eva_args ..................... {'num_layers': 39, 'hidden_size': 1408, 'num_attention_heads': 16, 'vocab_size': 1, 'layernorm_order': 'pre', 'model_parallel_size': 1, 'max_sequence_length': 257, 'inner_hidden_size': 6144, 'use_final_layernorm': False, 'layernorm_epsilon': 1e-06, 'image_size': [224, 224], 'pre_len': 1, 'post_len': 0, 'in_channels': 3, 'num_classes': 0, 'patch_size': 14}
[2024-06-17 21:55:29,649] [INFO] [RANK 0]   qformer_args ................. {'num_layers': 12, 'hidden_size': 768, 'num_attention_heads': 12, 'vocab_size': 32, 'layernorm_order': 'post', 'model_parallel_size': 1, 'max_sequence_length': 0, 'is_decoder': [True, False, True, False, True, False, True, False, True, False, True, False], 'cross_attn_hidden_size': 1408, 'layernorm_epsilon': 1e-12}
[2024-06-17 21:55:29,650] [INFO] [RANK 0]   bos_token_id ................. 130004
[2024-06-17 21:55:29,650] [INFO] [RANK 0]   mask_token_id ................ 130000
[2024-06-17 21:55:29,650] [INFO] [RANK 0]   gmask_token_id ............... 130001
[2024-06-17 21:55:29,652] [INFO] [RANK 0]   pad_token_id ................. 3
[2024-06-17 21:55:29,652] [INFO] [RANK 0]   image_size ................... [224, 224]
[2024-06-17 21:55:29,652] [INFO] [RANK 0]   pre_len ...................... 1
[2024-06-17 21:55:29,653] [INFO] [RANK 0]   post_len ..................... 0
[2024-06-17 21:55:29,653] [INFO] [RANK 0]   in_channels .................. 3
[2024-06-17 21:55:29,653] [INFO] [RANK 0]   patch_size ................... 14
[2024-06-17 21:55:29,654] [INFO] [RANK 0]   inner_hidden_size ............ None
[2024-06-17 21:55:29,654] [INFO] [RANK 0]   hidden_size_per_attention_head  None
[2024-06-17 21:55:29,654] [INFO] [RANK 0]   skip_init .................... True
[2024-06-17 21:55:29,655] [INFO] [RANK 0]   use_gpu_initialization ....... False
[2024-06-17 21:55:29,655] [INFO] [RANK 0]   num_multi_query_heads ........ 0
[2024-06-17 21:55:29,656] [INFO] [RANK 0]   layernorm_epsilon ............ 1e-05
[2024-06-17 21:55:29,657] [INFO] [RANK 0]   hidden_dropout ............... 0.1
[2024-06-17 21:55:29,659] [INFO] [RANK 0]   attention_dropout ............ 0.1
[2024-06-17 21:55:29,659] [INFO] [RANK 0]   make_vocab_size_divisible_by . 128
[2024-06-17 21:55:29,662] [INFO] [RANK 0]   experiment_name .............. finetune-visualglm-6b-06-17-21-54
[2024-06-17 21:55:29,662] [INFO] [RANK 0]   train_iters .................. 10000
[2024-06-17 21:55:29,662] [INFO] [RANK 0]   batch_size ................... 4
[2024-06-17 21:55:29,663] [INFO] [RANK 0]   lr ........................... 0.0001
[2024-06-17 21:55:29,663] [INFO] [RANK 0]   mode ......................... finetune
[2024-06-17 21:55:29,663] [INFO] [RANK 0]   seed ......................... 1234
[2024-06-17 21:55:29,665] [INFO] [RANK 0]   zero_stage ................... 1
[2024-06-17 21:55:29,665] [INFO] [RANK 0]   checkpoint_activations ....... True
[2024-06-17 21:55:29,665] [INFO] [RANK 0]   checkpoint_num_layers ........ 1
[2024-06-17 21:55:29,666] [INFO] [RANK 0]   fp16 ......................... True
[2024-06-17 21:55:29,666] [INFO] [RANK 0]   bf16 ......................... False
[2024-06-17 21:55:29,667] [INFO] [RANK 0]   gradient_accumulation_steps .. 1
[2024-06-17 21:55:29,667] [INFO] [RANK 0]   epochs ....................... None
[2024-06-17 21:55:29,667] [INFO] [RANK 0]   log_interval ................. 50
[2024-06-17 21:55:29,668] [INFO] [RANK 0]   summary_dir .................. 
[2024-06-17 21:55:29,669] [INFO] [RANK 0]   save_args .................... False
[2024-06-17 21:55:29,669] [INFO] [RANK 0]   lr_decay_iters ............... None
[2024-06-17 21:55:29,671] [INFO] [RANK 0]   lr_decay_style ............... cosine
[2024-06-17 21:55:29,672] [INFO] [RANK 0]   lr_decay_ratio ............... 0.1
[2024-06-17 21:55:29,673] [INFO] [RANK 0]   warmup ....................... 0.02
[2024-06-17 21:55:29,673] [INFO] [RANK 0]   weight_decay ................. 0.01
[2024-06-17 21:55:29,673] [INFO] [RANK 0]   save ......................... ./checkpoints/finetune-visualglm-6b-06-17-21-54
[2024-06-17 21:55:29,674] [INFO] [RANK 0]   load ......................... None
[2024-06-17 21:55:29,674] [INFO] [RANK 0]   save_interval ................ 300
[2024-06-17 21:55:29,674] [INFO] [RANK 0]   no_save_rng .................. False
[2024-06-17 21:55:29,674] [INFO] [RANK 0]   no_load_rng .................. False
[2024-06-17 21:55:29,674] [INFO] [RANK 0]   resume_dataloader ............ True
[2024-06-17 21:55:29,674] [INFO] [RANK 0]   distributed_backend .......... nccl
[2024-06-17 21:55:29,674] [INFO] [RANK 0]   local_rank ................... 0
[2024-06-17 21:55:29,675] [INFO] [RANK 0]   exit_interval ................ None
[2024-06-17 21:55:29,675] [INFO] [RANK 0]   eval_batch_size .............. 8
[2024-06-17 21:55:29,675] [INFO] [RANK 0]   eval_iters ................... 10
[2024-06-17 21:55:29,676] [INFO] [RANK 0]   eval_interval ................ 1000
[2024-06-17 21:55:29,676] [INFO] [RANK 0]   strict_eval .................. False
[2024-06-17 21:55:29,676] [INFO] [RANK 0]   train_data ................... ['./finetune-data/train/dataset.json']
[2024-06-17 21:55:29,676] [INFO] [RANK 0]   train_data_weights ........... None
[2024-06-17 21:55:29,677] [INFO] [RANK 0]   iterable_dataset ............. False
[2024-06-17 21:55:29,677] [INFO] [RANK 0]   valid_data ................... ['./finetune-data/test/dataset.json']
[2024-06-17 21:55:29,677] [INFO] [RANK 0]   test_data .................... None
[2024-06-17 21:55:29,679] [INFO] [RANK 0]   split ........................ 1
[2024-06-17 21:55:29,681] [INFO] [RANK 0]   num_workers .................. 1
[2024-06-17 21:55:29,681] [INFO] [RANK 0]   block_size ................... 10000
[2024-06-17 21:55:29,681] [INFO] [RANK 0]   prefetch_factor .............. 4
[2024-06-17 21:55:29,682] [INFO] [RANK 0]   temperature .................. 1.0
[2024-06-17 21:55:29,682] [INFO] [RANK 0]   top_p ........................ 0.0
[2024-06-17 21:55:29,682] [INFO] [RANK 0]   top_k ........................ 0
[2024-06-17 21:55:29,683] [INFO] [RANK 0]   num_beams .................... 1
[2024-06-17 21:55:29,685] [INFO] [RANK 0]   length_penalty ............... 0.0
[2024-06-17 21:55:29,685] [INFO] [RANK 0]   no_repeat_ngram_size ......... 0
[2024-06-17 21:55:29,685] [INFO] [RANK 0]   min_tgt_length ............... 0
[2024-06-17 21:55:29,687] [INFO] [RANK 0]   out_seq_length ............... 256
[2024-06-17 21:55:29,688] [INFO] [RANK 0]   input_source ................. interactive
[2024-06-17 21:55:29,688] [INFO] [RANK 0]   output_path .................. ./samples
[2024-06-17 21:55:29,688] [INFO] [RANK 0]   with_id ...................... False
[2024-06-17 21:55:29,689] [INFO] [RANK 0]   max_inference_batch_size ..... 12
[2024-06-17 21:55:29,689] [INFO] [RANK 0]   device ....................... cpu
[2024-06-17 21:55:29,689] [INFO] [RANK 0]   deepspeed .................... True
[2024-06-17 21:55:29,689] [INFO] [RANK 0]   deepspeed_config ............. {'train_micro_batch_size_per_gpu': 4, 'gradient_accumulation_steps': 1, 'gradient_clipping': 0.1, 'zero_optimization': {'stage': 1, 'cpu_offload': False, 'contiguous_gradients': False, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 40000000.0, 'allgather_bucket_size': 100000000.0, 'load_from_fp32_weights': False}, 'zero_allow_untested_optimizer': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 400, 'hysteresis': 2, 'min_loss_scale': 1}, 'bf16': {'enabled': False}, 'optimizer': {'type': 'Adam', 'params': {'lr': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'weight_decay': 0.01}}, 'activation_checkpointing': {'partition_activations': False, 'contiguous_memory_optimization': False}, 'wall_clock_breakdown': False}
[2024-06-17 21:55:29,690] [INFO] [RANK 0]   deepscale .................... False
[2024-06-17 21:55:29,690] [INFO] [RANK 0]   deepscale_config ............. None
[2024-06-17 21:55:29,691] [INFO] [RANK 0]   cuda ......................... True
[2024-06-17 21:55:29,692] [INFO] [RANK 0]   rank ......................... 0
[2024-06-17 21:55:29,692] [INFO] [RANK 0]   world_size ................... 1
[2024-06-17 21:55:29,692] [INFO] [RANK 0]   deepspeed_activation_checkpointing  True
[2024-06-17 21:55:29,694] [INFO] [RANK 0]   master_ip .................... 127.0.0.1
[2024-06-17 21:55:29,695] [INFO] [RANK 0]   master_port .................. 16666
[2024-06-17 21:55:29,696] [INFO] [RANK 0]   max_source_length ............ 64
[2024-06-17 21:55:29,696] [INFO] [RANK 0]   max_target_length ............ 256
[2024-06-17 21:55:29,696] [INFO] [RANK 0]   ignore_pad_token_for_loss .... True
[2024-06-17 21:55:29,697] [INFO] [RANK 0]   source_prefix ................ 
[2024-06-17 21:55:29,697] [INFO] [RANK 0]   pre_seq_len .................. 4
[2024-06-17 21:55:29,697] [INFO] [RANK 0]   lora_rank .................... 10
[2024-06-17 21:55:29,698] [INFO] [RANK 0]   use_ptuning .................. True
[2024-06-17 21:55:29,698] [INFO] [RANK 0]   use_lora ..................... False
[2024-06-17 21:55:29,698] [INFO] [RANK 0]   use_qlora .................... False
[2024-06-17 21:55:29,699] [INFO] [RANK 0]   layer_range .................. [0, 4, 8, 14]
[2024-06-17 21:55:29,701] [INFO] [RANK 0]   do_train ..................... True
[2024-06-17 21:55:29,701] [INFO] [RANK 0]   val_last_shape ............... []
[2024-06-17 21:55:29,702] [INFO] [RANK 0]   val_drop_number .............. 0
[2024-06-17 21:55:29,703] [INFO] [RANK 0]   do_valid ..................... True
[2024-06-17 21:55:29,703] [INFO] [RANK 0]   do_test ...................... False
[2024-06-17 21:55:29,703] [INFO] [RANK 0]   iteration .................... 0
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/sat/mpu/data.py:49: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  sizes_cuda = torch.cuda.LongTensor(sizes)
discover-01:761761:763383 [0] NCCL INFO Using non-device net plugin version 0
discover-01:761761:763383 [0] NCCL INFO Using network Socket
discover-01:761761:763383 [0] NCCL INFO bootstrapSplit: comm 0x556dddc747f0 parent 0x556dfbabaf20 rank 0 nranks 1 color -1091263299 key 0 prev 0 next 0 - DONE
discover-01:761761:763383 [0] NCCL INFO comm 0x556dddc747f0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x587128369a907a02 - Init START
discover-01:761761:763383 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:761761:763383 [0] NCCL INFO comm 0x556dddc747f0 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:761761:763383 [0] NCCL INFO Channel 00/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 01/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 02/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 03/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 04/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 05/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 06/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 07/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 08/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 09/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 10/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 11/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 12/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 13/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 14/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 15/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 16/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 17/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 18/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 19/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 20/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 21/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 22/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 23/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 24/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 25/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 26/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 27/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 28/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 29/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 30/32 :    0
discover-01:761761:763383 [0] NCCL INFO Channel 31/32 :    0
discover-01:761761:763383 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:761761:763383 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:761761:763383 [0] NCCL INFO Connected all rings
discover-01:761761:763383 [0] NCCL INFO Connected all trees
discover-01:761761:763383 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:761761:763383 [0] NCCL INFO comm 0x556dddc747f0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x587128369a907a02 - Init COMPLETE
[2024-06-17 21:55:31,855] [INFO] [checkpointing.py:541:forward] Activation Checkpointing Information
[2024-06-17 21:55:31,855] [INFO] [checkpointing.py:542:forward] ----Partition Activations False, CPU CHECKPOINTING False
[2024-06-17 21:55:31,855] [INFO] [checkpointing.py:543:forward] ----contiguous Memory Checkpointing False with 6 total layers
[2024-06-17 21:55:31,856] [INFO] [checkpointing.py:545:forward] ----Synchronization False
[2024-06-17 21:55:31,856] [INFO] [checkpointing.py:546:forward] ----Profiling time in checkpointing False
[2024-06-17 21:55:34,084] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 21:55:35,006] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 21:55:42,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:55:42,466] [INFO] [timer.py:258:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=4.369190972425453, CurrSamplesPerSec=4.454994697198623, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:55:51,544] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:55:51,544] [INFO] [timer.py:258:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=4.424262866388662, CurrSamplesPerSec=4.490527242725437, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:56:00,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:56:00,625] [INFO] [timer.py:258:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=4.4427901663634, CurrSamplesPerSec=4.466012873727953, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:56:09,724] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:56:09,725] [INFO] [timer.py:258:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=4.449660595310169, CurrSamplesPerSec=4.463569974610896, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:56:18,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:56:18,827] [INFO] [timer.py:258:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=4.452153877295585, CurrSamplesPerSec=4.449865328125933, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:56:18,828] [INFO] [RANK 0]  iteration       50/   10000 | elapsed time per iteration (ms): 977.3 | learning rate 5.000E-06 | total loss 3.263555E+00 | loss 3.263555E+00 | loss scale 32768.0 |speed 245.57 samples/(min*GPU)
[2024-06-17 21:56:18,830] [INFO] [RANK 0] after 50 iterations memory (MB) | allocated: 14935.013671875 | max allocated: 17775.19873046875 | cached: 19336.0 | max cached: 19336.0
[2024-06-17 21:56:18,830] [INFO] [RANK 0] time (ms) | forward: 406.32 | backward: 560.55 | allreduce: 0.00 | optimizer: 9.44 | batch generator: 15.82 | data loader: 0.25
[2024-06-17 21:56:27,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:56:27,972] [INFO] [timer.py:258:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=4.450094043752674, CurrSamplesPerSec=4.452412583682358, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:56:37,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:56:37,097] [INFO] [timer.py:258:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=4.449505224950776, CurrSamplesPerSec=4.424828727020304, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:56:46,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:56:46,246] [INFO] [timer.py:258:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=4.448821944742347, CurrSamplesPerSec=4.444374509428379, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:56:55,393] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:56:55,393] [INFO] [timer.py:258:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=4.44840161631309, CurrSamplesPerSec=4.4438165209737654, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:57:04,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 21:57:04,552] [INFO] [timer.py:258:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=4.44691946187565, CurrSamplesPerSec=4.442682141134968, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:57:04,554] [INFO] [RANK 0]  iteration      100/   10000 | elapsed time per iteration (ms): 914.5 | learning rate 5.000E-06 | total loss 3.222734E+00 | loss 3.222734E+00 | loss scale 32768.0 |speed 262.44 samples/(min*GPU)
[2024-06-17 21:57:04,554] [INFO] [RANK 0] time (ms) | forward: 356.57 | backward: 552.10 | allreduce: 0.00 | optimizer: 5.03 | batch generator: 13.42 | data loader: 0.09
[2024-06-17 21:57:13,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=2, lr=[5.4000000000000005e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:57:13,719] [INFO] [timer.py:258:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=4.4460923215460975, CurrSamplesPerSec=4.443216310104274, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:57:22,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=2, lr=[5.9e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:57:22,888] [INFO] [timer.py:258:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=4.4446740725069525, CurrSamplesPerSec=4.4072837852818525, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:57:32,065] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=2, lr=[6.4e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:57:32,065] [INFO] [timer.py:258:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=4.444035912396254, CurrSamplesPerSec=4.434822144166739, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:57:41,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=2, lr=[6.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:57:41,228] [INFO] [timer.py:258:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=4.442969467357143, CurrSamplesPerSec=4.444819588004414, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:57:50,387] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=2, lr=[7.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:57:50,388] [INFO] [timer.py:258:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=4.442101269275799, CurrSamplesPerSec=4.414119422533162, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:57:50,389] [INFO] [RANK 0]  iteration      150/   10000 | elapsed time per iteration (ms): 916.7 | learning rate 7.450E-05 | total loss 3.224336E+00 | loss 3.224336E+00 | loss scale 32768.0 |speed 261.81 samples/(min*GPU)
[2024-06-17 21:57:50,390] [INFO] [RANK 0] time (ms) | forward: 357.48 | backward: 553.74 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 13.77 | data loader: 0.10
[2024-06-17 21:57:59,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=2, lr=[7.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:57:59,573] [INFO] [timer.py:258:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=4.441403351831512, CurrSamplesPerSec=4.424868405575099, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:58:08,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=2, lr=[8.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:58:08,752] [INFO] [timer.py:258:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=4.441143747600686, CurrSamplesPerSec=4.432077184831116, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:58:17,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=2, lr=[8.9e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:58:17,908] [INFO] [timer.py:258:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=4.440561513084354, CurrSamplesPerSec=4.443335162518513, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:58:27,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=2, lr=[9.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:58:27,055] [INFO] [timer.py:258:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=4.440211554209212, CurrSamplesPerSec=4.436404118237361, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:58:36,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=2, lr=[9.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:58:36,234] [INFO] [timer.py:258:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=4.439795133936271, CurrSamplesPerSec=4.439894546915349, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:58:36,236] [INFO] [RANK 0]  iteration      200/   10000 | elapsed time per iteration (ms): 916.9 | learning rate 9.950E-05 | total loss 3.222461E+00 | loss 3.222461E+00 | loss scale 32768.0 |speed 261.74 samples/(min*GPU)
[2024-06-17 21:58:36,238] [INFO] [RANK 0] time (ms) | forward: 357.93 | backward: 553.57 | allreduce: 0.00 | optimizer: 4.71 | batch generator: 14.05 | data loader: 0.08
[2024-06-17 21:58:45,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=2, lr=[9.999985787777144e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:58:45,411] [INFO] [timer.py:258:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=4.439087593430598, CurrSamplesPerSec=4.416048128698363, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:58:54,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=2, lr=[9.999928050775647e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:58:54,576] [INFO] [timer.py:258:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=4.438778458636753, CurrSamplesPerSec=4.439889847055081, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:59:03,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=2, lr=[9.999825901300984e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:59:03,742] [INFO] [timer.py:258:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=4.438562030129301, CurrSamplesPerSec=4.434857312939825, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:59:12,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=2, lr=[9.999679340361326e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:59:12,876] [INFO] [timer.py:258:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=4.438355464996289, CurrSamplesPerSec=4.439396417093083, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:59:22,013] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=2, lr=[9.999488369403173e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:59:22,013] [INFO] [timer.py:258:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=4.438198804047727, CurrSamplesPerSec=4.4176679163526655, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:59:22,014] [INFO] [RANK 0]  iteration      250/   10000 | elapsed time per iteration (ms): 915.6 | learning rate 9.999E-05 | total loss 3.066426E+00 | loss 3.066426E+00 | loss scale 32768.0 |speed 262.13 samples/(min*GPU)
[2024-06-17 21:59:22,016] [INFO] [RANK 0] time (ms) | forward: 356.25 | backward: 553.85 | allreduce: 0.00 | optimizer: 4.69 | batch generator: 12.46 | data loader: 0.09
[2024-06-17 21:59:31,164] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=2, lr=[9.999252990311333e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:59:31,164] [INFO] [timer.py:258:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=4.437929925699676, CurrSamplesPerSec=4.435121096518487, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:59:40,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=2, lr=[9.998973205408901e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:59:40,326] [INFO] [timer.py:258:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=4.4377873773004355, CurrSamplesPerSec=4.428978987897483, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:59:49,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=2, lr=[9.998649017457239e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:59:49,471] [INFO] [timer.py:258:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=4.437448913332196, CurrSamplesPerSec=4.43382709909028, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 21:59:58,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=2, lr=[9.998280429655952e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:59:58,655] [INFO] [timer.py:258:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=4.4371828030667695, CurrSamplesPerSec=4.438145711201247, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:00:07,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=2, lr=[9.997867445642854e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:00:07,848] [INFO] [timer.py:258:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=4.436988885217684, CurrSamplesPerSec=4.429757809403787, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:00:07,849] [INFO] [RANK 0]  iteration      300/   10000 | elapsed time per iteration (ms): 916.7 | learning rate 9.998E-05 | total loss 3.167813E+00 | loss 3.167813E+00 | loss scale 32768.0 |speed 261.81 samples/(min*GPU)
[2024-06-17 22:00:07,850] [INFO] [RANK 0] time (ms) | forward: 357.33 | backward: 553.93 | allreduce: 0.00 | optimizer: 4.68 | batch generator: 13.46 | data loader: 0.10
[2024-06-17 22:00:07,851] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:00:07,867] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/300/mp_rank_00_model_states.pt
[2024-06-17 22:00:07,867] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/300/mp_rank_00_model_states.pt...
[2024-06-17 22:00:26,114] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/300/mp_rank_00_model_states.pt.
[2024-06-17 22:00:35,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=2, lr=[9.99741006949393e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:00:35,222] [INFO] [timer.py:258:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=4.43817389217301, CurrSamplesPerSec=4.48294035631128, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:00:44,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=2, lr=[9.9969083057233e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:00:44,311] [INFO] [timer.py:258:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=4.439060957702454, CurrSamplesPerSec=4.463261238018291, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:00:53,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=2, lr=[9.996362159283164e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:00:53,438] [INFO] [timer.py:258:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=4.439626129910459, CurrSamplesPerSec=4.453935006358131, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:01:02,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=2, lr=[9.995771635563776e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:01:02,553] [INFO] [timer.py:258:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=4.4401189629183815, CurrSamplesPerSec=4.448197080936419, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:01:11,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=2, lr=[9.995136740393356e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:01:11,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=4.44027662954297, CurrSamplesPerSec=4.448361018679323, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:01:11,686] [INFO] [RANK 0]  iteration      350/   10000 | elapsed time per iteration (ms): 1276.7 | learning rate 9.995E-05 | total loss 3.155625E+00 | loss 3.155625E+00 | loss scale 32768.0 |speed 187.98 samples/(min*GPU)
[2024-06-17 22:01:11,686] [INFO] [RANK 0] time (ms) | forward: 355.63 | backward: 549.95 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 13.70 | data loader: 0.10
[2024-06-17 22:01:20,804] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=2, lr=[9.994457480038073e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:01:20,804] [INFO] [timer.py:258:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=4.440463024414988, CurrSamplesPerSec=4.449637551624891, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:01:29,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=2, lr=[9.993733861201945e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:01:29,962] [INFO] [timer.py:258:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=4.4404143707196395, CurrSamplesPerSec=4.438243158733467, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:01:39,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=2, lr=[9.992965891026802e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:01:39,109] [INFO] [timer.py:258:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=4.440498953521682, CurrSamplesPerSec=4.428006430384437, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:01:48,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=2, lr=[9.992153577092197e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:01:48,246] [INFO] [timer.py:258:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=4.440557017863392, CurrSamplesPerSec=4.45067040394016, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:01:57,398] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=2, lr=[9.991296927415344e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:01:57,399] [INFO] [timer.py:258:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=4.4404960989757205, CurrSamplesPerSec=4.381223420715553, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:01:57,401] [INFO] [RANK 0]  iteration      400/   10000 | elapsed time per iteration (ms): 914.3 | learning rate 9.991E-05 | total loss 3.034961E+00 | loss 3.034961E+00 | loss scale 32768.0 |speed 262.50 samples/(min*GPU)
[2024-06-17 22:01:57,401] [INFO] [RANK 0] time (ms) | forward: 356.65 | backward: 552.04 | allreduce: 0.00 | optimizer: 4.84 | batch generator: 13.18 | data loader: 0.09
[2024-06-17 22:02:00,147] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:02:01,062] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:02:06,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=4, lr=[9.990579691606356e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:02:06,547] [INFO] [timer.py:258:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=4.440411543328948, CurrSamplesPerSec=4.413289203640016, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:02:15,722] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=4, lr=[9.98964325919351e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:02:15,723] [INFO] [timer.py:258:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=4.440346389928085, CurrSamplesPerSec=4.438726937542728, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:02:24,882] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=4, lr=[9.98866251581424e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:02:24,882] [INFO] [timer.py:258:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=4.440228806069709, CurrSamplesPerSec=4.4459621288509465, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:02:34,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=4, lr=[9.987637471148084e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:02:34,046] [INFO] [timer.py:258:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=4.4399808925229465, CurrSamplesPerSec=4.422187036835445, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:02:43,195] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=4, lr=[9.986568135311822e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:02:43,196] [INFO] [timer.py:258:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=4.439862702409499, CurrSamplesPerSec=4.440465653994859, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:02:43,197] [INFO] [RANK 0]  iteration      450/   10000 | elapsed time per iteration (ms): 915.9 | learning rate 9.986E-05 | total loss 3.098984E+00 | loss 3.098984E+00 | loss scale 32768.0 |speed 262.03 samples/(min*GPU)
[2024-06-17 22:02:43,198] [INFO] [RANK 0] time (ms) | forward: 357.03 | backward: 553.34 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 13.42 | data loader: 0.09
[2024-06-17 22:02:52,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=4, lr=[9.985454518859362e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:02:52,350] [INFO] [timer.py:258:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=4.439745813477105, CurrSamplesPerSec=4.430734646858331, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:03:01,519] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=4, lr=[9.984296632781656e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:03:01,520] [INFO] [timer.py:258:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=4.439572837839306, CurrSamplesPerSec=4.42889714568553, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:03:10,663] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=4, lr=[9.983094488506567e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:03:10,663] [INFO] [timer.py:258:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=4.439446612853477, CurrSamplesPerSec=4.433270584305838, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:03:19,842] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=4, lr=[9.981848097898774e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:03:19,842] [INFO] [timer.py:258:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=4.439183834974735, CurrSamplesPerSec=4.408317916111923, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:03:28,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=4, lr=[9.98055747325965e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:03:28,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=4.439089173407786, CurrSamplesPerSec=4.436080360846971, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:03:28,998] [INFO] [RANK 0]  iteration      500/   10000 | elapsed time per iteration (ms): 916.0 | learning rate 9.980E-05 | total loss 3.152617E+00 | loss 3.152617E+00 | loss scale 32768.0 |speed 262.00 samples/(min*GPU)
[2024-06-17 22:03:28,999] [INFO] [RANK 0] time (ms) | forward: 356.55 | backward: 553.90 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 12.90 | data loader: 0.10
[2024-06-17 22:03:38,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=4, lr=[9.979222627327138e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:03:38,170] [INFO] [timer.py:258:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=4.438964170910519, CurrSamplesPerSec=4.417703976830327, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:03:47,340] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=4, lr=[9.977843573275632e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:03:47,340] [INFO] [timer.py:258:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=4.438785122961388, CurrSamplesPerSec=4.438570754700758, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:03:56,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=4, lr=[9.976420324715835e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:03:56,503] [INFO] [timer.py:258:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=4.438642010202184, CurrSamplesPerSec=4.425566397677009, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:04:05,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=4, lr=[9.97495289569464e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:04:05,679] [INFO] [timer.py:258:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=4.438499068898113, CurrSamplesPerSec=4.435328628320175, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:04:14,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=4, lr=[9.973441300694973e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:04:14,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=4.438297773986162, CurrSamplesPerSec=4.431636995570005, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:04:14,835] [INFO] [RANK 0]  iteration      550/   10000 | elapsed time per iteration (ms): 916.7 | learning rate 9.973E-05 | total loss 2.994961E+00 | loss 2.994961E+00 | loss scale 32768.0 |speed 261.80 samples/(min*GPU)
[2024-06-17 22:04:14,836] [INFO] [RANK 0] time (ms) | forward: 357.43 | backward: 553.78 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 13.35 | data loader: 0.10
[2024-06-17 22:04:24,025] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=4, lr=[9.971885554635668e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:04:24,026] [INFO] [timer.py:258:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=4.43807211394536, CurrSamplesPerSec=4.4242978030692, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:04:33,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=4, lr=[9.970285672871313e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:04:33,193] [INFO] [timer.py:258:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=4.437990555135554, CurrSamplesPerSec=4.43480690453829, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:04:42,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=4, lr=[9.968641671192096e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:04:42,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=4.437870295866845, CurrSamplesPerSec=4.431449707510124, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:04:51,548] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=4, lr=[9.966953565823649e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:04:51,548] [INFO] [timer.py:258:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=4.437822410286468, CurrSamplesPerSec=4.4323605443884215, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:05:00,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=4, lr=[9.965221373426886e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:05:00,695] [INFO] [timer.py:258:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=4.437763874499535, CurrSamplesPerSec=4.425219708525343, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:05:00,696] [INFO] [RANK 0]  iteration      600/   10000 | elapsed time per iteration (ms): 917.2 | learning rate 9.965E-05 | total loss 3.081680E+00 | loss 3.081680E+00 | loss scale 32768.0 |speed 261.66 samples/(min*GPU)
[2024-06-17 22:05:00,697] [INFO] [RANK 0] time (ms) | forward: 358.02 | backward: 553.61 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 14.08 | data loader: 0.10
[2024-06-17 22:05:00,697] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:05:00,709] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/600/mp_rank_00_model_states.pt
[2024-06-17 22:05:00,710] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/600/mp_rank_00_model_states.pt...
[2024-06-17 22:05:18,938] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/600/mp_rank_00_model_states.pt.
[2024-06-17 22:05:28,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=4, lr=[9.963445111097852e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:05:28,050] [INFO] [timer.py:258:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=4.438286144836539, CurrSamplesPerSec=4.470713698136245, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:05:37,161] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=4, lr=[9.961624796367537e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:05:37,162] [INFO] [timer.py:258:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=4.43866155314307, CurrSamplesPerSec=4.455439539106821, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:05:46,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=4, lr=[9.959760447201712e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:05:46,283] [INFO] [timer.py:258:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=4.4389592500268655, CurrSamplesPerSec=4.450023487185227, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:05:55,402] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=4, lr=[9.957852082000752e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:05:55,403] [INFO] [timer.py:258:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=4.4391007376102225, CurrSamplesPerSec=4.452240076597605, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:06:04,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=4, lr=[9.955899719599449e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:06:04,538] [INFO] [timer.py:258:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=4.439187578196624, CurrSamplesPerSec=4.4496882977383185, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:06:04,540] [INFO] [RANK 0]  iteration      650/   10000 | elapsed time per iteration (ms): 1276.9 | learning rate 9.956E-05 | total loss 3.059648E+00 | loss 3.059648E+00 | loss scale 32768.0 |speed 187.96 samples/(min*GPU)
[2024-06-17 22:06:04,541] [INFO] [RANK 0] time (ms) | forward: 355.95 | backward: 550.30 | allreduce: 0.00 | optimizer: 4.76 | batch generator: 13.58 | data loader: 0.10
[2024-06-17 22:06:13,671] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=4, lr=[9.953903379266834e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:06:13,671] [INFO] [timer.py:258:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=4.439330791816383, CurrSamplesPerSec=4.447117045118691, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:06:22,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=4, lr=[9.951863080705979e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:06:22,828] [INFO] [timer.py:258:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=4.43924665634672, CurrSamplesPerSec=4.42056626363805, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:06:31,988] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=4, lr=[9.949778844053809e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:06:31,989] [INFO] [timer.py:258:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=4.439220828511884, CurrSamplesPerSec=4.447306838749627, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:06:41,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=4, lr=[9.947650689880895e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:06:41,139] [INFO] [timer.py:258:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=4.439290498318974, CurrSamplesPerSec=4.444031930290759, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:06:50,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=4, lr=[9.945478639191261e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:06:50,277] [INFO] [timer.py:258:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=4.439361366463442, CurrSamplesPerSec=4.438108142211269, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:06:50,278] [INFO] [RANK 0]  iteration      700/   10000 | elapsed time per iteration (ms): 914.8 | learning rate 9.945E-05 | total loss 3.082520E+00 | loss 3.082520E+00 | loss scale 32768.0 |speed 262.36 samples/(min*GPU)
[2024-06-17 22:06:50,279] [INFO] [RANK 0] time (ms) | forward: 357.34 | backward: 551.76 | allreduce: 0.00 | optimizer: 4.90 | batch generator: 13.64 | data loader: 0.09
[2024-06-17 22:06:59,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=4, lr=[9.943262713422169e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:06:59,454] [INFO] [timer.py:258:stop] epoch=0/micro_step=710/global_step=710, RunningAvgSamplesPerSec=4.439297226618913, CurrSamplesPerSec=4.444249715036056, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:07:08,630] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=4, lr=[9.941002934443916e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:07:08,630] [INFO] [timer.py:258:stop] epoch=0/micro_step=720/global_step=720, RunningAvgSamplesPerSec=4.439240259117518, CurrSamplesPerSec=4.423849825719384, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:07:17,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=4, lr=[9.938699324559604e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:07:17,808] [INFO] [timer.py:258:stop] epoch=0/micro_step=730/global_step=730, RunningAvgSamplesPerSec=4.4391464550838595, CurrSamplesPerSec=4.41580288038137, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:07:26,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=4, lr=[9.936351906504936e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:07:26,975] [INFO] [timer.py:258:stop] epoch=0/micro_step=740/global_step=740, RunningAvgSamplesPerSec=4.439112518526202, CurrSamplesPerSec=4.432554935945822, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:07:36,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=4, lr=[9.933960703447975e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:07:36,141] [INFO] [timer.py:258:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=4.439086626585949, CurrSamplesPerSec=4.433781401032571, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:07:36,142] [INFO] [RANK 0]  iteration      750/   10000 | elapsed time per iteration (ms): 917.3 | learning rate 9.934E-05 | total loss 3.040313E+00 | loss 3.040313E+00 | loss scale 32768.0 |speed 261.64 samples/(min*GPU)
[2024-06-17 22:07:36,143] [INFO] [RANK 0] time (ms) | forward: 358.08 | backward: 553.51 | allreduce: 0.00 | optimizer: 4.97 | batch generator: 14.64 | data loader: 0.09
[2024-06-17 22:07:45,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=4, lr=[9.931525738988936e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:07:45,315] [INFO] [timer.py:258:stop] epoch=0/micro_step=760/global_step=760, RunningAvgSamplesPerSec=4.439036736159882, CurrSamplesPerSec=4.437044734049179, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:07:54,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=4, lr=[9.929047037159932e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:07:54,478] [INFO] [timer.py:258:stop] epoch=0/micro_step=770/global_step=770, RunningAvgSamplesPerSec=4.4389600747654585, CurrSamplesPerSec=4.411232999605079, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:08:03,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=4, lr=[9.92652462242475e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:08:03,643] [INFO] [timer.py:258:stop] epoch=0/micro_step=780/global_step=780, RunningAvgSamplesPerSec=4.438879997549832, CurrSamplesPerSec=4.435187926673491, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:08:12,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=4, lr=[9.923958519678604e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:08:12,813] [INFO] [timer.py:258:stop] epoch=0/micro_step=790/global_step=790, RunningAvgSamplesPerSec=4.438830835531678, CurrSamplesPerSec=4.425009620322341, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:08:21,993] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=4, lr=[9.921348754247894e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:08:21,993] [INFO] [timer.py:258:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=4.4387215028768825, CurrSamplesPerSec=4.425694814852332, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:08:21,995] [INFO] [RANK 0]  iteration      800/   10000 | elapsed time per iteration (ms): 917.1 | learning rate 9.921E-05 | total loss 2.962070E+00 | loss 2.962070E+00 | loss scale 32768.0 |speed 261.71 samples/(min*GPU)
[2024-06-17 22:08:21,995] [INFO] [RANK 0] time (ms) | forward: 357.76 | backward: 553.83 | allreduce: 0.00 | optimizer: 4.71 | batch generator: 14.21 | data loader: 0.09
[2024-06-17 22:08:26,573] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:08:27,489] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:08:31,158] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=6, lr=[9.91922952206489e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:08:31,159] [INFO] [timer.py:258:stop] epoch=0/micro_step=810/global_step=810, RunningAvgSamplesPerSec=4.43865973763544, CurrSamplesPerSec=4.434938203234764, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:08:40,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=6, lr=[9.916541228999864e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:08:40,309] [INFO] [timer.py:258:stop] epoch=0/micro_step=820/global_step=820, RunningAvgSamplesPerSec=4.438606868691165, CurrSamplesPerSec=4.429439699064938, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:08:49,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=6, lr=[9.913809346455937e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:08:49,466] [INFO] [timer.py:258:stop] epoch=0/micro_step=830/global_step=830, RunningAvgSamplesPerSec=4.438498510168346, CurrSamplesPerSec=4.437525904190138, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:08:58,616] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=6, lr=[9.911033901395686e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:08:58,617] [INFO] [timer.py:258:stop] epoch=0/micro_step=840/global_step=840, RunningAvgSamplesPerSec=4.4384611639397225, CurrSamplesPerSec=4.4364897576238045, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:09:07,785] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=6, lr=[9.908214921211635e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:09:07,786] [INFO] [timer.py:258:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=4.438333110159139, CurrSamplesPerSec=4.405120975820065, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:09:07,788] [INFO] [RANK 0]  iteration      850/   10000 | elapsed time per iteration (ms): 915.9 | learning rate 9.908E-05 | total loss 3.018750E+00 | loss 3.018750E+00 | loss scale 32768.0 |speed 262.05 samples/(min*GPU)
[2024-06-17 22:09:07,789] [INFO] [RANK 0] time (ms) | forward: 356.56 | backward: 553.77 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 12.78 | data loader: 0.11
[2024-06-17 22:09:16,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=6, lr=[9.90535243372598e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:09:16,969] [INFO] [timer.py:258:stop] epoch=0/micro_step=860/global_step=860, RunningAvgSamplesPerSec=4.438163480613655, CurrSamplesPerSec=4.440140128457261, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:09:26,120] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=6, lr=[9.902446467190317e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:09:26,121] [INFO] [timer.py:258:stop] epoch=0/micro_step=870/global_step=870, RunningAvgSamplesPerSec=4.438104586337154, CurrSamplesPerSec=4.445397852288673, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:09:35,301] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=6, lr=[9.899497050285361e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:09:35,302] [INFO] [timer.py:258:stop] epoch=0/micro_step=880/global_step=880, RunningAvgSamplesPerSec=4.438017815301949, CurrSamplesPerSec=4.422420171691129, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:09:44,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=6, lr=[9.896504212120668e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:09:44,472] [INFO] [timer.py:258:stop] epoch=0/micro_step=890/global_step=890, RunningAvgSamplesPerSec=4.437946855039344, CurrSamplesPerSec=4.430801344884203, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:09:53,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=6, lr=[9.893467982234342e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:09:53,629] [INFO] [timer.py:258:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=4.437905346541317, CurrSamplesPerSec=4.436474506532193, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:09:53,630] [INFO] [RANK 0]  iteration      900/   10000 | elapsed time per iteration (ms): 916.8 | learning rate 9.893E-05 | total loss 2.998438E+00 | loss 2.998438E+00 | loss scale 32768.0 |speed 261.77 samples/(min*GPU)
[2024-06-17 22:09:53,631] [INFO] [RANK 0] time (ms) | forward: 357.70 | backward: 553.51 | allreduce: 0.00 | optimizer: 4.85 | batch generator: 13.37 | data loader: 0.09
[2024-06-17 22:09:53,632] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:09:53,644] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/900/mp_rank_00_model_states.pt
[2024-06-17 22:09:53,644] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/900/mp_rank_00_model_states.pt...
[2024-06-17 22:10:16,404] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/900/mp_rank_00_model_states.pt.
[2024-06-17 22:10:25,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=6, lr=[9.890388390592748e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:10:25,525] [INFO] [timer.py:258:stop] epoch=0/micro_step=910/global_step=910, RunningAvgSamplesPerSec=4.438291418594949, CurrSamplesPerSec=4.486409645616441, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:10:34,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=6, lr=[9.887265467590208e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:10:34,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=920/global_step=920, RunningAvgSamplesPerSec=4.438626866893725, CurrSamplesPerSec=4.441073351017632, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:10:43,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=6, lr=[9.884099244048715e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:10:43,711] [INFO] [timer.py:258:stop] epoch=0/micro_step=930/global_step=930, RunningAvgSamplesPerSec=4.4388734549969096, CurrSamplesPerSec=4.454787686707952, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:10:52,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=6, lr=[9.880889751217614e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:10:52,833] [INFO] [timer.py:258:stop] epoch=0/micro_step=940/global_step=940, RunningAvgSamplesPerSec=4.438977743956071, CurrSamplesPerSec=4.4503303950443, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:11:01,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=6, lr=[9.877637020773307e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:11:01,990] [INFO] [timer.py:258:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=4.4390343172689795, CurrSamplesPerSec=4.452920730166617, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:11:01,991] [INFO] [RANK 0]  iteration      950/   10000 | elapsed time per iteration (ms): 1367.2 | learning rate 9.877E-05 | total loss 3.015352E+00 | loss 3.015352E+00 | loss scale 32768.0 |speed 175.54 samples/(min*GPU)
[2024-06-17 22:11:01,992] [INFO] [RANK 0] time (ms) | forward: 356.28 | backward: 549.50 | allreduce: 0.00 | optimizer: 4.87 | batch generator: 13.78 | data loader: 0.10
[2024-06-17 22:11:11,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=6, lr=[9.874341084818929e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:11:11,128] [INFO] [timer.py:258:stop] epoch=0/micro_step=960/global_step=960, RunningAvgSamplesPerSec=4.439098441511598, CurrSamplesPerSec=4.413314744179929, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:11:20,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=6, lr=[9.871001975884035e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:11:20,275] [INFO] [timer.py:258:stop] epoch=0/micro_step=970/global_step=970, RunningAvgSamplesPerSec=4.439178092105879, CurrSamplesPerSec=4.445336603326448, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:11:29,445] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=6, lr=[9.867619726924284e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:11:29,445] [INFO] [timer.py:258:stop] epoch=0/micro_step=980/global_step=980, RunningAvgSamplesPerSec=4.439204323081636, CurrSamplesPerSec=4.443624671241693, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:11:38,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=6, lr=[9.86419437132111e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:11:38,602] [INFO] [timer.py:258:stop] epoch=0/micro_step=990/global_step=990, RunningAvgSamplesPerSec=4.439208674729688, CurrSamplesPerSec=4.438940679244165, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:11:47,716] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=6, lr=[9.860725942881385e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:11:47,716] [INFO] [timer.py:258:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=4.439253938941428, CurrSamplesPerSec=4.448465992356808, MemAllocated=14.61GB, MaxMemAllocated=17.36GB
[2024-06-17 22:11:47,717] [INFO] [RANK 0]  iteration     1000/   10000 | elapsed time per iteration (ms): 914.5 | learning rate 9.860E-05 | total loss 2.822012E+00 | loss 2.822012E+00 | loss scale 32768.0 |speed 262.43 samples/(min*GPU)
[2024-06-17 22:11:47,718] [INFO] [RANK 0] time (ms) | forward: 357.27 | backward: 551.69 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 13.71 | data loader: 0.10
[2024-06-17 22:11:55,167] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 22:11:55,168] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 22:11:55,168] [INFO] [RANK 0]  validation loss at iteration 1000 | loss: 2.731055E+00 | PPL: 1.534907E+01 loss 2.730469E+00 |
[2024-06-17 22:11:55,168] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 22:12:04,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=6, lr=[9.857214475837101e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:12:04,315] [INFO] [timer.py:258:stop] epoch=0/micro_step=1010/global_step=1010, RunningAvgSamplesPerSec=4.439278157517587, CurrSamplesPerSec=4.44954314333089, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:12:13,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=6, lr=[9.853660004845018e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:12:13,452] [INFO] [timer.py:258:stop] epoch=0/micro_step=1020/global_step=1020, RunningAvgSamplesPerSec=4.439317973034531, CurrSamplesPerSec=4.450488587165133, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:12:22,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=6, lr=[9.850062564986333e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:12:22,608] [INFO] [timer.py:258:stop] epoch=0/micro_step=1030/global_step=1030, RunningAvgSamplesPerSec=4.439362032166557, CurrSamplesPerSec=4.441284967355903, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:12:31,752] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=6, lr=[9.846422191766323e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:12:31,753] [INFO] [timer.py:258:stop] epoch=0/micro_step=1040/global_step=1040, RunningAvgSamplesPerSec=4.439309150169315, CurrSamplesPerSec=4.4180576333557084, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:12:40,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=6, lr=[9.842738921114001e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:12:40,927] [INFO] [timer.py:258:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=4.439212050232989, CurrSamplesPerSec=4.439558531982298, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:12:40,928] [INFO] [RANK 0]  iteration     1050/   10000 | elapsed time per iteration (ms): 1064.2 | learning rate 9.842E-05 | total loss 2.778320E+00 | loss 2.778320E+00 | loss scale 32768.0 |speed 225.52 samples/(min*GPU)
[2024-06-17 22:12:40,929] [INFO] [RANK 0] time (ms) | forward: 357.07 | backward: 552.48 | allreduce: 0.00 | optimizer: 4.90 | batch generator: 16.29 | data loader: 0.13
[2024-06-17 22:12:50,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=6, lr=[9.83901278938176e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:12:50,087] [INFO] [timer.py:258:stop] epoch=0/micro_step=1060/global_step=1060, RunningAvgSamplesPerSec=4.439150495941292, CurrSamplesPerSec=4.4181227867865145, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:12:59,260] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=6, lr=[9.835243833345022e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:12:59,261] [INFO] [timer.py:258:stop] epoch=0/micro_step=1070/global_step=1070, RunningAvgSamplesPerSec=4.439089102930612, CurrSamplesPerSec=4.421682384077616, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:13:08,424] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=6, lr=[9.831432090201855e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:13:08,424] [INFO] [timer.py:258:stop] epoch=0/micro_step=1080/global_step=1080, RunningAvgSamplesPerSec=4.439016068315152, CurrSamplesPerSec=4.432175536935685, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:13:17,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=6, lr=[9.827577597572628e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:13:17,605] [INFO] [timer.py:258:stop] epoch=0/micro_step=1090/global_step=1090, RunningAvgSamplesPerSec=4.438922721282258, CurrSamplesPerSec=4.4306621004083855, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:13:26,779] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=6, lr=[9.823680393499628e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:13:26,780] [INFO] [timer.py:258:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=4.438881185757963, CurrSamplesPerSec=4.429739095766099, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:13:26,782] [INFO] [RANK 0]  iteration     1100/   10000 | elapsed time per iteration (ms): 917.1 | learning rate 9.823E-05 | total loss 2.869980E+00 | loss 2.869980E+00 | loss scale 32768.0 |speed 261.70 samples/(min*GPU)
[2024-06-17 22:13:26,782] [INFO] [RANK 0] time (ms) | forward: 357.93 | backward: 553.46 | allreduce: 0.00 | optimizer: 4.89 | batch generator: 13.94 | data loader: 0.09
[2024-06-17 22:13:35,949] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=6, lr=[9.819740516446685e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:13:35,950] [INFO] [timer.py:258:stop] epoch=0/micro_step=1110/global_step=1110, RunningAvgSamplesPerSec=4.438788780354391, CurrSamplesPerSec=4.433277613095084, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:13:45,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=6, lr=[9.815758005298792e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:13:45,097] [INFO] [timer.py:258:stop] epoch=0/micro_step=1120/global_step=1120, RunningAvgSamplesPerSec=4.438717480801984, CurrSamplesPerSec=4.433581043745143, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:13:54,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=6, lr=[9.81173289936173e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:13:54,244] [INFO] [timer.py:258:stop] epoch=0/micro_step=1130/global_step=1130, RunningAvgSamplesPerSec=4.438660459799613, CurrSamplesPerSec=4.436334905258749, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:14:03,387] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=6, lr=[9.807665238361669e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:14:03,388] [INFO] [timer.py:258:stop] epoch=0/micro_step=1140/global_step=1140, RunningAvgSamplesPerSec=4.438599636873495, CurrSamplesPerSec=4.422140412813894, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:14:12,553] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=6, lr=[9.803555062444779e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:14:12,554] [INFO] [timer.py:258:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=4.438501891424034, CurrSamplesPerSec=4.437959046553398, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:14:12,555] [INFO] [RANK 0]  iteration     1150/   10000 | elapsed time per iteration (ms): 915.5 | learning rate 9.803E-05 | total loss 2.817031E+00 | loss 2.817031E+00 | loss scale 32768.0 |speed 262.16 samples/(min*GPU)
[2024-06-17 22:14:12,556] [INFO] [RANK 0] time (ms) | forward: 356.04 | backward: 553.76 | allreduce: 0.00 | optimizer: 4.87 | batch generator: 11.85 | data loader: 0.08
[2024-06-17 22:14:21,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=6, lr=[9.799402412176838e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:14:21,705] [INFO] [timer.py:258:stop] epoch=0/micro_step=1160/global_step=1160, RunningAvgSamplesPerSec=4.4384747215116835, CurrSamplesPerSec=4.438257247887377, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:14:30,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=6, lr=[9.795207328542828e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:14:30,878] [INFO] [timer.py:258:stop] epoch=0/micro_step=1170/global_step=1170, RunningAvgSamplesPerSec=4.438471907451514, CurrSamplesPerSec=4.438886654672452, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:14:40,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=6, lr=[9.790969852946531e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:14:40,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=1180/global_step=1180, RunningAvgSamplesPerSec=4.438421121603829, CurrSamplesPerSec=4.434919445802134, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:14:49,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=6, lr=[9.78669002721012e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:14:49,204] [INFO] [timer.py:258:stop] epoch=0/micro_step=1190/global_step=1190, RunningAvgSamplesPerSec=4.438380587147723, CurrSamplesPerSec=4.441842320201955, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:14:58,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=6, lr=[9.782367893573747e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:14:58,366] [INFO] [timer.py:258:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=4.4383860899790895, CurrSamplesPerSec=4.432140410682966, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:14:58,367] [INFO] [RANK 0]  iteration     1200/   10000 | elapsed time per iteration (ms): 916.2 | learning rate 9.782E-05 | total loss 2.878535E+00 | loss 2.878535E+00 | loss scale 32768.0 |speed 261.94 samples/(min*GPU)
[2024-06-17 22:14:58,368] [INFO] [RANK 0] time (ms) | forward: 357.55 | backward: 553.23 | allreduce: 0.00 | optimizer: 4.73 | batch generator: 13.94 | data loader: 0.09
[2024-06-17 22:14:58,369] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:14:58,382] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/1200/mp_rank_00_model_states.pt
[2024-06-17 22:14:58,382] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/1200/mp_rank_00_model_states.pt...
[2024-06-17 22:15:17,306] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/1200/mp_rank_00_model_states.pt.
[2024-06-17 22:15:23,681] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:15:24,592] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:15:26,414] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=8, lr=[9.77887975362864e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:15:26,415] [INFO] [timer.py:258:stop] epoch=0/micro_step=1210/global_step=1210, RunningAvgSamplesPerSec=4.438665248167487, CurrSamplesPerSec=4.4749457476159895, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:15:35,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=8, lr=[9.77448157355011e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:15:35,527] [INFO] [timer.py:258:stop] epoch=0/micro_step=1220/global_step=1220, RunningAvgSamplesPerSec=4.4388877577525765, CurrSamplesPerSec=4.464279042984996, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:15:44,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=8, lr=[9.770041206064124e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:15:44,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=1230/global_step=1230, RunningAvgSamplesPerSec=4.43905133961278, CurrSamplesPerSec=4.460386102767546, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:15:53,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=8, lr=[9.765558694995321e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:15:53,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=1240/global_step=1240, RunningAvgSamplesPerSec=4.43918162864137, CurrSamplesPerSec=4.44574888851084, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:16:02,858] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=8, lr=[9.761034084584273e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:16:02,859] [INFO] [timer.py:258:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=4.439271489849486, CurrSamplesPerSec=4.458997919763522, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:16:02,861] [INFO] [RANK 0]  iteration     1250/   10000 | elapsed time per iteration (ms): 1289.9 | learning rate 9.761E-05 | total loss 2.768789E+00 | loss 2.768789E+00 | loss scale 32768.0 |speed 186.07 samples/(min*GPU)
[2024-06-17 22:16:02,861] [INFO] [RANK 0] time (ms) | forward: 355.71 | backward: 549.69 | allreduce: 0.00 | optimizer: 4.73 | batch generator: 13.45 | data loader: 0.10
[2024-06-17 22:16:11,983] [INFO] [logging.py:96:log_dist] [Rank 0] step=1260, skipped=8, lr=[9.75646741948706e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:16:11,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=1260/global_step=1260, RunningAvgSamplesPerSec=4.439345435769126, CurrSamplesPerSec=4.446412239150663, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:16:21,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=1270, skipped=8, lr=[9.751858744774823e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:16:21,119] [INFO] [timer.py:258:stop] epoch=0/micro_step=1270/global_step=1270, RunningAvgSamplesPerSec=4.439405777677369, CurrSamplesPerSec=4.446895443243242, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:16:30,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=1280, skipped=8, lr=[9.747208105933319e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:16:30,249] [INFO] [timer.py:258:stop] epoch=0/micro_step=1280/global_step=1280, RunningAvgSamplesPerSec=4.43947638839462, CurrSamplesPerSec=4.442238666704795, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:16:39,384] [INFO] [logging.py:96:log_dist] [Rank 0] step=1290, skipped=8, lr=[9.742515548862475e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:16:39,385] [INFO] [timer.py:258:stop] epoch=0/micro_step=1290/global_step=1290, RunningAvgSamplesPerSec=4.439492609815492, CurrSamplesPerSec=4.446704506149689, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:16:48,529] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=8, lr=[9.73778111987594e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:16:48,530] [INFO] [timer.py:258:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=4.439490321987747, CurrSamplesPerSec=4.437930872121413, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:16:48,532] [INFO] [RANK 0]  iteration     1300/   10000 | elapsed time per iteration (ms): 913.4 | learning rate 9.737E-05 | total loss 2.837188E+00 | loss 2.837188E+00 | loss scale 32768.0 |speed 262.74 samples/(min*GPU)
[2024-06-17 22:16:48,534] [INFO] [RANK 0] time (ms) | forward: 355.51 | backward: 551.72 | allreduce: 0.00 | optimizer: 5.42 | batch generator: 12.31 | data loader: 0.08
[2024-06-17 22:16:57,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=1310, skipped=8, lr=[9.733004865700612e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:16:57,692] [INFO] [timer.py:258:stop] epoch=0/micro_step=1310/global_step=1310, RunningAvgSamplesPerSec=4.439434176740971, CurrSamplesPerSec=4.431124332150712, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:17:06,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=1320, skipped=8, lr=[9.728186833476192e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:17:06,841] [INFO] [timer.py:258:stop] epoch=0/micro_step=1320/global_step=1320, RunningAvgSamplesPerSec=4.43941529619621, CurrSamplesPerSec=4.44396483334618, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:17:16,004] [INFO] [logging.py:96:log_dist] [Rank 0] step=1330, skipped=8, lr=[9.723327070754714e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:17:16,005] [INFO] [timer.py:258:stop] epoch=0/micro_step=1330/global_step=1330, RunningAvgSamplesPerSec=4.439336077293413, CurrSamplesPerSec=4.433445139168007, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:17:25,148] [INFO] [logging.py:96:log_dist] [Rank 0] step=1340, skipped=8, lr=[9.718425625500074e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:17:25,149] [INFO] [timer.py:258:stop] epoch=0/micro_step=1340/global_step=1340, RunningAvgSamplesPerSec=4.439333991917722, CurrSamplesPerSec=4.43859893725801, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:17:34,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=8, lr=[9.713482546087558e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:17:34,299] [INFO] [timer.py:258:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=4.439265021599066, CurrSamplesPerSec=4.431593683799019, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:17:34,300] [INFO] [RANK 0]  iteration     1350/   10000 | elapsed time per iteration (ms): 915.4 | learning rate 9.713E-05 | total loss 2.753086E+00 | loss 2.753086E+00 | loss scale 32768.0 |speed 262.19 samples/(min*GPU)
[2024-06-17 22:17:34,301] [INFO] [RANK 0] time (ms) | forward: 356.61 | backward: 552.97 | allreduce: 0.00 | optimizer: 4.96 | batch generator: 12.35 | data loader: 0.10
[2024-06-17 22:17:43,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=1360, skipped=8, lr=[9.708497881303363e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:17:43,438] [INFO] [timer.py:258:stop] epoch=0/micro_step=1360/global_step=1360, RunningAvgSamplesPerSec=4.439228966861218, CurrSamplesPerSec=4.436272732729445, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:17:52,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=1370, skipped=8, lr=[9.703471680344118e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:17:52,624] [INFO] [timer.py:258:stop] epoch=0/micro_step=1370/global_step=1370, RunningAvgSamplesPerSec=4.439165763154712, CurrSamplesPerSec=4.436481545484523, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:18:01,782] [INFO] [logging.py:96:log_dist] [Rank 0] step=1380, skipped=8, lr=[9.6984039928164e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:18:01,782] [INFO] [timer.py:258:stop] epoch=0/micro_step=1380/global_step=1380, RunningAvgSamplesPerSec=4.439136720697791, CurrSamplesPerSec=4.432810247145079, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:18:10,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=1390, skipped=8, lr=[9.693294868736235e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:18:10,943] [INFO] [timer.py:258:stop] epoch=0/micro_step=1390/global_step=1390, RunningAvgSamplesPerSec=4.439103827081756, CurrSamplesPerSec=4.43305621693978, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:18:20,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=8, lr=[9.68814435852862e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:18:20,095] [INFO] [timer.py:258:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=4.439082158478878, CurrSamplesPerSec=4.437112795683596, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:18:20,096] [INFO] [RANK 0]  iteration     1400/   10000 | elapsed time per iteration (ms): 915.9 | learning rate 9.688E-05 | total loss 2.796836E+00 | loss 2.796836E+00 | loss scale 32768.0 |speed 262.03 samples/(min*GPU)
[2024-06-17 22:18:20,097] [INFO] [RANK 0] time (ms) | forward: 357.05 | backward: 553.28 | allreduce: 0.00 | optimizer: 4.81 | batch generator: 13.20 | data loader: 0.09
[2024-06-17 22:18:29,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=1410, skipped=8, lr=[9.682952513027007e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:18:29,255] [INFO] [timer.py:258:stop] epoch=0/micro_step=1410/global_step=1410, RunningAvgSamplesPerSec=4.439044840908901, CurrSamplesPerSec=4.433849362587853, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:18:38,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=1420, skipped=8, lr=[9.677719383472816e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:18:38,418] [INFO] [timer.py:258:stop] epoch=0/micro_step=1420/global_step=1420, RunningAvgSamplesPerSec=4.438990370786321, CurrSamplesPerSec=4.434189201618351, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:18:47,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=1430, skipped=8, lr=[9.672445021514925e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:18:47,567] [INFO] [timer.py:258:stop] epoch=0/micro_step=1430/global_step=1430, RunningAvgSamplesPerSec=4.438966036407686, CurrSamplesPerSec=4.441466032898246, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:18:56,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=1440, skipped=8, lr=[9.667129479209156e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:18:56,710] [INFO] [timer.py:258:stop] epoch=0/micro_step=1440/global_step=1440, RunningAvgSamplesPerSec=4.438932589522324, CurrSamplesPerSec=4.430326311500453, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:19:05,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=8, lr=[9.661772809017767e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:19:05,876] [INFO] [timer.py:258:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=4.438875160183359, CurrSamplesPerSec=4.43445642198925, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:19:05,877] [INFO] [RANK 0]  iteration     1450/   10000 | elapsed time per iteration (ms): 915.6 | learning rate 9.661E-05 | total loss 2.621055E+00 | loss 2.621055E+00 | loss scale 32768.0 |speed 262.11 samples/(min*GPU)
[2024-06-17 22:19:05,878] [INFO] [RANK 0] time (ms) | forward: 356.56 | backward: 553.55 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 12.76 | data loader: 0.08
[2024-06-17 22:19:15,035] [INFO] [logging.py:96:log_dist] [Rank 0] step=1460, skipped=8, lr=[9.656375063808926e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:19:15,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=1460/global_step=1460, RunningAvgSamplesPerSec=4.43885147271088, CurrSamplesPerSec=4.442393931498463, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:19:24,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=1470, skipped=8, lr=[9.6509362968562e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:19:24,199] [INFO] [timer.py:258:stop] epoch=0/micro_step=1470/global_step=1470, RunningAvgSamplesPerSec=4.438822385001613, CurrSamplesPerSec=4.417522517173401, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:19:33,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=1480, skipped=8, lr=[9.64545656183803e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:19:33,364] [INFO] [timer.py:258:stop] epoch=0/micro_step=1480/global_step=1480, RunningAvgSamplesPerSec=4.4388074120603465, CurrSamplesPerSec=4.4302069841471035, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:19:42,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=1490, skipped=8, lr=[9.639935912837179e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:19:42,534] [INFO] [timer.py:258:stop] epoch=0/micro_step=1490/global_step=1490, RunningAvgSamplesPerSec=4.43878489334021, CurrSamplesPerSec=4.437405015046833, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:19:51,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=8, lr=[9.634374404340228e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:19:51,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=4.438749541120797, CurrSamplesPerSec=4.411596061089972, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:19:51,685] [INFO] [RANK 0]  iteration     1500/   10000 | elapsed time per iteration (ms): 916.2 | learning rate 9.634E-05 | total loss 2.588008E+00 | loss 2.588008E+00 | loss scale 32768.0 |speed 261.96 samples/(min*GPU)
[2024-06-17 22:19:51,686] [INFO] [RANK 0] time (ms) | forward: 357.45 | backward: 553.13 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 13.68 | data loader: 0.09
[2024-06-17 22:19:51,686] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:19:51,699] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/1500/mp_rank_00_model_states.pt
[2024-06-17 22:19:51,699] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/1500/mp_rank_00_model_states.pt...
[2024-06-17 22:20:09,682] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/1500/mp_rank_00_model_states.pt.
[2024-06-17 22:20:18,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=1510, skipped=8, lr=[9.628772091237021e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:20:18,793] [INFO] [timer.py:258:stop] epoch=0/micro_step=1510/global_step=1510, RunningAvgSamplesPerSec=4.438952040708546, CurrSamplesPerSec=4.486054558192018, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:20:27,906] [INFO] [logging.py:96:log_dist] [Rank 0] step=1520, skipped=8, lr=[9.62312902882013e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:20:27,906] [INFO] [timer.py:258:stop] epoch=0/micro_step=1520/global_step=1520, RunningAvgSamplesPerSec=4.4390574329181005, CurrSamplesPerSec=4.446270833427194, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:20:37,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=1530, skipped=8, lr=[9.617445272784296e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:20:37,022] [INFO] [timer.py:258:stop] epoch=0/micro_step=1530/global_step=1530, RunningAvgSamplesPerSec=4.439160170665039, CurrSamplesPerSec=4.45242912616, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:20:46,142] [INFO] [logging.py:96:log_dist] [Rank 0] step=1540, skipped=8, lr=[9.6117208792259e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:20:46,143] [INFO] [timer.py:258:stop] epoch=0/micro_step=1540/global_step=1540, RunningAvgSamplesPerSec=4.439263665912209, CurrSamplesPerSec=4.457383214715738, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:20:55,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=8, lr=[9.605955904642394e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:20:55,266] [INFO] [timer.py:258:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=4.439371503367532, CurrSamplesPerSec=4.462640331832949, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:20:55,267] [INFO] [RANK 0]  iteration     1550/   10000 | elapsed time per iteration (ms): 1271.6 | learning rate 9.605E-05 | total loss 2.777520E+00 | loss 2.777520E+00 | loss scale 32768.0 |speed 188.73 samples/(min*GPU)
[2024-06-17 22:20:55,268] [INFO] [RANK 0] time (ms) | forward: 355.85 | backward: 550.10 | allreduce: 0.00 | optimizer: 4.76 | batch generator: 13.55 | data loader: 0.11
[2024-06-17 22:21:04,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=1560, skipped=8, lr=[9.600150405931751e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:21:04,403] [INFO] [timer.py:258:stop] epoch=0/micro_step=1560/global_step=1560, RunningAvgSamplesPerSec=4.439432356650916, CurrSamplesPerSec=4.4591425065336745, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:21:13,544] [INFO] [logging.py:96:log_dist] [Rank 0] step=1570, skipped=8, lr=[9.594304440391899e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:21:13,544] [INFO] [timer.py:258:stop] epoch=0/micro_step=1570/global_step=1570, RunningAvgSamplesPerSec=4.439511187312991, CurrSamplesPerSec=4.449517181752361, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:21:22,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=1580, skipped=8, lr=[9.588418065720158e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:21:22,665] [INFO] [timer.py:258:stop] epoch=0/micro_step=1580/global_step=1580, RunningAvgSamplesPerSec=4.4395752217839375, CurrSamplesPerSec=4.445426121609734, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:21:31,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=1590, skipped=8, lr=[9.58249134001267e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:21:31,812] [INFO] [timer.py:258:stop] epoch=0/micro_step=1590/global_step=1590, RunningAvgSamplesPerSec=4.439623178840449, CurrSamplesPerSec=4.4469508416416055, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:21:40,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=8, lr=[9.576524321763824e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:21:40,966] [INFO] [timer.py:258:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=4.439629773974652, CurrSamplesPerSec=4.441172102799223, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:21:40,967] [INFO] [RANK 0]  iteration     1600/   10000 | elapsed time per iteration (ms): 914.0 | learning rate 9.576E-05 | total loss 2.646836E+00 | loss 2.646836E+00 | loss scale 32768.0 |speed 262.58 samples/(min*GPU)
[2024-06-17 22:21:40,967] [INFO] [RANK 0] time (ms) | forward: 356.76 | backward: 551.78 | allreduce: 0.00 | optimizer: 4.73 | batch generator: 13.98 | data loader: 0.09
[2024-06-17 22:21:49,194] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:21:50,105] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:21:50,105] [INFO] [logging.py:96:log_dist] [Rank 0] step=1610, skipped=10, lr=[9.571119603883084e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:21:50,113] [INFO] [timer.py:258:stop] epoch=0/micro_step=1610/global_step=1610, RunningAvgSamplesPerSec=4.43960808990594, CurrSamplesPerSec=4.416500340374407, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:21:59,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=1620, skipped=10, lr=[9.565682339948657e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:21:59,287] [INFO] [timer.py:258:stop] epoch=0/micro_step=1620/global_step=1620, RunningAvgSamplesPerSec=4.439587241152008, CurrSamplesPerSec=4.445768915738699, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:22:08,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=1630, skipped=10, lr=[9.559602817156913e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:22:08,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=1630/global_step=1630, RunningAvgSamplesPerSec=4.4395422661285275, CurrSamplesPerSec=4.422203355475256, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:22:17,597] [INFO] [logging.py:96:log_dist] [Rank 0] step=1640, skipped=10, lr=[9.553483227724292e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:22:17,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=1640/global_step=1640, RunningAvgSamplesPerSec=4.439512703512394, CurrSamplesPerSec=4.442771552540254, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:22:26,761] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=10, lr=[9.547323632048671e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:22:26,762] [INFO] [timer.py:258:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=4.439489400891757, CurrSamplesPerSec=4.438265466601801, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:22:26,763] [INFO] [RANK 0]  iteration     1650/   10000 | elapsed time per iteration (ms): 915.9 | learning rate 9.547E-05 | total loss 2.620391E+00 | loss 2.620391E+00 | loss scale 32768.0 |speed 262.03 samples/(min*GPU)
[2024-06-17 22:22:26,764] [INFO] [RANK 0] time (ms) | forward: 357.15 | backward: 553.15 | allreduce: 0.00 | optimizer: 4.89 | batch generator: 13.28 | data loader: 0.09
[2024-06-17 22:22:35,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=1660, skipped=10, lr=[9.54112409092277e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:22:35,930] [INFO] [timer.py:258:stop] epoch=0/micro_step=1660/global_step=1660, RunningAvgSamplesPerSec=4.439455430037166, CurrSamplesPerSec=4.430321631875301, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:22:45,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=1670, skipped=10, lr=[9.534884665533563e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:22:45,062] [INFO] [timer.py:258:stop] epoch=0/micro_step=1670/global_step=1670, RunningAvgSamplesPerSec=4.439447170744737, CurrSamplesPerSec=4.437194941816288, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:22:54,235] [INFO] [logging.py:96:log_dist] [Rank 0] step=1680, skipped=10, lr=[9.528605417461653e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:22:54,235] [INFO] [timer.py:258:stop] epoch=0/micro_step=1680/global_step=1680, RunningAvgSamplesPerSec=4.439352698702296, CurrSamplesPerSec=4.4342747555127735, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:23:03,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=1690, skipped=10, lr=[9.522286408680687e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:23:03,384] [INFO] [timer.py:258:stop] epoch=0/micro_step=1690/global_step=1690, RunningAvgSamplesPerSec=4.4392689794292455, CurrSamplesPerSec=4.431590172070908, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:23:12,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=10, lr=[9.515927701556732e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:23:12,547] [INFO] [timer.py:258:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=4.439168233487734, CurrSamplesPerSec=4.427804257520335, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:23:12,549] [INFO] [RANK 0]  iteration     1700/   10000 | elapsed time per iteration (ms): 915.7 | learning rate 9.515E-05 | total loss 2.600566E+00 | loss 2.600566E+00 | loss scale 32768.0 |speed 262.09 samples/(min*GPU)
[2024-06-17 22:23:12,550] [INFO] [RANK 0] time (ms) | forward: 356.28 | backward: 553.56 | allreduce: 0.00 | optimizer: 5.02 | batch generator: 11.86 | data loader: 0.09
[2024-06-17 22:23:21,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=1710, skipped=10, lr=[9.509529358847655e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:23:21,718] [INFO] [timer.py:258:stop] epoch=0/micro_step=1710/global_step=1710, RunningAvgSamplesPerSec=4.439119256148512, CurrSamplesPerSec=4.438608331523291, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:23:30,889] [INFO] [logging.py:96:log_dist] [Rank 0] step=1720, skipped=10, lr=[9.503091443702522e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:23:30,890] [INFO] [timer.py:258:stop] epoch=0/micro_step=1720/global_step=1720, RunningAvgSamplesPerSec=4.4390530400449135, CurrSamplesPerSec=4.425142673867993, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:23:40,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=1730, skipped=10, lr=[9.496614019660951e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:23:40,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=1730/global_step=1730, RunningAvgSamplesPerSec=4.439017464391596, CurrSamplesPerSec=4.431927323350596, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:23:49,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=1740, skipped=10, lr=[9.490097150652505e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:23:49,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=1740/global_step=1740, RunningAvgSamplesPerSec=4.438966579717824, CurrSamplesPerSec=4.4278708673495375, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:23:58,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=10, lr=[9.48354090099605e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:23:58,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=4.438956189177866, CurrSamplesPerSec=4.4367631218945105, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:23:58,356] [INFO] [RANK 0]  iteration     1750/   10000 | elapsed time per iteration (ms): 916.1 | learning rate 9.483E-05 | total loss 2.574609E+00 | loss 2.574609E+00 | loss scale 32768.0 |speed 261.97 samples/(min*GPU)
[2024-06-17 22:23:58,357] [INFO] [RANK 0] time (ms) | forward: 356.82 | backward: 553.64 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 12.88 | data loader: 0.11
[2024-06-17 22:24:07,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=1760, skipped=10, lr=[9.476945335399122e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:24:07,494] [INFO] [timer.py:258:stop] epoch=0/micro_step=1760/global_step=1760, RunningAvgSamplesPerSec=4.438903498963663, CurrSamplesPerSec=4.4371538683697445, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:24:16,639] [INFO] [logging.py:96:log_dist] [Rank 0] step=1770, skipped=10, lr=[9.470310518957292e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:24:16,640] [INFO] [timer.py:258:stop] epoch=0/micro_step=1770/global_step=1770, RunningAvgSamplesPerSec=4.438853815964203, CurrSamplesPerSec=4.407884749629747, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:24:25,804] [INFO] [logging.py:96:log_dist] [Rank 0] step=1780, skipped=10, lr=[9.463636517153516e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:24:25,805] [INFO] [timer.py:258:stop] epoch=0/micro_step=1780/global_step=1780, RunningAvgSamplesPerSec=4.438798286629748, CurrSamplesPerSec=4.420361275636027, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:24:34,959] [INFO] [logging.py:96:log_dist] [Rank 0] step=1790, skipped=10, lr=[9.456923395857504e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:24:34,960] [INFO] [timer.py:258:stop] epoch=0/micro_step=1790/global_step=1790, RunningAvgSamplesPerSec=4.438743023152895, CurrSamplesPerSec=4.432641597918057, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:24:44,118] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=10, lr=[9.450171221325049e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:24:44,118] [INFO] [timer.py:258:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=4.438735171059656, CurrSamplesPerSec=4.436370098028846, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:24:44,120] [INFO] [RANK 0]  iteration     1800/   10000 | elapsed time per iteration (ms): 915.3 | learning rate 9.449E-05 | total loss 2.516250E+00 | loss 2.516250E+00 | loss scale 32768.0 |speed 262.22 samples/(min*GPU)
[2024-06-17 22:24:44,120] [INFO] [RANK 0] time (ms) | forward: 356.31 | backward: 553.46 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 12.02 | data loader: 0.09
[2024-06-17 22:24:44,121] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:24:44,137] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/1800/mp_rank_00_model_states.pt
[2024-06-17 22:24:44,137] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/1800/mp_rank_00_model_states.pt...
[2024-06-17 22:25:02,548] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/1800/mp_rank_00_model_states.pt.
[2024-06-17 22:25:11,671] [INFO] [logging.py:96:log_dist] [Rank 0] step=1810, skipped=10, lr=[9.443380060197387e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:25:11,671] [INFO] [timer.py:258:stop] epoch=0/micro_step=1810/global_step=1810, RunningAvgSamplesPerSec=4.4388934369029975, CurrSamplesPerSec=4.47383956197096, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:25:20,782] [INFO] [logging.py:96:log_dist] [Rank 0] step=1820, skipped=10, lr=[9.436549979500537e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:25:20,782] [INFO] [timer.py:258:stop] epoch=0/micro_step=1820/global_step=1820, RunningAvgSamplesPerSec=4.438992520244495, CurrSamplesPerSec=4.42797487617824, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:25:29,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=1830, skipped=10, lr=[9.429681046644642e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:25:29,903] [INFO] [timer.py:258:stop] epoch=0/micro_step=1830/global_step=1830, RunningAvgSamplesPerSec=4.439039364473795, CurrSamplesPerSec=4.454392645793392, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:25:39,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=1840, skipped=10, lr=[9.42277332942329e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:25:39,041] [INFO] [timer.py:258:stop] epoch=0/micro_step=1840/global_step=1840, RunningAvgSamplesPerSec=4.439052143423962, CurrSamplesPerSec=4.460380173590221, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:25:48,151] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=10, lr=[9.415826896012865e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:25:48,151] [INFO] [timer.py:258:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=4.439096454658537, CurrSamplesPerSec=4.430916023377357, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:25:48,153] [INFO] [RANK 0]  iteration     1850/   10000 | elapsed time per iteration (ms): 1280.7 | learning rate 9.415E-05 | total loss 2.612891E+00 | loss 2.612891E+00 | loss scale 32768.0 |speed 187.40 samples/(min*GPU)
[2024-06-17 22:25:48,154] [INFO] [RANK 0] time (ms) | forward: 355.80 | backward: 550.26 | allreduce: 0.00 | optimizer: 4.98 | batch generator: 12.78 | data loader: 0.10
[2024-06-17 22:25:57,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=1860, skipped=10, lr=[9.408841814971862e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:25:57,274] [INFO] [timer.py:258:stop] epoch=0/micro_step=1860/global_step=1860, RunningAvgSamplesPerSec=4.439124838402576, CurrSamplesPerSec=4.448019003987444, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:26:06,420] [INFO] [logging.py:96:log_dist] [Rank 0] step=1870, skipped=10, lr=[9.401818155240207e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:26:06,420] [INFO] [timer.py:258:stop] epoch=0/micro_step=1870/global_step=1870, RunningAvgSamplesPerSec=4.439149553344691, CurrSamplesPerSec=4.4487561700937235, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:26:15,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=1880, skipped=10, lr=[9.394755986138586e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:26:15,561] [INFO] [timer.py:258:stop] epoch=0/micro_step=1880/global_step=1880, RunningAvgSamplesPerSec=4.439177156344885, CurrSamplesPerSec=4.44246568631994, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:26:24,716] [INFO] [logging.py:96:log_dist] [Rank 0] step=1890, skipped=10, lr=[9.38765537736776e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:26:24,716] [INFO] [timer.py:258:stop] epoch=0/micro_step=1890/global_step=1890, RunningAvgSamplesPerSec=4.439206028229098, CurrSamplesPerSec=4.441801160672682, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:26:33,867] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=10, lr=[9.380516399007869e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:26:33,868] [INFO] [timer.py:258:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=4.4392357776730735, CurrSamplesPerSec=4.440185957685787, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:26:33,869] [INFO] [RANK 0]  iteration     1900/   10000 | elapsed time per iteration (ms): 914.3 | learning rate 9.380E-05 | total loss 2.461348E+00 | loss 2.461348E+00 | loss scale 32768.0 |speed 262.49 samples/(min*GPU)
[2024-06-17 22:26:33,870] [INFO] [RANK 0] time (ms) | forward: 356.89 | backward: 551.88 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 13.69 | data loader: 0.09
[2024-06-17 22:26:43,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=1910, skipped=10, lr=[9.373339121517747e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:26:43,037] [INFO] [timer.py:258:stop] epoch=0/micro_step=1910/global_step=1910, RunningAvgSamplesPerSec=4.439222791992344, CurrSamplesPerSec=4.438917190138359, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:26:52,178] [INFO] [logging.py:96:log_dist] [Rank 0] step=1920, skipped=10, lr=[9.366123615734227e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:26:52,178] [INFO] [timer.py:258:stop] epoch=0/micro_step=1920/global_step=1920, RunningAvgSamplesPerSec=4.439189900128257, CurrSamplesPerSec=4.436158949783232, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:27:01,336] [INFO] [logging.py:96:log_dist] [Rank 0] step=1930, skipped=10, lr=[9.358869952871436e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:27:01,337] [INFO] [timer.py:258:stop] epoch=0/micro_step=1930/global_step=1930, RunningAvgSamplesPerSec=4.439169558748333, CurrSamplesPerSec=4.435884487110269, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:27:10,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=1940, skipped=10, lr=[9.351578204520099e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:27:10,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=1940/global_step=1940, RunningAvgSamplesPerSec=4.439133526565257, CurrSamplesPerSec=4.434796354087641, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:27:19,667] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=10, lr=[9.344248442646829e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:27:19,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=4.439111114139638, CurrSamplesPerSec=4.432620517666977, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:27:19,671] [INFO] [RANK 0]  iteration     1950/   10000 | elapsed time per iteration (ms): 916.0 | learning rate 9.344E-05 | total loss 2.456172E+00 | loss 2.456172E+00 | loss scale 32768.0 |speed 262.00 samples/(min*GPU)
[2024-06-17 22:27:19,673] [INFO] [RANK 0] time (ms) | forward: 356.97 | backward: 553.28 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 13.19 | data loader: 0.09
[2024-06-17 22:27:28,822] [INFO] [logging.py:96:log_dist] [Rank 0] step=1960, skipped=10, lr=[9.336880739593416e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:27:28,822] [INFO] [timer.py:258:stop] epoch=0/micro_step=1960/global_step=1960, RunningAvgSamplesPerSec=4.439098245026083, CurrSamplesPerSec=4.419860532631518, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:27:37,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=1970, skipped=10, lr=[9.329475168076114e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:27:37,956] [INFO] [timer.py:258:stop] epoch=0/micro_step=1970/global_step=1970, RunningAvgSamplesPerSec=4.43906985825263, CurrSamplesPerSec=4.440853526511637, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:27:47,093] [INFO] [logging.py:96:log_dist] [Rank 0] step=1980, skipped=10, lr=[9.322031801184924e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:27:47,093] [INFO] [timer.py:258:stop] epoch=0/micro_step=1980/global_step=1980, RunningAvgSamplesPerSec=4.439037807792076, CurrSamplesPerSec=4.4313490467188705, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:27:56,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=1990, skipped=10, lr=[9.314550712382876e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:27:56,249] [INFO] [timer.py:258:stop] epoch=0/micro_step=1990/global_step=1990, RunningAvgSamplesPerSec=4.438981684162253, CurrSamplesPerSec=4.437859263716861, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:28:05,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=10, lr=[9.30703197550529e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:28:05,409] [INFO] [timer.py:258:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=4.438969181574051, CurrSamplesPerSec=4.43242963341053, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:28:05,411] [INFO] [RANK 0]  iteration     2000/   10000 | elapsed time per iteration (ms): 914.8 | learning rate 9.306E-05 | total loss 2.438027E+00 | loss 2.438027E+00 | loss scale 32768.0 |speed 262.35 samples/(min*GPU)
[2024-06-17 22:28:05,412] [INFO] [RANK 0] time (ms) | forward: 355.73 | backward: 553.47 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 11.93 | data loader: 0.08
[2024-06-17 22:28:12,071] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 22:28:12,071] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 22:28:12,071] [INFO] [RANK 0]  validation loss at iteration 2000 | loss: 2.377930E+00 | PPL: 1.078256E+01 loss 2.378906E+00 |
[2024-06-17 22:28:12,071] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 22:28:21,218] [INFO] [logging.py:96:log_dist] [Rank 0] step=2010, skipped=10, lr=[9.299475664759069e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:28:21,219] [INFO] [timer.py:258:stop] epoch=0/micro_step=2010/global_step=2010, RunningAvgSamplesPerSec=4.438930314996517, CurrSamplesPerSec=4.4377277920069025, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:28:22,136] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:28:23,044] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:28:30,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=2020, skipped=12, lr=[9.29340361308047e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:28:30,367] [INFO] [timer.py:258:stop] epoch=0/micro_step=2020/global_step=2020, RunningAvgSamplesPerSec=4.438921541656866, CurrSamplesPerSec=4.428203946559232, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:28:39,533] [INFO] [logging.py:96:log_dist] [Rank 0] step=2030, skipped=12, lr=[9.285779857555331e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:28:39,534] [INFO] [timer.py:258:stop] epoch=0/micro_step=2030/global_step=2030, RunningAvgSamplesPerSec=4.438874974075997, CurrSamplesPerSec=4.430221022325629, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:28:48,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=2040, skipped=12, lr=[9.278118737911378e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:28:48,663] [INFO] [timer.py:258:stop] epoch=0/micro_step=2040/global_step=2040, RunningAvgSamplesPerSec=4.438873141243565, CurrSamplesPerSec=4.435257103867536, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:28:57,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=12, lr=[9.270420329760772e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:28:57,815] [INFO] [timer.py:258:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=4.438845809670656, CurrSamplesPerSec=4.432022156391281, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:28:57,818] [INFO] [RANK 0]  iteration     2050/   10000 | elapsed time per iteration (ms): 1048.1 | learning rate 9.270E-05 | total loss 2.434707E+00 | loss 2.434707E+00 | loss scale 32768.0 |speed 228.98 samples/(min*GPU)
[2024-06-17 22:28:57,819] [INFO] [RANK 0] time (ms) | forward: 355.70 | backward: 553.79 | allreduce: 0.00 | optimizer: 4.72 | batch generator: 14.46 | data loader: 0.13
[2024-06-17 22:29:06,956] [INFO] [logging.py:96:log_dist] [Rank 0] step=2060, skipped=12, lr=[9.26268470908369e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:29:06,957] [INFO] [timer.py:258:stop] epoch=0/micro_step=2060/global_step=2060, RunningAvgSamplesPerSec=4.438829880868921, CurrSamplesPerSec=4.433233097806269, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:29:16,106] [INFO] [logging.py:96:log_dist] [Rank 0] step=2070, skipped=12, lr=[9.254911952227588e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:29:16,107] [INFO] [timer.py:258:stop] epoch=0/micro_step=2070/global_step=2070, RunningAvgSamplesPerSec=4.4387839924146135, CurrSamplesPerSec=4.43689101631714, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:29:25,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=2080, skipped=12, lr=[9.247102135906435e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:29:25,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=2080/global_step=2080, RunningAvgSamplesPerSec=4.4387483223154325, CurrSamplesPerSec=4.4137780080034705, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:29:34,426] [INFO] [logging.py:96:log_dist] [Rank 0] step=2090, skipped=12, lr=[9.239255337199968e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:29:34,426] [INFO] [timer.py:258:stop] epoch=0/micro_step=2090/global_step=2090, RunningAvgSamplesPerSec=4.438715711520288, CurrSamplesPerSec=4.435030820384225, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:29:43,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=12, lr=[9.23137163355292e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:29:43,577] [INFO] [timer.py:258:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=4.438694686856192, CurrSamplesPerSec=4.425991370258945, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:29:43,579] [INFO] [RANK 0]  iteration     2100/   10000 | elapsed time per iteration (ms): 915.2 | learning rate 9.231E-05 | total loss 2.353730E+00 | loss 2.353730E+00 | loss scale 32768.0 |speed 262.23 samples/(min*GPU)
[2024-06-17 22:29:43,580] [INFO] [RANK 0] time (ms) | forward: 356.06 | backward: 553.59 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 12.18 | data loader: 0.10
[2024-06-17 22:29:43,581] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:29:43,597] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/2100/mp_rank_00_model_states.pt
[2024-06-17 22:29:43,597] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/2100/mp_rank_00_model_states.pt...
[2024-06-17 22:30:02,132] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/2100/mp_rank_00_model_states.pt.
[2024-06-17 22:30:11,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=2110, skipped=12, lr=[9.223451102774268e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:30:11,222] [INFO] [timer.py:258:stop] epoch=0/micro_step=2110/global_step=2110, RunningAvgSamplesPerSec=4.438862598427614, CurrSamplesPerSec=4.479829278966916, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:30:20,301] [INFO] [logging.py:96:log_dist] [Rank 0] step=2120, skipped=12, lr=[9.215493823036445e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:30:20,302] [INFO] [timer.py:258:stop] epoch=0/micro_step=2120/global_step=2120, RunningAvgSamplesPerSec=4.438986284640733, CurrSamplesPerSec=4.460693255711127, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:30:29,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=2130, skipped=12, lr=[9.207499872874597e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:30:29,418] [INFO] [timer.py:258:stop] epoch=0/micro_step=2130/global_step=2130, RunningAvgSamplesPerSec=4.4390787396114275, CurrSamplesPerSec=4.443810635766375, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:30:38,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=2140, skipped=12, lr=[9.199469331185782e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:30:38,534] [INFO] [timer.py:258:stop] epoch=0/micro_step=2140/global_step=2140, RunningAvgSamplesPerSec=4.439127527014969, CurrSamplesPerSec=4.436509701517205, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:30:47,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=12, lr=[9.191402277228204e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:30:47,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=4.439198703422458, CurrSamplesPerSec=4.448683032299139, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:30:47,654] [INFO] [RANK 0]  iteration     2150/   10000 | elapsed time per iteration (ms): 1281.5 | learning rate 9.191E-05 | total loss 2.534512E+00 | loss 2.534512E+00 | loss scale 32768.0 |speed 187.28 samples/(min*GPU)
[2024-06-17 22:30:47,655] [INFO] [RANK 0] time (ms) | forward: 354.47 | backward: 549.86 | allreduce: 0.00 | optimizer: 5.03 | batch generator: 12.59 | data loader: 0.09
[2024-06-17 22:30:56,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=2160, skipped=12, lr=[9.183298790620427e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:30:56,769] [INFO] [timer.py:258:stop] epoch=0/micro_step=2160/global_step=2160, RunningAvgSamplesPerSec=4.439239581318792, CurrSamplesPerSec=4.447309196536355, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:31:05,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=2170, skipped=12, lr=[9.175158951340598e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:31:05,905] [INFO] [timer.py:258:stop] epoch=0/micro_step=2170/global_step=2170, RunningAvgSamplesPerSec=4.439272946705216, CurrSamplesPerSec=4.4513399483049465, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:31:15,025] [INFO] [logging.py:96:log_dist] [Rank 0] step=2180, skipped=12, lr=[9.166982839725638e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:31:15,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=2180/global_step=2180, RunningAvgSamplesPerSec=4.439305534828758, CurrSamplesPerSec=4.435497482080578, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:31:24,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=12, lr=[9.158770536470473e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:31:24,161] [INFO] [timer.py:258:stop] epoch=0/micro_step=2190/global_step=2190, RunningAvgSamplesPerSec=4.439315618562079, CurrSamplesPerSec=4.4351773744098555, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:31:33,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=12, lr=[9.150522122627216e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:31:33,309] [INFO] [timer.py:258:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=4.439315774524448, CurrSamplesPerSec=4.424106468310046, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:31:33,312] [INFO] [RANK 0]  iteration     2200/   10000 | elapsed time per iteration (ms): 913.1 | learning rate 9.150E-05 | total loss 2.223496E+00 | loss 2.223496E+00 | loss scale 32768.0 |speed 262.83 samples/(min*GPU)
[2024-06-17 22:31:33,312] [INFO] [RANK 0] time (ms) | forward: 355.47 | backward: 552.23 | allreduce: 0.00 | optimizer: 4.71 | batch generator: 12.61 | data loader: 0.09
[2024-06-17 22:31:42,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=12, lr=[9.142237679604388e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:31:42,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=2210/global_step=2210, RunningAvgSamplesPerSec=4.439305555062321, CurrSamplesPerSec=4.429036279245598, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:31:51,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=12, lr=[9.13391728916609e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:31:51,646] [INFO] [timer.py:258:stop] epoch=0/micro_step=2220/global_step=2220, RunningAvgSamplesPerSec=4.43925798232884, CurrSamplesPerSec=4.432971881363711, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:32:00,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=12, lr=[9.12556103343122e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:32:00,812] [INFO] [timer.py:258:stop] epoch=0/micro_step=2230/global_step=2230, RunningAvgSamplesPerSec=4.439186161599283, CurrSamplesPerSec=4.431985861785214, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:32:09,978] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=12, lr=[9.117168994872649e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:32:09,979] [INFO] [timer.py:258:stop] epoch=0/micro_step=2240/global_step=2240, RunningAvgSamplesPerSec=4.439111412000405, CurrSamplesPerSec=4.414910452969191, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:32:19,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=12, lr=[9.108741256316407e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:32:19,126] [INFO] [timer.py:258:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=4.439083784259684, CurrSamplesPerSec=4.442006965947346, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:32:19,127] [INFO] [RANK 0]  iteration     2250/   10000 | elapsed time per iteration (ms): 916.3 | learning rate 9.108E-05 | total loss 2.396758E+00 | loss 2.396758E+00 | loss scale 32768.0 |speed 261.92 samples/(min*GPU)
[2024-06-17 22:32:19,129] [INFO] [RANK 0] time (ms) | forward: 357.02 | backward: 553.59 | allreduce: 0.00 | optimizer: 4.88 | batch generator: 12.55 | data loader: 0.15
[2024-06-17 22:32:28,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=12, lr=[9.100277900940877e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:32:28,273] [INFO] [timer.py:258:stop] epoch=0/micro_step=2260/global_step=2260, RunningAvgSamplesPerSec=4.439059993800476, CurrSamplesPerSec=4.425057471991965, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:32:37,432] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=12, lr=[9.091779012275951e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:32:37,433] [INFO] [timer.py:258:stop] epoch=0/micro_step=2270/global_step=2270, RunningAvgSamplesPerSec=4.438987836342354, CurrSamplesPerSec=4.424324637925761, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:32:46,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=12, lr=[9.083244674202236e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:32:46,605] [INFO] [timer.py:258:stop] epoch=0/micro_step=2280/global_step=2280, RunningAvgSamplesPerSec=4.438905503936819, CurrSamplesPerSec=4.44092758260424, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:32:55,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=12, lr=[9.074674970950201e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:32:55,765] [INFO] [timer.py:258:stop] epoch=0/micro_step=2290/global_step=2290, RunningAvgSamplesPerSec=4.438855829615538, CurrSamplesPerSec=4.424084302547883, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:33:04,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=12, lr=[9.066069987099359e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:33:04,930] [INFO] [timer.py:258:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=4.438803136073901, CurrSamplesPerSec=4.427956177601592, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:33:04,933] [INFO] [RANK 0]  iteration     2300/   10000 | elapsed time per iteration (ms): 916.1 | learning rate 9.065E-05 | total loss 2.224902E+00 | loss 2.224902E+00 | loss scale 32768.0 |speed 261.97 samples/(min*GPU)
[2024-06-17 22:33:04,937] [INFO] [RANK 0] time (ms) | forward: 356.30 | backward: 553.91 | allreduce: 0.00 | optimizer: 5.07 | batch generator: 11.68 | data loader: 0.12
[2024-06-17 22:33:14,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=2310, skipped=12, lr=[9.057429807577423e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:33:14,098] [INFO] [timer.py:258:stop] epoch=0/micro_step=2310/global_step=2310, RunningAvgSamplesPerSec=4.438765588595678, CurrSamplesPerSec=4.438428673091728, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:33:23,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=2320, skipped=12, lr=[9.048754517659479e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:33:23,254] [INFO] [timer.py:258:stop] epoch=0/micro_step=2320/global_step=2320, RunningAvgSamplesPerSec=4.438745491615791, CurrSamplesPerSec=4.427331034855844, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:33:32,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=2330, skipped=12, lr=[9.040044202967136e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:33:32,410] [INFO] [timer.py:258:stop] epoch=0/micro_step=2330/global_step=2330, RunningAvgSamplesPerSec=4.438708352850831, CurrSamplesPerSec=4.418161181672386, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:33:41,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=2340, skipped=12, lr=[9.031298949467681e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:33:41,546] [INFO] [timer.py:258:stop] epoch=0/micro_step=2340/global_step=2340, RunningAvgSamplesPerSec=4.4386867478667735, CurrSamplesPerSec=4.430451495142595, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:33:50,735] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=12, lr=[9.022518843473241e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:33:50,735] [INFO] [timer.py:258:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=4.438634737103509, CurrSamplesPerSec=4.434933513861731, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:33:50,738] [INFO] [RANK 0]  iteration     2350/   10000 | elapsed time per iteration (ms): 916.1 | learning rate 9.022E-05 | total loss 2.126816E+00 | loss 2.126816E+00 | loss scale 32768.0 |speed 261.99 samples/(min*GPU)
[2024-06-17 22:33:50,739] [INFO] [RANK 0] time (ms) | forward: 356.72 | backward: 553.59 | allreduce: 0.00 | optimizer: 4.92 | batch generator: 12.60 | data loader: 0.18
[2024-06-17 22:33:59,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=2360, skipped=12, lr=[9.013703971639914e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:33:59,899] [INFO] [timer.py:258:stop] epoch=0/micro_step=2360/global_step=2360, RunningAvgSamplesPerSec=4.438611868327065, CurrSamplesPerSec=4.439943896048906, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:34:09,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=2370, skipped=12, lr=[9.004854420966926e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:34:09,045] [INFO] [timer.py:258:stop] epoch=0/micro_step=2370/global_step=2370, RunningAvgSamplesPerSec=4.438586975297663, CurrSamplesPerSec=4.424435480999856, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:34:18,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=2380, skipped=12, lr=[8.995970278795771e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:34:18,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=2380/global_step=2380, RunningAvgSamplesPerSec=4.438563377776, CurrSamplesPerSec=4.437658537720802, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:34:27,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=2390, skipped=12, lr=[8.987051632809343e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:34:27,348] [INFO] [timer.py:258:stop] epoch=0/micro_step=2390/global_step=2390, RunningAvgSamplesPerSec=4.438549132678845, CurrSamplesPerSec=4.4111692090313035, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:34:36,497] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=12, lr=[8.97809857103108e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:34:36,497] [INFO] [timer.py:258:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=4.438545069866992, CurrSamplesPerSec=4.426386060743893, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:34:36,500] [INFO] [RANK 0]  iteration     2400/   10000 | elapsed time per iteration (ms): 915.3 | learning rate 8.977E-05 | total loss 2.517148E+00 | loss 2.517148E+00 | loss scale 32768.0 |speed 262.22 samples/(min*GPU)
[2024-06-17 22:34:36,501] [INFO] [RANK 0] time (ms) | forward: 356.05 | backward: 553.48 | allreduce: 0.00 | optimizer: 4.94 | batch generator: 12.51 | data loader: 0.21
[2024-06-17 22:34:36,503] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:34:36,526] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/2400/mp_rank_00_model_states.pt
[2024-06-17 22:34:36,526] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/2400/mp_rank_00_model_states.pt...
[2024-06-17 22:34:54,662] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/2400/mp_rank_00_model_states.pt.
[2024-06-17 22:35:03,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=2410, skipped=12, lr=[8.969111181824083e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:35:03,771] [INFO] [timer.py:258:stop] epoch=0/micro_step=2410/global_step=2410, RunningAvgSamplesPerSec=4.438671534154231, CurrSamplesPerSec=4.480023071407877, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:35:06,488] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:35:07,392] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:35:12,866] [INFO] [logging.py:96:log_dist] [Rank 0] step=2420, skipped=14, lr=[8.96189661430612e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:35:12,867] [INFO] [timer.py:258:stop] epoch=0/micro_step=2420/global_step=2420, RunningAvgSamplesPerSec=4.438791146869002, CurrSamplesPerSec=4.457531249742614, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:35:21,976] [INFO] [logging.py:96:log_dist] [Rank 0] step=2430, skipped=14, lr=[8.952847659483319e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:35:21,976] [INFO] [timer.py:258:stop] epoch=0/micro_step=2430/global_step=2430, RunningAvgSamplesPerSec=4.4388518026334935, CurrSamplesPerSec=4.448857623274091, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:35:31,114] [INFO] [logging.py:96:log_dist] [Rank 0] step=2440, skipped=14, lr=[8.94376462644809e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:35:31,115] [INFO] [timer.py:258:stop] epoch=0/micro_step=2440/global_step=2440, RunningAvgSamplesPerSec=4.438897928871718, CurrSamplesPerSec=4.455775595614025, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:35:40,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=14, lr=[8.934647604846301e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:35:40,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=4.438933865170982, CurrSamplesPerSec=4.447661713779143, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:35:40,251] [INFO] [RANK 0]  iteration     2450/   10000 | elapsed time per iteration (ms): 1275.0 | learning rate 8.934E-05 | total loss 2.199883E+00 | loss 2.199883E+00 | loss scale 32768.0 |speed 188.23 samples/(min*GPU)
[2024-06-17 22:35:40,252] [INFO] [RANK 0] time (ms) | forward: 355.48 | backward: 550.42 | allreduce: 0.00 | optimizer: 4.83 | batch generator: 13.41 | data loader: 0.16
[2024-06-17 22:35:49,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=2460, skipped=14, lr=[8.925496684659279e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:35:49,414] [INFO] [timer.py:258:stop] epoch=0/micro_step=2460/global_step=2460, RunningAvgSamplesPerSec=4.438930692999155, CurrSamplesPerSec=4.428781402578094, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:35:58,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=2470, skipped=14, lr=[8.916311956202905e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:35:58,538] [INFO] [timer.py:258:stop] epoch=0/micro_step=2470/global_step=2470, RunningAvgSamplesPerSec=4.438956621617013, CurrSamplesPerSec=4.446553653868733, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:36:07,667] [INFO] [logging.py:96:log_dist] [Rank 0] step=2480, skipped=14, lr=[8.907093510126747e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:36:07,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=2480/global_step=2480, RunningAvgSamplesPerSec=4.438975272097228, CurrSamplesPerSec=4.44961630940945, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:36:16,825] [INFO] [logging.py:96:log_dist] [Rank 0] step=2490, skipped=14, lr=[8.897841437413139e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:36:16,825] [INFO] [timer.py:258:stop] epoch=0/micro_step=2490/global_step=2490, RunningAvgSamplesPerSec=4.438975996451184, CurrSamplesPerSec=4.4448796451136365, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:36:25,988] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=14, lr=[8.888555829376311e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:36:25,988] [INFO] [timer.py:258:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=4.438972890189554, CurrSamplesPerSec=4.429801085296535, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:36:25,989] [INFO] [RANK 0]  iteration     2500/   10000 | elapsed time per iteration (ms): 914.8 | learning rate 8.888E-05 | total loss 2.222285E+00 | loss 2.222285E+00 | loss scale 32768.0 |speed 262.36 samples/(min*GPU)
[2024-06-17 22:36:25,990] [INFO] [RANK 0] time (ms) | forward: 356.93 | backward: 552.31 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 13.52 | data loader: 0.10
[2024-06-17 22:36:35,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=2510, skipped=14, lr=[8.879236777661462e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:36:35,148] [INFO] [timer.py:258:stop] epoch=0/micro_step=2510/global_step=2510, RunningAvgSamplesPerSec=4.438960215757392, CurrSamplesPerSec=4.437450787831115, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:36:44,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=2520, skipped=14, lr=[8.86988437424387e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:36:44,295] [INFO] [timer.py:258:stop] epoch=0/micro_step=2520/global_step=2520, RunningAvgSamplesPerSec=4.438944906936468, CurrSamplesPerSec=4.4283523874706985, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:36:53,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=2530, skipped=14, lr=[8.860498711427982e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:36:53,452] [INFO] [timer.py:258:stop] epoch=0/micro_step=2530/global_step=2530, RunningAvgSamplesPerSec=4.438924688878293, CurrSamplesPerSec=4.42907954104165, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:37:02,605] [INFO] [logging.py:96:log_dist] [Rank 0] step=2540, skipped=14, lr=[8.8510798818465e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:37:02,606] [INFO] [timer.py:258:stop] epoch=0/micro_step=2540/global_step=2540, RunningAvgSamplesPerSec=4.438884128116077, CurrSamplesPerSec=4.433462712566698, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:37:11,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=14, lr=[8.841627978459472e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:37:11,793] [INFO] [timer.py:258:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=4.438821514240898, CurrSamplesPerSec=4.402961443550205, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:37:11,794] [INFO] [RANK 0]  iteration     2550/   10000 | elapsed time per iteration (ms): 916.1 | learning rate 8.841E-05 | total loss 2.167734E+00 | loss 2.167734E+00 | loss scale 32768.0 |speed 261.98 samples/(min*GPU)
[2024-06-17 22:37:11,795] [INFO] [RANK 0] time (ms) | forward: 356.90 | backward: 553.54 | allreduce: 0.00 | optimizer: 4.90 | batch generator: 12.85 | data loader: 0.19
[2024-06-17 22:37:20,947] [INFO] [logging.py:96:log_dist] [Rank 0] step=2560, skipped=14, lr=[8.832143094553364e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:37:20,948] [INFO] [timer.py:258:stop] epoch=0/micro_step=2560/global_step=2560, RunningAvgSamplesPerSec=4.438791335281119, CurrSamplesPerSec=4.433508404055298, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:37:30,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=2570, skipped=14, lr=[8.822625323740153e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:37:30,105] [INFO] [timer.py:258:stop] epoch=0/micro_step=2570/global_step=2570, RunningAvgSamplesPerSec=4.438756948109331, CurrSamplesPerSec=4.431234345810376, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:37:39,285] [INFO] [logging.py:96:log_dist] [Rank 0] step=2580, skipped=14, lr=[8.813074759956396e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:37:39,286] [INFO] [timer.py:258:stop] epoch=0/micro_step=2580/global_step=2580, RunningAvgSamplesPerSec=4.438722824138439, CurrSamplesPerSec=4.433984120108494, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:37:48,477] [INFO] [logging.py:96:log_dist] [Rank 0] step=2590, skipped=14, lr=[8.8034914974623e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:37:48,478] [INFO] [timer.py:258:stop] epoch=0/micro_step=2590/global_step=2590, RunningAvgSamplesPerSec=4.438686663384618, CurrSamplesPerSec=4.42477854633773, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:37:57,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=14, lr=[8.793875630840797e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:37:57,646] [INFO] [timer.py:258:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=4.438662608320408, CurrSamplesPerSec=4.4345595682908625, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:37:57,647] [INFO] [RANK 0]  iteration     2600/   10000 | elapsed time per iteration (ms): 917.0 | learning rate 8.793E-05 | total loss 2.247559E+00 | loss 2.247559E+00 | loss scale 32768.0 |speed 261.71 samples/(min*GPU)
[2024-06-17 22:37:57,649] [INFO] [RANK 0] time (ms) | forward: 357.55 | backward: 553.80 | allreduce: 0.00 | optimizer: 4.86 | batch generator: 13.65 | data loader: 0.21
[2024-06-17 22:38:06,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=2610, skipped=14, lr=[8.784227254996609e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:38:06,833] [INFO] [timer.py:258:stop] epoch=0/micro_step=2610/global_step=2610, RunningAvgSamplesPerSec=4.43862087993555, CurrSamplesPerSec=4.441361389323186, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:38:15,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=2620, skipped=14, lr=[8.774546465155311e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:38:15,968] [INFO] [timer.py:258:stop] epoch=0/micro_step=2620/global_step=2620, RunningAvgSamplesPerSec=4.438602700521269, CurrSamplesPerSec=4.437281785321057, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:38:25,117] [INFO] [logging.py:96:log_dist] [Rank 0] step=2630, skipped=14, lr=[8.76483335686239e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:38:25,118] [INFO] [timer.py:258:stop] epoch=0/micro_step=2630/global_step=2630, RunningAvgSamplesPerSec=4.43858004160741, CurrSamplesPerSec=4.4335669842645675, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:38:34,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=2640, skipped=14, lr=[8.755088025982304e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:38:34,272] [INFO] [timer.py:258:stop] epoch=0/micro_step=2640/global_step=2640, RunningAvgSamplesPerSec=4.438564887385914, CurrSamplesPerSec=4.431354898965247, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:38:43,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=14, lr=[8.745310568697534e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:38:43,429] [INFO] [timer.py:258:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=4.438545395937918, CurrSamplesPerSec=4.434879586784615, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:38:43,430] [INFO] [RANK 0]  iteration     2650/   10000 | elapsed time per iteration (ms): 915.7 | learning rate 8.744E-05 | total loss 2.021016E+00 | loss 2.021016E+00 | loss scale 32768.0 |speed 262.10 samples/(min*GPU)
[2024-06-17 22:38:43,431] [INFO] [RANK 0] time (ms) | forward: 356.34 | backward: 553.77 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 12.61 | data loader: 0.22
[2024-06-17 22:38:52,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=2660, skipped=14, lr=[8.735501081507633e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:38:52,630] [INFO] [timer.py:258:stop] epoch=0/micro_step=2660/global_step=2660, RunningAvgSamplesPerSec=4.438462940460788, CurrSamplesPerSec=4.401368585803414, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:39:01,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=2670, skipped=14, lr=[8.725659661228286e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:39:01,800] [INFO] [timer.py:258:stop] epoch=0/micro_step=2670/global_step=2670, RunningAvgSamplesPerSec=4.438415902265496, CurrSamplesPerSec=4.410529085799026, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:39:10,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=2680, skipped=14, lr=[8.715786404990331e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:39:10,960] [INFO] [timer.py:258:stop] epoch=0/micro_step=2680/global_step=2680, RunningAvgSamplesPerSec=4.438384319559797, CurrSamplesPerSec=4.4010233683803515, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:39:20,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=2690, skipped=14, lr=[8.705881410238825e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:39:20,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=2690/global_step=2690, RunningAvgSamplesPerSec=4.43835215151942, CurrSamplesPerSec=4.4280391537399515, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:39:29,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=14, lr=[8.695944774732068e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:39:29,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=4.4383305890006515, CurrSamplesPerSec=4.431537496817111, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:39:29,299] [INFO] [RANK 0]  iteration     2700/   10000 | elapsed time per iteration (ms): 917.4 | learning rate 8.695E-05 | total loss 2.039785E+00 | loss 2.039785E+00 | loss scale 32768.0 |speed 261.61 samples/(min*GPU)
[2024-06-17 22:39:29,301] [INFO] [RANK 0] time (ms) | forward: 358.11 | backward: 553.69 | allreduce: 0.00 | optimizer: 4.81 | batch generator: 13.23 | data loader: 0.21
[2024-06-17 22:39:29,301] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:39:29,314] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/2700/mp_rank_00_model_states.pt
[2024-06-17 22:39:29,314] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/2700/mp_rank_00_model_states.pt...
[2024-06-17 22:39:49,654] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/2700/mp_rank_00_model_states.pt.
[2024-06-17 22:39:58,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=2710, skipped=14, lr=[8.685976596540638e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:39:58,768] [INFO] [timer.py:258:stop] epoch=0/micro_step=2710/global_step=2710, RunningAvgSamplesPerSec=4.438427499768653, CurrSamplesPerSec=4.477910203802745, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:40:07,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=2720, skipped=14, lr=[8.675976974046432e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:40:07,846] [INFO] [timer.py:258:stop] epoch=0/micro_step=2720/global_step=2720, RunningAvgSamplesPerSec=4.438550180519394, CurrSamplesPerSec=4.449844083735667, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:40:16,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=2730, skipped=14, lr=[8.665946005941686e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:40:16,955] [INFO] [timer.py:258:stop] epoch=0/micro_step=2730/global_step=2730, RunningAvgSamplesPerSec=4.438622602497329, CurrSamplesPerSec=4.450747149245211, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:40:26,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=2740, skipped=14, lr=[8.655883791228004e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:40:26,083] [INFO] [timer.py:258:stop] epoch=0/micro_step=2740/global_step=2740, RunningAvgSamplesPerSec=4.438648963122115, CurrSamplesPerSec=4.450715270104826, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:40:35,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=14, lr=[8.645790429215386e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:40:35,226] [INFO] [timer.py:258:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=4.438677782973982, CurrSamplesPerSec=4.447680579153353, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:40:35,229] [INFO] [RANK 0]  iteration     2750/   10000 | elapsed time per iteration (ms): 1318.6 | learning rate 8.645E-05 | total loss 2.217363E+00 | loss 2.217363E+00 | loss scale 32768.0 |speed 182.01 samples/(min*GPU)
[2024-06-17 22:40:35,231] [INFO] [RANK 0] time (ms) | forward: 355.69 | backward: 549.98 | allreduce: 0.00 | optimizer: 4.83 | batch generator: 13.22 | data loader: 0.20
[2024-06-17 22:40:44,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=2760, skipped=14, lr=[8.635666019521238e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:40:44,413] [INFO] [timer.py:258:stop] epoch=0/micro_step=2760/global_step=2760, RunningAvgSamplesPerSec=4.438650306032551, CurrSamplesPerSec=4.409050091493773, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:40:53,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=2770, skipped=14, lr=[8.625510662069396e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:40:53,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=2770/global_step=2770, RunningAvgSamplesPerSec=4.438616009786537, CurrSamplesPerSec=4.429642021308054, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:41:02,760] [INFO] [logging.py:96:log_dist] [Rank 0] step=2780, skipped=14, lr=[8.61532445708914e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:41:02,760] [INFO] [timer.py:258:stop] epoch=0/micro_step=2780/global_step=2780, RunningAvgSamplesPerSec=4.438565081626367, CurrSamplesPerSec=4.429354331639972, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:41:11,936] [INFO] [logging.py:96:log_dist] [Rank 0] step=2790, skipped=14, lr=[8.605107505114198e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:41:11,937] [INFO] [timer.py:258:stop] epoch=0/micro_step=2790/global_step=2790, RunningAvgSamplesPerSec=4.438538679113534, CurrSamplesPerSec=4.442944503234513, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:41:21,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=14, lr=[8.594859906981766e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:41:21,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=4.438495320109397, CurrSamplesPerSec=4.437862785387645, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:41:21,111] [INFO] [RANK 0]  iteration     2800/   10000 | elapsed time per iteration (ms): 917.6 | learning rate 8.594E-05 | total loss 2.052246E+00 | loss 2.052246E+00 | loss scale 32768.0 |speed 261.54 samples/(min*GPU)
[2024-06-17 22:41:21,112] [INFO] [RANK 0] time (ms) | forward: 358.07 | backward: 553.86 | allreduce: 0.00 | optimizer: 4.92 | batch generator: 13.82 | data loader: 0.20
[2024-06-17 22:41:30,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=2810, skipped=14, lr=[8.584581763831497e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:41:30,282] [INFO] [timer.py:258:stop] epoch=0/micro_step=2810/global_step=2810, RunningAvgSamplesPerSec=4.43846248359851, CurrSamplesPerSec=4.433470913533764, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:41:34,860] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:41:35,774] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:41:39,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=2820, skipped=16, lr=[8.57633732505677e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:41:39,444] [INFO] [timer.py:258:stop] epoch=0/micro_step=2820/global_step=2820, RunningAvgSamplesPerSec=4.438452335783241, CurrSamplesPerSec=4.432730605633144, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:41:48,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=2830, skipped=16, lr=[8.566004456707973e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:41:48,610] [INFO] [timer.py:258:stop] epoch=0/micro_step=2830/global_step=2830, RunningAvgSamplesPerSec=4.438430313969702, CurrSamplesPerSec=4.439275426014925, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:41:57,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=2840, skipped=16, lr=[8.555641328132982e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:41:57,771] [INFO] [timer.py:258:stop] epoch=0/micro_step=2840/global_step=2840, RunningAvgSamplesPerSec=4.4383952275303, CurrSamplesPerSec=4.432628715518572, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:42:06,949] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=16, lr=[8.545248041611697e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:42:06,949] [INFO] [timer.py:258:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=4.438347347453801, CurrSamplesPerSec=4.431186360457327, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:42:06,951] [INFO] [RANK 0]  iteration     2850/   10000 | elapsed time per iteration (ms): 916.8 | learning rate 8.544E-05 | total loss 2.066309E+00 | loss 2.066309E+00 | loss scale 32768.0 |speed 261.78 samples/(min*GPU)
[2024-06-17 22:42:06,951] [INFO] [RANK 0] time (ms) | forward: 356.96 | backward: 554.04 | allreduce: 0.00 | optimizer: 4.98 | batch generator: 13.05 | data loader: 0.09
[2024-06-17 22:42:16,118] [INFO] [logging.py:96:log_dist] [Rank 0] step=2860, skipped=16, lr=[8.534824699721658e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:42:16,118] [INFO] [timer.py:258:stop] epoch=0/micro_step=2860/global_step=2860, RunningAvgSamplesPerSec=4.438323346012096, CurrSamplesPerSec=4.430197625410845, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:42:25,290] [INFO] [logging.py:96:log_dist] [Rank 0] step=2870, skipped=16, lr=[8.52437140533704e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:42:25,291] [INFO] [timer.py:258:stop] epoch=0/micro_step=2870/global_step=2870, RunningAvgSamplesPerSec=4.43828175060302, CurrSamplesPerSec=4.425806894113861, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:42:34,454] [INFO] [logging.py:96:log_dist] [Rank 0] step=2880, skipped=16, lr=[8.513888261627641e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:42:34,455] [INFO] [timer.py:258:stop] epoch=0/micro_step=2880/global_step=2880, RunningAvgSamplesPerSec=4.438267405220898, CurrSamplesPerSec=4.433557611327056, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:42:43,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=2890, skipped=16, lr=[8.503375372057854e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:42:43,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=2890/global_step=2890, RunningAvgSamplesPerSec=4.43825973350051, CurrSamplesPerSec=4.43462755370411, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:42:52,782] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=16, lr=[8.492832840385657e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:42:52,782] [INFO] [timer.py:258:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=4.438239163257573, CurrSamplesPerSec=4.439695986489229, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:42:52,784] [INFO] [RANK 0]  iteration     2900/   10000 | elapsed time per iteration (ms): 916.7 | learning rate 8.492E-05 | total loss 1.936992E+00 | loss 1.936992E+00 | loss scale 32768.0 |speed 261.82 samples/(min*GPU)
[2024-06-17 22:42:52,786] [INFO] [RANK 0] time (ms) | forward: 357.56 | backward: 553.55 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 13.54 | data loader: 0.09
[2024-06-17 22:43:01,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=2910, skipped=16, lr=[8.482260770661583e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:43:01,956] [INFO] [timer.py:258:stop] epoch=0/micro_step=2910/global_step=2910, RunningAvgSamplesPerSec=4.438230743992337, CurrSamplesPerSec=4.429439699064938, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:43:11,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=2920, skipped=16, lr=[8.471659267227686e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:43:11,146] [INFO] [timer.py:258:stop] epoch=0/micro_step=2920/global_step=2920, RunningAvgSamplesPerSec=4.438206324403877, CurrSamplesPerSec=4.441160346404459, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:43:20,313] [INFO] [logging.py:96:log_dist] [Rank 0] step=2930, skipped=16, lr=[8.461028434716533e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:43:20,313] [INFO] [timer.py:258:stop] epoch=0/micro_step=2930/global_step=2930, RunningAvgSamplesPerSec=4.43818439113296, CurrSamplesPerSec=4.439241361755543, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:43:29,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=2940, skipped=16, lr=[8.45036837805014e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:43:29,494] [INFO] [timer.py:258:stop] epoch=0/micro_step=2940/global_step=2940, RunningAvgSamplesPerSec=4.438141535328, CurrSamplesPerSec=4.400262695736649, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:43:38,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=16, lr=[8.439679202438971e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:43:38,679] [INFO] [timer.py:258:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=4.438099138348682, CurrSamplesPerSec=4.433066759112415, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:43:38,680] [INFO] [RANK 0]  iteration     2950/   10000 | elapsed time per iteration (ms): 917.9 | learning rate 8.439E-05 | total loss 1.954492E+00 | loss 1.954492E+00 | loss scale 32768.0 |speed 261.46 samples/(min*GPU)
[2024-06-17 22:43:38,681] [INFO] [RANK 0] time (ms) | forward: 358.51 | backward: 553.77 | allreduce: 0.00 | optimizer: 4.82 | batch generator: 14.34 | data loader: 0.13
[2024-06-17 22:43:47,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=2960, skipped=16, lr=[8.42896101338087e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:43:47,849] [INFO] [timer.py:258:stop] epoch=0/micro_step=2960/global_step=2960, RunningAvgSamplesPerSec=4.438088208948326, CurrSamplesPerSec=4.431516427066214, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:43:57,022] [INFO] [logging.py:96:log_dist] [Rank 0] step=2970, skipped=16, lr=[8.418213916660038e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:43:57,023] [INFO] [timer.py:258:stop] epoch=0/micro_step=2970/global_step=2970, RunningAvgSamplesPerSec=4.438073137041855, CurrSamplesPerSec=4.434942892617714, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:44:06,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=2980, skipped=16, lr=[8.407438018345975e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:44:06,182] [INFO] [timer.py:258:stop] epoch=0/micro_step=2980/global_step=2980, RunningAvgSamplesPerSec=4.438053080599952, CurrSamplesPerSec=4.436032270483169, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:44:15,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=2990, skipped=16, lr=[8.396633424792452e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:44:15,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=2990/global_step=2990, RunningAvgSamplesPerSec=4.438023205696457, CurrSamplesPerSec=4.430721775540628, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:44:24,540] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=16, lr=[8.385800242636447e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:44:24,541] [INFO] [timer.py:258:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=4.437999991588833, CurrSamplesPerSec=4.434449389461598, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:44:24,543] [INFO] [RANK 0]  iteration     3000/   10000 | elapsed time per iteration (ms): 917.3 | learning rate 8.385E-05 | total loss 2.036191E+00 | loss 2.036191E+00 | loss scale 32768.0 |speed 261.65 samples/(min*GPU)
[2024-06-17 22:44:24,544] [INFO] [RANK 0] time (ms) | forward: 357.90 | backward: 553.74 | allreduce: 0.00 | optimizer: 4.86 | batch generator: 14.16 | data loader: 0.17
[2024-06-17 22:44:24,544] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:44:24,558] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/3000/mp_rank_00_model_states.pt
[2024-06-17 22:44:24,559] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/3000/mp_rank_00_model_states.pt...
[2024-06-17 22:44:49,578] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/3000/mp_rank_00_model_states.pt.
[2024-06-17 22:44:56,208] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 22:44:56,208] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 22:44:56,208] [INFO] [RANK 0]  validation loss at iteration 3000 | loss: 2.216406E+00 | PPL: 9.174301E+00 loss 2.216797E+00 |
[2024-06-17 22:44:56,208] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 22:45:05,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=3010, skipped=16, lr=[8.37493857879709e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:45:05,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=3010/global_step=3010, RunningAvgSamplesPerSec=4.438135806034082, CurrSamplesPerSec=4.474060278099121, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:45:14,384] [INFO] [logging.py:96:log_dist] [Rank 0] step=3020, skipped=16, lr=[8.36404854047462e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:45:14,384] [INFO] [timer.py:258:stop] epoch=0/micro_step=3020/global_step=3020, RunningAvgSamplesPerSec=4.438200930321675, CurrSamplesPerSec=4.459690125038245, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:45:23,529] [INFO] [logging.py:96:log_dist] [Rank 0] step=3030, skipped=16, lr=[8.353130235149319e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:45:23,529] [INFO] [timer.py:258:stop] epoch=0/micro_step=3030/global_step=3030, RunningAvgSamplesPerSec=4.438206804817825, CurrSamplesPerSec=4.426479488912705, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:45:32,675] [INFO] [logging.py:96:log_dist] [Rank 0] step=3040, skipped=16, lr=[8.342183770580452e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:45:32,675] [INFO] [timer.py:258:stop] epoch=0/micro_step=3040/global_step=3040, RunningAvgSamplesPerSec=4.438222634239548, CurrSamplesPerSec=4.439363525661821, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:45:41,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=16, lr=[8.331209254805206e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:45:41,835] [INFO] [timer.py:258:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=4.438202851674304, CurrSamplesPerSec=4.4317997149230095, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:45:41,837] [INFO] [RANK 0]  iteration     3050/   10000 | elapsed time per iteration (ms): 1545.9 | learning rate 8.330E-05 | total loss 1.958730E+00 | loss 1.958730E+00 | loss scale 32768.0 |speed 155.25 samples/(min*GPU)
[2024-06-17 22:45:41,838] [INFO] [RANK 0] time (ms) | forward: 355.69 | backward: 551.27 | allreduce: 0.00 | optimizer: 4.82 | batch generator: 15.77 | data loader: 0.25
[2024-06-17 22:45:50,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=3060, skipped=16, lr=[8.320206796137623e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:45:51,000] [INFO] [timer.py:258:stop] epoch=0/micro_step=3060/global_step=3060, RunningAvgSamplesPerSec=4.438190829305928, CurrSamplesPerSec=4.4324717904820785, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:46:00,190] [INFO] [logging.py:96:log_dist] [Rank 0] step=3070, skipped=16, lr=[8.309176503167521e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:46:00,190] [INFO] [timer.py:258:stop] epoch=0/micro_step=3070/global_step=3070, RunningAvgSamplesPerSec=4.438125182418504, CurrSamplesPerSec=4.424108801561089, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:46:09,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=3080, skipped=16, lr=[8.298118484759446e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:46:09,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=3080/global_step=3080, RunningAvgSamplesPerSec=4.4380876057115595, CurrSamplesPerSec=4.43176342396006, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:46:18,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=3090, skipped=16, lr=[8.287032850051573e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:46:18,525] [INFO] [timer.py:258:stop] epoch=0/micro_step=3090/global_step=3090, RunningAvgSamplesPerSec=4.43804673393086, CurrSamplesPerSec=4.420579076019438, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:46:27,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=16, lr=[8.275919708454638e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:46:27,679] [INFO] [timer.py:258:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=4.43800546474059, CurrSamplesPerSec=4.425002617725789, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:46:27,680] [INFO] [RANK 0]  iteration     3100/   10000 | elapsed time per iteration (ms): 916.9 | learning rate 8.275E-05 | total loss 1.994922E+00 | loss 1.994922E+00 | loss scale 32768.0 |speed 261.76 samples/(min*GPU)
[2024-06-17 22:46:27,681] [INFO] [RANK 0] time (ms) | forward: 357.61 | backward: 553.61 | allreduce: 0.00 | optimizer: 4.84 | batch generator: 12.54 | data loader: 0.21
[2024-06-17 22:46:36,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=3110, skipped=16, lr=[8.264779169650865e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:46:36,857] [INFO] [timer.py:258:stop] epoch=0/micro_step=3110/global_step=3110, RunningAvgSamplesPerSec=4.437967427337478, CurrSamplesPerSec=4.428759189946368, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:46:46,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=3120, skipped=16, lr=[8.253611343592877e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:46:46,023] [INFO] [timer.py:258:stop] epoch=0/micro_step=3120/global_step=3120, RunningAvgSamplesPerSec=4.437944202899378, CurrSamplesPerSec=4.435693321640337, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:46:55,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=3130, skipped=16, lr=[8.242416340502605e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:46:55,172] [INFO] [timer.py:258:stop] epoch=0/micro_step=3130/global_step=3130, RunningAvgSamplesPerSec=4.437942190715122, CurrSamplesPerSec=4.4313490467188705, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:47:04,324] [INFO] [logging.py:96:log_dist] [Rank 0] step=3140, skipped=16, lr=[8.23119427087021e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:47:04,324] [INFO] [timer.py:258:stop] epoch=0/micro_step=3140/global_step=3140, RunningAvgSamplesPerSec=4.4379154446465705, CurrSamplesPerSec=4.414620027071005, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:47:13,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=16, lr=[8.219945245452987e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:47:13,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=4.43790190300885, CurrSamplesPerSec=4.432393332130383, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:47:13,485] [INFO] [RANK 0]  iteration     3150/   10000 | elapsed time per iteration (ms): 916.1 | learning rate 8.219E-05 | total loss 1.961572E+00 | loss 1.961572E+00 | loss scale 32768.0 |speed 261.98 samples/(min*GPU)
[2024-06-17 22:47:13,486] [INFO] [RANK 0] time (ms) | forward: 356.84 | backward: 553.72 | allreduce: 0.00 | optimizer: 4.76 | batch generator: 12.88 | data loader: 0.21
[2024-06-17 22:47:22,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=3160, skipped=16, lr=[8.208669375274278e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:47:22,641] [INFO] [timer.py:258:stop] epoch=0/micro_step=3160/global_step=3160, RunningAvgSamplesPerSec=4.437888094075948, CurrSamplesPerSec=4.4265390514289304, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:47:31,810] [INFO] [logging.py:96:log_dist] [Rank 0] step=3170, skipped=16, lr=[8.197366771622371e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:47:31,810] [INFO] [timer.py:258:stop] epoch=0/micro_step=3170/global_step=3170, RunningAvgSamplesPerSec=4.437880666179231, CurrSamplesPerSec=4.440178906973667, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:47:40,988] [INFO] [logging.py:96:log_dist] [Rank 0] step=3180, skipped=16, lr=[8.186037546049399e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:47:40,988] [INFO] [timer.py:258:stop] epoch=0/micro_step=3180/global_step=3180, RunningAvgSamplesPerSec=4.43786645740212, CurrSamplesPerSec=4.437979003659163, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:47:50,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=3190, skipped=16, lr=[8.174681810370246e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:47:50,148] [INFO] [timer.py:258:stop] epoch=0/micro_step=3190/global_step=3190, RunningAvgSamplesPerSec=4.437852993286136, CurrSamplesPerSec=4.430030344670248, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:47:59,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=16, lr=[8.163299676661434e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:47:59,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=4.437833572647895, CurrSamplesPerSec=4.42235256005236, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:47:59,300] [INFO] [RANK 0]  iteration     3200/   10000 | elapsed time per iteration (ms): 916.3 | learning rate 8.162E-05 | total loss 1.826641E+00 | loss 1.826641E+00 | loss scale 32768.0 |speed 261.93 samples/(min*GPU)
[2024-06-17 22:47:59,300] [INFO] [RANK 0] time (ms) | forward: 357.28 | backward: 553.35 | allreduce: 0.00 | optimizer: 4.91 | batch generator: 13.40 | data loader: 0.12
[2024-06-17 22:48:08,443] [INFO] [logging.py:96:log_dist] [Rank 0] step=3210, skipped=16, lr=[8.151891257260032e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:48:08,444] [INFO] [timer.py:258:stop] epoch=0/micro_step=3210/global_step=3210, RunningAvgSamplesPerSec=4.437827448177601, CurrSamplesPerSec=4.438458028050524, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:48:14,853] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:48:15,772] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:48:17,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=3220, skipped=18, lr=[8.1427456716964e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:48:17,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=3220/global_step=3220, RunningAvgSamplesPerSec=4.4378051877666795, CurrSamplesPerSec=4.421069496620667, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:48:26,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=3230, skipped=18, lr=[8.131290221965128e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:48:26,762] [INFO] [timer.py:258:stop] epoch=0/micro_step=3230/global_step=3230, RunningAvgSamplesPerSec=4.43779339306583, CurrSamplesPerSec=4.431975324752859, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:48:35,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=3240, skipped=18, lr=[8.119808802461656e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:48:35,931] [INFO] [timer.py:258:stop] epoch=0/micro_step=3240/global_step=3240, RunningAvgSamplesPerSec=4.4377694231230365, CurrSamplesPerSec=4.434645136477837, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:48:45,074] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=18, lr=[8.108301526502963e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:48:45,075] [INFO] [timer.py:258:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=4.437777524503772, CurrSamplesPerSec=4.437697272902569, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:48:45,076] [INFO] [RANK 0]  iteration     3250/   10000 | elapsed time per iteration (ms): 915.5 | learning rate 8.107E-05 | total loss 1.961582E+00 | loss 1.961582E+00 | loss scale 32768.0 |speed 262.14 samples/(min*GPU)
[2024-06-17 22:48:45,077] [INFO] [RANK 0] time (ms) | forward: 356.53 | backward: 553.57 | allreduce: 0.00 | optimizer: 4.69 | batch generator: 12.91 | data loader: 0.19
[2024-06-17 22:48:54,207] [INFO] [logging.py:96:log_dist] [Rank 0] step=3260, skipped=18, lr=[8.096768507661222e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:48:54,207] [INFO] [timer.py:258:stop] epoch=0/micro_step=3260/global_step=3260, RunningAvgSamplesPerSec=4.437767020920657, CurrSamplesPerSec=4.431699038230407, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:49:03,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=3270, skipped=18, lr=[8.085209859762666e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:49:03,334] [INFO] [timer.py:258:stop] epoch=0/micro_step=3270/global_step=3270, RunningAvgSamplesPerSec=4.437751148557269, CurrSamplesPerSec=4.421255908284036, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:49:12,480] [INFO] [logging.py:96:log_dist] [Rank 0] step=3280, skipped=18, lr=[8.073625696886485e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:49:12,481] [INFO] [timer.py:258:stop] epoch=0/micro_step=3280/global_step=3280, RunningAvgSamplesPerSec=4.437732038603017, CurrSamplesPerSec=4.426951361421081, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:49:21,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=3290, skipped=18, lr=[8.062016133363692e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:49:21,611] [INFO] [timer.py:258:stop] epoch=0/micro_step=3290/global_step=3290, RunningAvgSamplesPerSec=4.437716421906442, CurrSamplesPerSec=4.424030638990879, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:49:30,784] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=18, lr=[8.050381283775988e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:49:30,785] [INFO] [timer.py:258:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=4.437695237432619, CurrSamplesPerSec=4.434156387301936, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:49:30,786] [INFO] [RANK 0]  iteration     3300/   10000 | elapsed time per iteration (ms): 914.2 | learning rate 8.049E-05 | total loss 1.878281E+00 | loss 1.878281E+00 | loss scale 32768.0 |speed 262.52 samples/(min*GPU)
[2024-06-17 22:49:30,787] [INFO] [RANK 0] time (ms) | forward: 354.78 | backward: 553.85 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 11.16 | data loader: 0.21
[2024-06-17 22:49:30,788] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:49:30,805] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/3300/mp_rank_00_model_states.pt
[2024-06-17 22:49:30,805] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/3300/mp_rank_00_model_states.pt...
[2024-06-17 22:50:00,151] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/3300/mp_rank_00_model_states.pt.
[2024-06-17 22:50:09,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=3310, skipped=18, lr=[8.038721262954646e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:50:09,235] [INFO] [timer.py:258:stop] epoch=0/micro_step=3310/global_step=3310, RunningAvgSamplesPerSec=4.43781140056352, CurrSamplesPerSec=4.46755650945519, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:50:18,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=3320, skipped=18, lr=[8.02703618597936e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:50:18,313] [INFO] [timer.py:258:stop] epoch=0/micro_step=3320/global_step=3320, RunningAvgSamplesPerSec=4.43792674639733, CurrSamplesPerSec=4.468025281821254, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:50:27,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=3330, skipped=18, lr=[8.015326168177127e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:50:27,406] [INFO] [timer.py:258:stop] epoch=0/micro_step=3330/global_step=3330, RunningAvgSamplesPerSec=4.4379967202561055, CurrSamplesPerSec=4.450012864209647, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:50:36,517] [INFO] [logging.py:96:log_dist] [Rank 0] step=3340, skipped=18, lr=[8.003591325121088e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:50:36,518] [INFO] [timer.py:258:stop] epoch=0/micro_step=3340/global_step=3340, RunningAvgSamplesPerSec=4.438028226866202, CurrSamplesPerSec=4.425531376104391, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:50:45,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=18, lr=[7.991831772629413e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:50:45,644] [INFO] [timer.py:258:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=4.438063719566858, CurrSamplesPerSec=4.447513154549688, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:50:45,645] [INFO] [RANK 0]  iteration     3350/   10000 | elapsed time per iteration (ms): 1497.2 | learning rate 7.991E-05 | total loss 1.861924E+00 | loss 1.861924E+00 | loss scale 32768.0 |speed 160.30 samples/(min*GPU)
[2024-06-17 22:50:45,646] [INFO] [RANK 0] time (ms) | forward: 354.11 | backward: 549.89 | allreduce: 0.00 | optimizer: 4.86 | batch generator: 12.57 | data loader: 0.21
[2024-06-17 22:50:54,739] [INFO] [logging.py:96:log_dist] [Rank 0] step=3360, skipped=18, lr=[7.980047626764135e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:50:54,739] [INFO] [timer.py:258:stop] epoch=0/micro_step=3360/global_step=3360, RunningAvgSamplesPerSec=4.438094631571199, CurrSamplesPerSec=4.4469390546327405, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:51:03,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=3370, skipped=18, lr=[7.968239003830016e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:51:03,861] [INFO] [timer.py:258:stop] epoch=0/micro_step=3370/global_step=3370, RunningAvgSamplesPerSec=4.438120640271668, CurrSamplesPerSec=4.447513154549688, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:51:12,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=3380, skipped=18, lr=[7.9564060203734e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:51:12,973] [INFO] [timer.py:258:stop] epoch=0/micro_step=3380/global_step=3380, RunningAvgSamplesPerSec=4.438146550199236, CurrSamplesPerSec=4.445221177177553, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:51:22,120] [INFO] [logging.py:96:log_dist] [Rank 0] step=3390, skipped=18, lr=[7.944548793181054e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:51:22,121] [INFO] [timer.py:258:stop] epoch=0/micro_step=3390/global_step=3390, RunningAvgSamplesPerSec=4.4381570787737115, CurrSamplesPerSec=4.443727067503681, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:51:31,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=18, lr=[7.932667439279021e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:51:31,245] [INFO] [timer.py:258:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=4.438186378027964, CurrSamplesPerSec=4.4450951575131, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:51:31,246] [INFO] [RANK 0]  iteration     3400/   10000 | elapsed time per iteration (ms): 912.0 | learning rate 7.931E-05 | total loss 1.890723E+00 | loss 1.890723E+00 | loss scale 32768.0 |speed 263.15 samples/(min*GPU)
[2024-06-17 22:51:31,247] [INFO] [RANK 0] time (ms) | forward: 354.33 | backward: 552.25 | allreduce: 0.00 | optimizer: 4.69 | batch generator: 11.84 | data loader: 0.22
[2024-06-17 22:51:40,367] [INFO] [logging.py:96:log_dist] [Rank 0] step=3410, skipped=18, lr=[7.920762075931471e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:51:40,368] [INFO] [timer.py:258:stop] epoch=0/micro_step=3410/global_step=3410, RunningAvgSamplesPerSec=4.438208451275407, CurrSamplesPerSec=4.443618786542447, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:51:49,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=3420, skipped=18, lr=[7.908832820639534e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:51:49,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=3420/global_step=3420, RunningAvgSamplesPerSec=4.4382260527054775, CurrSamplesPerSec=4.445990405349218, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:51:58,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=3430, skipped=18, lr=[7.89687979114014e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:51:58,635] [INFO] [timer.py:258:stop] epoch=0/micro_step=3430/global_step=3430, RunningAvgSamplesPerSec=4.438240757462292, CurrSamplesPerSec=4.444865513883104, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:52:07,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=3440, skipped=18, lr=[7.884903105404869e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:52:07,757] [INFO] [timer.py:258:stop] epoch=0/micro_step=3440/global_step=3440, RunningAvgSamplesPerSec=4.43825837178607, CurrSamplesPerSec=4.445313046482692, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:52:16,890] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=18, lr=[7.872902881638772e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:52:16,890] [INFO] [timer.py:258:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=4.438257365024956, CurrSamplesPerSec=4.4425456780335795, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:52:16,892] [INFO] [RANK 0]  iteration     3450/   10000 | elapsed time per iteration (ms): 912.9 | learning rate 7.872E-05 | total loss 1.796855E+00 | loss 1.796855E+00 | loss scale 32768.0 |speed 262.89 samples/(min*GPU)
[2024-06-17 22:52:16,893] [INFO] [RANK 0] time (ms) | forward: 355.39 | backward: 552.06 | allreduce: 0.00 | optimizer: 4.72 | batch generator: 12.08 | data loader: 0.17
[2024-06-17 22:52:26,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=3460, skipped=18, lr=[7.860879238279212e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:52:26,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=3460/global_step=3460, RunningAvgSamplesPerSec=4.438272097346698, CurrSamplesPerSec=4.4436093710560725, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:52:35,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=3470, skipped=18, lr=[7.848832293994696e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:52:35,180] [INFO] [timer.py:258:stop] epoch=0/micro_step=3470/global_step=3470, RunningAvgSamplesPerSec=4.438280884729454, CurrSamplesPerSec=4.441260277743952, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:52:44,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=3480, skipped=18, lr=[7.8367621676837e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:52:44,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=3480/global_step=3480, RunningAvgSamplesPerSec=4.43830682664871, CurrSamplesPerSec=4.447183058457292, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:52:53,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=3490, skipped=18, lr=[7.8246689784735e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:52:53,443] [INFO] [timer.py:258:stop] epoch=0/micro_step=3490/global_step=3490, RunningAvgSamplesPerSec=4.4383358533818935, CurrSamplesPerSec=4.44998217589842, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:53:02,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=18, lr=[7.812552845718985e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:53:02,573] [INFO] [timer.py:258:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=4.438369004670234, CurrSamplesPerSec=4.452756456174872, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:53:02,575] [INFO] [RANK 0]  iteration     3500/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 7.811E-05 | total loss 1.848516E+00 | loss 1.848516E+00 | loss scale 32768.0 |speed 262.68 samples/(min*GPU)
[2024-06-17 22:53:02,576] [INFO] [RANK 0] time (ms) | forward: 356.26 | backward: 551.96 | allreduce: 0.00 | optimizer: 4.69 | batch generator: 13.44 | data loader: 0.22
[2024-06-17 22:53:11,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=3510, skipped=18, lr=[7.800413889001502e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:53:11,709] [INFO] [timer.py:258:stop] epoch=0/micro_step=3510/global_step=3510, RunningAvgSamplesPerSec=4.438403693566054, CurrSamplesPerSec=4.451140362862628, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:53:20,836] [INFO] [logging.py:96:log_dist] [Rank 0] step=3520, skipped=18, lr=[7.788252228127647e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:53:20,837] [INFO] [timer.py:258:stop] epoch=0/micro_step=3520/global_step=3520, RunningAvgSamplesPerSec=4.4384171284719045, CurrSamplesPerSec=4.427792571792023, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:53:29,979] [INFO] [logging.py:96:log_dist] [Rank 0] step=3530, skipped=18, lr=[7.776067983128106e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:53:29,980] [INFO] [timer.py:258:stop] epoch=0/micro_step=3530/global_step=3530, RunningAvgSamplesPerSec=4.438428435125111, CurrSamplesPerSec=4.449608048602663, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:53:39,107] [INFO] [logging.py:96:log_dist] [Rank 0] step=3540, skipped=18, lr=[7.763861274256458e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:53:39,108] [INFO] [timer.py:258:stop] epoch=0/micro_step=3540/global_step=3540, RunningAvgSamplesPerSec=4.438439831912906, CurrSamplesPerSec=4.4462967571365235, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:53:48,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=18, lr=[7.751632221987988e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:53:48,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=4.438456896868031, CurrSamplesPerSec=4.439488045793059, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:53:48,251] [INFO] [RANK 0]  iteration     3550/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 7.750E-05 | total loss 1.762256E+00 | loss 1.762256E+00 | loss scale 32768.0 |speed 262.72 samples/(min*GPU)
[2024-06-17 22:53:48,253] [INFO] [RANK 0] time (ms) | forward: 356.13 | backward: 551.91 | allreduce: 0.00 | optimizer: 4.70 | batch generator: 12.98 | data loader: 0.22
[2024-06-17 22:53:57,389] [INFO] [logging.py:96:log_dist] [Rank 0] step=3560, skipped=18, lr=[7.739380947018512e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:53:57,390] [INFO] [timer.py:258:stop] epoch=0/micro_step=3560/global_step=3560, RunningAvgSamplesPerSec=4.4384693173549215, CurrSamplesPerSec=4.4431668881997926, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:54:06,518] [INFO] [logging.py:96:log_dist] [Rank 0] step=3570, skipped=18, lr=[7.727107570263161e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:54:06,519] [INFO] [timer.py:258:stop] epoch=0/micro_step=3570/global_step=3570, RunningAvgSamplesPerSec=4.4384932867653255, CurrSamplesPerSec=4.4508333432817215, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:54:15,639] [INFO] [logging.py:96:log_dist] [Rank 0] step=3580, skipped=18, lr=[7.71481221285521e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:54:15,640] [INFO] [timer.py:258:stop] epoch=0/micro_step=3580/global_step=3580, RunningAvgSamplesPerSec=4.438511304764746, CurrSamplesPerSec=4.445932674547715, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:54:24,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=3590, skipped=18, lr=[7.702494996144878e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:54:24,765] [INFO] [timer.py:258:stop] epoch=0/micro_step=3590/global_step=3590, RunningAvgSamplesPerSec=4.438524003510223, CurrSamplesPerSec=4.445411986904261, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:54:33,925] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=18, lr=[7.690156041698113e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:54:33,926] [INFO] [timer.py:258:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=4.438510166939203, CurrSamplesPerSec=4.4407324559975585, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:54:33,927] [INFO] [RANK 0]  iteration     3600/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 7.689E-05 | total loss 1.838984E+00 | loss 1.838984E+00 | loss scale 32768.0 |speed 262.72 samples/(min*GPU)
[2024-06-17 22:54:33,928] [INFO] [RANK 0] time (ms) | forward: 355.64 | backward: 552.34 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 12.51 | data loader: 0.21
[2024-06-17 22:54:33,928] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:54:33,942] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/3600/mp_rank_00_model_states.pt
[2024-06-17 22:54:33,942] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/3600/mp_rank_00_model_states.pt...
[2024-06-17 22:55:01,227] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/3600/mp_rank_00_model_states.pt.
[2024-06-17 22:55:10,329] [INFO] [logging.py:96:log_dist] [Rank 0] step=3610, skipped=18, lr=[7.67779547129542e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:55:10,329] [INFO] [timer.py:258:stop] epoch=0/micro_step=3610/global_step=3610, RunningAvgSamplesPerSec=4.438595937767049, CurrSamplesPerSec=4.476615010729115, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:55:18,496] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 22:55:19,405] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 22:55:19,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=3620, skipped=20, lr=[7.666652577114196e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:55:19,408] [INFO] [timer.py:258:stop] epoch=0/micro_step=3620/global_step=3620, RunningAvgSamplesPerSec=4.438697369347718, CurrSamplesPerSec=4.472044815298957, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:55:28,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=3630, skipped=20, lr=[7.655492361901425e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:55:28,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=3630/global_step=3630, RunningAvgSamplesPerSec=4.43875296498488, CurrSamplesPerSec=4.457275451400595, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:55:37,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=3640, skipped=20, lr=[7.643071916505727e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:55:37,651] [INFO] [timer.py:258:stop] epoch=0/micro_step=3640/global_step=3640, RunningAvgSamplesPerSec=4.438777887675281, CurrSamplesPerSec=4.445982158000068, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:55:46,778] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=20, lr=[7.630630319855406e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:55:46,779] [INFO] [timer.py:258:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=4.438806038141913, CurrSamplesPerSec=4.454424577635609, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:55:46,780] [INFO] [RANK 0]  iteration     3650/   10000 | elapsed time per iteration (ms): 1457.1 | learning rate 7.629E-05 | total loss 1.858457E+00 | loss 1.858457E+00 | loss scale 32768.0 |speed 164.71 samples/(min*GPU)
[2024-06-17 22:55:46,781] [INFO] [RANK 0] time (ms) | forward: 355.43 | backward: 549.97 | allreduce: 0.00 | optimizer: 4.68 | batch generator: 13.50 | data loader: 0.19
[2024-06-17 22:55:55,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=3660, skipped=20, lr=[7.618167694743998e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:55:55,915] [INFO] [timer.py:258:stop] epoch=0/micro_step=3660/global_step=3660, RunningAvgSamplesPerSec=4.438825525285663, CurrSamplesPerSec=4.449958569793188, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:56:05,074] [INFO] [logging.py:96:log_dist] [Rank 0] step=3670, skipped=20, lr=[7.605684164172581e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:56:05,075] [INFO] [timer.py:258:stop] epoch=0/micro_step=3670/global_step=3670, RunningAvgSamplesPerSec=4.438835657718173, CurrSamplesPerSec=4.4446535562069105, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:56:14,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=3680, skipped=20, lr=[7.593179851348563e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:56:14,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=3680/global_step=3680, RunningAvgSamplesPerSec=4.438845021447952, CurrSamplesPerSec=4.441581264112236, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:56:23,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=3690, skipped=20, lr=[7.580654879684464e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:56:23,343] [INFO] [timer.py:258:stop] epoch=0/micro_step=3690/global_step=3690, RunningAvgSamplesPerSec=4.438849575956798, CurrSamplesPerSec=4.439379971316529, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:56:32,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=20, lr=[7.568109372796697e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:56:32,485] [INFO] [timer.py:258:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=4.438849464079023, CurrSamplesPerSec=4.435393119558438, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:56:32,486] [INFO] [RANK 0]  iteration     3700/   10000 | elapsed time per iteration (ms): 914.1 | learning rate 7.567E-05 | total loss 1.740010E+00 | loss 1.740010E+00 | loss scale 32768.0 |speed 262.55 samples/(min*GPU)
[2024-06-17 22:56:32,487] [INFO] [RANK 0] time (ms) | forward: 356.21 | backward: 552.38 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 13.11 | data loader: 0.18
[2024-06-17 22:56:41,626] [INFO] [logging.py:96:log_dist] [Rank 0] step=3710, skipped=20, lr=[7.555543454504348e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:56:41,627] [INFO] [timer.py:258:stop] epoch=0/micro_step=3710/global_step=3710, RunningAvgSamplesPerSec=4.43884211408586, CurrSamplesPerSec=4.437058815595332, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:56:50,745] [INFO] [logging.py:96:log_dist] [Rank 0] step=3720, skipped=20, lr=[7.542957248827961e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:56:50,745] [INFO] [timer.py:258:stop] epoch=0/micro_step=3720/global_step=3720, RunningAvgSamplesPerSec=4.438854592379991, CurrSamplesPerSec=4.444551117243031, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:56:59,879] [INFO] [logging.py:96:log_dist] [Rank 0] step=3730, skipped=20, lr=[7.530350879988304e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:56:59,880] [INFO] [timer.py:258:stop] epoch=0/micro_step=3730/global_step=3730, RunningAvgSamplesPerSec=4.438853630292952, CurrSamplesPerSec=4.443931874185663, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:57:09,013] [INFO] [logging.py:96:log_dist] [Rank 0] step=3740, skipped=20, lr=[7.517724472405146e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:57:09,013] [INFO] [timer.py:258:stop] epoch=0/micro_step=3740/global_step=3740, RunningAvgSamplesPerSec=4.43885259417989, CurrSamplesPerSec=4.442041072663517, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:57:18,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=20, lr=[7.505078150696035e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:57:18,141] [INFO] [timer.py:258:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=4.438870288815811, CurrSamplesPerSec=4.445559227828201, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:57:18,142] [INFO] [RANK 0]  iteration     3750/   10000 | elapsed time per iteration (ms): 913.1 | learning rate 7.504E-05 | total loss 1.755215E+00 | loss 1.755215E+00 | loss scale 32768.0 |speed 262.83 samples/(min*GPU)
[2024-06-17 22:57:18,143] [INFO] [RANK 0] time (ms) | forward: 355.27 | backward: 552.34 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 11.76 | data loader: 0.09
[2024-06-17 22:57:27,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=3760, skipped=20, lr=[7.492412039675058e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:57:27,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=3760/global_step=3760, RunningAvgSamplesPerSec=4.4388899867142735, CurrSamplesPerSec=4.4449397038458285, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:57:36,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=3770, skipped=20, lr=[7.479726264351618e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:57:36,372] [INFO] [timer.py:258:stop] epoch=0/micro_step=3770/global_step=3770, RunningAvgSamplesPerSec=4.43889700111395, CurrSamplesPerSec=4.4468777631938865, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:57:45,517] [INFO] [logging.py:96:log_dist] [Rank 0] step=3780, skipped=20, lr=[7.4670209499292e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:57:45,518] [INFO] [timer.py:258:stop] epoch=0/micro_step=3780/global_step=3780, RunningAvgSamplesPerSec=4.438905939330206, CurrSamplesPerSec=4.442546854403803, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:57:54,626] [INFO] [logging.py:96:log_dist] [Rank 0] step=3790, skipped=20, lr=[7.454296221804121e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:57:54,627] [INFO] [timer.py:258:stop] epoch=0/micro_step=3790/global_step=3790, RunningAvgSamplesPerSec=4.43892974419116, CurrSamplesPerSec=4.4502961609163085, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:58:03,755] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=20, lr=[7.441552205564317e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:58:03,756] [INFO] [timer.py:258:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=4.438949541529439, CurrSamplesPerSec=4.448476607948344, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:58:03,757] [INFO] [RANK 0]  iteration     3800/   10000 | elapsed time per iteration (ms): 912.3 | learning rate 7.440E-05 | total loss 1.744766E+00 | loss 1.744766E+00 | loss scale 32768.0 |speed 263.07 samples/(min*GPU)
[2024-06-17 22:58:03,758] [INFO] [RANK 0] time (ms) | forward: 354.47 | backward: 552.23 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 11.82 | data loader: 0.15
[2024-06-17 22:58:12,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=3810, skipped=20, lr=[7.428789026988078e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:58:12,873] [INFO] [timer.py:258:stop] epoch=0/micro_step=3810/global_step=3810, RunningAvgSamplesPerSec=4.438964948908326, CurrSamplesPerSec=4.445990405349218, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:58:22,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=3820, skipped=20, lr=[7.416006812042828e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:58:22,017] [INFO] [timer.py:258:stop] epoch=0/micro_step=3820/global_step=3820, RunningAvgSamplesPerSec=4.4389653479946505, CurrSamplesPerSec=4.442559794517374, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:58:31,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=3830, skipped=20, lr=[7.403205686883864e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:58:31,141] [INFO] [timer.py:258:stop] epoch=0/micro_step=3830/global_step=3830, RunningAvgSamplesPerSec=4.438967273531826, CurrSamplesPerSec=4.438479163861293, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:58:40,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=3840, skipped=20, lr=[7.39038577785313e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:58:40,280] [INFO] [timer.py:258:stop] epoch=0/micro_step=3840/global_step=3840, RunningAvgSamplesPerSec=4.438958003690009, CurrSamplesPerSec=4.429376550242033, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:58:49,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=20, lr=[7.377547211477944e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:58:49,428] [INFO] [timer.py:258:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=4.438962072371126, CurrSamplesPerSec=4.444784261051215, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:58:49,429] [INFO] [RANK 0]  iteration     3850/   10000 | elapsed time per iteration (ms): 913.4 | learning rate 7.376E-05 | total loss 1.578369E+00 | loss 1.578369E+00 | loss scale 32768.0 |speed 262.75 samples/(min*GPU)
[2024-06-17 22:58:49,430] [INFO] [RANK 0] time (ms) | forward: 355.73 | backward: 552.16 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 11.93 | data loader: 0.20
[2024-06-17 22:58:58,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=3860, skipped=20, lr=[7.36469011446978e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:58:58,564] [INFO] [timer.py:258:stop] epoch=0/micro_step=3860/global_step=3860, RunningAvgSamplesPerSec=4.438969527713158, CurrSamplesPerSec=4.4428703798596, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:59:07,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=3870, skipped=20, lr=[7.35181461372299e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:59:07,664] [INFO] [timer.py:258:stop] epoch=0/micro_step=3870/global_step=3870, RunningAvgSamplesPerSec=4.438988574288965, CurrSamplesPerSec=4.448342147532351, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:59:16,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=3880, skipped=20, lr=[7.338920836313572e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:59:16,789] [INFO] [timer.py:258:stop] epoch=0/micro_step=3880/global_step=3880, RunningAvgSamplesPerSec=4.43899660466807, CurrSamplesPerSec=4.444807812290953, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:59:25,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=3890, skipped=20, lr=[7.3260089094979e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:59:25,921] [INFO] [timer.py:258:stop] epoch=0/micro_step=3890/global_step=3890, RunningAvgSamplesPerSec=4.439022126683622, CurrSamplesPerSec=4.4516375882448775, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:59:35,066] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=20, lr=[7.313078960711483e-05], mom=[[0.9, 0.95]]
[2024-06-17 22:59:35,067] [INFO] [timer.py:258:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=4.4390278957219085, CurrSamplesPerSec=4.398124064457103, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 22:59:35,068] [INFO] [RANK 0]  iteration     3900/   10000 | elapsed time per iteration (ms): 912.8 | learning rate 7.312E-05 | total loss 1.711475E+00 | loss 1.711475E+00 | loss scale 32768.0 |speed 262.93 samples/(min*GPU)
[2024-06-17 22:59:35,068] [INFO] [RANK 0] time (ms) | forward: 355.14 | backward: 552.20 | allreduce: 0.00 | optimizer: 4.69 | batch generator: 12.17 | data loader: 0.09
[2024-06-17 22:59:35,069] [INFO] [RANK 0] Saving Model...
[2024-06-17 22:59:35,082] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/3900/mp_rank_00_model_states.pt
[2024-06-17 22:59:35,082] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/3900/mp_rank_00_model_states.pt...
[2024-06-17 23:00:03,283] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/3900/mp_rank_00_model_states.pt.
[2024-06-17 23:00:12,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=3910, skipped=20, lr=[7.300131117567692e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:00:12,386] [INFO] [timer.py:258:stop] epoch=0/micro_step=3910/global_step=3910, RunningAvgSamplesPerSec=4.439105731783186, CurrSamplesPerSec=4.483848518053291, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:00:21,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=3920, skipped=20, lr=[7.287165507856512e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:00:21,453] [INFO] [timer.py:258:stop] epoch=0/micro_step=3920/global_step=3920, RunningAvgSamplesPerSec=4.43920732979736, CurrSamplesPerSec=4.475679926712585, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:00:30,540] [INFO] [logging.py:96:log_dist] [Rank 0] step=3930, skipped=20, lr=[7.274182259543281e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:00:30,540] [INFO] [timer.py:258:stop] epoch=0/micro_step=3930/global_step=3930, RunningAvgSamplesPerSec=4.439281255854666, CurrSamplesPerSec=4.450414211856831, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:00:39,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=3940, skipped=20, lr=[7.261181500767411e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:00:39,632] [INFO] [timer.py:258:stop] epoch=0/micro_step=3940/global_step=3940, RunningAvgSamplesPerSec=4.439322381334317, CurrSamplesPerSec=4.448868240734848, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:00:48,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=20, lr=[7.248163359841149e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:00:48,738] [INFO] [timer.py:258:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=4.439354653354306, CurrSamplesPerSec=4.448940204860226, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:00:48,740] [INFO] [RANK 0]  iteration     3950/   10000 | elapsed time per iteration (ms): 1473.4 | learning rate 7.247E-05 | total loss 1.823115E+00 | loss 1.823115E+00 | loss scale 32768.0 |speed 162.88 samples/(min*GPU)
[2024-06-17 23:00:48,741] [INFO] [RANK 0] time (ms) | forward: 353.74 | backward: 549.60 | allreduce: 0.00 | optimizer: 4.81 | batch generator: 12.42 | data loader: 0.10
[2024-06-17 23:00:57,858] [INFO] [logging.py:96:log_dist] [Rank 0] step=3960, skipped=20, lr=[7.235127965248285e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:00:57,859] [INFO] [timer.py:258:stop] epoch=0/micro_step=3960/global_step=3960, RunningAvgSamplesPerSec=4.439374283347565, CurrSamplesPerSec=4.441926993632269, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:01:06,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=3970, skipped=20, lr=[7.222075445642905e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:01:06,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=3970/global_step=3970, RunningAvgSamplesPerSec=4.439386487206728, CurrSamplesPerSec=4.45585606737055, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:01:16,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=3980, skipped=20, lr=[7.209005929848107e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:01:16,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=3980/global_step=3980, RunningAvgSamplesPerSec=4.439399145369781, CurrSamplesPerSec=4.449034587569965, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:01:25,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=3990, skipped=20, lr=[7.195919546854733e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:01:25,283] [INFO] [timer.py:258:stop] epoch=0/micro_step=3990/global_step=3990, RunningAvgSamplesPerSec=4.439403444995676, CurrSamplesPerSec=4.442872732944601, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:01:34,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=20, lr=[7.182816425820103e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:01:34,411] [INFO] [timer.py:258:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=4.439416113870983, CurrSamplesPerSec=4.435416571382797, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:01:34,413] [INFO] [RANK 0]  iteration     4000/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 7.182E-05 | total loss 1.745488E+00 | loss 1.745488E+00 | loss scale 32768.0 |speed 262.74 samples/(min*GPU)
[2024-06-17 23:01:34,414] [INFO] [RANK 0] time (ms) | forward: 355.77 | backward: 552.04 | allreduce: 0.00 | optimizer: 4.89 | batch generator: 12.70 | data loader: 0.10
[2024-06-17 23:01:41,058] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 23:01:41,058] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 23:01:41,058] [INFO] [RANK 0]  validation loss at iteration 4000 | loss: 2.140918E+00 | PPL: 8.507243E+00 loss 2.142578E+00 |
[2024-06-17 23:01:41,058] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 23:01:50,164] [INFO] [logging.py:96:log_dist] [Rank 0] step=4010, skipped=20, lr=[7.16969669606673e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:01:50,165] [INFO] [timer.py:258:stop] epoch=0/micro_step=4010/global_step=4010, RunningAvgSamplesPerSec=4.439435097622494, CurrSamplesPerSec=4.447952965829387, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:01:59,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=4020, skipped=20, lr=[7.156560487081053e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:01:59,290] [INFO] [timer.py:258:stop] epoch=0/micro_step=4020/global_step=4020, RunningAvgSamplesPerSec=4.4394487551290105, CurrSamplesPerSec=4.445972732495648, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:02:00,203] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 23:02:01,115] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 23:02:08,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=4030, skipped=22, lr=[7.146039741963997e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:02:08,397] [INFO] [timer.py:258:stop] epoch=0/micro_step=4030/global_step=4030, RunningAvgSamplesPerSec=4.439459662668038, CurrSamplesPerSec=4.445786586971948, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:02:17,544] [INFO] [logging.py:96:log_dist] [Rank 0] step=4040, skipped=22, lr=[7.132874197184328e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:02:17,544] [INFO] [timer.py:258:stop] epoch=0/micro_step=4040/global_step=4040, RunningAvgSamplesPerSec=4.439483538802808, CurrSamplesPerSec=4.445963307031193, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:02:26,682] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=22, lr=[7.11969253659555e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:02:26,682] [INFO] [timer.py:258:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=4.439487346108123, CurrSamplesPerSec=4.440366933626937, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:02:26,684] [INFO] [RANK 0]  iteration     4050/   10000 | elapsed time per iteration (ms): 1045.4 | learning rate 7.118E-05 | total loss 1.754707E+00 | loss 1.754707E+00 | loss scale 32768.0 |speed 229.57 samples/(min*GPU)
[2024-06-17 23:02:26,685] [INFO] [RANK 0] time (ms) | forward: 354.94 | backward: 552.18 | allreduce: 0.00 | optimizer: 4.65 | batch generator: 14.49 | data loader: 0.20
[2024-06-17 23:02:35,820] [INFO] [logging.py:96:log_dist] [Rank 0] step=4060, skipped=22, lr=[7.10649489029533e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:02:35,821] [INFO] [timer.py:258:stop] epoch=0/micro_step=4060/global_step=4060, RunningAvgSamplesPerSec=4.439488483791751, CurrSamplesPerSec=4.438079965886188, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:02:44,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=4070, skipped=22, lr=[7.093281388539112e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:02:44,929] [INFO] [timer.py:258:stop] epoch=0/micro_step=4070/global_step=4070, RunningAvgSamplesPerSec=4.439487766255434, CurrSamplesPerSec=4.437335770834673, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:02:54,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=4080, skipped=22, lr=[7.080052161738823e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:02:54,053] [INFO] [timer.py:258:stop] epoch=0/micro_step=4080/global_step=4080, RunningAvgSamplesPerSec=4.439502669447983, CurrSamplesPerSec=4.446755185384657, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:03:03,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=4090, skipped=22, lr=[7.06680734046159e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:03:03,172] [INFO] [timer.py:258:stop] epoch=0/micro_step=4090/global_step=4090, RunningAvgSamplesPerSec=4.439522257236105, CurrSamplesPerSec=4.451399000683475, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:03:12,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=22, lr=[7.053547055428453e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:03:12,311] [INFO] [timer.py:258:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=4.4395344469425595, CurrSamplesPerSec=4.450476781394663, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:03:12,313] [INFO] [RANK 0]  iteration     4100/   10000 | elapsed time per iteration (ms): 912.6 | learning rate 7.052E-05 | total loss 1.694443E+00 | loss 1.694443E+00 | loss scale 32768.0 |speed 262.99 samples/(min*GPU)
[2024-06-17 23:03:12,314] [INFO] [RANK 0] time (ms) | forward: 354.72 | backward: 552.27 | allreduce: 0.00 | optimizer: 4.84 | batch generator: 11.69 | data loader: 0.10
[2024-06-17 23:03:21,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=4110, skipped=22, lr=[7.04027143751307e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:03:21,436] [INFO] [timer.py:258:stop] epoch=0/micro_step=4110/global_step=4110, RunningAvgSamplesPerSec=4.439532562674326, CurrSamplesPerSec=4.441768233598472, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:03:30,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=4120, skipped=22, lr=[7.026980617740433e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:03:30,574] [INFO] [timer.py:258:stop] epoch=0/micro_step=4120/global_step=4120, RunningAvgSamplesPerSec=4.439543979829904, CurrSamplesPerSec=4.44319865929789, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:03:39,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=4130, skipped=22, lr=[7.013674727285566e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:03:39,720] [INFO] [timer.py:258:stop] epoch=0/micro_step=4130/global_step=4130, RunningAvgSamplesPerSec=4.439544467862238, CurrSamplesPerSec=4.448619333598669, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:03:48,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=4140, skipped=22, lr=[7.000353897472236e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:03:48,845] [INFO] [timer.py:258:stop] epoch=0/micro_step=4140/global_step=4140, RunningAvgSamplesPerSec=4.4395544838204914, CurrSamplesPerSec=4.4437070586677265, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:03:57,974] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=22, lr=[6.987018259771655e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:03:57,975] [INFO] [timer.py:258:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=4.4395630006011935, CurrSamplesPerSec=4.443758846613495, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:03:57,977] [INFO] [RANK 0]  iteration     4150/   10000 | elapsed time per iteration (ms): 913.3 | learning rate 6.986E-05 | total loss 1.653213E+00 | loss 1.653213E+00 | loss scale 32768.0 |speed 262.79 samples/(min*GPU)
[2024-06-17 23:03:57,979] [INFO] [RANK 0] time (ms) | forward: 355.35 | backward: 552.27 | allreduce: 0.00 | optimizer: 4.90 | batch generator: 12.16 | data loader: 0.10
[2024-06-17 23:04:07,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=4160, skipped=22, lr=[6.973667945801184e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:04:07,126] [INFO] [timer.py:258:stop] epoch=0/micro_step=4160/global_step=4160, RunningAvgSamplesPerSec=4.439555701529336, CurrSamplesPerSec=4.441350807663158, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:04:16,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=4170, skipped=22, lr=[6.96030308732303e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:04:16,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=4170/global_step=4170, RunningAvgSamplesPerSec=4.439559923520807, CurrSamplesPerSec=4.439733582366623, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:04:25,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=4180, skipped=22, lr=[6.946923816242954e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:04:25,390] [INFO] [timer.py:258:stop] epoch=0/micro_step=4180/global_step=4180, RunningAvgSamplesPerSec=4.439566167276948, CurrSamplesPerSec=4.441041610306197, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:04:34,532] [INFO] [logging.py:96:log_dist] [Rank 0] step=4190, skipped=22, lr=[6.933530264608959e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:04:34,533] [INFO] [timer.py:258:stop] epoch=0/micro_step=4190/global_step=4190, RunningAvgSamplesPerSec=4.439568704529286, CurrSamplesPerSec=4.435549078849548, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:04:43,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=22, lr=[6.92012256460999e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:04:43,652] [INFO] [timer.py:258:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=4.4395794118607546, CurrSamplesPerSec=4.447030994959018, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:04:43,654] [INFO] [RANK 0]  iteration     4200/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 6.919E-05 | total loss 1.596367E+00 | loss 1.596367E+00 | loss scale 32768.0 |speed 262.72 samples/(min*GPU)
[2024-06-17 23:04:43,655] [INFO] [RANK 0] time (ms) | forward: 355.74 | backward: 552.19 | allreduce: 0.00 | optimizer: 4.82 | batch generator: 12.19 | data loader: 0.10
[2024-06-17 23:04:43,656] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:04:43,671] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/4200/mp_rank_00_model_states.pt
[2024-06-17 23:04:43,671] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/4200/mp_rank_00_model_states.pt...
[2024-06-17 23:05:06,944] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/4200/mp_rank_00_model_states.pt.
[2024-06-17 23:05:16,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=4210, skipped=22, lr=[6.906700848574636e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:05:16,061] [INFO] [timer.py:258:stop] epoch=0/micro_step=4210/global_step=4210, RunningAvgSamplesPerSec=4.43965032455924, CurrSamplesPerSec=4.474625888005906, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:05:25,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=4220, skipped=22, lr=[6.893265248969816e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:05:25,153] [INFO] [timer.py:258:stop] epoch=0/micro_step=4220/global_step=4220, RunningAvgSamplesPerSec=4.439731351542028, CurrSamplesPerSec=4.482426533315059, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:05:34,248] [INFO] [logging.py:96:log_dist] [Rank 0] step=4230, skipped=22, lr=[6.87981589839947e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:05:34,249] [INFO] [timer.py:258:stop] epoch=0/micro_step=4230/global_step=4230, RunningAvgSamplesPerSec=4.4397787307171575, CurrSamplesPerSec=4.463072454761995, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:05:43,331] [INFO] [logging.py:96:log_dist] [Rank 0] step=4240, skipped=22, lr=[6.866352929603261e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:05:43,331] [INFO] [timer.py:258:stop] epoch=0/micro_step=4240/global_step=4240, RunningAvgSamplesPerSec=4.439828246037011, CurrSamplesPerSec=4.454700156630732, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:05:52,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=22, lr=[6.852876475455258e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:05:52,458] [INFO] [timer.py:258:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=4.439858300551626, CurrSamplesPerSec=4.455714060349622, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:05:52,460] [INFO] [RANK 0]  iteration     4250/   10000 | elapsed time per iteration (ms): 1376.1 | learning rate 6.852E-05 | total loss 1.669805E+00 | loss 1.669805E+00 | loss scale 32768.0 |speed 174.40 samples/(min*GPU)
[2024-06-17 23:05:52,461] [INFO] [RANK 0] time (ms) | forward: 354.58 | backward: 549.51 | allreduce: 0.00 | optimizer: 5.20 | batch generator: 12.83 | data loader: 0.12
[2024-06-17 23:06:01,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=4260, skipped=22, lr=[6.839386668962619e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:06:01,589] [INFO] [timer.py:258:stop] epoch=0/micro_step=4260/global_step=4260, RunningAvgSamplesPerSec=4.439885111056353, CurrSamplesPerSec=4.433257698250105, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:06:10,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=4270, skipped=22, lr=[6.82588364326429e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:06:10,721] [INFO] [timer.py:258:stop] epoch=0/micro_step=4270/global_step=4270, RunningAvgSamplesPerSec=4.4399059629482105, CurrSamplesPerSec=4.454118287348922, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:06:19,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=4280, skipped=22, lr=[6.812367531629683e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:06:19,838] [INFO] [timer.py:258:stop] epoch=0/micro_step=4280/global_step=4280, RunningAvgSamplesPerSec=4.439921783065175, CurrSamplesPerSec=4.442189266546459, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:06:28,986] [INFO] [logging.py:96:log_dist] [Rank 0] step=4290, skipped=22, lr=[6.798838467457363e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:06:28,986] [INFO] [timer.py:258:stop] epoch=0/micro_step=4290/global_step=4290, RunningAvgSamplesPerSec=4.439937350846524, CurrSamplesPerSec=4.436923871120618, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:06:38,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=22, lr=[6.785296584273732e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:06:38,134] [INFO] [timer.py:258:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=4.439954086630189, CurrSamplesPerSec=4.454662306851839, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:06:38,136] [INFO] [RANK 0]  iteration     4300/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 6.784E-05 | total loss 1.749512E+00 | loss 1.749512E+00 | loss scale 32768.0 |speed 262.72 samples/(min*GPU)
[2024-06-17 23:06:38,138] [INFO] [RANK 0] time (ms) | forward: 356.36 | backward: 551.62 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 13.68 | data loader: 0.19
[2024-06-17 23:06:47,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=4310, skipped=22, lr=[6.771742015731709e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:06:47,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=4310/global_step=4310, RunningAvgSamplesPerSec=4.4399739458381715, CurrSamplesPerSec=4.451413173487462, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:06:56,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=4320, skipped=22, lr=[6.758174895609414e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:06:56,417] [INFO] [timer.py:258:stop] epoch=0/micro_step=4320/global_step=4320, RunningAvgSamplesPerSec=4.439979917015749, CurrSamplesPerSec=4.438377009307324, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:07:05,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=4330, skipped=22, lr=[6.744595357808844e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:07:05,543] [INFO] [timer.py:258:stop] epoch=0/micro_step=4330/global_step=4330, RunningAvgSamplesPerSec=4.439988288293176, CurrSamplesPerSec=4.437920306801646, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:07:14,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=4340, skipped=22, lr=[6.731003536354558e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:07:14,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=4340/global_step=4340, RunningAvgSamplesPerSec=4.440000924814187, CurrSamplesPerSec=4.426704900605567, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:07:23,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=22, lr=[6.717399565392343e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:07:23,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=4.44000094688016, CurrSamplesPerSec=4.434618176281798, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:07:23,835] [INFO] [RANK 0]  iteration     4350/   10000 | elapsed time per iteration (ms): 914.0 | learning rate 6.716E-05 | total loss 1.572119E+00 | loss 1.572119E+00 | loss scale 32768.0 |speed 262.59 samples/(min*GPU)
[2024-06-17 23:07:23,836] [INFO] [RANK 0] time (ms) | forward: 356.35 | backward: 552.04 | allreduce: 0.00 | optimizer: 4.85 | batch generator: 13.28 | data loader: 0.19
[2024-06-17 23:07:32,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=4360, skipped=22, lr=[6.703783579187901e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:07:32,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=4360/global_step=4360, RunningAvgSamplesPerSec=4.440006088746333, CurrSamplesPerSec=4.443452844440631, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:07:42,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=4370, skipped=22, lr=[6.69015571212552e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:07:42,136] [INFO] [timer.py:258:stop] epoch=0/micro_step=4370/global_step=4370, RunningAvgSamplesPerSec=4.44000814496214, CurrSamplesPerSec=4.433153441099562, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:07:51,269] [INFO] [logging.py:96:log_dist] [Rank 0] step=4380, skipped=22, lr=[6.676516098706746e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:07:51,269] [INFO] [timer.py:258:stop] epoch=0/micro_step=4380/global_step=4380, RunningAvgSamplesPerSec=4.440002885585772, CurrSamplesPerSec=4.4270494861606675, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:08:00,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=4390, skipped=22, lr=[6.662864873549055e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:08:00,409] [INFO] [timer.py:258:stop] epoch=0/micro_step=4390/global_step=4390, RunningAvgSamplesPerSec=4.439990120218218, CurrSamplesPerSec=4.444334480274927, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:08:09,544] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=22, lr=[6.649202171384532e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:08:09,544] [INFO] [timer.py:258:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=4.4399903888862955, CurrSamplesPerSec=4.445695876131581, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:08:09,546] [INFO] [RANK 0]  iteration     4400/   10000 | elapsed time per iteration (ms): 914.2 | learning rate 6.648E-05 | total loss 1.618682E+00 | loss 1.618682E+00 | loss scale 32768.0 |speed 262.52 samples/(min*GPU)
[2024-06-17 23:08:09,546] [INFO] [RANK 0] time (ms) | forward: 356.16 | backward: 552.40 | allreduce: 0.00 | optimizer: 4.91 | batch generator: 12.57 | data loader: 0.21
[2024-06-17 23:08:18,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=4410, skipped=22, lr=[6.63552812705853e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:08:18,659] [INFO] [timer.py:258:stop] epoch=0/micro_step=4410/global_step=4410, RunningAvgSamplesPerSec=4.4399950280007205, CurrSamplesPerSec=4.441921113428636, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:08:27,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=4420, skipped=22, lr=[6.621842875528342e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:08:27,791] [INFO] [timer.py:258:stop] epoch=0/micro_step=4420/global_step=4420, RunningAvgSamplesPerSec=4.439996700060116, CurrSamplesPerSec=4.43775244235916, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:08:30,524] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 23:08:31,435] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 23:08:36,893] [INFO] [logging.py:96:log_dist] [Rank 0] step=4430, skipped=24, lr=[6.610886695879134e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:08:36,894] [INFO] [timer.py:258:stop] epoch=0/micro_step=4430/global_step=4430, RunningAvgSamplesPerSec=4.4400089779973335, CurrSamplesPerSec=4.442653906702026, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:08:46,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=4440, skipped=24, lr=[6.597181611826025e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:08:46,052] [INFO] [timer.py:258:stop] epoch=0/micro_step=4440/global_step=4440, RunningAvgSamplesPerSec=4.440002321052626, CurrSamplesPerSec=4.444180257042333, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:08:55,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=24, lr=[6.583465699033356e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:08:55,223] [INFO] [timer.py:258:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=4.440002333671781, CurrSamplesPerSec=4.4412461695175125, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:08:55,225] [INFO] [RANK 0]  iteration     4450/   10000 | elapsed time per iteration (ms): 913.6 | learning rate 6.582E-05 | total loss 1.685811E+00 | loss 1.685811E+00 | loss scale 32768.0 |speed 262.70 samples/(min*GPU)
[2024-06-17 23:08:55,226] [INFO] [RANK 0] time (ms) | forward: 355.69 | backward: 552.41 | allreduce: 0.00 | optimizer: 4.72 | batch generator: 12.31 | data loader: 0.22
[2024-06-17 23:09:04,367] [INFO] [logging.py:96:log_dist] [Rank 0] step=4460, skipped=24, lr=[6.569739092871651e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:09:04,368] [INFO] [timer.py:258:stop] epoch=0/micro_step=4460/global_step=4460, RunningAvgSamplesPerSec=4.440002710760444, CurrSamplesPerSec=4.439335333394369, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:09:13,522] [INFO] [logging.py:96:log_dist] [Rank 0] step=4470, skipped=24, lr=[6.556001928816972e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:09:13,522] [INFO] [timer.py:258:stop] epoch=0/micro_step=4470/global_step=4470, RunningAvgSamplesPerSec=4.44001257315711, CurrSamplesPerSec=4.438303038255367, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:09:22,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=4480, skipped=24, lr=[6.54225434244958e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:09:22,645] [INFO] [timer.py:258:stop] epoch=0/micro_step=4480/global_step=4480, RunningAvgSamplesPerSec=4.440018054318697, CurrSamplesPerSec=4.449504201076704, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:09:31,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=4490, skipped=24, lr=[6.528496469452602e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:09:31,782] [INFO] [timer.py:258:stop] epoch=0/micro_step=4490/global_step=4490, RunningAvgSamplesPerSec=4.44002806328423, CurrSamplesPerSec=4.443115114050492, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:09:40,901] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
[2024-06-17 23:09:40,901] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=25, lr=[6.514728445610694e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:09:40,903] [INFO] [timer.py:258:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=4.440032113140403, CurrSamplesPerSec=4.443383411352636, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:09:40,904] [INFO] [RANK 0]  iteration     4500/   10000 | elapsed time per iteration (ms): 913.6 | learning rate 6.515E-05 | total loss 1.518438E+00 | loss 1.518438E+00 | loss scale 16384.0 |speed 262.70 samples/(min*GPU)
[2024-06-17 23:09:40,905] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 552.42 | allreduce: 0.00 | optimizer: 4.73 | batch generator: 12.69 | data loader: 0.21
[2024-06-17 23:09:40,905] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:09:40,923] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/4500/mp_rank_00_model_states.pt
[2024-06-17 23:09:40,923] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/4500/mp_rank_00_model_states.pt...
[2024-06-17 23:10:06,892] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/4500/mp_rank_00_model_states.pt.
[2024-06-17 23:10:15,993] [INFO] [logging.py:96:log_dist] [Rank 0] step=4510, skipped=25, lr=[6.502328657487327e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:10:15,993] [INFO] [timer.py:258:stop] epoch=0/micro_step=4510/global_step=4510, RunningAvgSamplesPerSec=4.440096596362649, CurrSamplesPerSec=4.4768252494282965, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:10:25,065] [INFO] [logging.py:96:log_dist] [Rank 0] step=4520, skipped=25, lr=[6.488541721484493e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:10:25,066] [INFO] [timer.py:258:stop] epoch=0/micro_step=4520/global_step=4520, RunningAvgSamplesPerSec=4.440177913144457, CurrSamplesPerSec=4.483103271177627, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:10:34,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=4530, skipped=25, lr=[6.474745028973957e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:10:34,160] [INFO] [timer.py:258:stop] epoch=0/micro_step=4530/global_step=4530, RunningAvgSamplesPerSec=4.440234481248246, CurrSamplesPerSec=4.461906864179144, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:10:43,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=4540, skipped=25, lr=[6.460938716123508e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:10:43,280] [INFO] [timer.py:258:stop] epoch=0/micro_step=4540/global_step=4540, RunningAvgSamplesPerSec=4.4402626766711695, CurrSamplesPerSec=4.457900788074014, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:10:52,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=25, lr=[6.447122919195876e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:10:52,407] [INFO] [timer.py:258:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=4.440295075271536, CurrSamplesPerSec=4.452827364324811, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:10:52,411] [INFO] [RANK 0]  iteration     4550/   10000 | elapsed time per iteration (ms): 1430.1 | learning rate 6.446E-05 | total loss 1.559785E+00 | loss 1.559785E+00 | loss scale 16384.0 |speed 167.82 samples/(min*GPU)
[2024-06-17 23:10:52,413] [INFO] [RANK 0] time (ms) | forward: 354.90 | backward: 549.56 | allreduce: 0.00 | optimizer: 4.95 | batch generator: 13.39 | data loader: 0.20
[2024-06-17 23:11:01,527] [INFO] [logging.py:96:log_dist] [Rank 0] step=4560, skipped=25, lr=[6.433297774547401e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:11:01,527] [INFO] [timer.py:258:stop] epoch=0/micro_step=4560/global_step=4560, RunningAvgSamplesPerSec=4.440303920441657, CurrSamplesPerSec=4.451859663014192, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:11:10,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=4570, skipped=25, lr=[6.41946341862668e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:11:10,652] [INFO] [timer.py:258:stop] epoch=0/micro_step=4570/global_step=4570, RunningAvgSamplesPerSec=4.4403199614879565, CurrSamplesPerSec=4.4361132036458315, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:11:19,775] [INFO] [logging.py:96:log_dist] [Rank 0] step=4580, skipped=25, lr=[6.405619987973218e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:11:19,776] [INFO] [timer.py:258:stop] epoch=0/micro_step=4580/global_step=4580, RunningAvgSamplesPerSec=4.440319601510128, CurrSamplesPerSec=4.449231624382229, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:11:28,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=4590, skipped=25, lr=[6.391767619216089e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:11:28,931] [INFO] [timer.py:258:stop] epoch=0/micro_step=4590/global_step=4590, RunningAvgSamplesPerSec=4.440320806864477, CurrSamplesPerSec=4.444004855841221, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:11:38,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=25, lr=[6.377906449072578e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:11:38,087] [INFO] [timer.py:258:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=4.440334428832485, CurrSamplesPerSec=4.441470736096062, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:11:38,088] [INFO] [RANK 0]  iteration     4600/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 6.377E-05 | total loss 1.670879E+00 | loss 1.670879E+00 | loss scale 16384.0 |speed 262.71 samples/(min*GPU)
[2024-06-17 23:11:38,089] [INFO] [RANK 0] time (ms) | forward: 355.99 | backward: 552.01 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 12.86 | data loader: 0.20
[2024-06-17 23:11:47,213] [INFO] [logging.py:96:log_dist] [Rank 0] step=4610, skipped=25, lr=[6.364036614346842e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:11:47,214] [INFO] [timer.py:258:stop] epoch=0/micro_step=4610/global_step=4610, RunningAvgSamplesPerSec=4.4403302910508655, CurrSamplesPerSec=4.430276006048145, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:11:56,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=4620, skipped=25, lr=[6.350158251928545e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:11:56,343] [INFO] [timer.py:258:stop] epoch=0/micro_step=4620/global_step=4620, RunningAvgSamplesPerSec=4.440332821058669, CurrSamplesPerSec=4.446963807423527, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:12:05,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=4630, skipped=25, lr=[6.336271498791526e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:12:05,475] [INFO] [timer.py:258:stop] epoch=0/micro_step=4630/global_step=4630, RunningAvgSamplesPerSec=4.440336505432416, CurrSamplesPerSec=4.435856339012771, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:12:14,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=4640, skipped=25, lr=[6.32237649199243e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:12:14,616] [INFO] [timer.py:258:stop] epoch=0/micro_step=4640/global_step=4640, RunningAvgSamplesPerSec=4.440345333113654, CurrSamplesPerSec=4.4432904450225035, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:12:23,750] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=25, lr=[6.308473368669368e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:12:23,751] [INFO] [timer.py:258:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=4.440356819659201, CurrSamplesPerSec=4.444857270706788, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:12:23,752] [INFO] [RANK 0]  iteration     4650/   10000 | elapsed time per iteration (ms): 913.3 | learning rate 6.307E-05 | total loss 1.646104E+00 | loss 1.646104E+00 | loss scale 16384.0 |speed 262.79 samples/(min*GPU)
[2024-06-17 23:12:23,753] [INFO] [RANK 0] time (ms) | forward: 355.25 | backward: 552.46 | allreduce: 0.00 | optimizer: 4.82 | batch generator: 12.25 | data loader: 0.21
[2024-06-17 23:12:32,881] [INFO] [logging.py:96:log_dist] [Rank 0] step=4660, skipped=25, lr=[6.294562266040548e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:12:32,881] [INFO] [timer.py:258:stop] epoch=0/micro_step=4660/global_step=4660, RunningAvgSamplesPerSec=4.440350458204448, CurrSamplesPerSec=4.443695288848394, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:12:41,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=4670, skipped=25, lr=[6.280643321402941e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:12:41,989] [INFO] [timer.py:258:stop] epoch=0/micro_step=4670/global_step=4670, RunningAvgSamplesPerSec=4.440354515592614, CurrSamplesPerSec=4.420060816218783, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:12:51,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=4680, skipped=25, lr=[6.26671667213091e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:12:51,128] [INFO] [timer.py:258:stop] epoch=0/micro_step=4680/global_step=4680, RunningAvgSamplesPerSec=4.440353933933249, CurrSamplesPerSec=4.432655651530167, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:13:00,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=4690, skipped=25, lr=[6.25278245567486e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:13:00,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=4690/global_step=4690, RunningAvgSamplesPerSec=4.440350254792564, CurrSamplesPerSec=4.430766240409747, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:13:09,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=25, lr=[6.238840809559884e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:13:09,412] [INFO] [timer.py:258:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=4.440353108993215, CurrSamplesPerSec=4.4449397038458285, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:13:09,414] [INFO] [RANK 0]  iteration     4700/   10000 | elapsed time per iteration (ms): 913.2 | learning rate 6.237E-05 | total loss 1.654717E+00 | loss 1.654717E+00 | loss scale 16384.0 |speed 262.80 samples/(min*GPU)
[2024-06-17 23:13:09,415] [INFO] [RANK 0] time (ms) | forward: 355.51 | backward: 552.20 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 11.78 | data loader: 0.20
[2024-06-17 23:13:18,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=4710, skipped=25, lr=[6.224891871384399e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:13:18,557] [INFO] [timer.py:258:stop] epoch=0/micro_step=4710/global_step=4710, RunningAvgSamplesPerSec=4.440360526859891, CurrSamplesPerSec=4.445910289538267, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:13:27,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=4720, skipped=25, lr=[6.210935778818795e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:13:27,704] [INFO] [timer.py:258:stop] epoch=0/micro_step=4720/global_step=4720, RunningAvgSamplesPerSec=4.44036756009356, CurrSamplesPerSec=4.444987987532892, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:13:36,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=4730, skipped=25, lr=[6.19697266960407e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:13:36,829] [INFO] [timer.py:258:stop] epoch=0/micro_step=4730/global_step=4730, RunningAvgSamplesPerSec=4.440382198069403, CurrSamplesPerSec=4.446831795723495, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:13:45,944] [INFO] [logging.py:96:log_dist] [Rank 0] step=4740, skipped=25, lr=[6.183002681550477e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:13:45,944] [INFO] [timer.py:258:stop] epoch=0/micro_step=4740/global_step=4740, RunningAvgSamplesPerSec=4.440390927963718, CurrSamplesPerSec=4.447574463505148, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:13:55,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=25, lr=[6.169025952536154e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:13:55,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=4.440400039678663, CurrSamplesPerSec=4.444433377140431, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:13:55,057] [INFO] [RANK 0]  iteration     4750/   10000 | elapsed time per iteration (ms): 912.9 | learning rate 6.168E-05 | total loss 1.576523E+00 | loss 1.576523E+00 | loss scale 16384.0 |speed 262.91 samples/(min*GPU)
[2024-06-17 23:13:55,058] [INFO] [RANK 0] time (ms) | forward: 355.04 | backward: 552.39 | allreduce: 0.00 | optimizer: 4.69 | batch generator: 12.40 | data loader: 0.21
[2024-06-17 23:14:04,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=4760, skipped=25, lr=[6.155042620505778e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:14:04,182] [INFO] [timer.py:258:stop] epoch=0/micro_step=4760/global_step=4760, RunningAvgSamplesPerSec=4.440405463668801, CurrSamplesPerSec=4.444547584949187, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:14:13,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=4770, skipped=25, lr=[6.141052823469188e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:14:13,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=4770/global_step=4770, RunningAvgSamplesPerSec=4.440399436434915, CurrSamplesPerSec=4.4393247613863895, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:14:22,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=4780, skipped=25, lr=[6.127056699500034e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:14:22,475] [INFO] [timer.py:258:stop] epoch=0/micro_step=4780/global_step=4780, RunningAvgSamplesPerSec=4.440402088566552, CurrSamplesPerSec=4.40023384383292, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:14:31,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=4790, skipped=25, lr=[6.113054386734407e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:14:31,635] [INFO] [timer.py:258:stop] epoch=0/micro_step=4790/global_step=4790, RunningAvgSamplesPerSec=4.440413665413731, CurrSamplesPerSec=4.433828270847736, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:14:40,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=25, lr=[6.099046023369486e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:14:40,780] [INFO] [timer.py:258:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=4.440418470817587, CurrSamplesPerSec=4.440359882340051, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:14:40,785] [INFO] [RANK 0]  iteration     4800/   10000 | elapsed time per iteration (ms): 914.6 | learning rate 6.098E-05 | total loss 1.608262E+00 | loss 1.608262E+00 | loss scale 16384.0 |speed 262.42 samples/(min*GPU)
[2024-06-17 23:14:40,789] [INFO] [RANK 0] time (ms) | forward: 356.49 | backward: 552.20 | allreduce: 0.00 | optimizer: 5.12 | batch generator: 13.17 | data loader: 0.20
[2024-06-17 23:14:40,793] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:14:40,810] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/4800/mp_rank_00_model_states.pt
[2024-06-17 23:14:40,810] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/4800/mp_rank_00_model_states.pt...
[2024-06-17 23:15:03,192] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/4800/mp_rank_00_model_states.pt.
[2024-06-17 23:15:12,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=4810, skipped=25, lr=[6.0850317476621586e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:15:12,295] [INFO] [timer.py:258:stop] epoch=0/micro_step=4810/global_step=4810, RunningAvgSamplesPerSec=4.44047644776813, CurrSamplesPerSec=4.453521201535366, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:15:21,373] [INFO] [logging.py:96:log_dist] [Rank 0] step=4820, skipped=25, lr=[6.071011697927667e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:15:21,373] [INFO] [timer.py:258:stop] epoch=0/micro_step=4820/global_step=4820, RunningAvgSamplesPerSec=4.440545168755175, CurrSamplesPerSec=4.4726921890583204, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:15:30,475] [INFO] [logging.py:96:log_dist] [Rank 0] step=4830, skipped=25, lr=[6.0569860125382447e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:15:30,476] [INFO] [timer.py:258:stop] epoch=0/micro_step=4830/global_step=4830, RunningAvgSamplesPerSec=4.4405874166702475, CurrSamplesPerSec=4.452017963874821, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:15:39,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=4840, skipped=25, lr=[6.0429548299217444e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:15:39,591] [INFO] [timer.py:258:stop] epoch=0/micro_step=4840/global_step=4840, RunningAvgSamplesPerSec=4.44059888554718, CurrSamplesPerSec=4.424381808923069, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:15:48,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=25, lr=[6.0289182885602704e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:15:48,704] [INFO] [timer.py:258:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=4.440615333424046, CurrSamplesPerSec=4.450341019535942, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:15:48,706] [INFO] [RANK 0]  iteration     4850/   10000 | elapsed time per iteration (ms): 1358.4 | learning rate 6.028E-05 | total loss 1.625332E+00 | loss 1.625332E+00 | loss scale 16384.0 |speed 176.68 samples/(min*GPU)
[2024-06-17 23:15:48,707] [INFO] [RANK 0] time (ms) | forward: 354.48 | backward: 550.03 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 12.50 | data loader: 0.18
[2024-06-17 23:15:57,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=4860, skipped=25, lr=[6.014876526988822e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:15:57,816] [INFO] [timer.py:258:stop] epoch=0/micro_step=4860/global_step=4860, RunningAvgSamplesPerSec=4.4406277131923035, CurrSamplesPerSec=4.446284973594809, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:16:06,954] [INFO] [logging.py:96:log_dist] [Rank 0] step=4870, skipped=25, lr=[6.0008296837939156e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:16:06,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=4870/global_step=4870, RunningAvgSamplesPerSec=4.440629809452414, CurrSamplesPerSec=4.439293045664567, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:16:16,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=4880, skipped=25, lr=[5.986777897612224e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:16:16,083] [INFO] [timer.py:258:stop] epoch=0/micro_step=4880/global_step=4880, RunningAvgSamplesPerSec=4.440644020336979, CurrSamplesPerSec=4.436490930789041, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:16:25,208] [INFO] [logging.py:96:log_dist] [Rank 0] step=4890, skipped=25, lr=[5.972721307129203e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:16:25,209] [INFO] [timer.py:258:stop] epoch=0/micro_step=4890/global_step=4890, RunningAvgSamplesPerSec=4.440644474659193, CurrSamplesPerSec=4.446234305077128, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:16:34,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=25, lr=[5.9586600510777255e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:16:34,333] [INFO] [timer.py:258:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=4.440652034031472, CurrSamplesPerSec=4.445157577575308, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:16:34,335] [INFO] [RANK 0]  iteration     4900/   10000 | elapsed time per iteration (ms): 912.6 | learning rate 5.957E-05 | total loss 1.551963E+00 | loss 1.551963E+00 | loss scale 32768.0 |speed 262.99 samples/(min*GPU)
[2024-06-17 23:16:34,336] [INFO] [RANK 0] time (ms) | forward: 355.09 | backward: 551.98 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 11.96 | data loader: 0.19
[2024-06-17 23:16:43,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=4910, skipped=25, lr=[5.944594268236713e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:16:43,474] [INFO] [timer.py:258:stop] epoch=0/micro_step=4910/global_step=4910, RunningAvgSamplesPerSec=4.44066243136614, CurrSamplesPerSec=4.450815631905812, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:16:52,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=4920, skipped=25, lr=[5.9305240974297634e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:16:52,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=4920/global_step=4920, RunningAvgSamplesPerSec=4.44067148227016, CurrSamplesPerSec=4.442798611964393, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:17:01,730] [INFO] [logging.py:96:log_dist] [Rank 0] step=4930, skipped=25, lr=[5.916449677523782e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:17:01,730] [INFO] [timer.py:258:stop] epoch=0/micro_step=4930/global_step=4930, RunningAvgSamplesPerSec=4.440677286837738, CurrSamplesPerSec=4.436052210263576, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:17:10,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=4940, skipped=25, lr=[5.902371147427609e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:17:10,889] [INFO] [timer.py:258:stop] epoch=0/micro_step=4940/global_step=4940, RunningAvgSamplesPerSec=4.4406787234225185, CurrSamplesPerSec=4.446919016861073, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:17:20,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=4950, skipped=25, lr=[5.888288646090656e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:17:20,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=4950/global_step=4950, RunningAvgSamplesPerSec=4.4406930485232, CurrSamplesPerSec=4.449545503489415, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:17:20,027] [INFO] [RANK 0]  iteration     4950/   10000 | elapsed time per iteration (ms): 913.8 | learning rate 5.887E-05 | total loss 1.507021E+00 | loss 1.507021E+00 | loss scale 32768.0 |speed 262.63 samples/(min*GPU)
[2024-06-17 23:17:20,028] [INFO] [RANK 0] time (ms) | forward: 356.10 | backward: 552.22 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 13.26 | data loader: 0.21
[2024-06-17 23:17:29,161] [INFO] [logging.py:96:log_dist] [Rank 0] step=4960, skipped=25, lr=[5.874202312501525e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:17:29,161] [INFO] [timer.py:258:stop] epoch=0/micro_step=4960/global_step=4960, RunningAvgSamplesPerSec=4.4406953986549125, CurrSamplesPerSec=4.44327044011832, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:17:38,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=4970, skipped=25, lr=[5.86011228568664e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:17:38,275] [INFO] [timer.py:258:stop] epoch=0/micro_step=4970/global_step=4970, RunningAvgSamplesPerSec=4.440699071107512, CurrSamplesPerSec=4.441824680310291, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:17:47,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=4980, skipped=25, lr=[5.84601870470888e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:17:47,403] [INFO] [timer.py:258:stop] epoch=0/micro_step=4980/global_step=4980, RunningAvgSamplesPerSec=4.440701821175018, CurrSamplesPerSec=4.443137470921487, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:17:56,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=4990, skipped=25, lr=[5.831921708666196e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:17:56,552] [INFO] [timer.py:258:stop] epoch=0/micro_step=4990/global_step=4990, RunningAvgSamplesPerSec=4.440710318437137, CurrSamplesPerSec=4.44320336616588, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:18:05,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=5000, skipped=25, lr=[5.817821436690251e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:18:05,712] [INFO] [timer.py:258:stop] epoch=0/micro_step=5000/global_step=5000, RunningAvgSamplesPerSec=4.440707749010814, CurrSamplesPerSec=4.446228413463972, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:18:05,713] [INFO] [RANK 0]  iteration     5000/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 5.816E-05 | total loss 1.576836E+00 | loss 1.576836E+00 | loss scale 32768.0 |speed 262.66 samples/(min*GPU)
[2024-06-17 23:18:05,714] [INFO] [RANK 0] time (ms) | forward: 355.56 | backward: 552.44 | allreduce: 0.00 | optimizer: 4.97 | batch generator: 12.49 | data loader: 0.15
[2024-06-17 23:18:12,351] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 23:18:12,351] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 23:18:12,351] [INFO] [RANK 0]  validation loss at iteration 5000 | loss: 2.077930E+00 | PPL: 7.987914E+00 loss 2.078125E+00 |
[2024-06-17 23:18:12,351] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 23:18:21,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=5010, skipped=25, lr=[5.803718027945035e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:18:21,483] [INFO] [timer.py:258:stop] epoch=0/micro_step=5010/global_step=5010, RunningAvgSamplesPerSec=4.440702214513758, CurrSamplesPerSec=4.438903096794199, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:18:30,612] [INFO] [logging.py:96:log_dist] [Rank 0] step=5020, skipped=25, lr=[5.789611621625499e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:18:30,612] [INFO] [timer.py:258:stop] epoch=0/micro_step=5020/global_step=5020, RunningAvgSamplesPerSec=4.440694429777036, CurrSamplesPerSec=4.437865133171273, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:18:39,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=5030, skipped=25, lr=[5.7755023569561794e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:18:39,743] [INFO] [timer.py:258:stop] epoch=0/micro_step=5030/global_step=5030, RunningAvgSamplesPerSec=4.440687317492524, CurrSamplesPerSec=4.43292620093313, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:18:48,901] [INFO] [logging.py:96:log_dist] [Rank 0] step=5040, skipped=25, lr=[5.7613903731898214e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:18:48,902] [INFO] [timer.py:258:stop] epoch=0/micro_step=5040/global_step=5040, RunningAvgSamplesPerSec=4.440680009960633, CurrSamplesPerSec=4.423403105332957, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:18:58,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=5050, skipped=25, lr=[5.747275809606007e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:18:58,038] [INFO] [timer.py:258:stop] epoch=0/micro_step=5050/global_step=5050, RunningAvgSamplesPerSec=4.440682626910057, CurrSamplesPerSec=4.444747757122844, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:18:58,040] [INFO] [RANK 0]  iteration     5050/   10000 | elapsed time per iteration (ms): 1046.5 | learning rate 5.746E-05 | total loss 1.594824E+00 | loss 1.594824E+00 | loss scale 32768.0 |speed 229.33 samples/(min*GPU)
[2024-06-17 23:18:58,041] [INFO] [RANK 0] time (ms) | forward: 355.93 | backward: 552.34 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 14.26 | data loader: 0.13
[2024-06-17 23:19:07,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=5060, skipped=25, lr=[5.733158805509782e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:19:07,159] [INFO] [timer.py:258:stop] epoch=0/micro_step=5060/global_step=5060, RunningAvgSamplesPerSec=4.440689720338315, CurrSamplesPerSec=4.445416698462765, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:19:16,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=5070, skipped=25, lr=[5.719039500230275e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:19:16,286] [INFO] [timer.py:258:stop] epoch=0/micro_step=5070/global_step=5070, RunningAvgSamplesPerSec=4.4406890889468364, CurrSamplesPerSec=4.42869606052535, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:19:25,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=5080, skipped=25, lr=[5.704918033119332e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:19:25,401] [INFO] [timer.py:258:stop] epoch=0/micro_step=5080/global_step=5080, RunningAvgSamplesPerSec=4.44070077455364, CurrSamplesPerSec=4.444853737926299, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:19:34,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=5090, skipped=25, lr=[5.690794543550129e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:19:34,504] [INFO] [timer.py:258:stop] epoch=0/micro_step=5090/global_step=5090, RunningAvgSamplesPerSec=4.4407057019549745, CurrSamplesPerSec=4.422269796895041, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:19:43,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=5100, skipped=25, lr=[5.6766691709158096e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:19:43,609] [INFO] [timer.py:258:stop] epoch=0/micro_step=5100/global_step=5100, RunningAvgSamplesPerSec=4.440707333080132, CurrSamplesPerSec=4.4420669470734415, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:19:43,611] [INFO] [RANK 0]  iteration     5100/   10000 | elapsed time per iteration (ms): 911.4 | learning rate 5.675E-05 | total loss 1.510771E+00 | loss 1.510771E+00 | loss scale 32768.0 |speed 263.32 samples/(min*GPU)
[2024-06-17 23:19:43,612] [INFO] [RANK 0] time (ms) | forward: 353.50 | backward: 552.45 | allreduce: 0.00 | optimizer: 4.73 | batch generator: 10.60 | data loader: 0.11
[2024-06-17 23:19:43,612] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:19:43,624] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/5100/mp_rank_00_model_states.pt
[2024-06-17 23:19:43,624] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/5100/mp_rank_00_model_states.pt...
[2024-06-17 23:20:08,497] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/5100/mp_rank_00_model_states.pt.
[2024-06-17 23:20:17,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=5110, skipped=25, lr=[5.6625420546280967e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:20:17,579] [INFO] [timer.py:258:stop] epoch=0/micro_step=5110/global_step=5110, RunningAvgSamplesPerSec=4.440775845106317, CurrSamplesPerSec=4.4878521662696125, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:20:26,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=5120, skipped=25, lr=[5.6484133341159264e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:20:26,645] [INFO] [timer.py:258:stop] epoch=0/micro_step=5120/global_step=5120, RunningAvgSamplesPerSec=4.44085622358056, CurrSamplesPerSec=4.483967157374611, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:20:35,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=5130, skipped=25, lr=[5.634283148824064e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:20:35,741] [INFO] [timer.py:258:stop] epoch=0/micro_step=5130/global_step=5130, RunningAvgSamplesPerSec=4.440887243247651, CurrSamplesPerSec=4.459193469679363, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:20:44,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=5140, skipped=25, lr=[5.620151638211737e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:20:44,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=5140/global_step=5140, RunningAvgSamplesPerSec=4.440911902668793, CurrSamplesPerSec=4.445326002715861, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:20:54,001] [INFO] [logging.py:96:log_dist] [Rank 0] step=5150, skipped=25, lr=[5.606018941751247e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:20:54,001] [INFO] [timer.py:258:stop] epoch=0/micro_step=5150/global_step=5150, RunningAvgSamplesPerSec=4.440917993561496, CurrSamplesPerSec=4.445020962361011, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:20:54,003] [INFO] [RANK 0]  iteration     5150/   10000 | elapsed time per iteration (ms): 1407.8 | learning rate 5.605E-05 | total loss 1.475996E+00 | loss 1.475996E+00 | loss scale 32768.0 |speed 170.47 samples/(min*GPU)
[2024-06-17 23:20:54,003] [INFO] [RANK 0] time (ms) | forward: 354.65 | backward: 549.68 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 12.95 | data loader: 0.22
[2024-06-17 23:21:03,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=5160, skipped=25, lr=[5.591885198926603e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:21:03,146] [INFO] [timer.py:258:stop] epoch=0/micro_step=5160/global_step=5160, RunningAvgSamplesPerSec=4.440922588844086, CurrSamplesPerSec=4.4403916133073995, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:21:12,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=5170, skipped=25, lr=[5.5777505492321413e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:21:12,282] [INFO] [timer.py:258:stop] epoch=0/micro_step=5170/global_step=5170, RunningAvgSamplesPerSec=4.440931710779111, CurrSamplesPerSec=4.444962079082585, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:21:21,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=5180, skipped=25, lr=[5.563615132171149e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:21:21,416] [INFO] [timer.py:258:stop] epoch=0/micro_step=5180/global_step=5180, RunningAvgSamplesPerSec=4.440941457244115, CurrSamplesPerSec=4.446710399024636, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:21:30,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=5190, skipped=25, lr=[5.549479087254483e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:21:30,558] [INFO] [timer.py:258:stop] epoch=0/micro_step=5190/global_step=5190, RunningAvgSamplesPerSec=4.440945889461476, CurrSamplesPerSec=4.443169241598885, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:21:39,702] [INFO] [logging.py:96:log_dist] [Rank 0] step=5200, skipped=25, lr=[5.5353425539992014e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:21:39,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=5200/global_step=5200, RunningAvgSamplesPerSec=4.440945525195434, CurrSamplesPerSec=4.447626341633854, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:21:39,705] [INFO] [RANK 0]  iteration     5200/   10000 | elapsed time per iteration (ms): 914.1 | learning rate 5.534E-05 | total loss 1.564404E+00 | loss 1.564404E+00 | loss scale 32768.0 |speed 262.57 samples/(min*GPU)
[2024-06-17 23:21:39,707] [INFO] [RANK 0] time (ms) | forward: 356.19 | backward: 552.29 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 13.25 | data loader: 0.22
[2024-06-17 23:21:48,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=5210, skipped=25, lr=[5.52120567192718e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:21:48,825] [INFO] [timer.py:258:stop] epoch=0/micro_step=5210/global_step=5210, RunningAvgSamplesPerSec=4.440950763447026, CurrSamplesPerSec=4.424436647798596, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:21:57,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=5220, skipped=25, lr=[5.507068580563739e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:21:57,961] [INFO] [timer.py:258:stop] epoch=0/micro_step=5220/global_step=5220, RunningAvgSamplesPerSec=4.440957504999365, CurrSamplesPerSec=4.449203306640755, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:22:07,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=5230, skipped=25, lr=[5.492931419436262e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:22:07,097] [INFO] [timer.py:258:stop] epoch=0/micro_step=5230/global_step=5230, RunningAvgSamplesPerSec=4.440963988058826, CurrSamplesPerSec=4.446111762738581, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:22:16,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=5240, skipped=25, lr=[5.478794328072821e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:22:16,229] [INFO] [timer.py:258:stop] epoch=0/micro_step=5240/global_step=5240, RunningAvgSamplesPerSec=4.440962677267445, CurrSamplesPerSec=4.444168484716199, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:22:25,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=5250, skipped=25, lr=[5.464657446000801e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:22:25,387] [INFO] [timer.py:258:stop] epoch=0/micro_step=5250/global_step=5250, RunningAvgSamplesPerSec=4.4409489059056515, CurrSamplesPerSec=4.418469528438412, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:22:25,388] [INFO] [RANK 0]  iteration     5250/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 5.463E-05 | total loss 1.489277E+00 | loss 1.489277E+00 | loss scale 32768.0 |speed 262.68 samples/(min*GPU)
[2024-06-17 23:22:25,389] [INFO] [RANK 0] time (ms) | forward: 355.67 | backward: 552.33 | allreduce: 0.00 | optimizer: 4.91 | batch generator: 12.37 | data loader: 0.12
[2024-06-17 23:22:34,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=5260, skipped=25, lr=[5.4505209127455195e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:22:34,509] [INFO] [timer.py:258:stop] epoch=0/micro_step=5260/global_step=5260, RunningAvgSamplesPerSec=4.440938180580216, CurrSamplesPerSec=4.434534953396617, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:22:43,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=5270, skipped=25, lr=[5.436384867828854e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:22:43,661] [INFO] [timer.py:258:stop] epoch=0/micro_step=5270/global_step=5270, RunningAvgSamplesPerSec=4.440922413744219, CurrSamplesPerSec=4.418955989324265, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:22:52,784] [INFO] [logging.py:96:log_dist] [Rank 0] step=5280, skipped=25, lr=[5.4222494507678604e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:22:52,785] [INFO] [timer.py:258:stop] epoch=0/micro_step=5280/global_step=5280, RunningAvgSamplesPerSec=4.440926500410807, CurrSamplesPerSec=4.442931560879719, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:23:01,920] [INFO] [logging.py:96:log_dist] [Rank 0] step=5290, skipped=25, lr=[5.408114801073399e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:23:01,920] [INFO] [timer.py:258:stop] epoch=0/micro_step=5290/global_step=5290, RunningAvgSamplesPerSec=4.440921858209431, CurrSamplesPerSec=4.441423704566134, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:23:11,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=5300, skipped=25, lr=[5.393981058248756e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:23:11,043] [INFO] [timer.py:258:stop] epoch=0/micro_step=5300/global_step=5300, RunningAvgSamplesPerSec=4.440920211807417, CurrSamplesPerSec=4.438985309230071, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:23:11,044] [INFO] [RANK 0]  iteration     5300/   10000 | elapsed time per iteration (ms): 913.1 | learning rate 5.393E-05 | total loss 1.394873E+00 | loss 1.394873E+00 | loss scale 65536.0 |speed 262.84 samples/(min*GPU)
[2024-06-17 23:23:11,045] [INFO] [RANK 0] time (ms) | forward: 355.13 | backward: 552.35 | allreduce: 0.00 | optimizer: 4.87 | batch generator: 11.24 | data loader: 0.11
[2024-06-17 23:23:11,953] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 23:23:12,862] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 23:23:20,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=5310, skipped=27, lr=[5.382674810675839e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:23:20,171] [INFO] [timer.py:258:stop] epoch=0/micro_step=5310/global_step=5310, RunningAvgSamplesPerSec=4.440918781996865, CurrSamplesPerSec=4.436549589841947, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:23:29,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=5320, skipped=27, lr=[5.3685430517357e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:23:29,300] [INFO] [timer.py:258:stop] epoch=0/micro_step=5320/global_step=5320, RunningAvgSamplesPerSec=4.440915758759608, CurrSamplesPerSec=4.441149765702387, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:23:38,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=5330, skipped=27, lr=[5.354412590222568e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:23:38,432] [INFO] [timer.py:258:stop] epoch=0/micro_step=5330/global_step=5330, RunningAvgSamplesPerSec=4.440915858833196, CurrSamplesPerSec=4.436954379588104, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:23:47,584] [INFO] [logging.py:96:log_dist] [Rank 0] step=5340, skipped=27, lr=[5.340283565598395e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:23:47,585] [INFO] [timer.py:258:stop] epoch=0/micro_step=5340/global_step=5340, RunningAvgSamplesPerSec=4.440915424290626, CurrSamplesPerSec=4.446396919762876, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:23:56,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=5350, skipped=27, lr=[5.32615611731095e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:23:56,720] [INFO] [timer.py:258:stop] epoch=0/micro_step=5350/global_step=5350, RunningAvgSamplesPerSec=4.440910159888612, CurrSamplesPerSec=4.418831454447668, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:23:56,721] [INFO] [RANK 0]  iteration     5350/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 5.325E-05 | total loss 1.529033E+00 | loss 1.529033E+00 | loss scale 32768.0 |speed 262.71 samples/(min*GPU)
[2024-06-17 23:23:56,722] [INFO] [RANK 0] time (ms) | forward: 355.75 | backward: 552.28 | allreduce: 0.00 | optimizer: 4.72 | batch generator: 12.05 | data loader: 0.09
[2024-06-17 23:24:05,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=5360, skipped=27, lr=[5.3120303847924434e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:24:05,853] [INFO] [timer.py:258:stop] epoch=0/micro_step=5360/global_step=5360, RunningAvgSamplesPerSec=4.440906693540082, CurrSamplesPerSec=4.443484619628364, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:24:14,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=5370, skipped=27, lr=[5.297906507458153e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:24:14,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=5370/global_step=5370, RunningAvgSamplesPerSec=4.440915926703817, CurrSamplesPerSec=4.444350962780199, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:24:24,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=5380, skipped=27, lr=[5.2837846247050444e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:24:24,097] [INFO] [timer.py:258:stop] epoch=0/micro_step=5380/global_step=5380, RunningAvgSamplesPerSec=4.440905706539316, CurrSamplesPerSec=4.441387255815529, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:24:33,241] [INFO] [logging.py:96:log_dist] [Rank 0] step=5390, skipped=27, lr=[5.2696648759104006e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:24:33,241] [INFO] [timer.py:258:stop] epoch=0/micro_step=5390/global_step=5390, RunningAvgSamplesPerSec=4.440894235632704, CurrSamplesPerSec=4.444694768616308, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:24:42,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=5400, skipped=27, lr=[5.255547400430441e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:24:42,381] [INFO] [timer.py:258:stop] epoch=0/micro_step=5400/global_step=5400, RunningAvgSamplesPerSec=4.440894722486108, CurrSamplesPerSec=4.438495602964391, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:24:42,383] [INFO] [RANK 0]  iteration     5400/   10000 | elapsed time per iteration (ms): 913.2 | learning rate 5.254E-05 | total loss 1.481777E+00 | loss 1.481777E+00 | loss scale 32768.0 |speed 262.80 samples/(min*GPU)
[2024-06-17 23:24:42,384] [INFO] [RANK 0] time (ms) | forward: 355.30 | backward: 552.39 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 11.61 | data loader: 0.09
[2024-06-17 23:24:42,384] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:24:42,399] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/5400/mp_rank_00_model_states.pt
[2024-06-17 23:24:42,399] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/5400/mp_rank_00_model_states.pt...
[2024-06-17 23:25:09,975] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/5400/mp_rank_00_model_states.pt.
[2024-06-17 23:25:19,065] [INFO] [logging.py:96:log_dist] [Rank 0] step=5410, skipped=27, lr=[5.241432337598951e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:25:19,066] [INFO] [timer.py:258:stop] epoch=0/micro_step=5410/global_step=5410, RunningAvgSamplesPerSec=4.440950803457405, CurrSamplesPerSec=4.4878113501084425, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:25:28,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=5420, skipped=27, lr=[5.2273198267258994e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:25:28,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=5420/global_step=5420, RunningAvgSamplesPerSec=4.44102621117121, CurrSamplesPerSec=4.463479724112244, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:25:37,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=5430, skipped=27, lr=[5.213210007096074e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:25:37,203] [INFO] [timer.py:258:stop] epoch=0/micro_step=5430/global_step=5430, RunningAvgSamplesPerSec=4.441066522728352, CurrSamplesPerSec=4.454923720005927, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:25:46,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=5440, skipped=27, lr=[5.1991030179676965e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:25:46,336] [INFO] [timer.py:258:stop] epoch=0/micro_step=5440/global_step=5440, RunningAvgSamplesPerSec=4.441083321939565, CurrSamplesPerSec=4.45554129734599, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:25:55,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=5450, skipped=27, lr=[5.184998998571054e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:25:55,459] [INFO] [timer.py:258:stop] epoch=0/micro_step=5450/global_step=5450, RunningAvgSamplesPerSec=4.441107023476508, CurrSamplesPerSec=4.452609919821144, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:25:55,462] [INFO] [RANK 0]  iteration     5450/   10000 | elapsed time per iteration (ms): 1461.6 | learning rate 5.184E-05 | total loss 1.409692E+00 | loss 1.409692E+00 | loss scale 32768.0 |speed 164.21 samples/(min*GPU)
[2024-06-17 23:25:55,463] [INFO] [RANK 0] time (ms) | forward: 354.53 | backward: 549.24 | allreduce: 0.00 | optimizer: 4.95 | batch generator: 12.82 | data loader: 0.11
[2024-06-17 23:26:04,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=5460, skipped=27, lr=[5.170898088107125e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:26:04,589] [INFO] [timer.py:258:stop] epoch=0/micro_step=5460/global_step=5460, RunningAvgSamplesPerSec=4.44111186496519, CurrSamplesPerSec=4.45588091952985, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:26:13,722] [INFO] [logging.py:96:log_dist] [Rank 0] step=5470, skipped=27, lr=[5.1568004257462016e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:26:13,722] [INFO] [timer.py:258:stop] epoch=0/micro_step=5470/global_step=5470, RunningAvgSamplesPerSec=4.4411183883218195, CurrSamplesPerSec=4.4368663755338416, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:26:22,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=5480, skipped=27, lr=[5.142706150626522e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:26:22,849] [INFO] [timer.py:258:stop] epoch=0/micro_step=5480/global_step=5480, RunningAvgSamplesPerSec=4.44112225379519, CurrSamplesPerSec=4.442772729030102, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:26:31,981] [INFO] [logging.py:96:log_dist] [Rank 0] step=5490, skipped=27, lr=[5.128615401852889e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:26:31,982] [INFO] [timer.py:258:stop] epoch=0/micro_step=5490/global_step=5490, RunningAvgSamplesPerSec=4.4411298998163895, CurrSamplesPerSec=4.422549572143542, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:26:41,114] [INFO] [logging.py:96:log_dist] [Rank 0] step=5500, skipped=27, lr=[5.114528318495307e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:26:41,114] [INFO] [timer.py:258:stop] epoch=0/micro_step=5500/global_step=5500, RunningAvgSamplesPerSec=4.441128055770076, CurrSamplesPerSec=4.435361459988939, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:26:41,116] [INFO] [RANK 0]  iteration     5500/   10000 | elapsed time per iteration (ms): 913.1 | learning rate 5.113E-05 | total loss 1.420850E+00 | loss 1.420850E+00 | loss scale 32768.0 |speed 262.85 samples/(min*GPU)
[2024-06-17 23:26:41,117] [INFO] [RANK 0] time (ms) | forward: 355.62 | backward: 551.93 | allreduce: 0.00 | optimizer: 4.73 | batch generator: 12.18 | data loader: 0.09
[2024-06-17 23:26:50,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=5510, skipped=27, lr=[5.1004450395876e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:26:50,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=5510/global_step=5510, RunningAvgSamplesPerSec=4.441123114816648, CurrSamplesPerSec=4.418385746945659, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:26:59,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=5520, skipped=27, lr=[5.086365704126046e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:26:59,394] [INFO] [timer.py:258:stop] epoch=0/micro_step=5520/global_step=5520, RunningAvgSamplesPerSec=4.441123631401098, CurrSamplesPerSec=4.44244804147679, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:27:08,547] [INFO] [logging.py:96:log_dist] [Rank 0] step=5530, skipped=27, lr=[5.072290451068001e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:27:08,548] [INFO] [timer.py:258:stop] epoch=0/micro_step=5530/global_step=5530, RunningAvgSamplesPerSec=4.441127489865451, CurrSamplesPerSec=4.448338609210119, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:27:17,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=5540, skipped=27, lr=[5.0582194193305294e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:27:17,669] [INFO] [timer.py:258:stop] epoch=0/micro_step=5540/global_step=5540, RunningAvgSamplesPerSec=4.441138183710422, CurrSamplesPerSec=4.447153587974682, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:27:26,801] [INFO] [logging.py:96:log_dist] [Rank 0] step=5550, skipped=27, lr=[5.044152747789036e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:27:26,801] [INFO] [timer.py:258:stop] epoch=0/micro_step=5550/global_step=5550, RunningAvgSamplesPerSec=4.441139607580794, CurrSamplesPerSec=4.439794677025437, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:27:26,803] [INFO] [RANK 0]  iteration     5550/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 5.043E-05 | total loss 1.450889E+00 | loss 1.450889E+00 | loss scale 32768.0 |speed 262.65 samples/(min*GPU)
[2024-06-17 23:27:26,804] [INFO] [RANK 0] time (ms) | forward: 355.90 | backward: 552.30 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 12.75 | data loader: 0.10
[2024-06-17 23:27:35,922] [INFO] [logging.py:96:log_dist] [Rank 0] step=5560, skipped=27, lr=[5.0300905752758883e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:27:35,922] [INFO] [timer.py:258:stop] epoch=0/micro_step=5560/global_step=5560, RunningAvgSamplesPerSec=4.441150480218644, CurrSamplesPerSec=4.4477147730520254, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:27:45,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=5570, skipped=27, lr=[5.016033040579054e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:27:45,047] [INFO] [timer.py:258:stop] epoch=0/micro_step=5570/global_step=5570, RunningAvgSamplesPerSec=4.441156622292245, CurrSamplesPerSec=4.437899176313028, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:27:54,185] [INFO] [logging.py:96:log_dist] [Rank 0] step=5580, skipped=27, lr=[5.001980282440722e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:27:54,185] [INFO] [timer.py:258:stop] epoch=0/micro_step=5580/global_step=5580, RunningAvgSamplesPerSec=4.441157865513833, CurrSamplesPerSec=4.441600077939454, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:28:03,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=5590, skipped=27, lr=[4.987932439555945e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:28:03,333] [INFO] [timer.py:258:stop] epoch=0/micro_step=5590/global_step=5590, RunningAvgSamplesPerSec=4.441150688240319, CurrSamplesPerSec=4.448014286911124, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:28:12,488] [INFO] [logging.py:96:log_dist] [Rank 0] step=5600, skipped=27, lr=[4.973889650571257e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:28:12,488] [INFO] [timer.py:258:stop] epoch=0/micro_step=5600/global_step=5600, RunningAvgSamplesPerSec=4.441152515982845, CurrSamplesPerSec=4.439513890469232, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:28:12,490] [INFO] [RANK 0]  iteration     5600/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 4.972E-05 | total loss 1.474482E+00 | loss 1.474482E+00 | loss scale 32768.0 |speed 262.66 samples/(min*GPU)
[2024-06-17 23:28:12,491] [INFO] [RANK 0] time (ms) | forward: 356.17 | backward: 552.03 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 12.78 | data loader: 0.10
[2024-06-17 23:28:21,620] [INFO] [logging.py:96:log_dist] [Rank 0] step=5610, skipped=27, lr=[4.959852054083321e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:28:21,620] [INFO] [timer.py:258:stop] epoch=0/micro_step=5610/global_step=5610, RunningAvgSamplesPerSec=4.441151718239787, CurrSamplesPerSec=4.446505336161759, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:28:30,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=5620, skipped=27, lr=[4.945819788637545e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:28:30,759] [INFO] [timer.py:258:stop] epoch=0/micro_step=5620/global_step=5620, RunningAvgSamplesPerSec=4.441155692412764, CurrSamplesPerSec=4.452001424452284, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:28:39,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=5630, skipped=27, lr=[4.9317929927267225e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:28:39,869] [INFO] [timer.py:258:stop] epoch=0/micro_step=5630/global_step=5630, RunningAvgSamplesPerSec=4.441159851124873, CurrSamplesPerSec=4.443399886804276, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:28:48,973] [INFO] [logging.py:96:log_dist] [Rank 0] step=5640, skipped=27, lr=[4.917771804789668e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:28:48,973] [INFO] [timer.py:258:stop] epoch=0/micro_step=5640/global_step=5640, RunningAvgSamplesPerSec=4.4411657760661685, CurrSamplesPerSec=4.4459456343930555, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:28:58,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=5650, skipped=27, lr=[4.9037563632098444e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:28:58,099] [INFO] [timer.py:258:stop] epoch=0/micro_step=5650/global_step=5650, RunningAvgSamplesPerSec=4.441163842301817, CurrSamplesPerSec=4.447053391255345, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:28:58,103] [INFO] [RANK 0]  iteration     5650/   10000 | elapsed time per iteration (ms): 912.3 | learning rate 4.902E-05 | total loss 1.535488E+00 | loss 1.535488E+00 | loss scale 32768.0 |speed 263.08 samples/(min*GPU)
[2024-06-17 23:28:58,103] [INFO] [RANK 0] time (ms) | forward: 354.71 | backward: 552.00 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 11.24 | data loader: 0.09
[2024-06-17 23:29:07,236] [INFO] [logging.py:96:log_dist] [Rank 0] step=5660, skipped=27, lr=[4.8897468063140035e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:29:07,237] [INFO] [timer.py:258:stop] epoch=0/micro_step=5660/global_step=5660, RunningAvgSamplesPerSec=4.441166491180406, CurrSamplesPerSec=4.441421353015784, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:29:16,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=5670, skipped=27, lr=[4.8757432723708144e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:29:16,336] [INFO] [timer.py:258:stop] epoch=0/micro_step=5670/global_step=5670, RunningAvgSamplesPerSec=4.441168982619436, CurrSamplesPerSec=4.449149031977134, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:29:25,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=5680, skipped=27, lr=[4.8617458995895036e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:29:25,429] [INFO] [timer.py:258:stop] epoch=0/micro_step=5680/global_step=5680, RunningAvgSamplesPerSec=4.441179467245318, CurrSamplesPerSec=4.447114687535701, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:29:34,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=5690, skipped=27, lr=[4.8477548261184916e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:29:34,539] [INFO] [timer.py:258:stop] epoch=0/micro_step=5690/global_step=5690, RunningAvgSamplesPerSec=4.441182928327758, CurrSamplesPerSec=4.431373626257525, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:29:43,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=5700, skipped=27, lr=[4.833770190044023e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:29:43,645] [INFO] [timer.py:258:stop] epoch=0/micro_step=5700/global_step=5700, RunningAvgSamplesPerSec=4.441188206767705, CurrSamplesPerSec=4.4468129375490175, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:29:43,648] [INFO] [RANK 0]  iteration     5700/   10000 | elapsed time per iteration (ms): 910.9 | learning rate 4.832E-05 | total loss 1.468467E+00 | loss 1.468467E+00 | loss scale 32768.0 |speed 263.47 samples/(min*GPU)
[2024-06-17 23:29:43,653] [INFO] [RANK 0] time (ms) | forward: 353.40 | backward: 551.99 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 10.22 | data loader: 0.08
[2024-06-17 23:29:43,655] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:29:43,667] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/5700/mp_rank_00_model_states.pt
[2024-06-17 23:29:43,668] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/5700/mp_rank_00_model_states.pt...
[2024-06-17 23:30:06,189] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/5700/mp_rank_00_model_states.pt.
[2024-06-17 23:30:08,932] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 23:30:09,834] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 23:30:15,257] [INFO] [logging.py:96:log_dist] [Rank 0] step=5710, skipped=29, lr=[4.822587208863393e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:30:15,257] [INFO] [timer.py:258:stop] epoch=0/micro_step=5710/global_step=5710, RunningAvgSamplesPerSec=4.441255091370217, CurrSamplesPerSec=4.481600351749143, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:30:24,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=5720, skipped=29, lr=[4.808614507876374e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:30:24,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=5720/global_step=5720, RunningAvgSamplesPerSec=4.441320026097795, CurrSamplesPerSec=4.4767583531547706, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:30:33,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=5730, skipped=29, lr=[4.7946486305850384e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:30:33,380] [INFO] [timer.py:258:stop] epoch=0/micro_step=5730/global_step=5730, RunningAvgSamplesPerSec=4.4413519419378495, CurrSamplesPerSec=4.44676579281259, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:30:42,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=5740, skipped=29, lr=[4.7806897148269577e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:30:42,520] [INFO] [timer.py:258:stop] epoch=0/micro_step=5740/global_step=5740, RunningAvgSamplesPerSec=4.441343499786143, CurrSamplesPerSec=4.4423739346661435, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:30:51,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=5750, skipped=29, lr=[4.766737898370994e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:30:51,629] [INFO] [timer.py:258:stop] epoch=0/micro_step=5750/global_step=5750, RunningAvgSamplesPerSec=4.441345261782338, CurrSamplesPerSec=4.442149276746812, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:30:51,631] [INFO] [RANK 0]  iteration     5750/   10000 | elapsed time per iteration (ms): 1359.6 | learning rate 4.765E-05 | total loss 1.484209E+00 | loss 1.484209E+00 | loss scale 32768.0 |speed 176.52 samples/(min*GPU)
[2024-06-17 23:30:51,631] [INFO] [RANK 0] time (ms) | forward: 353.28 | backward: 549.81 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 11.00 | data loader: 0.10
[2024-06-17 23:31:00,783] [INFO] [logging.py:96:log_dist] [Rank 0] step=5760, skipped=29, lr=[4.752793318915943e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:31:00,784] [INFO] [timer.py:258:stop] epoch=0/micro_step=5760/global_step=5760, RunningAvgSamplesPerSec=4.4413458723494035, CurrSamplesPerSec=4.435401327668754, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:31:09,941] [INFO] [logging.py:96:log_dist] [Rank 0] step=5770, skipped=29, lr=[4.738856114089176e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:31:09,942] [INFO] [timer.py:258:stop] epoch=0/micro_step=5770/global_step=5770, RunningAvgSamplesPerSec=4.44134438575834, CurrSamplesPerSec=4.4232351711348405, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:31:19,078] [INFO] [logging.py:96:log_dist] [Rank 0] step=5780, skipped=29, lr=[4.7249264214452754e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:31:19,079] [INFO] [timer.py:258:stop] epoch=0/micro_step=5780/global_step=5780, RunningAvgSamplesPerSec=4.441345319064965, CurrSamplesPerSec=4.444236765075959, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:31:28,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=5790, skipped=29, lr=[4.711004378464687e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:31:28,189] [INFO] [timer.py:258:stop] epoch=0/micro_step=5790/global_step=5790, RunningAvgSamplesPerSec=4.441345506492263, CurrSamplesPerSec=4.440915827503995, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:31:37,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=5800, skipped=29, lr=[4.697090122552352e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:31:37,351] [INFO] [timer.py:258:stop] epoch=0/micro_step=5800/global_step=5800, RunningAvgSamplesPerSec=4.441325230152559, CurrSamplesPerSec=4.436749042225132, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:31:37,352] [INFO] [RANK 0]  iteration     5800/   10000 | elapsed time per iteration (ms): 914.4 | learning rate 4.696E-05 | total loss 1.560918E+00 | loss 1.560918E+00 | loss scale 32768.0 |speed 262.46 samples/(min*GPU)
[2024-06-17 23:31:37,352] [INFO] [RANK 0] time (ms) | forward: 356.57 | backward: 552.34 | allreduce: 0.00 | optimizer: 4.76 | batch generator: 12.78 | data loader: 0.10
[2024-06-17 23:31:46,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=5810, skipped=29, lr=[4.683183791036359e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:31:46,490] [INFO] [timer.py:258:stop] epoch=0/micro_step=5810/global_step=5810, RunningAvgSamplesPerSec=4.441327157616647, CurrSamplesPerSec=4.442711552384236, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:31:55,617] [INFO] [logging.py:96:log_dist] [Rank 0] step=5820, skipped=29, lr=[4.669285521166586e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:31:55,617] [INFO] [timer.py:258:stop] epoch=0/micro_step=5820/global_step=5820, RunningAvgSamplesPerSec=4.441325247954408, CurrSamplesPerSec=4.439987371194521, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:32:04,741] [INFO] [logging.py:96:log_dist] [Rank 0] step=5830, skipped=29, lr=[4.655395450113347e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:32:04,741] [INFO] [timer.py:258:stop] epoch=0/micro_step=5830/global_step=5830, RunningAvgSamplesPerSec=4.441325362015402, CurrSamplesPerSec=4.442084588889398, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:32:13,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=5840, skipped=29, lr=[4.641513714966035e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:32:13,872] [INFO] [timer.py:258:stop] epoch=0/micro_step=5840/global_step=5840, RunningAvgSamplesPerSec=4.441327875267101, CurrSamplesPerSec=4.440091950031944, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:32:23,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=5850, skipped=29, lr=[4.627640452731771e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:32:23,011] [INFO] [timer.py:258:stop] epoch=0/micro_step=5850/global_step=5850, RunningAvgSamplesPerSec=4.441314172532949, CurrSamplesPerSec=4.433429909001831, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:32:23,013] [INFO] [RANK 0]  iteration     5850/   10000 | elapsed time per iteration (ms): 913.2 | learning rate 4.626E-05 | total loss 1.513271E+00 | loss 1.513271E+00 | loss scale 32768.0 |speed 262.81 samples/(min*GPU)
[2024-06-17 23:32:23,014] [INFO] [RANK 0] time (ms) | forward: 355.59 | backward: 552.08 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 11.76 | data loader: 0.08
[2024-06-17 23:32:32,142] [INFO] [logging.py:96:log_dist] [Rank 0] step=5860, skipped=29, lr=[4.6137758003340524e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:32:32,142] [INFO] [timer.py:258:stop] epoch=0/micro_step=5860/global_step=5860, RunningAvgSamplesPerSec=4.441317768449184, CurrSamplesPerSec=4.447316269911537, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:32:41,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=5870, skipped=29, lr=[4.599919894611401e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:32:41,289] [INFO] [timer.py:258:stop] epoch=0/micro_step=5870/global_step=5870, RunningAvgSamplesPerSec=4.441320154153775, CurrSamplesPerSec=4.446216630284502, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:32:50,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=5880, skipped=29, lr=[4.5860728723160135e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:32:50,392] [INFO] [timer.py:258:stop] epoch=0/micro_step=5880/global_step=5880, RunningAvgSamplesPerSec=4.441328029721904, CurrSamplesPerSec=4.448848185573741, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:32:59,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=5890, skipped=29, lr=[4.57223487011241e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:32:59,511] [INFO] [timer.py:258:stop] epoch=0/micro_step=5890/global_step=5890, RunningAvgSamplesPerSec=4.4413320061313835, CurrSamplesPerSec=4.433656029147537, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:33:08,620] [INFO] [logging.py:96:log_dist] [Rank 0] step=5900, skipped=29, lr=[4.558406024576082e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:33:08,621] [INFO] [timer.py:258:stop] epoch=0/micro_step=5900/global_step=5900, RunningAvgSamplesPerSec=4.441338261518151, CurrSamplesPerSec=4.429686464507783, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:33:08,622] [INFO] [RANK 0]  iteration     5900/   10000 | elapsed time per iteration (ms): 912.2 | learning rate 4.557E-05 | total loss 1.455654E+00 | loss 1.455654E+00 | loss scale 32768.0 |speed 263.10 samples/(min*GPU)
[2024-06-17 23:33:08,624] [INFO] [RANK 0] time (ms) | forward: 354.77 | backward: 551.96 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 11.63 | data loader: 0.09
[2024-06-17 23:33:17,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=5910, skipped=29, lr=[4.5445864721921566e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:33:17,766] [INFO] [timer.py:258:stop] epoch=0/micro_step=5910/global_step=5910, RunningAvgSamplesPerSec=4.441331578234124, CurrSamplesPerSec=4.439542085004613, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:33:26,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=5920, skipped=29, lr=[4.5307763493540334e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:33:26,905] [INFO] [timer.py:258:stop] epoch=0/micro_step=5920/global_step=5920, RunningAvgSamplesPerSec=4.44132461359276, CurrSamplesPerSec=4.425437987953847, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:33:36,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=5930, skipped=29, lr=[4.5169757923620526e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:33:36,070] [INFO] [timer.py:258:stop] epoch=0/micro_step=5930/global_step=5930, RunningAvgSamplesPerSec=4.441312463649858, CurrSamplesPerSec=4.422711624830661, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:33:45,213] [INFO] [logging.py:96:log_dist] [Rank 0] step=5940, skipped=29, lr=[4.503184937422136e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:33:45,214] [INFO] [timer.py:258:stop] epoch=0/micro_step=5940/global_step=5940, RunningAvgSamplesPerSec=4.441303274174145, CurrSamplesPerSec=4.4403563567050055, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:33:54,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=5950, skipped=29, lr=[4.489403920644456e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:33:54,356] [INFO] [timer.py:258:stop] epoch=0/micro_step=5950/global_step=5950, RunningAvgSamplesPerSec=4.441300182356271, CurrSamplesPerSec=4.447298586515769, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:33:54,358] [INFO] [RANK 0]  iteration     5950/   10000 | elapsed time per iteration (ms): 914.7 | learning rate 4.488E-05 | total loss 1.426885E+00 | loss 1.426885E+00 | loss scale 32768.0 |speed 262.38 samples/(min*GPU)
[2024-06-17 23:33:54,359] [INFO] [RANK 0] time (ms) | forward: 356.87 | backward: 552.18 | allreduce: 0.00 | optimizer: 4.86 | batch generator: 12.55 | data loader: 0.09
[2024-06-17 23:34:03,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=5960, skipped=29, lr=[4.4756328780420874e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:34:03,488] [INFO] [timer.py:258:stop] epoch=0/micro_step=5960/global_step=5960, RunningAvgSamplesPerSec=4.441295864039803, CurrSamplesPerSec=4.432009277592052, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:34:12,631] [INFO] [logging.py:96:log_dist] [Rank 0] step=5970, skipped=29, lr=[4.461871945529657e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:34:12,631] [INFO] [timer.py:258:stop] epoch=0/micro_step=5970/global_step=5970, RunningAvgSamplesPerSec=4.441299610493184, CurrSamplesPerSec=4.442876262576776, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:34:21,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=5980, skipped=29, lr=[4.448121258922019e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:34:21,754] [INFO] [timer.py:258:stop] epoch=0/micro_step=5980/global_step=5980, RunningAvgSamplesPerSec=4.441302347286086, CurrSamplesPerSec=4.444113155618776, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:34:30,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=5990, skipped=29, lr=[4.43438095393289e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:34:30,899] [INFO] [timer.py:258:stop] epoch=0/micro_step=5990/global_step=5990, RunningAvgSamplesPerSec=4.441304897052989, CurrSamplesPerSec=4.448303226297387, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:34:40,032] [INFO] [logging.py:96:log_dist] [Rank 0] step=6000, skipped=29, lr=[4.4206511661735404e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:34:40,033] [INFO] [timer.py:258:stop] epoch=0/micro_step=6000/global_step=6000, RunningAvgSamplesPerSec=4.441310911561313, CurrSamplesPerSec=4.4441967384037016, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:34:40,034] [INFO] [RANK 0]  iteration     6000/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 4.419E-05 | total loss 1.381768E+00 | loss 1.381768E+00 | loss scale 32768.0 |speed 262.72 samples/(min*GPU)
[2024-06-17 23:34:40,034] [INFO] [RANK 0] time (ms) | forward: 355.93 | backward: 552.02 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 12.59 | data loader: 0.09
[2024-06-17 23:34:40,035] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:34:40,048] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/6000/mp_rank_00_model_states.pt
[2024-06-17 23:34:40,048] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/6000/mp_rank_00_model_states.pt...
[2024-06-17 23:35:06,913] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/6000/mp_rank_00_model_states.pt.
[2024-06-17 23:35:13,534] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 23:35:13,534] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 23:35:13,534] [INFO] [RANK 0]  validation loss at iteration 6000 | loss: 1.974121E+00 | PPL: 7.200288E+00 loss 1.973633E+00 |
[2024-06-17 23:35:13,534] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 23:35:22,575] [INFO] [logging.py:96:log_dist] [Rank 0] step=6010, skipped=29, lr=[4.4069320311514286e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:35:22,576] [INFO] [timer.py:258:stop] epoch=0/micro_step=6010/global_step=6010, RunningAvgSamplesPerSec=4.441382390756514, CurrSamplesPerSec=4.4481829286043615, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:35:31,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=6020, skipped=29, lr=[4.393223684268881e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:35:31,651] [INFO] [timer.py:258:stop] epoch=0/micro_step=6020/global_step=6020, RunningAvgSamplesPerSec=4.441423603556483, CurrSamplesPerSec=4.462835014223325, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:35:40,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=6030, skipped=29, lr=[4.3795262608217456e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:35:40,750] [INFO] [timer.py:258:stop] epoch=0/micro_step=6030/global_step=6030, RunningAvgSamplesPerSec=4.4414452370888435, CurrSamplesPerSec=4.4552573324778955, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:35:49,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=6040, skipped=29, lr=[4.365839895998061e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:35:49,864] [INFO] [timer.py:258:stop] epoch=0/micro_step=6040/global_step=6040, RunningAvgSamplesPerSec=4.441458183027788, CurrSamplesPerSec=4.443109230700783, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:35:58,981] [INFO] [logging.py:96:log_dist] [Rank 0] step=6050, skipped=29, lr=[4.3521647248767256e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:35:58,981] [INFO] [timer.py:258:stop] epoch=0/micro_step=6050/global_step=6050, RunningAvgSamplesPerSec=4.441467566996605, CurrSamplesPerSec=4.445622838924362, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:35:58,983] [INFO] [RANK 0]  iteration     6050/   10000 | elapsed time per iteration (ms): 1579.0 | learning rate 4.351E-05 | total loss 1.529385E+00 | loss 1.529385E+00 | loss scale 32768.0 |speed 152.00 samples/(min*GPU)
[2024-06-17 23:35:58,983] [INFO] [RANK 0] time (ms) | forward: 353.27 | backward: 550.13 | allreduce: 0.00 | optimizer: 4.82 | batch generator: 14.08 | data loader: 0.13
[2024-06-17 23:36:08,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=6060, skipped=29, lr=[4.338500882426155e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:36:08,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=6060/global_step=6060, RunningAvgSamplesPerSec=4.441470086669096, CurrSamplesPerSec=4.4387140197478825, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:36:17,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=6070, skipped=29, lr=[4.324848503502959e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:36:17,261] [INFO] [timer.py:258:stop] epoch=0/micro_step=6070/global_step=6070, RunningAvgSamplesPerSec=4.441479838687828, CurrSamplesPerSec=4.4447265615686185, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:36:26,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=6080, skipped=29, lr=[4.311207722850605e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:36:26,398] [INFO] [timer.py:258:stop] epoch=0/micro_step=6080/global_step=6080, RunningAvgSamplesPerSec=4.441476421461474, CurrSamplesPerSec=4.443298682388349, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:36:35,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=6090, skipped=29, lr=[4.2975786750980933e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:36:35,521] [INFO] [timer.py:258:stop] epoch=0/micro_step=6090/global_step=6090, RunningAvgSamplesPerSec=4.441477736640594, CurrSamplesPerSec=4.4453860735110124, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:36:44,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=6100, skipped=29, lr=[4.283961494758619e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:36:44,672] [INFO] [timer.py:258:stop] epoch=0/micro_step=6100/global_step=6100, RunningAvgSamplesPerSec=4.441478671897281, CurrSamplesPerSec=4.44381534393104, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:36:44,673] [INFO] [RANK 0]  iteration     6100/   10000 | elapsed time per iteration (ms): 913.8 | learning rate 4.283E-05 | total loss 1.503027E+00 | loss 1.503027E+00 | loss scale 32768.0 |speed 262.63 samples/(min*GPU)
[2024-06-17 23:36:44,674] [INFO] [RANK 0] time (ms) | forward: 356.32 | backward: 551.94 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 12.86 | data loader: 0.09
[2024-06-17 23:36:49,243] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 23:36:50,154] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 23:36:53,806] [INFO] [logging.py:96:log_dist] [Rank 0] step=6110, skipped=31, lr=[4.27307638534256e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:36:53,807] [INFO] [timer.py:258:stop] epoch=0/micro_step=6110/global_step=6110, RunningAvgSamplesPerSec=4.4414807824002, CurrSamplesPerSec=4.435393119558438, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:37:02,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=6120, skipped=31, lr=[4.259480904945104e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:37:02,944] [INFO] [timer.py:258:stop] epoch=0/micro_step=6120/global_step=6120, RunningAvgSamplesPerSec=4.441479834636553, CurrSamplesPerSec=4.443397533160847, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:37:12,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=6130, skipped=31, lr=[4.2458976679702993e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:37:12,069] [INFO] [timer.py:258:stop] epoch=0/micro_step=6130/global_step=6130, RunningAvgSamplesPerSec=4.441480304463486, CurrSamplesPerSec=4.443012745988575, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:37:21,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=6140, skipped=31, lr=[4.23232680847921e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:37:21,200] [INFO] [timer.py:258:stop] epoch=0/micro_step=6140/global_step=6140, RunningAvgSamplesPerSec=4.441485263163128, CurrSamplesPerSec=4.4407348068184795, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:37:30,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=6150, skipped=31, lr=[4.218768460410741e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:37:30,365] [INFO] [timer.py:258:stop] epoch=0/micro_step=6150/global_step=6150, RunningAvgSamplesPerSec=4.441482723634566, CurrSamplesPerSec=4.440784174632774, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:37:30,366] [INFO] [RANK 0]  iteration     6150/   10000 | elapsed time per iteration (ms): 913.9 | learning rate 4.217E-05 | total loss 1.421016E+00 | loss 1.421016E+00 | loss scale 32768.0 |speed 262.62 samples/(min*GPU)
[2024-06-17 23:37:30,367] [INFO] [RANK 0] time (ms) | forward: 356.27 | backward: 552.02 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 12.74 | data loader: 0.10
[2024-06-17 23:37:39,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=6160, skipped=31, lr=[4.2052227575803136e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:37:39,493] [INFO] [timer.py:258:stop] epoch=0/micro_step=6160/global_step=6160, RunningAvgSamplesPerSec=4.441486544733537, CurrSamplesPerSec=4.449794514280561, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:37:48,593] [INFO] [logging.py:96:log_dist] [Rank 0] step=6170, skipped=31, lr=[4.1916898336785456e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:37:48,593] [INFO] [timer.py:258:stop] epoch=0/micro_step=6170/global_step=6170, RunningAvgSamplesPerSec=4.4414921005814065, CurrSamplesPerSec=4.4398416740610145, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:37:57,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=6180, skipped=31, lr=[4.178169822269933e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:37:57,731] [INFO] [timer.py:258:stop] epoch=0/micro_step=6180/global_step=6180, RunningAvgSamplesPerSec=4.441493442411948, CurrSamplesPerSec=4.440267042484633, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:38:06,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=6190, skipped=31, lr=[4.16466285679153e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:38:06,845] [INFO] [timer.py:258:stop] epoch=0/micro_step=6190/global_step=6190, RunningAvgSamplesPerSec=4.441501633381564, CurrSamplesPerSec=4.444228524231555, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:38:15,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=6200, skipped=31, lr=[4.1511690705516344e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:38:15,967] [INFO] [timer.py:258:stop] epoch=0/micro_step=6200/global_step=6200, RunningAvgSamplesPerSec=4.4415055981585105, CurrSamplesPerSec=4.445244733047638, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:38:15,969] [INFO] [RANK 0]  iteration     6200/   10000 | elapsed time per iteration (ms): 912.1 | learning rate 4.150E-05 | total loss 1.526533E+00 | loss 1.526533E+00 | loss scale 32768.0 |speed 263.14 samples/(min*GPU)
[2024-06-17 23:38:15,970] [INFO] [RANK 0] time (ms) | forward: 354.48 | backward: 552.05 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 11.49 | data loader: 0.09
[2024-06-17 23:38:25,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=6210, skipped=31, lr=[4.137688596728467e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:38:25,089] [INFO] [timer.py:258:stop] epoch=0/micro_step=6210/global_step=6210, RunningAvgSamplesPerSec=4.441503839640207, CurrSamplesPerSec=4.426396571215997, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:38:34,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=6220, skipped=31, lr=[4.124221568368862e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:38:34,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=6220/global_step=6220, RunningAvgSamplesPerSec=4.4414995267593405, CurrSamplesPerSec=4.437348680608636, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:38:43,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=6230, skipped=31, lr=[4.110768118386952e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:38:43,334] [INFO] [timer.py:258:stop] epoch=0/micro_step=6230/global_step=6230, RunningAvgSamplesPerSec=4.441496770567965, CurrSamplesPerSec=4.4373698058553375, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:38:52,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=6240, skipped=31, lr=[4.097328379562859e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:38:52,478] [INFO] [timer.py:258:stop] epoch=0/micro_step=6240/global_step=6240, RunningAvgSamplesPerSec=4.441489611189164, CurrSamplesPerSec=4.436381829076291, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:39:01,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=6250, skipped=31, lr=[4.0839024845413785e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:39:01,636] [INFO] [timer.py:258:stop] epoch=0/micro_step=6250/global_step=6250, RunningAvgSamplesPerSec=4.44149138252214, CurrSamplesPerSec=4.446682113367333, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:39:01,637] [INFO] [RANK 0]  iteration     6250/   10000 | elapsed time per iteration (ms): 913.4 | learning rate 4.083E-05 | total loss 1.480625E+00 | loss 1.480625E+00 | loss scale 32768.0 |speed 262.76 samples/(min*GPU)
[2024-06-17 23:39:01,638] [INFO] [RANK 0] time (ms) | forward: 355.52 | backward: 552.17 | allreduce: 0.00 | optimizer: 4.88 | batch generator: 11.77 | data loader: 0.09
[2024-06-17 23:39:10,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=6260, skipped=31, lr=[4.070490565830674e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:39:10,768] [INFO] [timer.py:258:stop] epoch=0/micro_step=6260/global_step=6260, RunningAvgSamplesPerSec=4.441492285782813, CurrSamplesPerSec=4.439219044075953, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:39:19,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=6270, skipped=31, lr=[4.057092755800968e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:39:19,900] [INFO] [timer.py:258:stop] epoch=0/micro_step=6270/global_step=6270, RunningAvgSamplesPerSec=4.441488410506864, CurrSamplesPerSec=4.440110751244258, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:39:29,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=6280, skipped=31, lr=[4.043709186683236e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:39:29,043] [INFO] [timer.py:258:stop] epoch=0/micro_step=6280/global_step=6280, RunningAvgSamplesPerSec=4.44147916692896, CurrSamplesPerSec=4.438618900119264, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:39:38,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=6290, skipped=31, lr=[4.030339990567905e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:39:38,221] [INFO] [timer.py:258:stop] epoch=0/micro_step=6290/global_step=6290, RunningAvgSamplesPerSec=4.441470250853937, CurrSamplesPerSec=4.4394058147343936, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:39:47,375] [INFO] [logging.py:96:log_dist] [Rank 0] step=6300, skipped=31, lr=[4.0169852994035405e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:39:47,376] [INFO] [timer.py:258:stop] epoch=0/micro_step=6300/global_step=6300, RunningAvgSamplesPerSec=4.441460881085935, CurrSamplesPerSec=4.443004509682882, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:39:47,378] [INFO] [RANK 0]  iteration     6300/   10000 | elapsed time per iteration (ms): 914.8 | learning rate 4.016E-05 | total loss 1.447373E+00 | loss 1.447373E+00 | loss scale 32768.0 |speed 262.35 samples/(min*GPU)
[2024-06-17 23:39:47,379] [INFO] [RANK 0] time (ms) | forward: 357.06 | backward: 552.05 | allreduce: 0.00 | optimizer: 4.90 | batch generator: 12.83 | data loader: 0.09
[2024-06-17 23:39:47,379] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:39:47,397] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/6300/mp_rank_00_model_states.pt
[2024-06-17 23:39:47,397] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/6300/mp_rank_00_model_states.pt...
[2024-06-17 23:40:13,315] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/6300/mp_rank_00_model_states.pt.
[2024-06-17 23:40:22,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=6310, skipped=31, lr=[4.0036452449955534e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:40:22,413] [INFO] [timer.py:258:stop] epoch=0/micro_step=6310/global_step=6310, RunningAvgSamplesPerSec=4.441510073017143, CurrSamplesPerSec=4.478305841101601, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:40:31,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=6320, skipped=31, lr=[3.990319959004896e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:40:31,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=6320/global_step=6320, RunningAvgSamplesPerSec=4.441557460069821, CurrSamplesPerSec=4.463250551747182, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:40:40,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=6330, skipped=31, lr=[3.977009572946761e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:40:40,615] [INFO] [timer.py:258:stop] epoch=0/micro_step=6330/global_step=6330, RunningAvgSamplesPerSec=4.441579540832499, CurrSamplesPerSec=4.4494687996189475, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:40:49,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=6340, skipped=31, lr=[3.963714218189283e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:40:49,745] [INFO] [timer.py:258:stop] epoch=0/micro_step=6340/global_step=6340, RunningAvgSamplesPerSec=4.441588256199971, CurrSamplesPerSec=4.441307305812778, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:40:58,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=6350, skipped=31, lr=[3.950434025952249e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:40:58,887] [INFO] [timer.py:258:stop] epoch=0/micro_step=6350/global_step=6350, RunningAvgSamplesPerSec=4.441590399823647, CurrSamplesPerSec=4.447593328139195, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:40:58,888] [INFO] [RANK 0]  iteration     6350/   10000 | elapsed time per iteration (ms): 1430.2 | learning rate 3.949E-05 | total loss 1.400986E+00 | loss 1.400986E+00 | loss scale 32768.0 |speed 167.81 samples/(min*GPU)
[2024-06-17 23:40:58,902] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 549.91 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 13.21 | data loader: 0.10
[2024-06-17 23:41:08,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=6360, skipped=31, lr=[3.937169127305794e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:41:08,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=6360/global_step=6360, RunningAvgSamplesPerSec=4.441597207252188, CurrSamplesPerSec=4.447596865275895, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:41:17,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=6370, skipped=31, lr=[3.923919653169112e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:41:17,173] [INFO] [timer.py:258:stop] epoch=0/micro_step=6370/global_step=6370, RunningAvgSamplesPerSec=4.441602638890944, CurrSamplesPerSec=4.446268476741335, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:41:26,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=6380, skipped=31, lr=[3.9106857343091636e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:41:26,312] [INFO] [timer.py:258:stop] epoch=0/micro_step=6380/global_step=6380, RunningAvgSamplesPerSec=4.441609874289823, CurrSamplesPerSec=4.438392273482078, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:41:35,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=6390, skipped=31, lr=[3.8974675013393864e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:41:35,454] [INFO] [timer.py:258:stop] epoch=0/micro_step=6390/global_step=6390, RunningAvgSamplesPerSec=4.441610616793244, CurrSamplesPerSec=4.443359875205089, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:41:44,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=6400, skipped=31, lr=[3.8842650847184014e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:41:44,602] [INFO] [timer.py:258:stop] epoch=0/micro_step=6400/global_step=6400, RunningAvgSamplesPerSec=4.441607944955629, CurrSamplesPerSec=4.441543636935949, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:41:44,604] [INFO] [RANK 0]  iteration     6400/   10000 | elapsed time per iteration (ms): 914.3 | learning rate 3.883E-05 | total loss 1.400273E+00 | loss 1.400273E+00 | loss scale 32768.0 |speed 262.49 samples/(min*GPU)
[2024-06-17 23:41:44,605] [INFO] [RANK 0] time (ms) | forward: 356.76 | backward: 551.74 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 13.35 | data loader: 0.10
[2024-06-17 23:41:53,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=6410, skipped=31, lr=[3.871078614748732e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:41:53,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=6410/global_step=6410, RunningAvgSamplesPerSec=4.441605477255445, CurrSamplesPerSec=4.4461659633244395, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:42:02,883] [INFO] [logging.py:96:log_dist] [Rank 0] step=6420, skipped=31, lr=[3.857908221575512e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:42:02,884] [INFO] [timer.py:258:stop] epoch=0/micro_step=6420/global_step=6420, RunningAvgSamplesPerSec=4.441607524695925, CurrSamplesPerSec=4.449683577120799, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:42:12,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=6430, skipped=31, lr=[3.844754035185207e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:42:12,020] [INFO] [timer.py:258:stop] epoch=0/micro_step=6430/global_step=6430, RunningAvgSamplesPerSec=4.441612840400708, CurrSamplesPerSec=4.43486669137352, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:42:21,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=6440, skipped=31, lr=[3.831616185404325e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:42:21,161] [INFO] [timer.py:258:stop] epoch=0/micro_step=6440/global_step=6440, RunningAvgSamplesPerSec=4.441619001879345, CurrSamplesPerSec=4.444684171066609, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:42:30,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=6450, skipped=31, lr=[3.818494801898138e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:42:30,293] [INFO] [timer.py:258:stop] epoch=0/micro_step=6450/global_step=6450, RunningAvgSamplesPerSec=4.4416186110864535, CurrSamplesPerSec=4.445612236948585, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:42:30,294] [INFO] [RANK 0]  iteration     6450/   10000 | elapsed time per iteration (ms): 913.8 | learning rate 3.817E-05 | total loss 1.368584E+00 | loss 1.368584E+00 | loss scale 32768.0 |speed 262.64 samples/(min*GPU)
[2024-06-17 23:42:30,295] [INFO] [RANK 0] time (ms) | forward: 356.37 | backward: 551.89 | allreduce: 0.00 | optimizer: 4.76 | batch generator: 12.91 | data loader: 0.11
[2024-06-17 23:42:39,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=6460, skipped=31, lr=[3.8053900141694055e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:42:39,419] [INFO] [timer.py:258:stop] epoch=0/micro_step=6460/global_step=6460, RunningAvgSamplesPerSec=4.441622955067447, CurrSamplesPerSec=4.448473069412203, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:42:48,549] [INFO] [logging.py:96:log_dist] [Rank 0] step=6470, skipped=31, lr=[3.792301951557092e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:42:48,549] [INFO] [timer.py:258:stop] epoch=0/micro_step=6470/global_step=6470, RunningAvgSamplesPerSec=4.441622319031011, CurrSamplesPerSec=4.442908029518728, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:42:57,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=6480, skipped=31, lr=[3.779230743235092e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:42:57,679] [INFO] [timer.py:258:stop] epoch=0/micro_step=6480/global_step=6480, RunningAvgSamplesPerSec=4.441621251672428, CurrSamplesPerSec=4.438433369859042, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:43:06,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=6490, skipped=31, lr=[3.766176518210951e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:43:06,815] [INFO] [timer.py:258:stop] epoch=0/micro_step=6490/global_step=6490, RunningAvgSamplesPerSec=4.4416203211778935, CurrSamplesPerSec=4.444824298307269, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:43:15,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=6500, skipped=31, lr=[3.7531394053246044e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:43:15,961] [INFO] [timer.py:258:stop] epoch=0/micro_step=6500/global_step=6500, RunningAvgSamplesPerSec=4.441616189830538, CurrSamplesPerSec=4.424508990522384, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:43:15,962] [INFO] [RANK 0]  iteration     6500/   10000 | elapsed time per iteration (ms): 913.4 | learning rate 3.752E-05 | total loss 1.418350E+00 | loss 1.418350E+00 | loss scale 32768.0 |speed 262.77 samples/(min*GPU)
[2024-06-17 23:43:15,963] [INFO] [RANK 0] time (ms) | forward: 355.97 | backward: 551.84 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 12.12 | data loader: 0.11
[2024-06-17 23:43:22,341] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 23:43:23,252] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 23:43:25,078] [INFO] [logging.py:96:log_dist] [Rank 0] step=6510, skipped=33, lr=[3.7427221222273836e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:43:25,078] [INFO] [timer.py:258:stop] epoch=0/micro_step=6510/global_step=6510, RunningAvgSamplesPerSec=4.441623657241025, CurrSamplesPerSec=4.443210426486564, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:43:34,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=6520, skipped=33, lr=[3.729716135325781e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:43:34,224] [INFO] [timer.py:258:stop] epoch=0/micro_step=6520/global_step=6520, RunningAvgSamplesPerSec=4.441621950152042, CurrSamplesPerSec=4.449315399811336, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:43:43,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=6530, skipped=33, lr=[3.71672762041123e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:43:43,327] [INFO] [timer.py:258:stop] epoch=0/micro_step=6530/global_step=6530, RunningAvgSamplesPerSec=4.441629514852293, CurrSamplesPerSec=4.447415299526662, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:43:52,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=6540, skipped=33, lr=[3.70375670567513e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:43:52,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=6540/global_step=6540, RunningAvgSamplesPerSec=4.441633419962194, CurrSamplesPerSec=4.442308064021157, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:44:01,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=6550, skipped=33, lr=[3.690803519135171e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:44:01,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=6550/global_step=6550, RunningAvgSamplesPerSec=4.44162881095928, CurrSamplesPerSec=4.439062826601754, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:44:01,576] [INFO] [RANK 0]  iteration     6550/   10000 | elapsed time per iteration (ms): 912.3 | learning rate 3.690E-05 | total loss 1.562803E+00 | loss 1.562803E+00 | loss scale 32768.0 |speed 263.08 samples/(min*GPU)
[2024-06-17 23:44:01,577] [INFO] [RANK 0] time (ms) | forward: 355.00 | backward: 551.82 | allreduce: 0.00 | optimizer: 4.71 | batch generator: 11.43 | data loader: 0.08
[2024-06-17 23:44:10,747] [INFO] [logging.py:96:log_dist] [Rank 0] step=6560, skipped=33, lr=[3.677868188634077e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:44:10,747] [INFO] [timer.py:258:stop] epoch=0/micro_step=6560/global_step=6560, RunningAvgSamplesPerSec=4.441616528334929, CurrSamplesPerSec=4.4345595682908625, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:44:19,895] [INFO] [logging.py:96:log_dist] [Rank 0] step=6570, skipped=33, lr=[3.664950841838337e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:44:19,895] [INFO] [timer.py:258:stop] epoch=0/micro_step=6570/global_step=6570, RunningAvgSamplesPerSec=4.44161434900542, CurrSamplesPerSec=4.434149355725891, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:44:29,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=6580, skipped=33, lr=[3.652051606236949e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:44:29,050] [INFO] [timer.py:258:stop] epoch=0/micro_step=6580/global_step=6580, RunningAvgSamplesPerSec=4.441602766995522, CurrSamplesPerSec=4.4478609873769015, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:44:38,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=6590, skipped=33, lr=[3.639170609140159e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:44:38,181] [INFO] [timer.py:258:stop] epoch=0/micro_step=6590/global_step=6590, RunningAvgSamplesPerSec=4.441608319391238, CurrSamplesPerSec=4.445039805339596, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:44:47,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=6600, skipped=33, lr=[3.6263079776782106e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:44:47,319] [INFO] [timer.py:258:stop] epoch=0/micro_step=6600/global_step=6600, RunningAvgSamplesPerSec=4.441611712266979, CurrSamplesPerSec=4.44497856624329, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:44:47,320] [INFO] [RANK 0]  iteration     6600/   10000 | elapsed time per iteration (ms): 914.9 | learning rate 3.625E-05 | total loss 1.383018E+00 | loss 1.383018E+00 | loss scale 32768.0 |speed 262.33 samples/(min*GPU)
[2024-06-17 23:44:47,322] [INFO] [RANK 0] time (ms) | forward: 357.38 | backward: 551.97 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 13.28 | data loader: 0.09
[2024-06-17 23:44:47,322] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:44:47,336] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/6600/mp_rank_00_model_states.pt
[2024-06-17 23:44:47,336] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/6600/mp_rank_00_model_states.pt...
[2024-06-17 23:45:15,132] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/6600/mp_rank_00_model_states.pt.
[2024-06-17 23:45:24,241] [INFO] [logging.py:96:log_dist] [Rank 0] step=6610, skipped=33, lr=[3.613463838800081e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:45:24,241] [INFO] [timer.py:258:stop] epoch=0/micro_step=6610/global_step=6610, RunningAvgSamplesPerSec=4.441655380424721, CurrSamplesPerSec=4.481775141574667, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:45:33,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=6620, skipped=33, lr=[3.600638319272239e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:45:33,295] [INFO] [timer.py:258:stop] epoch=0/micro_step=6620/global_step=6620, RunningAvgSamplesPerSec=4.44170668890629, CurrSamplesPerSec=4.473651075707643, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:45:42,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=6630, skipped=33, lr=[3.5878315456773826e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:45:42,419] [INFO] [timer.py:258:stop] epoch=0/micro_step=6630/global_step=6630, RunningAvgSamplesPerSec=4.441724733683496, CurrSamplesPerSec=4.4601038914084885, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:45:51,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=6640, skipped=33, lr=[3.575043644413195e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:45:51,535] [INFO] [timer.py:258:stop] epoch=0/micro_step=6640/global_step=6640, RunningAvgSamplesPerSec=4.44172637002218, CurrSamplesPerSec=4.443435191754921, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:46:00,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=6650, skipped=33, lr=[3.562274741691103e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:46:00,665] [INFO] [timer.py:258:stop] epoch=0/micro_step=6650/global_step=6650, RunningAvgSamplesPerSec=4.441725179581607, CurrSamplesPerSec=4.444157889676002, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:46:00,666] [INFO] [RANK 0]  iteration     6650/   10000 | elapsed time per iteration (ms): 1466.9 | learning rate 3.561E-05 | total loss 1.405352E+00 | loss 1.405352E+00 | loss scale 32768.0 |speed 163.61 samples/(min*GPU)
[2024-06-17 23:46:00,667] [INFO] [RANK 0] time (ms) | forward: 355.05 | backward: 549.77 | allreduce: 0.00 | optimizer: 4.85 | batch generator: 12.29 | data loader: 0.10
[2024-06-17 23:46:09,784] [INFO] [logging.py:96:log_dist] [Rank 0] step=6660, skipped=33, lr=[3.549524963535016e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:46:09,785] [INFO] [timer.py:258:stop] epoch=0/micro_step=6660/global_step=6660, RunningAvgSamplesPerSec=4.4417247618971105, CurrSamplesPerSec=4.446561903338284, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:46:18,906] [INFO] [logging.py:96:log_dist] [Rank 0] step=6670, skipped=33, lr=[3.536794435780103e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:46:18,906] [INFO] [timer.py:258:stop] epoch=0/micro_step=6670/global_step=6670, RunningAvgSamplesPerSec=4.441720784155965, CurrSamplesPerSec=4.445910289538267, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:46:28,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=6680, skipped=33, lr=[3.524083284071529e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:46:28,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=6680/global_step=6680, RunningAvgSamplesPerSec=4.4417152918086344, CurrSamplesPerSec=4.439687762475925, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:46:37,169] [INFO] [logging.py:96:log_dist] [Rank 0] step=6690, skipped=33, lr=[3.511391633863233e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:46:37,170] [INFO] [timer.py:258:stop] epoch=0/micro_step=6690/global_step=6690, RunningAvgSamplesPerSec=4.441713865361934, CurrSamplesPerSec=4.440995763412881, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:46:46,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=6700, skipped=33, lr=[3.498719610416675e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:46:46,290] [INFO] [timer.py:258:stop] epoch=0/micro_step=6700/global_step=6700, RunningAvgSamplesPerSec=4.441707593572242, CurrSamplesPerSec=4.4256446145238515, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:46:46,291] [INFO] [RANK 0]  iteration     6700/   10000 | elapsed time per iteration (ms): 912.5 | learning rate 3.497E-05 | total loss 1.426123E+00 | loss 1.426123E+00 | loss scale 32768.0 |speed 263.01 samples/(min*GPU)
[2024-06-17 23:46:46,292] [INFO] [RANK 0] time (ms) | forward: 354.76 | backward: 552.05 | allreduce: 0.00 | optimizer: 4.90 | batch generator: 10.83 | data loader: 0.09
[2024-06-17 23:46:55,430] [INFO] [logging.py:96:log_dist] [Rank 0] step=6710, skipped=33, lr=[3.486067338799615e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:46:55,431] [INFO] [timer.py:258:stop] epoch=0/micro_step=6710/global_step=6710, RunningAvgSamplesPerSec=4.441707317589316, CurrSamplesPerSec=4.435754305153864, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:47:04,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=6720, skipped=33, lr=[3.473434943884863e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:47:04,546] [INFO] [timer.py:258:stop] epoch=0/micro_step=6720/global_step=6720, RunningAvgSamplesPerSec=4.441702087721425, CurrSamplesPerSec=4.442702140742102, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:47:13,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=6730, skipped=33, lr=[3.460822550349055e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:47:13,681] [INFO] [timer.py:258:stop] epoch=0/micro_step=6730/global_step=6730, RunningAvgSamplesPerSec=4.441693866847327, CurrSamplesPerSec=4.431766935962757, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:47:22,809] [INFO] [logging.py:96:log_dist] [Rank 0] step=6740, skipped=33, lr=[3.4482302826714286e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:47:22,810] [INFO] [timer.py:258:stop] epoch=0/micro_step=6740/global_step=6740, RunningAvgSamplesPerSec=4.4416830431853365, CurrSamplesPerSec=4.440554976205474, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:47:31,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=6750, skipped=33, lr=[3.435658265132579e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:47:31,940] [INFO] [timer.py:258:stop] epoch=0/micro_step=6750/global_step=6750, RunningAvgSamplesPerSec=4.441680039528863, CurrSamplesPerSec=4.441783521107929, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:47:31,943] [INFO] [RANK 0]  iteration     6750/   10000 | elapsed time per iteration (ms): 913.0 | learning rate 3.434E-05 | total loss 1.343438E+00 | loss 1.343438E+00 | loss scale 32768.0 |speed 262.86 samples/(min*GPU)
[2024-06-17 23:47:31,944] [INFO] [RANK 0] time (ms) | forward: 354.88 | backward: 552.15 | allreduce: 0.00 | optimizer: 5.16 | batch generator: 11.05 | data loader: 0.10
[2024-06-17 23:47:41,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=6760, skipped=33, lr=[3.423106621813244e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:47:41,062] [INFO] [timer.py:258:stop] epoch=0/micro_step=6760/global_step=6760, RunningAvgSamplesPerSec=4.441677819599574, CurrSamplesPerSec=4.439620796644593, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:47:50,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=6770, skipped=33, lr=[3.410575476593075e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:47:50,183] [INFO] [timer.py:258:stop] epoch=0/micro_step=6770/global_step=6770, RunningAvgSamplesPerSec=4.441679616802301, CurrSamplesPerSec=4.441183859256229, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:47:59,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=6780, skipped=33, lr=[3.398064953149418e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:47:59,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=6780/global_step=6780, RunningAvgSamplesPerSec=4.441675785566893, CurrSamplesPerSec=4.446605508185842, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:48:08,480] [INFO] [logging.py:96:log_dist] [Rank 0] step=6790, skipped=33, lr=[3.385575174956086e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:48:08,480] [INFO] [timer.py:258:stop] epoch=0/micro_step=6790/global_step=6790, RunningAvgSamplesPerSec=4.441676749120982, CurrSamplesPerSec=4.423186192728952, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:48:17,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=6800, skipped=33, lr=[3.3731062652821515e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:48:17,624] [INFO] [timer.py:258:stop] epoch=0/micro_step=6800/global_step=6800, RunningAvgSamplesPerSec=4.441662113256572, CurrSamplesPerSec=4.4399133464559215, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:48:17,625] [INFO] [RANK 0]  iteration     6800/   10000 | elapsed time per iteration (ms): 913.6 | learning rate 3.372E-05 | total loss 1.483545E+00 | loss 1.483545E+00 | loss scale 32768.0 |speed 262.69 samples/(min*GPU)
[2024-06-17 23:48:17,626] [INFO] [RANK 0] time (ms) | forward: 355.76 | backward: 552.03 | allreduce: 0.00 | optimizer: 5.05 | batch generator: 11.84 | data loader: 0.09
[2024-06-17 23:48:26,785] [INFO] [logging.py:96:log_dist] [Rank 0] step=6810, skipped=33, lr=[3.360658347190715e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:48:26,785] [INFO] [timer.py:258:stop] epoch=0/micro_step=6810/global_step=6810, RunningAvgSamplesPerSec=4.441655994090115, CurrSamplesPerSec=4.440007346546885, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:48:35,957] [INFO] [logging.py:96:log_dist] [Rank 0] step=6820, skipped=33, lr=[3.348231543537707e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:48:35,959] [INFO] [timer.py:258:stop] epoch=0/micro_step=6820/global_step=6820, RunningAvgSamplesPerSec=4.441650535338642, CurrSamplesPerSec=4.435377876005594, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:48:45,118] [INFO] [logging.py:96:log_dist] [Rank 0] step=6830, skipped=33, lr=[3.335825976970658e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:48:45,119] [INFO] [timer.py:258:stop] epoch=0/micro_step=6830/global_step=6830, RunningAvgSamplesPerSec=4.441646810276057, CurrSamplesPerSec=4.441170927156946, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:48:54,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=6840, skipped=33, lr=[3.323441769927506e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:48:54,267] [INFO] [timer.py:258:stop] epoch=0/micro_step=6840/global_step=6840, RunningAvgSamplesPerSec=4.4416368218338835, CurrSamplesPerSec=4.43933650806503, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:49:03,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=6850, skipped=33, lr=[3.311079044635372e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:49:03,412] [INFO] [timer.py:258:stop] epoch=0/micro_step=6850/global_step=6850, RunningAvgSamplesPerSec=4.441632900523436, CurrSamplesPerSec=4.447138263478085, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:49:03,414] [INFO] [RANK 0]  iteration     6850/   10000 | elapsed time per iteration (ms): 915.8 | learning rate 3.310E-05 | total loss 1.398652E+00 | loss 1.398652E+00 | loss scale 32768.0 |speed 262.07 samples/(min*GPU)
[2024-06-17 23:49:03,415] [INFO] [RANK 0] time (ms) | forward: 357.86 | backward: 552.22 | allreduce: 0.00 | optimizer: 4.86 | batch generator: 13.76 | data loader: 0.10
[2024-06-17 23:49:12,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=6860, skipped=33, lr=[3.298737923109363e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:49:12,539] [INFO] [timer.py:258:stop] epoch=0/micro_step=6860/global_step=6860, RunningAvgSamplesPerSec=4.441630289649996, CurrSamplesPerSec=4.4462932220674505, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:49:21,713] [INFO] [logging.py:96:log_dist] [Rank 0] step=6870, skipped=33, lr=[3.286418527151369e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:49:21,713] [INFO] [timer.py:258:stop] epoch=0/micro_step=6870/global_step=6870, RunningAvgSamplesPerSec=4.44161707725833, CurrSamplesPerSec=4.410767950637473, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:49:30,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=6880, skipped=33, lr=[3.274120978348852e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:49:30,878] [INFO] [timer.py:258:stop] epoch=0/micro_step=6880/global_step=6880, RunningAvgSamplesPerSec=4.4416119241948575, CurrSamplesPerSec=4.446072880523632, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:49:40,002] [INFO] [logging.py:96:log_dist] [Rank 0] step=6890, skipped=33, lr=[3.2618453980736553e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:49:40,003] [INFO] [timer.py:258:stop] epoch=0/micro_step=6890/global_step=6890, RunningAvgSamplesPerSec=4.441612787025324, CurrSamplesPerSec=4.437502430054758, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:49:49,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=6900, skipped=33, lr=[3.249591907480799e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:49:49,144] [INFO] [timer.py:258:stop] epoch=0/micro_step=6900/global_step=6900, RunningAvgSamplesPerSec=4.441605856206998, CurrSamplesPerSec=4.436184755712866, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:49:49,146] [INFO] [RANK 0]  iteration     6900/   10000 | elapsed time per iteration (ms): 914.6 | learning rate 3.248E-05 | total loss 1.407573E+00 | loss 1.407573E+00 | loss scale 32768.0 |speed 262.40 samples/(min*GPU)
[2024-06-17 23:49:49,149] [INFO] [RANK 0] time (ms) | forward: 356.89 | backward: 552.12 | allreduce: 0.00 | optimizer: 4.85 | batch generator: 12.72 | data loader: 0.10
[2024-06-17 23:49:49,152] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:49:49,174] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/6900/mp_rank_00_model_states.pt
[2024-06-17 23:49:49,174] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/6900/mp_rank_00_model_states.pt...
[2024-06-17 23:50:16,242] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/6900/mp_rank_00_model_states.pt.
[2024-06-17 23:50:24,412] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 23:50:25,316] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 23:50:25,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=6910, skipped=35, lr=[3.238582752584591e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:50:25,317] [INFO] [timer.py:258:stop] epoch=0/micro_step=6910/global_step=6910, RunningAvgSamplesPerSec=4.441654175219221, CurrSamplesPerSec=4.4929937301892515, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:50:34,373] [INFO] [logging.py:96:log_dist] [Rank 0] step=6920, skipped=35, lr=[3.2275916763041686e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:50:34,373] [INFO] [timer.py:258:stop] epoch=0/micro_step=6920/global_step=6920, RunningAvgSamplesPerSec=4.44170744854145, CurrSamplesPerSec=4.481681759012734, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:50:43,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=6930, skipped=35, lr=[3.215400679506259e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:50:43,457] [INFO] [timer.py:258:stop] epoch=0/micro_step=6930/global_step=6930, RunningAvgSamplesPerSec=4.441740688204098, CurrSamplesPerSec=4.46664185378825, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:50:52,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=6940, skipped=35, lr=[3.2032322307813117e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:50:52,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=6940/global_step=6940, RunningAvgSamplesPerSec=4.441757621524651, CurrSamplesPerSec=4.431123161821995, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:51:01,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=6950, skipped=35, lr=[3.1910864502270054e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:51:01,698] [INFO] [timer.py:258:stop] epoch=0/micro_step=6950/global_step=6950, RunningAvgSamplesPerSec=4.4417627307369, CurrSamplesPerSec=4.44679054367457, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:51:01,700] [INFO] [RANK 0]  iteration     6950/   10000 | elapsed time per iteration (ms): 1451.1 | learning rate 3.190E-05 | total loss 1.330127E+00 | loss 1.330127E+00 | loss scale 32768.0 |speed 165.40 samples/(min*GPU)
[2024-06-17 23:51:01,700] [INFO] [RANK 0] time (ms) | forward: 354.23 | backward: 549.30 | allreduce: 0.00 | optimizer: 4.64 | batch generator: 12.22 | data loader: 0.10
[2024-06-17 23:51:10,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=6960, skipped=35, lr=[3.178963457717287e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:51:10,826] [INFO] [timer.py:258:stop] epoch=0/micro_step=6960/global_step=6960, RunningAvgSamplesPerSec=4.44176802943672, CurrSamplesPerSec=4.439799376684221, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:51:19,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=6970, skipped=35, lr=[3.1668633729012026e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:51:19,953] [INFO] [timer.py:258:stop] epoch=0/micro_step=6970/global_step=6970, RunningAvgSamplesPerSec=4.441777041657756, CurrSamplesPerSec=4.455020722735953, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:51:29,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=6980, skipped=35, lr=[3.1547863152017005e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:51:29,083] [INFO] [timer.py:258:stop] epoch=0/micro_step=6980/global_step=6980, RunningAvgSamplesPerSec=4.441787602614711, CurrSamplesPerSec=4.44544732383648, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:51:38,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=6990, skipped=35, lr=[3.142732403814469e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:51:38,220] [INFO] [timer.py:258:stop] epoch=0/micro_step=6990/global_step=6990, RunningAvgSamplesPerSec=4.441793791820865, CurrSamplesPerSec=4.450377615395451, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:51:47,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=7000, skipped=35, lr=[3.1307017577067416e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:51:47,350] [INFO] [timer.py:258:stop] epoch=0/micro_step=7000/global_step=7000, RunningAvgSamplesPerSec=4.441799046673442, CurrSamplesPerSec=4.441027503468971, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:51:47,351] [INFO] [RANK 0]  iteration     7000/   10000 | elapsed time per iteration (ms): 913.0 | learning rate 3.129E-05 | total loss 1.451768E+00 | loss 1.451768E+00 | loss scale 32768.0 |speed 262.86 samples/(min*GPU)
[2024-06-17 23:51:47,353] [INFO] [RANK 0] time (ms) | forward: 355.98 | backward: 551.58 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 12.87 | data loader: 0.10
[2024-06-17 23:51:54,014] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 23:51:54,014] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 23:51:54,014] [INFO] [RANK 0]  validation loss at iteration 7000 | loss: 1.973730E+00 | PPL: 7.197476E+00 loss 1.974609E+00 |
[2024-06-17 23:51:54,014] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 23:52:03,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=7010, skipped=35, lr=[3.118694495616143e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:52:03,130] [INFO] [timer.py:258:stop] epoch=0/micro_step=7010/global_step=7010, RunningAvgSamplesPerSec=4.4418001120610775, CurrSamplesPerSec=4.437636235953199, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:52:12,280] [INFO] [logging.py:96:log_dist] [Rank 0] step=7020, skipped=35, lr=[3.106710736049501e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:52:12,281] [INFO] [timer.py:258:stop] epoch=0/micro_step=7020/global_step=7020, RunningAvgSamplesPerSec=4.441796396954244, CurrSamplesPerSec=4.422683643662348, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:52:21,426] [INFO] [logging.py:96:log_dist] [Rank 0] step=7030, skipped=35, lr=[3.094750597281683e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:52:21,426] [INFO] [timer.py:258:stop] epoch=0/micro_step=7030/global_step=7030, RunningAvgSamplesPerSec=4.441800069866847, CurrSamplesPerSec=4.438333565692284, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:52:30,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=7040, skipped=35, lr=[3.082814197354432e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:52:30,567] [INFO] [timer.py:258:stop] epoch=0/micro_step=7040/global_step=7040, RunningAvgSamplesPerSec=4.44179647181307, CurrSamplesPerSec=4.441571857258396, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:52:39,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=7050, skipped=35, lr=[3.070901654075195e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:52:39,691] [INFO] [timer.py:258:stop] epoch=0/micro_step=7050/global_step=7050, RunningAvgSamplesPerSec=4.441799051492605, CurrSamplesPerSec=4.447086396734798, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:52:39,693] [INFO] [RANK 0]  iteration     7050/   10000 | elapsed time per iteration (ms): 1046.8 | learning rate 3.070E-05 | total loss 1.397861E+00 | loss 1.397861E+00 | loss scale 32768.0 |speed 229.26 samples/(min*GPU)
[2024-06-17 23:52:39,693] [INFO] [RANK 0] time (ms) | forward: 356.09 | backward: 551.88 | allreduce: 0.00 | optimizer: 4.86 | batch generator: 15.03 | data loader: 0.15
[2024-06-17 23:52:48,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=7060, skipped=35, lr=[3.059013085015967e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:52:48,848] [INFO] [timer.py:258:stop] epoch=0/micro_step=7060/global_step=7060, RunningAvgSamplesPerSec=4.441798686926464, CurrSamplesPerSec=4.4476015814669125, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:52:57,986] [INFO] [logging.py:96:log_dist] [Rank 0] step=7070, skipped=35, lr=[3.0471486075121214e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:52:57,987] [INFO] [timer.py:258:stop] epoch=0/micro_step=7070/global_step=7070, RunningAvgSamplesPerSec=4.441803760199332, CurrSamplesPerSec=4.4503362975333935, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:53:07,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=7080, skipped=35, lr=[3.0353083386612657e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:53:07,140] [INFO] [timer.py:258:stop] epoch=0/micro_step=7080/global_step=7080, RunningAvgSamplesPerSec=4.441801302062243, CurrSamplesPerSec=4.425050469243961, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:53:16,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=7090, skipped=35, lr=[3.023492395322069e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:53:16,268] [INFO] [timer.py:258:stop] epoch=0/micro_step=7090/global_step=7090, RunningAvgSamplesPerSec=4.44180189615532, CurrSamplesPerSec=4.446006900139312, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:53:25,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=7100, skipped=35, lr=[3.0117008941131262e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:53:25,402] [INFO] [timer.py:258:stop] epoch=0/micro_step=7100/global_step=7100, RunningAvgSamplesPerSec=4.441799108597771, CurrSamplesPerSec=4.441591846870435, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:53:25,403] [INFO] [RANK 0]  iteration     7100/   10000 | elapsed time per iteration (ms): 914.2 | learning rate 3.011E-05 | total loss 1.426924E+00 | loss 1.426924E+00 | loss scale 32768.0 |speed 262.52 samples/(min*GPU)
[2024-06-17 23:53:25,404] [INFO] [RANK 0] time (ms) | forward: 356.42 | backward: 552.20 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 13.08 | data loader: 0.16
[2024-06-17 23:53:34,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=7110, skipped=35, lr=[2.9999339514117912e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:53:34,552] [INFO] [timer.py:258:stop] epoch=0/micro_step=7110/global_step=7110, RunningAvgSamplesPerSec=4.441789070392026, CurrSamplesPerSec=4.44641106073247, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:53:43,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=7120, skipped=35, lr=[2.9881916833530368e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:53:43,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=7120/global_step=7120, RunningAvgSamplesPerSec=4.441789844372717, CurrSamplesPerSec=4.4334685703972205, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:53:52,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=7130, skipped=35, lr=[2.9764742058283115e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:53:52,831] [INFO] [timer.py:258:stop] epoch=0/micro_step=7130/global_step=7130, RunningAvgSamplesPerSec=4.441784872611714, CurrSamplesPerSec=4.441651816786141, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:54:01,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=7140, skipped=35, lr=[2.9647816344843838e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:54:01,963] [INFO] [timer.py:258:stop] epoch=0/micro_step=7140/global_step=7140, RunningAvgSamplesPerSec=4.441787795645802, CurrSamplesPerSec=4.43589738844101, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:54:11,115] [INFO] [logging.py:96:log_dist] [Rank 0] step=7150, skipped=35, lr=[2.9531140847222163e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:54:11,116] [INFO] [timer.py:258:stop] epoch=0/micro_step=7150/global_step=7150, RunningAvgSamplesPerSec=4.441791959521296, CurrSamplesPerSec=4.4366938977137975, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:54:11,117] [INFO] [RANK 0]  iteration     7150/   10000 | elapsed time per iteration (ms): 914.3 | learning rate 2.952E-05 | total loss 1.448379E+00 | loss 1.448379E+00 | loss scale 32768.0 |speed 262.50 samples/(min*GPU)
[2024-06-17 23:54:11,118] [INFO] [RANK 0] time (ms) | forward: 356.71 | backward: 552.04 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 12.96 | data loader: 0.19
[2024-06-17 23:54:20,239] [INFO] [logging.py:96:log_dist] [Rank 0] step=7160, skipped=35, lr=[2.941471671695812e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:54:20,240] [INFO] [timer.py:258:stop] epoch=0/micro_step=7160/global_step=7160, RunningAvgSamplesPerSec=4.441796860923448, CurrSamplesPerSec=4.447899900873317, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:54:29,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=7170, skipped=35, lr=[2.9298545103110903e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:54:29,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=7170/global_step=7170, RunningAvgSamplesPerSec=4.441796808188932, CurrSamplesPerSec=4.438717542775383, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:54:38,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=7180, skipped=35, lr=[2.9182627152247397e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:54:38,465] [INFO] [timer.py:258:stop] epoch=0/micro_step=7180/global_step=7180, RunningAvgSamplesPerSec=4.441799506148622, CurrSamplesPerSec=4.447048676226846, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:54:47,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=7190, skipped=35, lr=[2.9066964008431023e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:54:47,561] [INFO] [timer.py:258:stop] epoch=0/micro_step=7190/global_step=7190, RunningAvgSamplesPerSec=4.441807599099637, CurrSamplesPerSec=4.444893776434021, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:54:56,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=7200, skipped=35, lr=[2.8951556813210283e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:54:56,690] [INFO] [timer.py:258:stop] epoch=0/micro_step=7200/global_step=7200, RunningAvgSamplesPerSec=4.441811488141677, CurrSamplesPerSec=4.441130955689853, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:54:56,692] [INFO] [RANK 0]  iteration     7200/   10000 | elapsed time per iteration (ms): 911.5 | learning rate 2.894E-05 | total loss 1.418682E+00 | loss 1.418682E+00 | loss scale 32768.0 |speed 263.30 samples/(min*GPU)
[2024-06-17 23:54:56,693] [INFO] [RANK 0] time (ms) | forward: 353.82 | backward: 552.20 | allreduce: 0.00 | optimizer: 4.72 | batch generator: 10.97 | data loader: 0.21
[2024-06-17 23:54:56,694] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:54:56,707] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/7200/mp_rank_00_model_states.pt
[2024-06-17 23:54:56,707] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/7200/mp_rank_00_model_states.pt...
[2024-06-17 23:55:21,753] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/7200/mp_rank_00_model_states.pt.
[2024-06-17 23:55:30,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=7210, skipped=35, lr=[2.8836406705607624e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:55:30,886] [INFO] [timer.py:258:stop] epoch=0/micro_step=7210/global_step=7210, RunningAvgSamplesPerSec=4.441836590158519, CurrSamplesPerSec=4.479471644351031, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:55:39,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=7220, skipped=35, lr=[2.872151482210812e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:55:39,953] [INFO] [timer.py:258:stop] epoch=0/micro_step=7220/global_step=7220, RunningAvgSamplesPerSec=4.4418886397997435, CurrSamplesPerSec=4.4763641835709915, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:55:49,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=7230, skipped=35, lr=[2.8606882296648244e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:55:49,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=7230/global_step=7230, RunningAvgSamplesPerSec=4.441911840343344, CurrSamplesPerSec=4.452971551194446, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:55:58,185] [INFO] [logging.py:96:log_dist] [Rank 0] step=7240, skipped=35, lr=[2.849251026060479e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:55:58,186] [INFO] [timer.py:258:stop] epoch=0/micro_step=7240/global_step=7240, RunningAvgSamplesPerSec=4.441926661682255, CurrSamplesPerSec=4.4545097314531015, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:56:07,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=7250, skipped=35, lr=[2.8378399842783535e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:56:07,303] [INFO] [timer.py:258:stop] epoch=0/micro_step=7250/global_step=7250, RunningAvgSamplesPerSec=4.441945452607751, CurrSamplesPerSec=4.451319870853158, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:56:07,304] [INFO] [RANK 0]  iteration     7250/   10000 | elapsed time per iteration (ms): 1412.2 | learning rate 2.837E-05 | total loss 1.539150E+00 | loss 1.539150E+00 | loss scale 32768.0 |speed 169.94 samples/(min*GPU)
[2024-06-17 23:56:07,305] [INFO] [RANK 0] time (ms) | forward: 355.54 | backward: 549.58 | allreduce: 0.00 | optimizer: 4.92 | batch generator: 13.57 | data loader: 0.11
[2024-06-17 23:56:16,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=7260, skipped=35, lr=[2.826455216940827e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:56:16,460] [INFO] [timer.py:258:stop] epoch=0/micro_step=7260/global_step=7260, RunningAvgSamplesPerSec=4.441945348425909, CurrSamplesPerSec=4.449795694492849, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:56:25,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=7270, skipped=35, lr=[2.8150968364109545e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:56:25,610] [INFO] [timer.py:258:stop] epoch=0/micro_step=7270/global_step=7270, RunningAvgSamplesPerSec=4.441946173171863, CurrSamplesPerSec=4.4422927729008, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:56:34,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=7280, skipped=35, lr=[2.803764954791369e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:56:34,754] [INFO] [timer.py:258:stop] epoch=0/micro_step=7280/global_step=7280, RunningAvgSamplesPerSec=4.441951965684518, CurrSamplesPerSec=4.446528905643735, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:56:43,884] [INFO] [logging.py:96:log_dist] [Rank 0] step=7290, skipped=35, lr=[2.792459683923164e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:56:43,885] [INFO] [timer.py:258:stop] epoch=0/micro_step=7290/global_step=7290, RunningAvgSamplesPerSec=4.441957890453099, CurrSamplesPerSec=4.448837568208709, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:56:53,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=7300, skipped=35, lr=[2.7811811353848024e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:56:53,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=7300/global_step=7300, RunningAvgSamplesPerSec=4.441955941897081, CurrSamplesPerSec=4.442204556954249, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:56:53,005] [INFO] [RANK 0]  iteration     7300/   10000 | elapsed time per iteration (ms): 914.0 | learning rate 2.780E-05 | total loss 1.357046E+00 | loss 1.357046E+00 | loss scale 32768.0 |speed 262.58 samples/(min*GPU)
[2024-06-17 23:56:53,006] [INFO] [RANK 0] time (ms) | forward: 356.65 | backward: 551.76 | allreduce: 0.00 | optimizer: 4.81 | batch generator: 13.13 | data loader: 0.11
[2024-06-17 23:57:02,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=7310, skipped=35, lr=[2.7699294204910024e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:57:02,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=7310/global_step=7310, RunningAvgSamplesPerSec=4.441954905339927, CurrSamplesPerSec=4.438156277594278, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:57:03,039] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 23:57:03,946] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 23:57:11,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=7320, skipped=37, lr=[2.7609474434344946e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:57:11,245] [INFO] [timer.py:258:stop] epoch=0/micro_step=7320/global_step=7320, RunningAvgSamplesPerSec=4.441957757041579, CurrSamplesPerSec=4.441441341273132, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:57:20,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=7330, skipped=37, lr=[2.749744308767941e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:57:20,383] [INFO] [timer.py:258:stop] epoch=0/micro_step=7330/global_step=7330, RunningAvgSamplesPerSec=4.441952240810142, CurrSamplesPerSec=4.432955483152106, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:57:29,527] [INFO] [logging.py:96:log_dist] [Rank 0] step=7340, skipped=37, lr=[2.7385683180147382e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:57:29,528] [INFO] [timer.py:258:stop] epoch=0/micro_step=7340/global_step=7340, RunningAvgSamplesPerSec=4.4419515776677585, CurrSamplesPerSec=4.449020429908212, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:57:38,656] [INFO] [logging.py:96:log_dist] [Rank 0] step=7350, skipped=37, lr=[2.7274195814774006e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:57:38,657] [INFO] [timer.py:258:stop] epoch=0/micro_step=7350/global_step=7350, RunningAvgSamplesPerSec=4.441956157847822, CurrSamplesPerSec=4.44575242271441, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:57:38,658] [INFO] [RANK 0]  iteration     7350/   10000 | elapsed time per iteration (ms): 913.1 | learning rate 2.726E-05 | total loss 1.318101E+00 | loss 1.318101E+00 | loss scale 32768.0 |speed 262.85 samples/(min*GPU)
[2024-06-17 23:57:38,659] [INFO] [RANK 0] time (ms) | forward: 355.43 | backward: 552.10 | allreduce: 0.00 | optimizer: 4.74 | batch generator: 11.95 | data loader: 0.11
[2024-06-17 23:57:47,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=7360, skipped=37, lr=[2.716298209189459e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:57:47,794] [INFO] [timer.py:258:stop] epoch=0/micro_step=7360/global_step=7360, RunningAvgSamplesPerSec=4.441956020872666, CurrSamplesPerSec=4.444953835548098, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:57:56,937] [INFO] [logging.py:96:log_dist] [Rank 0] step=7370, skipped=37, lr=[2.7052043109143653e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:57:56,938] [INFO] [timer.py:258:stop] epoch=0/micro_step=7370/global_step=7370, RunningAvgSamplesPerSec=4.441951496244487, CurrSamplesPerSec=4.443498742079897, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:58:06,079] [INFO] [logging.py:96:log_dist] [Rank 0] step=7380, skipped=37, lr=[2.6941379961444193e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:58:06,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=7380/global_step=7380, RunningAvgSamplesPerSec=4.44194887596895, CurrSamplesPerSec=4.442098702443056, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:58:15,239] [INFO] [logging.py:96:log_dist] [Rank 0] step=7390, skipped=37, lr=[2.6830993740996798e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:58:15,240] [INFO] [timer.py:258:stop] epoch=0/micro_step=7390/global_step=7390, RunningAvgSamplesPerSec=4.441935274494436, CurrSamplesPerSec=4.436442831523116, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:58:24,377] [INFO] [logging.py:96:log_dist] [Rank 0] step=7400, skipped=37, lr=[2.6720885537268868e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:58:24,378] [INFO] [timer.py:258:stop] epoch=0/micro_step=7400/global_step=7400, RunningAvgSamplesPerSec=4.441924164010843, CurrSamplesPerSec=4.4356135764988744, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:58:24,379] [INFO] [RANK 0]  iteration     7400/   10000 | elapsed time per iteration (ms): 914.4 | learning rate 2.671E-05 | total loss 1.357578E+00 | loss 1.357578E+00 | loss scale 32768.0 |speed 262.46 samples/(min*GPU)
[2024-06-17 23:58:24,380] [INFO] [RANK 0] time (ms) | forward: 356.65 | backward: 552.12 | allreduce: 0.00 | optimizer: 4.83 | batch generator: 12.32 | data loader: 0.11
[2024-06-17 23:58:33,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=7410, skipped=37, lr=[2.6611056436983965e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:58:33,536] [INFO] [timer.py:258:stop] epoch=0/micro_step=7410/global_step=7410, RunningAvgSamplesPerSec=4.441913358060761, CurrSamplesPerSec=4.434881931412871, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:58:42,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=7420, skipped=37, lr=[2.6501507524110933e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:58:42,680] [INFO] [timer.py:258:stop] epoch=0/micro_step=7420/global_step=7420, RunningAvgSamplesPerSec=4.441918300480432, CurrSamplesPerSec=4.442666847439243, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:58:51,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=7430, skipped=37, lr=[2.6392239879853344e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:58:51,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=7430/global_step=7430, RunningAvgSamplesPerSec=4.441919240442972, CurrSamplesPerSec=4.433458026313425, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:59:00,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=7440, skipped=37, lr=[2.6283254582638708e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:59:00,931] [INFO] [timer.py:258:stop] epoch=0/micro_step=7440/global_step=7440, RunningAvgSamplesPerSec=4.441919028877259, CurrSamplesPerSec=4.440279969320461, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:59:10,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=7450, skipped=37, lr=[2.617455270810794e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:59:10,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=7450/global_step=7450, RunningAvgSamplesPerSec=4.441917975010534, CurrSamplesPerSec=4.435853993354105, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:59:10,057] [INFO] [RANK 0]  iteration     7450/   10000 | elapsed time per iteration (ms): 913.6 | learning rate 2.616E-05 | total loss 1.419395E+00 | loss 1.419395E+00 | loss scale 32768.0 |speed 262.71 samples/(min*GPU)
[2024-06-17 23:59:10,058] [INFO] [RANK 0] time (ms) | forward: 355.85 | backward: 552.12 | allreduce: 0.00 | optimizer: 4.81 | batch generator: 12.28 | data loader: 0.09
[2024-06-17 23:59:19,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=7460, skipped=37, lr=[2.606613532910462e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:59:19,195] [INFO] [timer.py:258:stop] epoch=0/micro_step=7460/global_step=7460, RunningAvgSamplesPerSec=4.441921165465768, CurrSamplesPerSec=4.444003678698724, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:59:28,353] [INFO] [logging.py:96:log_dist] [Rank 0] step=7470, skipped=37, lr=[2.595800351566455e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:59:28,354] [INFO] [timer.py:258:stop] epoch=0/micro_step=7470/global_step=7470, RunningAvgSamplesPerSec=4.441923521570138, CurrSamplesPerSec=4.438765691378396, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:59:37,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=7480, skipped=37, lr=[2.5850158335005048e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:59:37,508] [INFO] [timer.py:258:stop] epoch=0/micro_step=7480/global_step=7480, RunningAvgSamplesPerSec=4.441929297908878, CurrSamplesPerSec=4.435560805555364, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:59:46,658] [INFO] [logging.py:96:log_dist] [Rank 0] step=7490, skipped=37, lr=[2.5742600851514507e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:59:46,659] [INFO] [timer.py:258:stop] epoch=0/micro_step=7490/global_step=7490, RunningAvgSamplesPerSec=4.441926497646544, CurrSamplesPerSec=4.430982726864081, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:59:55,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=7500, skipped=37, lr=[2.563533212674186e-05], mom=[[0.9, 0.95]]
[2024-06-17 23:59:55,774] [INFO] [timer.py:258:stop] epoch=0/micro_step=7500/global_step=7500, RunningAvgSamplesPerSec=4.4419244241586044, CurrSamplesPerSec=4.441670631211064, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-17 23:59:55,774] [INFO] [RANK 0]  iteration     7500/   10000 | elapsed time per iteration (ms): 914.3 | learning rate 2.562E-05 | total loss 1.449600E+00 | loss 1.449600E+00 | loss scale 32768.0 |speed 262.48 samples/(min*GPU)
[2024-06-17 23:59:55,775] [INFO] [RANK 0] time (ms) | forward: 356.57 | backward: 552.15 | allreduce: 0.00 | optimizer: 4.83 | batch generator: 13.44 | data loader: 0.09
[2024-06-17 23:59:55,775] [INFO] [RANK 0] Saving Model...
[2024-06-17 23:59:55,787] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/7500/mp_rank_00_model_states.pt
[2024-06-17 23:59:55,788] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/7500/mp_rank_00_model_states.pt...
[2024-06-18 00:00:22,769] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/7500/mp_rank_00_model_states.pt.
[2024-06-18 00:00:31,874] [INFO] [logging.py:96:log_dist] [Rank 0] step=7510, skipped=37, lr=[2.552835321938614e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:00:31,875] [INFO] [timer.py:258:stop] epoch=0/micro_step=7510/global_step=7510, RunningAvgSamplesPerSec=4.441953790265093, CurrSamplesPerSec=4.466923703838011, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:00:40,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=7520, skipped=37, lr=[2.5421665185285962e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:00:40,949] [INFO] [timer.py:258:stop] epoch=0/micro_step=7520/global_step=7520, RunningAvgSamplesPerSec=4.441991238726047, CurrSamplesPerSec=4.431208597442943, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:00:50,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=7530, skipped=37, lr=[2.531526907740913e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:00:50,057] [INFO] [timer.py:258:stop] epoch=0/micro_step=7530/global_step=7530, RunningAvgSamplesPerSec=4.442020895594887, CurrSamplesPerSec=4.467444684895694, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:00:59,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=7540, skipped=37, lr=[2.5209165945842312e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:00:59,180] [INFO] [timer.py:258:stop] epoch=0/micro_step=7540/global_step=7540, RunningAvgSamplesPerSec=4.442033119084378, CurrSamplesPerSec=4.447852733086408, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:01:08,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=7550, skipped=37, lr=[2.510335683778055e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:01:08,309] [INFO] [timer.py:258:stop] epoch=0/micro_step=7550/global_step=7550, RunningAvgSamplesPerSec=4.442042324025914, CurrSamplesPerSec=4.443303389468259, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:01:08,310] [INFO] [RANK 0]  iteration     7550/   10000 | elapsed time per iteration (ms): 1450.7 | learning rate 2.509E-05 | total loss 1.263184E+00 | loss 1.263184E+00 | loss scale 32768.0 |speed 165.43 samples/(min*GPU)
[2024-06-18 00:01:08,311] [INFO] [RANK 0] time (ms) | forward: 355.48 | backward: 549.43 | allreduce: 0.00 | optimizer: 4.86 | batch generator: 13.08 | data loader: 0.11
[2024-06-18 00:01:17,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=7560, skipped=37, lr=[2.4997842797517046e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:01:17,438] [INFO] [timer.py:258:stop] epoch=0/micro_step=7560/global_step=7560, RunningAvgSamplesPerSec=4.442039957715956, CurrSamplesPerSec=4.43933650806503, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:01:26,547] [INFO] [logging.py:96:log_dist] [Rank 0] step=7570, skipped=37, lr=[2.489262486643275e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:01:26,548] [INFO] [timer.py:258:stop] epoch=0/micro_step=7570/global_step=7570, RunningAvgSamplesPerSec=4.44205092953864, CurrSamplesPerSec=4.451549000769201, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:01:35,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=7580, skipped=37, lr=[2.4787704082986207e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:01:35,662] [INFO] [timer.py:258:stop] epoch=0/micro_step=7580/global_step=7580, RunningAvgSamplesPerSec=4.442054849310573, CurrSamplesPerSec=4.44276802307445, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:01:44,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=7590, skipped=37, lr=[2.4683081482703147e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:01:44,816] [INFO] [timer.py:258:stop] epoch=0/micro_step=7590/global_step=7590, RunningAvgSamplesPerSec=4.4420476940633415, CurrSamplesPerSec=4.421999381133643, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:01:53,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=7600, skipped=37, lr=[2.4578758098166437e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:01:53,949] [INFO] [timer.py:258:stop] epoch=0/micro_step=7600/global_step=7600, RunningAvgSamplesPerSec=4.442049553373872, CurrSamplesPerSec=4.445543914317662, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:01:53,950] [INFO] [RANK 0]  iteration     7600/   10000 | elapsed time per iteration (ms): 912.8 | learning rate 2.457E-05 | total loss 1.461592E+00 | loss 1.461592E+00 | loss scale 32768.0 |speed 262.93 samples/(min*GPU)
[2024-06-18 00:01:53,951] [INFO] [RANK 0] time (ms) | forward: 355.28 | backward: 551.87 | allreduce: 0.00 | optimizer: 4.82 | batch generator: 11.92 | data loader: 0.10
[2024-06-18 00:02:03,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=7610, skipped=37, lr=[2.4474734959005747e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:02:03,081] [INFO] [timer.py:258:stop] epoch=0/micro_step=7610/global_step=7610, RunningAvgSamplesPerSec=4.442048990501466, CurrSamplesPerSec=4.4441708391764365, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:02:12,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=7620, skipped=37, lr=[2.4371013091887442e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:02:12,232] [INFO] [timer.py:258:stop] epoch=0/micro_step=7620/global_step=7620, RunningAvgSamplesPerSec=4.44203934015902, CurrSamplesPerSec=4.440479757262898, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:02:21,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=7630, skipped=37, lr=[2.4267593520504516e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:02:21,362] [INFO] [timer.py:258:stop] epoch=0/micro_step=7630/global_step=7630, RunningAvgSamplesPerSec=4.442040598090405, CurrSamplesPerSec=4.424631511821502, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:02:30,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=7640, skipped=37, lr=[2.4164477265566353e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:02:30,515] [INFO] [timer.py:258:stop] epoch=0/micro_step=7640/global_step=7640, RunningAvgSamplesPerSec=4.442033629414927, CurrSamplesPerSec=4.4375916330904595, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:02:39,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=7650, skipped=37, lr=[2.4061665344788798e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:02:39,651] [INFO] [timer.py:258:stop] epoch=0/micro_step=7650/global_step=7650, RunningAvgSamplesPerSec=4.442025718179258, CurrSamplesPerSec=4.436409983843288, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:02:39,653] [INFO] [RANK 0]  iteration     7650/   10000 | elapsed time per iteration (ms): 914.1 | learning rate 2.405E-05 | total loss 1.404600E+00 | loss 1.404600E+00 | loss scale 32768.0 |speed 262.57 samples/(min*GPU)
[2024-06-18 00:02:39,654] [INFO] [RANK 0] time (ms) | forward: 356.26 | backward: 552.15 | allreduce: 0.00 | optimizer: 4.84 | batch generator: 12.25 | data loader: 0.09
[2024-06-18 00:02:48,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=7660, skipped=37, lr=[2.3959158772883955e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:02:48,794] [INFO] [timer.py:258:stop] epoch=0/micro_step=7660/global_step=7660, RunningAvgSamplesPerSec=4.442020624573677, CurrSamplesPerSec=4.426708404595464, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:02:57,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=7670, skipped=37, lr=[2.3856958561550342e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:02:57,928] [INFO] [timer.py:258:stop] epoch=0/micro_step=7670/global_step=7670, RunningAvgSamplesPerSec=4.442017330792499, CurrSamplesPerSec=4.440578482647638, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:03:07,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=7680, skipped=37, lr=[2.3755065719462758e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:03:07,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=7680/global_step=7680, RunningAvgSamplesPerSec=4.442015038638783, CurrSamplesPerSec=4.439505667130537, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:03:16,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=7690, skipped=37, lr=[2.3653481252262456e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:03:16,216] [INFO] [timer.py:258:stop] epoch=0/micro_step=7690/global_step=7690, RunningAvgSamplesPerSec=4.442008125357822, CurrSamplesPerSec=4.439102760849824, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:03:25,353] [INFO] [logging.py:96:log_dist] [Rank 0] step=7700, skipped=37, lr=[2.355220616254707e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:03:25,353] [INFO] [timer.py:258:stop] epoch=0/micro_step=7700/global_step=7700, RunningAvgSamplesPerSec=4.442003113349215, CurrSamplesPerSec=4.443618786542447, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:03:25,355] [INFO] [RANK 0]  iteration     7700/   10000 | elapsed time per iteration (ms): 914.0 | learning rate 2.354E-05 | total loss 1.387012E+00 | loss 1.387012E+00 | loss scale 32768.0 |speed 262.57 samples/(min*GPU)
[2024-06-18 00:03:25,355] [INFO] [RANK 0] time (ms) | forward: 356.09 | backward: 552.18 | allreduce: 0.00 | optimizer: 4.95 | batch generator: 12.16 | data loader: 0.10
[2024-06-18 00:03:34,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=7710, skipped=37, lr=[2.3451241449860888e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:03:34,509] [INFO] [timer.py:258:stop] epoch=0/micro_step=7710/global_step=7710, RunningAvgSamplesPerSec=4.4419925900834105, CurrSamplesPerSec=4.442899793601269, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:03:37,247] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 00:03:38,161] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 00:03:43,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=7720, skipped=39, lr=[2.337069382091133e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:03:43,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=7720/global_step=7720, RunningAvgSamplesPerSec=4.441995722618925, CurrSamplesPerSec=4.43046553487075, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:03:52,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=7730, skipped=39, lr=[2.3270290295944868e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:03:52,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=7730/global_step=7730, RunningAvgSamplesPerSec=4.441989287615134, CurrSamplesPerSec=4.432594753187942, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:04:01,954] [INFO] [logging.py:96:log_dist] [Rank 0] step=7740, skipped=39, lr=[2.3170199930403376e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:04:01,955] [INFO] [timer.py:258:stop] epoch=0/micro_step=7740/global_step=7740, RunningAvgSamplesPerSec=4.441982377129758, CurrSamplesPerSec=4.43726535520808, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:04:11,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=7750, skipped=39, lr=[2.3070423712138368e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:04:11,102] [INFO] [timer.py:258:stop] epoch=0/micro_step=7750/global_step=7750, RunningAvgSamplesPerSec=4.441976393877248, CurrSamplesPerSec=4.4400202718706625, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:04:11,104] [INFO] [RANK 0]  iteration     7750/   10000 | elapsed time per iteration (ms): 915.0 | learning rate 2.306E-05 | total loss 1.386812E+00 | loss 1.386812E+00 | loss scale 32768.0 |speed 262.30 samples/(min*GPU)
[2024-06-18 00:04:11,105] [INFO] [RANK 0] time (ms) | forward: 357.21 | backward: 552.08 | allreduce: 0.00 | optimizer: 4.83 | batch generator: 13.03 | data loader: 0.10
[2024-06-18 00:04:20,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=7760, skipped=39, lr=[2.2970962625900824e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:04:20,257] [INFO] [timer.py:258:stop] epoch=0/micro_step=7760/global_step=7760, RunningAvgSamplesPerSec=4.441973811765707, CurrSamplesPerSec=4.419853546322377, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:04:29,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=7770, skipped=39, lr=[2.287181765333153e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:04:29,422] [INFO] [timer.py:258:stop] epoch=0/micro_step=7770/global_step=7770, RunningAvgSamplesPerSec=4.441966962321827, CurrSamplesPerSec=4.440846473679251, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:04:38,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=7780, skipped=39, lr=[2.2772989772951307e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:04:38,573] [INFO] [timer.py:258:stop] epoch=0/micro_step=7780/global_step=7780, RunningAvgSamplesPerSec=4.441961332427273, CurrSamplesPerSec=4.447015671307297, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:04:47,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=7790, skipped=39, lr=[2.2674479960151474e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:04:47,705] [INFO] [timer.py:258:stop] epoch=0/micro_step=7790/global_step=7790, RunningAvgSamplesPerSec=4.4419607374531385, CurrSamplesPerSec=4.445092802073378, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:04:56,834] [INFO] [logging.py:96:log_dist] [Rank 0] step=7800, skipped=39, lr=[2.257628918718409e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:04:56,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=7800/global_step=7800, RunningAvgSamplesPerSec=4.44195801087069, CurrSamplesPerSec=4.4488729596225625, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:04:56,836] [INFO] [RANK 0]  iteration     7800/   10000 | elapsed time per iteration (ms): 914.6 | learning rate 2.257E-05 | total loss 1.406697E+00 | loss 1.406697E+00 | loss scale 32768.0 |speed 262.40 samples/(min*GPU)
[2024-06-18 00:04:56,836] [INFO] [RANK 0] time (ms) | forward: 356.72 | backward: 551.96 | allreduce: 0.00 | optimizer: 5.12 | batch generator: 12.76 | data loader: 0.09
[2024-06-18 00:04:56,837] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:04:56,850] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/7800/mp_rank_00_model_states.pt
[2024-06-18 00:04:56,850] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/7800/mp_rank_00_model_states.pt...
[2024-06-18 00:05:19,427] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/7800/mp_rank_00_model_states.pt.
[2024-06-18 00:05:28,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=7810, skipped=39, lr=[2.2478418423152437e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:05:28,527] [INFO] [timer.py:258:stop] epoch=0/micro_step=7810/global_step=7810, RunningAvgSamplesPerSec=4.441993908253066, CurrSamplesPerSec=4.475545010699875, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:05:37,620] [INFO] [logging.py:96:log_dist] [Rank 0] step=7820, skipped=39, lr=[2.2380868634001458e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:05:37,621] [INFO] [timer.py:258:stop] epoch=0/micro_step=7820/global_step=7820, RunningAvgSamplesPerSec=4.442020141955291, CurrSamplesPerSec=4.458668486573009, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:05:46,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=7830, skipped=39, lr=[2.228364078250818e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:05:46,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=7830/global_step=7830, RunningAvgSamplesPerSec=4.442050429220171, CurrSamplesPerSec=4.458754987697853, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:05:55,850] [INFO] [logging.py:96:log_dist] [Rank 0] step=7840, skipped=39, lr=[2.218673582827226e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:05:55,851] [INFO] [timer.py:258:stop] epoch=0/micro_step=7840/global_step=7840, RunningAvgSamplesPerSec=4.442067939675084, CurrSamplesPerSec=4.454762846741881, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:06:04,978] [INFO] [logging.py:96:log_dist] [Rank 0] step=7850, skipped=39, lr=[2.2090154727706457e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:06:04,978] [INFO] [timer.py:258:stop] epoch=0/micro_step=7850/global_step=7850, RunningAvgSamplesPerSec=4.4420766708857755, CurrSamplesPerSec=4.441366092299384, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:06:04,982] [INFO] [RANK 0]  iteration     7850/   10000 | elapsed time per iteration (ms): 1362.9 | learning rate 2.208E-05 | total loss 1.472720E+00 | loss 1.472720E+00 | loss scale 32768.0 |speed 176.09 samples/(min*GPU)
[2024-06-18 00:06:04,988] [INFO] [RANK 0] time (ms) | forward: 356.07 | backward: 549.06 | allreduce: 0.00 | optimizer: 4.92 | batch generator: 13.28 | data loader: 0.11
[2024-06-18 00:06:14,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=7860, skipped=39, lr=[2.1993898434027255e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:06:14,126] [INFO] [timer.py:258:stop] epoch=0/micro_step=7860/global_step=7860, RunningAvgSamplesPerSec=4.442083630836559, CurrSamplesPerSec=4.451785241873148, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:06:23,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=7870, skipped=39, lr=[2.1897967897245395e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:06:23,254] [INFO] [timer.py:258:stop] epoch=0/micro_step=7870/global_step=7870, RunningAvgSamplesPerSec=4.442090119587191, CurrSamplesPerSec=4.441676510751541, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:06:32,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=7880, skipped=39, lr=[2.1802364064156577e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:06:32,405] [INFO] [timer.py:258:stop] epoch=0/micro_step=7880/global_step=7880, RunningAvgSamplesPerSec=4.442088819691497, CurrSamplesPerSec=4.445665247333152, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:06:41,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=7890, skipped=39, lr=[2.1707087878332013e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:06:41,535] [INFO] [timer.py:258:stop] epoch=0/micro_step=7890/global_step=7890, RunningAvgSamplesPerSec=4.442088146940981, CurrSamplesPerSec=4.4431492377860655, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:06:50,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=7900, skipped=39, lr=[2.161214028010919e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:06:50,652] [INFO] [timer.py:258:stop] epoch=0/micro_step=7900/global_step=7900, RunningAvgSamplesPerSec=4.442087172704223, CurrSamplesPerSec=4.4334744282432235, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:06:50,653] [INFO] [RANK 0]  iteration     7900/   10000 | elapsed time per iteration (ms): 913.4 | learning rate 2.160E-05 | total loss 1.420039E+00 | loss 1.420039E+00 | loss scale 32768.0 |speed 262.75 samples/(min*GPU)
[2024-06-18 00:06:50,655] [INFO] [RANK 0] time (ms) | forward: 356.10 | backward: 551.59 | allreduce: 0.00 | optimizer: 4.84 | batch generator: 12.55 | data loader: 0.09
[2024-06-18 00:06:59,795] [INFO] [logging.py:96:log_dist] [Rank 0] step=7910, skipped=39, lr=[2.1517522206582583e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:06:59,796] [INFO] [timer.py:258:stop] epoch=0/micro_step=7910/global_step=7910, RunningAvgSamplesPerSec=4.442077202867759, CurrSamplesPerSec=4.441555395360055, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:07:08,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=7920, skipped=39, lr=[2.1423234591594365e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:07:08,940] [INFO] [timer.py:258:stop] epoch=0/micro_step=7920/global_step=7920, RunningAvgSamplesPerSec=4.442064133337812, CurrSamplesPerSec=4.4372747438291675, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:07:18,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=7930, skipped=39, lr=[2.1329278365725258e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:07:18,064] [INFO] [timer.py:258:stop] epoch=0/micro_step=7930/global_step=7930, RunningAvgSamplesPerSec=4.442063900714516, CurrSamplesPerSec=4.4422927729008, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:07:27,207] [INFO] [logging.py:96:log_dist] [Rank 0] step=7940, skipped=39, lr=[2.123565445628524e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:07:27,207] [INFO] [timer.py:258:stop] epoch=0/micro_step=7940/global_step=7940, RunningAvgSamplesPerSec=4.4420588661402745, CurrSamplesPerSec=4.446936697238466, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:07:36,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=7950, skipped=39, lr=[2.1142363787304532e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:07:36,342] [INFO] [timer.py:258:stop] epoch=0/micro_step=7950/global_step=7950, RunningAvgSamplesPerSec=4.442056279776648, CurrSamplesPerSec=4.4449420591233, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:07:36,343] [INFO] [RANK 0]  iteration     7950/   10000 | elapsed time per iteration (ms): 913.8 | learning rate 2.113E-05 | total loss 1.448721E+00 | loss 1.448721E+00 | loss scale 32768.0 |speed 262.64 samples/(min*GPU)
[2024-06-18 00:07:36,344] [INFO] [RANK 0] time (ms) | forward: 355.95 | backward: 552.19 | allreduce: 0.00 | optimizer: 4.87 | batch generator: 11.71 | data loader: 0.09
[2024-06-18 00:07:39,084] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
[2024-06-18 00:07:45,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=7960, skipped=40, lr=[2.1058687866875328e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:07:45,504] [INFO] [timer.py:258:stop] epoch=0/micro_step=7960/global_step=7960, RunningAvgSamplesPerSec=4.442045386177288, CurrSamplesPerSec=4.443409301402926, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:07:54,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=7970, skipped=40, lr=[2.0966032888683773e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:07:54,674] [INFO] [timer.py:258:stop] epoch=0/micro_step=7970/global_step=7970, RunningAvgSamplesPerSec=4.442038949391789, CurrSamplesPerSec=4.4462083820960325, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:08:03,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=7980, skipped=40, lr=[2.0873713812007517e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:08:03,828] [INFO] [timer.py:258:stop] epoch=0/micro_step=7980/global_step=7980, RunningAvgSamplesPerSec=4.442028666126797, CurrSamplesPerSec=4.436276251882689, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:08:12,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=7990, skipped=40, lr=[2.0781731547998607e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:08:12,964] [INFO] [timer.py:258:stop] epoch=0/micro_step=7990/global_step=7990, RunningAvgSamplesPerSec=4.442029188139337, CurrSamplesPerSec=4.448272561561661, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:08:22,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=8000, skipped=40, lr=[2.0690087004484844e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:08:22,087] [INFO] [timer.py:258:stop] epoch=0/micro_step=8000/global_step=8000, RunningAvgSamplesPerSec=4.442027837209713, CurrSamplesPerSec=4.445867876454322, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:08:22,089] [INFO] [RANK 0]  iteration     8000/   10000 | elapsed time per iteration (ms): 914.9 | learning rate 2.068E-05 | total loss 1.457012E+00 | loss 1.457012E+00 | loss scale 16384.0 |speed 262.32 samples/(min*GPU)
[2024-06-18 00:08:22,090] [INFO] [RANK 0] time (ms) | forward: 357.15 | backward: 552.06 | allreduce: 0.00 | optimizer: 4.93 | batch generator: 12.90 | data loader: 0.10
[2024-06-18 00:08:28,742] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 00:08:28,742] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 00:08:28,742] [INFO] [RANK 0]  validation loss at iteration 8000 | loss: 1.890039E+00 | PPL: 6.619627E+00 loss 1.892578E+00 |
[2024-06-18 00:08:28,742] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 00:08:37,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=8010, skipped=40, lr=[2.0598781085960883e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:08:37,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=8010/global_step=8010, RunningAvgSamplesPerSec=4.44202464547174, CurrSamplesPerSec=4.43964546803163, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:08:47,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=8020, skipped=40, lr=[2.0507814693579267e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:08:47,024] [INFO] [timer.py:258:stop] epoch=0/micro_step=8020/global_step=8020, RunningAvgSamplesPerSec=4.442020121324582, CurrSamplesPerSec=4.417117776267716, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:08:56,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=8030, skipped=40, lr=[2.0417188725141557e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:08:56,159] [INFO] [timer.py:258:stop] epoch=0/micro_step=8030/global_step=8030, RunningAvgSamplesPerSec=4.442013847254379, CurrSamplesPerSec=4.438225547416871, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:09:05,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=8040, skipped=40, lr=[2.0326904075089492e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:09:05,320] [INFO] [timer.py:258:stop] epoch=0/micro_step=8040/global_step=8040, RunningAvgSamplesPerSec=4.442005378862819, CurrSamplesPerSec=4.434641619911938, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:09:14,477] [INFO] [logging.py:96:log_dist] [Rank 0] step=8050, skipped=40, lr=[2.02369616344961e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:09:14,478] [INFO] [timer.py:258:stop] epoch=0/micro_step=8050/global_step=8050, RunningAvgSamplesPerSec=4.441992345603427, CurrSamplesPerSec=4.440616093472746, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:09:14,480] [INFO] [RANK 0]  iteration     8050/   10000 | elapsed time per iteration (ms): 1047.8 | learning rate 2.023E-05 | total loss 1.389668E+00 | loss 1.389668E+00 | loss scale 16384.0 |speed 229.04 samples/(min*GPU)
[2024-06-18 00:09:14,481] [INFO] [RANK 0] time (ms) | forward: 357.04 | backward: 552.00 | allreduce: 0.00 | optimizer: 4.89 | batch generator: 14.71 | data loader: 0.14
[2024-06-18 00:09:23,647] [INFO] [logging.py:96:log_dist] [Rank 0] step=8060, skipped=40, lr=[2.0147362291056983e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:09:23,647] [INFO] [timer.py:258:stop] epoch=0/micro_step=8060/global_step=8060, RunningAvgSamplesPerSec=4.441988308927376, CurrSamplesPerSec=4.43487489753554, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:09:32,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=8070, skipped=40, lr=[2.005810692908146e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:09:32,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=8070/global_step=8070, RunningAvgSamplesPerSec=4.441983401814451, CurrSamplesPerSec=4.43214509415116, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:09:41,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=8080, skipped=40, lr=[1.9969196429483954e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:09:41,932] [INFO] [timer.py:258:stop] epoch=0/micro_step=8080/global_step=8080, RunningAvgSamplesPerSec=4.441978191369877, CurrSamplesPerSec=4.430746348121136, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:09:51,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=8090, skipped=40, lr=[1.988063166977516e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:09:51,073] [INFO] [timer.py:258:stop] epoch=0/micro_step=8090/global_step=8090, RunningAvgSamplesPerSec=4.441970402928789, CurrSamplesPerSec=4.442968034981865, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:10:00,206] [INFO] [logging.py:96:log_dist] [Rank 0] step=8100, skipped=40, lr=[1.9792413524053538e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:10:00,207] [INFO] [timer.py:258:stop] epoch=0/micro_step=8100/global_step=8100, RunningAvgSamplesPerSec=4.4419625829203735, CurrSamplesPerSec=4.4409510929914235, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:10:00,208] [INFO] [RANK 0]  iteration     8100/   10000 | elapsed time per iteration (ms): 914.6 | learning rate 1.978E-05 | total loss 1.402285E+00 | loss 1.402285E+00 | loss scale 16384.0 |speed 262.42 samples/(min*GPU)
[2024-06-18 00:10:00,209] [INFO] [RANK 0] time (ms) | forward: 356.86 | backward: 551.84 | allreduce: 0.00 | optimizer: 4.96 | batch generator: 12.38 | data loader: 0.11
[2024-06-18 00:10:00,209] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:10:00,228] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/8100/mp_rank_00_model_states.pt
[2024-06-18 00:10:00,228] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/8100/mp_rank_00_model_states.pt...
[2024-06-18 00:10:22,243] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/8100/mp_rank_00_model_states.pt.
[2024-06-18 00:10:31,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=8110, skipped=40, lr=[1.970454286299654e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:10:31,351] [INFO] [timer.py:258:stop] epoch=0/micro_step=8110/global_step=8110, RunningAvgSamplesPerSec=4.441995804920639, CurrSamplesPerSec=4.4815392982422395, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:10:40,443] [INFO] [logging.py:96:log_dist] [Rank 0] step=8120, skipped=40, lr=[1.961702055385215e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:10:40,443] [INFO] [timer.py:258:stop] epoch=0/micro_step=8120/global_step=8120, RunningAvgSamplesPerSec=4.4420366293235976, CurrSamplesPerSec=4.47405669874495, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:10:49,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=8130, skipped=40, lr=[1.9529847460430206e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:10:49,495] [INFO] [timer.py:258:stop] epoch=0/micro_step=8130/global_step=8130, RunningAvgSamplesPerSec=4.442067936672581, CurrSamplesPerSec=4.463855000147667, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:10:58,593] [INFO] [logging.py:96:log_dist] [Rank 0] step=8140, skipped=40, lr=[1.9443024443093935e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:10:58,593] [INFO] [timer.py:258:stop] epoch=0/micro_step=8140/global_step=8140, RunningAvgSamplesPerSec=4.442089550648285, CurrSamplesPerSec=4.461636325341832, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:11:07,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=8150, skipped=40, lr=[1.9356552358751486e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:11:07,695] [INFO] [timer.py:258:stop] epoch=0/micro_step=8150/global_step=8150, RunningAvgSamplesPerSec=4.442099466467865, CurrSamplesPerSec=4.4561756162654556, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:11:07,696] [INFO] [RANK 0]  iteration     8150/   10000 | elapsed time per iteration (ms): 1349.8 | learning rate 1.935E-05 | total loss 1.400566E+00 | loss 1.400566E+00 | loss scale 16384.0 |speed 177.81 samples/(min*GPU)
[2024-06-18 00:11:07,698] [INFO] [RANK 0] time (ms) | forward: 353.51 | backward: 549.24 | allreduce: 0.00 | optimizer: 5.25 | batch generator: 11.67 | data loader: 0.09
[2024-06-18 00:11:16,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=8160, skipped=40, lr=[1.927043206084741e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:11:16,832] [INFO] [timer.py:258:stop] epoch=0/micro_step=8160/global_step=8160, RunningAvgSamplesPerSec=4.442096554033079, CurrSamplesPerSec=4.4060950766191604, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:11:25,945] [INFO] [logging.py:96:log_dist] [Rank 0] step=8170, skipped=40, lr=[1.918466439935429e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:11:25,945] [INFO] [timer.py:258:stop] epoch=0/micro_step=8170/global_step=8170, RunningAvgSamplesPerSec=4.442091744721752, CurrSamplesPerSec=4.4424750969602655, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:11:35,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=8180, skipped=40, lr=[1.9099250220764303e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:11:35,091] [INFO] [timer.py:258:stop] epoch=0/micro_step=8180/global_step=8180, RunningAvgSamplesPerSec=4.442089492870286, CurrSamplesPerSec=4.438898399032699, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:11:44,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=8190, skipped=40, lr=[1.9014190368080926e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:11:44,229] [INFO] [timer.py:258:stop] epoch=0/micro_step=8190/global_step=8190, RunningAvgSamplesPerSec=4.442089917371639, CurrSamplesPerSec=4.422893511055246, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:11:53,370] [INFO] [logging.py:96:log_dist] [Rank 0] step=8200, skipped=40, lr=[1.892948568081055e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:11:53,371] [INFO] [timer.py:258:stop] epoch=0/micro_step=8200/global_step=8200, RunningAvgSamplesPerSec=4.4420885772188425, CurrSamplesPerSec=4.432812589585812, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:11:53,372] [INFO] [RANK 0]  iteration     8200/   10000 | elapsed time per iteration (ms): 913.5 | learning rate 1.892E-05 | total loss 1.287832E+00 | loss 1.287832E+00 | loss scale 16384.0 |speed 262.72 samples/(min*GPU)
[2024-06-18 00:11:53,373] [INFO] [RANK 0] time (ms) | forward: 355.94 | backward: 551.84 | allreduce: 0.00 | optimizer: 4.93 | batch generator: 12.01 | data loader: 0.10
[2024-06-18 00:12:02,532] [INFO] [logging.py:96:log_dist] [Rank 0] step=8210, skipped=40, lr=[1.884513699495426e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:12:02,533] [INFO] [timer.py:258:stop] epoch=0/micro_step=8210/global_step=8210, RunningAvgSamplesPerSec=4.442079586061954, CurrSamplesPerSec=4.437368632225244, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:12:11,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=8220, skipped=40, lr=[1.8761145142999516e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:12:11,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=8220/global_step=8220, RunningAvgSamplesPerSec=4.442077509820204, CurrSamplesPerSec=4.445370761193369, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:12:20,825] [INFO] [logging.py:96:log_dist] [Rank 0] step=8230, skipped=40, lr=[1.8677510953911987e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:12:20,826] [INFO] [timer.py:258:stop] epoch=0/micro_step=8230/global_step=8230, RunningAvgSamplesPerSec=4.442079249730958, CurrSamplesPerSec=4.443199836013952, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:12:29,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=8240, skipped=40, lr=[1.859423525312737e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:12:29,934] [INFO] [timer.py:258:stop] epoch=0/micro_step=8240/global_step=8240, RunningAvgSamplesPerSec=4.442081089354159, CurrSamplesPerSec=4.444998586531433, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:12:39,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=8250, skipped=40, lr=[1.8511318862543194e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:12:39,057] [INFO] [timer.py:258:stop] epoch=0/micro_step=8250/global_step=8250, RunningAvgSamplesPerSec=4.4420731954144586, CurrSamplesPerSec=4.441125077593612, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:12:39,059] [INFO] [RANK 0]  iteration     8250/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 1.850E-05 | total loss 1.403125E+00 | loss 1.403125E+00 | loss scale 16384.0 |speed 262.66 samples/(min*GPU)
[2024-06-18 00:12:39,060] [INFO] [RANK 0] time (ms) | forward: 355.74 | backward: 552.19 | allreduce: 0.00 | optimizer: 5.00 | batch generator: 12.03 | data loader: 0.10
[2024-06-18 00:12:48,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=8260, skipped=40, lr=[1.8428762600510776e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:12:48,215] [INFO] [timer.py:258:stop] epoch=0/micro_step=8260/global_step=8260, RunningAvgSamplesPerSec=4.442069194770015, CurrSamplesPerSec=4.4404985617596395, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:12:57,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=8270, skipped=40, lr=[1.8346567281827073e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:12:57,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=8270/global_step=8270, RunningAvgSamplesPerSec=4.442073165648212, CurrSamplesPerSec=4.446656185164256, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:13:06,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=8280, skipped=40, lr=[1.8264733717726722e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:13:06,505] [INFO] [timer.py:258:stop] epoch=0/micro_step=8280/global_step=8280, RunningAvgSamplesPerSec=4.44207661957915, CurrSamplesPerSec=4.448902452897583, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:13:15,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=8290, skipped=40, lr=[1.818326271587394e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:13:15,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=8290/global_step=8290, RunningAvgSamplesPerSec=4.442073382800749, CurrSamplesPerSec=4.442709199469964, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:13:24,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=8300, skipped=40, lr=[1.8102155080354646e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:13:24,768] [INFO] [timer.py:258:stop] epoch=0/micro_step=8300/global_step=8300, RunningAvgSamplesPerSec=4.442067803861218, CurrSamplesPerSec=4.421633440053469, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:13:24,770] [INFO] [RANK 0]  iteration     8300/   10000 | elapsed time per iteration (ms): 914.2 | learning rate 1.809E-05 | total loss 1.467314E+00 | loss 1.467314E+00 | loss scale 16384.0 |speed 262.52 samples/(min*GPU)
[2024-06-18 00:13:24,772] [INFO] [RANK 0] time (ms) | forward: 356.53 | backward: 552.00 | allreduce: 0.00 | optimizer: 4.89 | batch generator: 12.92 | data loader: 0.09
[2024-06-18 00:13:33,906] [INFO] [logging.py:96:log_dist] [Rank 0] step=8310, skipped=40, lr=[1.8021411611668444e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:13:33,906] [INFO] [timer.py:258:stop] epoch=0/micro_step=8310/global_step=8310, RunningAvgSamplesPerSec=4.44206376513444, CurrSamplesPerSec=4.447084039184304, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:13:43,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=8320, skipped=40, lr=[1.7941033106720768e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:13:43,043] [INFO] [timer.py:258:stop] epoch=0/micro_step=8320/global_step=8320, RunningAvgSamplesPerSec=4.442062550992824, CurrSamplesPerSec=4.435190271627784, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:13:52,189] [INFO] [logging.py:96:log_dist] [Rank 0] step=8330, skipped=40, lr=[1.786102035881502e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:13:52,190] [INFO] [timer.py:258:stop] epoch=0/micro_step=8330/global_step=8330, RunningAvgSamplesPerSec=4.442058906762036, CurrSamplesPerSec=4.44326690985981, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:14:01,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=8340, skipped=40, lr=[1.7781374157644715e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:14:01,343] [INFO] [timer.py:258:stop] epoch=0/micro_step=8340/global_step=8340, RunningAvgSamplesPerSec=4.442052330017507, CurrSamplesPerSec=4.437218412698581, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:14:10,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=8350, skipped=40, lr=[1.7702095289285717e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:14:10,473] [INFO] [timer.py:258:stop] epoch=0/micro_step=8350/global_step=8350, RunningAvgSamplesPerSec=4.442045717485052, CurrSamplesPerSec=4.435288761947262, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:14:10,475] [INFO] [RANK 0]  iteration     8350/   10000 | elapsed time per iteration (ms): 914.1 | learning rate 1.769E-05 | total loss 1.342109E+00 | loss 1.342109E+00 | loss scale 16384.0 |speed 262.56 samples/(min*GPU)
[2024-06-18 00:14:10,476] [INFO] [RANK 0] time (ms) | forward: 356.43 | backward: 552.03 | allreduce: 0.00 | optimizer: 4.87 | batch generator: 12.29 | data loader: 0.09
[2024-06-18 00:14:19,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=8360, skipped=40, lr=[1.7623184536188427e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:14:19,626] [INFO] [timer.py:258:stop] epoch=0/micro_step=8360/global_step=8360, RunningAvgSamplesPerSec=4.442038326737012, CurrSamplesPerSec=4.4405820086354275, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:14:28,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=8370, skipped=40, lr=[1.7544642677170152e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:14:28,763] [INFO] [timer.py:258:stop] epoch=0/micro_step=8370/global_step=8370, RunningAvgSamplesPerSec=4.442038628681867, CurrSamplesPerSec=4.442948032980725, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:14:37,901] [INFO] [logging.py:96:log_dist] [Rank 0] step=8380, skipped=40, lr=[1.7466470487407302e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:14:37,901] [INFO] [timer.py:258:stop] epoch=0/micro_step=8380/global_step=8380, RunningAvgSamplesPerSec=4.442039431904006, CurrSamplesPerSec=4.442986860559221, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:14:47,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=8390, skipped=40, lr=[1.738866873842785e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:14:47,046] [INFO] [timer.py:258:stop] epoch=0/micro_step=8390/global_step=8390, RunningAvgSamplesPerSec=4.44203985155294, CurrSamplesPerSec=4.440281144491086, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:14:56,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=8400, skipped=40, lr=[1.7311238198103627e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:14:56,181] [INFO] [timer.py:258:stop] epoch=0/micro_step=8400/global_step=8400, RunningAvgSamplesPerSec=4.442037337511278, CurrSamplesPerSec=4.443405770923757, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:14:56,183] [INFO] [RANK 0]  iteration     8400/   10000 | elapsed time per iteration (ms): 914.2 | learning rate 1.730E-05 | total loss 1.279805E+00 | loss 1.279805E+00 | loss scale 32768.0 |speed 262.54 samples/(min*GPU)
[2024-06-18 00:14:56,184] [INFO] [RANK 0] time (ms) | forward: 356.52 | backward: 552.02 | allreduce: 0.00 | optimizer: 4.83 | batch generator: 12.80 | data loader: 0.09
[2024-06-18 00:14:56,184] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:14:56,198] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/8400/mp_rank_00_model_states.pt
[2024-06-18 00:14:56,198] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/8400/mp_rank_00_model_states.pt...
[2024-06-18 00:15:21,144] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/8400/mp_rank_00_model_states.pt.
[2024-06-18 00:15:30,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=8410, skipped=40, lr=[1.723417963064283e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:15:30,267] [INFO] [timer.py:258:stop] epoch=0/micro_step=8410/global_step=8410, RunningAvgSamplesPerSec=4.4420600850995315, CurrSamplesPerSec=4.472484722917184, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:15:39,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=8420, skipped=40, lr=[1.7157493796582395e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:15:39,335] [INFO] [timer.py:258:stop] epoch=0/micro_step=8420/global_step=8420, RunningAvgSamplesPerSec=4.442099669979792, CurrSamplesPerSec=4.473909950154826, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:15:48,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=8430, skipped=40, lr=[1.7081181452780557e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:15:48,419] [INFO] [timer.py:258:stop] epoch=0/micro_step=8430/global_step=8430, RunningAvgSamplesPerSec=4.442135940879779, CurrSamplesPerSec=4.465646743862243, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:15:57,553] [INFO] [logging.py:96:log_dist] [Rank 0] step=8440, skipped=40, lr=[1.7005243352409334e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:15:57,553] [INFO] [timer.py:258:stop] epoch=0/micro_step=8440/global_step=8440, RunningAvgSamplesPerSec=4.442141866867604, CurrSamplesPerSec=4.445477949632167, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:16:06,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=8450, skipped=40, lr=[1.6929680244947105e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:16:06,697] [INFO] [timer.py:258:stop] epoch=0/micro_step=8450/global_step=8450, RunningAvgSamplesPerSec=4.442140713266066, CurrSamplesPerSec=4.442824495200265, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:16:06,699] [INFO] [RANK 0]  iteration     8450/   10000 | elapsed time per iteration (ms): 1410.3 | learning rate 1.692E-05 | total loss 1.336084E+00 | loss 1.336084E+00 | loss scale 32768.0 |speed 170.17 samples/(min*GPU)
[2024-06-18 00:16:06,699] [INFO] [RANK 0] time (ms) | forward: 355.59 | backward: 549.64 | allreduce: 0.00 | optimizer: 4.81 | batch generator: 13.27 | data loader: 0.10
[2024-06-18 00:16:15,851] [INFO] [logging.py:96:log_dist] [Rank 0] step=8460, skipped=40, lr=[1.6854492876171264e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:16:15,851] [INFO] [timer.py:258:stop] epoch=0/micro_step=8460/global_step=8460, RunningAvgSamplesPerSec=4.442138695364817, CurrSamplesPerSec=4.441349631926267, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:16:25,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=8470, skipped=40, lr=[1.677968198815076e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:16:25,020] [INFO] [timer.py:258:stop] epoch=0/micro_step=8470/global_step=8470, RunningAvgSamplesPerSec=4.44213456479525, CurrSamplesPerSec=4.448390505167008, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:16:34,174] [INFO] [logging.py:96:log_dist] [Rank 0] step=8480, skipped=40, lr=[1.6705248319238873e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:16:34,174] [INFO] [timer.py:258:stop] epoch=0/micro_step=8480/global_step=8480, RunningAvgSamplesPerSec=4.442137277255953, CurrSamplesPerSec=4.43821732885029, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:16:43,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=8490, skipped=40, lr=[1.663119260406585e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:16:43,340] [INFO] [timer.py:258:stop] epoch=0/micro_step=8490/global_step=8490, RunningAvgSamplesPerSec=4.442141408904455, CurrSamplesPerSec=4.439509191414819, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:16:52,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=8500, skipped=40, lr=[1.6557515573531724e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:16:52,462] [INFO] [timer.py:258:stop] epoch=0/micro_step=8500/global_step=8500, RunningAvgSamplesPerSec=4.4421431307726715, CurrSamplesPerSec=4.427779717562121, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:16:52,463] [INFO] [RANK 0]  iteration     8500/   10000 | elapsed time per iteration (ms): 915.3 | learning rate 1.655E-05 | total loss 1.363184E+00 | loss 1.363184E+00 | loss scale 32768.0 |speed 262.21 samples/(min*GPU)
[2024-06-18 00:16:52,464] [INFO] [RANK 0] time (ms) | forward: 357.91 | backward: 551.70 | allreduce: 0.00 | optimizer: 4.87 | batch generator: 14.26 | data loader: 0.10
[2024-06-18 00:17:01,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=8510, skipped=40, lr=[1.6484217954799018e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:17:01,604] [INFO] [timer.py:258:stop] epoch=0/micro_step=8510/global_step=8510, RunningAvgSamplesPerSec=4.442140363357591, CurrSamplesPerSec=4.432029181222408, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:17:10,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=8520, skipped=40, lr=[1.6411300471285656e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:17:10,763] [INFO] [timer.py:258:stop] epoch=0/micro_step=8520/global_step=8520, RunningAvgSamplesPerSec=4.442131669626992, CurrSamplesPerSec=4.396730574848677, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:17:19,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=8530, skipped=40, lr=[1.6338763842657757e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:17:19,926] [INFO] [timer.py:258:stop] epoch=0/micro_step=8530/global_step=8530, RunningAvgSamplesPerSec=4.442130407237677, CurrSamplesPerSec=4.448661799196297, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:17:29,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=8540, skipped=40, lr=[1.626660878482254e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:17:29,098] [INFO] [timer.py:258:stop] epoch=0/micro_step=8540/global_step=8540, RunningAvgSamplesPerSec=4.44212765165327, CurrSamplesPerSec=4.439826399915317, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:17:38,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=8550, skipped=40, lr=[1.6194836009921332e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:17:38,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=8550/global_step=8550, RunningAvgSamplesPerSec=4.4421245784875145, CurrSamplesPerSec=4.441859960233726, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:17:38,255] [INFO] [RANK 0]  iteration     8550/   10000 | elapsed time per iteration (ms): 915.8 | learning rate 1.619E-05 | total loss 1.359321E+00 | loss 1.359321E+00 | loss scale 32768.0 |speed 262.06 samples/(min*GPU)
[2024-06-18 00:17:38,258] [INFO] [RANK 0] time (ms) | forward: 358.27 | backward: 551.81 | allreduce: 0.00 | optimizer: 4.93 | batch generator: 14.00 | data loader: 0.11
[2024-06-18 00:17:47,388] [INFO] [logging.py:96:log_dist] [Rank 0] step=8560, skipped=40, lr=[1.6123446226322414e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:17:47,389] [INFO] [timer.py:258:stop] epoch=0/micro_step=8560/global_step=8560, RunningAvgSamplesPerSec=4.442122612928353, CurrSamplesPerSec=4.4446606211371, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:17:56,506] [INFO] [logging.py:96:log_dist] [Rank 0] step=8570, skipped=40, lr=[1.6052440138614155e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:17:56,507] [INFO] [timer.py:258:stop] epoch=0/micro_step=8570/global_step=8570, RunningAvgSamplesPerSec=4.44211930546033, CurrSamplesPerSec=4.4460410683081415, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:18:05,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=8580, skipped=40, lr=[1.5981818447597948e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:18:05,665] [INFO] [timer.py:258:stop] epoch=0/micro_step=8580/global_step=8580, RunningAvgSamplesPerSec=4.442118309320087, CurrSamplesPerSec=4.445397852288673, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:18:14,825] [INFO] [logging.py:96:log_dist] [Rank 0] step=8590, skipped=40, lr=[1.59115818502814e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:18:14,825] [INFO] [timer.py:258:stop] epoch=0/micro_step=8590/global_step=8590, RunningAvgSamplesPerSec=4.442115626746681, CurrSamplesPerSec=4.431473117651891, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:18:23,957] [INFO] [logging.py:96:log_dist] [Rank 0] step=8600, skipped=40, lr=[1.5841731039871344e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:18:23,957] [INFO] [timer.py:258:stop] epoch=0/micro_step=8600/global_step=8600, RunningAvgSamplesPerSec=4.442110687051182, CurrSamplesPerSec=4.443752961558866, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:18:23,959] [INFO] [RANK 0]  iteration     8600/   10000 | elapsed time per iteration (ms): 914.1 | learning rate 1.583E-05 | total loss 1.344141E+00 | loss 1.344141E+00 | loss scale 32768.0 |speed 262.56 samples/(min*GPU)
[2024-06-18 00:18:23,959] [INFO] [RANK 0] time (ms) | forward: 356.32 | backward: 551.98 | allreduce: 0.00 | optimizer: 4.92 | batch generator: 12.39 | data loader: 0.09
[2024-06-18 00:18:33,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=8610, skipped=40, lr=[1.5772266705767108e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:18:33,103] [INFO] [timer.py:258:stop] epoch=0/micro_step=8610/global_step=8610, RunningAvgSamplesPerSec=4.442108383292014, CurrSamplesPerSec=4.448191184120451, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:18:42,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=8620, skipped=40, lr=[1.5703189533553605e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:18:42,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=8620/global_step=8620, RunningAvgSamplesPerSec=4.442108973911884, CurrSamplesPerSec=4.447590970051188, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:18:51,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=8630, skipped=40, lr=[1.563450020499463e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:18:51,365] [INFO] [timer.py:258:stop] epoch=0/micro_step=8630/global_step=8630, RunningAvgSamplesPerSec=4.4421083917952595, CurrSamplesPerSec=4.435420089177841, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:19:00,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=8640, skipped=40, lr=[1.556619939802615e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:19:00,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=8640/global_step=8640, RunningAvgSamplesPerSec=4.442108345449181, CurrSamplesPerSec=4.451133277317925, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:19:09,686] [INFO] [logging.py:96:log_dist] [Rank 0] step=8650, skipped=40, lr=[1.549828778674953e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:19:09,687] [INFO] [timer.py:258:stop] epoch=0/micro_step=8650/global_step=8650, RunningAvgSamplesPerSec=4.442103598198133, CurrSamplesPerSec=4.443232784316758, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:19:09,688] [INFO] [RANK 0]  iteration     8650/   10000 | elapsed time per iteration (ms): 914.6 | learning rate 1.549E-05 | total loss 1.427676E+00 | loss 1.427676E+00 | loss scale 32768.0 |speed 262.41 samples/(min*GPU)
[2024-06-18 00:19:09,689] [INFO] [RANK 0] time (ms) | forward: 356.78 | backward: 552.07 | allreduce: 0.00 | optimizer: 4.98 | batch generator: 13.16 | data loader: 0.10
[2024-06-18 00:19:18,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=8660, skipped=40, lr=[1.5430766041424975e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:19:18,832] [INFO] [timer.py:258:stop] epoch=0/micro_step=8660/global_step=8660, RunningAvgSamplesPerSec=4.4421015614076484, CurrSamplesPerSec=4.420794568107871, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:19:27,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=8670, skipped=40, lr=[1.536363482846484e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:19:27,969] [INFO] [timer.py:258:stop] epoch=0/micro_step=8670/global_step=8670, RunningAvgSamplesPerSec=4.442102288648155, CurrSamplesPerSec=4.419401811886634, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:19:37,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=8680, skipped=40, lr=[1.529689481042711e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:19:37,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=8680/global_step=8680, RunningAvgSamplesPerSec=4.442101581653713, CurrSamplesPerSec=4.440906423468606, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:19:46,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=8690, skipped=40, lr=[1.5230546646008795e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:19:46,279] [INFO] [timer.py:258:stop] epoch=0/micro_step=8690/global_step=8690, RunningAvgSamplesPerSec=4.442100848399851, CurrSamplesPerSec=4.44546145876667, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:19:55,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=8700, skipped=40, lr=[1.516459099003952e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:19:55,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=8700/global_step=8700, RunningAvgSamplesPerSec=4.442100776835788, CurrSamplesPerSec=4.446054028785424, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:19:55,398] [INFO] [RANK 0]  iteration     8700/   10000 | elapsed time per iteration (ms): 914.2 | learning rate 1.516E-05 | total loss 1.383389E+00 | loss 1.383389E+00 | loss scale 32768.0 |speed 262.53 samples/(min*GPU)
[2024-06-18 00:19:55,398] [INFO] [RANK 0] time (ms) | forward: 356.49 | backward: 552.14 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 13.00 | data loader: 0.10
[2024-06-18 00:19:55,401] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:19:55,415] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/8700/mp_rank_00_model_states.pt
[2024-06-18 00:19:55,415] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/8700/mp_rank_00_model_states.pt...
[2024-06-18 00:20:20,281] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/8700/mp_rank_00_model_states.pt.
[2024-06-18 00:20:29,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=8710, skipped=40, lr=[1.5099028493474956e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:20:29,380] [INFO] [timer.py:258:stop] epoch=0/micro_step=8710/global_step=8710, RunningAvgSamplesPerSec=4.442128940806776, CurrSamplesPerSec=4.489693266670752, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:20:38,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=8720, skipped=40, lr=[1.5033859803390501e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:20:38,454] [INFO] [timer.py:258:stop] epoch=0/micro_step=8720/global_step=8720, RunningAvgSamplesPerSec=4.442170615694168, CurrSamplesPerSec=4.469119069842772, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:20:47,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=8730, skipped=40, lr=[1.4969085562974801e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:20:47,558] [INFO] [timer.py:258:stop] epoch=0/micro_step=8730/global_step=8730, RunningAvgSamplesPerSec=4.442198614295594, CurrSamplesPerSec=4.462614217194608, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:20:56,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=8740, skipped=40, lr=[1.490470641152345e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:20:56,695] [INFO] [timer.py:258:stop] epoch=0/micro_step=8740/global_step=8740, RunningAvgSamplesPerSec=4.442210889109685, CurrSamplesPerSec=4.455748377883604, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:21:05,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=8750, skipped=40, lr=[1.4840722984432701e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:21:05,824] [INFO] [timer.py:258:stop] epoch=0/micro_step=8750/global_step=8750, RunningAvgSamplesPerSec=4.442219776207061, CurrSamplesPerSec=4.452500023885071, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:21:05,825] [INFO] [RANK 0]  iteration     8750/   10000 | elapsed time per iteration (ms): 1408.5 | learning rate 1.483E-05 | total loss 1.389370E+00 | loss 1.389370E+00 | loss scale 32768.0 |speed 170.39 samples/(min*GPU)
[2024-06-18 00:21:05,826] [INFO] [RANK 0] time (ms) | forward: 355.47 | backward: 549.54 | allreduce: 0.00 | optimizer: 4.79 | batch generator: 13.66 | data loader: 0.10
[2024-06-18 00:21:09,472] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 00:21:10,393] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 00:21:14,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=8760, skipped=42, lr=[1.4789821588792794e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:21:14,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=8760/global_step=8760, RunningAvgSamplesPerSec=4.442227560182019, CurrSamplesPerSec=4.441313184391409, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:21:24,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=8770, skipped=42, lr=[1.4726552054278833e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:21:24,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=8770/global_step=8770, RunningAvgSamplesPerSec=4.4422360971064485, CurrSamplesPerSec=4.44640399023643, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:21:33,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=8780, skipped=42, lr=[1.4663680002437058e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:21:33,192] [INFO] [timer.py:258:stop] epoch=0/micro_step=8780/global_step=8780, RunningAvgSamplesPerSec=4.442244684826372, CurrSamplesPerSec=4.453845145060694, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:21:42,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=8790, skipped=42, lr=[1.4601206053789214e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:21:42,324] [INFO] [timer.py:258:stop] epoch=0/micro_step=8790/global_step=8790, RunningAvgSamplesPerSec=4.442245939714666, CurrSamplesPerSec=4.444679461060743, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:21:51,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=8800, skipped=42, lr=[1.453913082492798e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:21:51,474] [INFO] [timer.py:258:stop] epoch=0/micro_step=8800/global_step=8800, RunningAvgSamplesPerSec=4.442242581026759, CurrSamplesPerSec=4.443188068881373, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:21:51,476] [INFO] [RANK 0]  iteration     8800/   10000 | elapsed time per iteration (ms): 913.0 | learning rate 1.453E-05 | total loss 1.333896E+00 | loss 1.333896E+00 | loss scale 32768.0 |speed 262.86 samples/(min*GPU)
[2024-06-18 00:21:51,477] [INFO] [RANK 0] time (ms) | forward: 355.74 | backward: 551.81 | allreduce: 0.00 | optimizer: 4.71 | batch generator: 12.81 | data loader: 0.10
[2024-06-18 00:22:00,610] [INFO] [logging.py:96:log_dist] [Rank 0] step=8810, skipped=42, lr=[1.4477454928510785e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:22:00,610] [INFO] [timer.py:258:stop] epoch=0/micro_step=8810/global_step=8810, RunningAvgSamplesPerSec=4.442245623939293, CurrSamplesPerSec=4.441013396721363, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:22:09,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=8820, skipped=42, lr=[1.4416178973253832e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:22:09,766] [INFO] [timer.py:258:stop] epoch=0/micro_step=8820/global_step=8820, RunningAvgSamplesPerSec=4.442250182575348, CurrSamplesPerSec=4.442162214544379, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:22:18,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=8830, skipped=42, lr=[1.4355303563926067e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:22:18,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=8830/global_step=8830, RunningAvgSamplesPerSec=4.442254760071946, CurrSamplesPerSec=4.448436504868373, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:22:28,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=8840, skipped=42, lr=[1.4294829301343187e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:22:28,030] [INFO] [timer.py:258:stop] epoch=0/micro_step=8840/global_step=8840, RunningAvgSamplesPerSec=4.442256501795205, CurrSamplesPerSec=4.438596588697902, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:22:37,157] [INFO] [logging.py:96:log_dist] [Rank 0] step=8850, skipped=42, lr=[1.423475678236177e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:22:37,157] [INFO] [timer.py:258:stop] epoch=0/micro_step=8850/global_step=8850, RunningAvgSamplesPerSec=4.442253746616594, CurrSamplesPerSec=4.419444885672011, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:22:37,158] [INFO] [RANK 0]  iteration     8850/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 1.423E-05 | total loss 1.287012E+00 | loss 1.287012E+00 | loss scale 32768.0 |speed 262.68 samples/(min*GPU)
[2024-06-18 00:22:37,159] [INFO] [RANK 0] time (ms) | forward: 356.20 | backward: 551.94 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 13.08 | data loader: 0.09
[2024-06-18 00:22:46,324] [INFO] [logging.py:96:log_dist] [Rank 0] step=8860, skipped=42, lr=[1.4175086599873306e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:22:46,324] [INFO] [timer.py:258:stop] epoch=0/micro_step=8860/global_step=8860, RunningAvgSamplesPerSec=4.442239797898378, CurrSamplesPerSec=4.422930822899188, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:22:55,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=8870, skipped=42, lr=[1.411581934279843e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:22:55,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=8870/global_step=8870, RunningAvgSamplesPerSec=4.442235136626636, CurrSamplesPerSec=4.441979916165559, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:23:04,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=8880, skipped=42, lr=[1.4056955596081015e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:23:04,652] [INFO] [timer.py:258:stop] epoch=0/micro_step=8880/global_step=8880, RunningAvgSamplesPerSec=4.442232066678515, CurrSamplesPerSec=4.434911239475251, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:23:13,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=8890, skipped=42, lr=[1.3998495940682504e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:23:13,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=8890/global_step=8890, RunningAvgSamplesPerSec=4.442226747447683, CurrSamplesPerSec=4.421645093294272, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:23:22,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=8900, skipped=42, lr=[1.3940440953576083e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:23:22,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=8900/global_step=8900, RunningAvgSamplesPerSec=4.442224714455172, CurrSamplesPerSec=4.439659566090191, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:23:22,955] [INFO] [RANK 0]  iteration     8900/   10000 | elapsed time per iteration (ms): 915.9 | learning rate 1.393E-05 | total loss 1.340347E+00 | loss 1.340347E+00 | loss scale 32768.0 |speed 262.03 samples/(min*GPU)
[2024-06-18 00:23:22,956] [INFO] [RANK 0] time (ms) | forward: 358.38 | backward: 551.92 | allreduce: 0.00 | optimizer: 4.85 | batch generator: 13.77 | data loader: 0.09
[2024-06-18 00:23:32,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=8910, skipped=42, lr=[1.3882791207741023e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:23:32,097] [INFO] [timer.py:258:stop] epoch=0/micro_step=8910/global_step=8910, RunningAvgSamplesPerSec=4.442218714974915, CurrSamplesPerSec=4.424766876574672, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:23:41,230] [INFO] [logging.py:96:log_dist] [Rank 0] step=8920, skipped=42, lr=[1.3825547272157063e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:23:41,231] [INFO] [timer.py:258:stop] epoch=0/micro_step=8920/global_step=8920, RunningAvgSamplesPerSec=4.442210611079539, CurrSamplesPerSec=4.418013423193469, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:23:50,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=8930, skipped=42, lr=[1.376870971179872e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:23:50,398] [INFO] [timer.py:258:stop] epoch=0/micro_step=8930/global_step=8930, RunningAvgSamplesPerSec=4.4422084907627735, CurrSamplesPerSec=4.441470736096062, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:23:59,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=8940, skipped=42, lr=[1.3712279087629785e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:23:59,561] [INFO] [timer.py:258:stop] epoch=0/micro_step=8940/global_step=8940, RunningAvgSamplesPerSec=4.44220217246801, CurrSamplesPerSec=4.42207863749965, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:24:08,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=8950, skipped=42, lr=[1.365625595659772e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:24:08,711] [INFO] [timer.py:258:stop] epoch=0/micro_step=8950/global_step=8950, RunningAvgSamplesPerSec=4.442199627296562, CurrSamplesPerSec=4.445575719419075, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:24:08,712] [INFO] [RANK 0]  iteration     8950/   10000 | elapsed time per iteration (ms): 915.1 | learning rate 1.365E-05 | total loss 1.412822E+00 | loss 1.412822E+00 | loss scale 32768.0 |speed 262.26 samples/(min*GPU)
[2024-06-18 00:24:08,713] [INFO] [RANK 0] time (ms) | forward: 356.96 | backward: 552.41 | allreduce: 0.00 | optimizer: 4.94 | batch generator: 13.04 | data loader: 0.09
[2024-06-18 00:24:17,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=8960, skipped=42, lr=[1.3600640871628225e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:24:17,856] [INFO] [timer.py:258:stop] epoch=0/micro_step=8960/global_step=8960, RunningAvgSamplesPerSec=4.442192396335498, CurrSamplesPerSec=4.44412845927385, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:24:27,013] [INFO] [logging.py:96:log_dist] [Rank 0] step=8970, skipped=42, lr=[1.3545434381619722e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:24:27,014] [INFO] [timer.py:258:stop] epoch=0/micro_step=8970/global_step=8970, RunningAvgSamplesPerSec=4.442184863609484, CurrSamplesPerSec=4.435951340273568, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:24:36,169] [INFO] [logging.py:96:log_dist] [Rank 0] step=8980, skipped=42, lr=[1.3490637031438e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:24:36,170] [INFO] [timer.py:258:stop] epoch=0/micro_step=8980/global_step=8980, RunningAvgSamplesPerSec=4.442176638814188, CurrSamplesPerSec=4.441741186724138, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:24:45,315] [INFO] [logging.py:96:log_dist] [Rank 0] step=8990, skipped=42, lr=[1.3436249361910765e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:24:45,315] [INFO] [timer.py:258:stop] epoch=0/micro_step=8990/global_step=8990, RunningAvgSamplesPerSec=4.442173974281023, CurrSamplesPerSec=4.428933389720529, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:24:54,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=9000, skipped=42, lr=[1.3382271909822357e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:24:54,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=9000/global_step=9000, RunningAvgSamplesPerSec=4.442166273356331, CurrSamplesPerSec=4.430180077886934, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:24:54,469] [INFO] [RANK 0]  iteration     9000/   10000 | elapsed time per iteration (ms): 915.1 | learning rate 1.338E-05 | total loss 1.428936E+00 | loss 1.428936E+00 | loss scale 32768.0 |speed 262.25 samples/(min*GPU)
[2024-06-18 00:24:54,470] [INFO] [RANK 0] time (ms) | forward: 357.16 | backward: 552.38 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 12.88 | data loader: 0.10
[2024-06-18 00:24:54,470] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:24:54,484] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/9000/mp_rank_00_model_states.pt
[2024-06-18 00:24:54,484] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/9000/mp_rank_00_model_states.pt...
[2024-06-18 00:25:21,218] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/9000/mp_rank_00_model_states.pt.
[2024-06-18 00:25:27,870] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 00:25:27,870] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 00:25:27,871] [INFO] [RANK 0]  validation loss at iteration 9000 | loss: 1.816797E+00 | PPL: 6.152121E+00 loss 1.817383E+00 |
[2024-06-18 00:25:27,871] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-18 00:25:36,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=9010, skipped=42, lr=[1.332870520790845e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:25:36,967] [INFO] [timer.py:258:stop] epoch=0/micro_step=9010/global_step=9010, RunningAvgSamplesPerSec=4.442187057813031, CurrSamplesPerSec=4.467075941443372, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:25:46,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=9020, skipped=42, lr=[1.327554978485075e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:25:46,075] [INFO] [timer.py:258:stop] epoch=0/micro_step=9020/global_step=9020, RunningAvgSamplesPerSec=4.442218609838822, CurrSamplesPerSec=4.469420282866945, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:25:55,191] [INFO] [logging.py:96:log_dist] [Rank 0] step=9030, skipped=42, lr=[1.322280616527184e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:25:55,192] [INFO] [timer.py:258:stop] epoch=0/micro_step=9030/global_step=9030, RunningAvgSamplesPerSec=4.442236185570567, CurrSamplesPerSec=4.446810580288455, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:26:04,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=9040, skipped=42, lr=[1.3170474869729933e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:26:04,343] [INFO] [timer.py:258:stop] epoch=0/micro_step=9040/global_step=9040, RunningAvgSamplesPerSec=4.442231986617246, CurrSamplesPerSec=4.445510931730211, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:26:13,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=9050, skipped=42, lr=[1.3118556414713807e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:26:13,485] [INFO] [timer.py:258:stop] epoch=0/micro_step=9050/global_step=9050, RunningAvgSamplesPerSec=4.442235782606785, CurrSamplesPerSec=4.444832541361287, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:26:13,487] [INFO] [RANK 0]  iteration     9050/   10000 | elapsed time per iteration (ms): 1580.4 | learning rate 1.311E-05 | total loss 1.450464E+00 | loss 1.450464E+00 | loss scale 32768.0 |speed 151.86 samples/(min*GPU)
[2024-06-18 00:26:13,488] [INFO] [RANK 0] time (ms) | forward: 356.58 | backward: 549.99 | allreduce: 0.00 | optimizer: 4.96 | batch generator: 16.65 | data loader: 0.14
[2024-06-18 00:26:22,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=9060, skipped=42, lr=[1.3067051312637645e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:26:22,647] [INFO] [timer.py:258:stop] epoch=0/micro_step=9060/global_step=9060, RunningAvgSamplesPerSec=4.442227854012208, CurrSamplesPerSec=4.424392309879108, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:26:31,821] [INFO] [logging.py:96:log_dist] [Rank 0] step=9070, skipped=42, lr=[1.301596007183601e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:26:31,822] [INFO] [timer.py:258:stop] epoch=0/micro_step=9070/global_step=9070, RunningAvgSamplesPerSec=4.44221607061622, CurrSamplesPerSec=4.433419365101932, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:26:40,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=9080, skipped=42, lr=[1.2965283196558825e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:26:40,962] [INFO] [timer.py:258:stop] epoch=0/micro_step=9080/global_step=9080, RunningAvgSamplesPerSec=4.442210555553506, CurrSamplesPerSec=4.428281087838101, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:26:50,101] [INFO] [logging.py:96:log_dist] [Rank 0] step=9090, skipped=42, lr=[1.2915021186966384e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:26:50,102] [INFO] [timer.py:258:stop] epoch=0/micro_step=9090/global_step=9090, RunningAvgSamplesPerSec=4.442204931372804, CurrSamplesPerSec=4.437711358590869, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:26:59,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=9100, skipped=42, lr=[1.2865174539124439e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:26:59,266] [INFO] [timer.py:258:stop] epoch=0/micro_step=9100/global_step=9100, RunningAvgSamplesPerSec=4.4421975879985505, CurrSamplesPerSec=4.438743378481274, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:26:59,268] [INFO] [RANK 0]  iteration     9100/   10000 | elapsed time per iteration (ms): 915.6 | learning rate 1.286E-05 | total loss 1.400596E+00 | loss 1.400596E+00 | loss scale 32768.0 |speed 262.12 samples/(min*GPU)
[2024-06-18 00:26:59,268] [INFO] [RANK 0] time (ms) | forward: 357.63 | backward: 552.12 | allreduce: 0.00 | optimizer: 5.02 | batch generator: 13.14 | data loader: 0.12
[2024-06-18 00:27:08,422] [INFO] [logging.py:96:log_dist] [Rank 0] step=9110, skipped=42, lr=[1.281574374499927e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:27:08,423] [INFO] [timer.py:258:stop] epoch=0/micro_step=9110/global_step=9110, RunningAvgSamplesPerSec=4.442194694574936, CurrSamplesPerSec=4.438615377248348, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:27:17,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=9120, skipped=42, lr=[1.2766729292452876e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:27:17,577] [INFO] [timer.py:258:stop] epoch=0/micro_step=9120/global_step=9120, RunningAvgSamplesPerSec=4.442186354474467, CurrSamplesPerSec=4.444927927495911, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:27:26,706] [INFO] [logging.py:96:log_dist] [Rank 0] step=9130, skipped=42, lr=[1.2718131665238088e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:27:26,708] [INFO] [timer.py:258:stop] epoch=0/micro_step=9130/global_step=9130, RunningAvgSamplesPerSec=4.442183003339038, CurrSamplesPerSec=4.447349279293226, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:27:35,850] [INFO] [logging.py:96:log_dist] [Rank 0] step=9140, skipped=42, lr=[1.2669951342993898e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:27:35,850] [INFO] [timer.py:258:stop] epoch=0/micro_step=9140/global_step=9140, RunningAvgSamplesPerSec=4.442183181381125, CurrSamplesPerSec=4.444551117243031, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:27:45,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=9150, skipped=42, lr=[1.262218880124061e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:27:45,009] [INFO] [timer.py:258:stop] epoch=0/micro_step=9150/global_step=9150, RunningAvgSamplesPerSec=4.44217651064891, CurrSamplesPerSec=4.445065714696003, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:27:45,011] [INFO] [RANK 0]  iteration     9150/   10000 | elapsed time per iteration (ms): 914.9 | learning rate 1.262E-05 | total loss 1.394277E+00 | loss 1.394277E+00 | loss scale 32768.0 |speed 262.33 samples/(min*GPU)
[2024-06-18 00:27:45,012] [INFO] [RANK 0] time (ms) | forward: 356.97 | backward: 552.32 | allreduce: 0.00 | optimizer: 4.80 | batch generator: 13.07 | data loader: 0.10
[2024-06-18 00:27:50,500] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 00:27:51,410] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 00:27:54,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=9160, skipped=44, lr=[1.2584279886708892e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:27:54,157] [INFO] [timer.py:258:stop] epoch=0/micro_step=9160/global_step=9160, RunningAvgSamplesPerSec=4.442172054528487, CurrSamplesPerSec=4.424160133706698, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:28:03,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=9170, skipped=44, lr=[1.2537270534985864e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:28:03,291] [INFO] [timer.py:258:stop] epoch=0/micro_step=9170/global_step=9170, RunningAvgSamplesPerSec=4.4421680031452935, CurrSamplesPerSec=4.435463475775522, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:28:12,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=9180, skipped=44, lr=[1.2490680273259745e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:28:12,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=9180/global_step=9180, RunningAvgSamplesPerSec=4.4421598588800295, CurrSamplesPerSec=4.4385590120741965, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:28:21,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=9190, skipped=44, lr=[1.2444509561357634e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:28:21,628] [INFO] [timer.py:258:stop] epoch=0/micro_step=9190/global_step=9190, RunningAvgSamplesPerSec=4.442150103566444, CurrSamplesPerSec=4.430508824592717, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:28:30,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=9200, skipped=44, lr=[1.2398758854965793e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:28:30,775] [INFO] [timer.py:258:stop] epoch=0/micro_step=9200/global_step=9200, RunningAvgSamplesPerSec=4.44215181627179, CurrSamplesPerSec=4.443292798552486, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:28:30,776] [INFO] [RANK 0]  iteration     9200/   10000 | elapsed time per iteration (ms): 915.3 | learning rate 1.239E-05 | total loss 1.451094E+00 | loss 1.451094E+00 | loss scale 32768.0 |speed 262.21 samples/(min*GPU)
[2024-06-18 00:28:30,777] [INFO] [RANK 0] time (ms) | forward: 357.51 | backward: 552.15 | allreduce: 0.00 | optimizer: 4.85 | batch generator: 13.34 | data loader: 0.09
[2024-06-18 00:28:39,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=9210, skipped=44, lr=[1.2353428605625251e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:28:39,930] [INFO] [timer.py:258:stop] epoch=0/micro_step=9210/global_step=9210, RunningAvgSamplesPerSec=4.4421469257054005, CurrSamplesPerSec=4.436618809519528, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:28:49,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=9220, skipped=44, lr=[1.2308519260727249e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:28:49,059] [INFO] [timer.py:258:stop] epoch=0/micro_step=9220/global_step=9220, RunningAvgSamplesPerSec=4.442147527691183, CurrSamplesPerSec=4.447414120576733, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:28:58,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=9230, skipped=44, lr=[1.2264031263508892e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:28:58,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=9230/global_step=9230, RunningAvgSamplesPerSec=4.442146220874194, CurrSamplesPerSec=4.451765160404238, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:29:07,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=9240, skipped=44, lr=[1.221996505304876e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:29:07,291] [INFO] [timer.py:258:stop] epoch=0/micro_step=9240/global_step=9240, RunningAvgSamplesPerSec=4.442149883542577, CurrSamplesPerSec=4.44455464954249, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:29:16,429] [INFO] [logging.py:96:log_dist] [Rank 0] step=9250, skipped=44, lr=[1.2176321064262548e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:29:16,430] [INFO] [timer.py:258:stop] epoch=0/micro_step=9250/global_step=9250, RunningAvgSamplesPerSec=4.442151017332011, CurrSamplesPerSec=4.43996857102707, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:29:16,431] [INFO] [RANK 0]  iteration     9250/   10000 | elapsed time per iteration (ms): 913.1 | learning rate 1.217E-05 | total loss 1.354395E+00 | loss 1.354395E+00 | loss scale 32768.0 |speed 262.84 samples/(min*GPU)
[2024-06-18 00:29:16,432] [INFO] [RANK 0] time (ms) | forward: 355.39 | backward: 552.02 | allreduce: 0.00 | optimizer: 4.90 | batch generator: 12.03 | data loader: 0.09
[2024-06-18 00:29:25,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=9260, skipped=44, lr=[1.213309972789882e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:29:25,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=9260/global_step=9260, RunningAvgSamplesPerSec=4.442147378731826, CurrSamplesPerSec=4.43992979618452, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:29:34,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=9270, skipped=44, lr=[1.2090301470534705e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:29:34,727] [INFO] [timer.py:258:stop] epoch=0/micro_step=9270/global_step=9270, RunningAvgSamplesPerSec=4.442149537029967, CurrSamplesPerSec=4.448056740958182, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:29:43,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=9280, skipped=44, lr=[1.2047926714571738e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:29:43,893] [INFO] [timer.py:258:stop] epoch=0/micro_step=9280/global_step=9280, RunningAvgSamplesPerSec=4.442144003428729, CurrSamplesPerSec=4.445064536991432, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:29:53,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=9290, skipped=44, lr=[1.2005975878231635e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:29:53,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=9290/global_step=9290, RunningAvgSamplesPerSec=4.442139971831328, CurrSamplesPerSec=4.444129636482452, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:30:02,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=9300, skipped=44, lr=[1.1964449375552231e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:30:02,172] [INFO] [timer.py:258:stop] epoch=0/micro_step=9300/global_step=9300, RunningAvgSamplesPerSec=4.442145983678376, CurrSamplesPerSec=4.451441519366188, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:30:02,173] [INFO] [RANK 0]  iteration     9300/   10000 | elapsed time per iteration (ms): 914.8 | learning rate 1.196E-05 | total loss 1.383213E+00 | loss 1.383213E+00 | loss scale 32768.0 |speed 262.34 samples/(min*GPU)
[2024-06-18 00:30:02,174] [INFO] [RANK 0] time (ms) | forward: 357.46 | backward: 551.73 | allreduce: 0.00 | optimizer: 4.85 | batch generator: 13.61 | data loader: 0.12
[2024-06-18 00:30:02,174] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:30:02,187] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/9300/mp_rank_00_model_states.pt
[2024-06-18 00:30:02,187] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/9300/mp_rank_00_model_states.pt...
[2024-06-18 00:30:28,853] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/9300/mp_rank_00_model_states.pt.
[2024-06-18 00:30:37,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=9310, skipped=44, lr=[1.1923347616383336e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:30:37,967] [INFO] [timer.py:258:stop] epoch=0/micro_step=9310/global_step=9310, RunningAvgSamplesPerSec=4.442173343172782, CurrSamplesPerSec=4.485934608926299, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:30:47,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=9320, skipped=44, lr=[1.1882671006382713e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:30:47,036] [INFO] [timer.py:258:stop] epoch=0/micro_step=9320/global_step=9320, RunningAvgSamplesPerSec=4.442209316246747, CurrSamplesPerSec=4.472910406974419, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:30:56,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=9330, skipped=44, lr=[1.1842419947012099e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:30:56,140] [INFO] [timer.py:258:stop] epoch=0/micro_step=9330/global_step=9330, RunningAvgSamplesPerSec=4.442224511281351, CurrSamplesPerSec=4.446493551514471, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:31:05,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=9340, skipped=44, lr=[1.1802594835533174e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:31:05,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=9340/global_step=9340, RunningAvgSamplesPerSec=4.442239664805989, CurrSamplesPerSec=4.451319870853158, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:31:14,400] [INFO] [logging.py:96:log_dist] [Rank 0] step=9350, skipped=44, lr=[1.1763196065003733e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:31:14,400] [INFO] [timer.py:258:stop] epoch=0/micro_step=9350/global_step=9350, RunningAvgSamplesPerSec=4.442239702618057, CurrSamplesPerSec=4.440411592297281, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:31:14,402] [INFO] [RANK 0]  iteration     9350/   10000 | elapsed time per iteration (ms): 1444.6 | learning rate 1.176E-05 | total loss 1.398086E+00 | loss 1.398086E+00 | loss scale 32768.0 |speed 166.14 samples/(min*GPU)
[2024-06-18 00:31:14,403] [INFO] [RANK 0] time (ms) | forward: 355.33 | backward: 549.82 | allreduce: 0.00 | optimizer: 4.78 | batch generator: 13.23 | data loader: 0.14
[2024-06-18 00:31:23,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=9360, skipped=44, lr=[1.172422402427372e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:31:23,542] [INFO] [timer.py:258:stop] epoch=0/micro_step=9360/global_step=9360, RunningAvgSamplesPerSec=4.442236752823491, CurrSamplesPerSec=4.433243640820196, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:31:32,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=9370, skipped=44, lr=[1.1685679097981458e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:31:32,733] [INFO] [timer.py:258:stop] epoch=0/micro_step=9370/global_step=9370, RunningAvgSamplesPerSec=4.44223421361946, CurrSamplesPerSec=4.41778773246936, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:31:41,854] [INFO] [logging.py:96:log_dist] [Rank 0] step=9380, skipped=44, lr=[1.164756166654979e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:31:41,854] [INFO] [timer.py:258:stop] epoch=0/micro_step=9380/global_step=9380, RunningAvgSamplesPerSec=4.442233942941795, CurrSamplesPerSec=4.433508404055298, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:31:50,992] [INFO] [logging.py:96:log_dist] [Rank 0] step=9390, skipped=44, lr=[1.1609872106182396e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:31:50,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=9390/global_step=9390, RunningAvgSamplesPerSec=4.442229690311548, CurrSamplesPerSec=4.438980611294556, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:32:00,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=9400, skipped=44, lr=[1.1572610788860006e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:32:00,120] [INFO] [timer.py:258:stop] epoch=0/micro_step=9400/global_step=9400, RunningAvgSamplesPerSec=4.4422315129778, CurrSamplesPerSec=4.443802396502216, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:32:00,121] [INFO] [RANK 0]  iteration     9400/   10000 | elapsed time per iteration (ms): 914.4 | learning rate 1.157E-05 | total loss 1.322056E+00 | loss 1.322056E+00 | loss scale 32768.0 |speed 262.47 samples/(min*GPU)
[2024-06-18 00:32:00,122] [INFO] [RANK 0] time (ms) | forward: 356.61 | backward: 552.24 | allreduce: 0.00 | optimizer: 4.77 | batch generator: 13.07 | data loader: 0.22
[2024-06-18 00:32:09,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=9410, skipped=44, lr=[1.1535778082336782e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:32:09,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=9410/global_step=9410, RunningAvgSamplesPerSec=4.4422265889837265, CurrSamplesPerSec=4.426004214107473, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:32:18,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=9420, skipped=44, lr=[1.1499374350136674e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:32:18,398] [INFO] [timer.py:258:stop] epoch=0/micro_step=9420/global_step=9420, RunningAvgSamplesPerSec=4.442222594635421, CurrSamplesPerSec=4.439065175655281, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:32:27,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=9430, skipped=44, lr=[1.1463399951549811e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:32:27,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=9430/global_step=9430, RunningAvgSamplesPerSec=4.442223851507217, CurrSamplesPerSec=4.441660048077432, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:32:36,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=9440, skipped=44, lr=[1.1427855241628994e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:32:36,677] [INFO] [timer.py:258:stop] epoch=0/micro_step=9440/global_step=9440, RunningAvgSamplesPerSec=4.44221967137419, CurrSamplesPerSec=4.425826742074728, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:32:45,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=9450, skipped=44, lr=[1.139274057118615e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:32:45,812] [INFO] [timer.py:258:stop] epoch=0/micro_step=9450/global_step=9450, RunningAvgSamplesPerSec=4.4422149102573885, CurrSamplesPerSec=4.437014224339131, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:32:45,813] [INFO] [RANK 0]  iteration     9450/   10000 | elapsed time per iteration (ms): 913.8 | learning rate 1.139E-05 | total loss 1.401709E+00 | loss 1.401709E+00 | loss scale 32768.0 |speed 262.63 samples/(min*GPU)
[2024-06-18 00:32:45,814] [INFO] [RANK 0] time (ms) | forward: 356.11 | backward: 552.22 | allreduce: 0.00 | optimizer: 4.76 | batch generator: 12.15 | data loader: 0.21
[2024-06-18 00:32:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=9460, skipped=44, lr=[1.1358056286788914e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:32:55,028] [INFO] [timer.py:258:stop] epoch=0/micro_step=9460/global_step=9460, RunningAvgSamplesPerSec=4.442168301197467, CurrSamplesPerSec=4.441155643863981, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:33:04,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=9470, skipped=44, lr=[1.1323802730757157e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:33:04,180] [INFO] [timer.py:258:stop] epoch=0/micro_step=9470/global_step=9470, RunningAvgSamplesPerSec=4.442170911338781, CurrSamplesPerSec=4.441695325385668, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:33:13,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=9480, skipped=44, lr=[1.1289980241159656e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:33:13,327] [INFO] [timer.py:258:stop] epoch=0/micro_step=9480/global_step=9480, RunningAvgSamplesPerSec=4.442169601152466, CurrSamplesPerSec=4.438557837814957, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:33:22,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=9490, skipped=44, lr=[1.1256589151810723e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:33:22,475] [INFO] [timer.py:258:stop] epoch=0/micro_step=9490/global_step=9490, RunningAvgSamplesPerSec=4.442163334679945, CurrSamplesPerSec=4.434246627840747, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:33:31,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=9500, skipped=44, lr=[1.1223629792266932e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:33:31,625] [INFO] [timer.py:258:stop] epoch=0/micro_step=9500/global_step=9500, RunningAvgSamplesPerSec=4.44216109781771, CurrSamplesPerSec=4.447778445850578, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:33:31,626] [INFO] [RANK 0]  iteration     9500/   10000 | elapsed time per iteration (ms): 916.3 | learning rate 1.122E-05 | total loss 1.325278E+00 | loss 1.325278E+00 | loss scale 32768.0 |speed 261.93 samples/(min*GPU)
[2024-06-18 00:33:31,627] [INFO] [RANK 0] time (ms) | forward: 358.41 | backward: 552.16 | allreduce: 0.00 | optimizer: 4.90 | batch generator: 13.17 | data loader: 0.20
[2024-06-18 00:33:40,777] [INFO] [logging.py:96:log_dist] [Rank 0] step=9510, skipped=44, lr=[1.1191102487823858e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:33:40,778] [INFO] [timer.py:258:stop] epoch=0/micro_step=9510/global_step=9510, RunningAvgSamplesPerSec=4.442158053802411, CurrSamplesPerSec=4.443508157097457, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:33:49,925] [INFO] [logging.py:96:log_dist] [Rank 0] step=9520, skipped=44, lr=[1.115900755951286e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:33:49,926] [INFO] [timer.py:258:stop] epoch=0/micro_step=9520/global_step=9520, RunningAvgSamplesPerSec=4.442161016752604, CurrSamplesPerSec=4.4435599404072175, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:33:59,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=9530, skipped=44, lr=[1.1127345324097927e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:33:59,083] [INFO] [timer.py:258:stop] epoch=0/micro_step=9530/global_step=9530, RunningAvgSamplesPerSec=4.442162285894551, CurrSamplesPerSec=4.443860071992944, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:34:08,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=9540, skipped=44, lr=[1.1096116094072534e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:34:08,234] [INFO] [timer.py:258:stop] epoch=0/micro_step=9540/global_step=9540, RunningAvgSamplesPerSec=4.442159707330004, CurrSamplesPerSec=4.430388317467024, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:34:17,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=9550, skipped=44, lr=[1.106532017765658e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:34:17,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=9550/global_step=9550, RunningAvgSamplesPerSec=4.442156828179808, CurrSamplesPerSec=4.443288091495015, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:34:17,371] [INFO] [RANK 0]  iteration     9550/   10000 | elapsed time per iteration (ms): 914.9 | learning rate 1.106E-05 | total loss 1.338799E+00 | loss 1.338799E+00 | loss scale 32768.0 |speed 262.33 samples/(min*GPU)
[2024-06-18 00:34:17,372] [INFO] [RANK 0] time (ms) | forward: 357.08 | backward: 552.18 | allreduce: 0.00 | optimizer: 4.83 | batch generator: 13.69 | data loader: 0.20
[2024-06-18 00:34:24,683] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 00:34:25,598] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 00:34:26,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=9560, skipped=46, lr=[1.1040995634716256e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:34:26,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=9560/global_step=9560, RunningAvgSamplesPerSec=4.442152914748737, CurrSamplesPerSec=4.443263379606909, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:34:35,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=9570, skipped=46, lr=[1.1010980445858493e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:34:35,655] [INFO] [timer.py:258:stop] epoch=0/micro_step=9570/global_step=9570, RunningAvgSamplesPerSec=4.44215080091202, CurrSamplesPerSec=4.435485755709586, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:34:44,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=9580, skipped=46, lr=[1.0981399410864651e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:34:44,794] [INFO] [timer.py:258:stop] epoch=0/micro_step=9580/global_step=9580, RunningAvgSamplesPerSec=4.442151911872327, CurrSamplesPerSec=4.440480932539278, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:34:53,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=9590, skipped=46, lr=[1.0952252821687593e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:34:53,927] [INFO] [timer.py:258:stop] epoch=0/micro_step=9590/global_step=9590, RunningAvgSamplesPerSec=4.442152477700179, CurrSamplesPerSec=4.444221460674961, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:35:03,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=9600, skipped=46, lr=[1.092354096599239e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:35:03,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=9600/global_step=9600, RunningAvgSamplesPerSec=4.44215097910364, CurrSamplesPerSec=4.442119872941704, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:35:03,050] [INFO] [RANK 0]  iteration     9600/   10000 | elapsed time per iteration (ms): 913.6 | learning rate 1.092E-05 | total loss 1.294590E+00 | loss 1.294590E+00 | loss scale 32768.0 |speed 262.70 samples/(min*GPU)
[2024-06-18 00:35:03,052] [INFO] [RANK 0] time (ms) | forward: 356.10 | backward: 552.04 | allreduce: 0.00 | optimizer: 4.69 | batch generator: 12.34 | data loader: 0.21
[2024-06-18 00:35:03,053] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:35:03,065] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/9600/mp_rank_00_model_states.pt
[2024-06-18 00:35:03,066] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/9600/mp_rank_00_model_states.pt...
[2024-06-18 00:35:28,180] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/9600/mp_rank_00_model_states.pt.
[2024-06-18 00:35:37,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=9610, skipped=46, lr=[1.0895264127153466e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:35:37,293] [INFO] [timer.py:258:stop] epoch=0/micro_step=9610/global_step=9610, RunningAvgSamplesPerSec=4.442167730710056, CurrSamplesPerSec=4.481987062593134, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:35:46,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=9620, skipped=46, lr=[1.0867422584251801e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:35:46,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=9620/global_step=9620, RunningAvgSamplesPerSec=4.442201824254197, CurrSamplesPerSec=4.472563414705019, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:35:55,470] [INFO] [logging.py:96:log_dist] [Rank 0] step=9630, skipped=46, lr=[1.0840016612072194e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:35:55,470] [INFO] [timer.py:258:stop] epoch=0/micro_step=9630/global_step=9630, RunningAvgSamplesPerSec=4.442215532508161, CurrSamplesPerSec=4.438352352016042, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:36:04,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=9640, skipped=46, lr=[1.0813046481100515e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:36:04,624] [INFO] [timer.py:258:stop] epoch=0/micro_step=9640/global_step=9640, RunningAvgSamplesPerSec=4.4422088195765985, CurrSamplesPerSec=4.446539511992144, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:36:13,761] [INFO] [logging.py:96:log_dist] [Rank 0] step=9650, skipped=46, lr=[1.0786512457521072e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:36:13,761] [INFO] [timer.py:258:stop] epoch=0/micro_step=9650/global_step=9650, RunningAvgSamplesPerSec=4.442205490420572, CurrSamplesPerSec=4.434415399225725, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:36:13,763] [INFO] [RANK 0]  iteration     9650/   10000 | elapsed time per iteration (ms): 1414.2 | learning rate 1.078E-05 | total loss 1.252500E+00 | loss 1.252500E+00 | loss scale 32768.0 |speed 169.70 samples/(min*GPU)
[2024-06-18 00:36:13,763] [INFO] [RANK 0] time (ms) | forward: 355.65 | backward: 550.16 | allreduce: 0.00 | optimizer: 4.86 | batch generator: 12.47 | data loader: 0.18
[2024-06-18 00:36:22,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=9660, skipped=46, lr=[1.0760414803213966e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:36:22,924] [INFO] [timer.py:258:stop] epoch=0/micro_step=9660/global_step=9660, RunningAvgSamplesPerSec=4.442194339914357, CurrSamplesPerSec=4.433228412038398, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:36:32,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=9670, skipped=46, lr=[1.0734753775752513e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:36:32,082] [INFO] [timer.py:258:stop] epoch=0/micro_step=9670/global_step=9670, RunningAvgSamplesPerSec=4.442186884379406, CurrSamplesPerSec=4.430235060593121, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:36:41,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=9680, skipped=46, lr=[1.070952962840069e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:36:41,225] [INFO] [timer.py:258:stop] epoch=0/micro_step=9680/global_step=9680, RunningAvgSamplesPerSec=4.442183717185298, CurrSamplesPerSec=4.445497974419042, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:36:50,348] [INFO] [logging.py:96:log_dist] [Rank 0] step=9690, skipped=46, lr=[1.0684742610110645e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:36:50,349] [INFO] [timer.py:258:stop] epoch=0/micro_step=9690/global_step=9690, RunningAvgSamplesPerSec=4.442182079566687, CurrSamplesPerSec=4.4411862105551, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:36:59,491] [INFO] [logging.py:96:log_dist] [Rank 0] step=9700, skipped=46, lr=[1.0660392965520251e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:36:59,491] [INFO] [timer.py:258:stop] epoch=0/micro_step=9700/global_step=9700, RunningAvgSamplesPerSec=4.442178325590176, CurrSamplesPerSec=4.444181434278377, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:36:59,493] [INFO] [RANK 0]  iteration     9700/   10000 | elapsed time per iteration (ms): 914.6 | learning rate 1.066E-05 | total loss 1.447090E+00 | loss 1.447090E+00 | loss scale 32768.0 |speed 262.41 samples/(min*GPU)
[2024-06-18 00:36:59,495] [INFO] [RANK 0] time (ms) | forward: 356.62 | backward: 552.29 | allreduce: 0.00 | optimizer: 4.92 | batch generator: 12.43 | data loader: 0.21
[2024-06-18 00:37:08,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=9710, skipped=46, lr=[1.063648093495066e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:37:08,629] [INFO] [timer.py:258:stop] epoch=0/micro_step=9710/global_step=9710, RunningAvgSamplesPerSec=4.442178467102111, CurrSamplesPerSec=4.442030487764518, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:37:17,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=9720, skipped=46, lr=[1.061300675440396e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:37:17,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=9720/global_step=9720, RunningAvgSamplesPerSec=4.442177945801327, CurrSamplesPerSec=4.4355256256239315, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:37:26,882] [INFO] [logging.py:96:log_dist] [Rank 0] step=9730, skipped=46, lr=[1.0589970655560846e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:37:26,883] [INFO] [timer.py:258:stop] epoch=0/micro_step=9730/global_step=9730, RunningAvgSamplesPerSec=4.442174628531618, CurrSamplesPerSec=4.441564802144165, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:37:36,031] [INFO] [logging.py:96:log_dist] [Rank 0] step=9740, skipped=46, lr=[1.0567372865778306e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:37:36,032] [INFO] [timer.py:258:stop] epoch=0/micro_step=9740/global_step=9740, RunningAvgSamplesPerSec=4.442166705433647, CurrSamplesPerSec=4.432399187135349, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:37:45,174] [INFO] [logging.py:96:log_dist] [Rank 0] step=9750, skipped=46, lr=[1.0545213608087402e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:37:45,174] [INFO] [timer.py:258:stop] epoch=0/micro_step=9750/global_step=9750, RunningAvgSamplesPerSec=4.4421611711007545, CurrSamplesPerSec=4.420199395138397, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:37:45,176] [INFO] [RANK 0]  iteration     9750/   10000 | elapsed time per iteration (ms): 913.7 | learning rate 1.054E-05 | total loss 1.445400E+00 | loss 1.445400E+00 | loss scale 32768.0 |speed 262.68 samples/(min*GPU)
[2024-06-18 00:37:45,177] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 552.31 | allreduce: 0.00 | optimizer: 4.87 | batch generator: 11.92 | data loader: 0.22
[2024-06-18 00:37:54,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=9760, skipped=46, lr=[1.0523493101191065e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:37:54,327] [INFO] [timer.py:258:stop] epoch=0/micro_step=9760/global_step=9760, RunningAvgSamplesPerSec=4.44215775974763, CurrSamplesPerSec=4.449945586542065, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:38:03,480] [INFO] [logging.py:96:log_dist] [Rank 0] step=9770, skipped=46, lr=[1.0502211559461925e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:38:03,480] [INFO] [timer.py:258:stop] epoch=0/micro_step=9770/global_step=9770, RunningAvgSamplesPerSec=4.44215501848121, CurrSamplesPerSec=4.433349073717584, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:38:12,624] [INFO] [logging.py:96:log_dist] [Rank 0] step=9780, skipped=46, lr=[1.048136919294021e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:38:12,624] [INFO] [timer.py:258:stop] epoch=0/micro_step=9780/global_step=9780, RunningAvgSamplesPerSec=4.44214990295767, CurrSamplesPerSec=4.438399318521223, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:38:21,786] [INFO] [logging.py:96:log_dist] [Rank 0] step=9790, skipped=46, lr=[1.046096620733166e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:38:21,787] [INFO] [timer.py:258:stop] epoch=0/micro_step=9790/global_step=9790, RunningAvgSamplesPerSec=4.442137982010693, CurrSamplesPerSec=4.418609171320628, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:38:30,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=9800, skipped=46, lr=[1.0441002804005511e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:38:30,918] [INFO] [timer.py:258:stop] epoch=0/micro_step=9800/global_step=9800, RunningAvgSamplesPerSec=4.442133959350456, CurrSamplesPerSec=4.441458978120199, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:38:30,919] [INFO] [RANK 0]  iteration     9800/   10000 | elapsed time per iteration (ms): 914.9 | learning rate 1.044E-05 | total loss 1.389238E+00 | loss 1.389238E+00 | loss scale 32768.0 |speed 262.33 samples/(min*GPU)
[2024-06-18 00:38:30,920] [INFO] [RANK 0] time (ms) | forward: 357.07 | backward: 552.18 | allreduce: 0.00 | optimizer: 4.84 | batch generator: 12.73 | data loader: 0.15
[2024-06-18 00:38:40,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=9810, skipped=46, lr=[1.0421479179992491e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:38:40,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=9810/global_step=9810, RunningAvgSamplesPerSec=4.442129397837235, CurrSamplesPerSec=4.418150710273694, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:38:49,196] [INFO] [logging.py:96:log_dist] [Rank 0] step=9820, skipped=46, lr=[1.0402395527982887e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:38:49,196] [INFO] [timer.py:258:stop] epoch=0/micro_step=9820/global_step=9820, RunningAvgSamplesPerSec=4.442131338043384, CurrSamplesPerSec=4.444339189549672, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:38:58,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=9830, skipped=46, lr=[1.0383752036324641e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:38:58,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=9830/global_step=9830, RunningAvgSamplesPerSec=4.4421283478275635, CurrSamplesPerSec=4.423669027227217, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:39:07,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=9840, skipped=46, lr=[1.0365548889021489e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:39:07,505] [INFO] [timer.py:258:stop] epoch=0/micro_step=9840/global_step=9840, RunningAvgSamplesPerSec=4.4421229929903525, CurrSamplesPerSec=4.439690112190903, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:39:16,655] [INFO] [logging.py:96:log_dist] [Rank 0] step=9850, skipped=46, lr=[1.0347786265731143e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:39:16,656] [INFO] [timer.py:258:stop] epoch=0/micro_step=9850/global_step=9850, RunningAvgSamplesPerSec=4.442123655405312, CurrSamplesPerSec=4.444682993564207, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:39:16,657] [INFO] [RANK 0]  iteration     9850/   10000 | elapsed time per iteration (ms): 914.8 | learning rate 1.035E-05 | total loss 1.367207E+00 | loss 1.367207E+00 | loss scale 32768.0 |speed 262.36 samples/(min*GPU)
[2024-06-18 00:39:16,658] [INFO] [RANK 0] time (ms) | forward: 357.07 | backward: 552.16 | allreduce: 0.00 | optimizer: 4.76 | batch generator: 13.23 | data loader: 0.21
[2024-06-18 00:39:25,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=9860, skipped=46, lr=[1.0330464341763529e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:39:25,791] [INFO] [timer.py:258:stop] epoch=0/micro_step=9860/global_step=9860, RunningAvgSamplesPerSec=4.442124328765368, CurrSamplesPerSec=4.435116406758674, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:39:34,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=9870, skipped=46, lr=[1.031358328807904e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:39:34,919] [INFO] [timer.py:258:stop] epoch=0/micro_step=9870/global_step=9870, RunningAvgSamplesPerSec=4.442123434273626, CurrSamplesPerSec=4.438742204124482, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:39:44,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=9880, skipped=46, lr=[1.0297143271286863e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:39:44,069] [INFO] [timer.py:258:stop] epoch=0/micro_step=9880/global_step=9880, RunningAvgSamplesPerSec=4.4421216664495535, CurrSamplesPerSec=4.445606346983892, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:39:53,185] [INFO] [logging.py:96:log_dist] [Rank 0] step=9890, skipped=46, lr=[1.028114445364332e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:39:53,186] [INFO] [timer.py:258:stop] epoch=0/micro_step=9890/global_step=9890, RunningAvgSamplesPerSec=4.442124338560061, CurrSamplesPerSec=4.440405716105123, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:40:02,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=9900, skipped=46, lr=[1.026558699305029e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:40:02,349] [INFO] [timer.py:258:stop] epoch=0/micro_step=9900/global_step=9900, RunningAvgSamplesPerSec=4.442118640473878, CurrSamplesPerSec=4.427599766179717, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:40:02,351] [INFO] [RANK 0]  iteration     9900/   10000 | elapsed time per iteration (ms): 913.9 | learning rate 1.026E-05 | total loss 1.318569E+00 | loss 1.318569E+00 | loss scale 32768.0 |speed 262.62 samples/(min*GPU)
[2024-06-18 00:40:02,353] [INFO] [RANK 0] time (ms) | forward: 356.14 | backward: 552.11 | allreduce: 0.00 | optimizer: 4.83 | batch generator: 12.41 | data loader: 0.12
[2024-06-18 00:40:02,353] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:40:02,366] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/9900/mp_rank_00_model_states.pt
[2024-06-18 00:40:02,366] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/9900/mp_rank_00_model_states.pt...
[2024-06-18 00:40:27,248] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/9900/mp_rank_00_model_states.pt.
[2024-06-18 00:40:36,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=9910, skipped=46, lr=[1.0250471043053626e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:40:36,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=9910/global_step=9910, RunningAvgSamplesPerSec=4.442144016677818, CurrSamplesPerSec=4.472233166232075, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:40:45,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=9920, skipped=46, lr=[1.0235796752841654e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:40:45,444] [INFO] [timer.py:258:stop] epoch=0/micro_step=9920/global_step=9920, RunningAvgSamplesPerSec=4.4421717365591755, CurrSamplesPerSec=4.4734816902114485, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:40:54,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=9930, skipped=46, lr=[1.0221564267243684e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:40:54,557] [INFO] [timer.py:258:stop] epoch=0/micro_step=9930/global_step=9930, RunningAvgSamplesPerSec=4.442188777142363, CurrSamplesPerSec=4.4446606211371, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:41:03,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=9940, skipped=46, lr=[1.020777372672862e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:41:03,679] [INFO] [timer.py:258:stop] epoch=0/micro_step=9940/global_step=9940, RunningAvgSamplesPerSec=4.442192593184109, CurrSamplesPerSec=4.423732013411564, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:41:12,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=9950, skipped=46, lr=[1.0194425267403516e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:41:12,813] [INFO] [timer.py:258:stop] epoch=0/micro_step=9950/global_step=9950, RunningAvgSamplesPerSec=4.442188067310195, CurrSamplesPerSec=4.427520311782932, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:41:12,815] [INFO] [RANK 0]  iteration     9950/   10000 | elapsed time per iteration (ms): 1409.3 | learning rate 1.019E-05 | total loss 1.249673E+00 | loss 1.249673E+00 | loss scale 32768.0 |speed 170.30 samples/(min*GPU)
[2024-06-18 00:41:12,815] [INFO] [RANK 0] time (ms) | forward: 355.04 | backward: 549.82 | allreduce: 0.00 | optimizer: 4.89 | batch generator: 12.24 | data loader: 0.10
[2024-06-18 00:41:21,952] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-18 00:41:21,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=9960, skipped=47, lr=[1.0181519021012276e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:41:21,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=9960/global_step=9960, RunningAvgSamplesPerSec=4.442176647734035, CurrSamplesPerSec=4.4225740541620615, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:41:22,867] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-18 00:41:31,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=9970, skipped=48, lr=[1.017151250295734e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:41:31,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=9970/global_step=9970, RunningAvgSamplesPerSec=4.442162332066671, CurrSamplesPerSec=4.3980087712629725, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:41:40,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=9980, skipped=48, lr=[1.0159402557909535e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:41:40,263] [INFO] [timer.py:258:stop] epoch=0/micro_step=9980/global_step=9980, RunningAvgSamplesPerSec=4.442159758127538, CurrSamplesPerSec=4.440706597131696, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:41:49,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=9990, skipped=48, lr=[1.0147735171455601e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:41:49,428] [INFO] [timer.py:258:stop] epoch=0/micro_step=9990/global_step=9990, RunningAvgSamplesPerSec=4.442156048862146, CurrSamplesPerSec=4.442392755209226, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:41:58,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=10000, skipped=48, lr=[1.013651045874794e-05], mom=[[0.9, 0.95]]
[2024-06-18 00:41:58,576] [INFO] [timer.py:258:stop] epoch=0/micro_step=10000/global_step=10000, RunningAvgSamplesPerSec=4.442156647463598, CurrSamplesPerSec=4.444965612035298, MemAllocated=14.61GB, MaxMemAllocated=18.94GB
[2024-06-18 00:41:58,578] [INFO] [RANK 0]  iteration    10000/   10000 | elapsed time per iteration (ms): 915.3 | learning rate 1.014E-05 | total loss 1.282822E+00 | loss 1.282822E+00 | loss scale 32768.0 |speed 262.22 samples/(min*GPU)
[2024-06-18 00:41:58,579] [INFO] [RANK 0] time (ms) | forward: 357.67 | backward: 552.05 | allreduce: 0.00 | optimizer: 4.75 | batch generator: 12.97 | data loader: 0.10
[2024-06-18 00:42:05,231] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-18 00:42:05,232] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-18 00:42:05,232] [INFO] [RANK 0]  validation loss at iteration 10000 | loss: 1.908496E+00 | PPL: 6.742940E+00 loss 1.909180E+00 |
[2024-06-18 00:42:05,233] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-18 00:42:05,489] [INFO] [RANK 0] Saving Model...
[2024-06-18 00:42:05,505] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-21-54/10000/mp_rank_00_model_states.pt
[2024-06-18 00:42:05,505] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-21-54/10000/mp_rank_00_model_states.pt...
[2024-06-18 00:42:28,599] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-21-54/10000/mp_rank_00_model_states.pt.
discover-01:761761:763212 [0] NCCL INFO [Service thread] Connection closed by localRank 0
discover-01:761761:868810 [0] NCCL INFO comm 0x556dfbabaf20 rank 0 nranks 1 cudaDev 0 busId 1000 - Abort COMPLETE
[2024-06-18 00:42:31,109] [INFO] [launch.py:351:main] Process 761761 exits successfully.
