NCCL_DEBUG=info NCCL_IB_DISABLE=0 NCCL_NET_GDR_LEVEL=2 deepspeed --master_port 16666 --hostfile hostfile_single finetune_visualglm.py --experiment-name finetune-visualglm-6b --model-parallel-size 1 --mode finetune --train-iters 20000 --resume-dataloader --max_source_length 64 --max_target_length 256 --lora_rank 10 --layer_range 0 14 --pre_seq_len 4 --train-data ./finetune-data/train/dataset.json --valid-data ./finetune-data/test/dataset.json --distributed-backend nccl --lr-decay-style cosine --warmup .02 --checkpoint-activations --save-interval 300 --eval-interval 1000 --save ./checkpoints --split 1 --eval-iters 10 --eval-batch-size 8 --zero-stage 1 --lr 0.0001 --batch-size 4 --skip-init --fp16 --use_lora
[2024-06-17 05:46:23,106] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 05:46:25,186] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0: setting --include=localhost:0
[2024-06-17 05:46:25,186] [INFO] [runner.py:568:main] cmd = /DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/bin/python3.12 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=16666 --enable_each_rank_log=None finetune_visualglm.py --experiment-name finetune-visualglm-6b --model-parallel-size 1 --mode finetune --train-iters 20000 --resume-dataloader --max_source_length 64 --max_target_length 256 --lora_rank 10 --layer_range 0 14 --pre_seq_len 4 --train-data ./finetune-data/train/dataset.json --valid-data ./finetune-data/test/dataset.json --distributed-backend nccl --lr-decay-style cosine --warmup .02 --checkpoint-activations --save-interval 300 --eval-interval 1000 --save ./checkpoints --split 1 --eval-iters 10 --eval-batch-size 8 --zero-stage 1 --lr 0.0001 --batch-size 4 --skip-init --fp16 --use_lora
[2024-06-17 05:46:27,881] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 05:46:29,608] [INFO] [launch.py:139:main] 0 NCCL_IB_DISABLE=0
[2024-06-17 05:46:29,608] [INFO] [launch.py:139:main] 0 NCCL_DEBUG=info
[2024-06-17 05:46:29,608] [INFO] [launch.py:139:main] 0 NCCL_NET_GDR_LEVEL=2
[2024-06-17 05:46:29,608] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2024-06-17 05:46:29,608] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2024-06-17 05:46:29,608] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2024-06-17 05:46:29,608] [INFO] [launch.py:164:main] dist_world_size=1
[2024-06-17 05:46:29,609] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2024-06-17 05:46:29,611] [INFO] [launch.py:256:main] process 4104408 spawned with command: ['/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/bin/python3.12', '-u', 'finetune_visualglm.py', '--local_rank=0', '--experiment-name', 'finetune-visualglm-6b', '--model-parallel-size', '1', '--mode', 'finetune', '--train-iters', '20000', '--resume-dataloader', '--max_source_length', '64', '--max_target_length', '256', '--lora_rank', '10', '--layer_range', '0', '14', '--pre_seq_len', '4', '--train-data', './finetune-data/train/dataset.json', '--valid-data', './finetune-data/test/dataset.json', '--distributed-backend', 'nccl', '--lr-decay-style', 'cosine', '--warmup', '.02', '--checkpoint-activations', '--save-interval', '300', '--eval-interval', '1000', '--save', './checkpoints', '--split', '1', '--eval-iters', '10', '--eval-batch-size', '8', '--zero-stage', '1', '--lr', '0.0001', '--batch-size', '4', '--skip-init', '--fp16', '--use_lora']
[2024-06-17 05:46:32,132] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 05:46:35,225] [INFO] using world size: 1 and model-parallel size: 1 
[2024-06-17 05:46:35,226] [INFO] > padded vocab (size: 100) with 28 dummy tokens (new size: 128)
[2024-06-17 05:46:35,230] [INFO] [RANK 0] > initializing model parallel with size 1
[2024-06-17 05:46:35,231] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-06-17 05:46:35,231] [WARNING] [config_utils.py:69:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
[2024-06-17 05:46:35,232] [INFO] [checkpointing.py:1048:_configure_using_config_file] {'partition_activations': False, 'contiguous_memory_optimization': False, 'cpu_checkpointing': False, 'number_checkpoints': None, 'synchronize_checkpoint_boundary': False, 'profile': False}
[2024-06-17 05:46:35,235] [INFO] [checkpointing.py:229:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
[2024-06-17 05:46:35,238] [INFO] [RANK 0] building FineTuneVisualGLMModel model ...
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
replacing layer 0 attention with lora
replacing layer 14 attention with lora
[2024-06-17 05:46:46,854] [INFO] [RANK 0]  > number of parameters on model parallel rank 0: 7802848768
[2024-06-17 05:46:48,446] [INFO] [RANK 0] global rank 0 is loading checkpoint /DATA_EDS2/AIGC/2311/dingkr2311/.sat_models/visualglm-6b/1/mp_rank_00_model_states.pt
[2024-06-17 05:47:05,281] [INFO] [RANK 0] Will continue but found unexpected_keys! Check whether you are loading correct checkpoints: ['transformer.position_embeddings.weight'].
[2024-06-17 05:47:05,282] [INFO] [RANK 0] > successfully loaded /DATA_EDS2/AIGC/2311/dingkr2311/.sat_models/visualglm-6b/1/mp_rank_00_model_states.pt
[2024-06-17 05:47:11,093] [INFO] [RANK 0] Try to load tokenizer from Huggingface transformers...
[2024-06-17 05:47:12,975] [INFO] [RANK 0] > Set tokenizer as a THUDM/chatglm-6b tokenizer! Now you can get_tokenizer() everywhere.
discover-01:4104408:4104408 [0] NCCL INFO Bootstrap : Using enp196s0f0:10.0.0.14<0>
discover-01:4104408:4104408 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
discover-01:4104408:4104408 [0] NCCL INFO cudaDriverVersion 12030
NCCL version 2.20.5+cuda12.4
discover-01:4104408:4106000 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
discover-01:4104408:4106000 [0] NCCL INFO NET/IB : No device found.
discover-01:4104408:4106000 [0] NCCL INFO NET/Socket : Using [0]enp196s0f0:10.0.0.14<0> [1]tun0:198.18.1.50<0>
discover-01:4104408:4106000 [0] NCCL INFO Using non-device net plugin version 0
discover-01:4104408:4106000 [0] NCCL INFO Using network Socket
discover-01:4104408:4106000 [0] NCCL INFO comm 0x55aad4a72d30 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x1078662635c15f9b - Init START
discover-01:4104408:4106000 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:4104408:4106000 [0] NCCL INFO comm 0x55aad4a72d30 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:4104408:4106000 [0] NCCL INFO Channel 00/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 01/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 02/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 03/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 04/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 05/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 06/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 07/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 08/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 09/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 10/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 11/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 12/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 13/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 14/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 15/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 16/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 17/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 18/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 19/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 20/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 21/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 22/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 23/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 24/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 25/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 26/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 27/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 28/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 29/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 30/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Channel 31/32 :    0
discover-01:4104408:4106000 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:4104408:4106000 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:4104408:4106000 [0] NCCL INFO Connected all rings
discover-01:4104408:4106000 [0] NCCL INFO Connected all trees
discover-01:4104408:4106000 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:4104408:4106000 [0] NCCL INFO comm 0x55aad4a72d30 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x1078662635c15f9b - Init COMPLETE
transformer.layers.0.attention.query_key_value.matrix_A.0
transformer.layers.0.attention.query_key_value.matrix_A.1
transformer.layers.0.attention.query_key_value.matrix_A.2
transformer.layers.0.attention.query_key_value.matrix_B.0
transformer.layers.0.attention.query_key_value.matrix_B.1
transformer.layers.0.attention.query_key_value.matrix_B.2
transformer.layers.0.attention.dense.matrix_A.0
transformer.layers.0.attention.dense.matrix_B.0
transformer.layers.14.attention.query_key_value.matrix_A.0
transformer.layers.14.attention.query_key_value.matrix_A.1
transformer.layers.14.attention.query_key_value.matrix_A.2
transformer.layers.14.attention.query_key_value.matrix_B.0
transformer.layers.14.attention.query_key_value.matrix_B.1
transformer.layers.14.attention.query_key_value.matrix_B.2
transformer.layers.14.attention.dense.matrix_A.0
transformer.layers.14.attention.dense.matrix_B.0
[2024-06-17 05:48:11,612] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.3, git-hash=unknown, git-branch=unknown
[2024-06-17 05:48:11,615] [WARNING] [config_utils.py:69:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
discover-01:4104408:4106005 [0] NCCL INFO Using non-device net plugin version 0
discover-01:4104408:4106005 [0] NCCL INFO Using network Socket
discover-01:4104408:4106005 [0] NCCL INFO bootstrapSplit: comm 0x55aaf342dee0 parent 0x55aad4a72d30 rank 0 nranks 1 color -1091263299 key 0 prev 0 next 0 - DONE
discover-01:4104408:4106005 [0] NCCL INFO comm 0x55aaf342dee0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x8072a54298a4f2a0 - Init START
discover-01:4104408:4106005 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:4104408:4106005 [0] NCCL INFO comm 0x55aaf342dee0 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:4104408:4106005 [0] NCCL INFO Channel 00/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 01/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 02/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 03/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 04/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 05/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 06/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 07/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 08/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 09/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 10/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 11/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 12/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 13/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 14/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 15/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 16/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 17/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 18/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 19/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 20/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 21/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 22/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 23/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 24/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 25/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 26/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 27/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 28/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 29/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 30/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Channel 31/32 :    0
discover-01:4104408:4106005 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:4104408:4106005 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:4104408:4106005 [0] NCCL INFO Connected all rings
discover-01:4104408:4106005 [0] NCCL INFO Connected all trees
discover-01:4104408:4106005 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:4104408:4106005 [0] NCCL INFO comm 0x55aaf342dee0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x8072a54298a4f2a0 - Init COMPLETE
[2024-06-17 05:48:11,743] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /DATA_EDS2/AIGC/2311/dingkr2311/.cache/torch_extensions/py312_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /DATA_EDS2/AIGC/2311/dingkr2311/.cache/torch_extensions/py312_cu121/fused_adam/build.ninja...
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.9837052822113037 seconds
[2024-06-17 05:48:12,733] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-06-17 05:48:12,733] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-06-17 05:48:12,741] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-06-17 05:48:12,741] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-06-17 05:48:12,742] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 1 optimizer
[2024-06-17 05:48:12,742] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 40000000
[2024-06-17 05:48:12,743] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 100000000
[2024-06-17 05:48:12,743] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-06-17 05:48:12,744] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-06-17 05:48:13,392] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2024-06-17 05:48:13,393] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 05:48:13,394] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 23.17 GB, percent = 2.3%
[2024-06-17 05:48:13,615] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2024-06-17 05:48:13,616] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 05:48:13,617] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 23.17 GB, percent = 2.3%
[2024-06-17 05:48:13,617] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-06-17 05:48:13,826] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2024-06-17 05:48:13,827] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 05:48:13,827] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 23.17 GB, percent = 2.3%
[2024-06-17 05:48:13,829] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2024-06-17 05:48:13,829] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-06-17 05:48:13,829] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-06-17 05:48:13,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0001], mom=[[0.9, 0.95]]
[2024-06-17 05:48:13,832] [INFO] [config.py:1000:print] DeepSpeedEngine configuration:
[2024-06-17 05:48:13,832] [INFO] [config.py:1004:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-06-17 05:48:13,832] [INFO] [config.py:1004:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-06-17 05:48:13,833] [INFO] [config.py:1004:print]   amp_enabled .................. False
[2024-06-17 05:48:13,833] [INFO] [config.py:1004:print]   amp_params ................... False
[2024-06-17 05:48:13,833] [INFO] [config.py:1004:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-06-17 05:48:13,834] [INFO] [config.py:1004:print]   bfloat16_enabled ............. False
[2024-06-17 05:48:13,834] [INFO] [config.py:1004:print]   bfloat16_immediate_grad_update  False
[2024-06-17 05:48:13,834] [INFO] [config.py:1004:print]   checkpoint_parallel_write_pipeline  False
[2024-06-17 05:48:13,834] [INFO] [config.py:1004:print]   checkpoint_tag_validation_enabled  True
[2024-06-17 05:48:13,834] [INFO] [config.py:1004:print]   checkpoint_tag_validation_fail  False
[2024-06-17 05:48:13,834] [INFO] [config.py:1004:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fc99d62b860>
[2024-06-17 05:48:13,835] [INFO] [config.py:1004:print]   communication_data_type ...... None
[2024-06-17 05:48:13,835] [INFO] [config.py:1004:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-06-17 05:48:13,835] [INFO] [config.py:1004:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-06-17 05:48:13,836] [INFO] [config.py:1004:print]   curriculum_enabled_legacy .... False
[2024-06-17 05:48:13,836] [INFO] [config.py:1004:print]   curriculum_params_legacy ..... False
[2024-06-17 05:48:13,836] [INFO] [config.py:1004:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-06-17 05:48:13,837] [INFO] [config.py:1004:print]   data_efficiency_enabled ...... False
[2024-06-17 05:48:13,837] [INFO] [config.py:1004:print]   dataloader_drop_last ......... False
[2024-06-17 05:48:13,838] [INFO] [config.py:1004:print]   disable_allgather ............ False
[2024-06-17 05:48:13,838] [INFO] [config.py:1004:print]   dump_state ................... False
[2024-06-17 05:48:13,839] [INFO] [config.py:1004:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 400, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2024-06-17 05:48:13,839] [INFO] [config.py:1004:print]   eigenvalue_enabled ........... False
[2024-06-17 05:48:13,840] [INFO] [config.py:1004:print]   eigenvalue_gas_boundary_resolution  1
[2024-06-17 05:48:13,840] [INFO] [config.py:1004:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-06-17 05:48:13,840] [INFO] [config.py:1004:print]   eigenvalue_layer_num ......... 0
[2024-06-17 05:48:13,841] [INFO] [config.py:1004:print]   eigenvalue_max_iter .......... 100
[2024-06-17 05:48:13,841] [INFO] [config.py:1004:print]   eigenvalue_stability ......... 1e-06
[2024-06-17 05:48:13,842] [INFO] [config.py:1004:print]   eigenvalue_tol ............... 0.01
[2024-06-17 05:48:13,842] [INFO] [config.py:1004:print]   eigenvalue_verbose ........... False
[2024-06-17 05:48:13,843] [INFO] [config.py:1004:print]   elasticity_enabled ........... False
[2024-06-17 05:48:13,843] [INFO] [config.py:1004:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-06-17 05:48:13,844] [INFO] [config.py:1004:print]   fp16_auto_cast ............... False
[2024-06-17 05:48:13,845] [INFO] [config.py:1004:print]   fp16_enabled ................. True
[2024-06-17 05:48:13,845] [INFO] [config.py:1004:print]   fp16_master_weights_and_gradients  False
[2024-06-17 05:48:13,846] [INFO] [config.py:1004:print]   global_rank .................. 0
[2024-06-17 05:48:13,846] [INFO] [config.py:1004:print]   grad_accum_dtype ............. None
[2024-06-17 05:48:13,847] [INFO] [config.py:1004:print]   gradient_accumulation_steps .. 1
[2024-06-17 05:48:13,847] [INFO] [config.py:1004:print]   gradient_clipping ............ 0.1
[2024-06-17 05:48:13,847] [INFO] [config.py:1004:print]   gradient_predivide_factor .... 1.0
[2024-06-17 05:48:13,848] [INFO] [config.py:1004:print]   graph_harvesting ............. False
[2024-06-17 05:48:13,848] [INFO] [config.py:1004:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-06-17 05:48:13,849] [INFO] [config.py:1004:print]   initial_dynamic_scale ........ 65536
[2024-06-17 05:48:13,849] [INFO] [config.py:1004:print]   load_universal_checkpoint .... False
[2024-06-17 05:48:13,850] [INFO] [config.py:1004:print]   loss_scale ................... 0
[2024-06-17 05:48:13,850] [INFO] [config.py:1004:print]   memory_breakdown ............. False
[2024-06-17 05:48:13,851] [INFO] [config.py:1004:print]   mics_hierarchial_params_gather  False
[2024-06-17 05:48:13,851] [INFO] [config.py:1004:print]   mics_shard_size .............. -1
[2024-06-17 05:48:13,852] [INFO] [config.py:1004:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-06-17 05:48:13,852] [INFO] [config.py:1004:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-06-17 05:48:13,853] [INFO] [config.py:1004:print]   optimizer_legacy_fusion ...... False
[2024-06-17 05:48:13,853] [INFO] [config.py:1004:print]   optimizer_name ............... adam
[2024-06-17 05:48:13,854] [INFO] [config.py:1004:print]   optimizer_params ............. {'lr': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'weight_decay': 0.01}
[2024-06-17 05:48:13,854] [INFO] [config.py:1004:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-06-17 05:48:13,854] [INFO] [config.py:1004:print]   pld_enabled .................. False
[2024-06-17 05:48:13,855] [INFO] [config.py:1004:print]   pld_params ................... False
[2024-06-17 05:48:13,855] [INFO] [config.py:1004:print]   prescale_gradients ........... False
[2024-06-17 05:48:13,856] [INFO] [config.py:1004:print]   scheduler_name ............... None
[2024-06-17 05:48:13,856] [INFO] [config.py:1004:print]   scheduler_params ............. None
[2024-06-17 05:48:13,856] [INFO] [config.py:1004:print]   seq_parallel_communication_data_type  torch.float32
[2024-06-17 05:48:13,857] [INFO] [config.py:1004:print]   sparse_attention ............. None
[2024-06-17 05:48:13,857] [INFO] [config.py:1004:print]   sparse_gradients_enabled ..... False
[2024-06-17 05:48:13,857] [INFO] [config.py:1004:print]   steps_per_print .............. 10
[2024-06-17 05:48:13,858] [INFO] [config.py:1004:print]   timers_config ................ enabled=True synchronized=True
[2024-06-17 05:48:13,858] [INFO] [config.py:1004:print]   train_batch_size ............. 4
[2024-06-17 05:48:13,859] [INFO] [config.py:1004:print]   train_micro_batch_size_per_gpu  4
[2024-06-17 05:48:13,859] [INFO] [config.py:1004:print]   use_data_before_expert_parallel_  False
[2024-06-17 05:48:13,860] [INFO] [config.py:1004:print]   use_node_local_storage ....... False
[2024-06-17 05:48:13,860] [INFO] [config.py:1004:print]   wall_clock_breakdown ......... False
[2024-06-17 05:48:13,860] [INFO] [config.py:1004:print]   weight_quantization_config ... None
[2024-06-17 05:48:13,861] [INFO] [config.py:1004:print]   world_size ................... 1
[2024-06-17 05:48:13,861] [INFO] [config.py:1004:print]   zero_allow_untested_optimizer  True
[2024-06-17 05:48:13,862] [INFO] [config.py:1004:print]   zero_config .................. stage=1 contiguous_gradients=False reduce_scatter=True reduce_bucket_size=40000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=100000000 overlap_comm=True load_from_fp32_weights=False elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-06-17 05:48:13,862] [INFO] [config.py:1004:print]   zero_enabled ................. True
[2024-06-17 05:48:13,863] [INFO] [config.py:1004:print]   zero_force_ds_cpu_optimizer .. True
[2024-06-17 05:48:13,863] [INFO] [config.py:1004:print]   zero_optimization_stage ...... 1
[2024-06-17 05:48:13,865] [INFO] [config.py:990:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "gradient_clipping": 0.1, 
    "zero_optimization": {
        "stage": 1, 
        "cpu_offload": false, 
        "contiguous_gradients": false, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 4.000000e+07, 
        "allgather_bucket_size": 1.000000e+08, 
        "load_from_fp32_weights": false
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 400, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "bf16": {
        "enabled": false
    }, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0001, 
            "betas": [0.9, 0.95], 
            "eps": 1e-08, 
            "weight_decay": 0.01
        }
    }, 
    "activation_checkpointing": {
        "partition_activations": false, 
        "contiguous_memory_optimization": false
    }, 
    "wall_clock_breakdown": false
}
[2024-06-17 05:48:13,865] [INFO] [RANK 0] learning rate decaying style cosine, ratio 10.0
[2024-06-17 05:48:13,865] [INFO] [RANK 0] Finetuning Model...
[2024-06-17 05:48:13,866] [INFO] [RANK 0] arguments:
[2024-06-17 05:48:13,866] [INFO] [RANK 0]   model_class .................. VisualGLMModel
[2024-06-17 05:48:13,867] [INFO] [RANK 0]   tokenizer_type ............... THUDM/chatglm-6b
[2024-06-17 05:48:13,867] [INFO] [RANK 0]   num_layers ................... 28
[2024-06-17 05:48:13,867] [INFO] [RANK 0]   hidden_size .................. 4096
[2024-06-17 05:48:13,868] [INFO] [RANK 0]   num_attention_heads .......... 32
[2024-06-17 05:48:13,868] [INFO] [RANK 0]   vocab_size ................... 130528
[2024-06-17 05:48:13,869] [INFO] [RANK 0]   layernorm_order .............. post
[2024-06-17 05:48:13,869] [INFO] [RANK 0]   model_parallel_size .......... 1
[2024-06-17 05:48:13,869] [INFO] [RANK 0]   max_sequence_length .......... 2048
[2024-06-17 05:48:13,870] [INFO] [RANK 0]   image_length ................. 32
[2024-06-17 05:48:13,870] [INFO] [RANK 0]   eva_args ..................... {'num_layers': 39, 'hidden_size': 1408, 'num_attention_heads': 16, 'vocab_size': 1, 'layernorm_order': 'pre', 'model_parallel_size': 1, 'max_sequence_length': 257, 'inner_hidden_size': 6144, 'use_final_layernorm': False, 'layernorm_epsilon': 1e-06, 'image_size': [224, 224], 'pre_len': 1, 'post_len': 0, 'in_channels': 3, 'num_classes': 0, 'patch_size': 14}
[2024-06-17 05:48:13,871] [INFO] [RANK 0]   qformer_args ................. {'num_layers': 12, 'hidden_size': 768, 'num_attention_heads': 12, 'vocab_size': 32, 'layernorm_order': 'post', 'model_parallel_size': 1, 'max_sequence_length': 0, 'is_decoder': [True, False, True, False, True, False, True, False, True, False, True, False], 'cross_attn_hidden_size': 1408, 'layernorm_epsilon': 1e-12}
[2024-06-17 05:48:13,871] [INFO] [RANK 0]   bos_token_id ................. 130004
[2024-06-17 05:48:13,872] [INFO] [RANK 0]   mask_token_id ................ 130000
[2024-06-17 05:48:13,872] [INFO] [RANK 0]   gmask_token_id ............... 130001
[2024-06-17 05:48:13,873] [INFO] [RANK 0]   pad_token_id ................. 3
[2024-06-17 05:48:13,873] [INFO] [RANK 0]   image_size ................... [224, 224]
[2024-06-17 05:48:13,874] [INFO] [RANK 0]   pre_len ...................... 1
[2024-06-17 05:48:13,874] [INFO] [RANK 0]   post_len ..................... 0
[2024-06-17 05:48:13,874] [INFO] [RANK 0]   in_channels .................. 3
[2024-06-17 05:48:13,875] [INFO] [RANK 0]   patch_size ................... 14
[2024-06-17 05:48:13,875] [INFO] [RANK 0]   inner_hidden_size ............ None
[2024-06-17 05:48:13,876] [INFO] [RANK 0]   hidden_size_per_attention_head  None
[2024-06-17 05:48:13,876] [INFO] [RANK 0]   skip_init .................... True
[2024-06-17 05:48:13,877] [INFO] [RANK 0]   use_gpu_initialization ....... False
[2024-06-17 05:48:13,878] [INFO] [RANK 0]   num_multi_query_heads ........ 0
[2024-06-17 05:48:13,878] [INFO] [RANK 0]   layernorm_epsilon ............ 1e-05
[2024-06-17 05:48:13,879] [INFO] [RANK 0]   hidden_dropout ............... 0.1
[2024-06-17 05:48:13,879] [INFO] [RANK 0]   attention_dropout ............ 0.1
[2024-06-17 05:48:13,879] [INFO] [RANK 0]   make_vocab_size_divisible_by . 128
[2024-06-17 05:48:13,880] [INFO] [RANK 0]   experiment_name .............. finetune-visualglm-6b-06-17-05-47
[2024-06-17 05:48:13,880] [INFO] [RANK 0]   train_iters .................. 20000
[2024-06-17 05:48:13,881] [INFO] [RANK 0]   batch_size ................... 4
[2024-06-17 05:48:13,881] [INFO] [RANK 0]   lr ........................... 0.0001
[2024-06-17 05:48:13,882] [INFO] [RANK 0]   mode ......................... finetune
[2024-06-17 05:48:13,882] [INFO] [RANK 0]   seed ......................... 1234
[2024-06-17 05:48:13,883] [INFO] [RANK 0]   zero_stage ................... 1
[2024-06-17 05:48:13,883] [INFO] [RANK 0]   checkpoint_activations ....... True
[2024-06-17 05:48:13,884] [INFO] [RANK 0]   checkpoint_num_layers ........ 1
[2024-06-17 05:48:13,885] [INFO] [RANK 0]   fp16 ......................... True
[2024-06-17 05:48:13,885] [INFO] [RANK 0]   bf16 ......................... False
[2024-06-17 05:48:13,886] [INFO] [RANK 0]   gradient_accumulation_steps .. 1
[2024-06-17 05:48:13,886] [INFO] [RANK 0]   epochs ....................... None
[2024-06-17 05:48:13,886] [INFO] [RANK 0]   log_interval ................. 50
[2024-06-17 05:48:13,887] [INFO] [RANK 0]   summary_dir .................. 
[2024-06-17 05:48:13,887] [INFO] [RANK 0]   save_args .................... False
[2024-06-17 05:48:13,888] [INFO] [RANK 0]   lr_decay_iters ............... None
[2024-06-17 05:48:13,888] [INFO] [RANK 0]   lr_decay_style ............... cosine
[2024-06-17 05:48:13,888] [INFO] [RANK 0]   lr_decay_ratio ............... 0.1
[2024-06-17 05:48:13,889] [INFO] [RANK 0]   warmup ....................... 0.02
[2024-06-17 05:48:13,889] [INFO] [RANK 0]   weight_decay ................. 0.01
[2024-06-17 05:48:13,890] [INFO] [RANK 0]   save ......................... ./checkpoints/finetune-visualglm-6b-06-17-05-47
[2024-06-17 05:48:13,890] [INFO] [RANK 0]   load ......................... None
[2024-06-17 05:48:13,891] [INFO] [RANK 0]   save_interval ................ 300
[2024-06-17 05:48:13,891] [INFO] [RANK 0]   no_save_rng .................. False
[2024-06-17 05:48:13,891] [INFO] [RANK 0]   no_load_rng .................. False
[2024-06-17 05:48:13,892] [INFO] [RANK 0]   resume_dataloader ............ True
[2024-06-17 05:48:13,892] [INFO] [RANK 0]   distributed_backend .......... nccl
[2024-06-17 05:48:13,893] [INFO] [RANK 0]   local_rank ................... 0
[2024-06-17 05:48:13,893] [INFO] [RANK 0]   exit_interval ................ None
[2024-06-17 05:48:13,894] [INFO] [RANK 0]   eval_batch_size .............. 8
[2024-06-17 05:48:13,894] [INFO] [RANK 0]   eval_iters ................... 10
[2024-06-17 05:48:13,895] [INFO] [RANK 0]   eval_interval ................ 1000
[2024-06-17 05:48:13,895] [INFO] [RANK 0]   strict_eval .................. False
[2024-06-17 05:48:13,895] [INFO] [RANK 0]   train_data ................... ['./finetune-data/train/dataset.json']
[2024-06-17 05:48:13,896] [INFO] [RANK 0]   train_data_weights ........... None
[2024-06-17 05:48:13,896] [INFO] [RANK 0]   iterable_dataset ............. False
[2024-06-17 05:48:13,897] [INFO] [RANK 0]   valid_data ................... ['./finetune-data/test/dataset.json']
[2024-06-17 05:48:13,897] [INFO] [RANK 0]   test_data .................... None
[2024-06-17 05:48:13,898] [INFO] [RANK 0]   split ........................ 1
[2024-06-17 05:48:13,898] [INFO] [RANK 0]   num_workers .................. 1
[2024-06-17 05:48:13,899] [INFO] [RANK 0]   block_size ................... 10000
[2024-06-17 05:48:13,899] [INFO] [RANK 0]   prefetch_factor .............. 4
[2024-06-17 05:48:13,900] [INFO] [RANK 0]   temperature .................. 1.0
[2024-06-17 05:48:13,900] [INFO] [RANK 0]   top_p ........................ 0.0
[2024-06-17 05:48:13,901] [INFO] [RANK 0]   top_k ........................ 0
[2024-06-17 05:48:13,901] [INFO] [RANK 0]   num_beams .................... 1
[2024-06-17 05:48:13,901] [INFO] [RANK 0]   length_penalty ............... 0.0
[2024-06-17 05:48:13,902] [INFO] [RANK 0]   no_repeat_ngram_size ......... 0
[2024-06-17 05:48:13,902] [INFO] [RANK 0]   min_tgt_length ............... 0
[2024-06-17 05:48:13,903] [INFO] [RANK 0]   out_seq_length ............... 256
[2024-06-17 05:48:13,904] [INFO] [RANK 0]   input_source ................. interactive
[2024-06-17 05:48:13,905] [INFO] [RANK 0]   output_path .................. ./samples
[2024-06-17 05:48:13,905] [INFO] [RANK 0]   with_id ...................... False
[2024-06-17 05:48:13,906] [INFO] [RANK 0]   max_inference_batch_size ..... 12
[2024-06-17 05:48:13,906] [INFO] [RANK 0]   device ....................... cpu
[2024-06-17 05:48:13,907] [INFO] [RANK 0]   deepspeed .................... True
[2024-06-17 05:48:13,907] [INFO] [RANK 0]   deepspeed_config ............. {'train_micro_batch_size_per_gpu': 4, 'gradient_accumulation_steps': 1, 'gradient_clipping': 0.1, 'zero_optimization': {'stage': 1, 'cpu_offload': False, 'contiguous_gradients': False, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 40000000.0, 'allgather_bucket_size': 100000000.0, 'load_from_fp32_weights': False}, 'zero_allow_untested_optimizer': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 400, 'hysteresis': 2, 'min_loss_scale': 1}, 'bf16': {'enabled': False}, 'optimizer': {'type': 'Adam', 'params': {'lr': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'weight_decay': 0.01}}, 'activation_checkpointing': {'partition_activations': False, 'contiguous_memory_optimization': False}, 'wall_clock_breakdown': False}
[2024-06-17 05:48:13,908] [INFO] [RANK 0]   deepscale .................... False
[2024-06-17 05:48:13,908] [INFO] [RANK 0]   deepscale_config ............. None
[2024-06-17 05:48:13,908] [INFO] [RANK 0]   cuda ......................... True
[2024-06-17 05:48:13,909] [INFO] [RANK 0]   rank ......................... 0
[2024-06-17 05:48:13,909] [INFO] [RANK 0]   world_size ................... 1
[2024-06-17 05:48:13,910] [INFO] [RANK 0]   deepspeed_activation_checkpointing  True
[2024-06-17 05:48:13,910] [INFO] [RANK 0]   master_ip .................... 127.0.0.1
[2024-06-17 05:48:13,911] [INFO] [RANK 0]   master_port .................. 16666
[2024-06-17 05:48:13,911] [INFO] [RANK 0]   max_source_length ............ 64
[2024-06-17 05:48:13,911] [INFO] [RANK 0]   max_target_length ............ 256
[2024-06-17 05:48:13,912] [INFO] [RANK 0]   ignore_pad_token_for_loss .... True
[2024-06-17 05:48:13,912] [INFO] [RANK 0]   source_prefix ................ 
[2024-06-17 05:48:13,913] [INFO] [RANK 0]   pre_seq_len .................. 4
[2024-06-17 05:48:13,913] [INFO] [RANK 0]   lora_rank .................... 10
[2024-06-17 05:48:13,914] [INFO] [RANK 0]   use_ptuning .................. False
[2024-06-17 05:48:13,914] [INFO] [RANK 0]   use_lora ..................... True
[2024-06-17 05:48:13,915] [INFO] [RANK 0]   use_qlora .................... False
[2024-06-17 05:48:13,915] [INFO] [RANK 0]   layer_range .................. [0, 14]
[2024-06-17 05:48:13,916] [INFO] [RANK 0]   do_train ..................... True
[2024-06-17 05:48:13,916] [INFO] [RANK 0]   val_last_shape ............... []
[2024-06-17 05:48:13,916] [INFO] [RANK 0]   val_drop_number .............. 0
[2024-06-17 05:48:13,917] [INFO] [RANK 0]   do_valid ..................... True
[2024-06-17 05:48:13,917] [INFO] [RANK 0]   do_test ...................... False
[2024-06-17 05:48:13,918] [INFO] [RANK 0]   iteration .................... 0
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/sat/mpu/data.py:49: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  sizes_cuda = torch.cuda.LongTensor(sizes)
discover-01:4104408:4106199 [0] NCCL INFO Using non-device net plugin version 0
discover-01:4104408:4106199 [0] NCCL INFO Using network Socket
discover-01:4104408:4106199 [0] NCCL INFO bootstrapSplit: comm 0x55aac2d6cb30 parent 0x55aad4a72d30 rank 0 nranks 1 color -1091263299 key 0 prev 0 next 0 - DONE
discover-01:4104408:4106199 [0] NCCL INFO comm 0x55aac2d6cb30 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x8072a54298a4f2a0 - Init START
discover-01:4104408:4106199 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:4104408:4106199 [0] NCCL INFO comm 0x55aac2d6cb30 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:4104408:4106199 [0] NCCL INFO Channel 00/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 01/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 02/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 03/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 04/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 05/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 06/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 07/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 08/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 09/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 10/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 11/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 12/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 13/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 14/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 15/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 16/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 17/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 18/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 19/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 20/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 21/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 22/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 23/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 24/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 25/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 26/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 27/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 28/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 29/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 30/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Channel 31/32 :    0
discover-01:4104408:4106199 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:4104408:4106199 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:4104408:4106199 [0] NCCL INFO Connected all rings
discover-01:4104408:4106199 [0] NCCL INFO Connected all trees
discover-01:4104408:4106199 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:4104408:4106199 [0] NCCL INFO comm 0x55aac2d6cb30 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0x8072a54298a4f2a0 - Init COMPLETE
[2024-06-17 05:48:15,285] [INFO] [checkpointing.py:541:forward] Activation Checkpointing Information
[2024-06-17 05:48:15,286] [INFO] [checkpointing.py:542:forward] ----Partition Activations False, CPU CHECKPOINTING False
[2024-06-17 05:48:15,286] [INFO] [checkpointing.py:543:forward] ----contiguous Memory Checkpointing False with 6 total layers
[2024-06-17 05:48:15,286] [INFO] [checkpointing.py:545:forward] ----Synchronization False
[2024-06-17 05:48:15,286] [INFO] [checkpointing.py:546:forward] ----Profiling time in checkpointing False
[2024-06-17 05:48:17,329] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 05:48:18,233] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 05:48:25,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:48:25,850] [INFO] [timer.py:258:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=4.28015726703091, CurrSamplesPerSec=4.5409302331875825, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:48:34,887] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:48:34,888] [INFO] [timer.py:258:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=4.405576158149141, CurrSamplesPerSec=4.512569915422343, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:48:43,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:48:43,918] [INFO] [timer.py:258:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=4.446936318371762, CurrSamplesPerSec=4.514811604506842, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:48:52,949] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:48:52,950] [INFO] [timer.py:258:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=4.466568001561947, CurrSamplesPerSec=4.528117990272377, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:49:01,987] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:49:01,987] [INFO] [timer.py:258:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=4.476799516026944, CurrSamplesPerSec=4.508329432452783, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:49:01,989] [INFO] [RANK 0]  iteration       50/   20000 | elapsed time per iteration (ms): 957.0 | learning rate 5.000E-06 | total loss 3.272344E+00 | loss 3.272344E+00 | loss scale 32768.0 |speed 250.77 samples/(min*GPU)
[2024-06-17 05:49:01,991] [INFO] [RANK 0] after 50 iterations memory (MB) | allocated: 14931.65234375 | max allocated: 17771.33740234375 | cached: 19278.0 | max cached: 19278.0
[2024-06-17 05:49:01,991] [INFO] [RANK 0] time (ms) | forward: 389.85 | backward: 553.15 | allreduce: 0.00 | optimizer: 13.08 | batch generator: 19.22 | data loader: 0.36
[2024-06-17 05:49:11,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:49:11,037] [INFO] [timer.py:258:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=4.481908369145175, CurrSamplesPerSec=4.507388319521009, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:49:20,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:49:20,069] [INFO] [timer.py:258:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=4.485554800141515, CurrSamplesPerSec=4.515432530719726, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:49:29,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:49:29,125] [INFO] [timer.py:258:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=4.487181625603522, CurrSamplesPerSec=4.4953906561278085, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:49:38,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:49:38,173] [INFO] [timer.py:258:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=4.488257994599785, CurrSamplesPerSec=4.495355725241565, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:49:47,217] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 05:49:47,217] [INFO] [timer.py:258:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=4.48980222315732, CurrSamplesPerSec=4.51059722635583, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:49:47,218] [INFO] [RANK 0]  iteration      100/   20000 | elapsed time per iteration (ms): 904.6 | learning rate 5.000E-06 | total loss 3.258203E+00 | loss 3.258203E+00 | loss scale 32768.0 |speed 265.31 samples/(min*GPU)
[2024-06-17 05:49:47,219] [INFO] [RANK 0] time (ms) | forward: 356.39 | backward: 544.07 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.46 | data loader: 0.25
[2024-06-17 05:49:56,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=2, lr=[2.7000000000000002e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:49:56,244] [INFO] [timer.py:258:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=4.4916484111113215, CurrSamplesPerSec=4.505861815212896, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:50:05,306] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=2, lr=[2.95e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:50:05,307] [INFO] [timer.py:258:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=4.491614008827412, CurrSamplesPerSec=4.467999104121388, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:50:14,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=2, lr=[3.2e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:50:14,359] [INFO] [timer.py:258:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=4.491881085358179, CurrSamplesPerSec=4.480825933491158, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:50:23,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=2, lr=[3.4500000000000005e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:50:23,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=4.4930534918309535, CurrSamplesPerSec=4.50758571476165, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:50:32,440] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=2, lr=[3.7000000000000005e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:50:32,440] [INFO] [timer.py:258:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=4.493627885736912, CurrSamplesPerSec=4.496588270640903, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:50:32,441] [INFO] [RANK 0]  iteration      150/   20000 | elapsed time per iteration (ms): 904.5 | learning rate 3.725E-05 | total loss 3.225234E+00 | loss 3.225234E+00 | loss scale 32768.0 |speed 265.35 samples/(min*GPU)
[2024-06-17 05:50:32,442] [INFO] [RANK 0] time (ms) | forward: 356.07 | backward: 544.24 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 15.24 | data loader: 0.27
[2024-06-17 05:50:41,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=2, lr=[3.9500000000000005e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:50:41,497] [INFO] [timer.py:258:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=4.494101195774682, CurrSamplesPerSec=4.496353275834068, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:50:50,527] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=2, lr=[4.2000000000000004e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:50:50,527] [INFO] [timer.py:258:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=4.494541520516687, CurrSamplesPerSec=4.466149593454381, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:50:59,567] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=2, lr=[4.45e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:50:59,568] [INFO] [timer.py:258:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=4.49497327364013, CurrSamplesPerSec=4.5074936755656525, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:51:08,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=2, lr=[4.7000000000000004e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:51:08,629] [INFO] [timer.py:258:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=4.495197992013141, CurrSamplesPerSec=4.50143825768115, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:51:17,687] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=2, lr=[4.9500000000000004e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:51:17,688] [INFO] [timer.py:258:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=4.4954218096802485, CurrSamplesPerSec=4.486126530830526, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:51:17,689] [INFO] [RANK 0]  iteration      200/   20000 | elapsed time per iteration (ms): 905.0 | learning rate 4.975E-05 | total loss 3.133437E+00 | loss 3.133437E+00 | loss scale 32768.0 |speed 265.20 samples/(min*GPU)
[2024-06-17 05:51:17,690] [INFO] [RANK 0] time (ms) | forward: 356.65 | backward: 544.23 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.65 | data loader: 0.24
[2024-06-17 05:51:26,748] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=2, lr=[5.2000000000000004e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:51:26,749] [INFO] [timer.py:258:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=4.495411405284908, CurrSamplesPerSec=4.506154688279744, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:51:35,821] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=2, lr=[5.4499999999999997e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:51:35,821] [INFO] [timer.py:258:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=4.495551404874638, CurrSamplesPerSec=4.503674942849136, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:51:44,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=2, lr=[5.7e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:51:44,886] [INFO] [timer.py:258:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=4.495303588786711, CurrSamplesPerSec=4.503992923423442, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:51:53,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=2, lr=[5.95e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:51:53,950] [INFO] [timer.py:258:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=4.49539965969981, CurrSamplesPerSec=4.459998367763163, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:52:03,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=2, lr=[6.2e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:52:03,011] [INFO] [timer.py:258:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=4.49539531394412, CurrSamplesPerSec=4.485209052643117, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:52:03,013] [INFO] [RANK 0]  iteration      250/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 6.225E-05 | total loss 2.723672E+00 | loss 2.723672E+00 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 05:52:03,014] [INFO] [RANK 0] time (ms) | forward: 357.76 | backward: 544.60 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 16.08 | data loader: 0.21
[2024-06-17 05:52:12,088] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=2, lr=[6.45e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:52:12,088] [INFO] [timer.py:258:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=4.495340290836848, CurrSamplesPerSec=4.498214625645151, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:52:21,227] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=2, lr=[6.7e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:52:21,228] [INFO] [timer.py:258:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=4.49530239960744, CurrSamplesPerSec=4.495824326124082, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:52:30,277] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=2, lr=[6.950000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:52:30,278] [INFO] [timer.py:258:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=4.4955759089508405, CurrSamplesPerSec=4.507098918492864, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:52:39,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=2, lr=[7.2e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:52:39,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=4.4955149010570565, CurrSamplesPerSec=4.50015839001711, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:52:48,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=2, lr=[7.45e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:52:48,427] [INFO] [timer.py:258:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=4.495531581614846, CurrSamplesPerSec=4.49344137951722, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:52:48,429] [INFO] [RANK 0]  iteration      300/   20000 | elapsed time per iteration (ms): 908.3 | learning rate 7.475E-05 | total loss 2.399023E+00 | loss 2.399023E+00 | loss scale 32768.0 |speed 264.23 samples/(min*GPU)
[2024-06-17 05:52:48,429] [INFO] [RANK 0] time (ms) | forward: 359.54 | backward: 544.60 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 18.08 | data loader: 0.17
[2024-06-17 05:52:48,429] [INFO] [RANK 0] Saving Model...
[2024-06-17 05:52:48,448] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/300/mp_rank_00_model_states.pt
[2024-06-17 05:52:48,448] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/300/mp_rank_00_model_states.pt...
[2024-06-17 05:53:16,745] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/300/mp_rank_00_model_states.pt.
[2024-06-17 05:53:25,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=2, lr=[7.7e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:53:25,828] [INFO] [timer.py:258:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=4.495732007793726, CurrSamplesPerSec=4.501794576771823, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:53:34,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=2, lr=[7.950000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:53:34,818] [INFO] [timer.py:258:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=4.496783095069191, CurrSamplesPerSec=4.5161229192238945, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:53:43,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=2, lr=[8.2e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:53:43,833] [INFO] [timer.py:258:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=4.497717120758548, CurrSamplesPerSec=4.516026884239977, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:53:51,064] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
[2024-06-17 05:53:52,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=3, lr=[8.425e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:53:52,886] [INFO] [timer.py:258:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=4.498108661064806, CurrSamplesPerSec=4.4938614327082576, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:54:01,913] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=3, lr=[8.675000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:54:01,914] [INFO] [timer.py:258:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=4.498300099907596, CurrSamplesPerSec=4.503824859654925, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:54:01,915] [INFO] [RANK 0]  iteration      350/   20000 | elapsed time per iteration (ms): 1469.7 | learning rate 8.700E-05 | total loss 1.915254E+00 | loss 1.915254E+00 | loss scale 16384.0 |speed 163.30 samples/(min*GPU)
[2024-06-17 05:54:01,916] [INFO] [RANK 0] time (ms) | forward: 356.32 | backward: 542.53 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 16.48 | data loader: 0.19
[2024-06-17 05:54:10,973] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=3, lr=[8.925e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:54:10,974] [INFO] [timer.py:258:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=4.498176093446019, CurrSamplesPerSec=4.480695493696741, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:54:20,033] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=3, lr=[9.175000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:54:20,033] [INFO] [timer.py:258:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=4.498128503834509, CurrSamplesPerSec=4.5037897975723284, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:54:29,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=3, lr=[9.425000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:54:29,081] [INFO] [timer.py:258:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=4.4980548889122085, CurrSamplesPerSec=4.477507466641971, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:54:38,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=3, lr=[9.675000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:54:38,111] [INFO] [timer.py:258:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=4.498218047931732, CurrSamplesPerSec=4.50325305315123, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:54:47,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=3, lr=[9.925e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:54:47,167] [INFO] [timer.py:258:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=4.498169420942489, CurrSamplesPerSec=4.504670141942135, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:54:47,167] [INFO] [RANK 0]  iteration      400/   20000 | elapsed time per iteration (ms): 905.0 | learning rate 9.950E-05 | total loss 1.533887E+00 | loss 1.533887E+00 | loss scale 16384.0 |speed 265.18 samples/(min*GPU)
[2024-06-17 05:54:47,169] [INFO] [RANK 0] time (ms) | forward: 356.56 | backward: 544.31 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 15.00 | data loader: 0.10
[2024-06-17 05:54:56,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=3, lr=[9.999997279690561e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:54:56,215] [INFO] [timer.py:258:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=4.498158081571241, CurrSamplesPerSec=4.501998730751634, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:55:05,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=3, lr=[9.999983955733881e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:55:05,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=4.498174460372029, CurrSamplesPerSec=4.4871391907259675, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:55:14,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=3, lr=[9.99995952851412e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:55:14,322] [INFO] [timer.py:258:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=4.497977739302188, CurrSamplesPerSec=4.495890588630638, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:55:23,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=3, lr=[9.999923998091547e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:55:23,375] [INFO] [timer.py:258:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=4.497824575501032, CurrSamplesPerSec=4.4893628863419375, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:55:32,446] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=3, lr=[9.999877364553835e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:55:32,446] [INFO] [timer.py:258:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=4.497604959924412, CurrSamplesPerSec=4.498525804586791, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:55:32,448] [INFO] [RANK 0]  iteration      450/   20000 | elapsed time per iteration (ms): 905.6 | learning rate 1.000E-04 | total loss 1.272114E+00 | loss 1.272114E+00 | loss scale 16384.0 |speed 265.01 samples/(min*GPU)
[2024-06-17 05:55:32,449] [INFO] [RANK 0] time (ms) | forward: 356.80 | backward: 544.46 | allreduce: 0.00 | optimizer: 3.45 | batch generator: 14.70 | data loader: 0.13
[2024-06-17 05:55:41,518] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=3, lr=[9.999819628016046e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:55:41,519] [INFO] [timer.py:258:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=4.497453950666685, CurrSamplesPerSec=4.487384025471601, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:55:50,593] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=3, lr=[9.999750788620638e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:55:50,594] [INFO] [timer.py:258:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=4.497401149123897, CurrSamplesPerSec=4.490836156855229, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:55:59,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=3, lr=[9.999670846537467e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:55:59,661] [INFO] [timer.py:258:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=4.497274441730293, CurrSamplesPerSec=4.489350873427998, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:56:08,735] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=3, lr=[9.99957980196378e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:56:08,736] [INFO] [timer.py:258:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=4.497167797330702, CurrSamplesPerSec=4.49163327947655, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:56:17,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=3, lr=[9.999477655124223e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:56:17,789] [INFO] [timer.py:258:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=4.497103387451738, CurrSamplesPerSec=4.4972885802990366, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:56:17,790] [INFO] [RANK 0]  iteration      500/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 9.999E-05 | total loss 1.334619E+00 | loss 1.334619E+00 | loss scale 16384.0 |speed 264.66 samples/(min*GPU)
[2024-06-17 05:56:17,790] [INFO] [RANK 0] time (ms) | forward: 358.08 | backward: 544.38 | allreduce: 0.00 | optimizer: 3.54 | batch generator: 15.86 | data loader: 0.15
[2024-06-17 05:56:26,883] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=3, lr=[9.99936440627083e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:56:26,883] [INFO] [timer.py:258:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=4.497027973321164, CurrSamplesPerSec=4.481864936169576, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:56:35,951] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=3, lr=[9.999240055683037e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:56:35,952] [INFO] [timer.py:258:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=4.496979131568344, CurrSamplesPerSec=4.503967531690052, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:56:45,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=3, lr=[9.999104603667659e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:56:45,022] [INFO] [timer.py:258:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=4.496851450158477, CurrSamplesPerSec=4.500777706776377, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:56:54,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=3, lr=[9.998958050558916e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:56:54,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=4.496666347843133, CurrSamplesPerSec=4.4931922733192655, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:57:03,190] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=3, lr=[9.998800396718409e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:57:03,191] [INFO] [timer.py:258:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=4.49647909373996, CurrSamplesPerSec=4.485838654132041, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:57:03,192] [INFO] [RANK 0]  iteration      550/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 9.999E-05 | total loss 1.077100E+00 | loss 1.077100E+00 | loss scale 16384.0 |speed 264.30 samples/(min*GPU)
[2024-06-17 05:57:03,193] [INFO] [RANK 0] time (ms) | forward: 359.06 | backward: 544.51 | allreduce: 0.00 | optimizer: 3.65 | batch generator: 16.62 | data loader: 0.12
[2024-06-17 05:57:12,241] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=3, lr=[9.998631642535139e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:57:12,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=4.496499079433945, CurrSamplesPerSec=4.504304902372186, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:57:21,285] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=3, lr=[9.998451788425485e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:57:21,286] [INFO] [timer.py:258:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=4.496559506008205, CurrSamplesPerSec=4.497811845524122, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:57:30,352] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=3, lr=[9.998260834833222e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:57:30,353] [INFO] [timer.py:258:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=4.496417327258048, CurrSamplesPerSec=4.49945959978738, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:57:39,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=3, lr=[9.998058782229507e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:57:39,392] [INFO] [timer.py:258:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=4.496524309696453, CurrSamplesPerSec=4.502269353913746, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:57:48,486] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=3, lr=[9.997845631112885e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:57:48,486] [INFO] [timer.py:258:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=4.496487234575016, CurrSamplesPerSec=4.501604935522188, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:57:48,488] [INFO] [RANK 0]  iteration      600/   20000 | elapsed time per iteration (ms): 905.9 | learning rate 9.998E-05 | total loss 1.178867E+00 | loss 1.178867E+00 | loss scale 16384.0 |speed 264.93 samples/(min*GPU)
[2024-06-17 05:57:48,488] [INFO] [RANK 0] time (ms) | forward: 357.26 | backward: 544.42 | allreduce: 0.00 | optimizer: 3.39 | batch generator: 15.75 | data loader: 0.11
[2024-06-17 05:57:48,489] [INFO] [RANK 0] Saving Model...
[2024-06-17 05:57:48,505] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/600/mp_rank_00_model_states.pt
[2024-06-17 05:57:48,505] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/600/mp_rank_00_model_states.pt...
[2024-06-17 05:58:16,685] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/600/mp_rank_00_model_states.pt.
[2024-06-17 05:58:25,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=3, lr=[9.997621382009288e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:58:25,800] [INFO] [timer.py:258:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=4.49631371801548, CurrSamplesPerSec=4.522692154657529, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:58:34,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=3, lr=[9.997386035472025e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:58:34,788] [INFO] [timer.py:258:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=4.496769596715209, CurrSamplesPerSec=4.488789941943733, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:58:43,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=3, lr=[9.997139592081791e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:58:43,781] [INFO] [timer.py:258:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=4.497237696721657, CurrSamplesPerSec=4.529212056290333, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:58:52,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=3, lr=[9.996882052446662e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:58:52,806] [INFO] [timer.py:258:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=4.4974816053592575, CurrSamplesPerSec=4.465921335633212, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:59:01,838] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=3, lr=[9.99661341720209e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:59:01,838] [INFO] [timer.py:258:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=4.49755535905111, CurrSamplesPerSec=4.501252269444921, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:59:01,840] [INFO] [RANK 0]  iteration      650/   20000 | elapsed time per iteration (ms): 1467.1 | learning rate 9.997E-05 | total loss 1.060186E+00 | loss 1.060186E+00 | loss scale 16384.0 |speed 163.59 samples/(min*GPU)
[2024-06-17 05:59:01,841] [INFO] [RANK 0] time (ms) | forward: 356.36 | backward: 542.11 | allreduce: 0.00 | optimizer: 3.58 | batch generator: 15.31 | data loader: 0.12
[2024-06-17 05:59:10,893] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=3, lr=[9.996333687010906e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:59:10,893] [INFO] [timer.py:258:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=4.497561886224081, CurrSamplesPerSec=4.5043847178828775, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:59:19,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=3, lr=[9.996042862563317e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:59:19,950] [INFO] [timer.py:258:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=4.497513986063295, CurrSamplesPerSec=4.498493237331678, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:59:29,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=3, lr=[9.995740944576904e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:59:29,019] [INFO] [timer.py:258:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=4.497518647501962, CurrSamplesPerSec=4.503765617143779, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:59:38,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=3, lr=[9.995427933796617e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:59:38,068] [INFO] [timer.py:258:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=4.49751353339487, CurrSamplesPerSec=4.509016438602833, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:59:47,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=3, lr=[9.99510383099478e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:59:47,130] [INFO] [timer.py:258:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=4.497447921023064, CurrSamplesPerSec=4.501761962170875, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 05:59:47,132] [INFO] [RANK 0]  iteration      700/   20000 | elapsed time per iteration (ms): 905.8 | learning rate 9.995E-05 | total loss 1.074771E+00 | loss 1.074771E+00 | loss scale 16384.0 |speed 264.95 samples/(min*GPU)
[2024-06-17 05:59:47,132] [INFO] [RANK 0] time (ms) | forward: 357.30 | backward: 544.32 | allreduce: 0.00 | optimizer: 3.42 | batch generator: 15.61 | data loader: 0.12
[2024-06-17 05:59:56,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=3, lr=[9.994768636971087e-05], mom=[[0.9, 0.95]]
[2024-06-17 05:59:56,205] [INFO] [timer.py:258:stop] epoch=0/micro_step=710/global_step=710, RunningAvgSamplesPerSec=4.497416425658361, CurrSamplesPerSec=4.492786782695134, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:00:05,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=3, lr=[9.994422352552592e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:00:05,277] [INFO] [timer.py:258:stop] epoch=0/micro_step=720/global_step=720, RunningAvgSamplesPerSec=4.497268641965126, CurrSamplesPerSec=4.487044384446789, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:00:14,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=3, lr=[9.994064978593722e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:00:14,358] [INFO] [timer.py:258:stop] epoch=0/micro_step=730/global_step=730, RunningAvgSamplesPerSec=4.497068151163976, CurrSamplesPerSec=4.477601870336169, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:00:23,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=3, lr=[9.993696515976258e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:00:23,414] [INFO] [timer.py:258:stop] epoch=0/micro_step=740/global_step=740, RunningAvgSamplesPerSec=4.497054572336937, CurrSamplesPerSec=4.470710124134755, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:00:32,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=3, lr=[9.993316965609346e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:00:32,466] [INFO] [timer.py:258:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=4.497062258005328, CurrSamplesPerSec=4.477664011649196, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:00:32,468] [INFO] [RANK 0]  iteration      750/   20000 | elapsed time per iteration (ms): 906.7 | learning rate 9.993E-05 | total loss 9.587549E-01 | loss 9.587549E-01 | loss scale 32768.0 |speed 264.69 samples/(min*GPU)
[2024-06-17 06:00:32,468] [INFO] [RANK 0] time (ms) | forward: 357.32 | backward: 545.09 | allreduce: 0.00 | optimizer: 3.54 | batch generator: 15.66 | data loader: 0.10
[2024-06-17 06:00:41,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=3, lr=[9.992926328429489e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:00:41,523] [INFO] [timer.py:258:stop] epoch=0/micro_step=760/global_step=760, RunningAvgSamplesPerSec=4.49706572230886, CurrSamplesPerSec=4.504135606106774, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:00:50,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=3, lr=[9.992524605400545e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:00:50,588] [INFO] [timer.py:258:stop] epoch=0/micro_step=770/global_step=770, RunningAvgSamplesPerSec=4.497016923252689, CurrSamplesPerSec=4.485709121671121, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:00:59,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=3, lr=[9.992111797513725e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:00:59,619] [INFO] [timer.py:258:stop] epoch=0/micro_step=780/global_step=780, RunningAvgSamplesPerSec=4.497069969815359, CurrSamplesPerSec=4.498893726702362, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:01:08,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=3, lr=[9.991687905787594e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:01:08,660] [INFO] [timer.py:258:stop] epoch=0/micro_step=790/global_step=790, RunningAvgSamplesPerSec=4.497124267226201, CurrSamplesPerSec=4.503349754408607, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:01:17,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=3, lr=[9.99125293126806e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:01:17,700] [INFO] [timer.py:258:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=4.497158870658039, CurrSamplesPerSec=4.503695495369255, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:01:17,700] [INFO] [RANK 0]  iteration      800/   20000 | elapsed time per iteration (ms): 904.6 | learning rate 9.991E-05 | total loss 9.112939E-01 | loss 9.112939E-01 | loss scale 32768.0 |speed 265.30 samples/(min*GPU)
[2024-06-17 06:01:17,701] [INFO] [RANK 0] time (ms) | forward: 355.81 | backward: 544.73 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 14.94 | data loader: 0.10
[2024-06-17 06:01:26,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=3, lr=[9.99080687502838e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:01:26,739] [INFO] [timer.py:258:stop] epoch=0/micro_step=810/global_step=810, RunningAvgSamplesPerSec=4.497214609403752, CurrSamplesPerSec=4.50215216042558, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:01:35,775] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=3, lr=[9.990349738169155e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:01:35,776] [INFO] [timer.py:258:stop] epoch=0/micro_step=820/global_step=820, RunningAvgSamplesPerSec=4.497293766484938, CurrSamplesPerSec=4.505081409696125, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:01:44,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=3, lr=[9.989881521818323e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:01:44,813] [INFO] [timer.py:258:stop] epoch=0/micro_step=830/global_step=830, RunningAvgSamplesPerSec=4.497348306279842, CurrSamplesPerSec=4.506080861314571, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:01:53,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=3, lr=[9.989402227131162e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:01:53,852] [INFO] [timer.py:258:stop] epoch=0/micro_step=840/global_step=840, RunningAvgSamplesPerSec=4.497425584452277, CurrSamplesPerSec=4.501031277431872, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:02:02,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=3, lr=[9.988911855290284e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:02:02,899] [INFO] [timer.py:258:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=4.49742612979331, CurrSamplesPerSec=4.505187867701653, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:02:02,901] [INFO] [RANK 0]  iteration      850/   20000 | elapsed time per iteration (ms): 904.0 | learning rate 9.989E-05 | total loss 9.129053E-01 | loss 9.129053E-01 | loss scale 32768.0 |speed 265.48 samples/(min*GPU)
[2024-06-17 06:02:02,901] [INFO] [RANK 0] time (ms) | forward: 355.58 | backward: 544.34 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 14.85 | data loader: 0.11
[2024-06-17 06:02:11,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=3, lr=[9.988410407505632e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:02:11,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=860/global_step=860, RunningAvgSamplesPerSec=4.497414385708325, CurrSamplesPerSec=4.4880142377656576, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:02:21,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=3, lr=[9.987897885014479e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:02:21,020] [INFO] [timer.py:258:stop] epoch=0/micro_step=870/global_step=870, RunningAvgSamplesPerSec=4.497412100150783, CurrSamplesPerSec=4.482724751899596, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:02:30,079] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=3, lr=[9.987374289081424e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:02:30,079] [INFO] [timer.py:258:stop] epoch=0/micro_step=880/global_step=880, RunningAvgSamplesPerSec=4.497406164712507, CurrSamplesPerSec=4.507371366134782, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:02:39,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=3, lr=[9.986839620998386e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:02:39,140] [INFO] [timer.py:258:stop] epoch=0/micro_step=890/global_step=890, RunningAvgSamplesPerSec=4.497454750031956, CurrSamplesPerSec=4.509229731774568, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:02:48,190] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=3, lr=[9.986293882084608e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:02:48,191] [INFO] [timer.py:258:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=4.4974771773505235, CurrSamplesPerSec=4.487430835156376, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:02:48,192] [INFO] [RANK 0]  iteration      900/   20000 | elapsed time per iteration (ms): 905.8 | learning rate 9.986E-05 | total loss 7.846094E-01 | loss 7.846094E-01 | loss scale 32768.0 |speed 264.95 samples/(min*GPU)
[2024-06-17 06:02:48,193] [INFO] [RANK 0] time (ms) | forward: 357.41 | backward: 544.25 | allreduce: 0.00 | optimizer: 3.41 | batch generator: 16.05 | data loader: 0.12
[2024-06-17 06:02:48,193] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:02:48,205] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/900/mp_rank_00_model_states.pt
[2024-06-17 06:02:48,205] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/900/mp_rank_00_model_states.pt...
[2024-06-17 06:03:16,235] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/900/mp_rank_00_model_states.pt.
[2024-06-17 06:03:25,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=3, lr=[9.985737073686645e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:03:25,290] [INFO] [timer.py:258:stop] epoch=0/micro_step=910/global_step=910, RunningAvgSamplesPerSec=4.497585971358846, CurrSamplesPerSec=4.513613978921315, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:03:34,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=3, lr=[9.985169197178368e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:03:34,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=920/global_step=920, RunningAvgSamplesPerSec=4.497999049727479, CurrSamplesPerSec=4.535458954854692, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:03:43,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=3, lr=[9.984590253960954e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:03:43,233] [INFO] [timer.py:258:stop] epoch=0/micro_step=930/global_step=930, RunningAvgSamplesPerSec=4.498365660795356, CurrSamplesPerSec=4.529598467348541, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:03:52,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=3, lr=[9.984000245462889e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:03:52,235] [INFO] [timer.py:258:stop] epoch=0/micro_step=940/global_step=940, RunningAvgSamplesPerSec=4.498637168976375, CurrSamplesPerSec=4.522339833950294, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:04:01,257] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=3, lr=[9.983399173139956e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:04:01,258] [INFO] [timer.py:258:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=4.498746397935498, CurrSamplesPerSec=4.480133133839083, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:04:01,259] [INFO] [RANK 0]  iteration      950/   20000 | elapsed time per iteration (ms): 1461.3 | learning rate 9.983E-05 | total loss 8.427344E-01 | loss 8.427344E-01 | loss scale 32768.0 |speed 164.23 samples/(min*GPU)
[2024-06-17 06:04:01,260] [INFO] [RANK 0] time (ms) | forward: 354.53 | backward: 541.63 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 15.03 | data loader: 0.11
[2024-06-17 06:04:10,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=3, lr=[9.982787038475249e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:04:10,305] [INFO] [timer.py:258:stop] epoch=0/micro_step=960/global_step=960, RunningAvgSamplesPerSec=4.498841940219671, CurrSamplesPerSec=4.509924286289544, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:04:19,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=3, lr=[9.982163842979143e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:04:19,379] [INFO] [timer.py:258:stop] epoch=0/micro_step=970/global_step=970, RunningAvgSamplesPerSec=4.498765772107727, CurrSamplesPerSec=4.4706874889246855, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:04:28,454] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=3, lr=[9.981529588189316e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:04:28,454] [INFO] [timer.py:258:stop] epoch=0/micro_step=980/global_step=980, RunningAvgSamplesPerSec=4.498754672968855, CurrSamplesPerSec=4.495097976173635, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:04:37,515] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=3, lr=[9.980884275670721e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:04:37,516] [INFO] [timer.py:258:stop] epoch=0/micro_step=990/global_step=990, RunningAvgSamplesPerSec=4.4987010075656375, CurrSamplesPerSec=4.494078109752455, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:04:46,577] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=3, lr=[9.98022790701561e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:04:46,578] [INFO] [timer.py:258:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=4.4986731680643075, CurrSamplesPerSec=4.482863694588836, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 06:04:46,579] [INFO] [RANK 0]  iteration     1000/   20000 | elapsed time per iteration (ms): 906.4 | learning rate 9.980E-05 | total loss 7.628638E-01 | loss 7.628638E-01 | loss scale 32768.0 |speed 264.79 samples/(min*GPU)
[2024-06-17 06:04:46,580] [INFO] [RANK 0] time (ms) | forward: 357.00 | backward: 545.30 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 16.39 | data loader: 0.12
[2024-06-17 06:04:54,033] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 06:04:54,033] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 06:04:54,033] [INFO] [RANK 0]  validation loss at iteration 1000 | loss: 1.098975E+00 | PPL: 3.001087E+00 loss 1.099609E+00 |
[2024-06-17 06:04:54,033] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 06:05:03,091] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=3, lr=[9.979560483843504e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:05:03,092] [INFO] [timer.py:258:stop] epoch=0/micro_step=1010/global_step=1010, RunningAvgSamplesPerSec=4.498606795181836, CurrSamplesPerSec=4.4947258579372, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:05:12,167] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=3, lr=[9.978882007801206e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:05:12,167] [INFO] [timer.py:258:stop] epoch=0/micro_step=1020/global_step=1020, RunningAvgSamplesPerSec=4.498483836684384, CurrSamplesPerSec=4.456376837232381, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:05:21,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=3, lr=[9.978192480562786e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:05:21,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=1030/global_step=1030, RunningAvgSamplesPerSec=4.498411733260103, CurrSamplesPerSec=4.49519914518098, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:05:30,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=3, lr=[9.977491903829582e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:05:30,314] [INFO] [timer.py:258:stop] epoch=0/micro_step=1040/global_step=1040, RunningAvgSamplesPerSec=4.49833625039448, CurrSamplesPerSec=4.496058060762597, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:05:39,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=3, lr=[9.9767802793302e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:05:39,387] [INFO] [timer.py:258:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=4.498251101640184, CurrSamplesPerSec=4.475186866054476, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:05:39,388] [INFO] [RANK 0]  iteration     1050/   20000 | elapsed time per iteration (ms): 1056.2 | learning rate 9.977E-05 | total loss 7.601611E-01 | loss 7.601611E-01 | loss scale 32768.0 |speed 227.23 samples/(min*GPU)
[2024-06-17 06:05:39,389] [INFO] [RANK 0] time (ms) | forward: 357.17 | backward: 545.84 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 19.54 | data loader: 0.17
[2024-06-17 06:05:48,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=3, lr=[9.976057608820503e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:05:48,463] [INFO] [timer.py:258:stop] epoch=0/micro_step=1060/global_step=1060, RunningAvgSamplesPerSec=4.498155295815593, CurrSamplesPerSec=4.4985438977100545, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:05:57,509] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=3, lr=[9.975323894083609e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:05:57,509] [INFO] [timer.py:258:stop] epoch=0/micro_step=1070/global_step=1070, RunningAvgSamplesPerSec=4.498155695498984, CurrSamplesPerSec=4.500256165542489, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:06:06,575] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=3, lr=[9.974579136929886e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:06:06,576] [INFO] [timer.py:258:stop] epoch=0/micro_step=1080/global_step=1080, RunningAvgSamplesPerSec=4.49815003537491, CurrSamplesPerSec=4.492095090781885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:06:15,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=3, lr=[9.973823339196945e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:06:15,642] [INFO] [timer.py:258:stop] epoch=0/micro_step=1090/global_step=1090, RunningAvgSamplesPerSec=4.4980851666738655, CurrSamplesPerSec=4.4753921953067275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:06:24,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=3, lr=[9.973056502749645e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:06:24,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=4.4980831297721, CurrSamplesPerSec=4.492787985823143, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:06:24,704] [INFO] [RANK 0]  iteration     1100/   20000 | elapsed time per iteration (ms): 906.3 | learning rate 9.973E-05 | total loss 7.736963E-01 | loss 7.736963E-01 | loss scale 32768.0 |speed 264.81 samples/(min*GPU)
[2024-06-17 06:06:24,705] [INFO] [RANK 0] time (ms) | forward: 356.79 | backward: 545.50 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 15.82 | data loader: 0.10
[2024-06-17 06:06:33,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=3, lr=[9.972278629480077e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:06:33,745] [INFO] [timer.py:258:stop] epoch=0/micro_step=1110/global_step=1110, RunningAvgSamplesPerSec=4.49810913475702, CurrSamplesPerSec=4.5005627978295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:06:42,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=3, lr=[9.971489721307567e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:06:42,806] [INFO] [timer.py:258:stop] epoch=0/micro_step=1120/global_step=1120, RunningAvgSamplesPerSec=4.49806376395334, CurrSamplesPerSec=4.489437367843337, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:06:51,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=3, lr=[9.970689780178669e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:06:51,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=1130/global_step=1130, RunningAvgSamplesPerSec=4.49799815785739, CurrSamplesPerSec=4.497084853272333, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:07:00,049] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 06:07:00,955] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 06:07:00,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=5, lr=[9.969960401615709e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:07:00,956] [INFO] [timer.py:258:stop] epoch=0/micro_step=1140/global_step=1140, RunningAvgSamplesPerSec=4.497941522650977, CurrSamplesPerSec=4.508683208414738, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:07:10,029] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=5, lr=[9.969222089414216e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:07:10,029] [INFO] [timer.py:258:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=4.4978526326681925, CurrSamplesPerSec=4.49396134230489, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:07:10,031] [INFO] [RANK 0]  iteration     1150/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 9.969E-05 | total loss 7.570898E-01 | loss 7.570898E-01 | loss scale 32768.0 |speed 264.74 samples/(min*GPU)
[2024-06-17 06:07:10,032] [INFO] [RANK 0] time (ms) | forward: 357.29 | backward: 545.19 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.64 | data loader: 0.10
[2024-06-17 06:07:19,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=5, lr=[9.968391266594785e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:07:19,098] [INFO] [timer.py:258:stop] epoch=0/micro_step=1160/global_step=1160, RunningAvgSamplesPerSec=4.497806035101122, CurrSamplesPerSec=4.489233150273519, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:07:28,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=5, lr=[9.967549418464096e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:07:28,154] [INFO] [timer.py:258:stop] epoch=0/micro_step=1170/global_step=1170, RunningAvgSamplesPerSec=4.497781292428222, CurrSamplesPerSec=4.494235815627535, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:07:37,196] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=5, lr=[9.966696547099322e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:07:37,197] [INFO] [timer.py:258:stop] epoch=0/micro_step=1180/global_step=1180, RunningAvgSamplesPerSec=4.497795489211648, CurrSamplesPerSec=4.495270207087361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:07:46,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=5, lr=[9.96583265460484e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:07:46,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=1190/global_step=1190, RunningAvgSamplesPerSec=4.49775985475748, CurrSamplesPerSec=4.484148124390276, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:07:55,330] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=5, lr=[9.964957743112216e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:07:55,331] [INFO] [timer.py:258:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=4.4977609379279535, CurrSamplesPerSec=4.504543147957718, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:07:55,332] [INFO] [RANK 0]  iteration     1200/   20000 | elapsed time per iteration (ms): 906.0 | learning rate 9.965E-05 | total loss 7.302930E-01 | loss 7.302930E-01 | loss scale 32768.0 |speed 264.89 samples/(min*GPU)
[2024-06-17 06:07:55,333] [INFO] [RANK 0] time (ms) | forward: 356.02 | backward: 545.97 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 15.71 | data loader: 0.10
[2024-06-17 06:07:55,333] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:07:55,344] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/1200/mp_rank_00_model_states.pt
[2024-06-17 06:07:55,344] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/1200/mp_rank_00_model_states.pt...
[2024-06-17 06:08:22,822] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/1200/mp_rank_00_model_states.pt.
[2024-06-17 06:08:31,868] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=5, lr=[9.964071814780209e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:08:31,868] [INFO] [timer.py:258:stop] epoch=0/micro_step=1210/global_step=1210, RunningAvgSamplesPerSec=4.497844491754664, CurrSamplesPerSec=4.51819535200374, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:08:40,879] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=5, lr=[9.963174871794761e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:08:40,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=1220/global_step=1220, RunningAvgSamplesPerSec=4.498079933818965, CurrSamplesPerSec=4.5315437517792905, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:08:49,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=5, lr=[9.962266916368986e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:08:49,877] [INFO] [timer.py:258:stop] epoch=0/micro_step=1230/global_step=1230, RunningAvgSamplesPerSec=4.49831113715268, CurrSamplesPerSec=4.536533264688179, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:08:58,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=5, lr=[9.961347950743179e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:08:58,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=1240/global_step=1240, RunningAvgSamplesPerSec=4.498572763217066, CurrSamplesPerSec=4.530606381059679, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:09:07,897] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=5, lr=[9.960417977184791e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:09:07,898] [INFO] [timer.py:258:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=4.498685364469077, CurrSamplesPerSec=4.503172069043634, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:09:07,899] [INFO] [RANK 0]  iteration     1250/   20000 | elapsed time per iteration (ms): 1451.3 | learning rate 9.960E-05 | total loss 7.770508E-01 | loss 7.770508E-01 | loss scale 32768.0 |speed 165.37 samples/(min*GPU)
[2024-06-17 06:09:07,900] [INFO] [RANK 0] time (ms) | forward: 355.32 | backward: 541.76 | allreduce: 0.00 | optimizer: 3.43 | batch generator: 15.97 | data loader: 0.10
[2024-06-17 06:09:16,958] [INFO] [logging.py:96:log_dist] [Rank 0] step=1260, skipped=5, lr=[9.959476997988441e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:09:16,959] [INFO] [timer.py:258:stop] epoch=0/micro_step=1260/global_step=1260, RunningAvgSamplesPerSec=4.498663423368973, CurrSamplesPerSec=4.4904899835820995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:09:26,018] [INFO] [logging.py:96:log_dist] [Rank 0] step=1270, skipped=5, lr=[9.958525015475904e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:09:26,019] [INFO] [timer.py:258:stop] epoch=0/micro_step=1270/global_step=1270, RunningAvgSamplesPerSec=4.498617467446415, CurrSamplesPerSec=4.479552974297304, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:09:35,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=1280, skipped=5, lr=[9.957562031996099e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:09:35,105] [INFO] [timer.py:258:stop] epoch=0/micro_step=1280/global_step=1280, RunningAvgSamplesPerSec=4.498562215611907, CurrSamplesPerSec=4.45839360117011, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:09:44,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=1290, skipped=5, lr=[9.956588049925093e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:09:44,157] [INFO] [timer.py:258:stop] epoch=0/micro_step=1290/global_step=1290, RunningAvgSamplesPerSec=4.4985655159991005, CurrSamplesPerSec=4.504581850127723, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:09:53,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=5, lr=[9.955603071666088e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:09:53,187] [INFO] [timer.py:258:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=4.498583730972614, CurrSamplesPerSec=4.505468553834916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:09:53,189] [INFO] [RANK 0]  iteration     1300/   20000 | elapsed time per iteration (ms): 905.8 | learning rate 9.956E-05 | total loss 7.232178E-01 | loss 7.232178E-01 | loss scale 32768.0 |speed 264.96 samples/(min*GPU)
[2024-06-17 06:09:53,189] [INFO] [RANK 0] time (ms) | forward: 356.40 | backward: 545.25 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 15.53 | data loader: 0.10
[2024-06-17 06:10:02,227] [INFO] [logging.py:96:log_dist] [Rank 0] step=1310, skipped=5, lr=[9.954607099649425e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:10:02,228] [INFO] [timer.py:258:stop] epoch=0/micro_step=1310/global_step=1310, RunningAvgSamplesPerSec=4.498594713237224, CurrSamplesPerSec=4.494279156585453, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:10:11,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=1320, skipped=5, lr=[9.953600136332563e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:10:11,283] [INFO] [timer.py:258:stop] epoch=0/micro_step=1320/global_step=1320, RunningAvgSamplesPerSec=4.498576551727279, CurrSamplesPerSec=4.497913136729222, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:10:20,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=1330, skipped=5, lr=[9.952582184200083e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:10:20,334] [INFO] [timer.py:258:stop] epoch=0/micro_step=1330/global_step=1330, RunningAvgSamplesPerSec=4.498584815772403, CurrSamplesPerSec=4.496688301524303, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:10:29,377] [INFO] [logging.py:96:log_dist] [Rank 0] step=1340, skipped=5, lr=[9.951553245763683e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:10:29,378] [INFO] [timer.py:258:stop] epoch=0/micro_step=1340/global_step=1340, RunningAvgSamplesPerSec=4.4985963451509, CurrSamplesPerSec=4.498009608785175, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:10:38,420] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=5, lr=[9.950513323562164e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:10:38,420] [INFO] [timer.py:258:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=4.498593144492674, CurrSamplesPerSec=4.489230747824449, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:10:38,421] [INFO] [RANK 0]  iteration     1350/   20000 | elapsed time per iteration (ms): 904.7 | learning rate 9.950E-05 | total loss 7.022485E-01 | loss 7.022485E-01 | loss scale 32768.0 |speed 265.29 samples/(min*GPU)
[2024-06-17 06:10:38,422] [INFO] [RANK 0] time (ms) | forward: 355.35 | backward: 545.22 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 14.93 | data loader: 0.10
[2024-06-17 06:10:47,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=1360, skipped=5, lr=[9.94946242016143e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:10:47,475] [INFO] [timer.py:258:stop] epoch=0/micro_step=1360/global_step=1360, RunningAvgSamplesPerSec=4.498591122602152, CurrSamplesPerSec=4.502067591595247, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:10:56,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=1370, skipped=5, lr=[9.948400538154484e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:10:56,524] [INFO] [timer.py:258:stop] epoch=0/micro_step=1370/global_step=1370, RunningAvgSamplesPerSec=4.498563729774346, CurrSamplesPerSec=4.504210578597154, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:11:05,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=1380, skipped=5, lr=[9.947327680161412e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:11:05,580] [INFO] [timer.py:258:stop] epoch=0/micro_step=1380/global_step=1380, RunningAvgSamplesPerSec=4.498594104919888, CurrSamplesPerSec=4.494771616727933, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:11:14,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=1390, skipped=5, lr=[9.946243848829386e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:11:14,612] [INFO] [timer.py:258:stop] epoch=0/micro_step=1390/global_step=1390, RunningAvgSamplesPerSec=4.498595134540101, CurrSamplesPerSec=4.4995114886655445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:11:23,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=5, lr=[9.94514904683265e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:11:23,669] [INFO] [timer.py:258:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=4.4986058045573145, CurrSamplesPerSec=4.495200349601353, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:11:23,670] [INFO] [RANK 0]  iteration     1400/   20000 | elapsed time per iteration (ms): 905.0 | learning rate 9.945E-05 | total loss 6.977539E-01 | loss 6.977539E-01 | loss scale 32768.0 |speed 265.20 samples/(min*GPU)
[2024-06-17 06:11:23,671] [INFO] [RANK 0] time (ms) | forward: 355.88 | backward: 545.08 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 15.33 | data loader: 0.10
[2024-06-17 06:11:32,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=1410, skipped=5, lr=[9.94404327687252e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:11:32,715] [INFO] [timer.py:258:stop] epoch=0/micro_step=1410/global_step=1410, RunningAvgSamplesPerSec=4.498590392221613, CurrSamplesPerSec=4.494082925035205, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:11:41,755] [INFO] [logging.py:96:log_dist] [Rank 0] step=1420, skipped=5, lr=[9.942926541677374e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:11:41,756] [INFO] [timer.py:258:stop] epoch=0/micro_step=1420/global_step=1420, RunningAvgSamplesPerSec=4.49859160062526, CurrSamplesPerSec=4.499760089194788, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:11:50,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=1430, skipped=5, lr=[9.941798844002644e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:11:50,812] [INFO] [timer.py:258:stop] epoch=0/micro_step=1430/global_step=1430, RunningAvgSamplesPerSec=4.498599155279787, CurrSamplesPerSec=4.504391973978659, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:11:59,859] [INFO] [logging.py:96:log_dist] [Rank 0] step=1440, skipped=5, lr=[9.940660186630817e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:11:59,859] [INFO] [timer.py:258:stop] epoch=0/micro_step=1440/global_step=1440, RunningAvgSamplesPerSec=4.498600287619655, CurrSamplesPerSec=4.501747466944365, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:12:08,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=5, lr=[9.939510572371408e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:12:08,924] [INFO] [timer.py:258:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=4.498584969306823, CurrSamplesPerSec=4.496676249374837, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:12:08,926] [INFO] [RANK 0]  iteration     1450/   20000 | elapsed time per iteration (ms): 905.1 | learning rate 9.939E-05 | total loss 7.017334E-01 | loss 7.017334E-01 | loss scale 32768.0 |speed 265.16 samples/(min*GPU)
[2024-06-17 06:12:08,927] [INFO] [RANK 0] time (ms) | forward: 355.89 | backward: 545.17 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.27 | data loader: 0.10
[2024-06-17 06:12:17,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=1460, skipped=5, lr=[9.93835000406098e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:12:17,967] [INFO] [timer.py:258:stop] epoch=0/micro_step=1460/global_step=1460, RunningAvgSamplesPerSec=4.498581025056179, CurrSamplesPerSec=4.497152358408001, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:12:27,018] [INFO] [logging.py:96:log_dist] [Rank 0] step=1470, skipped=5, lr=[9.937178484563123e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:12:27,018] [INFO] [timer.py:258:stop] epoch=0/micro_step=1470/global_step=1470, RunningAvgSamplesPerSec=4.498574364656437, CurrSamplesPerSec=4.509667288304799, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:12:36,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=1480, skipped=5, lr=[9.935996016768441e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:12:36,083] [INFO] [timer.py:258:stop] epoch=0/micro_step=1480/global_step=1480, RunningAvgSamplesPerSec=4.4985479611337995, CurrSamplesPerSec=4.487837760480893, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:12:45,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=1490, skipped=5, lr=[9.934802603594556e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:12:45,141] [INFO] [timer.py:258:stop] epoch=0/micro_step=1490/global_step=1490, RunningAvgSamplesPerSec=4.498511698212357, CurrSamplesPerSec=4.503412612453009, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:12:54,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=5, lr=[9.933598247986099e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:12:54,182] [INFO] [timer.py:258:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=4.498507026381664, CurrSamplesPerSec=4.4927386581031605, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:12:54,183] [INFO] [RANK 0]  iteration     1500/   20000 | elapsed time per iteration (ms): 905.2 | learning rate 9.933E-05 | total loss 6.795410E-01 | loss 6.795410E-01 | loss scale 32768.0 |speed 265.15 samples/(min*GPU)
[2024-06-17 06:12:54,184] [INFO] [RANK 0] time (ms) | forward: 355.35 | backward: 545.78 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 14.99 | data loader: 0.10
[2024-06-17 06:12:54,184] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:12:54,195] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/1500/mp_rank_00_model_states.pt
[2024-06-17 06:12:54,195] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/1500/mp_rank_00_model_states.pt...
[2024-06-17 06:13:21,850] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/1500/mp_rank_00_model_states.pt.
[2024-06-17 06:13:30,910] [INFO] [logging.py:96:log_dist] [Rank 0] step=1510, skipped=5, lr=[9.932382952914694e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:13:30,911] [INFO] [timer.py:258:stop] epoch=0/micro_step=1510/global_step=1510, RunningAvgSamplesPerSec=4.498555610325409, CurrSamplesPerSec=4.516024453027571, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:13:39,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=1520, skipped=5, lr=[9.931156721378963e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:13:39,903] [INFO] [timer.py:258:stop] epoch=0/micro_step=1520/global_step=1520, RunningAvgSamplesPerSec=4.498749168306482, CurrSamplesPerSec=4.529836950109255, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:13:48,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=1530, skipped=5, lr=[9.929919556404513e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:13:48,889] [INFO] [timer.py:258:stop] epoch=0/micro_step=1530/global_step=1530, RunningAvgSamplesPerSec=4.498980038905213, CurrSamplesPerSec=4.523179886357141, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:13:57,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=1540, skipped=5, lr=[9.928671461043922e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:13:57,866] [INFO] [timer.py:258:stop] epoch=0/micro_step=1540/global_step=1540, RunningAvgSamplesPerSec=4.4991796477141826, CurrSamplesPerSec=4.536604412755652, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:13:58,762] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 06:13:59,656] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 06:14:06,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=7, lr=[9.92766511694598e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:14:06,852] [INFO] [timer.py:258:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=4.499348978602911, CurrSamplesPerSec=4.509467286557004, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:14:06,854] [INFO] [RANK 0]  iteration     1550/   20000 | elapsed time per iteration (ms): 1453.4 | learning rate 9.928E-05 | total loss 7.774463E-01 | loss 7.774463E-01 | loss scale 32768.0 |speed 165.13 samples/(min*GPU)
[2024-06-17 06:14:06,855] [INFO] [RANK 0] time (ms) | forward: 354.37 | backward: 541.45 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.24 | data loader: 0.10
[2024-06-17 06:14:15,882] [INFO] [logging.py:96:log_dist] [Rank 0] step=1560, skipped=7, lr=[9.926397354668924e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:14:15,883] [INFO] [timer.py:258:stop] epoch=0/micro_step=1560/global_step=1560, RunningAvgSamplesPerSec=4.499389371939427, CurrSamplesPerSec=4.496916099299163, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:14:24,919] [INFO] [logging.py:96:log_dist] [Rank 0] step=1570, skipped=7, lr=[9.92511867069641e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:14:24,920] [INFO] [timer.py:258:stop] epoch=0/micro_step=1570/global_step=1570, RunningAvgSamplesPerSec=4.499385489516152, CurrSamplesPerSec=4.492991323713487, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:14:33,968] [INFO] [logging.py:96:log_dist] [Rank 0] step=1580, skipped=7, lr=[9.923829068183467e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:14:33,969] [INFO] [timer.py:258:stop] epoch=0/micro_step=1580/global_step=1580, RunningAvgSamplesPerSec=4.499411978299729, CurrSamplesPerSec=4.474655723722305, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:14:43,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=1590, skipped=7, lr=[9.922528550312052e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:14:43,042] [INFO] [timer.py:258:stop] epoch=0/micro_step=1590/global_step=1590, RunningAvgSamplesPerSec=4.499415962048768, CurrSamplesPerSec=4.489348470852925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:14:52,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=7, lr=[9.921217120291075e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:14:52,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=4.499401846367766, CurrSamplesPerSec=4.501370623816953, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:14:52,123] [INFO] [RANK 0]  iteration     1600/   20000 | elapsed time per iteration (ms): 905.4 | learning rate 9.921E-05 | total loss 6.724585E-01 | loss 6.724585E-01 | loss scale 32768.0 |speed 265.08 samples/(min*GPU)
[2024-06-17 06:14:52,124] [INFO] [RANK 0] time (ms) | forward: 356.52 | backward: 544.81 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 16.18 | data loader: 0.12
[2024-06-17 06:15:01,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=1610, skipped=7, lr=[9.919894781356352e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:15:01,189] [INFO] [timer.py:258:stop] epoch=0/micro_step=1610/global_step=1610, RunningAvgSamplesPerSec=4.499396403295727, CurrSamplesPerSec=4.498253219144182, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:15:10,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=1620, skipped=7, lr=[9.918561536770626e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:15:10,257] [INFO] [timer.py:258:stop] epoch=0/micro_step=1620/global_step=1620, RunningAvgSamplesPerSec=4.499377688587851, CurrSamplesPerSec=4.502921882812813, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:15:19,328] [INFO] [logging.py:96:log_dist] [Rank 0] step=1630, skipped=7, lr=[9.917217389823542e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:15:19,328] [INFO] [timer.py:258:stop] epoch=0/micro_step=1630/global_step=1630, RunningAvgSamplesPerSec=4.499343668003251, CurrSamplesPerSec=4.493092397915159, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:15:28,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=1640, skipped=7, lr=[9.915862343831654e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:15:28,367] [INFO] [timer.py:258:stop] epoch=0/micro_step=1640/global_step=1640, RunningAvgSamplesPerSec=4.499353790968244, CurrSamplesPerSec=4.499868709699309, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:15:37,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=7, lr=[9.9144964021384e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:15:37,418] [INFO] [timer.py:258:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=4.499370519983084, CurrSamplesPerSec=4.4879686164571, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:15:37,419] [INFO] [RANK 0]  iteration     1650/   20000 | elapsed time per iteration (ms): 905.9 | learning rate 9.914E-05 | total loss 6.835547E-01 | loss 6.835547E-01 | loss scale 32768.0 |speed 264.93 samples/(min*GPU)
[2024-06-17 06:15:37,419] [INFO] [RANK 0] time (ms) | forward: 356.35 | backward: 545.43 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 16.15 | data loader: 0.09
[2024-06-17 06:15:46,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=1660, skipped=7, lr=[9.913119568114105e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:15:46,474] [INFO] [timer.py:258:stop] epoch=0/micro_step=1660/global_step=1660, RunningAvgSamplesPerSec=4.499356726605114, CurrSamplesPerSec=4.500746314301871, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:15:55,527] [INFO] [logging.py:96:log_dist] [Rank 0] step=1670, skipped=7, lr=[9.911731845155971e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:15:55,528] [INFO] [timer.py:258:stop] epoch=0/micro_step=1670/global_step=1670, RunningAvgSamplesPerSec=4.499324779232105, CurrSamplesPerSec=4.461237696321714, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:16:04,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=1680, skipped=7, lr=[9.910333236688066e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:16:04,577] [INFO] [timer.py:258:stop] epoch=0/micro_step=1680/global_step=1680, RunningAvgSamplesPerSec=4.499294022048144, CurrSamplesPerSec=4.4743036876193765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:16:13,639] [INFO] [logging.py:96:log_dist] [Rank 0] step=1690, skipped=7, lr=[9.908923746161316e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:16:13,639] [INFO] [timer.py:258:stop] epoch=0/micro_step=1690/global_step=1690, RunningAvgSamplesPerSec=4.49928712848142, CurrSamplesPerSec=4.505929584107275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:16:22,695] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=7, lr=[9.907503377053504e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:16:22,695] [INFO] [timer.py:258:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=4.4993002081974875, CurrSamplesPerSec=4.494035976468559, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:16:22,696] [INFO] [RANK 0]  iteration     1700/   20000 | elapsed time per iteration (ms): 905.6 | learning rate 9.907E-05 | total loss 7.059717E-01 | loss 7.059717E-01 | loss scale 32768.0 |speed 265.03 samples/(min*GPU)
[2024-06-17 06:16:22,697] [INFO] [RANK 0] time (ms) | forward: 356.29 | backward: 545.17 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 15.51 | data loader: 0.11
[2024-06-17 06:16:31,752] [INFO] [logging.py:96:log_dist] [Rank 0] step=1710, skipped=7, lr=[9.906072132869243e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:16:31,753] [INFO] [timer.py:258:stop] epoch=0/micro_step=1710/global_step=1710, RunningAvgSamplesPerSec=4.4992846161174915, CurrSamplesPerSec=4.502729729657194, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:16:40,819] [INFO] [logging.py:96:log_dist] [Rank 0] step=1720, skipped=7, lr=[9.904630017139993e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:16:40,819] [INFO] [timer.py:258:stop] epoch=0/micro_step=1720/global_step=1720, RunningAvgSamplesPerSec=4.499238540756908, CurrSamplesPerSec=4.492459555799287, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:16:49,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=1730, skipped=7, lr=[9.903177033424025e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:16:49,861] [INFO] [timer.py:258:stop] epoch=0/micro_step=1730/global_step=1730, RunningAvgSamplesPerSec=4.499238666452668, CurrSamplesPerSec=4.506062707513374, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:16:58,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=1740, skipped=7, lr=[9.901713185306433e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:16:58,917] [INFO] [timer.py:258:stop] epoch=0/micro_step=1740/global_step=1740, RunningAvgSamplesPerSec=4.4992313207128785, CurrSamplesPerSec=4.502792570393977, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:17:07,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=7, lr=[9.900238476399119e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:17:07,967] [INFO] [timer.py:258:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=4.499197631831187, CurrSamplesPerSec=4.496302664782801, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:17:07,968] [INFO] [RANK 0]  iteration     1750/   20000 | elapsed time per iteration (ms): 905.4 | learning rate 9.900E-05 | total loss 7.572754E-01 | loss 7.572754E-01 | loss scale 32768.0 |speed 265.07 samples/(min*GPU)
[2024-06-17 06:17:07,969] [INFO] [RANK 0] time (ms) | forward: 355.99 | backward: 545.34 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 15.14 | data loader: 0.10
[2024-06-17 06:17:17,022] [INFO] [logging.py:96:log_dist] [Rank 0] step=1760, skipped=7, lr=[9.898752910340778e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:17:17,023] [INFO] [timer.py:258:stop] epoch=0/micro_step=1760/global_step=1760, RunningAvgSamplesPerSec=4.499198994235579, CurrSamplesPerSec=4.496793157950741, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:17:26,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=1770, skipped=7, lr=[9.897256490796898e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:17:26,057] [INFO] [timer.py:258:stop] epoch=0/micro_step=1770/global_step=1770, RunningAvgSamplesPerSec=4.499197706987648, CurrSamplesPerSec=4.495667713418205, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:17:35,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=1780, skipped=7, lr=[9.895749221459746e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:17:35,123] [INFO] [timer.py:258:stop] epoch=0/micro_step=1780/global_step=1780, RunningAvgSamplesPerSec=4.499158391840259, CurrSamplesPerSec=4.504024361204304, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:17:44,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=1790, skipped=7, lr=[9.894231106048358e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:17:44,176] [INFO] [timer.py:258:stop] epoch=0/micro_step=1790/global_step=1790, RunningAvgSamplesPerSec=4.499153881000259, CurrSamplesPerSec=4.501452750916472, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:17:53,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=7, lr=[9.892702148308534e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:17:53,223] [INFO] [timer.py:258:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=4.499143847328592, CurrSamplesPerSec=4.494689733234209, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:17:53,224] [INFO] [RANK 0]  iteration     1800/   20000 | elapsed time per iteration (ms): 905.1 | learning rate 9.893E-05 | total loss 6.371191E-01 | loss 6.371191E-01 | loss scale 32768.0 |speed 265.16 samples/(min*GPU)
[2024-06-17 06:17:53,225] [INFO] [RANK 0] time (ms) | forward: 355.77 | backward: 545.35 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 15.19 | data loader: 0.10
[2024-06-17 06:17:53,226] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:17:53,237] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/1800/mp_rank_00_model_states.pt
[2024-06-17 06:17:53,237] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/1800/mp_rank_00_model_states.pt...
[2024-06-17 06:18:21,330] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/1800/mp_rank_00_model_states.pt.
[2024-06-17 06:18:30,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=1810, skipped=7, lr=[9.891162352012824e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:18:30,397] [INFO] [timer.py:258:stop] epoch=0/micro_step=1810/global_step=1810, RunningAvgSamplesPerSec=4.49915739475038, CurrSamplesPerSec=4.505501222165588, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:18:39,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=1820, skipped=7, lr=[9.889611720960523e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:18:39,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=1820/global_step=1820, RunningAvgSamplesPerSec=4.499304503157541, CurrSamplesPerSec=4.540421463248824, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:18:48,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=1830, skipped=7, lr=[9.888050258977659e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:18:48,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=1830/global_step=1830, RunningAvgSamplesPerSec=4.499512802340275, CurrSamplesPerSec=4.533745527655573, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:18:57,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=1840, skipped=7, lr=[9.886477969916986e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:18:57,367] [INFO] [timer.py:258:stop] epoch=0/micro_step=1840/global_step=1840, RunningAvgSamplesPerSec=4.499671716605562, CurrSamplesPerSec=4.530348243928717, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:19:06,373] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=7, lr=[9.884894857657968e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:19:06,373] [INFO] [timer.py:258:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=4.499785786822672, CurrSamplesPerSec=4.514014736210531, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:19:06,375] [INFO] [RANK 0]  iteration     1850/   20000 | elapsed time per iteration (ms): 1463.0 | learning rate 9.885E-05 | total loss 7.087402E-01 | loss 7.087402E-01 | loss scale 32768.0 |speed 164.04 samples/(min*GPU)
[2024-06-17 06:19:06,376] [INFO] [RANK 0] time (ms) | forward: 354.75 | backward: 541.86 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.71 | data loader: 0.10
[2024-06-17 06:19:15,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=1860, skipped=7, lr=[9.883300926106776e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:19:15,406] [INFO] [timer.py:258:stop] epoch=0/micro_step=1860/global_step=1860, RunningAvgSamplesPerSec=4.499830516542016, CurrSamplesPerSec=4.516887697946144, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:19:24,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=1870, skipped=7, lr=[9.881696179196283e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:19:24,428] [INFO] [timer.py:258:stop] epoch=0/micro_step=1870/global_step=1870, RunningAvgSamplesPerSec=4.499881602756057, CurrSamplesPerSec=4.5180152765494945, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:19:33,454] [INFO] [logging.py:96:log_dist] [Rank 0] step=1880, skipped=7, lr=[9.88008062088604e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:19:33,455] [INFO] [timer.py:258:stop] epoch=0/micro_step=1880/global_step=1880, RunningAvgSamplesPerSec=4.499902418981724, CurrSamplesPerSec=4.506356817103145, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:19:42,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=1890, skipped=7, lr=[9.878454255162272e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:19:42,479] [INFO] [timer.py:258:stop] epoch=0/micro_step=1890/global_step=1890, RunningAvgSamplesPerSec=4.499974495717993, CurrSamplesPerSec=4.517633272100897, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:19:51,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=7, lr=[9.876817086037882e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:19:51,522] [INFO] [timer.py:258:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=4.50000168761602, CurrSamplesPerSec=4.511095695195074, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:19:51,524] [INFO] [RANK 0]  iteration     1900/   20000 | elapsed time per iteration (ms): 903.0 | learning rate 9.877E-05 | total loss 6.310303E-01 | loss 6.310303E-01 | loss scale 32768.0 |speed 265.79 samples/(min*GPU)
[2024-06-17 06:19:51,524] [INFO] [RANK 0] time (ms) | forward: 355.05 | backward: 543.92 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 15.10 | data loader: 0.10
[2024-06-17 06:20:00,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=1910, skipped=7, lr=[9.875169117552418e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:20:00,582] [INFO] [timer.py:258:stop] epoch=0/micro_step=1910/global_step=1910, RunningAvgSamplesPerSec=4.500032657396949, CurrSamplesPerSec=4.5114207901835846, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:20:09,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=1920, skipped=7, lr=[9.873510353772079e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:20:09,612] [INFO] [timer.py:258:stop] epoch=0/micro_step=1920/global_step=1920, RunningAvgSamplesPerSec=4.500056237452075, CurrSamplesPerSec=4.499065042122044, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:20:18,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=1930, skipped=7, lr=[9.871840798789699e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:20:18,640] [INFO] [timer.py:258:stop] epoch=0/micro_step=1930/global_step=1930, RunningAvgSamplesPerSec=4.500102977132309, CurrSamplesPerSec=4.509983690934746, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:20:27,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=1940, skipped=7, lr=[9.87016045672474e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:20:27,682] [INFO] [timer.py:258:stop] epoch=0/micro_step=1940/global_step=1940, RunningAvgSamplesPerSec=4.500143849059492, CurrSamplesPerSec=4.511661002400344, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:20:30,390] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 06:20:31,294] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 06:20:36,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=9, lr=[9.868808419158587e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:20:36,712] [INFO] [timer.py:258:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=4.50019119269069, CurrSamplesPerSec=4.492317611896817, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:20:36,713] [INFO] [RANK 0]  iteration     1950/   20000 | elapsed time per iteration (ms): 903.8 | learning rate 9.869E-05 | total loss 6.497168E-01 | loss 6.497168E-01 | loss scale 32768.0 |speed 265.55 samples/(min*GPU)
[2024-06-17 06:20:36,714] [INFO] [RANK 0] time (ms) | forward: 355.78 | backward: 544.05 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 15.84 | data loader: 0.10
[2024-06-17 06:20:45,755] [INFO] [logging.py:96:log_dist] [Rank 0] step=1960, skipped=9, lr=[9.867108670810979e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:20:45,755] [INFO] [timer.py:258:stop] epoch=0/micro_step=1960/global_step=1960, RunningAvgSamplesPerSec=4.500205875946676, CurrSamplesPerSec=4.498545103923447, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:20:54,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=1970, skipped=9, lr=[9.865398147056848e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:20:54,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=1970/global_step=1970, RunningAvgSamplesPerSec=4.50023340497276, CurrSamplesPerSec=4.5085996056604944, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:21:03,814] [INFO] [logging.py:96:log_dist] [Rank 0] step=1980, skipped=9, lr=[9.863676852116741e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:21:03,815] [INFO] [timer.py:258:stop] epoch=0/micro_step=1980/global_step=1980, RunningAvgSamplesPerSec=4.5002883921559, CurrSamplesPerSec=4.516423206853396, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:21:12,854] [INFO] [logging.py:96:log_dist] [Rank 0] step=1990, skipped=9, lr=[9.86194479023778e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:21:12,854] [INFO] [timer.py:258:stop] epoch=0/micro_step=1990/global_step=1990, RunningAvgSamplesPerSec=4.500313555417925, CurrSamplesPerSec=4.509735171718247, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:21:21,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=9, lr=[9.860201965693658e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:21:21,904] [INFO] [timer.py:258:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=4.500343797865033, CurrSamplesPerSec=4.501417725757533, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:21:21,905] [INFO] [RANK 0]  iteration     2000/   20000 | elapsed time per iteration (ms): 903.8 | learning rate 9.860E-05 | total loss 6.289917E-01 | loss 6.289917E-01 | loss scale 32768.0 |speed 265.53 samples/(min*GPU)
[2024-06-17 06:21:21,906] [INFO] [RANK 0] time (ms) | forward: 355.73 | backward: 544.02 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 15.66 | data loader: 0.10
[2024-06-17 06:21:28,538] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 06:21:28,539] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 06:21:28,539] [INFO] [RANK 0]  validation loss at iteration 2000 | loss: 9.630859E-01 | PPL: 2.619768E+00 loss 9.633789E-01 |
[2024-06-17 06:21:28,539] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 06:21:37,578] [INFO] [logging.py:96:log_dist] [Rank 0] step=2010, skipped=9, lr=[9.858448382784621e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:21:37,578] [INFO] [timer.py:258:stop] epoch=0/micro_step=2010/global_step=2010, RunningAvgSamplesPerSec=4.5003765302303105, CurrSamplesPerSec=4.497092085868505, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:21:46,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=2020, skipped=9, lr=[9.85668404583746e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:21:46,627] [INFO] [timer.py:258:stop] epoch=0/micro_step=2020/global_step=2020, RunningAvgSamplesPerSec=4.50041266499304, CurrSamplesPerSec=4.512353878888012, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:21:55,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=2030, skipped=9, lr=[9.854908959205501e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:21:55,662] [INFO] [timer.py:258:stop] epoch=0/micro_step=2030/global_step=2030, RunningAvgSamplesPerSec=4.500433500620581, CurrSamplesPerSec=4.50856810397763, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:22:04,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=2040, skipped=9, lr=[9.853123127268593e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:22:04,709] [INFO] [timer.py:258:stop] epoch=0/micro_step=2040/global_step=2040, RunningAvgSamplesPerSec=4.500426060607828, CurrSamplesPerSec=4.490654649629326, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:22:13,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=9, lr=[9.851326554433101e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:22:13,755] [INFO] [timer.py:258:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=4.500444219493403, CurrSamplesPerSec=4.504330297909676, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:22:13,756] [INFO] [RANK 0]  iteration     2050/   20000 | elapsed time per iteration (ms): 1037.0 | learning rate 9.851E-05 | total loss 6.707959E-01 | loss 6.707959E-01 | loss scale 32768.0 |speed 231.43 samples/(min*GPU)
[2024-06-17 06:22:13,757] [INFO] [RANK 0] time (ms) | forward: 356.06 | backward: 544.26 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 19.06 | data loader: 0.15
[2024-06-17 06:22:22,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=2060, skipped=9, lr=[9.84951924513189e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:22:22,789] [INFO] [timer.py:258:stop] epoch=0/micro_step=2060/global_step=2060, RunningAvgSamplesPerSec=4.50047195269371, CurrSamplesPerSec=4.5068168185350626, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:22:31,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=2070, skipped=9, lr=[9.847701203824312e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:22:31,817] [INFO] [timer.py:258:stop] epoch=0/micro_step=2070/global_step=2070, RunningAvgSamplesPerSec=4.500489425437146, CurrSamplesPerSec=4.495774931708083, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:22:40,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=2080, skipped=9, lr=[9.845872434996208e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:22:40,845] [INFO] [timer.py:258:stop] epoch=0/micro_step=2080/global_step=2080, RunningAvgSamplesPerSec=4.500530997018125, CurrSamplesPerSec=4.510896779577895, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:22:49,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=2090, skipped=9, lr=[9.844032943159878e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:22:49,918] [INFO] [timer.py:258:stop] epoch=0/micro_step=2090/global_step=2090, RunningAvgSamplesPerSec=4.500531346485576, CurrSamplesPerSec=4.480562668316043, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:22:58,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=9, lr=[9.842182732854089e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:22:58,953] [INFO] [timer.py:258:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=4.500576124736307, CurrSamplesPerSec=4.5113031197960485, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:22:58,954] [INFO] [RANK 0]  iteration     2100/   20000 | elapsed time per iteration (ms): 904.0 | learning rate 9.842E-05 | total loss 6.173999E-01 | loss 6.173999E-01 | loss scale 32768.0 |speed 265.50 samples/(min*GPU)
[2024-06-17 06:22:58,955] [INFO] [RANK 0] time (ms) | forward: 355.76 | backward: 544.16 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.69 | data loader: 0.11
[2024-06-17 06:22:58,955] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:22:58,966] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/2100/mp_rank_00_model_states.pt
[2024-06-17 06:22:58,966] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/2100/mp_rank_00_model_states.pt...
[2024-06-17 06:23:27,313] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/2100/mp_rank_00_model_states.pt.
[2024-06-17 06:23:36,389] [INFO] [logging.py:96:log_dist] [Rank 0] step=2110, skipped=9, lr=[9.840321808644053e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:23:36,389] [INFO] [timer.py:258:stop] epoch=0/micro_step=2110/global_step=2110, RunningAvgSamplesPerSec=4.500590041189554, CurrSamplesPerSec=4.514539471506726, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:23:45,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=2120, skipped=9, lr=[9.83845017512141e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:23:45,416] [INFO] [timer.py:258:stop] epoch=0/micro_step=2120/global_step=2120, RunningAvgSamplesPerSec=4.500689032772496, CurrSamplesPerSec=4.5324729391048475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:23:54,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=2130, skipped=9, lr=[9.836567836904235e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:23:54,407] [INFO] [timer.py:258:stop] epoch=0/micro_step=2130/global_step=2130, RunningAvgSamplesPerSec=4.50083593732212, CurrSamplesPerSec=4.523221348402456, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:24:03,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=2140, skipped=9, lr=[9.834674798637004e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:24:03,405] [INFO] [timer.py:258:stop] epoch=0/micro_step=2140/global_step=2140, RunningAvgSamplesPerSec=4.500923428755633, CurrSamplesPerSec=4.515363260428708, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:24:12,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=9, lr=[9.832771064990609e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:24:12,443] [INFO] [timer.py:258:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=4.500962349908768, CurrSamplesPerSec=4.506893091005994, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:24:12,444] [INFO] [RANK 0]  iteration     2150/   20000 | elapsed time per iteration (ms): 1469.8 | learning rate 9.833E-05 | total loss 6.660547E-01 | loss 6.660547E-01 | loss scale 32768.0 |speed 163.29 samples/(min*GPU)
[2024-06-17 06:24:12,445] [INFO] [RANK 0] time (ms) | forward: 355.87 | backward: 542.46 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 16.32 | data loader: 0.11
[2024-06-17 06:24:21,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=2160, skipped=9, lr=[9.830856640662316e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:24:21,511] [INFO] [timer.py:258:stop] epoch=0/micro_step=2160/global_step=2160, RunningAvgSamplesPerSec=4.500926195847737, CurrSamplesPerSec=4.493973379905552, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:24:30,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=2170, skipped=9, lr=[9.82893153037578e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:24:30,571] [INFO] [timer.py:258:stop] epoch=0/micro_step=2170/global_step=2170, RunningAvgSamplesPerSec=4.5008982584382276, CurrSamplesPerSec=4.5008272111836485, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:24:39,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=2180, skipped=9, lr=[9.826995738881023e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:24:39,616] [INFO] [timer.py:258:stop] epoch=0/micro_step=2180/global_step=2180, RunningAvgSamplesPerSec=4.500877501143867, CurrSamplesPerSec=4.499431845762417, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:24:48,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=9, lr=[9.825049270954412e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:24:48,679] [INFO] [timer.py:258:stop] epoch=0/micro_step=2190/global_step=2190, RunningAvgSamplesPerSec=4.500851791066143, CurrSamplesPerSec=4.495219620415114, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:24:57,745] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=9, lr=[9.823092131398665e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:24:57,746] [INFO] [timer.py:258:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=4.500809436977674, CurrSamplesPerSec=4.4967666420706145, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:24:57,747] [INFO] [RANK 0]  iteration     2200/   20000 | elapsed time per iteration (ms): 906.1 | learning rate 9.823E-05 | total loss 5.580151E-01 | loss 5.580151E-01 | loss scale 32768.0 |speed 264.88 samples/(min*GPU)
[2024-06-17 06:24:57,748] [INFO] [RANK 0] time (ms) | forward: 356.51 | backward: 545.47 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 15.46 | data loader: 0.11
[2024-06-17 06:25:06,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=9, lr=[9.821124325042829e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:25:06,801] [INFO] [timer.py:258:stop] epoch=0/micro_step=2210/global_step=2210, RunningAvgSamplesPerSec=4.500791798753864, CurrSamplesPerSec=4.504493561774292, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:25:15,859] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=9, lr=[9.819145856742272e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:25:15,859] [INFO] [timer.py:258:stop] epoch=0/micro_step=2220/global_step=2220, RunningAvgSamplesPerSec=4.500755406250809, CurrSamplesPerSec=4.482064891727348, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:25:24,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=9, lr=[9.817156731378665e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:25:24,899] [INFO] [timer.py:258:stop] epoch=0/micro_step=2230/global_step=2230, RunningAvgSamplesPerSec=4.500741980041789, CurrSamplesPerSec=4.5018730953420425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:25:33,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=9, lr=[9.815156953859982e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:25:33,961] [INFO] [timer.py:258:stop] epoch=0/micro_step=2240/global_step=2240, RunningAvgSamplesPerSec=4.500721961535872, CurrSamplesPerSec=4.500399818773858, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:25:43,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=9, lr=[9.813146529120472e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:25:43,001] [INFO] [timer.py:258:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=4.500710915579833, CurrSamplesPerSec=4.499515108864497, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:25:43,002] [INFO] [RANK 0]  iteration     2250/   20000 | elapsed time per iteration (ms): 905.1 | learning rate 9.813E-05 | total loss 6.815918E-01 | loss 6.815918E-01 | loss scale 32768.0 |speed 265.17 samples/(min*GPU)
[2024-06-17 06:25:43,003] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 545.29 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 14.93 | data loader: 0.10
[2024-06-17 06:25:52,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=9, lr=[9.811125462120659e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:25:52,062] [INFO] [timer.py:258:stop] epoch=0/micro_step=2260/global_step=2260, RunningAvgSamplesPerSec=4.500678758441909, CurrSamplesPerSec=4.502618554188801, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:26:01,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=9, lr=[9.809093757847324e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:26:01,103] [INFO] [timer.py:258:stop] epoch=0/micro_step=2270/global_step=2270, RunningAvgSamplesPerSec=4.500650849117445, CurrSamplesPerSec=4.497463390390183, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:26:10,148] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=9, lr=[9.807051421313496e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:26:10,148] [INFO] [timer.py:258:stop] epoch=0/micro_step=2280/global_step=2280, RunningAvgSamplesPerSec=4.500625784264642, CurrSamplesPerSec=4.489622380975828, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:26:19,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=9, lr=[9.804998457558437e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:26:19,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=2290/global_step=2290, RunningAvgSamplesPerSec=4.500609012201279, CurrSamplesPerSec=4.503155147359204, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:26:28,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=9, lr=[9.802934871647631e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:26:28,237] [INFO] [timer.py:258:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=4.5006032736056945, CurrSamplesPerSec=4.505560510346113, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:26:28,238] [INFO] [RANK 0]  iteration     2300/   20000 | elapsed time per iteration (ms): 904.7 | learning rate 9.803E-05 | total loss 6.394238E-01 | loss 6.394238E-01 | loss scale 32768.0 |speed 265.27 samples/(min*GPU)
[2024-06-17 06:26:28,239] [INFO] [RANK 0] time (ms) | forward: 355.50 | backward: 545.25 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.44 | data loader: 0.10
[2024-06-17 06:26:37,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=2310, skipped=9, lr=[9.800860668672773e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:26:37,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=2310/global_step=2310, RunningAvgSamplesPerSec=4.500604146004456, CurrSamplesPerSec=4.502094170028144, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:26:46,352] [INFO] [logging.py:96:log_dist] [Rank 0] step=2320, skipped=9, lr=[9.798775853751749e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:26:46,352] [INFO] [timer.py:258:stop] epoch=0/micro_step=2320/global_step=2320, RunningAvgSamplesPerSec=4.5005817578730065, CurrSamplesPerSec=4.503824859654925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:26:55,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=2330, skipped=9, lr=[9.796680432028636e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:26:55,392] [INFO] [timer.py:258:stop] epoch=0/micro_step=2330/global_step=2330, RunningAvgSamplesPerSec=4.500559526516127, CurrSamplesPerSec=4.503754736035641, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:27:04,470] [INFO] [logging.py:96:log_dist] [Rank 0] step=2340, skipped=9, lr=[9.794574408673676e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:27:04,470] [INFO] [timer.py:258:stop] epoch=0/micro_step=2340/global_step=2340, RunningAvgSamplesPerSec=4.500539986350861, CurrSamplesPerSec=4.495487020007701, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:27:09,012] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 06:27:09,914] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 06:27:13,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=11, lr=[9.792881960305884e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:27:13,543] [INFO] [timer.py:258:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=4.500523294711225, CurrSamplesPerSec=4.482831353711067, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:27:13,544] [INFO] [RANK 0]  iteration     2350/   20000 | elapsed time per iteration (ms): 906.1 | learning rate 9.793E-05 | total loss 5.609473E-01 | loss 5.609473E-01 | loss scale 32768.0 |speed 264.87 samples/(min*GPU)
[2024-06-17 06:27:13,544] [INFO] [RANK 0] time (ms) | forward: 356.76 | backward: 545.28 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 16.03 | data loader: 0.10
[2024-06-17 06:27:22,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=2360, skipped=11, lr=[9.790756867126109e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:27:22,599] [INFO] [timer.py:258:stop] epoch=0/micro_step=2360/global_step=2360, RunningAvgSamplesPerSec=4.500522372721151, CurrSamplesPerSec=4.505424996797609, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:27:31,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=2370, skipped=11, lr=[9.788621186930296e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:27:31,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=2370/global_step=2370, RunningAvgSamplesPerSec=4.500502928879261, CurrSamplesPerSec=4.49955493143745, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:27:40,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=2380, skipped=11, lr=[9.786474924988025e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:27:40,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=2380/global_step=2380, RunningAvgSamplesPerSec=4.500490771439821, CurrSamplesPerSec=4.483249425471648, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:27:49,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=2390, skipped=11, lr=[9.78431808659498e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:27:49,750] [INFO] [timer.py:258:stop] epoch=0/micro_step=2390/global_step=2390, RunningAvgSamplesPerSec=4.500478690103345, CurrSamplesPerSec=4.499726297218423, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:27:58,798] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=11, lr=[9.782150677072948e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:27:58,799] [INFO] [timer.py:258:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=4.500464816163005, CurrSamplesPerSec=4.495201554022373, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:27:58,800] [INFO] [RANK 0]  iteration     2400/   20000 | elapsed time per iteration (ms): 905.1 | learning rate 9.782E-05 | total loss 6.770410E-01 | loss 6.770410E-01 | loss scale 32768.0 |speed 265.16 samples/(min*GPU)
[2024-06-17 06:27:58,801] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 545.34 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 15.23 | data loader: 0.14
[2024-06-17 06:27:58,801] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:27:58,813] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/2400/mp_rank_00_model_states.pt
[2024-06-17 06:27:58,813] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/2400/mp_rank_00_model_states.pt...
[2024-06-17 06:28:23,266] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/2400/mp_rank_00_model_states.pt.
[2024-06-17 06:28:32,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=2410, skipped=11, lr=[9.779972701769797e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:28:32,362] [INFO] [timer.py:258:stop] epoch=0/micro_step=2410/global_step=2410, RunningAvgSamplesPerSec=4.500450045326162, CurrSamplesPerSec=4.497184906251106, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:28:41,338] [INFO] [logging.py:96:log_dist] [Rank 0] step=2420, skipped=11, lr=[9.777784166059466e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:28:41,338] [INFO] [timer.py:258:stop] epoch=0/micro_step=2420/global_step=2420, RunningAvgSamplesPerSec=4.500572074255603, CurrSamplesPerSec=4.5278686905298136, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:28:50,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=2430, skipped=11, lr=[9.775585075341944e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:28:50,334] [INFO] [timer.py:258:stop] epoch=0/micro_step=2430/global_step=2430, RunningAvgSamplesPerSec=4.50069818314104, CurrSamplesPerSec=4.53764735601668, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:28:59,340] [INFO] [logging.py:96:log_dist] [Rank 0] step=2440, skipped=11, lr=[9.773375435043273e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:28:59,341] [INFO] [timer.py:258:stop] epoch=0/micro_step=2440/global_step=2440, RunningAvgSamplesPerSec=4.500767118923553, CurrSamplesPerSec=4.507452501352729, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:29:08,384] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=11, lr=[9.771155250615521e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:29:08,385] [INFO] [timer.py:258:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=4.500783764063131, CurrSamplesPerSec=4.505683931563471, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:29:08,386] [INFO] [RANK 0]  iteration     2450/   20000 | elapsed time per iteration (ms): 1391.7 | learning rate 9.771E-05 | total loss 6.283447E-01 | loss 6.283447E-01 | loss scale 32768.0 |speed 172.45 samples/(min*GPU)
[2024-06-17 06:29:08,387] [INFO] [RANK 0] time (ms) | forward: 355.87 | backward: 542.29 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 15.94 | data loader: 0.10
[2024-06-17 06:29:17,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=2460, skipped=11, lr=[9.768924527536769e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:29:17,454] [INFO] [timer.py:258:stop] epoch=0/micro_step=2460/global_step=2460, RunningAvgSamplesPerSec=4.5007825541105575, CurrSamplesPerSec=4.502467509360004, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:29:26,499] [INFO] [logging.py:96:log_dist] [Rank 0] step=2470, skipped=11, lr=[9.766683271311108e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:29:26,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=2470/global_step=2470, RunningAvgSamplesPerSec=4.500747375419849, CurrSamplesPerSec=4.485168284544802, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:29:35,548] [INFO] [logging.py:96:log_dist] [Rank 0] step=2480, skipped=11, lr=[9.764431487468614e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:29:35,548] [INFO] [timer.py:258:stop] epoch=0/micro_step=2480/global_step=2480, RunningAvgSamplesPerSec=4.50072675635095, CurrSamplesPerSec=4.498004785084093, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:29:44,605] [INFO] [logging.py:96:log_dist] [Rank 0] step=2490, skipped=11, lr=[9.762169181565338e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:29:44,606] [INFO] [timer.py:258:stop] epoch=0/micro_step=2490/global_step=2490, RunningAvgSamplesPerSec=4.500689129275281, CurrSamplesPerSec=4.482339111291598, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:29:53,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=11, lr=[9.759896359183296e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:29:53,672] [INFO] [timer.py:258:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=4.5006661221191155, CurrSamplesPerSec=4.491439683715909, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:29:53,674] [INFO] [RANK 0]  iteration     2500/   20000 | elapsed time per iteration (ms): 905.8 | learning rate 9.760E-05 | total loss 6.548291E-01 | loss 6.548291E-01 | loss scale 32768.0 |speed 264.97 samples/(min*GPU)
[2024-06-17 06:29:53,674] [INFO] [RANK 0] time (ms) | forward: 355.88 | backward: 545.77 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 15.30 | data loader: 0.10
[2024-06-17 06:30:02,748] [INFO] [logging.py:96:log_dist] [Rank 0] step=2510, skipped=11, lr=[9.757613025930452e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:30:02,748] [INFO] [timer.py:258:stop] epoch=0/micro_step=2510/global_step=2510, RunningAvgSamplesPerSec=4.500637209024408, CurrSamplesPerSec=4.488033447015163, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:30:11,806] [INFO] [logging.py:96:log_dist] [Rank 0] step=2520, skipped=11, lr=[9.755319187440706e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:30:11,807] [INFO] [timer.py:258:stop] epoch=0/micro_step=2520/global_step=2520, RunningAvgSamplesPerSec=4.500613928689866, CurrSamplesPerSec=4.497621333950987, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:30:20,895] [INFO] [logging.py:96:log_dist] [Rank 0] step=2530, skipped=11, lr=[9.75301484937387e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:30:20,896] [INFO] [timer.py:258:stop] epoch=0/micro_step=2530/global_step=2530, RunningAvgSamplesPerSec=4.500559453411979, CurrSamplesPerSec=4.472273699519964, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:30:29,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=2540, skipped=11, lr=[9.750700017415674e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:30:29,976] [INFO] [timer.py:258:stop] epoch=0/micro_step=2540/global_step=2540, RunningAvgSamplesPerSec=4.500507770921763, CurrSamplesPerSec=4.492624366329075, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:30:39,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=11, lr=[9.748374697277735e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:30:39,037] [INFO] [timer.py:258:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=4.500483018680198, CurrSamplesPerSec=4.492558200065016, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:30:39,038] [INFO] [RANK 0]  iteration     2550/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 9.748E-05 | total loss 5.953479E-01 | loss 5.953479E-01 | loss scale 32768.0 |speed 264.52 samples/(min*GPU)
[2024-06-17 06:30:39,039] [INFO] [RANK 0] time (ms) | forward: 357.18 | backward: 546.09 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 16.15 | data loader: 0.10
[2024-06-17 06:30:48,099] [INFO] [logging.py:96:log_dist] [Rank 0] step=2560, skipped=11, lr=[9.746038894697548e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:30:48,099] [INFO] [timer.py:258:stop] epoch=0/micro_step=2560/global_step=2560, RunningAvgSamplesPerSec=4.500452127190117, CurrSamplesPerSec=4.495556886404043, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:30:57,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=2570, skipped=11, lr=[9.743692615438476e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:30:57,144] [INFO] [timer.py:258:stop] epoch=0/micro_step=2570/global_step=2570, RunningAvgSamplesPerSec=4.500447989636995, CurrSamplesPerSec=4.500982976056592, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:31:06,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=2580, skipped=11, lr=[9.741335865289728e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:31:06,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=2580/global_step=2580, RunningAvgSamplesPerSec=4.500397136506043, CurrSamplesPerSec=4.494305643137921, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:31:15,272] [INFO] [logging.py:96:log_dist] [Rank 0] step=2590, skipped=11, lr=[9.73896865006635e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:31:15,273] [INFO] [timer.py:258:stop] epoch=0/micro_step=2590/global_step=2590, RunningAvgSamplesPerSec=4.500350577052166, CurrSamplesPerSec=4.486819985547796, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:31:24,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=11, lr=[9.736590975609213e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:31:24,350] [INFO] [timer.py:258:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=4.500325801565176, CurrSamplesPerSec=4.482478030075526, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:31:24,351] [INFO] [RANK 0]  iteration     2600/   20000 | elapsed time per iteration (ms): 906.3 | learning rate 9.736E-05 | total loss 6.004980E-01 | loss 6.004980E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 06:31:24,352] [INFO] [RANK 0] time (ms) | forward: 356.35 | backward: 545.82 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.14 | data loader: 0.11
[2024-06-17 06:31:33,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=2610, skipped=11, lr=[9.734202847784991e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:31:33,421] [INFO] [timer.py:258:stop] epoch=0/micro_step=2610/global_step=2610, RunningAvgSamplesPerSec=4.500290341786303, CurrSamplesPerSec=4.4812795401519026, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:31:42,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=2620, skipped=11, lr=[9.731804272486152e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:31:42,474] [INFO] [timer.py:258:stop] epoch=0/micro_step=2620/global_step=2620, RunningAvgSamplesPerSec=4.500276684565734, CurrSamplesPerSec=4.500911733420255, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:31:51,537] [INFO] [logging.py:96:log_dist] [Rank 0] step=2630, skipped=11, lr=[9.72939525563094e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:31:51,538] [INFO] [timer.py:258:stop] epoch=0/micro_step=2630/global_step=2630, RunningAvgSamplesPerSec=4.500246686273139, CurrSamplesPerSec=4.494098574775405, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:32:00,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=2640, skipped=11, lr=[9.726975803163367e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:32:00,579] [INFO] [timer.py:258:stop] epoch=0/micro_step=2640/global_step=2640, RunningAvgSamplesPerSec=4.500230977452902, CurrSamplesPerSec=4.494547648369465, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:32:09,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=11, lr=[9.724545921053191e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:32:09,622] [INFO] [timer.py:258:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=4.500231499714676, CurrSamplesPerSec=4.498486000227911, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:32:09,624] [INFO] [RANK 0]  iteration     2650/   20000 | elapsed time per iteration (ms): 905.5 | learning rate 9.724E-05 | total loss 5.591455E-01 | loss 5.591455E-01 | loss scale 32768.0 |speed 265.06 samples/(min*GPU)
[2024-06-17 06:32:09,624] [INFO] [RANK 0] time (ms) | forward: 355.71 | backward: 545.72 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.12 | data loader: 0.10
[2024-06-17 06:32:18,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=2660, skipped=11, lr=[9.722105615295904e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:32:18,682] [INFO] [timer.py:258:stop] epoch=0/micro_step=2660/global_step=2660, RunningAvgSamplesPerSec=4.500195366085152, CurrSamplesPerSec=4.474103230795898, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:32:27,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=2670, skipped=11, lr=[9.71965489191272e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:32:27,747] [INFO] [timer.py:258:stop] epoch=0/micro_step=2670/global_step=2670, RunningAvgSamplesPerSec=4.500174862543759, CurrSamplesPerSec=4.4704504286535744, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:32:36,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=2680, skipped=11, lr=[9.717193756950553e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:32:36,828] [INFO] [timer.py:258:stop] epoch=0/micro_step=2680/global_step=2680, RunningAvgSamplesPerSec=4.500157804957972, CurrSamplesPerSec=4.4899744285907355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:32:45,895] [INFO] [logging.py:96:log_dist] [Rank 0] step=2690, skipped=11, lr=[9.71472221648201e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:32:45,896] [INFO] [timer.py:258:stop] epoch=0/micro_step=2690/global_step=2690, RunningAvgSamplesPerSec=4.500134785189676, CurrSamplesPerSec=4.4937964336692096, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:32:54,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=11, lr=[9.71224027660537e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:32:54,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=4.500076091818396, CurrSamplesPerSec=4.498346087465254, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:32:54,985] [INFO] [RANK 0]  iteration     2700/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 9.712E-05 | total loss 5.688818E-01 | loss 5.688818E-01 | loss scale 32768.0 |speed 264.54 samples/(min*GPU)
[2024-06-17 06:32:54,986] [INFO] [RANK 0] time (ms) | forward: 357.19 | backward: 546.01 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 16.06 | data loader: 0.10
[2024-06-17 06:32:54,986] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:32:55,004] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/2700/mp_rank_00_model_states.pt
[2024-06-17 06:32:55,004] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/2700/mp_rank_00_model_states.pt...
[2024-06-17 06:33:25,414] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/2700/mp_rank_00_model_states.pt.
[2024-06-17 06:33:34,470] [INFO] [logging.py:96:log_dist] [Rank 0] step=2710, skipped=11, lr=[9.709747943444575e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:33:34,471] [INFO] [timer.py:258:stop] epoch=0/micro_step=2710/global_step=2710, RunningAvgSamplesPerSec=4.500106296334451, CurrSamplesPerSec=4.5111660476004305, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:33:43,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=2720, skipped=11, lr=[9.707245223149209e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:33:43,466] [INFO] [timer.py:258:stop] epoch=0/micro_step=2720/global_step=2720, RunningAvgSamplesPerSec=4.50021922753361, CurrSamplesPerSec=4.535498190095402, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:33:52,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=2730, skipped=11, lr=[9.704732121894483e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:33:52,432] [INFO] [timer.py:258:stop] epoch=0/micro_step=2730/global_step=2730, RunningAvgSamplesPerSec=4.50034344045142, CurrSamplesPerSec=4.510589950254293, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:34:01,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=2740, skipped=11, lr=[9.702208645881226e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:34:01,437] [INFO] [timer.py:258:stop] epoch=0/micro_step=2740/global_step=2740, RunningAvgSamplesPerSec=4.500431891156121, CurrSamplesPerSec=4.51106779743504, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:34:07,773] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 06:34:08,681] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 06:34:10,488] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=13, lr=[9.700182399427777e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:34:10,488] [INFO] [timer.py:258:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=4.500437188953947, CurrSamplesPerSec=4.495293091908362, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:34:10,490] [INFO] [RANK 0]  iteration     2750/   20000 | elapsed time per iteration (ms): 1510.1 | learning rate 9.700E-05 | total loss 6.468921E-01 | loss 6.468921E-01 | loss scale 32768.0 |speed 158.93 samples/(min*GPU)
[2024-06-17 06:34:10,491] [INFO] [RANK 0] time (ms) | forward: 354.71 | backward: 542.49 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 15.76 | data loader: 0.11
[2024-06-17 06:34:19,549] [INFO] [logging.py:96:log_dist] [Rank 0] step=2760, skipped=13, lr=[9.697640264556953e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:34:19,550] [INFO] [timer.py:258:stop] epoch=0/micro_step=2760/global_step=2760, RunningAvgSamplesPerSec=4.5004285052607225, CurrSamplesPerSec=4.4955231575277805, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:34:28,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=2770, skipped=13, lr=[9.69508777242605e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:34:28,610] [INFO] [timer.py:258:stop] epoch=0/micro_step=2770/global_step=2770, RunningAvgSamplesPerSec=4.500383889608808, CurrSamplesPerSec=4.472580107258432, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:34:37,656] [INFO] [logging.py:96:log_dist] [Rank 0] step=2780, skipped=13, lr=[9.69252492933309e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:34:37,657] [INFO] [timer.py:258:stop] epoch=0/micro_step=2780/global_step=2780, RunningAvgSamplesPerSec=4.500375234962201, CurrSamplesPerSec=4.496623220684683, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:34:46,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=2790, skipped=13, lr=[9.689951741601635e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:34:46,706] [INFO] [timer.py:258:stop] epoch=0/micro_step=2790/global_step=2790, RunningAvgSamplesPerSec=4.500359347341419, CurrSamplesPerSec=4.498131410666309, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:34:55,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=13, lr=[9.687368215580766e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:34:55,781] [INFO] [timer.py:258:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=4.500328535489547, CurrSamplesPerSec=4.505739594324834, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:34:55,783] [INFO] [RANK 0]  iteration     2800/   20000 | elapsed time per iteration (ms): 905.9 | learning rate 9.687E-05 | total loss 5.512781E-01 | loss 5.512781E-01 | loss scale 32768.0 |speed 264.94 samples/(min*GPU)
[2024-06-17 06:34:55,784] [INFO] [RANK 0] time (ms) | forward: 356.36 | backward: 545.40 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 15.28 | data loader: 0.10
[2024-06-17 06:35:04,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=2810, skipped=13, lr=[9.684774357645081e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:35:04,844] [INFO] [timer.py:258:stop] epoch=0/micro_step=2810/global_step=2810, RunningAvgSamplesPerSec=4.5002943830993924, CurrSamplesPerSec=4.472719614183913, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:35:13,910] [INFO] [logging.py:96:log_dist] [Rank 0] step=2820, skipped=13, lr=[9.682170174194664e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:35:13,911] [INFO] [timer.py:258:stop] epoch=0/micro_step=2820/global_step=2820, RunningAvgSamplesPerSec=4.500255302816324, CurrSamplesPerSec=4.487846163846407, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:35:22,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=2830, skipped=13, lr=[9.67955567165508e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:35:22,948] [INFO] [timer.py:258:stop] epoch=0/micro_step=2830/global_step=2830, RunningAvgSamplesPerSec=4.500240664115413, CurrSamplesPerSec=4.4910236896642735, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:35:32,018] [INFO] [logging.py:96:log_dist] [Rank 0] step=2840, skipped=13, lr=[9.676930856477353e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:35:32,019] [INFO] [timer.py:258:stop] epoch=0/micro_step=2840/global_step=2840, RunningAvgSamplesPerSec=4.50020332162187, CurrSamplesPerSec=4.488283182223236, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:35:41,095] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=13, lr=[9.674295735137954e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:35:41,095] [INFO] [timer.py:258:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=4.500182537237025, CurrSamplesPerSec=4.496408708292775, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:35:41,096] [INFO] [RANK 0]  iteration     2850/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 9.674E-05 | total loss 5.291284E-01 | loss 5.291284E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 06:35:41,097] [INFO] [RANK 0] time (ms) | forward: 355.89 | backward: 546.30 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 15.19 | data loader: 0.10
[2024-06-17 06:35:50,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=2860, skipped=13, lr=[9.671650314138783e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:35:50,167] [INFO] [timer.py:258:stop] epoch=0/micro_step=2860/global_step=2860, RunningAvgSamplesPerSec=4.500159107591495, CurrSamplesPerSec=4.48684398435816, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:35:59,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=2870, skipped=13, lr=[9.668994600007151e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:35:59,212] [INFO] [timer.py:258:stop] epoch=0/micro_step=2870/global_step=2870, RunningAvgSamplesPerSec=4.500147963622616, CurrSamplesPerSec=4.4905657044251726, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:36:08,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=2880, skipped=13, lr=[9.666328599295774e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:36:08,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=2880/global_step=2880, RunningAvgSamplesPerSec=4.5001253167981865, CurrSamplesPerSec=4.487655295161783, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:36:17,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=2890, skipped=13, lr=[9.663652318582743e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:36:17,340] [INFO] [timer.py:258:stop] epoch=0/micro_step=2890/global_step=2890, RunningAvgSamplesPerSec=4.5000753254542785, CurrSamplesPerSec=4.484962057287121, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:36:26,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=13, lr=[9.660965764471509e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:36:26,403] [INFO] [timer.py:258:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=4.500042604628016, CurrSamplesPerSec=4.493233187417395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:36:26,405] [INFO] [RANK 0]  iteration     2900/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 9.661E-05 | total loss 5.619775E-01 | loss 5.619775E-01 | loss scale 32768.0 |speed 264.85 samples/(min*GPU)
[2024-06-17 06:36:26,406] [INFO] [RANK 0] time (ms) | forward: 355.67 | backward: 546.40 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 15.19 | data loader: 0.09
[2024-06-17 06:36:35,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=2910, skipped=13, lr=[9.65826894359088e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:36:35,460] [INFO] [timer.py:258:stop] epoch=0/micro_step=2910/global_step=2910, RunningAvgSamplesPerSec=4.500020439392545, CurrSamplesPerSec=4.499451152873972, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:36:44,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=2920, skipped=13, lr=[9.655561862594996e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:36:44,515] [INFO] [timer.py:258:stop] epoch=0/micro_step=2920/global_step=2920, RunningAvgSamplesPerSec=4.499998498266787, CurrSamplesPerSec=4.485668344481632, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:36:53,572] [INFO] [logging.py:96:log_dist] [Rank 0] step=2930, skipped=13, lr=[9.652844528163308e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:36:53,573] [INFO] [timer.py:258:stop] epoch=0/micro_step=2930/global_step=2930, RunningAvgSamplesPerSec=4.499972340576586, CurrSamplesPerSec=4.470071660904522, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:37:02,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=2940, skipped=13, lr=[9.650116947000569e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:37:02,647] [INFO] [timer.py:258:stop] epoch=0/micro_step=2940/global_step=2940, RunningAvgSamplesPerSec=4.4999326750960655, CurrSamplesPerSec=4.490297688156762, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:37:11,723] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=13, lr=[9.647379125836812e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:37:11,724] [INFO] [timer.py:258:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=4.499891444439678, CurrSamplesPerSec=4.48393839575051, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:37:11,725] [INFO] [RANK 0]  iteration     2950/   20000 | elapsed time per iteration (ms): 906.4 | learning rate 9.647E-05 | total loss 6.011450E-01 | loss 6.011450E-01 | loss scale 32768.0 |speed 264.78 samples/(min*GPU)
[2024-06-17 06:37:11,726] [INFO] [RANK 0] time (ms) | forward: 355.98 | backward: 546.39 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.22 | data loader: 0.10
[2024-06-17 06:37:20,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=2960, skipped=13, lr=[9.644631071427342e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:37:20,773] [INFO] [timer.py:258:stop] epoch=0/micro_step=2960/global_step=2960, RunningAvgSamplesPerSec=4.499863548250227, CurrSamplesPerSec=4.489779774280211, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:37:29,842] [INFO] [logging.py:96:log_dist] [Rank 0] step=2970, skipped=13, lr=[9.64187279055271e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:37:29,843] [INFO] [timer.py:258:stop] epoch=0/micro_step=2970/global_step=2970, RunningAvgSamplesPerSec=4.499837259555129, CurrSamplesPerSec=4.486372454771172, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:37:38,900] [INFO] [logging.py:96:log_dist] [Rank 0] step=2980, skipped=13, lr=[9.639104290018698e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:37:38,901] [INFO] [timer.py:258:stop] epoch=0/micro_step=2980/global_step=2980, RunningAvgSamplesPerSec=4.499819556265342, CurrSamplesPerSec=4.490630610037502, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:37:47,947] [INFO] [logging.py:96:log_dist] [Rank 0] step=2990, skipped=13, lr=[9.636325576656305e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:37:47,947] [INFO] [timer.py:258:stop] epoch=0/micro_step=2990/global_step=2990, RunningAvgSamplesPerSec=4.499811756388895, CurrSamplesPerSec=4.493298170163567, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:37:56,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=13, lr=[9.633536657321733e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:37:56,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=4.49979347468767, CurrSamplesPerSec=4.496449680988547, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:37:56,984] [INFO] [RANK 0]  iteration     3000/   20000 | elapsed time per iteration (ms): 905.2 | learning rate 9.633E-05 | total loss 5.989404E-01 | loss 5.989404E-01 | loss scale 32768.0 |speed 265.14 samples/(min*GPU)
[2024-06-17 06:37:56,985] [INFO] [RANK 0] time (ms) | forward: 354.90 | backward: 546.32 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.55 | data loader: 0.11
[2024-06-17 06:37:56,985] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:37:56,996] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/3000/mp_rank_00_model_states.pt
[2024-06-17 06:37:56,996] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/3000/mp_rank_00_model_states.pt...
[2024-06-17 06:38:26,360] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/3000/mp_rank_00_model_states.pt.
[2024-06-17 06:38:33,011] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 06:38:33,011] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 06:38:33,012] [INFO] [RANK 0]  validation loss at iteration 3000 | loss: 8.805664E-01 | PPL: 2.412266E+00 loss 8.803711E-01 |
[2024-06-17 06:38:33,012] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 06:38:42,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=3010, skipped=13, lr=[9.630737538896363e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:38:42,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=3010/global_step=3010, RunningAvgSamplesPerSec=4.499851249097006, CurrSamplesPerSec=4.522320329909223, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:38:51,025] [INFO] [logging.py:96:log_dist] [Rank 0] step=3020, skipped=13, lr=[9.627928228286739e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:38:51,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=3020/global_step=3020, RunningAvgSamplesPerSec=4.499925801350467, CurrSamplesPerSec=4.5133638452923694, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:39:00,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=3030, skipped=13, lr=[9.625108732424557e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:39:00,043] [INFO] [timer.py:258:stop] epoch=0/micro_step=3030/global_step=3030, RunningAvgSamplesPerSec=4.499952333762043, CurrSamplesPerSec=4.48865663623434, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:39:09,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=3040, skipped=13, lr=[9.622279058266643e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:39:09,104] [INFO] [timer.py:258:stop] epoch=0/micro_step=3040/global_step=3040, RunningAvgSamplesPerSec=4.499924707203005, CurrSamplesPerSec=4.486728792409698, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:39:18,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=13, lr=[9.619439212794935e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:39:18,171] [INFO] [timer.py:258:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=4.499872781486349, CurrSamplesPerSec=4.452842728054963, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:39:18,173] [INFO] [RANK 0]  iteration     3050/   20000 | elapsed time per iteration (ms): 1623.8 | learning rate 9.619E-05 | total loss 5.411060E-01 | loss 5.411060E-01 | loss scale 32768.0 |speed 147.80 samples/(min*GPU)
[2024-06-17 06:39:18,174] [INFO] [RANK 0] time (ms) | forward: 355.64 | backward: 543.22 | allreduce: 0.00 | optimizer: 3.45 | batch generator: 17.81 | data loader: 0.15
[2024-06-17 06:39:27,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=3060, skipped=13, lr=[9.616589203016473e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:39:27,235] [INFO] [timer.py:258:stop] epoch=0/micro_step=3060/global_step=3060, RunningAvgSamplesPerSec=4.499833725367857, CurrSamplesPerSec=4.480638054727871, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:39:36,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=3070, skipped=13, lr=[9.61372903596337e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:39:36,313] [INFO] [timer.py:258:stop] epoch=0/micro_step=3070/global_step=3070, RunningAvgSamplesPerSec=4.499811194701378, CurrSamplesPerSec=4.489568317119948, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:39:45,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=3080, skipped=13, lr=[9.610858718692802e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:39:45,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=3080/global_step=3080, RunningAvgSamplesPerSec=4.499788239760325, CurrSamplesPerSec=4.494967908426758, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:39:54,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=3090, skipped=13, lr=[9.607978258286997e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:39:54,483] [INFO] [timer.py:258:stop] epoch=0/micro_step=3090/global_step=3090, RunningAvgSamplesPerSec=4.499745520094626, CurrSamplesPerSec=4.4878977852106985, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:40:03,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=13, lr=[9.605087661853201e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:40:03,571] [INFO] [timer.py:258:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=4.499722737450408, CurrSamplesPerSec=4.47624355766201, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:40:03,572] [INFO] [RANK 0]  iteration     3100/   20000 | elapsed time per iteration (ms): 908.0 | learning rate 9.605E-05 | total loss 5.753516E-01 | loss 5.753516E-01 | loss scale 32768.0 |speed 264.32 samples/(min*GPU)
[2024-06-17 06:40:03,573] [INFO] [RANK 0] time (ms) | forward: 357.46 | backward: 546.41 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 16.69 | data loader: 0.10
[2024-06-17 06:40:12,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=3110, skipped=13, lr=[9.602186936523674e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:40:12,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=3110/global_step=3110, RunningAvgSamplesPerSec=4.499698100737451, CurrSamplesPerSec=4.479718035325688, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:40:21,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=3120, skipped=13, lr=[9.599276089455668e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:40:21,711] [INFO] [timer.py:258:stop] epoch=0/micro_step=3120/global_step=3120, RunningAvgSamplesPerSec=4.499672028066101, CurrSamplesPerSec=4.498888901104824, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:40:30,777] [INFO] [logging.py:96:log_dist] [Rank 0] step=3130, skipped=13, lr=[9.596355127831407e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:40:30,778] [INFO] [timer.py:258:stop] epoch=0/micro_step=3130/global_step=3130, RunningAvgSamplesPerSec=4.499635385416468, CurrSamplesPerSec=4.47995847206464, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:40:39,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=3140, skipped=13, lr=[9.593424058858078e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:40:39,857] [INFO] [timer.py:258:stop] epoch=0/micro_step=3140/global_step=3140, RunningAvgSamplesPerSec=4.499589028109625, CurrSamplesPerSec=4.480081690942698, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:40:48,046] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 06:40:48,950] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 06:40:48,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=15, lr=[9.590777460975456e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:40:48,951] [INFO] [timer.py:258:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=4.4995575738038, CurrSamplesPerSec=4.495999022400115, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:40:48,952] [INFO] [RANK 0]  iteration     3150/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 9.591E-05 | total loss 6.186670E-01 | loss 6.186670E-01 | loss scale 32768.0 |speed 264.43 samples/(min*GPU)
[2024-06-17 06:40:48,953] [INFO] [RANK 0] time (ms) | forward: 357.19 | backward: 546.46 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 16.06 | data loader: 0.10
[2024-06-17 06:40:58,002] [INFO] [logging.py:96:log_dist] [Rank 0] step=3160, skipped=15, lr=[9.58812268728726e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:40:58,003] [INFO] [timer.py:258:stop] epoch=0/micro_step=3160/global_step=3160, RunningAvgSamplesPerSec=4.499541395030964, CurrSamplesPerSec=4.489203119844955, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:41:07,065] [INFO] [logging.py:96:log_dist] [Rank 0] step=3170, skipped=15, lr=[9.585163356290953e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:41:07,065] [INFO] [timer.py:258:stop] epoch=0/micro_step=3170/global_step=3170, RunningAvgSamplesPerSec=4.499498277121906, CurrSamplesPerSec=4.4636162887837685, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:41:16,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=3180, skipped=15, lr=[9.582193945560156e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:41:16,135] [INFO] [timer.py:258:stop] epoch=0/micro_step=3180/global_step=3180, RunningAvgSamplesPerSec=4.499478158731219, CurrSamplesPerSec=4.491671760125274, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:41:25,220] [INFO] [logging.py:96:log_dist] [Rank 0] step=3190, skipped=15, lr=[9.579214462421597e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:41:25,221] [INFO] [timer.py:258:stop] epoch=0/micro_step=3190/global_step=3190, RunningAvgSamplesPerSec=4.499449892804332, CurrSamplesPerSec=4.48647563089165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:41:34,284] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=15, lr=[9.576224914226857e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:41:34,285] [INFO] [timer.py:258:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=4.499427173336521, CurrSamplesPerSec=4.499809571218755, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:41:34,286] [INFO] [RANK 0]  iteration     3200/   20000 | elapsed time per iteration (ms): 906.7 | learning rate 9.576E-05 | total loss 4.982709E-01 | loss 4.982709E-01 | loss scale 32768.0 |speed 264.70 samples/(min*GPU)
[2024-06-17 06:41:34,287] [INFO] [RANK 0] time (ms) | forward: 356.41 | backward: 546.33 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 15.53 | data loader: 0.10
[2024-06-17 06:41:43,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=3210, skipped=15, lr=[9.573225308352343e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:41:43,367] [INFO] [timer.py:258:stop] epoch=0/micro_step=3210/global_step=3210, RunningAvgSamplesPerSec=4.499402694324011, CurrSamplesPerSec=4.485164687395238, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:41:52,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=3220, skipped=15, lr=[9.57021565219929e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:41:52,422] [INFO] [timer.py:258:stop] epoch=0/micro_step=3220/global_step=3220, RunningAvgSamplesPerSec=4.499380161956225, CurrSamplesPerSec=4.491634481986842, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:42:01,488] [INFO] [logging.py:96:log_dist] [Rank 0] step=3230, skipped=15, lr=[9.567195953193724e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:42:01,489] [INFO] [timer.py:258:stop] epoch=0/micro_step=3230/global_step=3230, RunningAvgSamplesPerSec=4.499360254863052, CurrSamplesPerSec=4.50471610343449, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:42:10,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=3240, skipped=15, lr=[9.564166218786451e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:42:10,546] [INFO] [timer.py:258:stop] epoch=0/micro_step=3240/global_step=3240, RunningAvgSamplesPerSec=4.499336265926377, CurrSamplesPerSec=4.502941219887623, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:42:19,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=15, lr=[9.561126456453039e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:42:19,632] [INFO] [timer.py:258:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=4.499295724331312, CurrSamplesPerSec=4.487850965783687, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:42:19,633] [INFO] [RANK 0]  iteration     3250/   20000 | elapsed time per iteration (ms): 907.0 | learning rate 9.561E-05 | total loss 5.918066E-01 | loss 5.918066E-01 | loss scale 32768.0 |speed 264.62 samples/(min*GPU)
[2024-06-17 06:42:19,634] [INFO] [RANK 0] time (ms) | forward: 356.57 | backward: 546.42 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 15.74 | data loader: 0.11
[2024-06-17 06:42:28,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=3260, skipped=15, lr=[9.558076673693802e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:42:28,685] [INFO] [timer.py:258:stop] epoch=0/micro_step=3260/global_step=3260, RunningAvgSamplesPerSec=4.499282850124664, CurrSamplesPerSec=4.495153377685014, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:42:37,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=3270, skipped=15, lr=[9.555016878033773e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:42:37,750] [INFO] [timer.py:258:stop] epoch=0/micro_step=3270/global_step=3270, RunningAvgSamplesPerSec=4.4992505424631535, CurrSamplesPerSec=4.489221138053881, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:42:46,801] [INFO] [logging.py:96:log_dist] [Rank 0] step=3280, skipped=15, lr=[9.551947077022695e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:42:46,801] [INFO] [timer.py:258:stop] epoch=0/micro_step=3280/global_step=3280, RunningAvgSamplesPerSec=4.499226019311262, CurrSamplesPerSec=4.484576031657059, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:42:55,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=3290, skipped=15, lr=[9.548867278234998e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:42:55,850] [INFO] [timer.py:258:stop] epoch=0/micro_step=3290/global_step=3290, RunningAvgSamplesPerSec=4.499194799221924, CurrSamplesPerSec=4.501880343348146, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:43:04,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=15, lr=[9.545777489269777e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:43:04,914] [INFO] [timer.py:258:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=4.499168865434061, CurrSamplesPerSec=4.488411662603775, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:43:04,915] [INFO] [RANK 0]  iteration     3300/   20000 | elapsed time per iteration (ms): 905.6 | learning rate 9.545E-05 | total loss 5.640942E-01 | loss 5.640942E-01 | loss scale 32768.0 |speed 265.01 samples/(min*GPU)
[2024-06-17 06:43:04,916] [INFO] [RANK 0] time (ms) | forward: 355.30 | backward: 546.35 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.44 | data loader: 0.11
[2024-06-17 06:43:04,917] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:43:04,928] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/3300/mp_rank_00_model_states.pt
[2024-06-17 06:43:04,928] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/3300/mp_rank_00_model_states.pt...
[2024-06-17 06:43:33,808] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/3300/mp_rank_00_model_states.pt.
[2024-06-17 06:43:42,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=3310, skipped=15, lr=[9.542677717750778e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:43:42,849] [INFO] [timer.py:258:stop] epoch=0/micro_step=3310/global_step=3310, RunningAvgSamplesPerSec=4.499190907836761, CurrSamplesPerSec=4.526789930187367, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:43:51,814] [INFO] [logging.py:96:log_dist] [Rank 0] step=3320, skipped=15, lr=[9.539567971326385e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:43:51,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=3320/global_step=3320, RunningAvgSamplesPerSec=4.499308371886708, CurrSamplesPerSec=4.499184488056411, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:44:00,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=3330, skipped=15, lr=[9.536448257669581e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:44:00,827] [INFO] [timer.py:258:stop] epoch=0/micro_step=3330/global_step=3330, RunningAvgSamplesPerSec=4.499379882217052, CurrSamplesPerSec=4.515911404541532, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:44:09,887] [INFO] [logging.py:96:log_dist] [Rank 0] step=3340, skipped=15, lr=[9.533318584477956e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:44:09,888] [INFO] [timer.py:258:stop] epoch=0/micro_step=3340/global_step=3340, RunningAvgSamplesPerSec=4.499367641626011, CurrSamplesPerSec=4.492895066796709, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:44:18,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=15, lr=[9.530178959473661e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:44:18,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=4.499326630538946, CurrSamplesPerSec=4.470689871567584, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:44:18,985] [INFO] [RANK 0]  iteration     3350/   20000 | elapsed time per iteration (ms): 1481.4 | learning rate 9.530E-05 | total loss 5.479688E-01 | loss 5.479688E-01 | loss scale 32768.0 |speed 162.01 samples/(min*GPU)
[2024-06-17 06:44:18,986] [INFO] [RANK 0] time (ms) | forward: 356.12 | backward: 543.06 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 15.72 | data loader: 0.15
[2024-06-17 06:44:28,070] [INFO] [logging.py:96:log_dist] [Rank 0] step=3360, skipped=15, lr=[9.527029390403413e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:44:28,071] [INFO] [timer.py:258:stop] epoch=0/micro_step=3360/global_step=3360, RunningAvgSamplesPerSec=4.499297567315358, CurrSamplesPerSec=4.501751090742242, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:44:37,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=3370, skipped=15, lr=[9.523869885038461e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:44:37,140] [INFO] [timer.py:258:stop] epoch=0/micro_step=3370/global_step=3370, RunningAvgSamplesPerSec=4.499295325622621, CurrSamplesPerSec=4.495988178787795, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:44:46,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=3380, skipped=15, lr=[9.520700451174567e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:44:46,216] [INFO] [timer.py:258:stop] epoch=0/micro_step=3380/global_step=3380, RunningAvgSamplesPerSec=4.4992657477907025, CurrSamplesPerSec=4.490411861579222, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:44:55,269] [INFO] [logging.py:96:log_dist] [Rank 0] step=3390, skipped=15, lr=[9.517521096631994e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:44:55,270] [INFO] [timer.py:258:stop] epoch=0/micro_step=3390/global_step=3390, RunningAvgSamplesPerSec=4.4992622571031236, CurrSamplesPerSec=4.501836855661597, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:45:04,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=15, lr=[9.514331829255486e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:45:04,340] [INFO] [timer.py:258:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=4.499245751288192, CurrSamplesPerSec=4.471539445628998, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:45:04,341] [INFO] [RANK 0]  iteration     3400/   20000 | elapsed time per iteration (ms): 907.1 | learning rate 9.514E-05 | total loss 5.625903E-01 | loss 5.625903E-01 | loss scale 32768.0 |speed 264.57 samples/(min*GPU)
[2024-06-17 06:45:04,342] [INFO] [RANK 0] time (ms) | forward: 357.39 | backward: 545.67 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 16.37 | data loader: 0.10
[2024-06-17 06:45:13,407] [INFO] [logging.py:96:log_dist] [Rank 0] step=3410, skipped=15, lr=[9.511132656914245e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:45:13,407] [INFO] [timer.py:258:stop] epoch=0/micro_step=3410/global_step=3410, RunningAvgSamplesPerSec=4.499233975832123, CurrSamplesPerSec=4.491868983799011, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:45:22,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=3420, skipped=15, lr=[9.507923587501905e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:45:22,491] [INFO] [timer.py:258:stop] epoch=0/micro_step=3420/global_step=3420, RunningAvgSamplesPerSec=4.499202038264003, CurrSamplesPerSec=4.494985972941481, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:45:31,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=3430, skipped=15, lr=[9.504704628936531e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:45:31,540] [INFO] [timer.py:258:stop] epoch=0/micro_step=3430/global_step=3430, RunningAvgSamplesPerSec=4.499191210712743, CurrSamplesPerSec=4.499255676023435, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:45:40,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=3440, skipped=15, lr=[9.50147578916058e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:45:40,580] [INFO] [timer.py:258:stop] epoch=0/micro_step=3440/global_step=3440, RunningAvgSamplesPerSec=4.499178937481662, CurrSamplesPerSec=4.5009467507054355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:45:49,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=15, lr=[9.498237076140895e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:45:49,613] [INFO] [timer.py:258:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=4.499160305964257, CurrSamplesPerSec=4.484651553181878, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:45:49,614] [INFO] [RANK 0]  iteration     3450/   20000 | elapsed time per iteration (ms): 905.5 | learning rate 9.498E-05 | total loss 5.294238E-01 | loss 5.294238E-01 | loss scale 32768.0 |speed 265.06 samples/(min*GPU)
[2024-06-17 06:45:49,615] [INFO] [RANK 0] time (ms) | forward: 355.41 | backward: 546.09 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.74 | data loader: 0.09
[2024-06-17 06:45:58,682] [INFO] [logging.py:96:log_dist] [Rank 0] step=3460, skipped=15, lr=[9.494988497868676e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:45:58,683] [INFO] [timer.py:258:stop] epoch=0/micro_step=3460/global_step=3460, RunningAvgSamplesPerSec=4.499134511417308, CurrSamplesPerSec=4.488630216223071, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:46:07,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=3470, skipped=15, lr=[9.49173006235947e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:46:07,749] [INFO] [timer.py:258:stop] epoch=0/micro_step=3470/global_step=3470, RunningAvgSamplesPerSec=4.499117945077115, CurrSamplesPerSec=4.476481232746812, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:46:16,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=3480, skipped=15, lr=[9.488461777653142e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:46:16,799] [INFO] [timer.py:258:stop] epoch=0/micro_step=3480/global_step=3480, RunningAvgSamplesPerSec=4.499090914910558, CurrSamplesPerSec=4.487333616133973, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:46:25,841] [INFO] [logging.py:96:log_dist] [Rank 0] step=3490, skipped=15, lr=[9.485183651813856e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:46:25,841] [INFO] [timer.py:258:stop] epoch=0/micro_step=3490/global_step=3490, RunningAvgSamplesPerSec=4.499066758123153, CurrSamplesPerSec=4.485280998153993, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:46:34,882] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=15, lr=[9.481895692930068e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:46:34,882] [INFO] [timer.py:258:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=4.49905020107086, CurrSamplesPerSec=4.498202565312513, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:46:34,884] [INFO] [RANK 0]  iteration     3500/   20000 | elapsed time per iteration (ms): 905.4 | learning rate 9.482E-05 | total loss 5.206396E-01 | loss 5.206396E-01 | loss scale 32768.0 |speed 265.08 samples/(min*GPU)
[2024-06-17 06:46:34,885] [INFO] [RANK 0] time (ms) | forward: 355.12 | backward: 546.31 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.26 | data loader: 0.12
[2024-06-17 06:46:43,938] [INFO] [logging.py:96:log_dist] [Rank 0] step=3510, skipped=15, lr=[9.478597909114482e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:46:43,938] [INFO] [timer.py:258:stop] epoch=0/micro_step=3510/global_step=3510, RunningAvgSamplesPerSec=4.499036530145931, CurrSamplesPerSec=4.497678003428775, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:46:53,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=3520, skipped=15, lr=[9.475290308504062e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:46:53,020] [INFO] [timer.py:258:stop] epoch=0/micro_step=3520/global_step=3520, RunningAvgSamplesPerSec=4.499014058615178, CurrSamplesPerSec=4.467355467187714, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:47:02,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=3530, skipped=15, lr=[9.471972899259974e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:47:02,077] [INFO] [timer.py:258:stop] epoch=0/micro_step=3530/global_step=3530, RunningAvgSamplesPerSec=4.498993539423685, CurrSamplesPerSec=4.488199133617776, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:47:11,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=3540, skipped=15, lr=[9.468645689567599e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:47:11,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=3540/global_step=3540, RunningAvgSamplesPerSec=4.498963433054368, CurrSamplesPerSec=4.486356858793756, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:47:20,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=15, lr=[9.465308687636496e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:47:20,182] [INFO] [timer.py:258:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=4.4989374282093895, CurrSamplesPerSec=4.482936762734468, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:47:20,184] [INFO] [RANK 0]  iteration     3550/   20000 | elapsed time per iteration (ms): 906.0 | learning rate 9.465E-05 | total loss 5.168530E-01 | loss 5.168530E-01 | loss scale 65536.0 |speed 264.90 samples/(min*GPU)
[2024-06-17 06:47:20,184] [INFO] [RANK 0] time (ms) | forward: 355.61 | backward: 546.40 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.73 | data loader: 0.09
[2024-06-17 06:47:21,091] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 06:47:21,993] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 06:47:29,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=3560, skipped=17, lr=[9.46263204121198e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:47:29,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=3560/global_step=3560, RunningAvgSamplesPerSec=4.498920577923925, CurrSamplesPerSec=4.495247322499365, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:47:38,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=3570, skipped=17, lr=[9.459277434016369e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:47:38,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=3570/global_step=3570, RunningAvgSamplesPerSec=4.498886085952297, CurrSamplesPerSec=4.46890479280339, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:47:47,371] [INFO] [logging.py:96:log_dist] [Rank 0] step=3580, skipped=17, lr=[9.455913057697267e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:47:47,372] [INFO] [timer.py:258:stop] epoch=0/micro_step=3580/global_step=3580, RunningAvgSamplesPerSec=4.498844678519081, CurrSamplesPerSec=4.484311127053222, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:47:56,424] [INFO] [logging.py:96:log_dist] [Rank 0] step=3590, skipped=17, lr=[9.452538920555942e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:47:56,424] [INFO] [timer.py:258:stop] epoch=0/micro_step=3590/global_step=3590, RunningAvgSamplesPerSec=4.498806862487234, CurrSamplesPerSec=4.486559614958287, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:48:05,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=17, lr=[9.449155030917742e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:48:05,472] [INFO] [timer.py:258:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=4.498767742836842, CurrSamplesPerSec=4.490570512183965, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:48:05,473] [INFO] [RANK 0]  iteration     3600/   20000 | elapsed time per iteration (ms): 905.8 | learning rate 9.449E-05 | total loss 5.370605E-01 | loss 5.370605E-01 | loss scale 32768.0 |speed 264.96 samples/(min*GPU)
[2024-06-17 06:48:05,474] [INFO] [RANK 0] time (ms) | forward: 355.31 | backward: 546.53 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 13.71 | data loader: 0.10
[2024-06-17 06:48:05,474] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:48:05,490] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/3600/mp_rank_00_model_states.pt
[2024-06-17 06:48:05,490] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/3600/mp_rank_00_model_states.pt...
[2024-06-17 06:48:33,659] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/3600/mp_rank_00_model_states.pt.
[2024-06-17 06:48:42,759] [INFO] [logging.py:96:log_dist] [Rank 0] step=3610, skipped=17, lr=[9.445761397132075e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:48:42,760] [INFO] [timer.py:258:stop] epoch=0/micro_step=3610/global_step=3610, RunningAvgSamplesPerSec=4.498757025062303, CurrSamplesPerSec=4.504935038153304, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:48:51,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=3620, skipped=17, lr=[9.442358027572398e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:48:51,768] [INFO] [timer.py:258:stop] epoch=0/micro_step=3620/global_step=3620, RunningAvgSamplesPerSec=4.498842866718501, CurrSamplesPerSec=4.512892795092773, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:49:00,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=3630, skipped=17, lr=[9.438944930636187e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:49:00,773] [INFO] [timer.py:258:stop] epoch=0/micro_step=3630/global_step=3630, RunningAvgSamplesPerSec=4.4988998318695375, CurrSamplesPerSec=4.511238828259992, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:49:09,819] [INFO] [logging.py:96:log_dist] [Rank 0] step=3640, skipped=17, lr=[9.435522114744918e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:49:09,820] [INFO] [timer.py:258:stop] epoch=0/micro_step=3640/global_step=3640, RunningAvgSamplesPerSec=4.498912285386386, CurrSamplesPerSec=4.4974609791240825, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:49:18,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=17, lr=[9.432089588344049e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:49:18,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=4.498935230178753, CurrSamplesPerSec=4.499116921900283, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:49:18,864] [INFO] [RANK 0]  iteration     3650/   20000 | elapsed time per iteration (ms): 1467.8 | learning rate 9.432E-05 | total loss 5.698145E-01 | loss 5.698145E-01 | loss scale 32768.0 |speed 163.51 samples/(min*GPU)
[2024-06-17 06:49:18,865] [INFO] [RANK 0] time (ms) | forward: 356.88 | backward: 542.78 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 16.47 | data loader: 0.11
[2024-06-17 06:49:27,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=3660, skipped=17, lr=[9.428647359903e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:49:27,905] [INFO] [timer.py:258:stop] epoch=0/micro_step=3660/global_step=3660, RunningAvgSamplesPerSec=4.498941924541825, CurrSamplesPerSec=4.502246398007734, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:49:36,947] [INFO] [logging.py:96:log_dist] [Rank 0] step=3670, skipped=17, lr=[9.425195437915124e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:49:36,947] [INFO] [timer.py:258:stop] epoch=0/micro_step=3670/global_step=3670, RunningAvgSamplesPerSec=4.498945623908609, CurrSamplesPerSec=4.505886018155449, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:49:46,006] [INFO] [logging.py:96:log_dist] [Rank 0] step=3680, skipped=17, lr=[9.421733830897698e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:49:46,007] [INFO] [timer.py:258:stop] epoch=0/micro_step=3680/global_step=3680, RunningAvgSamplesPerSec=4.498935818606085, CurrSamplesPerSec=4.497180084318695, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:49:55,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=3690, skipped=17, lr=[9.418262547391892e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:49:55,055] [INFO] [timer.py:258:stop] epoch=0/micro_step=3690/global_step=3690, RunningAvgSamplesPerSec=4.498933855584381, CurrSamplesPerSec=4.495326817332441, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:50:04,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=17, lr=[9.414781595962753e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:50:04,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=4.498916150599156, CurrSamplesPerSec=4.495777341166609, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:50:04,111] [INFO] [RANK 0]  iteration     3700/   20000 | elapsed time per iteration (ms): 904.9 | learning rate 9.414E-05 | total loss 5.177197E-01 | loss 5.177197E-01 | loss scale 32768.0 |speed 265.21 samples/(min*GPU)
[2024-06-17 06:50:04,112] [INFO] [RANK 0] time (ms) | forward: 356.12 | backward: 544.68 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 14.97 | data loader: 0.11
[2024-06-17 06:50:13,150] [INFO] [logging.py:96:log_dist] [Rank 0] step=3710, skipped=17, lr=[9.411290985199183e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:50:13,151] [INFO] [timer.py:258:stop] epoch=0/micro_step=3710/global_step=3710, RunningAvgSamplesPerSec=4.498914913319335, CurrSamplesPerSec=4.495886974261733, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:50:22,235] [INFO] [logging.py:96:log_dist] [Rank 0] step=3720, skipped=17, lr=[9.407790723713919e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:50:22,236] [INFO] [timer.py:258:stop] epoch=0/micro_step=3720/global_step=3720, RunningAvgSamplesPerSec=4.498884948353714, CurrSamplesPerSec=4.493188663287556, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:50:31,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=3730, skipped=17, lr=[9.404280820143504e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:50:31,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=3730/global_step=3730, RunningAvgSamplesPerSec=4.498867134914972, CurrSamplesPerSec=4.489168285051158, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:50:40,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=3740, skipped=17, lr=[9.400761283148278e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:50:40,346] [INFO] [timer.py:258:stop] epoch=0/micro_step=3740/global_step=3740, RunningAvgSamplesPerSec=4.49885461681041, CurrSamplesPerSec=4.488008234908909, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:50:49,420] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=17, lr=[9.39723212141235e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:50:49,421] [INFO] [timer.py:258:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=4.498832577374906, CurrSamplesPerSec=4.489771363671883, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:50:49,422] [INFO] [RANK 0]  iteration     3750/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 9.397E-05 | total loss 5.845160E-01 | loss 5.845160E-01 | loss scale 32768.0 |speed 264.84 samples/(min*GPU)
[2024-06-17 06:50:49,423] [INFO] [RANK 0] time (ms) | forward: 356.98 | backward: 545.13 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.28 | data loader: 0.10
[2024-06-17 06:50:58,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=3760, skipped=17, lr=[9.393693343643576e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:50:58,502] [INFO] [timer.py:258:stop] epoch=0/micro_step=3760/global_step=3760, RunningAvgSamplesPerSec=4.498823035879401, CurrSamplesPerSec=4.486655600598926, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:51:07,582] [INFO] [logging.py:96:log_dist] [Rank 0] step=3770, skipped=17, lr=[9.390144958573535e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:51:07,583] [INFO] [timer.py:258:stop] epoch=0/micro_step=3770/global_step=3770, RunningAvgSamplesPerSec=4.498794852685619, CurrSamplesPerSec=4.490970794209273, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:51:16,631] [INFO] [logging.py:96:log_dist] [Rank 0] step=3780, skipped=17, lr=[9.386586974957517e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:51:16,631] [INFO] [timer.py:258:stop] epoch=0/micro_step=3780/global_step=3780, RunningAvgSamplesPerSec=4.498777698090396, CurrSamplesPerSec=4.495332839782849, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:51:25,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=3790, skipped=17, lr=[9.383019401574495e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:51:25,691] [INFO] [timer.py:258:stop] epoch=0/micro_step=3790/global_step=3790, RunningAvgSamplesPerSec=4.498745889514177, CurrSamplesPerSec=4.458162581465316, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:51:34,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=17, lr=[9.379442247227097e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:51:34,751] [INFO] [timer.py:258:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=4.498729851493641, CurrSamplesPerSec=4.472711267370956, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:51:34,752] [INFO] [RANK 0]  iteration     3800/   20000 | elapsed time per iteration (ms): 906.6 | learning rate 9.379E-05 | total loss 5.657031E-01 | loss 5.657031E-01 | loss scale 32768.0 |speed 264.72 samples/(min*GPU)
[2024-06-17 06:51:34,754] [INFO] [RANK 0] time (ms) | forward: 357.36 | backward: 544.97 | allreduce: 0.00 | optimizer: 3.47 | batch generator: 15.33 | data loader: 0.14
[2024-06-17 06:51:43,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=3810, skipped=17, lr=[9.375855520741598e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:51:43,809] [INFO] [timer.py:258:stop] epoch=0/micro_step=3810/global_step=3810, RunningAvgSamplesPerSec=4.498721569332332, CurrSamplesPerSec=4.495053415079361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:51:52,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=3820, skipped=17, lr=[9.372259230967889e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:51:52,869] [INFO] [timer.py:258:stop] epoch=0/micro_step=3820/global_step=3820, RunningAvgSamplesPerSec=4.498694538168111, CurrSamplesPerSec=4.460948260366911, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:52:01,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=3830, skipped=17, lr=[9.368653386779457e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:52:01,947] [INFO] [timer.py:258:stop] epoch=0/micro_step=3830/global_step=3830, RunningAvgSamplesPerSec=4.49867745353561, CurrSamplesPerSec=4.494698162279635, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:52:10,992] [INFO] [logging.py:96:log_dist] [Rank 0] step=3840, skipped=17, lr=[9.365037997073366e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:52:10,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=3840/global_step=3840, RunningAvgSamplesPerSec=4.498668562248232, CurrSamplesPerSec=4.493390833997098, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:52:20,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=17, lr=[9.361413070770229e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:52:20,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=4.498666878694819, CurrSamplesPerSec=4.487938602944127, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:52:20,050] [INFO] [RANK 0]  iteration     3850/   20000 | elapsed time per iteration (ms): 906.0 | learning rate 9.361E-05 | total loss 4.648462E-01 | loss 4.648462E-01 | loss scale 32768.0 |speed 264.91 samples/(min*GPU)
[2024-06-17 06:52:20,051] [INFO] [RANK 0] time (ms) | forward: 356.64 | backward: 545.28 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.32 | data loader: 0.10
[2024-06-17 06:52:29,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=3860, skipped=17, lr=[9.357778616814191e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:52:29,120] [INFO] [timer.py:258:stop] epoch=0/micro_step=3860/global_step=3860, RunningAvgSamplesPerSec=4.498650052592807, CurrSamplesPerSec=4.479950098212102, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:52:38,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=3870, skipped=17, lr=[9.354134644172906e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:52:38,181] [INFO] [timer.py:258:stop] epoch=0/micro_step=3870/global_step=3870, RunningAvgSamplesPerSec=4.498635281744609, CurrSamplesPerSec=4.486348461004676, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:52:47,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=3880, skipped=17, lr=[9.350481161837517e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:52:47,225] [INFO] [timer.py:258:stop] epoch=0/micro_step=3880/global_step=3880, RunningAvgSamplesPerSec=4.498612322571275, CurrSamplesPerSec=4.499016782937369, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:52:56,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=3890, skipped=17, lr=[9.346818178822624e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:52:56,290] [INFO] [timer.py:258:stop] epoch=0/micro_step=3890/global_step=3890, RunningAvgSamplesPerSec=4.498594230677959, CurrSamplesPerSec=4.493932452326411, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:53:05,351] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=17, lr=[9.343145704166276e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:53:05,352] [INFO] [timer.py:258:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=4.498568880198637, CurrSamplesPerSec=4.4916561272822095, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:53:05,353] [INFO] [RANK 0]  iteration     3900/   20000 | elapsed time per iteration (ms): 906.1 | learning rate 9.343E-05 | total loss 5.297681E-01 | loss 5.297681E-01 | loss scale 32768.0 |speed 264.88 samples/(min*GPU)
[2024-06-17 06:53:05,354] [INFO] [RANK 0] time (ms) | forward: 356.32 | backward: 545.42 | allreduce: 0.00 | optimizer: 3.53 | batch generator: 14.56 | data loader: 0.13
[2024-06-17 06:53:05,354] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:53:05,372] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/3900/mp_rank_00_model_states.pt
[2024-06-17 06:53:05,372] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/3900/mp_rank_00_model_states.pt...
[2024-06-17 06:53:33,356] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/3900/mp_rank_00_model_states.pt.
[2024-06-17 06:53:42,443] [INFO] [logging.py:96:log_dist] [Rank 0] step=3910, skipped=17, lr=[9.339463746929941e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:53:42,444] [INFO] [timer.py:258:stop] epoch=0/micro_step=3910/global_step=3910, RunningAvgSamplesPerSec=4.498577610198173, CurrSamplesPerSec=4.531604951343339, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:53:51,445] [INFO] [logging.py:96:log_dist] [Rank 0] step=3920, skipped=17, lr=[9.335772316198477e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:53:51,446] [INFO] [timer.py:258:stop] epoch=0/micro_step=3920/global_step=3920, RunningAvgSamplesPerSec=4.498638003693476, CurrSamplesPerSec=4.522809200672442, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:54:00,448] [INFO] [logging.py:96:log_dist] [Rank 0] step=3930, skipped=17, lr=[9.332071421080127e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:54:00,448] [INFO] [timer.py:258:stop] epoch=0/micro_step=3930/global_step=3930, RunningAvgSamplesPerSec=4.498684461853043, CurrSamplesPerSec=4.5105378055468925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:54:09,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=3940, skipped=17, lr=[9.32836107070648e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:54:09,474] [INFO] [timer.py:258:stop] epoch=0/micro_step=3940/global_step=3940, RunningAvgSamplesPerSec=4.498707733630825, CurrSamplesPerSec=4.51217548228852, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:54:18,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=17, lr=[9.324641274232458e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:54:18,511] [INFO] [timer.py:258:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=4.498720535729181, CurrSamplesPerSec=4.494786067065942, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:54:18,513] [INFO] [RANK 0]  iteration     3950/   20000 | elapsed time per iteration (ms): 1463.2 | learning rate 9.324E-05 | total loss 5.437231E-01 | loss 5.437231E-01 | loss scale 32768.0 |speed 164.02 samples/(min*GPU)
[2024-06-17 06:54:18,514] [INFO] [RANK 0] time (ms) | forward: 355.72 | backward: 543.09 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 15.53 | data loader: 0.10
[2024-06-17 06:54:21,234] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 06:54:22,136] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 06:54:27,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=3960, skipped=19, lr=[9.321658642027956e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:54:27,558] [INFO] [timer.py:258:stop] epoch=0/micro_step=3960/global_step=3960, RunningAvgSamplesPerSec=4.498733086075916, CurrSamplesPerSec=4.502854204358831, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:54:36,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=3970, skipped=19, lr=[9.31792186571804e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:54:36,600] [INFO] [timer.py:258:stop] epoch=0/micro_step=3970/global_step=3970, RunningAvgSamplesPerSec=4.498740505657279, CurrSamplesPerSec=4.493543677501797, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:54:45,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=3980, skipped=19, lr=[9.314175669065449e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:54:45,647] [INFO] [timer.py:258:stop] epoch=0/micro_step=3980/global_step=3980, RunningAvgSamplesPerSec=4.498743300421488, CurrSamplesPerSec=4.503221626136762, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:54:54,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=3990, skipped=19, lr=[9.310420061313551e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:54:54,699] [INFO] [timer.py:258:stop] epoch=0/micro_step=3990/global_step=3990, RunningAvgSamplesPerSec=4.498746903940343, CurrSamplesPerSec=4.504141652182831, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:55:03,747] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=19, lr=[9.306655051728934e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:55:03,748] [INFO] [timer.py:258:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=4.498750648149269, CurrSamplesPerSec=4.500635236754455, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:55:03,748] [INFO] [RANK 0]  iteration     4000/   20000 | elapsed time per iteration (ms): 904.7 | learning rate 9.306E-05 | total loss 5.534106E-01 | loss 5.534106E-01 | loss scale 32768.0 |speed 265.28 samples/(min*GPU)
[2024-06-17 06:55:03,749] [INFO] [RANK 0] time (ms) | forward: 356.36 | backward: 544.41 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 15.51 | data loader: 0.13
[2024-06-17 06:55:10,393] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 06:55:10,393] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 06:55:10,393] [INFO] [RANK 0]  validation loss at iteration 4000 | loss: 8.953125E-01 | PPL: 2.448101E+00 loss 8.945312E-01 |
[2024-06-17 06:55:10,393] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 06:55:19,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=4010, skipped=19, lr=[9.302880649601386e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:55:19,458] [INFO] [timer.py:258:stop] epoch=0/micro_step=4010/global_step=4010, RunningAvgSamplesPerSec=4.498745606465154, CurrSamplesPerSec=4.492597899589574, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:55:28,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=4020, skipped=19, lr=[9.299096864243867e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:55:28,497] [INFO] [timer.py:258:stop] epoch=0/micro_step=4020/global_step=4020, RunningAvgSamplesPerSec=4.498741307434236, CurrSamplesPerSec=4.505506061958571, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:55:37,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=4030, skipped=19, lr=[9.295303704992493e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:55:37,562] [INFO] [timer.py:258:stop] epoch=0/micro_step=4030/global_step=4030, RunningAvgSamplesPerSec=4.498733598885086, CurrSamplesPerSec=4.4834830525346705, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:55:46,634] [INFO] [logging.py:96:log_dist] [Rank 0] step=4040, skipped=19, lr=[9.291501181206507e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:55:46,635] [INFO] [timer.py:258:stop] epoch=0/micro_step=4040/global_step=4040, RunningAvgSamplesPerSec=4.498719600647923, CurrSamplesPerSec=4.492787985823143, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:55:55,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=19, lr=[9.287689302268257e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:55:55,690] [INFO] [timer.py:258:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=4.498704145904279, CurrSamplesPerSec=4.480500446522042, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:55:55,692] [INFO] [RANK 0]  iteration     4050/   20000 | elapsed time per iteration (ms): 1038.9 | learning rate 9.287E-05 | total loss 4.758142E-01 | loss 4.758142E-01 | loss scale 32768.0 |speed 231.02 samples/(min*GPU)
[2024-06-17 06:55:55,692] [INFO] [RANK 0] time (ms) | forward: 356.64 | backward: 545.32 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 18.87 | data loader: 0.13
[2024-06-17 06:56:04,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=4060, skipped=19, lr=[9.283868077583178e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:56:04,747] [INFO] [timer.py:258:stop] epoch=0/micro_step=4060/global_step=4060, RunningAvgSamplesPerSec=4.4986871449777865, CurrSamplesPerSec=4.493015388587133, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:56:13,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=4070, skipped=19, lr=[9.280037516579762e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:56:13,808] [INFO] [timer.py:258:stop] epoch=0/micro_step=4070/global_step=4070, RunningAvgSamplesPerSec=4.49867741623509, CurrSamplesPerSec=4.50211470812305, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:56:22,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=4080, skipped=19, lr=[9.276197628709533e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:56:22,861] [INFO] [timer.py:258:stop] epoch=0/micro_step=4080/global_step=4080, RunningAvgSamplesPerSec=4.498663681584127, CurrSamplesPerSec=4.496487039097252, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:56:31,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=4090, skipped=19, lr=[9.272348423447038e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:56:31,916] [INFO] [timer.py:258:stop] epoch=0/micro_step=4090/global_step=4090, RunningAvgSamplesPerSec=4.498669129894764, CurrSamplesPerSec=4.492623163288696, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:56:40,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=19, lr=[9.268489910289806e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:56:40,952] [INFO] [timer.py:258:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=4.4986558110471035, CurrSamplesPerSec=4.487733321278462, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:56:40,953] [INFO] [RANK 0]  iteration     4100/   20000 | elapsed time per iteration (ms): 905.2 | learning rate 9.268E-05 | total loss 5.232446E-01 | loss 5.232446E-01 | loss scale 32768.0 |speed 265.12 samples/(min*GPU)
[2024-06-17 06:56:40,954] [INFO] [RANK 0] time (ms) | forward: 355.80 | backward: 545.36 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 14.73 | data loader: 0.10
[2024-06-17 06:56:50,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=4110, skipped=19, lr=[9.264622098758334e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:56:50,027] [INFO] [timer.py:258:stop] epoch=0/micro_step=4110/global_step=4110, RunningAvgSamplesPerSec=4.4986337926234485, CurrSamplesPerSec=4.495424383015837, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:56:59,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=4120, skipped=19, lr=[9.260744998396066e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:56:59,077] [INFO] [timer.py:258:stop] epoch=0/micro_step=4120/global_step=4120, RunningAvgSamplesPerSec=4.498622344813964, CurrSamplesPerSec=4.491854552211214, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:57:08,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=4130, skipped=19, lr=[9.256858618769356e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:57:08,135] [INFO] [timer.py:258:stop] epoch=0/micro_step=4130/global_step=4130, RunningAvgSamplesPerSec=4.498609575334186, CurrSamplesPerSec=4.49327169548453, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:57:17,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=4140, skipped=19, lr=[9.252962969467465e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:57:17,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=4140/global_step=4140, RunningAvgSamplesPerSec=4.498601236411667, CurrSamplesPerSec=4.490538060011895, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:57:26,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=19, lr=[9.249058060102517e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:57:26,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=4.498580340877564, CurrSamplesPerSec=4.495018489433882, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:57:26,277] [INFO] [RANK 0]  iteration     4150/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 9.249E-05 | total loss 5.287048E-01 | loss 5.287048E-01 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 06:57:26,278] [INFO] [RANK 0] time (ms) | forward: 357.02 | backward: 545.40 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 15.54 | data loader: 0.10
[2024-06-17 06:57:35,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=4160, skipped=19, lr=[9.245143900309489e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:57:35,324] [INFO] [timer.py:258:stop] epoch=0/micro_step=4160/global_step=4160, RunningAvgSamplesPerSec=4.498564126673006, CurrSamplesPerSec=4.4946271184579, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:57:44,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=4170, skipped=19, lr=[9.241220499746179e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:57:44,410] [INFO] [timer.py:258:stop] epoch=0/micro_step=4170/global_step=4170, RunningAvgSamplesPerSec=4.498534803379665, CurrSamplesPerSec=4.492256266037111, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:57:53,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=4180, skipped=19, lr=[9.237287868093192e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:57:53,466] [INFO] [timer.py:258:stop] epoch=0/micro_step=4180/global_step=4180, RunningAvgSamplesPerSec=4.498514433449429, CurrSamplesPerSec=4.491141506746931, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:58:02,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=4190, skipped=19, lr=[9.233346015053901e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:58:02,531] [INFO] [timer.py:258:stop] epoch=0/micro_step=4190/global_step=4190, RunningAvgSamplesPerSec=4.498497791062478, CurrSamplesPerSec=4.48584705001266, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:58:11,592] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=19, lr=[9.22939495035444e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:58:11,593] [INFO] [timer.py:258:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=4.498484880243074, CurrSamplesPerSec=4.497808228065458, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:58:11,594] [INFO] [RANK 0]  iteration     4200/   20000 | elapsed time per iteration (ms): 906.3 | learning rate 9.229E-05 | total loss 4.401343E-01 | loss 4.401343E-01 | loss scale 32768.0 |speed 264.80 samples/(min*GPU)
[2024-06-17 06:58:11,595] [INFO] [RANK 0] time (ms) | forward: 356.68 | backward: 545.55 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 15.02 | data loader: 0.10
[2024-06-17 06:58:11,595] [INFO] [RANK 0] Saving Model...
[2024-06-17 06:58:11,608] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/4200/mp_rank_00_model_states.pt
[2024-06-17 06:58:11,609] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/4200/mp_rank_00_model_states.pt...
[2024-06-17 06:58:41,915] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/4200/mp_rank_00_model_states.pt.
[2024-06-17 06:58:50,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=4210, skipped=19, lr=[9.225434683743666e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:58:50,933] [INFO] [timer.py:258:stop] epoch=0/micro_step=4210/global_step=4210, RunningAvgSamplesPerSec=4.498584002645599, CurrSamplesPerSec=4.538159187064046, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:58:59,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=4220, skipped=19, lr=[9.221465224993147e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:58:59,931] [INFO] [timer.py:258:stop] epoch=0/micro_step=4220/global_step=4220, RunningAvgSamplesPerSec=4.498637600512111, CurrSamplesPerSec=4.51720876333141, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:59:08,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=4230, skipped=19, lr=[9.217486583897124e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:59:08,953] [INFO] [timer.py:258:stop] epoch=0/micro_step=4230/global_step=4230, RunningAvgSamplesPerSec=4.498680690939207, CurrSamplesPerSec=4.515876154020699, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:59:17,968] [INFO] [logging.py:96:log_dist] [Rank 0] step=4240, skipped=19, lr=[9.213498770272498e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:59:17,969] [INFO] [timer.py:258:stop] epoch=0/micro_step=4240/global_step=4240, RunningAvgSamplesPerSec=4.4987091618024655, CurrSamplesPerSec=4.5037631991152045, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:59:26,994] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=19, lr=[9.209501793958807e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:59:26,995] [INFO] [timer.py:258:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=4.498737030424699, CurrSamplesPerSec=4.503342501670244, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:59:26,996] [INFO] [RANK 0]  iteration     4250/   20000 | elapsed time per iteration (ms): 1508.0 | learning rate 9.209E-05 | total loss 5.078003E-01 | loss 5.078003E-01 | loss scale 32768.0 |speed 159.15 samples/(min*GPU)
[2024-06-17 06:59:26,997] [INFO] [RANK 0] time (ms) | forward: 355.32 | backward: 541.97 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 15.71 | data loader: 0.10
[2024-06-17 06:59:36,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=4260, skipped=19, lr=[9.205495664818188e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:59:36,030] [INFO] [timer.py:258:stop] epoch=0/micro_step=4260/global_step=4260, RunningAvgSamplesPerSec=4.498743025446625, CurrSamplesPerSec=4.500660590929101, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:59:45,064] [INFO] [logging.py:96:log_dist] [Rank 0] step=4270, skipped=19, lr=[9.20148039273537e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:59:45,065] [INFO] [timer.py:258:stop] epoch=0/micro_step=4270/global_step=4270, RunningAvgSamplesPerSec=4.498735773752598, CurrSamplesPerSec=4.488781535043456, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 06:59:54,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=4280, skipped=19, lr=[9.197455987617636e-05], mom=[[0.9, 0.95]]
[2024-06-17 06:59:54,097] [INFO] [timer.py:258:stop] epoch=0/micro_step=4280/global_step=4280, RunningAvgSamplesPerSec=4.498730814084123, CurrSamplesPerSec=4.505575030138383, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:00:03,136] [INFO] [logging.py:96:log_dist] [Rank 0] step=4290, skipped=19, lr=[9.193422459394806e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:00:03,136] [INFO] [timer.py:258:stop] epoch=0/micro_step=4290/global_step=4290, RunningAvgSamplesPerSec=4.498739417368184, CurrSamplesPerSec=4.506859191811306, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:00:12,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=19, lr=[9.189379818019209e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:00:12,188] [INFO] [timer.py:258:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=4.498725690177995, CurrSamplesPerSec=4.498369003614844, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:00:12,189] [INFO] [RANK 0]  iteration     4300/   20000 | elapsed time per iteration (ms): 903.9 | learning rate 9.189E-05 | total loss 5.535132E-01 | loss 5.535132E-01 | loss scale 32768.0 |speed 265.53 samples/(min*GPU)
[2024-06-17 07:00:12,190] [INFO] [RANK 0] time (ms) | forward: 355.42 | backward: 544.49 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.03 | data loader: 0.10
[2024-06-17 07:00:21,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=4310, skipped=19, lr=[9.185328073465661e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:00:21,254] [INFO] [timer.py:258:stop] epoch=0/micro_step=4310/global_step=4310, RunningAvgSamplesPerSec=4.498721088653089, CurrSamplesPerSec=4.486131329088539, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:00:30,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=4320, skipped=19, lr=[9.18126723573144e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:00:30,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=4320/global_step=4320, RunningAvgSamplesPerSec=4.4987119818758226, CurrSamplesPerSec=4.483607663591314, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:00:39,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=4330, skipped=19, lr=[9.177197314836259e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:00:39,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=4330/global_step=4330, RunningAvgSamplesPerSec=4.498702586656845, CurrSamplesPerSec=4.496791952676679, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:00:48,355] [INFO] [logging.py:96:log_dist] [Rank 0] step=4340, skipped=19, lr=[9.173118320822243e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:00:48,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=4340/global_step=4340, RunningAvgSamplesPerSec=4.498691824114258, CurrSamplesPerSec=4.49719696112737, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:00:57,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=19, lr=[9.169030263753904e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:00:57,409] [INFO] [timer.py:258:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=4.498677098592119, CurrSamplesPerSec=4.493821710849853, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:00:57,410] [INFO] [RANK 0]  iteration     4350/   20000 | elapsed time per iteration (ms): 904.4 | learning rate 9.169E-05 | total loss 4.609814E-01 | loss 4.609814E-01 | loss scale 32768.0 |speed 265.36 samples/(min*GPU)
[2024-06-17 07:00:57,411] [INFO] [RANK 0] time (ms) | forward: 355.28 | backward: 545.09 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 13.87 | data loader: 0.10
[2024-06-17 07:01:01,920] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 07:01:02,827] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 07:01:06,454] [INFO] [logging.py:96:log_dist] [Rank 0] step=4360, skipped=21, lr=[9.165753299477751e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:01:06,455] [INFO] [timer.py:258:stop] epoch=0/micro_step=4360/global_step=4360, RunningAvgSamplesPerSec=4.498672689967843, CurrSamplesPerSec=4.495454496736369, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:01:15,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=4370, skipped=21, lr=[9.161648954345564e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:01:15,515] [INFO] [timer.py:258:stop] epoch=0/micro_step=4370/global_step=4370, RunningAvgSamplesPerSec=4.498656788057901, CurrSamplesPerSec=4.49626892471493, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:01:24,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=4380, skipped=21, lr=[9.15753557445858e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:01:24,564] [INFO] [timer.py:258:stop] epoch=0/micro_step=4380/global_step=4380, RunningAvgSamplesPerSec=4.498644704721504, CurrSamplesPerSec=4.490568108303282, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:01:33,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=4390, skipped=21, lr=[9.153413169966148e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:01:33,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=4390/global_step=4390, RunningAvgSamplesPerSec=4.498630279123447, CurrSamplesPerSec=4.493911988816391, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:01:42,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=21, lr=[9.149281751039896e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:01:42,657] [INFO] [timer.py:258:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=4.498612011931346, CurrSamplesPerSec=4.493493129680215, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:01:42,659] [INFO] [RANK 0]  iteration     4400/   20000 | elapsed time per iteration (ms): 905.0 | learning rate 9.149E-05 | total loss 5.020361E-01 | loss 5.020361E-01 | loss scale 32768.0 |speed 265.20 samples/(min*GPU)
[2024-06-17 07:01:42,659] [INFO] [RANK 0] time (ms) | forward: 355.77 | backward: 545.23 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.15 | data loader: 0.12
[2024-06-17 07:01:51,725] [INFO] [logging.py:96:log_dist] [Rank 0] step=4410, skipped=21, lr=[9.145141327873686e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:01:51,725] [INFO] [timer.py:258:stop] epoch=0/micro_step=4410/global_step=4410, RunningAvgSamplesPerSec=4.498585171755573, CurrSamplesPerSec=4.497400698311854, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:02:00,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=4420, skipped=21, lr=[9.140991910683604e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:02:00,806] [INFO] [timer.py:258:stop] epoch=0/micro_step=4420/global_step=4420, RunningAvgSamplesPerSec=4.498550791536823, CurrSamplesPerSec=4.47000734822766, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:02:09,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=4430, skipped=21, lr=[9.136833509707922e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:02:09,907] [INFO] [timer.py:258:stop] epoch=0/micro_step=4430/global_step=4430, RunningAvgSamplesPerSec=4.49852547443359, CurrSamplesPerSec=4.500382917917689, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:02:18,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=4440, skipped=21, lr=[9.132666135207082e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:02:18,960] [INFO] [timer.py:258:stop] epoch=0/micro_step=4440/global_step=4440, RunningAvgSamplesPerSec=4.498511821042338, CurrSamplesPerSec=4.480200131010186, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:02:28,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=21, lr=[9.128489797463665e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:02:28,010] [INFO] [timer.py:258:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=4.498505346678895, CurrSamplesPerSec=4.503329205043921, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:02:28,011] [INFO] [RANK 0]  iteration     4450/   20000 | elapsed time per iteration (ms): 907.0 | learning rate 9.128E-05 | total loss 5.735693E-01 | loss 5.735693E-01 | loss scale 32768.0 |speed 264.60 samples/(min*GPU)
[2024-06-17 07:02:28,012] [INFO] [RANK 0] time (ms) | forward: 357.41 | backward: 545.62 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 15.48 | data loader: 0.11
[2024-06-17 07:02:37,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=4460, skipped=21, lr=[9.124304506782372e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:02:37,086] [INFO] [timer.py:258:stop] epoch=0/micro_step=4460/global_step=4460, RunningAvgSamplesPerSec=4.498471023382402, CurrSamplesPerSec=4.487769334247442, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:02:46,178] [INFO] [logging.py:96:log_dist] [Rank 0] step=4470, skipped=21, lr=[9.120110273489989e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:02:46,178] [INFO] [timer.py:258:stop] epoch=0/micro_step=4470/global_step=4470, RunningAvgSamplesPerSec=4.498433407203307, CurrSamplesPerSec=4.456504681168914, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:02:55,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=4480, skipped=21, lr=[9.115907107935372e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:02:55,245] [INFO] [timer.py:258:stop] epoch=0/micro_step=4480/global_step=4480, RunningAvgSamplesPerSec=4.498415573283533, CurrSamplesPerSec=4.483994720943944, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:03:04,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=4490, skipped=21, lr=[9.111695020489411e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:03:04,307] [INFO] [timer.py:258:stop] epoch=0/micro_step=4490/global_step=4490, RunningAvgSamplesPerSec=4.498399756373076, CurrSamplesPerSec=4.494282768369679, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:03:13,371] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=21, lr=[9.107474021545015e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:03:13,372] [INFO] [timer.py:258:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=4.498390061193876, CurrSamplesPerSec=4.497099318487941, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:03:13,374] [INFO] [RANK 0]  iteration     4500/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 9.107E-05 | total loss 4.973804E-01 | loss 4.973804E-01 | loss scale 32768.0 |speed 264.54 samples/(min*GPU)
[2024-06-17 07:03:13,374] [INFO] [RANK 0] time (ms) | forward: 357.67 | backward: 545.55 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 15.50 | data loader: 0.10
[2024-06-17 07:03:13,375] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:03:13,391] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/4500/mp_rank_00_model_states.pt
[2024-06-17 07:03:13,391] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/4500/mp_rank_00_model_states.pt...
[2024-06-17 07:03:37,657] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/4500/mp_rank_00_model_states.pt.
[2024-06-17 07:03:46,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=4510, skipped=21, lr=[9.10324412151708e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:03:46,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=4510/global_step=4510, RunningAvgSamplesPerSec=4.49845314618873, CurrSamplesPerSec=4.517543254980354, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:03:55,722] [INFO] [logging.py:96:log_dist] [Rank 0] step=4520, skipped=21, lr=[9.099005330842463e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:03:55,723] [INFO] [timer.py:258:stop] epoch=0/micro_step=4520/global_step=4520, RunningAvgSamplesPerSec=4.498488983381261, CurrSamplesPerSec=4.517177141229366, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:04:04,755] [INFO] [logging.py:96:log_dist] [Rank 0] step=4530, skipped=21, lr=[9.094757659979959e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:04:04,756] [INFO] [timer.py:258:stop] epoch=0/micro_step=4530/global_step=4530, RunningAvgSamplesPerSec=4.498529154680614, CurrSamplesPerSec=4.515321942319705, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:04:13,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=4540, skipped=21, lr=[9.090501119410274e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:04:13,774] [INFO] [timer.py:258:stop] epoch=0/micro_step=4540/global_step=4540, RunningAvgSamplesPerSec=4.498555444744572, CurrSamplesPerSec=4.508605663726898, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:04:22,801] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=21, lr=[9.086235719635996e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:04:22,801] [INFO] [timer.py:258:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=4.498578922718434, CurrSamplesPerSec=4.5102868002216265, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:04:22,803] [INFO] [RANK 0]  iteration     4550/   20000 | elapsed time per iteration (ms): 1388.6 | learning rate 9.086E-05 | total loss 4.773993E-01 | loss 4.773993E-01 | loss scale 32768.0 |speed 172.84 samples/(min*GPU)
[2024-06-17 07:04:22,804] [INFO] [RANK 0] time (ms) | forward: 356.17 | backward: 542.45 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 16.31 | data loader: 0.10
[2024-06-17 07:04:31,851] [INFO] [logging.py:96:log_dist] [Rank 0] step=4560, skipped=21, lr=[9.081961471181579e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:04:31,852] [INFO] [timer.py:258:stop] epoch=0/micro_step=4560/global_step=4560, RunningAvgSamplesPerSec=4.498588412917232, CurrSamplesPerSec=4.508688055046296, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:04:40,895] [INFO] [logging.py:96:log_dist] [Rank 0] step=4570, skipped=21, lr=[9.077678384593303e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:04:40,896] [INFO] [timer.py:258:stop] epoch=0/micro_step=4570/global_step=4570, RunningAvgSamplesPerSec=4.498595272199962, CurrSamplesPerSec=4.488316802546834, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:04:49,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=4580, skipped=21, lr=[9.073386470439259e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:04:49,933] [INFO] [timer.py:258:stop] epoch=0/micro_step=4580/global_step=4580, RunningAvgSamplesPerSec=4.498591590004435, CurrSamplesPerSec=4.497932430809355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:04:58,986] [INFO] [logging.py:96:log_dist] [Rank 0] step=4590, skipped=21, lr=[9.069085739309321e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:04:58,987] [INFO] [timer.py:258:stop] epoch=0/micro_step=4590/global_step=4590, RunningAvgSamplesPerSec=4.498583654192149, CurrSamplesPerSec=4.498522185979603, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:05:08,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=21, lr=[9.064776201815114e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:05:08,037] [INFO] [timer.py:258:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=4.498580645273016, CurrSamplesPerSec=4.485436888012566, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:05:08,037] [INFO] [RANK 0]  iteration     4600/   20000 | elapsed time per iteration (ms): 904.7 | learning rate 9.064E-05 | total loss 5.178394E-01 | loss 5.178394E-01 | loss scale 32768.0 |speed 265.28 samples/(min*GPU)
[2024-06-17 07:05:08,038] [INFO] [RANK 0] time (ms) | forward: 356.24 | backward: 544.47 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 15.03 | data loader: 0.11
[2024-06-17 07:05:17,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=4610, skipped=21, lr=[9.06045786858999e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:05:17,097] [INFO] [timer.py:258:stop] epoch=0/micro_step=4610/global_step=4610, RunningAvgSamplesPerSec=4.498572538123362, CurrSamplesPerSec=4.495005241917227, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:05:26,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=4620, skipped=21, lr=[9.056130750289011e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:05:26,167] [INFO] [timer.py:258:stop] epoch=0/micro_step=4620/global_step=4620, RunningAvgSamplesPerSec=4.498558181637585, CurrSamplesPerSec=4.49632074002746, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:05:35,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=4630, skipped=21, lr=[9.05179485758891e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:05:35,237] [INFO] [timer.py:258:stop] epoch=0/micro_step=4630/global_step=4630, RunningAvgSamplesPerSec=4.498546377120436, CurrSamplesPerSec=4.493353527318793, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:05:44,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=4640, skipped=21, lr=[9.047450201188072e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:05:44,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=4640/global_step=4640, RunningAvgSamplesPerSec=4.498530930826904, CurrSamplesPerSec=4.486197306177085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:05:53,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=21, lr=[9.043096791806503e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:05:53,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=4.498516638965042, CurrSamplesPerSec=4.4881559098463955, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:05:53,361] [INFO] [RANK 0]  iteration     4650/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 9.043E-05 | total loss 4.924036E-01 | loss 4.924036E-01 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 07:05:53,362] [INFO] [RANK 0] time (ms) | forward: 357.24 | backward: 545.19 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 15.56 | data loader: 0.11
[2024-06-17 07:06:02,426] [INFO] [logging.py:96:log_dist] [Rank 0] step=4660, skipped=21, lr=[9.038734640185813e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:06:02,427] [INFO] [timer.py:258:stop] epoch=0/micro_step=4660/global_step=4660, RunningAvgSamplesPerSec=4.498502764614991, CurrSamplesPerSec=4.487189595695434, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:06:11,512] [INFO] [logging.py:96:log_dist] [Rank 0] step=4670, skipped=21, lr=[9.03436375708917e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:06:11,512] [INFO] [timer.py:258:stop] epoch=0/micro_step=4670/global_step=4670, RunningAvgSamplesPerSec=4.498477616658348, CurrSamplesPerSec=4.461217529484687, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:06:20,587] [INFO] [logging.py:96:log_dist] [Rank 0] step=4680, skipped=21, lr=[9.029984153301299e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:06:20,587] [INFO] [timer.py:258:stop] epoch=0/micro_step=4680/global_step=4680, RunningAvgSamplesPerSec=4.49845674908599, CurrSamplesPerSec=4.488356427146274, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:06:29,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=4690, skipped=21, lr=[9.025595839628433e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:06:29,647] [INFO] [timer.py:258:stop] epoch=0/micro_step=4690/global_step=4690, RunningAvgSamplesPerSec=4.49844737443286, CurrSamplesPerSec=4.479106891947777, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:06:38,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=21, lr=[9.021198826898301e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:06:38,704] [INFO] [timer.py:258:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=4.498436125231358, CurrSamplesPerSec=4.5017076055527765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:06:38,706] [INFO] [RANK 0]  iteration     4700/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 9.021E-05 | total loss 5.488904E-01 | loss 5.488904E-01 | loss scale 32768.0 |speed 264.64 samples/(min*GPU)
[2024-06-17 07:06:38,706] [INFO] [RANK 0] time (ms) | forward: 357.29 | backward: 545.57 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 15.56 | data loader: 0.11
[2024-06-17 07:06:47,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=4710, skipped=21, lr=[9.016793125960097e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:06:47,777] [INFO] [timer.py:258:stop] epoch=0/micro_step=4710/global_step=4710, RunningAvgSamplesPerSec=4.498423457690265, CurrSamplesPerSec=4.495137720597711, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:06:56,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=4720, skipped=21, lr=[9.01237874768445e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:06:56,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=4720/global_step=4720, RunningAvgSamplesPerSec=4.49841609695592, CurrSamplesPerSec=4.483677161227769, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:07:05,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=4730, skipped=21, lr=[9.007955702963397e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:07:05,872] [INFO] [timer.py:258:stop] epoch=0/micro_step=4730/global_step=4730, RunningAvgSamplesPerSec=4.498410278630034, CurrSamplesPerSec=4.4925810572813445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:07:14,935] [INFO] [logging.py:96:log_dist] [Rank 0] step=4740, skipped=21, lr=[9.003524002710365e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:07:14,935] [INFO] [timer.py:258:stop] epoch=0/micro_step=4740/global_step=4740, RunningAvgSamplesPerSec=4.498400410538689, CurrSamplesPerSec=4.494292399822663, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:07:23,978] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=21, lr=[8.999083657860129e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:07:23,978] [INFO] [timer.py:258:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=4.498393494218634, CurrSamplesPerSec=4.4970740044216955, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:07:23,980] [INFO] [RANK 0]  iteration     4750/   20000 | elapsed time per iteration (ms): 905.5 | learning rate 8.999E-05 | total loss 4.814087E-01 | loss 4.814087E-01 | loss scale 32768.0 |speed 265.05 samples/(min*GPU)
[2024-06-17 07:07:23,981] [INFO] [RANK 0] time (ms) | forward: 356.05 | backward: 545.47 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 14.99 | data loader: 0.09
[2024-06-17 07:07:30,330] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 07:07:31,238] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 07:07:33,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=4760, skipped=23, lr=[8.995525165231745e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:07:33,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=4760/global_step=4760, RunningAvgSamplesPerSec=4.49838024554665, CurrSamplesPerSec=4.495789388497981, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:07:42,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=4770, skipped=23, lr=[8.99106928773026e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:07:42,113] [INFO] [timer.py:258:stop] epoch=0/micro_step=4770/global_step=4770, RunningAvgSamplesPerSec=4.498363236864426, CurrSamplesPerSec=4.500421548632603, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:07:51,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=4780, skipped=23, lr=[8.986604796362343e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:07:51,199] [INFO] [timer.py:258:stop] epoch=0/micro_step=4780/global_step=4780, RunningAvgSamplesPerSec=4.498355153227876, CurrSamplesPerSec=4.495391860650809, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:08:00,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=4790, skipped=23, lr=[8.982131702143683e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:08:00,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=4790/global_step=4790, RunningAvgSamplesPerSec=4.498335339586377, CurrSamplesPerSec=4.484765439656129, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:08:09,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=23, lr=[8.977650016111199e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:08:09,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=4.498316163742613, CurrSamplesPerSec=4.487728519592935, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:08:09,348] [INFO] [RANK 0]  iteration     4800/   20000 | elapsed time per iteration (ms): 907.4 | learning rate 8.977E-05 | total loss 4.961475E-01 | loss 4.961475E-01 | loss scale 32768.0 |speed 264.51 samples/(min*GPU)
[2024-06-17 07:08:09,349] [INFO] [RANK 0] time (ms) | forward: 357.80 | backward: 545.50 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 16.11 | data loader: 0.11
[2024-06-17 07:08:09,349] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:08:09,366] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/4800/mp_rank_00_model_states.pt
[2024-06-17 07:08:09,366] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/4800/mp_rank_00_model_states.pt...
[2024-06-17 07:08:34,123] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/4800/mp_rank_00_model_states.pt.
[2024-06-17 07:08:43,106] [INFO] [logging.py:96:log_dist] [Rank 0] step=4810, skipped=23, lr=[8.973159749323002e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:08:43,107] [INFO] [timer.py:258:stop] epoch=0/micro_step=4810/global_step=4810, RunningAvgSamplesPerSec=4.498397668446387, CurrSamplesPerSec=4.526444298094504, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:08:52,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=4820, skipped=23, lr=[8.96866091285838e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:08:52,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=4820/global_step=4820, RunningAvgSamplesPerSec=4.498435990544608, CurrSamplesPerSec=4.514815249367874, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:09:01,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=4830, skipped=23, lr=[8.964153517817764e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:09:01,173] [INFO] [timer.py:258:stop] epoch=0/micro_step=4830/global_step=4830, RunningAvgSamplesPerSec=4.498462932739631, CurrSamplesPerSec=4.518801387001253, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:09:10,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=4840, skipped=23, lr=[8.959637575322706e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:09:10,188] [INFO] [timer.py:258:stop] epoch=0/micro_step=4840/global_step=4840, RunningAvgSamplesPerSec=4.498491232590769, CurrSamplesPerSec=4.503338875309824, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:09:19,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=23, lr=[8.955113096515843e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:09:19,204] [INFO] [timer.py:258:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=4.498506154604668, CurrSamplesPerSec=4.493256051502652, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:09:19,205] [INFO] [RANK 0]  iteration     4850/   20000 | elapsed time per iteration (ms): 1397.1 | learning rate 8.955E-05 | total loss 5.676196E-01 | loss 5.676196E-01 | loss scale 32768.0 |speed 171.78 samples/(min*GPU)
[2024-06-17 07:09:19,206] [INFO] [RANK 0] time (ms) | forward: 354.70 | backward: 542.61 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 15.26 | data loader: 0.10
[2024-06-17 07:09:28,265] [INFO] [logging.py:96:log_dist] [Rank 0] step=4860, skipped=23, lr=[8.950580092560877e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:09:28,265] [INFO] [timer.py:258:stop] epoch=0/micro_step=4860/global_step=4860, RunningAvgSamplesPerSec=4.498515405141546, CurrSamplesPerSec=4.491588787048371, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:09:37,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=4870, skipped=23, lr=[8.946038574642544e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:09:37,312] [INFO] [timer.py:258:stop] epoch=0/micro_step=4870/global_step=4870, RunningAvgSamplesPerSec=4.498508804071918, CurrSamplesPerSec=4.4927603140419645, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:09:46,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=4880, skipped=23, lr=[8.941488553966591e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:09:46,386] [INFO] [timer.py:258:stop] epoch=0/micro_step=4880/global_step=4880, RunningAvgSamplesPerSec=4.498507245995613, CurrSamplesPerSec=4.501896047441436, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:09:55,430] [INFO] [logging.py:96:log_dist] [Rank 0] step=4890, skipped=23, lr=[8.936930041759734e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:09:55,430] [INFO] [timer.py:258:stop] epoch=0/micro_step=4890/global_step=4890, RunningAvgSamplesPerSec=4.498503180737638, CurrSamplesPerSec=4.495066662879967, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:10:04,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=23, lr=[8.93236304926966e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:10:04,465] [INFO] [timer.py:258:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=4.498501751325981, CurrSamplesPerSec=4.494250262520627, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:10:04,466] [INFO] [RANK 0]  iteration     4900/   20000 | elapsed time per iteration (ms): 905.2 | learning rate 8.932E-05 | total loss 4.473535E-01 | loss 4.473535E-01 | loss scale 32768.0 |speed 265.13 samples/(min*GPU)
[2024-06-17 07:10:04,467] [INFO] [RANK 0] time (ms) | forward: 356.40 | backward: 544.68 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 15.31 | data loader: 0.11
[2024-06-17 07:10:13,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=4910, skipped=23, lr=[8.927787587764959e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:10:13,539] [INFO] [timer.py:258:stop] epoch=0/micro_step=4910/global_step=4910, RunningAvgSamplesPerSec=4.4984752200633755, CurrSamplesPerSec=4.463985649017694, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:10:22,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=4920, skipped=23, lr=[8.923203668535135e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:10:22,614] [INFO] [timer.py:258:stop] epoch=0/micro_step=4920/global_step=4920, RunningAvgSamplesPerSec=4.498452595757875, CurrSamplesPerSec=4.476892147701116, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:10:31,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=4930, skipped=23, lr=[8.918611302890546e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:10:31,691] [INFO] [timer.py:258:stop] epoch=0/micro_step=4930/global_step=4930, RunningAvgSamplesPerSec=4.498440154274604, CurrSamplesPerSec=4.4749481347999085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:10:40,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=4940, skipped=23, lr=[8.914010502162402e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:10:40,748] [INFO] [timer.py:258:stop] epoch=0/micro_step=4940/global_step=4940, RunningAvgSamplesPerSec=4.498426826029044, CurrSamplesPerSec=4.494228592215819, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:10:49,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=4950, skipped=23, lr=[8.909401277702721e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:10:49,792] [INFO] [timer.py:258:stop] epoch=0/micro_step=4950/global_step=4950, RunningAvgSamplesPerSec=4.498414535078541, CurrSamplesPerSec=4.487861770180138, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:10:49,794] [INFO] [RANK 0]  iteration     4950/   20000 | elapsed time per iteration (ms): 906.6 | learning rate 8.909E-05 | total loss 4.642126E-01 | loss 4.642126E-01 | loss scale 32768.0 |speed 264.74 samples/(min*GPU)
[2024-06-17 07:10:49,794] [INFO] [RANK 0] time (ms) | forward: 356.64 | backward: 545.87 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 15.10 | data loader: 0.10
[2024-06-17 07:10:58,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=4960, skipped=23, lr=[8.904783640884308e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:10:58,862] [INFO] [timer.py:258:stop] epoch=0/micro_step=4960/global_step=4960, RunningAvgSamplesPerSec=4.498390528738478, CurrSamplesPerSec=4.4611594025628, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:11:07,944] [INFO] [logging.py:96:log_dist] [Rank 0] step=4970, skipped=23, lr=[8.900157603100719e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:11:07,945] [INFO] [timer.py:258:stop] epoch=0/micro_step=4970/global_step=4970, RunningAvgSamplesPerSec=4.498378525859321, CurrSamplesPerSec=4.4988273756436294, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:11:17,015] [INFO] [logging.py:96:log_dist] [Rank 0] step=4980, skipped=23, lr=[8.895523175766244e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:11:17,015] [INFO] [timer.py:258:stop] epoch=0/micro_step=4980/global_step=4980, RunningAvgSamplesPerSec=4.498361261980265, CurrSamplesPerSec=4.499258089214337, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:11:26,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=4990, skipped=23, lr=[8.890880370315871e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:11:26,048] [INFO] [timer.py:258:stop] epoch=0/micro_step=4990/global_step=4990, RunningAvgSamplesPerSec=4.498360776242457, CurrSamplesPerSec=4.502187197014646, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:11:35,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=5000, skipped=23, lr=[8.886229198205264e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:11:35,104] [INFO] [timer.py:258:stop] epoch=0/micro_step=5000/global_step=5000, RunningAvgSamplesPerSec=4.498343531668557, CurrSamplesPerSec=4.4859478030315385, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:11:35,105] [INFO] [RANK 0]  iteration     5000/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 8.886E-05 | total loss 5.419165E-01 | loss 5.419165E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 07:11:35,106] [INFO] [RANK 0] time (ms) | forward: 356.63 | backward: 545.60 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 15.08 | data loader: 0.11
[2024-06-17 07:11:41,764] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 07:11:41,764] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 07:11:41,764] [INFO] [RANK 0]  validation loss at iteration 5000 | loss: 8.401855E-01 | PPL: 2.316797E+00 loss 8.408203E-01 |
[2024-06-17 07:11:41,764] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 07:11:50,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=5010, skipped=23, lr=[8.881569670910722e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:11:50,828] [INFO] [timer.py:258:stop] epoch=0/micro_step=5010/global_step=5010, RunningAvgSamplesPerSec=4.498334509060603, CurrSamplesPerSec=4.491490185348887, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:11:59,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=5020, skipped=23, lr=[8.876901799929173e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:11:59,881] [INFO] [timer.py:258:stop] epoch=0/micro_step=5020/global_step=5020, RunningAvgSamplesPerSec=4.498314357797432, CurrSamplesPerSec=4.485451278391964, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:12:08,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=5030, skipped=23, lr=[8.872225596778117e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:12:08,950] [INFO] [timer.py:258:stop] epoch=0/micro_step=5030/global_step=5030, RunningAvgSamplesPerSec=4.498297354602124, CurrSamplesPerSec=4.485217446167122, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:12:18,028] [INFO] [logging.py:96:log_dist] [Rank 0] step=5040, skipped=23, lr=[8.867541072995626e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:12:18,029] [INFO] [timer.py:258:stop] epoch=0/micro_step=5040/global_step=5040, RunningAvgSamplesPerSec=4.498275148042456, CurrSamplesPerSec=4.496984804745401, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:12:27,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=5050, skipped=23, lr=[8.862848240140296e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:12:27,100] [INFO] [timer.py:258:stop] epoch=0/micro_step=5050/global_step=5050, RunningAvgSamplesPerSec=4.498255740923263, CurrSamplesPerSec=4.484685119120492, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:12:27,102] [INFO] [RANK 0]  iteration     5050/   20000 | elapsed time per iteration (ms): 1039.9 | learning rate 8.862E-05 | total loss 4.775549E-01 | loss 4.775549E-01 | loss scale 32768.0 |speed 230.78 samples/(min*GPU)
[2024-06-17 07:12:27,103] [INFO] [RANK 0] time (ms) | forward: 356.98 | backward: 545.78 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 18.88 | data loader: 0.14
[2024-06-17 07:12:36,165] [INFO] [logging.py:96:log_dist] [Rank 0] step=5060, skipped=23, lr=[8.858147109791222e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:12:36,166] [INFO] [timer.py:258:stop] epoch=0/micro_step=5060/global_step=5060, RunningAvgSamplesPerSec=4.498241201524551, CurrSamplesPerSec=4.4911739676415845, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:12:45,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=5070, skipped=23, lr=[8.853437693547978e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:12:45,244] [INFO] [timer.py:258:stop] epoch=0/micro_step=5070/global_step=5070, RunningAvgSamplesPerSec=4.498217693330053, CurrSamplesPerSec=4.482052917838459, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:12:54,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=5080, skipped=23, lr=[8.848720003030583e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:12:54,313] [INFO] [timer.py:258:stop] epoch=0/micro_step=5080/global_step=5080, RunningAvgSamplesPerSec=4.498204679784827, CurrSamplesPerSec=4.483648403323795, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:13:03,384] [INFO] [logging.py:96:log_dist] [Rank 0] step=5090, skipped=23, lr=[8.843994049879463e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:13:03,385] [INFO] [timer.py:258:stop] epoch=0/micro_step=5090/global_step=5090, RunningAvgSamplesPerSec=4.498187037729475, CurrSamplesPerSec=4.485601183667991, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:13:12,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=5100, skipped=23, lr=[8.839259845755446e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:13:12,443] [INFO] [timer.py:258:stop] epoch=0/micro_step=5100/global_step=5100, RunningAvgSamplesPerSec=4.498177770389657, CurrSamplesPerSec=4.4963870171678995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:13:12,444] [INFO] [RANK 0]  iteration     5100/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 8.839E-05 | total loss 4.438812E-01 | loss 4.438812E-01 | loss scale 32768.0 |speed 264.65 samples/(min*GPU)
[2024-06-17 07:13:12,445] [INFO] [RANK 0] time (ms) | forward: 356.83 | backward: 545.96 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 15.42 | data loader: 0.09
[2024-06-17 07:13:12,445] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:13:12,458] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/5100/mp_rank_00_model_states.pt
[2024-06-17 07:13:12,458] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/5100/mp_rank_00_model_states.pt...
[2024-06-17 07:13:41,004] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/5100/mp_rank_00_model_states.pt.
[2024-06-17 07:13:50,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=5110, skipped=23, lr=[8.834517402339703e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:13:50,013] [INFO] [timer.py:258:stop] epoch=0/micro_step=5110/global_step=5110, RunningAvgSamplesPerSec=4.498258788075301, CurrSamplesPerSec=4.545444102350693, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:13:58,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=5120, skipped=23, lr=[8.829766731333745e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:13:58,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=5120/global_step=5120, RunningAvgSamplesPerSec=4.4983108848758615, CurrSamplesPerSec=4.514430141593116, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:14:07,992] [INFO] [logging.py:96:log_dist] [Rank 0] step=5130, skipped=23, lr=[8.825007844459379e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:14:07,993] [INFO] [timer.py:258:stop] epoch=0/micro_step=5130/global_step=5130, RunningAvgSamplesPerSec=4.4983407183198665, CurrSamplesPerSec=4.516041471569386, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:14:16,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=5140, skipped=23, lr=[8.820240753458688e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:14:16,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=5140/global_step=5140, RunningAvgSamplesPerSec=4.498357185883542, CurrSamplesPerSec=4.504262577112724, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:14:26,007] [INFO] [logging.py:96:log_dist] [Rank 0] step=5150, skipped=23, lr=[8.81546547009399e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:14:26,007] [INFO] [timer.py:258:stop] epoch=0/micro_step=5150/global_step=5150, RunningAvgSamplesPerSec=4.49836987680976, CurrSamplesPerSec=4.4940769059333805, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:14:26,008] [INFO] [RANK 0]  iteration     5150/   20000 | elapsed time per iteration (ms): 1471.3 | learning rate 8.815E-05 | total loss 4.360126E-01 | loss 4.360126E-01 | loss scale 32768.0 |speed 163.12 samples/(min*GPU)
[2024-06-17 07:14:26,009] [INFO] [RANK 0] time (ms) | forward: 353.65 | backward: 542.28 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.03 | data loader: 0.10
[2024-06-17 07:14:34,150] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 07:14:35,053] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 07:14:35,053] [INFO] [logging.py:96:log_dist] [Rank 0] step=5160, skipped=25, lr=[8.811160720332389e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:14:35,055] [INFO] [timer.py:258:stop] epoch=0/micro_step=5160/global_step=5160, RunningAvgSamplesPerSec=4.498374739119193, CurrSamplesPerSec=4.502830033975438, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:14:44,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=5170, skipped=25, lr=[8.806849352902994e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:14:44,113] [INFO] [timer.py:258:stop] epoch=0/micro_step=5170/global_step=5170, RunningAvgSamplesPerSec=4.498366803288409, CurrSamplesPerSec=4.494175621239387, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:14:53,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=5180, skipped=25, lr=[8.802051193666594e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:14:53,171] [INFO] [timer.py:258:stop] epoch=0/micro_step=5180/global_step=5180, RunningAvgSamplesPerSec=4.498353042506651, CurrSamplesPerSec=4.493199493400088, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:15:02,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=5190, skipped=25, lr=[8.797244886947123e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:15:02,222] [INFO] [timer.py:258:stop] epoch=0/micro_step=5190/global_step=5190, RunningAvgSamplesPerSec=4.4983342603014576, CurrSamplesPerSec=4.468282315529591, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:15:11,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=5200, skipped=25, lr=[8.792430444603663e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:15:11,295] [INFO] [timer.py:258:stop] epoch=0/micro_step=5200/global_step=5200, RunningAvgSamplesPerSec=4.498310883245763, CurrSamplesPerSec=4.490191932692683, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:15:11,295] [INFO] [RANK 0]  iteration     5200/   20000 | elapsed time per iteration (ms): 905.7 | learning rate 8.792E-05 | total loss 4.621033E-01 | loss 4.621033E-01 | loss scale 32768.0 |speed 264.98 samples/(min*GPU)
[2024-06-17 07:15:11,296] [INFO] [RANK 0] time (ms) | forward: 356.50 | backward: 545.25 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.76 | data loader: 0.13
[2024-06-17 07:15:20,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=5210, skipped=25, lr=[8.78760787851537e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:15:20,382] [INFO] [timer.py:258:stop] epoch=0/micro_step=5210/global_step=5210, RunningAvgSamplesPerSec=4.4982922899008075, CurrSamplesPerSec=4.48352139366051, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:15:29,448] [INFO] [logging.py:96:log_dist] [Rank 0] step=5220, skipped=25, lr=[8.78277720058145e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:15:29,449] [INFO] [timer.py:258:stop] epoch=0/micro_step=5220/global_step=5220, RunningAvgSamplesPerSec=4.498274047418424, CurrSamplesPerSec=4.4840270786099135, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:15:38,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=5230, skipped=25, lr=[8.777938422721117e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:15:38,531] [INFO] [timer.py:258:stop] epoch=0/micro_step=5230/global_step=5230, RunningAvgSamplesPerSec=4.498259853160599, CurrSamplesPerSec=4.492777157694261, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:15:47,600] [INFO] [logging.py:96:log_dist] [Rank 0] step=5240, skipped=25, lr=[8.773091556873578e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:15:47,602] [INFO] [timer.py:258:stop] epoch=0/micro_step=5240/global_step=5240, RunningAvgSamplesPerSec=4.498244745445599, CurrSamplesPerSec=4.4841193604445735, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:15:56,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=5250, skipped=25, lr=[8.768236614997989e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:15:56,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=5250/global_step=5250, RunningAvgSamplesPerSec=4.498215126168737, CurrSamplesPerSec=4.482485215764081, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:15:56,684] [INFO] [RANK 0]  iteration     5250/   20000 | elapsed time per iteration (ms): 907.8 | learning rate 8.768E-05 | total loss 4.730139E-01 | loss 4.730139E-01 | loss scale 32768.0 |speed 264.38 samples/(min*GPU)
[2024-06-17 07:15:56,686] [INFO] [RANK 0] time (ms) | forward: 357.80 | backward: 545.96 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.92 | data loader: 0.10
[2024-06-17 07:16:05,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=5260, skipped=25, lr=[8.76337360907344e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:16:05,773] [INFO] [timer.py:258:stop] epoch=0/micro_step=5260/global_step=5260, RunningAvgSamplesPerSec=4.498196107854412, CurrSamplesPerSec=4.479275507806659, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:16:14,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=5270, skipped=25, lr=[8.758502551098914e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:16:14,865] [INFO] [timer.py:258:stop] epoch=0/micro_step=5270/global_step=5270, RunningAvgSamplesPerSec=4.49817234608425, CurrSamplesPerSec=4.487064785459712, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:16:23,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=5280, skipped=25, lr=[8.75362345309326e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:16:23,927] [INFO] [timer.py:258:stop] epoch=0/micro_step=5280/global_step=5280, RunningAvgSamplesPerSec=4.498161259734533, CurrSamplesPerSec=4.487702110506202, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:16:32,993] [INFO] [logging.py:96:log_dist] [Rank 0] step=5290, skipped=25, lr=[8.748736327095167e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:16:32,993] [INFO] [timer.py:258:stop] epoch=0/micro_step=5290/global_step=5290, RunningAvgSamplesPerSec=4.498142585960315, CurrSamplesPerSec=4.48976415460411, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:16:42,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=5300, skipped=25, lr=[8.743841185163136e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:16:42,063] [INFO] [timer.py:258:stop] epoch=0/micro_step=5300/global_step=5300, RunningAvgSamplesPerSec=4.498127640863608, CurrSamplesPerSec=4.486103739245134, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:16:42,065] [INFO] [RANK 0]  iteration     5300/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 8.743E-05 | total loss 4.781085E-01 | loss 4.781085E-01 | loss scale 32768.0 |speed 264.43 samples/(min*GPU)
[2024-06-17 07:16:42,066] [INFO] [RANK 0] time (ms) | forward: 357.82 | backward: 545.75 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.99 | data loader: 0.11
[2024-06-17 07:16:51,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=5310, skipped=25, lr=[8.738938039375439e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:16:51,121] [INFO] [timer.py:258:stop] epoch=0/micro_step=5310/global_step=5310, RunningAvgSamplesPerSec=4.498111445091395, CurrSamplesPerSec=4.490589743322084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:17:00,177] [INFO] [logging.py:96:log_dist] [Rank 0] step=5320, skipped=25, lr=[8.734026901830107e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:17:00,178] [INFO] [timer.py:258:stop] epoch=0/micro_step=5320/global_step=5320, RunningAvgSamplesPerSec=4.4980974923438835, CurrSamplesPerSec=4.484693510683655, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:17:09,235] [INFO] [logging.py:96:log_dist] [Rank 0] step=5330, skipped=25, lr=[8.729107784644877e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:17:09,237] [INFO] [timer.py:258:stop] epoch=0/micro_step=5330/global_step=5330, RunningAvgSamplesPerSec=4.498085229211706, CurrSamplesPerSec=4.495703853843406, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:17:18,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=5340, skipped=25, lr=[8.724180699957185e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:17:18,295] [INFO] [timer.py:258:stop] epoch=0/micro_step=5340/global_step=5340, RunningAvgSamplesPerSec=4.498070934985728, CurrSamplesPerSec=4.494768004157948, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:17:27,343] [INFO] [logging.py:96:log_dist] [Rank 0] step=5350, skipped=25, lr=[8.719245659924123e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:17:27,344] [INFO] [timer.py:258:stop] epoch=0/micro_step=5350/global_step=5350, RunningAvgSamplesPerSec=4.4980574118343455, CurrSamplesPerSec=4.495502679528403, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:17:27,345] [INFO] [RANK 0]  iteration     5350/   20000 | elapsed time per iteration (ms): 905.6 | learning rate 8.719E-05 | total loss 4.472626E-01 | loss 4.472626E-01 | loss scale 32768.0 |speed 265.02 samples/(min*GPU)
[2024-06-17 07:17:27,346] [INFO] [RANK 0] time (ms) | forward: 355.85 | backward: 545.78 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.36 | data loader: 0.10
[2024-06-17 07:17:36,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=5360, skipped=25, lr=[8.714302676722413e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:17:36,410] [INFO] [timer.py:258:stop] epoch=0/micro_step=5360/global_step=5360, RunningAvgSamplesPerSec=4.498047327504453, CurrSamplesPerSec=4.493497943709465, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:17:45,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=5370, skipped=25, lr=[8.70935176254837e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:17:45,473] [INFO] [timer.py:258:stop] epoch=0/micro_step=5370/global_step=5370, RunningAvgSamplesPerSec=4.498038554803396, CurrSamplesPerSec=4.478405060209575, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:17:54,548] [INFO] [logging.py:96:log_dist] [Rank 0] step=5380, skipped=25, lr=[8.704392929617884e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:17:54,548] [INFO] [timer.py:258:stop] epoch=0/micro_step=5380/global_step=5380, RunningAvgSamplesPerSec=4.498015830594518, CurrSamplesPerSec=4.490690709499654, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:18:03,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=5390, skipped=25, lr=[8.699426190166385e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:18:03,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=5390/global_step=5390, RunningAvgSamplesPerSec=4.497993050409041, CurrSamplesPerSec=4.485128716216939, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:18:12,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=5400, skipped=25, lr=[8.694451556448807e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:18:12,669] [INFO] [timer.py:258:stop] epoch=0/micro_step=5400/global_step=5400, RunningAvgSamplesPerSec=4.497976971930909, CurrSamplesPerSec=4.461236510032135, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:18:12,671] [INFO] [RANK 0]  iteration     5400/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 8.694E-05 | total loss 4.530078E-01 | loss 4.530078E-01 | loss scale 32768.0 |speed 264.75 samples/(min*GPU)
[2024-06-17 07:18:12,671] [INFO] [RANK 0] time (ms) | forward: 356.65 | backward: 545.83 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.90 | data loader: 0.10
[2024-06-17 07:18:12,672] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:18:12,688] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/5400/mp_rank_00_model_states.pt
[2024-06-17 07:18:12,688] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/5400/mp_rank_00_model_states.pt...
[2024-06-17 07:18:41,622] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/5400/mp_rank_00_model_states.pt.
[2024-06-17 07:18:50,631] [INFO] [logging.py:96:log_dist] [Rank 0] step=5410, skipped=25, lr=[8.689469040739564e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:18:50,632] [INFO] [timer.py:258:stop] epoch=0/micro_step=5410/global_step=5410, RunningAvgSamplesPerSec=4.498040263567066, CurrSamplesPerSec=4.523201836757033, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:18:59,631] [INFO] [logging.py:96:log_dist] [Rank 0] step=5420, skipped=25, lr=[8.68447865533252e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:18:59,632] [INFO] [timer.py:258:stop] epoch=0/micro_step=5420/global_step=5420, RunningAvgSamplesPerSec=4.498087909682395, CurrSamplesPerSec=4.519043603078092, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:19:08,630] [INFO] [logging.py:96:log_dist] [Rank 0] step=5430, skipped=25, lr=[8.679480412540955e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:19:08,631] [INFO] [timer.py:258:stop] epoch=0/micro_step=5430/global_step=5430, RunningAvgSamplesPerSec=4.4981237028184, CurrSamplesPerSec=4.51895961566847, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:19:17,649] [INFO] [logging.py:96:log_dist] [Rank 0] step=5440, skipped=25, lr=[8.674474324697531e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:19:17,650] [INFO] [timer.py:258:stop] epoch=0/micro_step=5440/global_step=5440, RunningAvgSamplesPerSec=4.498145364998083, CurrSamplesPerSec=4.503528662683684, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:19:26,695] [INFO] [logging.py:96:log_dist] [Rank 0] step=5450, skipped=25, lr=[8.66946040415428e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:19:26,696] [INFO] [timer.py:258:stop] epoch=0/micro_step=5450/global_step=5450, RunningAvgSamplesPerSec=4.498156695021357, CurrSamplesPerSec=4.503887730963219, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:19:26,697] [INFO] [RANK 0]  iteration     5450/   20000 | elapsed time per iteration (ms): 1480.5 | learning rate 8.669E-05 | total loss 4.408789E-01 | loss 4.408789E-01 | loss scale 32768.0 |speed 162.10 samples/(min*GPU)
[2024-06-17 07:19:26,698] [INFO] [RANK 0] time (ms) | forward: 354.85 | backward: 542.40 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 15.30 | data loader: 0.11
[2024-06-17 07:19:35,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=5460, skipped=25, lr=[8.664438663282547e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:19:35,738] [INFO] [timer.py:258:stop] epoch=0/micro_step=5460/global_step=5460, RunningAvgSamplesPerSec=4.498157167291429, CurrSamplesPerSec=4.486568013537885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:19:44,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=5470, skipped=25, lr=[8.659409114472978e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:19:44,793] [INFO] [timer.py:258:stop] epoch=0/micro_step=5470/global_step=5470, RunningAvgSamplesPerSec=4.49813854782048, CurrSamplesPerSec=4.463484474047501, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:19:53,851] [INFO] [logging.py:96:log_dist] [Rank 0] step=5480, skipped=25, lr=[8.654371770135488e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:19:53,852] [INFO] [timer.py:258:stop] epoch=0/micro_step=5480/global_step=5480, RunningAvgSamplesPerSec=4.49812304667249, CurrSamplesPerSec=4.500193395581139, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:20:02,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=5490, skipped=25, lr=[8.649326642699223e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:20:02,906] [INFO] [timer.py:258:stop] epoch=0/micro_step=5490/global_step=5490, RunningAvgSamplesPerSec=4.498118270491469, CurrSamplesPerSec=4.4942418351550355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:20:11,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=5500, skipped=25, lr=[8.644273744612531e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:20:11,955] [INFO] [timer.py:258:stop] epoch=0/micro_step=5500/global_step=5500, RunningAvgSamplesPerSec=4.498111006508185, CurrSamplesPerSec=4.503930049178299, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:20:11,956] [INFO] [RANK 0]  iteration     5500/   20000 | elapsed time per iteration (ms): 905.2 | learning rate 8.644E-05 | total loss 4.201466E-01 | loss 4.201466E-01 | loss scale 32768.0 |speed 265.14 samples/(min*GPU)
[2024-06-17 07:20:11,957] [INFO] [RANK 0] time (ms) | forward: 356.05 | backward: 545.16 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.42 | data loader: 0.10
[2024-06-17 07:20:21,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=5510, skipped=25, lr=[8.639213088342937e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:20:21,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=5510/global_step=5510, RunningAvgSamplesPerSec=4.498110937580423, CurrSamplesPerSec=4.502301975867092, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:20:30,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=5520, skipped=25, lr=[8.634144686377108e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:20:30,061] [INFO] [timer.py:258:stop] epoch=0/micro_step=5520/global_step=5520, RunningAvgSamplesPerSec=4.4980957633763525, CurrSamplesPerSec=4.488187126931104, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:20:39,110] [INFO] [logging.py:96:log_dist] [Rank 0] step=5530, skipped=25, lr=[8.629068551220823e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:20:39,111] [INFO] [timer.py:258:stop] epoch=0/micro_step=5530/global_step=5530, RunningAvgSamplesPerSec=4.498086432505909, CurrSamplesPerSec=4.501515556014666, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:20:48,157] [INFO] [logging.py:96:log_dist] [Rank 0] step=5540, skipped=25, lr=[8.623984695398936e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:20:48,158] [INFO] [timer.py:258:stop] epoch=0/micro_step=5540/global_step=5540, RunningAvgSamplesPerSec=4.498078653822516, CurrSamplesPerSec=4.4928409240934695, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:20:57,217] [INFO] [logging.py:96:log_dist] [Rank 0] step=5550, skipped=25, lr=[8.618893131455363e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:20:57,218] [INFO] [timer.py:258:stop] epoch=0/micro_step=5550/global_step=5550, RunningAvgSamplesPerSec=4.49805657476811, CurrSamplesPerSec=4.4999447471727185, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:20:57,220] [INFO] [RANK 0]  iteration     5550/   20000 | elapsed time per iteration (ms): 905.3 | learning rate 8.618E-05 | total loss 4.369727E-01 | loss 4.369727E-01 | loss scale 32768.0 |speed 265.11 samples/(min*GPU)
[2024-06-17 07:20:57,220] [INFO] [RANK 0] time (ms) | forward: 355.54 | backward: 545.75 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.29 | data loader: 0.10
[2024-06-17 07:21:06,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=5560, skipped=25, lr=[8.613793871953025e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:21:06,280] [INFO] [timer.py:258:stop] epoch=0/micro_step=5560/global_step=5560, RunningAvgSamplesPerSec=4.498046885633749, CurrSamplesPerSec=4.495217211554357, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:21:07,180] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 07:21:08,089] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 07:21:15,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=5570, skipped=27, lr=[8.609708932003258e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:21:15,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=5570/global_step=5570, RunningAvgSamplesPerSec=4.4980366216591126, CurrSamplesPerSec=4.48987830089585, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:21:24,402] [INFO] [logging.py:96:log_dist] [Rank 0] step=5580, skipped=27, lr=[8.604595852214319e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:21:24,403] [INFO] [timer.py:258:stop] epoch=0/micro_step=5580/global_step=5580, RunningAvgSamplesPerSec=4.49802022995766, CurrSamplesPerSec=4.490688305490282, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:21:33,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=5590, skipped=27, lr=[8.599475112143734e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:21:33,459] [INFO] [timer.py:258:stop] epoch=0/micro_step=5590/global_step=5590, RunningAvgSamplesPerSec=4.498004735448712, CurrSamplesPerSec=4.48844768646067, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:21:42,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=5600, skipped=27, lr=[8.594346724426417e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:21:42,530] [INFO] [timer.py:258:stop] epoch=0/micro_step=5600/global_step=5600, RunningAvgSamplesPerSec=4.497992308393993, CurrSamplesPerSec=4.489424153203072, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:21:42,532] [INFO] [RANK 0]  iteration     5600/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 8.594E-05 | total loss 4.088745E-01 | loss 4.088745E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 07:21:42,532] [INFO] [RANK 0] time (ms) | forward: 356.48 | backward: 545.81 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 15.00 | data loader: 0.10
[2024-06-17 07:21:51,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=5610, skipped=27, lr=[8.58921070171616e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:21:51,608] [INFO] [timer.py:258:stop] epoch=0/micro_step=5610/global_step=5610, RunningAvgSamplesPerSec=4.49797657184387, CurrSamplesPerSec=4.4816649984519925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:22:00,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=5620, skipped=27, lr=[8.584067056685585e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:22:00,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=5620/global_step=5620, RunningAvgSamplesPerSec=4.497960729364858, CurrSamplesPerSec=4.4890313535150295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:22:09,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=5630, skipped=27, lr=[8.578915802026125e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:22:09,733] [INFO] [timer.py:258:stop] epoch=0/micro_step=5630/global_step=5630, RunningAvgSamplesPerSec=4.497950929266955, CurrSamplesPerSec=4.499927849734331, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:22:18,821] [INFO] [logging.py:96:log_dist] [Rank 0] step=5640, skipped=27, lr=[8.57375695044799e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:22:18,821] [INFO] [timer.py:258:stop] epoch=0/micro_step=5640/global_step=5640, RunningAvgSamplesPerSec=4.497939647096228, CurrSamplesPerSec=4.4908373589387445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:22:27,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=5650, skipped=27, lr=[8.568590514680132e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:22:27,869] [INFO] [timer.py:258:stop] epoch=0/micro_step=5650/global_step=5650, RunningAvgSamplesPerSec=4.497923772280054, CurrSamplesPerSec=4.4830278017895, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:22:27,871] [INFO] [RANK 0]  iteration     5650/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 8.568E-05 | total loss 4.727954E-01 | loss 4.727954E-01 | loss scale 32768.0 |speed 264.67 samples/(min*GPU)
[2024-06-17 07:22:27,871] [INFO] [RANK 0] time (ms) | forward: 357.05 | backward: 545.63 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 15.35 | data loader: 0.10
[2024-06-17 07:22:36,925] [INFO] [logging.py:96:log_dist] [Rank 0] step=5660, skipped=27, lr=[8.56341650747022e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:22:36,926] [INFO] [timer.py:258:stop] epoch=0/micro_step=5660/global_step=5660, RunningAvgSamplesPerSec=4.4979106465500465, CurrSamplesPerSec=4.482315160647398, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:22:45,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=5670, skipped=27, lr=[8.558234941584598e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:22:45,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=5670/global_step=5670, RunningAvgSamplesPerSec=4.497900203822622, CurrSamplesPerSec=4.4934281412948955, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:22:55,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=5680, skipped=27, lr=[8.553045829808271e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:22:55,041] [INFO] [timer.py:258:stop] epoch=0/micro_step=5680/global_step=5680, RunningAvgSamplesPerSec=4.49789360283103, CurrSamplesPerSec=4.486711994078055, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:23:04,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=5690, skipped=27, lr=[8.547849184944852e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:23:04,077] [INFO] [timer.py:258:stop] epoch=0/micro_step=5690/global_step=5690, RunningAvgSamplesPerSec=4.497886211409831, CurrSamplesPerSec=4.498451021221304, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:23:13,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=5700, skipped=27, lr=[8.542645019816548e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:23:13,123] [INFO] [timer.py:258:stop] epoch=0/micro_step=5700/global_step=5700, RunningAvgSamplesPerSec=4.49786931425096, CurrSamplesPerSec=4.477270877405164, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:23:13,123] [INFO] [RANK 0]  iteration     5700/   20000 | elapsed time per iteration (ms): 905.1 | learning rate 8.542E-05 | total loss 4.037610E-01 | loss 4.037610E-01 | loss scale 32768.0 |speed 265.18 samples/(min*GPU)
[2024-06-17 07:23:13,124] [INFO] [RANK 0] time (ms) | forward: 355.55 | backward: 545.53 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.02 | data loader: 0.11
[2024-06-17 07:23:13,125] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:23:13,138] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/5700/mp_rank_00_model_states.pt
[2024-06-17 07:23:13,138] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/5700/mp_rank_00_model_states.pt...
[2024-06-17 07:23:41,754] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/5700/mp_rank_00_model_states.pt.
[2024-06-17 07:23:50,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=5710, skipped=27, lr=[8.537433347264117e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:23:50,796] [INFO] [timer.py:258:stop] epoch=0/micro_step=5710/global_step=5710, RunningAvgSamplesPerSec=4.497893619936729, CurrSamplesPerSec=4.5103037755463875, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:23:59,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=5720, skipped=27, lr=[8.532214180146846e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:23:59,808] [INFO] [timer.py:258:stop] epoch=0/micro_step=5720/global_step=5720, RunningAvgSamplesPerSec=4.497939982050571, CurrSamplesPerSec=4.5018561834185595, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:24:08,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=5730, skipped=27, lr=[8.526987531342507e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:24:08,853] [INFO] [timer.py:258:stop] epoch=0/micro_step=5730/global_step=5730, RunningAvgSamplesPerSec=4.497946117689912, CurrSamplesPerSec=4.51689742652968, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:24:17,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=5740, skipped=27, lr=[8.521753413747338e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:24:17,905] [INFO] [timer.py:258:stop] epoch=0/micro_step=5740/global_step=5740, RunningAvgSamplesPerSec=4.497953152879484, CurrSamplesPerSec=4.497237948190084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:24:26,987] [INFO] [logging.py:96:log_dist] [Rank 0] step=5750, skipped=27, lr=[8.516511840276005e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:24:26,987] [INFO] [timer.py:258:stop] epoch=0/micro_step=5750/global_step=5750, RunningAvgSamplesPerSec=4.497942437286987, CurrSamplesPerSec=4.481438743151182, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:24:26,988] [INFO] [RANK 0]  iteration     5750/   20000 | elapsed time per iteration (ms): 1477.3 | learning rate 8.516E-05 | total loss 4.124353E-01 | loss 4.124353E-01 | loss scale 32768.0 |speed 162.46 samples/(min*GPU)
[2024-06-17 07:24:26,989] [INFO] [RANK 0] time (ms) | forward: 357.54 | backward: 542.66 | allreduce: 0.00 | optimizer: 3.45 | batch generator: 16.26 | data loader: 0.23
[2024-06-17 07:24:36,043] [INFO] [logging.py:96:log_dist] [Rank 0] step=5760, skipped=27, lr=[8.511262823861568e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:24:36,044] [INFO] [timer.py:258:stop] epoch=0/micro_step=5760/global_step=5760, RunningAvgSamplesPerSec=4.497932465574367, CurrSamplesPerSec=4.498327995933137, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:24:45,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=5770, skipped=27, lr=[8.506006377455457e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:24:45,130] [INFO] [timer.py:258:stop] epoch=0/micro_step=5770/global_step=5770, RunningAvgSamplesPerSec=4.497908973036263, CurrSamplesPerSec=4.46769451343713, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:24:54,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=5780, skipped=27, lr=[8.500742514027424e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:24:54,234] [INFO] [timer.py:258:stop] epoch=0/micro_step=5780/global_step=5780, RunningAvgSamplesPerSec=4.4978722396202, CurrSamplesPerSec=4.4829020251223115, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:25:03,345] [INFO] [logging.py:96:log_dist] [Rank 0] step=5790, skipped=27, lr=[8.495471246565535e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:25:03,346] [INFO] [timer.py:258:stop] epoch=0/micro_step=5790/global_step=5790, RunningAvgSamplesPerSec=4.497839463525335, CurrSamplesPerSec=4.479745546679726, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:25:12,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=5800, skipped=27, lr=[8.490192588076114e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:25:12,418] [INFO] [timer.py:258:stop] epoch=0/micro_step=5800/global_step=5800, RunningAvgSamplesPerSec=4.497816334392038, CurrSamplesPerSec=4.490221976352034, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:25:12,420] [INFO] [RANK 0]  iteration     5800/   20000 | elapsed time per iteration (ms): 908.6 | learning rate 8.490E-05 | total loss 4.544421E-01 | loss 4.544421E-01 | loss scale 32768.0 |speed 264.14 samples/(min*GPU)
[2024-06-17 07:25:12,422] [INFO] [RANK 0] time (ms) | forward: 357.98 | backward: 546.37 | allreduce: 0.00 | optimizer: 3.46 | batch generator: 15.86 | data loader: 0.10
[2024-06-17 07:25:21,519] [INFO] [logging.py:96:log_dist] [Rank 0] step=5810, skipped=27, lr=[8.484906551583732e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:25:21,519] [INFO] [timer.py:258:stop] epoch=0/micro_step=5810/global_step=5810, RunningAvgSamplesPerSec=4.4977798047259325, CurrSamplesPerSec=4.477402312783236, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:25:30,582] [INFO] [logging.py:96:log_dist] [Rank 0] step=5820, skipped=27, lr=[8.479613150131151e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:25:30,583] [INFO] [timer.py:258:stop] epoch=0/micro_step=5820/global_step=5820, RunningAvgSamplesPerSec=4.497757538452465, CurrSamplesPerSec=4.4753014661045025, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:25:39,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=5830, skipped=27, lr=[8.474312396779318e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:25:39,654] [INFO] [timer.py:258:stop] epoch=0/micro_step=5830/global_step=5830, RunningAvgSamplesPerSec=4.497736020802215, CurrSamplesPerSec=4.477164539882998, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:25:48,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=5840, skipped=27, lr=[8.469004304607314e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:25:48,745] [INFO] [timer.py:258:stop] epoch=0/micro_step=5840/global_step=5840, RunningAvgSamplesPerSec=4.497705468355759, CurrSamplesPerSec=4.490177511878999, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:25:57,823] [INFO] [logging.py:96:log_dist] [Rank 0] step=5850, skipped=27, lr=[8.463688886712326e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:25:57,823] [INFO] [timer.py:258:stop] epoch=0/micro_step=5850/global_step=5850, RunningAvgSamplesPerSec=4.497682735915173, CurrSamplesPerSec=4.4942442429705505, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:25:57,825] [INFO] [RANK 0]  iteration     5850/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 8.463E-05 | total loss 4.738538E-01 | loss 4.738538E-01 | loss scale 32768.0 |speed 264.28 samples/(min*GPU)
[2024-06-17 07:25:57,826] [INFO] [RANK 0] time (ms) | forward: 357.17 | backward: 546.62 | allreduce: 0.00 | optimizer: 3.43 | batch generator: 15.00 | data loader: 0.11
[2024-06-17 07:26:06,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=5860, skipped=27, lr=[8.458366156209626e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:26:06,915] [INFO] [timer.py:258:stop] epoch=0/micro_step=5860/global_step=5860, RunningAvgSamplesPerSec=4.497658381177965, CurrSamplesPerSec=4.483789799903735, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:26:15,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=5870, skipped=27, lr=[8.453036126232514e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:26:15,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=5870/global_step=5870, RunningAvgSamplesPerSec=4.497646526168055, CurrSamplesPerSec=4.49598215458133, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:26:25,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=5880, skipped=27, lr=[8.447698809932314e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:26:25,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=5880/global_step=5880, RunningAvgSamplesPerSec=4.497628033718311, CurrSamplesPerSec=4.487185995302918, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:26:34,115] [INFO] [logging.py:96:log_dist] [Rank 0] step=5890, skipped=27, lr=[8.442354220478326e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:26:34,116] [INFO] [timer.py:258:stop] epoch=0/micro_step=5890/global_step=5890, RunningAvgSamplesPerSec=4.497605089575641, CurrSamplesPerSec=4.487632488040133, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:26:43,196] [INFO] [logging.py:96:log_dist] [Rank 0] step=5900, skipped=27, lr=[8.437002371057783e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:26:43,197] [INFO] [timer.py:258:stop] epoch=0/micro_step=5900/global_step=5900, RunningAvgSamplesPerSec=4.4975881620169815, CurrSamplesPerSec=4.48543568881845, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:26:43,198] [INFO] [RANK 0]  iteration     5900/   20000 | elapsed time per iteration (ms): 907.5 | learning rate 8.436E-05 | total loss 4.417352E-01 | loss 4.417352E-01 | loss scale 32768.0 |speed 264.47 samples/(min*GPU)
[2024-06-17 07:26:43,199] [INFO] [RANK 0] time (ms) | forward: 357.17 | backward: 546.25 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 15.40 | data loader: 0.16
[2024-06-17 07:26:52,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=5910, skipped=27, lr=[8.431643274875855e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:26:52,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=5910/global_step=5910, RunningAvgSamplesPerSec=4.497570624962851, CurrSamplesPerSec=4.480750540757159, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:27:01,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=5920, skipped=27, lr=[8.426276945155568e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:27:01,305] [INFO] [timer.py:258:stop] epoch=0/micro_step=5920/global_step=5920, RunningAvgSamplesPerSec=4.4975608665, CurrSamplesPerSec=4.4964569115417845, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:27:10,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=5930, skipped=27, lr=[8.420903395137813e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:27:10,381] [INFO] [timer.py:258:stop] epoch=0/micro_step=5930/global_step=5930, RunningAvgSamplesPerSec=4.497542048992224, CurrSamplesPerSec=4.476354628806467, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:27:19,454] [INFO] [logging.py:96:log_dist] [Rank 0] step=5940, skipped=27, lr=[8.415522638081292e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:27:19,455] [INFO] [timer.py:258:stop] epoch=0/micro_step=5940/global_step=5940, RunningAvgSamplesPerSec=4.497527355669836, CurrSamplesPerSec=4.49527382046466, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:27:28,510] [INFO] [logging.py:96:log_dist] [Rank 0] step=5950, skipped=27, lr=[8.410134687262482e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:27:28,511] [INFO] [timer.py:258:stop] epoch=0/micro_step=5950/global_step=5950, RunningAvgSamplesPerSec=4.4975181699608635, CurrSamplesPerSec=4.49488120077717, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:27:28,511] [INFO] [RANK 0]  iteration     5950/   20000 | elapsed time per iteration (ms): 906.3 | learning rate 8.410E-05 | total loss 3.989502E-01 | loss 3.989502E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 07:27:28,513] [INFO] [RANK 0] time (ms) | forward: 356.27 | backward: 546.00 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 14.74 | data loader: 0.19
[2024-06-17 07:27:37,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=5960, skipped=27, lr=[8.404739555975618e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:27:37,588] [INFO] [timer.py:258:stop] epoch=0/micro_step=5960/global_step=5960, RunningAvgSamplesPerSec=4.497500484066661, CurrSamplesPerSec=4.48937970452946, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:27:40,311] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 07:27:41,217] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 07:27:46,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=5970, skipped=29, lr=[8.400418289954167e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:27:46,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=5970/global_step=5970, RunningAvgSamplesPerSec=4.497486503201865, CurrSamplesPerSec=4.488601394747304, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:27:55,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=5980, skipped=29, lr=[8.395010267382808e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:27:55,732] [INFO] [timer.py:258:stop] epoch=0/micro_step=5980/global_step=5980, RunningAvgSamplesPerSec=4.497473784517496, CurrSamplesPerSec=4.4980759357242155, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:28:04,795] [INFO] [logging.py:96:log_dist] [Rank 0] step=5990, skipped=29, lr=[8.389595101661398e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:28:04,795] [INFO] [timer.py:258:stop] epoch=0/micro_step=5990/global_step=5990, RunningAvgSamplesPerSec=4.497453954937044, CurrSamplesPerSec=4.4750842084935085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:28:13,866] [INFO] [logging.py:96:log_dist] [Rank 0] step=6000, skipped=29, lr=[8.384172806151322e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:28:13,866] [INFO] [timer.py:258:stop] epoch=0/micro_step=6000/global_step=6000, RunningAvgSamplesPerSec=4.497431369968083, CurrSamplesPerSec=4.485198261015555, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:28:13,868] [INFO] [RANK 0]  iteration     6000/   20000 | elapsed time per iteration (ms): 907.1 | learning rate 8.384E-05 | total loss 4.285547E-01 | loss 4.285547E-01 | loss scale 32768.0 |speed 264.57 samples/(min*GPU)
[2024-06-17 07:28:13,868] [INFO] [RANK 0] time (ms) | forward: 356.99 | backward: 546.20 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 15.15 | data loader: 0.18
[2024-06-17 07:28:13,869] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:28:13,882] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/6000/mp_rank_00_model_states.pt
[2024-06-17 07:28:13,882] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/6000/mp_rank_00_model_states.pt...
[2024-06-17 07:28:42,113] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/6000/mp_rank_00_model_states.pt.
[2024-06-17 07:28:48,699] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 07:28:48,699] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 07:28:48,699] [INFO] [RANK 0]  validation loss at iteration 6000 | loss: 8.602539E-01 | PPL: 2.363761E+00 loss 8.603516E-01 |
[2024-06-17 07:28:48,699] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 07:28:57,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=6010, skipped=29, lr=[8.378743394231554e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:28:57,662] [INFO] [timer.py:258:stop] epoch=0/micro_step=6010/global_step=6010, RunningAvgSamplesPerSec=4.497485670242035, CurrSamplesPerSec=4.524662016656648, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:29:06,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=6020, skipped=29, lr=[8.373306879298629e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:29:06,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=6020/global_step=6020, RunningAvgSamplesPerSec=4.497524566815028, CurrSamplesPerSec=4.51306032229889, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:29:15,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=6030, skipped=29, lr=[8.367863274766607e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:29:15,681] [INFO] [timer.py:258:stop] epoch=0/micro_step=6030/global_step=6030, RunningAvgSamplesPerSec=4.497550977543856, CurrSamplesPerSec=4.516650576681924, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:29:24,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=6040, skipped=29, lr=[8.362412594067037e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:29:24,753] [INFO] [timer.py:258:stop] epoch=0/micro_step=6040/global_step=6040, RunningAvgSamplesPerSec=4.497540141326738, CurrSamplesPerSec=4.493881895757854, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:29:33,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=6050, skipped=29, lr=[8.356954850648937e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:29:33,831] [INFO] [timer.py:258:stop] epoch=0/micro_step=6050/global_step=6050, RunningAvgSamplesPerSec=4.497527855439603, CurrSamplesPerSec=4.485346950233261, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:29:33,832] [INFO] [RANK 0]  iteration     6050/   20000 | elapsed time per iteration (ms): 1599.3 | learning rate 8.356E-05 | total loss 4.810742E-01 | loss 4.810742E-01 | loss scale 32768.0 |speed 150.07 samples/(min*GPU)
[2024-06-17 07:29:33,833] [INFO] [RANK 0] time (ms) | forward: 354.71 | backward: 543.83 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 18.18 | data loader: 0.17
[2024-06-17 07:29:42,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=6060, skipped=29, lr=[8.351490057978745e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:29:42,910] [INFO] [timer.py:258:stop] epoch=0/micro_step=6060/global_step=6060, RunningAvgSamplesPerSec=4.497498152831776, CurrSamplesPerSec=4.464599801161946, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:29:51,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=6070, skipped=29, lr=[8.346018229540293e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:29:51,982] [INFO] [timer.py:258:stop] epoch=0/micro_step=6070/global_step=6070, RunningAvgSamplesPerSec=4.4974792395222325, CurrSamplesPerSec=4.479298230063215, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:30:01,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=6080, skipped=29, lr=[8.340539378834772e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:30:01,058] [INFO] [timer.py:258:stop] epoch=0/micro_step=6080/global_step=6080, RunningAvgSamplesPerSec=4.4974603564719615, CurrSamplesPerSec=4.480609335795674, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:30:10,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=6090, skipped=29, lr=[8.335053519380704e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:30:10,129] [INFO] [timer.py:258:stop] epoch=0/micro_step=6090/global_step=6090, RunningAvgSamplesPerSec=4.49744696547336, CurrSamplesPerSec=4.486849984100864, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:30:19,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=6100, skipped=29, lr=[8.329560664713905e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:30:19,216] [INFO] [timer.py:258:stop] epoch=0/micro_step=6100/global_step=6100, RunningAvgSamplesPerSec=4.497421843861771, CurrSamplesPerSec=4.489716094743913, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:30:19,216] [INFO] [RANK 0]  iteration     6100/   20000 | elapsed time per iteration (ms): 907.7 | learning rate 8.329E-05 | total loss 4.620288E-01 | loss 4.620288E-01 | loss scale 32768.0 |speed 264.41 samples/(min*GPU)
[2024-06-17 07:30:19,217] [INFO] [RANK 0] time (ms) | forward: 356.94 | backward: 546.69 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.24 | data loader: 0.16
[2024-06-17 07:30:28,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=6110, skipped=29, lr=[8.324060828387441e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:30:28,299] [INFO] [timer.py:258:stop] epoch=0/micro_step=6110/global_step=6110, RunningAvgSamplesPerSec=4.49738248450797, CurrSamplesPerSec=4.456858657742261, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:30:37,398] [INFO] [logging.py:96:log_dist] [Rank 0] step=6120, skipped=29, lr=[8.318554023971616e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:30:37,399] [INFO] [timer.py:258:stop] epoch=0/micro_step=6120/global_step=6120, RunningAvgSamplesPerSec=4.497344705407631, CurrSamplesPerSec=4.489392918908056, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:30:46,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=6130, skipped=29, lr=[8.313040265053918e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:30:46,473] [INFO] [timer.py:258:stop] epoch=0/micro_step=6130/global_step=6130, RunningAvgSamplesPerSec=4.497322202682617, CurrSamplesPerSec=4.49070873965199, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:30:55,565] [INFO] [logging.py:96:log_dist] [Rank 0] step=6140, skipped=29, lr=[8.307519565239005e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:30:55,566] [INFO] [timer.py:258:stop] epoch=0/micro_step=6140/global_step=6140, RunningAvgSamplesPerSec=4.497291693139751, CurrSamplesPerSec=4.467447064083355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:31:04,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=6150, skipped=29, lr=[8.301991938148651e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:31:04,639] [INFO] [timer.py:258:stop] epoch=0/micro_step=6150/global_step=6150, RunningAvgSamplesPerSec=4.49726319547254, CurrSamplesPerSec=4.477849250796631, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:31:04,639] [INFO] [RANK 0]  iteration     6150/   20000 | elapsed time per iteration (ms): 908.5 | learning rate 8.301E-05 | total loss 3.871460E-01 | loss 3.871460E-01 | loss scale 32768.0 |speed 264.18 samples/(min*GPU)
[2024-06-17 07:31:04,641] [INFO] [RANK 0] time (ms) | forward: 357.53 | backward: 546.71 | allreduce: 0.00 | optimizer: 3.43 | batch generator: 14.65 | data loader: 0.25
[2024-06-17 07:31:13,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=6160, skipped=29, lr=[8.296457397421726e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:31:13,720] [INFO] [timer.py:258:stop] epoch=0/micro_step=6160/global_step=6160, RunningAvgSamplesPerSec=4.497236929436048, CurrSamplesPerSec=4.474979168422636, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:31:22,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=6170, skipped=29, lr=[8.290915956714163e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:31:22,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=6170/global_step=6170, RunningAvgSamplesPerSec=4.497214553388647, CurrSamplesPerSec=4.482673249470099, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:31:31,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=6180, skipped=29, lr=[8.285367629698913e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:31:31,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=6180/global_step=6180, RunningAvgSamplesPerSec=4.49719126129752, CurrSamplesPerSec=4.484830177704129, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:31:40,944] [INFO] [logging.py:96:log_dist] [Rank 0] step=6190, skipped=29, lr=[8.27981243006592e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:31:40,945] [INFO] [timer.py:258:stop] epoch=0/micro_step=6190/global_step=6190, RunningAvgSamplesPerSec=4.497170742633311, CurrSamplesPerSec=4.488633818933566, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:31:50,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=6200, skipped=29, lr=[8.274250371522094e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:31:50,022] [INFO] [timer.py:258:stop] epoch=0/micro_step=6200/global_step=6200, RunningAvgSamplesPerSec=4.497153832664607, CurrSamplesPerSec=4.483152387541182, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:31:50,022] [INFO] [RANK 0]  iteration     6200/   20000 | elapsed time per iteration (ms): 907.7 | learning rate 8.274E-05 | total loss 4.405786E-01 | loss 4.405786E-01 | loss scale 32768.0 |speed 264.42 samples/(min*GPU)
[2024-06-17 07:31:50,024] [INFO] [RANK 0] time (ms) | forward: 356.98 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 15.02 | data loader: 0.22
[2024-06-17 07:31:59,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=6210, skipped=29, lr=[8.26868146779125e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:31:59,103] [INFO] [timer.py:258:stop] epoch=0/micro_step=6210/global_step=6210, RunningAvgSamplesPerSec=4.497124835948539, CurrSamplesPerSec=4.482791826605268, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:32:08,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=6220, skipped=29, lr=[8.263105732614115e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:32:08,173] [INFO] [timer.py:258:stop] epoch=0/micro_step=6220/global_step=6220, RunningAvgSamplesPerSec=4.497099913840492, CurrSamplesPerSec=4.47159665155631, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:32:17,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=6230, skipped=29, lr=[8.257523179748255e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:32:17,256] [INFO] [timer.py:258:stop] epoch=0/micro_step=6230/global_step=6230, RunningAvgSamplesPerSec=4.497068488080319, CurrSamplesPerSec=4.470378958127608, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:32:26,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=6240, skipped=29, lr=[8.251933822968067e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:32:26,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=6240/global_step=6240, RunningAvgSamplesPerSec=4.497046263973581, CurrSamplesPerSec=4.4749075530196505, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:32:35,432] [INFO] [logging.py:96:log_dist] [Rank 0] step=6250, skipped=29, lr=[8.246337676064732e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:32:35,433] [INFO] [timer.py:258:stop] epoch=0/micro_step=6250/global_step=6250, RunningAvgSamplesPerSec=4.497017318137697, CurrSamplesPerSec=4.48709478728631, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:32:35,434] [INFO] [RANK 0]  iteration     6250/   20000 | elapsed time per iteration (ms): 908.2 | learning rate 8.246E-05 | total loss 4.274036E-01 | loss 4.274036E-01 | loss scale 32768.0 |speed 264.25 samples/(min*GPU)
[2024-06-17 07:32:35,435] [INFO] [RANK 0] time (ms) | forward: 357.57 | backward: 546.45 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 14.64 | data loader: 0.23
[2024-06-17 07:32:44,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=6260, skipped=29, lr=[8.240734752846187e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:32:44,503] [INFO] [timer.py:258:stop] epoch=0/micro_step=6260/global_step=6260, RunningAvgSamplesPerSec=4.497000195988503, CurrSamplesPerSec=4.497114989243196, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:32:53,582] [INFO] [logging.py:96:log_dist] [Rank 0] step=6270, skipped=29, lr=[8.235125067137088e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:32:53,582] [INFO] [timer.py:258:stop] epoch=0/micro_step=6270/global_step=6270, RunningAvgSamplesPerSec=4.496980065933701, CurrSamplesPerSec=4.468457258159884, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:33:02,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=6280, skipped=29, lr=[8.229508632778777e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:33:02,643] [INFO] [timer.py:258:stop] epoch=0/micro_step=6280/global_step=6280, RunningAvgSamplesPerSec=4.496961823401457, CurrSamplesPerSec=4.476683097236724, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:33:11,712] [INFO] [logging.py:96:log_dist] [Rank 0] step=6290, skipped=29, lr=[8.223885463629245e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:33:11,713] [INFO] [timer.py:258:stop] epoch=0/micro_step=6290/global_step=6290, RunningAvgSamplesPerSec=4.49694188314798, CurrSamplesPerSec=4.483194316995729, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:33:20,791] [INFO] [logging.py:96:log_dist] [Rank 0] step=6300, skipped=29, lr=[8.218255573563106e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:33:20,792] [INFO] [timer.py:258:stop] epoch=0/micro_step=6300/global_step=6300, RunningAvgSamplesPerSec=4.496924043497083, CurrSamplesPerSec=4.483847319708336, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:33:20,793] [INFO] [RANK 0]  iteration     6300/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 8.218E-05 | total loss 4.458856E-01 | loss 4.458856E-01 | loss scale 32768.0 |speed 264.55 samples/(min*GPU)
[2024-06-17 07:33:20,794] [INFO] [RANK 0] time (ms) | forward: 356.87 | backward: 546.11 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 14.79 | data loader: 0.23
[2024-06-17 07:33:20,795] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:33:20,808] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/6300/mp_rank_00_model_states.pt
[2024-06-17 07:33:20,808] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/6300/mp_rank_00_model_states.pt...
[2024-06-17 07:33:47,712] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/6300/mp_rank_00_model_states.pt.
[2024-06-17 07:33:56,745] [INFO] [logging.py:96:log_dist] [Rank 0] step=6310, skipped=29, lr=[8.212618976471554e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:33:56,746] [INFO] [timer.py:258:stop] epoch=0/micro_step=6310/global_step=6310, RunningAvgSamplesPerSec=4.496965096686526, CurrSamplesPerSec=4.4994028854057575, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:34:05,739] [INFO] [logging.py:96:log_dist] [Rank 0] step=6320, skipped=29, lr=[8.206975686262333e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:34:05,739] [INFO] [timer.py:258:stop] epoch=0/micro_step=6320/global_step=6320, RunningAvgSamplesPerSec=4.4970079729838135, CurrSamplesPerSec=4.515174904595047, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:34:14,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=6330, skipped=29, lr=[8.201325716859693e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:34:14,763] [INFO] [timer.py:258:stop] epoch=0/micro_step=6330/global_step=6330, RunningAvgSamplesPerSec=4.497028248648054, CurrSamplesPerSec=4.512630603563633, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:34:23,779] [INFO] [logging.py:96:log_dist] [Rank 0] step=6340, skipped=29, lr=[8.195669082204382e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:34:23,779] [INFO] [timer.py:258:stop] epoch=0/micro_step=6340/global_step=6340, RunningAvgSamplesPerSec=4.497050400430955, CurrSamplesPerSec=4.512537144504765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:34:32,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=6350, skipped=29, lr=[8.190005796253577e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:34:32,837] [INFO] [timer.py:258:stop] epoch=0/micro_step=6350/global_step=6350, RunningAvgSamplesPerSec=4.497050456413074, CurrSamplesPerSec=4.481823031577519, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:34:32,839] [INFO] [RANK 0]  iteration     6350/   20000 | elapsed time per iteration (ms): 1440.9 | learning rate 8.189E-05 | total loss 4.251563E-01 | loss 4.251563E-01 | loss scale 32768.0 |speed 166.56 samples/(min*GPU)
[2024-06-17 07:34:32,839] [INFO] [RANK 0] time (ms) | forward: 355.44 | backward: 542.78 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 15.41 | data loader: 0.23
[2024-06-17 07:34:41,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=6360, skipped=29, lr=[8.184335872980875e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:34:41,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=6360/global_step=6360, RunningAvgSamplesPerSec=4.497048371560974, CurrSamplesPerSec=4.4878521662696125, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:34:46,412] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 07:34:47,313] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 07:34:50,936] [INFO] [logging.py:96:log_dist] [Rank 0] step=6370, skipped=31, lr=[8.179795164891663e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:34:50,936] [INFO] [timer.py:258:stop] epoch=0/micro_step=6370/global_step=6370, RunningAvgSamplesPerSec=4.497039967704029, CurrSamplesPerSec=4.468984549078419, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:34:59,988] [INFO] [logging.py:96:log_dist] [Rank 0] step=6380, skipped=31, lr=[8.17411332970526e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:34:59,989] [INFO] [timer.py:258:stop] epoch=0/micro_step=6380/global_step=6380, RunningAvgSamplesPerSec=4.4970310315655, CurrSamplesPerSec=4.490072963749892, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:35:09,051] [INFO] [logging.py:96:log_dist] [Rank 0] step=6390, skipped=31, lr=[8.168424896410042e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:35:09,052] [INFO] [timer.py:258:stop] epoch=0/micro_step=6390/global_step=6390, RunningAvgSamplesPerSec=4.497017567919236, CurrSamplesPerSec=4.4896980725616, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:35:18,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=6400, skipped=31, lr=[8.162729879041653e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:35:18,111] [INFO] [timer.py:258:stop] epoch=0/micro_step=6400/global_step=6400, RunningAvgSamplesPerSec=4.4969927024474465, CurrSamplesPerSec=4.496095412364117, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:35:18,112] [INFO] [RANK 0]  iteration     6400/   20000 | elapsed time per iteration (ms): 905.5 | learning rate 8.162E-05 | total loss 4.175964E-01 | loss 4.175964E-01 | loss scale 32768.0 |speed 265.06 samples/(min*GPU)
[2024-06-17 07:35:18,113] [INFO] [RANK 0] time (ms) | forward: 355.30 | backward: 546.27 | allreduce: 0.00 | optimizer: 3.12 | batch generator: 14.02 | data loader: 0.23
[2024-06-17 07:35:27,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=6410, skipped=31, lr=[8.157028291651982e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:35:27,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=6410/global_step=6410, RunningAvgSamplesPerSec=4.496967714714684, CurrSamplesPerSec=4.467376879112639, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:35:36,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=6420, skipped=31, lr=[8.15132014830913e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:35:36,281] [INFO] [timer.py:258:stop] epoch=0/micro_step=6420/global_step=6420, RunningAvgSamplesPerSec=4.496941321627549, CurrSamplesPerSec=4.479647464267014, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:35:45,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=6430, skipped=31, lr=[8.145605463097368e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:35:45,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=6430/global_step=6430, RunningAvgSamplesPerSec=4.496927825895663, CurrSamplesPerSec=4.497075209846959, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:35:54,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=6440, skipped=31, lr=[8.139884250117121e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:35:54,413] [INFO] [timer.py:258:stop] epoch=0/micro_step=6440/global_step=6440, RunningAvgSamplesPerSec=4.496913529106239, CurrSamplesPerSec=4.48393839575051, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:36:03,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=6450, skipped=31, lr=[8.134156523484908e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:36:03,490] [INFO] [timer.py:258:stop] epoch=0/micro_step=6450/global_step=6450, RunningAvgSamplesPerSec=4.496891801579703, CurrSamplesPerSec=4.487294009591778, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:36:03,490] [INFO] [RANK 0]  iteration     6450/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 8.134E-05 | total loss 4.221777E-01 | loss 4.221777E-01 | loss scale 32768.0 |speed 264.44 samples/(min*GPU)
[2024-06-17 07:36:03,491] [INFO] [RANK 0] time (ms) | forward: 357.24 | backward: 546.39 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 15.00 | data loader: 0.21
[2024-06-17 07:36:12,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=6460, skipped=31, lr=[8.12842229733333e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:36:12,592] [INFO] [timer.py:258:stop] epoch=0/micro_step=6460/global_step=6460, RunningAvgSamplesPerSec=4.496858984476588, CurrSamplesPerSec=4.490855390268698, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:36:21,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=6470, skipped=31, lr=[8.122681585811014e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:36:21,676] [INFO] [timer.py:258:stop] epoch=0/micro_step=6470/global_step=6470, RunningAvgSamplesPerSec=4.49683803660776, CurrSamplesPerSec=4.479190600361865, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:36:30,757] [INFO] [logging.py:96:log_dist] [Rank 0] step=6480, skipped=31, lr=[8.116934403082601e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:36:30,758] [INFO] [timer.py:258:stop] epoch=0/micro_step=6480/global_step=6480, RunningAvgSamplesPerSec=4.496817298360622, CurrSamplesPerSec=4.46409848828738, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:36:39,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=6490, skipped=31, lr=[8.111180763328687e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:36:39,825] [INFO] [timer.py:258:stop] epoch=0/micro_step=6490/global_step=6490, RunningAvgSamplesPerSec=4.496794299134839, CurrSamplesPerSec=4.467473235314872, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:36:48,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=6500, skipped=31, lr=[8.105420680745814e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:36:48,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=6500/global_step=6500, RunningAvgSamplesPerSec=4.496779396942274, CurrSamplesPerSec=4.477439355056343, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:36:48,893] [INFO] [RANK 0]  iteration     6500/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 8.105E-05 | total loss 4.224762E-01 | loss 4.224762E-01 | loss scale 32768.0 |speed 264.30 samples/(min*GPU)
[2024-06-17 07:36:48,894] [INFO] [RANK 0] time (ms) | forward: 357.56 | backward: 546.54 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 15.15 | data loader: 0.24
[2024-06-17 07:36:57,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=6510, skipped=31, lr=[8.099654169546403e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:36:57,970] [INFO] [timer.py:258:stop] epoch=0/micro_step=6510/global_step=6510, RunningAvgSamplesPerSec=4.496754467642426, CurrSamplesPerSec=4.473262223857536, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:37:07,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=6520, skipped=31, lr=[8.093881243958756e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:37:07,042] [INFO] [timer.py:258:stop] epoch=0/micro_step=6520/global_step=6520, RunningAvgSamplesPerSec=4.496726812809228, CurrSamplesPerSec=4.470133593379481, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:37:16,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=6530, skipped=31, lr=[8.088101918226987e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:37:16,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=6530/global_step=6530, RunningAvgSamplesPerSec=4.496700126651024, CurrSamplesPerSec=4.490764033021962, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:37:25,191] [INFO] [logging.py:96:log_dist] [Rank 0] step=6540, skipped=31, lr=[8.082316206611012e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:37:25,192] [INFO] [timer.py:258:stop] epoch=0/micro_step=6540/global_step=6540, RunningAvgSamplesPerSec=4.496673183626537, CurrSamplesPerSec=4.467205589460119, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:37:34,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=6550, skipped=31, lr=[8.076524123386497e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:37:34,255] [INFO] [timer.py:258:stop] epoch=0/micro_step=6550/global_step=6550, RunningAvgSamplesPerSec=4.496658709084957, CurrSamplesPerSec=4.477460863754251, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:37:34,256] [INFO] [RANK 0]  iteration     6550/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 8.076E-05 | total loss 4.392004E-01 | loss 4.392004E-01 | loss scale 32768.0 |speed 264.54 samples/(min*GPU)
[2024-06-17 07:37:34,256] [INFO] [RANK 0] time (ms) | forward: 356.18 | backward: 547.05 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.06 | data loader: 0.10
[2024-06-17 07:37:43,351] [INFO] [logging.py:96:log_dist] [Rank 0] step=6560, skipped=31, lr=[8.070725682844834e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:37:43,352] [INFO] [timer.py:258:stop] epoch=0/micro_step=6560/global_step=6560, RunningAvgSamplesPerSec=4.49663467289548, CurrSamplesPerSec=4.470454002239861, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:37:52,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=6570, skipped=31, lr=[8.064920899293096e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:37:52,431] [INFO] [timer.py:258:stop] epoch=0/micro_step=6570/global_step=6570, RunningAvgSamplesPerSec=4.496603840400674, CurrSamplesPerSec=4.477017587351687, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:38:01,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=6580, skipped=31, lr=[8.05910978705401e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:38:01,511] [INFO] [timer.py:258:stop] epoch=0/micro_step=6580/global_step=6580, RunningAvgSamplesPerSec=4.496582621507846, CurrSamplesPerSec=4.48206369433558, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:38:10,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=6590, skipped=31, lr=[8.053292360465918e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:38:10,596] [INFO] [timer.py:258:stop] epoch=0/micro_step=6590/global_step=6590, RunningAvgSamplesPerSec=4.496546902302925, CurrSamplesPerSec=4.481983470544502, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:38:19,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=6600, skipped=31, lr=[8.047468633882741e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:38:19,700] [INFO] [timer.py:258:stop] epoch=0/micro_step=6600/global_step=6600, RunningAvgSamplesPerSec=4.496518426613021, CurrSamplesPerSec=4.479869950064392, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:38:19,701] [INFO] [RANK 0]  iteration     6600/   20000 | elapsed time per iteration (ms): 908.9 | learning rate 8.047E-05 | total loss 4.088727E-01 | loss 4.088727E-01 | loss scale 32768.0 |speed 264.05 samples/(min*GPU)
[2024-06-17 07:38:19,702] [INFO] [RANK 0] time (ms) | forward: 357.72 | backward: 546.87 | allreduce: 0.00 | optimizer: 3.52 | batch generator: 15.14 | data loader: 0.12
[2024-06-17 07:38:19,702] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:38:19,719] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/6600/mp_rank_00_model_states.pt
[2024-06-17 07:38:19,719] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/6600/mp_rank_00_model_states.pt...
[2024-06-17 07:38:50,399] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/6600/mp_rank_00_model_states.pt.
[2024-06-17 07:38:59,387] [INFO] [logging.py:96:log_dist] [Rank 0] step=6610, skipped=31, lr=[8.041638621673948e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:38:59,387] [INFO] [timer.py:258:stop] epoch=0/micro_step=6610/global_step=6610, RunningAvgSamplesPerSec=4.49657765234188, CurrSamplesPerSec=4.542537170780628, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:39:08,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=6620, skipped=31, lr=[8.035802338224512e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:39:08,375] [INFO] [timer.py:258:stop] epoch=0/micro_step=6620/global_step=6620, RunningAvgSamplesPerSec=4.496619354559076, CurrSamplesPerSec=4.511333446628361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:39:17,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=6630, skipped=31, lr=[8.029959797934883e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:39:17,386] [INFO] [timer.py:258:stop] epoch=0/micro_step=6630/global_step=6630, RunningAvgSamplesPerSec=4.496648150915701, CurrSamplesPerSec=4.5159624579956565, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:39:26,430] [INFO] [logging.py:96:log_dist] [Rank 0] step=6640, skipped=31, lr=[8.02411101522095e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:39:26,431] [INFO] [timer.py:258:stop] epoch=0/micro_step=6640/global_step=6640, RunningAvgSamplesPerSec=4.496661591339235, CurrSamplesPerSec=4.504708846294396, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:39:35,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=6650, skipped=31, lr=[8.018256004514e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:39:35,492] [INFO] [timer.py:258:stop] epoch=0/micro_step=6650/global_step=6650, RunningAvgSamplesPerSec=4.496653366422138, CurrSamplesPerSec=4.490092190626675, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:39:35,493] [INFO] [RANK 0]  iteration     6650/   20000 | elapsed time per iteration (ms): 1515.8 | learning rate 8.018E-05 | total loss 4.117294E-01 | loss 4.117294E-01 | loss scale 32768.0 |speed 158.33 samples/(min*GPU)
[2024-06-17 07:39:35,494] [INFO] [RANK 0] time (ms) | forward: 354.60 | backward: 542.97 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 15.12 | data loader: 0.14
[2024-06-17 07:39:43,644] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
[2024-06-17 07:39:44,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=6660, skipped=32, lr=[8.012981181883562e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:39:44,551] [INFO] [timer.py:258:stop] epoch=0/micro_step=6660/global_step=6660, RunningAvgSamplesPerSec=4.496643056698973, CurrSamplesPerSec=4.4869687823106, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:39:53,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=6670, skipped=32, lr=[8.007114377803092e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:39:53,623] [INFO] [timer.py:258:stop] epoch=0/micro_step=6670/global_step=6670, RunningAvgSamplesPerSec=4.49663068929096, CurrSamplesPerSec=4.491710241433345, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:40:02,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=6680, skipped=32, lr=[8.001241387667122e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:40:02,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=6680/global_step=6680, RunningAvgSamplesPerSec=4.496614222253444, CurrSamplesPerSec=4.493765138506199, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:40:11,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=6690, skipped=32, lr=[7.99536222596667e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:40:11,766] [INFO] [timer.py:258:stop] epoch=0/micro_step=6690/global_step=6690, RunningAvgSamplesPerSec=4.496595429019822, CurrSamplesPerSec=4.487850965783687, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:40:20,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=6700, skipped=32, lr=[7.989476907207982e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:40:20,832] [INFO] [timer.py:258:stop] epoch=0/micro_step=6700/global_step=6700, RunningAvgSamplesPerSec=4.4965765727662195, CurrSamplesPerSec=4.476195786821952, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:40:20,833] [INFO] [RANK 0]  iteration     6700/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 7.989E-05 | total loss 4.124524E-01 | loss 4.124524E-01 | loss scale 16384.0 |speed 264.67 samples/(min*GPU)
[2024-06-17 07:40:20,834] [INFO] [RANK 0] time (ms) | forward: 356.39 | backward: 546.40 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.70 | data loader: 0.22
[2024-06-17 07:40:29,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=6710, skipped=32, lr=[7.983585445912495e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:40:29,919] [INFO] [timer.py:258:stop] epoch=0/micro_step=6710/global_step=6710, RunningAvgSamplesPerSec=4.496552749828069, CurrSamplesPerSec=4.480391562540809, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:40:38,988] [INFO] [logging.py:96:log_dist] [Rank 0] step=6720, skipped=32, lr=[7.977687856616808e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:40:38,988] [INFO] [timer.py:258:stop] epoch=0/micro_step=6720/global_step=6720, RunningAvgSamplesPerSec=4.496534568984588, CurrSamplesPerSec=4.489603158122339, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:40:48,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=6730, skipped=32, lr=[7.971784153872634e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:40:48,062] [INFO] [timer.py:258:stop] epoch=0/micro_step=6730/global_step=6730, RunningAvgSamplesPerSec=4.496506534814142, CurrSamplesPerSec=4.48173204144714, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:40:57,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=6740, skipped=32, lr=[7.965874352246773e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:40:57,140] [INFO] [timer.py:258:stop] epoch=0/micro_step=6740/global_step=6740, RunningAvgSamplesPerSec=4.496483809733074, CurrSamplesPerSec=4.46911073646278, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:41:06,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=6750, skipped=32, lr=[7.959958466321073e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:41:06,216] [INFO] [timer.py:258:stop] epoch=0/micro_step=6750/global_step=6750, RunningAvgSamplesPerSec=4.49646678358468, CurrSamplesPerSec=4.459705536162571, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:41:06,217] [INFO] [RANK 0]  iteration     6750/   20000 | elapsed time per iteration (ms): 907.7 | learning rate 7.959E-05 | total loss 3.681580E-01 | loss 3.681580E-01 | loss scale 16384.0 |speed 264.41 samples/(min*GPU)
[2024-06-17 07:41:06,218] [INFO] [RANK 0] time (ms) | forward: 356.71 | backward: 546.77 | allreduce: 0.00 | optimizer: 3.39 | batch generator: 14.59 | data loader: 0.23
[2024-06-17 07:41:15,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=6760, skipped=32, lr=[7.954036510692393e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:41:15,309] [INFO] [timer.py:258:stop] epoch=0/micro_step=6760/global_step=6760, RunningAvgSamplesPerSec=4.4964437978447, CurrSamplesPerSec=4.484869740764661, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:41:24,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=6770, skipped=32, lr=[7.948108499972574e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:41:24,390] [INFO] [timer.py:258:stop] epoch=0/micro_step=6770/global_step=6770, RunningAvgSamplesPerSec=4.4964314321712795, CurrSamplesPerSec=4.492333249344715, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:41:33,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=6780, skipped=32, lr=[7.94217444878839e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:41:33,457] [INFO] [timer.py:258:stop] epoch=0/micro_step=6780/global_step=6780, RunningAvgSamplesPerSec=4.496413440564369, CurrSamplesPerSec=4.475497254768476, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:41:42,540] [INFO] [logging.py:96:log_dist] [Rank 0] step=6790, skipped=32, lr=[7.936234371781523e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:41:42,541] [INFO] [timer.py:258:stop] epoch=0/micro_step=6790/global_step=6790, RunningAvgSamplesPerSec=4.496388305485347, CurrSamplesPerSec=4.471497733896405, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:41:51,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=6800, skipped=32, lr=[7.930288283608521e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:41:51,619] [INFO] [timer.py:258:stop] epoch=0/micro_step=6800/global_step=6800, RunningAvgSamplesPerSec=4.496364284822758, CurrSamplesPerSec=4.479238435146124, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:41:51,620] [INFO] [RANK 0]  iteration     6800/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 7.930E-05 | total loss 4.460657E-01 | loss 4.460657E-01 | loss scale 16384.0 |speed 264.30 samples/(min*GPU)
[2024-06-17 07:41:51,621] [INFO] [RANK 0] time (ms) | forward: 357.21 | backward: 546.70 | allreduce: 0.00 | optimizer: 3.39 | batch generator: 15.19 | data loader: 0.23
[2024-06-17 07:42:00,707] [INFO] [logging.py:96:log_dist] [Rank 0] step=6810, skipped=32, lr=[7.924336198940769e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:42:00,708] [INFO] [timer.py:258:stop] epoch=0/micro_step=6810/global_step=6810, RunningAvgSamplesPerSec=4.496341172025707, CurrSamplesPerSec=4.4727518093257155, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:42:09,769] [INFO] [logging.py:96:log_dist] [Rank 0] step=6820, skipped=32, lr=[7.91837813246444e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:42:09,769] [INFO] [timer.py:258:stop] epoch=0/micro_step=6820/global_step=6820, RunningAvgSamplesPerSec=4.496324429148492, CurrSamplesPerSec=4.483411164691153, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:42:18,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=6830, skipped=32, lr=[7.912414098880476e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:42:18,857] [INFO] [timer.py:258:stop] epoch=0/micro_step=6830/global_step=6830, RunningAvgSamplesPerSec=4.496305960565699, CurrSamplesPerSec=4.49219973310085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:42:27,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=6840, skipped=32, lr=[7.906444112904531e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:42:27,931] [INFO] [timer.py:258:stop] epoch=0/micro_step=6840/global_step=6840, RunningAvgSamplesPerSec=4.496281948126574, CurrSamplesPerSec=4.483472269211179, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:42:37,022] [INFO] [logging.py:96:log_dist] [Rank 0] step=6850, skipped=32, lr=[7.900468189266957e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:42:37,023] [INFO] [timer.py:258:stop] epoch=0/micro_step=6850/global_step=6850, RunningAvgSamplesPerSec=4.496254599451547, CurrSamplesPerSec=4.48166858999017, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:42:37,024] [INFO] [RANK 0]  iteration     6850/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 7.900E-05 | total loss 4.153760E-01 | loss 4.153760E-01 | loss scale 16384.0 |speed 264.29 samples/(min*GPU)
[2024-06-17 07:42:37,025] [INFO] [RANK 0] time (ms) | forward: 357.05 | backward: 546.92 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 14.94 | data loader: 0.11
[2024-06-17 07:42:46,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=6860, skipped=32, lr=[7.894486342712749e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:42:46,127] [INFO] [timer.py:258:stop] epoch=0/micro_step=6860/global_step=6860, RunningAvgSamplesPerSec=4.496223427099174, CurrSamplesPerSec=4.484600006468733, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:42:55,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=6870, skipped=32, lr=[7.88849858800152e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:42:55,202] [INFO] [timer.py:258:stop] epoch=0/micro_step=6870/global_step=6870, RunningAvgSamplesPerSec=4.49620387882188, CurrSamplesPerSec=4.480328149034353, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:43:04,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=6880, skipped=32, lr=[7.882504939907458e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:43:04,259] [INFO] [timer.py:258:stop] epoch=0/micro_step=6880/global_step=6880, RunningAvgSamplesPerSec=4.496191791745325, CurrSamplesPerSec=4.481706900088901, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:43:13,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=6890, skipped=32, lr=[7.876505413219295e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:43:13,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=6890/global_step=6890, RunningAvgSamplesPerSec=4.4961688825753345, CurrSamplesPerSec=4.458363981921231, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:43:22,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=6900, skipped=32, lr=[7.870500022740265e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:43:22,413] [INFO] [timer.py:258:stop] epoch=0/micro_step=6900/global_step=6900, RunningAvgSamplesPerSec=4.49614120655601, CurrSamplesPerSec=4.478922744449473, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:43:22,414] [INFO] [RANK 0]  iteration     6900/   20000 | elapsed time per iteration (ms): 907.8 | learning rate 7.870E-05 | total loss 4.033118E-01 | loss 4.033118E-01 | loss scale 16384.0 |speed 264.38 samples/(min*GPU)
[2024-06-17 07:43:22,418] [INFO] [RANK 0] time (ms) | forward: 356.61 | backward: 547.15 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.43 | data loader: 0.10
[2024-06-17 07:43:22,418] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:43:22,434] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/6900/mp_rank_00_model_states.pt
[2024-06-17 07:43:22,435] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/6900/mp_rank_00_model_states.pt...
[2024-06-17 07:43:52,890] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/6900/mp_rank_00_model_states.pt.
[2024-06-17 07:44:01,887] [INFO] [logging.py:96:log_dist] [Rank 0] step=6910, skipped=32, lr=[7.864488783288074e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:44:01,888] [INFO] [timer.py:258:stop] epoch=0/micro_step=6910/global_step=6910, RunningAvgSamplesPerSec=4.496202014737674, CurrSamplesPerSec=4.531573127363737, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:44:10,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=6920, skipped=32, lr=[7.858471709694859e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:44:10,880] [INFO] [timer.py:258:stop] epoch=0/micro_step=6920/global_step=6920, RunningAvgSamplesPerSec=4.496246192467725, CurrSamplesPerSec=4.525230729311503, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:44:19,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=6930, skipped=32, lr=[7.852448816807146e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:44:19,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=6930/global_step=6930, RunningAvgSamplesPerSec=4.496277924788161, CurrSamplesPerSec=4.5178084508346945, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:44:28,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=6940, skipped=32, lr=[7.846420119485829e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:44:28,907] [INFO] [timer.py:258:stop] epoch=0/micro_step=6940/global_step=6940, RunningAvgSamplesPerSec=4.496299459815846, CurrSamplesPerSec=4.514462940011183, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:44:37,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=6950, skipped=32, lr=[7.840385632606118e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:44:37,940] [INFO] [timer.py:258:stop] epoch=0/micro_step=6950/global_step=6950, RunningAvgSamplesPerSec=4.496309586498642, CurrSamplesPerSec=4.4895034422116, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:44:37,941] [INFO] [RANK 0]  iteration     6950/   20000 | elapsed time per iteration (ms): 1510.5 | learning rate 7.840E-05 | total loss 3.805066E-01 | loss 3.805066E-01 | loss scale 16384.0 |speed 158.88 samples/(min*GPU)
[2024-06-17 07:44:37,942] [INFO] [RANK 0] time (ms) | forward: 353.95 | backward: 542.81 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 15.21 | data loader: 0.22
[2024-06-17 07:44:47,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=6960, skipped=32, lr=[7.83434537105751e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:44:47,008] [INFO] [timer.py:258:stop] epoch=0/micro_step=6960/global_step=6960, RunningAvgSamplesPerSec=4.496303413628799, CurrSamplesPerSec=4.489647611220843, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:44:56,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=6970, skipped=32, lr=[7.828299349743748e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:44:56,103] [INFO] [timer.py:258:stop] epoch=0/micro_step=6970/global_step=6970, RunningAvgSamplesPerSec=4.496282691218496, CurrSamplesPerSec=4.4754101028208035, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:45:05,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=6980, skipped=32, lr=[7.82224758358279e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:45:05,166] [INFO] [timer.py:258:stop] epoch=0/micro_step=6980/global_step=6980, RunningAvgSamplesPerSec=4.496269565720386, CurrSamplesPerSec=4.4878833791291095, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:45:14,241] [INFO] [logging.py:96:log_dist] [Rank 0] step=6990, skipped=32, lr=[7.816190087506769e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:45:14,242] [INFO] [timer.py:258:stop] epoch=0/micro_step=6990/global_step=6990, RunningAvgSamplesPerSec=4.4962539535669555, CurrSamplesPerSec=4.480064942347645, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:45:23,315] [INFO] [logging.py:96:log_dist] [Rank 0] step=7000, skipped=32, lr=[7.810126876461952e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:45:23,316] [INFO] [timer.py:258:stop] epoch=0/micro_step=7000/global_step=7000, RunningAvgSamplesPerSec=4.496236618106784, CurrSamplesPerSec=4.481692533725123, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:45:23,317] [INFO] [RANK 0]  iteration     7000/   20000 | elapsed time per iteration (ms): 907.5 | learning rate 7.810E-05 | total loss 4.344983E-01 | loss 4.344983E-01 | loss scale 16384.0 |speed 264.46 samples/(min*GPU)
[2024-06-17 07:45:23,318] [INFO] [RANK 0] time (ms) | forward: 356.93 | backward: 546.46 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 15.35 | data loader: 0.17
[2024-06-17 07:45:29,965] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 07:45:29,965] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 07:45:29,965] [INFO] [RANK 0]  validation loss at iteration 7000 | loss: 8.023926E-01 | PPL: 2.230872E+00 loss 8.032227E-01 |
[2024-06-17 07:45:29,965] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 07:45:39,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=7010, skipped=32, lr=[7.804057965408709e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:45:39,042] [INFO] [timer.py:258:stop] epoch=0/micro_step=7010/global_step=7010, RunningAvgSamplesPerSec=4.496216674725112, CurrSamplesPerSec=4.477656841409666, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:45:48,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=7020, skipped=32, lr=[7.797983369321477e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:45:48,112] [INFO] [timer.py:258:stop] epoch=0/micro_step=7020/global_step=7020, RunningAvgSamplesPerSec=4.496197877930565, CurrSamplesPerSec=4.4898422540714344, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:45:57,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=7030, skipped=32, lr=[7.791903103188717e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:45:57,187] [INFO] [timer.py:258:stop] epoch=0/micro_step=7030/global_step=7030, RunningAvgSamplesPerSec=4.4961807287478175, CurrSamplesPerSec=4.489138255490407, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:46:06,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=7040, skipped=32, lr=[7.78581718201288e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:46:06,263] [INFO] [timer.py:258:stop] epoch=0/micro_step=7040/global_step=7040, RunningAvgSamplesPerSec=4.496161935559447, CurrSamplesPerSec=4.480699083681193, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:46:15,330] [INFO] [logging.py:96:log_dist] [Rank 0] step=7050, skipped=32, lr=[7.779725620810374e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:46:15,331] [INFO] [timer.py:258:stop] epoch=0/micro_step=7050/global_step=7050, RunningAvgSamplesPerSec=4.4961465653095685, CurrSamplesPerSec=4.481524932952955, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:46:15,332] [INFO] [RANK 0]  iteration     7050/   20000 | elapsed time per iteration (ms): 1040.3 | learning rate 7.779E-05 | total loss 4.466541E-01 | loss 4.466541E-01 | loss scale 16384.0 |speed 230.70 samples/(min*GPU)
[2024-06-17 07:46:15,333] [INFO] [RANK 0] time (ms) | forward: 356.45 | backward: 546.82 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 17.61 | data loader: 0.12
[2024-06-17 07:46:24,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=7060, skipped=32, lr=[7.77362843461152e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:46:24,420] [INFO] [timer.py:258:stop] epoch=0/micro_step=7060/global_step=7060, RunningAvgSamplesPerSec=4.496132223584223, CurrSamplesPerSec=4.488603796522815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:46:33,518] [INFO] [logging.py:96:log_dist] [Rank 0] step=7070, skipped=32, lr=[7.767525638460517e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:46:33,519] [INFO] [timer.py:258:stop] epoch=0/micro_step=7070/global_step=7070, RunningAvgSamplesPerSec=4.496112331663489, CurrSamplesPerSec=4.489809812424332, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:46:42,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=7080, skipped=32, lr=[7.761417247415412e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:46:42,591] [INFO] [timer.py:258:stop] epoch=0/micro_step=7080/global_step=7080, RunningAvgSamplesPerSec=4.496095450666262, CurrSamplesPerSec=4.475530683813443, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:46:51,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=7090, skipped=32, lr=[7.755303276548047e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:46:51,677] [INFO] [timer.py:258:stop] epoch=0/micro_step=7090/global_step=7090, RunningAvgSamplesPerSec=4.496064600069885, CurrSamplesPerSec=4.449539603097796, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:47:00,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=7100, skipped=32, lr=[7.749183740944041e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:47:00,765] [INFO] [timer.py:258:stop] epoch=0/micro_step=7100/global_step=7100, RunningAvgSamplesPerSec=4.4960417871281475, CurrSamplesPerSec=4.477616210486086, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:47:00,766] [INFO] [RANK 0]  iteration     7100/   20000 | elapsed time per iteration (ms): 908.7 | learning rate 7.749E-05 | total loss 4.050012E-01 | loss 4.050012E-01 | loss scale 32768.0 |speed 264.12 samples/(min*GPU)
[2024-06-17 07:47:00,767] [INFO] [RANK 0] time (ms) | forward: 357.82 | backward: 546.69 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 15.43 | data loader: 0.12
[2024-06-17 07:47:09,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=7110, skipped=32, lr=[7.743058655702739e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:47:09,857] [INFO] [timer.py:258:stop] epoch=0/micro_step=7110/global_step=7110, RunningAvgSamplesPerSec=4.496013059575643, CurrSamplesPerSec=4.48574989960199, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:47:18,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=7120, skipped=32, lr=[7.736928035937181e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:47:18,950] [INFO] [timer.py:258:stop] epoch=0/micro_step=7120/global_step=7120, RunningAvgSamplesPerSec=4.495994805264285, CurrSamplesPerSec=4.47905905997302, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:47:28,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=7130, skipped=32, lr=[7.730791896774058e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:47:28,051] [INFO] [timer.py:258:stop] epoch=0/micro_step=7130/global_step=7130, RunningAvgSamplesPerSec=4.495972992544734, CurrSamplesPerSec=4.4824480899545245, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:47:37,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=7140, skipped=32, lr=[7.724650253353689e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:47:37,124] [INFO] [timer.py:258:stop] epoch=0/micro_step=7140/global_step=7140, RunningAvgSamplesPerSec=4.495963000277687, CurrSamplesPerSec=4.485181474142568, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:47:46,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=7150, skipped=32, lr=[7.718503120829963e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:47:46,183] [INFO] [timer.py:258:stop] epoch=0/micro_step=7150/global_step=7150, RunningAvgSamplesPerSec=4.495949596165457, CurrSamplesPerSec=4.472411995090726, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:47:46,184] [INFO] [RANK 0]  iteration     7150/   20000 | elapsed time per iteration (ms): 908.4 | learning rate 7.718E-05 | total loss 4.128418E-01 | loss 4.128418E-01 | loss scale 32768.0 |speed 264.21 samples/(min*GPU)
[2024-06-17 07:47:46,185] [INFO] [RANK 0] time (ms) | forward: 357.85 | backward: 546.51 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 15.55 | data loader: 0.20
[2024-06-17 07:47:55,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=7160, skipped=32, lr=[7.712350514370323e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:47:55,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=7160/global_step=7160, RunningAvgSamplesPerSec=4.495927834439812, CurrSamplesPerSec=4.480063746024218, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:48:04,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=7170, skipped=32, lr=[7.706192449155713e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:48:04,319] [INFO] [timer.py:258:stop] epoch=0/micro_step=7170/global_step=7170, RunningAvgSamplesPerSec=4.495912758029992, CurrSamplesPerSec=4.488839182992021, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:48:13,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=7180, skipped=32, lr=[7.700028940380545e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:48:13,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=7180/global_step=7180, RunningAvgSamplesPerSec=4.495889112771025, CurrSamplesPerSec=4.478968182035396, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:48:22,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=7190, skipped=32, lr=[7.693860003252665e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:48:22,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=7190/global_step=7190, RunningAvgSamplesPerSec=4.4958759903972405, CurrSamplesPerSec=4.491967602130906, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:48:31,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=7200, skipped=32, lr=[7.687685652993312e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:48:31,552] [INFO] [timer.py:258:stop] epoch=0/micro_step=7200/global_step=7200, RunningAvgSamplesPerSec=4.495862540851884, CurrSamplesPerSec=4.4924379027598, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:48:31,553] [INFO] [RANK 0]  iteration     7200/   20000 | elapsed time per iteration (ms): 907.4 | learning rate 7.687E-05 | total loss 4.491370E-01 | loss 4.491370E-01 | loss scale 32768.0 |speed 264.50 samples/(min*GPU)
[2024-06-17 07:48:31,554] [INFO] [RANK 0] time (ms) | forward: 356.83 | backward: 546.56 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.68 | data loader: 0.23
[2024-06-17 07:48:31,554] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:48:31,566] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/7200/mp_rank_00_model_states.pt
[2024-06-17 07:48:31,566] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/7200/mp_rank_00_model_states.pt...
[2024-06-17 07:48:57,381] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/7200/mp_rank_00_model_states.pt.
[2024-06-17 07:49:06,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=7210, skipped=32, lr=[7.681505904837081e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:49:06,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=7210/global_step=7210, RunningAvgSamplesPerSec=4.495922527508757, CurrSamplesPerSec=4.5376117653454475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:49:15,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=7220, skipped=32, lr=[7.675320774031887e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:49:15,369] [INFO] [timer.py:258:stop] epoch=0/micro_step=7220/global_step=7220, RunningAvgSamplesPerSec=4.495964762425628, CurrSamplesPerSec=4.512528648418645, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:49:24,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=7230, skipped=32, lr=[7.669130275838927e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:49:24,379] [INFO] [timer.py:258:stop] epoch=0/micro_step=7230/global_step=7230, RunningAvgSamplesPerSec=4.495988719867007, CurrSamplesPerSec=4.522753115367673, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:49:33,398] [INFO] [logging.py:96:log_dist] [Rank 0] step=7240, skipped=32, lr=[7.662934425532637e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:49:33,398] [INFO] [timer.py:258:stop] epoch=0/micro_step=7240/global_step=7240, RunningAvgSamplesPerSec=4.496012934966827, CurrSamplesPerSec=4.499469253441538, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:49:42,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=7250, skipped=32, lr=[7.656733238400663e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:49:42,414] [INFO] [timer.py:258:stop] epoch=0/micro_step=7250/global_step=7250, RunningAvgSamplesPerSec=4.496034683911063, CurrSamplesPerSec=4.521731630853353, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:49:42,415] [INFO] [RANK 0]  iteration     7250/   20000 | elapsed time per iteration (ms): 1417.2 | learning rate 7.656E-05 | total loss 4.985645E-01 | loss 4.985645E-01 | loss scale 32768.0 |speed 169.34 samples/(min*GPU)
[2024-06-17 07:49:42,416] [INFO] [RANK 0] time (ms) | forward: 354.05 | backward: 542.47 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 15.17 | data loader: 0.19
[2024-06-17 07:49:51,469] [INFO] [logging.py:96:log_dist] [Rank 0] step=7260, skipped=32, lr=[7.650526729743816e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:49:51,470] [INFO] [timer.py:258:stop] epoch=0/micro_step=7260/global_step=7260, RunningAvgSamplesPerSec=4.4960424636088785, CurrSamplesPerSec=4.49467648765527, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:50:00,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=7270, skipped=32, lr=[7.644314914876044e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:50:00,523] [INFO] [timer.py:258:stop] epoch=0/micro_step=7270/global_step=7270, RunningAvgSamplesPerSec=4.496035479150178, CurrSamplesPerSec=4.488189528263299, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:50:09,587] [INFO] [logging.py:96:log_dist] [Rank 0] step=7280, skipped=32, lr=[7.638097809124379e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:50:09,588] [INFO] [timer.py:258:stop] epoch=0/micro_step=7280/global_step=7280, RunningAvgSamplesPerSec=4.496028364746927, CurrSamplesPerSec=4.487856968219737, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:50:18,636] [INFO] [logging.py:96:log_dist] [Rank 0] step=7290, skipped=32, lr=[7.63187542782891e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:50:18,637] [INFO] [timer.py:258:stop] epoch=0/micro_step=7290/global_step=7290, RunningAvgSamplesPerSec=4.496027252209307, CurrSamplesPerSec=4.495414746710474, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:50:27,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=7300, skipped=32, lr=[7.625647786342748e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:50:27,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=7300/global_step=7300, RunningAvgSamplesPerSec=4.496022042095437, CurrSamplesPerSec=4.496525602957371, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:50:27,689] [INFO] [RANK 0]  iteration     7300/   20000 | elapsed time per iteration (ms): 905.5 | learning rate 7.625E-05 | total loss 3.984705E-01 | loss 3.984705E-01 | loss scale 32768.0 |speed 265.05 samples/(min*GPU)
[2024-06-17 07:50:27,691] [INFO] [RANK 0] time (ms) | forward: 355.46 | backward: 546.11 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 14.93 | data loader: 0.09
[2024-06-17 07:50:36,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=7310, skipped=32, lr=[7.619414900031977e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:50:36,758] [INFO] [timer.py:258:stop] epoch=0/micro_step=7310/global_step=7310, RunningAvgSamplesPerSec=4.496009619092657, CurrSamplesPerSec=4.478348875355518, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:50:45,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=7320, skipped=32, lr=[7.613176784275626e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:50:45,824] [INFO] [timer.py:258:stop] epoch=0/micro_step=7320/global_step=7320, RunningAvgSamplesPerSec=4.4959933580706375, CurrSamplesPerSec=4.488502924164353, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:50:54,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=7330, skipped=32, lr=[7.606933454465623e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:50:54,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=7330/global_step=7330, RunningAvgSamplesPerSec=4.495985062113897, CurrSamplesPerSec=4.488713080027664, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:51:03,951] [INFO] [logging.py:96:log_dist] [Rank 0] step=7340, skipped=32, lr=[7.600684926006767e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:51:03,953] [INFO] [timer.py:258:stop] epoch=0/micro_step=7340/global_step=7340, RunningAvgSamplesPerSec=4.495978482926534, CurrSamplesPerSec=4.491294197264781, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:51:13,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=7350, skipped=32, lr=[7.594431214316679e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:51:13,054] [INFO] [timer.py:258:stop] epoch=0/micro_step=7350/global_step=7350, RunningAvgSamplesPerSec=4.495960304260797, CurrSamplesPerSec=4.487190795827558, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:51:13,055] [INFO] [RANK 0]  iteration     7350/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 7.594E-05 | total loss 3.990833E-01 | loss 3.990833E-01 | loss scale 32768.0 |speed 264.52 samples/(min*GPU)
[2024-06-17 07:51:13,056] [INFO] [RANK 0] time (ms) | forward: 356.63 | backward: 546.64 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.24 | data loader: 0.17
[2024-06-17 07:51:22,132] [INFO] [logging.py:96:log_dist] [Rank 0] step=7360, skipped=32, lr=[7.588172334825768e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:51:22,133] [INFO] [timer.py:258:stop] epoch=0/micro_step=7360/global_step=7360, RunningAvgSamplesPerSec=4.495941639551369, CurrSamplesPerSec=4.4809599712829105, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:51:31,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=7370, skipped=32, lr=[7.581908302977202e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:51:31,204] [INFO] [timer.py:258:stop] epoch=0/micro_step=7370/global_step=7370, RunningAvgSamplesPerSec=4.495922989032276, CurrSamplesPerSec=4.489080599859954, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:51:40,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=7380, skipped=32, lr=[7.575639134226854e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:51:40,270] [INFO] [timer.py:258:stop] epoch=0/micro_step=7380/global_step=7380, RunningAvgSamplesPerSec=4.495908165284628, CurrSamplesPerSec=4.480294648283906, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:51:49,328] [INFO] [logging.py:96:log_dist] [Rank 0] step=7390, skipped=32, lr=[7.569364844043277e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:51:49,328] [INFO] [timer.py:258:stop] epoch=0/micro_step=7390/global_step=7390, RunningAvgSamplesPerSec=4.49589605080041, CurrSamplesPerSec=4.478752959524095, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:51:58,399] [INFO] [logging.py:96:log_dist] [Rank 0] step=7400, skipped=32, lr=[7.563085447907656e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:51:58,400] [INFO] [timer.py:258:stop] epoch=0/micro_step=7400/global_step=7400, RunningAvgSamplesPerSec=4.495882607029201, CurrSamplesPerSec=4.473846719990187, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:51:58,401] [INFO] [RANK 0]  iteration     7400/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 7.562E-05 | total loss 4.021924E-01 | loss 4.021924E-01 | loss scale 32768.0 |speed 264.63 samples/(min*GPU)
[2024-06-17 07:51:58,402] [INFO] [RANK 0] time (ms) | forward: 356.20 | backward: 546.70 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.43 | data loader: 0.23
[2024-06-17 07:52:07,510] [INFO] [logging.py:96:log_dist] [Rank 0] step=7410, skipped=32, lr=[7.556800961313778e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:52:07,511] [INFO] [timer.py:258:stop] epoch=0/micro_step=7410/global_step=7410, RunningAvgSamplesPerSec=4.495852542907868, CurrSamplesPerSec=4.476188621283887, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:52:16,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=7420, skipped=32, lr=[7.550511399767987e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:52:16,633] [INFO] [timer.py:258:stop] epoch=0/micro_step=7420/global_step=7420, RunningAvgSamplesPerSec=4.49582441203881, CurrSamplesPerSec=4.486972382354554, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:52:25,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=7430, skipped=32, lr=[7.544216778789153e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:52:25,704] [INFO] [timer.py:258:stop] epoch=0/micro_step=7430/global_step=7430, RunningAvgSamplesPerSec=4.495802651665947, CurrSamplesPerSec=4.473665390562733, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:52:34,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=7440, skipped=32, lr=[7.537917113908629e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:52:34,787] [INFO] [timer.py:258:stop] epoch=0/micro_step=7440/global_step=7440, RunningAvgSamplesPerSec=4.495780808290609, CurrSamplesPerSec=4.4943682489575245, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:52:43,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=7450, skipped=32, lr=[7.531612420670207e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:52:43,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=7450/global_step=7450, RunningAvgSamplesPerSec=4.495764171184526, CurrSamplesPerSec=4.4873804247670686, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:52:43,864] [INFO] [RANK 0]  iteration     7450/   20000 | elapsed time per iteration (ms): 909.3 | learning rate 7.531E-05 | total loss 3.941980E-01 | loss 3.941980E-01 | loss scale 32768.0 |speed 263.95 samples/(min*GPU)
[2024-06-17 07:52:43,865] [INFO] [RANK 0] time (ms) | forward: 358.33 | backward: 546.84 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 15.43 | data loader: 0.23
[2024-06-17 07:52:52,951] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 07:52:52,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=7460, skipped=33, lr=[7.525302714630095e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:52:52,952] [INFO] [timer.py:258:stop] epoch=0/micro_step=7460/global_step=7460, RunningAvgSamplesPerSec=4.495748401504841, CurrSamplesPerSec=4.502923091375123, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:52:53,858] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 07:53:02,035] [INFO] [logging.py:96:log_dist] [Rank 0] step=7470, skipped=34, lr=[7.520251351042455e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:53:02,036] [INFO] [timer.py:258:stop] epoch=0/micro_step=7470/global_step=7470, RunningAvgSamplesPerSec=4.495725875526297, CurrSamplesPerSec=4.482269655128562, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:53:11,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=7480, skipped=34, lr=[7.513932661200387e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:53:11,113] [INFO] [timer.py:258:stop] epoch=0/micro_step=7480/global_step=7480, RunningAvgSamplesPerSec=4.495701967387118, CurrSamplesPerSec=4.483438721425361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:53:20,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=7490, skipped=34, lr=[7.507609002179676e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:53:20,202] [INFO] [timer.py:258:stop] epoch=0/micro_step=7490/global_step=7490, RunningAvgSamplesPerSec=4.4956814042065165, CurrSamplesPerSec=4.463588975180935, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:53:29,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=7500, skipped=34, lr=[7.501280389583325e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:53:29,289] [INFO] [timer.py:258:stop] epoch=0/micro_step=7500/global_step=7500, RunningAvgSamplesPerSec=4.49566098699954, CurrSamplesPerSec=4.494352597339105, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:53:29,290] [INFO] [RANK 0]  iteration     7500/   20000 | elapsed time per iteration (ms): 908.5 | learning rate 7.501E-05 | total loss 4.304114E-01 | loss 4.304114E-01 | loss scale 32768.0 |speed 264.17 samples/(min*GPU)
[2024-06-17 07:53:29,291] [INFO] [RANK 0] time (ms) | forward: 357.75 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 15.16 | data loader: 0.11
[2024-06-17 07:53:29,292] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:53:29,304] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/7500/mp_rank_00_model_states.pt
[2024-06-17 07:53:29,304] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/7500/mp_rank_00_model_states.pt...
[2024-06-17 07:53:59,363] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/7500/mp_rank_00_model_states.pt.
[2024-06-17 07:54:08,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=7510, skipped=34, lr=[7.494946839026553e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:54:08,392] [INFO] [timer.py:258:stop] epoch=0/micro_step=7510/global_step=7510, RunningAvgSamplesPerSec=4.495696507136573, CurrSamplesPerSec=4.532603961904679, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:54:17,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=7520, skipped=34, lr=[7.488608366136768e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:54:17,395] [INFO] [timer.py:258:stop] epoch=0/micro_step=7520/global_step=7520, RunningAvgSamplesPerSec=4.495733344918586, CurrSamplesPerSec=4.5216511994066435, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:54:26,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=7530, skipped=34, lr=[7.482264986553521e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:54:26,419] [INFO] [timer.py:258:stop] epoch=0/micro_step=7530/global_step=7530, RunningAvgSamplesPerSec=4.495753960278056, CurrSamplesPerSec=4.509435772748006, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:54:35,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=7540, skipped=34, lr=[7.475916715928471e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:54:35,438] [INFO] [timer.py:258:stop] epoch=0/micro_step=7540/global_step=7540, RunningAvgSamplesPerSec=4.495764940697547, CurrSamplesPerSec=4.5140742486639835, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:54:44,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=7550, skipped=34, lr=[7.469563569925345e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:54:44,475] [INFO] [timer.py:258:stop] epoch=0/micro_step=7550/global_step=7550, RunningAvgSamplesPerSec=4.495776689163302, CurrSamplesPerSec=4.502521884330932, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:54:44,476] [INFO] [RANK 0]  iteration     7550/   20000 | elapsed time per iteration (ms): 1503.7 | learning rate 7.469E-05 | total loss 3.900165E-01 | loss 3.900165E-01 | loss scale 32768.0 |speed 159.60 samples/(min*GPU)
[2024-06-17 07:54:44,477] [INFO] [RANK 0] time (ms) | forward: 355.06 | backward: 542.69 | allreduce: 0.00 | optimizer: 3.41 | batch generator: 15.10 | data loader: 0.23
[2024-06-17 07:54:53,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=7560, skipped=34, lr=[7.463205564219898e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:54:53,546] [INFO] [timer.py:258:stop] epoch=0/micro_step=7560/global_step=7560, RunningAvgSamplesPerSec=4.495773022920167, CurrSamplesPerSec=4.4902171693395205, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:55:02,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=7570, skipped=34, lr=[7.456842714499878e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:55:02,629] [INFO] [timer.py:258:stop] epoch=0/micro_step=7570/global_step=7570, RunningAvgSamplesPerSec=4.495757309119012, CurrSamplesPerSec=4.486757589842306, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:55:11,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=7580, skipped=34, lr=[7.450475036464984e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:55:11,711] [INFO] [timer.py:258:stop] epoch=0/micro_step=7580/global_step=7580, RunningAvgSamplesPerSec=4.495734244267036, CurrSamplesPerSec=4.478703939510913, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:55:20,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=7590, skipped=34, lr=[7.44410254582683e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:55:20,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=7590/global_step=7590, RunningAvgSamplesPerSec=4.495709448961526, CurrSamplesPerSec=4.479618758031877, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:55:29,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=7600, skipped=34, lr=[7.4377252583089e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:55:29,885] [INFO] [timer.py:258:stop] epoch=0/micro_step=7600/global_step=7600, RunningAvgSamplesPerSec=4.495690782085468, CurrSamplesPerSec=4.48372509188752, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:55:29,886] [INFO] [RANK 0]  iteration     7600/   20000 | elapsed time per iteration (ms): 908.2 | learning rate 7.437E-05 | total loss 4.364999E-01 | loss 4.364999E-01 | loss scale 32768.0 |speed 264.26 samples/(min*GPU)
[2024-06-17 07:55:29,888] [INFO] [RANK 0] time (ms) | forward: 357.49 | backward: 546.65 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 15.36 | data loader: 0.23
[2024-06-17 07:55:38,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=7610, skipped=34, lr=[7.431343189646517e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:55:38,978] [INFO] [timer.py:258:stop] epoch=0/micro_step=7610/global_step=7610, RunningAvgSamplesPerSec=4.495667603211698, CurrSamplesPerSec=4.474942166844885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:55:48,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=7620, skipped=34, lr=[7.424956355586806e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:55:48,062] [INFO] [timer.py:258:stop] epoch=0/micro_step=7620/global_step=7620, RunningAvgSamplesPerSec=4.495645287006234, CurrSamplesPerSec=4.4694964854817165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:55:57,142] [INFO] [logging.py:96:log_dist] [Rank 0] step=7630, skipped=34, lr=[7.41856477188864e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:55:57,143] [INFO] [timer.py:258:stop] epoch=0/micro_step=7630/global_step=7630, RunningAvgSamplesPerSec=4.495630984040162, CurrSamplesPerSec=4.4849272882805815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:56:06,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=7640, skipped=34, lr=[7.412168454322618e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:56:06,232] [INFO] [timer.py:258:stop] epoch=0/micro_step=7640/global_step=7640, RunningAvgSamplesPerSec=4.495609483352844, CurrSamplesPerSec=4.4840474521947415, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:56:15,306] [INFO] [logging.py:96:log_dist] [Rank 0] step=7650, skipped=34, lr=[7.405767418671019e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:56:15,307] [INFO] [timer.py:258:stop] epoch=0/micro_step=7650/global_step=7650, RunningAvgSamplesPerSec=4.495598349970617, CurrSamplesPerSec=4.485951401437347, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:56:15,308] [INFO] [RANK 0]  iteration     7650/   20000 | elapsed time per iteration (ms): 908.4 | learning rate 7.405E-05 | total loss 3.756891E-01 | loss 3.756891E-01 | loss scale 32768.0 |speed 264.19 samples/(min*GPU)
[2024-06-17 07:56:15,309] [INFO] [RANK 0] time (ms) | forward: 357.19 | backward: 547.06 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 15.29 | data loader: 0.24
[2024-06-17 07:56:24,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=7660, skipped=34, lr=[7.399361680727761e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:56:24,383] [INFO] [timer.py:258:stop] epoch=0/micro_step=7660/global_step=7660, RunningAvgSamplesPerSec=4.495581169733968, CurrSamplesPerSec=4.477315086625604, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:56:33,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=7670, skipped=34, lr=[7.392951256298366e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:56:33,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=7670/global_step=7670, RunningAvgSamplesPerSec=4.495556517071489, CurrSamplesPerSec=4.48237623529594, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:56:42,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=7680, skipped=34, lr=[7.386536161199917e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:56:42,558] [INFO] [timer.py:258:stop] epoch=0/micro_step=7680/global_step=7680, RunningAvgSamplesPerSec=4.495536634646434, CurrSamplesPerSec=4.472369074860368, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:56:51,634] [INFO] [logging.py:96:log_dist] [Rank 0] step=7690, skipped=34, lr=[7.380116411261028e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:56:51,635] [INFO] [timer.py:258:stop] epoch=0/micro_step=7690/global_step=7690, RunningAvgSamplesPerSec=4.495515832676264, CurrSamplesPerSec=4.475856643174747, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:57:00,723] [INFO] [logging.py:96:log_dist] [Rank 0] step=7700, skipped=34, lr=[7.37369202232179e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:57:00,723] [INFO] [timer.py:258:stop] epoch=0/micro_step=7700/global_step=7700, RunningAvgSamplesPerSec=4.495496996652976, CurrSamplesPerSec=4.475158216959023, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:57:00,724] [INFO] [RANK 0]  iteration     7700/   20000 | elapsed time per iteration (ms): 908.3 | learning rate 7.373E-05 | total loss 4.079321E-01 | loss 4.079321E-01 | loss scale 32768.0 |speed 264.22 samples/(min*GPU)
[2024-06-17 07:57:00,726] [INFO] [RANK 0] time (ms) | forward: 357.01 | backward: 547.18 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 14.92 | data loader: 0.17
[2024-06-17 07:57:09,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=7710, skipped=34, lr=[7.367263010233745e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:57:09,804] [INFO] [timer.py:258:stop] epoch=0/micro_step=7710/global_step=7710, RunningAvgSamplesPerSec=4.495473883028573, CurrSamplesPerSec=4.479314972926084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:57:18,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=7720, skipped=34, lr=[7.36082939085984e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:57:18,866] [INFO] [timer.py:258:stop] epoch=0/micro_step=7720/global_step=7720, RunningAvgSamplesPerSec=4.495458646046948, CurrSamplesPerSec=4.485292989296871, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:57:27,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=7730, skipped=34, lr=[7.354391180074395e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:57:27,933] [INFO] [timer.py:258:stop] epoch=0/micro_step=7730/global_step=7730, RunningAvgSamplesPerSec=4.495440012329345, CurrSamplesPerSec=4.484987235180111, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:57:37,020] [INFO] [logging.py:96:log_dist] [Rank 0] step=7740, skipped=34, lr=[7.347948393763053e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:57:37,021] [INFO] [timer.py:258:stop] epoch=0/micro_step=7740/global_step=7740, RunningAvgSamplesPerSec=4.495418995123028, CurrSamplesPerSec=4.477341373603, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:57:46,088] [INFO] [logging.py:96:log_dist] [Rank 0] step=7750, skipped=34, lr=[7.341501047822746e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:57:46,089] [INFO] [timer.py:258:stop] epoch=0/micro_step=7750/global_step=7750, RunningAvgSamplesPerSec=4.495402065853257, CurrSamplesPerSec=4.490961176987687, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:57:46,090] [INFO] [RANK 0]  iteration     7750/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 7.341E-05 | total loss 3.483612E-01 | loss 3.483612E-01 | loss scale 32768.0 |speed 264.52 samples/(min*GPU)
[2024-06-17 07:57:46,090] [INFO] [RANK 0] time (ms) | forward: 356.12 | backward: 547.09 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 14.05 | data loader: 0.13
[2024-06-17 07:57:55,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=7760, skipped=34, lr=[7.335049158161663e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:57:55,182] [INFO] [timer.py:258:stop] epoch=0/micro_step=7760/global_step=7760, RunningAvgSamplesPerSec=4.495381113744892, CurrSamplesPerSec=4.479664209740748, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:58:04,272] [INFO] [logging.py:96:log_dist] [Rank 0] step=7770, skipped=34, lr=[7.3285927406992e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:58:04,273] [INFO] [timer.py:258:stop] epoch=0/micro_step=7770/global_step=7770, RunningAvgSamplesPerSec=4.495357734816525, CurrSamplesPerSec=4.470662471327586, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:58:13,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=7780, skipped=34, lr=[7.322131811365923e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:58:13,367] [INFO] [timer.py:258:stop] epoch=0/micro_step=7780/global_step=7780, RunningAvgSamplesPerSec=4.495338275023352, CurrSamplesPerSec=4.4758064924903085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:58:22,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=7790, skipped=34, lr=[7.315666386103535e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:58:22,452] [INFO] [timer.py:258:stop] epoch=0/micro_step=7790/global_step=7790, RunningAvgSamplesPerSec=4.495315757501559, CurrSamplesPerSec=4.480317380881359, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:58:31,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=7800, skipped=34, lr=[7.309196480864829e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:58:31,542] [INFO] [timer.py:258:stop] epoch=0/micro_step=7800/global_step=7800, RunningAvgSamplesPerSec=4.495294978315532, CurrSamplesPerSec=4.479334107779769, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:58:31,543] [INFO] [RANK 0]  iteration     7800/   20000 | elapsed time per iteration (ms): 909.1 | learning rate 7.309E-05 | total loss 3.446704E-01 | loss 3.446704E-01 | loss scale 32768.0 |speed 264.01 samples/(min*GPU)
[2024-06-17 07:58:31,544] [INFO] [RANK 0] time (ms) | forward: 357.88 | backward: 547.10 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 15.40 | data loader: 0.11
[2024-06-17 07:58:31,544] [INFO] [RANK 0] Saving Model...
[2024-06-17 07:58:31,557] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/7800/mp_rank_00_model_states.pt
[2024-06-17 07:58:31,557] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/7800/mp_rank_00_model_states.pt...
[2024-06-17 07:58:59,998] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/7800/mp_rank_00_model_states.pt.
[2024-06-17 07:59:09,002] [INFO] [logging.py:96:log_dist] [Rank 0] step=7810, skipped=34, lr=[7.302722111613653e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:59:09,002] [INFO] [timer.py:258:stop] epoch=0/micro_step=7810/global_step=7810, RunningAvgSamplesPerSec=4.495341322610565, CurrSamplesPerSec=4.530796026604885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:59:17,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=7820, skipped=34, lr=[7.29624329432487e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:59:17,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=7820/global_step=7820, RunningAvgSamplesPerSec=4.495381916345177, CurrSamplesPerSec=4.518336502259543, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:59:27,005] [INFO] [logging.py:96:log_dist] [Rank 0] step=7830, skipped=34, lr=[7.28976004498432e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:59:27,006] [INFO] [timer.py:258:stop] epoch=0/micro_step=7830/global_step=7830, RunningAvgSamplesPerSec=4.495407604293565, CurrSamplesPerSec=4.515385135027843, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:59:36,040] [INFO] [logging.py:96:log_dist] [Rank 0] step=7840, skipped=34, lr=[7.28327237958877e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:59:36,041] [INFO] [timer.py:258:stop] epoch=0/micro_step=7840/global_step=7840, RunningAvgSamplesPerSec=4.495419992854818, CurrSamplesPerSec=4.4619768773797945, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:59:45,070] [INFO] [logging.py:96:log_dist] [Rank 0] step=7850, skipped=34, lr=[7.276780314145897e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:59:45,071] [INFO] [timer.py:258:stop] epoch=0/micro_step=7850/global_step=7850, RunningAvgSamplesPerSec=4.49543504832246, CurrSamplesPerSec=4.5058448733078125, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:59:45,072] [INFO] [RANK 0]  iteration     7850/   20000 | elapsed time per iteration (ms): 1470.6 | learning rate 7.276E-05 | total loss 4.764093E-01 | loss 4.764093E-01 | loss scale 32768.0 |speed 163.20 samples/(min*GPU)
[2024-06-17 07:59:45,073] [INFO] [RANK 0] time (ms) | forward: 354.42 | backward: 542.63 | allreduce: 0.00 | optimizer: 3.39 | batch generator: 15.21 | data loader: 0.11
[2024-06-17 07:59:54,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=7860, skipped=34, lr=[7.27028386467422e-05], mom=[[0.9, 0.95]]
[2024-06-17 07:59:54,123] [INFO] [timer.py:258:stop] epoch=0/micro_step=7860/global_step=7860, RunningAvgSamplesPerSec=4.495442175431596, CurrSamplesPerSec=4.495421973935623, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 07:59:55,938] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 07:59:56,845] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 08:00:03,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=7870, skipped=36, lr=[7.2650835593675e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:00:03,195] [INFO] [timer.py:258:stop] epoch=0/micro_step=7870/global_step=7870, RunningAvgSamplesPerSec=4.495426979026174, CurrSamplesPerSec=4.47768193734849, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:00:12,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=7880, skipped=36, lr=[7.258579259045172e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:00:12,267] [INFO] [timer.py:258:stop] epoch=0/micro_step=7880/global_step=7880, RunningAvgSamplesPerSec=4.495415404939272, CurrSamplesPerSec=4.456539010882613, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:00:21,340] [INFO] [logging.py:96:log_dist] [Rank 0] step=7890, skipped=36, lr=[7.252070619603338e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:00:21,341] [INFO] [timer.py:258:stop] epoch=0/micro_step=7890/global_step=7890, RunningAvgSamplesPerSec=4.495402596631926, CurrSamplesPerSec=4.487303611113563, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:00:30,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=7900, skipped=36, lr=[7.245557657101418e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:00:30,416] [INFO] [timer.py:258:stop] epoch=0/micro_step=7900/global_step=7900, RunningAvgSamplesPerSec=4.495382591269682, CurrSamplesPerSec=4.474596052687377, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:00:30,417] [INFO] [RANK 0]  iteration     7900/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 7.245E-05 | total loss 4.225964E-01 | loss 4.225964E-01 | loss scale 32768.0 |speed 264.64 samples/(min*GPU)
[2024-06-17 08:00:30,418] [INFO] [RANK 0] time (ms) | forward: 356.59 | backward: 546.30 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.91 | data loader: 0.11
[2024-06-17 08:00:39,500] [INFO] [logging.py:96:log_dist] [Rank 0] step=7910, skipped=36, lr=[7.239040387609499e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:00:39,501] [INFO] [timer.py:258:stop] epoch=0/micro_step=7910/global_step=7910, RunningAvgSamplesPerSec=4.495361860787178, CurrSamplesPerSec=4.458096241769887, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:00:48,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=7920, skipped=36, lr=[7.232518827208298e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:00:48,582] [INFO] [timer.py:258:stop] epoch=0/micro_step=7920/global_step=7920, RunningAvgSamplesPerSec=4.4953454075737795, CurrSamplesPerSec=4.483124834326661, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:00:57,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=7930, skipped=36, lr=[7.225992991989113e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:00:57,644] [INFO] [timer.py:258:stop] epoch=0/micro_step=7930/global_step=7930, RunningAvgSamplesPerSec=4.495336989570504, CurrSamplesPerSec=4.478148055913004, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:01:06,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=7940, skipped=36, lr=[7.219462898053799e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:01:06,721] [INFO] [timer.py:258:stop] epoch=0/micro_step=7940/global_step=7940, RunningAvgSamplesPerSec=4.495316242804365, CurrSamplesPerSec=4.483896452376753, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:01:15,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=7950, skipped=36, lr=[7.212928561514709e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:01:15,800] [INFO] [timer.py:258:stop] epoch=0/micro_step=7950/global_step=7950, RunningAvgSamplesPerSec=4.495300518780864, CurrSamplesPerSec=4.489688460790193, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:01:15,801] [INFO] [RANK 0]  iteration     7950/   20000 | elapsed time per iteration (ms): 907.7 | learning rate 7.212E-05 | total loss 4.058679E-01 | loss 4.058679E-01 | loss scale 32768.0 |speed 264.41 samples/(min*GPU)
[2024-06-17 08:01:15,802] [INFO] [RANK 0] time (ms) | forward: 356.83 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 14.73 | data loader: 0.12
[2024-06-17 08:01:24,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=7960, skipped=36, lr=[7.206389998494672e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:01:24,893] [INFO] [timer.py:258:stop] epoch=0/micro_step=7960/global_step=7960, RunningAvgSamplesPerSec=4.495285129673902, CurrSamplesPerSec=4.4794955646169, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:01:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] step=7970, skipped=36, lr=[7.19984722512694e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:01:33,974] [INFO] [timer.py:258:stop] epoch=0/micro_step=7970/global_step=7970, RunningAvgSamplesPerSec=4.495263828668285, CurrSamplesPerSec=4.481518947442933, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:01:43,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=7980, skipped=36, lr=[7.193300257555158e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:01:43,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=7980/global_step=7980, RunningAvgSamplesPerSec=4.4952423922479765, CurrSamplesPerSec=4.485134711373254, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:01:52,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=7990, skipped=36, lr=[7.186749111933316e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:01:52,128] [INFO] [timer.py:258:stop] epoch=0/micro_step=7990/global_step=7990, RunningAvgSamplesPerSec=4.495230522140582, CurrSamplesPerSec=4.487636089149192, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:02:01,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=8000, skipped=36, lr=[7.180193804425714e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:02:01,202] [INFO] [timer.py:258:stop] epoch=0/micro_step=8000/global_step=8000, RunningAvgSamplesPerSec=4.49521207232874, CurrSamplesPerSec=4.459602402205397, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:02:01,203] [INFO] [RANK 0]  iteration     8000/   20000 | elapsed time per iteration (ms): 908.0 | learning rate 7.180E-05 | total loss 4.681519E-01 | loss 4.681519E-01 | loss scale 32768.0 |speed 264.31 samples/(min*GPU)
[2024-06-17 08:02:01,204] [INFO] [RANK 0] time (ms) | forward: 356.93 | backward: 547.08 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.77 | data loader: 0.10
[2024-06-17 08:02:07,875] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 08:02:07,875] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 08:02:07,875] [INFO] [RANK 0]  validation loss at iteration 8000 | loss: 8.302734E-01 | PPL: 2.293946E+00 loss 8.305664E-01 |
[2024-06-17 08:02:07,875] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 08:02:16,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=8010, skipped=36, lr=[7.173634351206925e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:02:16,976] [INFO] [timer.py:258:stop] epoch=0/micro_step=8010/global_step=8010, RunningAvgSamplesPerSec=4.495185505706732, CurrSamplesPerSec=4.472471607888425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:02:26,073] [INFO] [logging.py:96:log_dist] [Rank 0] step=8020, skipped=36, lr=[7.167070768461743e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:02:26,074] [INFO] [timer.py:258:stop] epoch=0/micro_step=8020/global_step=8020, RunningAvgSamplesPerSec=4.495165399891764, CurrSamplesPerSec=4.482434916427991, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:02:35,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=8030, skipped=36, lr=[7.160503072385161e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:02:35,148] [INFO] [timer.py:258:stop] epoch=0/micro_step=8030/global_step=8030, RunningAvgSamplesPerSec=4.495149904473843, CurrSamplesPerSec=4.486323267826067, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:02:44,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=8040, skipped=36, lr=[7.15393127918231e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:02:44,221] [INFO] [timer.py:258:stop] epoch=0/micro_step=8040/global_step=8040, RunningAvgSamplesPerSec=4.495134291438347, CurrSamplesPerSec=4.462004171256627, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:02:53,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=8050, skipped=36, lr=[7.147355405068443e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:02:53,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=8050/global_step=8050, RunningAvgSamplesPerSec=4.495118156275826, CurrSamplesPerSec=4.480318577340246, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:02:53,299] [INFO] [RANK 0]  iteration     8050/   20000 | elapsed time per iteration (ms): 1041.9 | learning rate 7.147E-05 | total loss 3.779425E-01 | loss 3.779425E-01 | loss scale 32768.0 |speed 230.35 samples/(min*GPU)
[2024-06-17 08:02:53,300] [INFO] [RANK 0] time (ms) | forward: 357.30 | backward: 547.11 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 18.45 | data loader: 0.17
[2024-06-17 08:03:02,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=8060, skipped=36, lr=[7.140775466268872e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:03:02,386] [INFO] [timer.py:258:stop] epoch=0/micro_step=8060/global_step=8060, RunningAvgSamplesPerSec=4.495101713925674, CurrSamplesPerSec=4.48930162115299, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:03:11,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=8070, skipped=36, lr=[7.134191479018941e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:03:11,465] [INFO] [timer.py:258:stop] epoch=0/micro_step=8070/global_step=8070, RunningAvgSamplesPerSec=4.495081985840798, CurrSamplesPerSec=4.4864336400373945, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:03:20,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=8080, skipped=36, lr=[7.127603459563988e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:03:20,547] [INFO] [timer.py:258:stop] epoch=0/micro_step=8080/global_step=8080, RunningAvgSamplesPerSec=4.495068646672447, CurrSamplesPerSec=4.487660096690617, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:03:29,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=8090, skipped=36, lr=[7.121011424159293e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:03:29,630] [INFO] [timer.py:258:stop] epoch=0/micro_step=8090/global_step=8090, RunningAvgSamplesPerSec=4.4950516389437, CurrSamplesPerSec=4.474754781154049, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:03:38,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=8100, skipped=36, lr=[7.11441538907005e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:03:38,698] [INFO] [timer.py:258:stop] epoch=0/micro_step=8100/global_step=8100, RunningAvgSamplesPerSec=4.495034689409667, CurrSamplesPerSec=4.483553744495511, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:03:38,699] [INFO] [RANK 0]  iteration     8100/   20000 | elapsed time per iteration (ms): 908.0 | learning rate 7.114E-05 | total loss 3.720215E-01 | loss 3.720215E-01 | loss scale 32768.0 |speed 264.32 samples/(min*GPU)
[2024-06-17 08:03:38,699] [INFO] [RANK 0] time (ms) | forward: 356.79 | backward: 547.06 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 14.95 | data loader: 0.19
[2024-06-17 08:03:38,700] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:03:38,713] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/8100/mp_rank_00_model_states.pt
[2024-06-17 08:03:38,713] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/8100/mp_rank_00_model_states.pt...
[2024-06-17 08:04:10,636] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/8100/mp_rank_00_model_states.pt.
[2024-06-17 08:04:19,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=8110, skipped=36, lr=[7.107815370571316e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:04:19,643] [INFO] [timer.py:258:stop] epoch=0/micro_step=8110/global_step=8110, RunningAvgSamplesPerSec=4.495072765586956, CurrSamplesPerSec=4.527355512781107, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:04:28,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=8120, skipped=36, lr=[7.101211384947986e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:04:28,619] [INFO] [timer.py:258:stop] epoch=0/micro_step=8120/global_step=8120, RunningAvgSamplesPerSec=4.495119197324513, CurrSamplesPerSec=4.524954898024629, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:04:37,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=8130, skipped=36, lr=[7.094603448494732e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:04:37,647] [INFO] [timer.py:258:stop] epoch=0/micro_step=8130/global_step=8130, RunningAvgSamplesPerSec=4.495135523718411, CurrSamplesPerSec=4.5058194606890645, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:04:46,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=8140, skipped=36, lr=[7.087991577515988e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:04:46,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=8140/global_step=8140, RunningAvgSamplesPerSec=4.49514531943797, CurrSamplesPerSec=4.506847085079646, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:04:55,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=8150, skipped=36, lr=[7.081375788325882e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:04:55,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=8150/global_step=8150, RunningAvgSamplesPerSec=4.49514179996766, CurrSamplesPerSec=4.48556760401533, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:04:55,730] [INFO] [RANK 0]  iteration     8150/   20000 | elapsed time per iteration (ms): 1540.6 | learning rate 7.081E-05 | total loss 3.838745E-01 | loss 3.838745E-01 | loss scale 32768.0 |speed 155.78 samples/(min*GPU)
[2024-06-17 08:04:55,731] [INFO] [RANK 0] time (ms) | forward: 354.38 | backward: 543.07 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 14.60 | data loader: 0.23
[2024-06-17 08:05:04,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=8160, skipped=36, lr=[7.074756097248219e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:05:04,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=8160/global_step=8160, RunningAvgSamplesPerSec=4.495132517438716, CurrSamplesPerSec=4.487549664126866, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:05:13,855] [INFO] [logging.py:96:log_dist] [Rank 0] step=8170, skipped=36, lr=[7.068132520616427e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:05:13,856] [INFO] [timer.py:258:stop] epoch=0/micro_step=8170/global_step=8170, RunningAvgSamplesPerSec=4.495116996475876, CurrSamplesPerSec=4.4839216183068435, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:05:22,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=8180, skipped=36, lr=[7.061505074773524e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:05:22,927] [INFO] [timer.py:258:stop] epoch=0/micro_step=8180/global_step=8180, RunningAvgSamplesPerSec=4.495103613048744, CurrSamplesPerSec=4.491045329073182, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:05:32,018] [INFO] [logging.py:96:log_dist] [Rank 0] step=8190, skipped=36, lr=[7.054873776072074e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:05:32,019] [INFO] [timer.py:258:stop] epoch=0/micro_step=8190/global_step=8190, RunningAvgSamplesPerSec=4.495091170663834, CurrSamplesPerSec=4.4710055942147635, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:05:41,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=8200, skipped=36, lr=[7.048238640874146e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:05:41,112] [INFO] [timer.py:258:stop] epoch=0/micro_step=8200/global_step=8200, RunningAvgSamplesPerSec=4.495071909399624, CurrSamplesPerSec=4.473313510262066, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:05:41,112] [INFO] [RANK 0]  iteration     8200/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 7.048E-05 | total loss 3.559558E-01 | loss 3.559558E-01 | loss scale 32768.0 |speed 264.42 samples/(min*GPU)
[2024-06-17 08:05:41,114] [INFO] [RANK 0] time (ms) | forward: 356.78 | backward: 546.85 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 15.00 | data loader: 0.20
[2024-06-17 08:05:50,206] [INFO] [logging.py:96:log_dist] [Rank 0] step=8210, skipped=36, lr=[7.041599685551279e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:05:50,207] [INFO] [timer.py:258:stop] epoch=0/micro_step=8210/global_step=8210, RunningAvgSamplesPerSec=4.495054687796847, CurrSamplesPerSec=4.485294188414685, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:05:59,277] [INFO] [logging.py:96:log_dist] [Rank 0] step=8220, skipped=36, lr=[7.034956926484432e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:05:59,278] [INFO] [timer.py:258:stop] epoch=0/micro_step=8220/global_step=8220, RunningAvgSamplesPerSec=4.495043969705193, CurrSamplesPerSec=4.49363153713593, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:06:08,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=8230, skipped=36, lr=[7.028310380063956e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:06:08,361] [INFO] [timer.py:258:stop] epoch=0/micro_step=8230/global_step=8230, RunningAvgSamplesPerSec=4.495026416347957, CurrSamplesPerSec=4.483121240454084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:06:17,428] [INFO] [logging.py:96:log_dist] [Rank 0] step=8240, skipped=36, lr=[7.021660062689542e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:06:17,429] [INFO] [timer.py:258:stop] epoch=0/micro_step=8240/global_step=8240, RunningAvgSamplesPerSec=4.495014299158936, CurrSamplesPerSec=4.4847618431527065, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:06:26,506] [INFO] [logging.py:96:log_dist] [Rank 0] step=8250, skipped=36, lr=[7.015005990770187e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:06:26,506] [INFO] [timer.py:258:stop] epoch=0/micro_step=8250/global_step=8250, RunningAvgSamplesPerSec=4.495000151613885, CurrSamplesPerSec=4.490601762867053, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:06:26,507] [INFO] [RANK 0]  iteration     8250/   20000 | elapsed time per iteration (ms): 907.9 | learning rate 7.014E-05 | total loss 3.968274E-01 | loss 3.968274E-01 | loss scale 32768.0 |speed 264.35 samples/(min*GPU)
[2024-06-17 08:06:26,508] [INFO] [RANK 0] time (ms) | forward: 356.93 | backward: 546.97 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 15.13 | data loader: 0.13
[2024-06-17 08:06:35,593] [INFO] [logging.py:96:log_dist] [Rank 0] step=8260, skipped=36, lr=[7.008348180724151e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:06:35,594] [INFO] [timer.py:258:stop] epoch=0/micro_step=8260/global_step=8260, RunningAvgSamplesPerSec=4.494985070076884, CurrSamplesPerSec=4.481363329794125, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:06:39,215] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 08:06:40,118] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 08:06:44,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=8270, skipped=38, lr=[7.003019252275074e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:06:44,659] [INFO] [timer.py:258:stop] epoch=0/micro_step=8270/global_step=8270, RunningAvgSamplesPerSec=4.494974036391447, CurrSamplesPerSec=4.482989469105126, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:06:53,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=8280, skipped=38, lr=[6.996354755004447e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:06:53,746] [INFO] [timer.py:258:stop] epoch=0/micro_step=8280/global_step=8280, RunningAvgSamplesPerSec=4.49495307517846, CurrSamplesPerSec=4.463788490933254, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:07:02,834] [INFO] [logging.py:96:log_dist] [Rank 0] step=8290, skipped=38, lr=[6.989686565627211e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:07:02,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=8290/global_step=8290, RunningAvgSamplesPerSec=4.494934255808724, CurrSamplesPerSec=4.484073818285228, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:07:11,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=8300, skipped=38, lr=[6.98301470059646e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:07:11,900] [INFO] [timer.py:258:stop] epoch=0/micro_step=8300/global_step=8300, RunningAvgSamplesPerSec=4.494926840532944, CurrSamplesPerSec=4.4850951436377535, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:07:11,901] [INFO] [RANK 0]  iteration     8300/   20000 | elapsed time per iteration (ms): 907.9 | learning rate 6.982E-05 | total loss 4.036060E-01 | loss 4.036060E-01 | loss scale 32768.0 |speed 264.35 samples/(min*GPU)
[2024-06-17 08:07:11,902] [INFO] [RANK 0] time (ms) | forward: 356.80 | backward: 547.08 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 15.06 | data loader: 0.10
[2024-06-17 08:07:20,968] [INFO] [logging.py:96:log_dist] [Rank 0] step=8310, skipped=38, lr=[6.976339176374359e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:07:20,969] [INFO] [timer.py:258:stop] epoch=0/micro_step=8310/global_step=8310, RunningAvgSamplesPerSec=4.4949162951886805, CurrSamplesPerSec=4.489463797357253, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:07:30,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=8320, skipped=38, lr=[6.969660009432097e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:07:30,046] [INFO] [timer.py:258:stop] epoch=0/micro_step=8320/global_step=8320, RunningAvgSamplesPerSec=4.494896827701181, CurrSamplesPerSec=4.45031504864593, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:07:39,108] [INFO] [logging.py:96:log_dist] [Rank 0] step=8330, skipped=38, lr=[6.962977216249857e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:07:39,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=8330/global_step=8330, RunningAvgSamplesPerSec=4.494882460699169, CurrSamplesPerSec=4.48476304198654, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:07:48,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=8340, skipped=38, lr=[6.956290813316765e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:07:48,177] [INFO] [timer.py:258:stop] epoch=0/micro_step=8340/global_step=8340, RunningAvgSamplesPerSec=4.494866076647944, CurrSamplesPerSec=4.48844768646067, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:07:57,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=8350, skipped=38, lr=[6.949600817130857e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:07:57,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=8350/global_step=8350, RunningAvgSamplesPerSec=4.494840901041218, CurrSamplesPerSec=4.482583422483325, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:07:57,263] [INFO] [RANK 0]  iteration     8350/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 6.949E-05 | total loss 3.456805E-01 | loss 3.456805E-01 | loss scale 32768.0 |speed 264.54 samples/(min*GPU)
[2024-06-17 08:07:57,264] [INFO] [RANK 0] time (ms) | forward: 355.85 | backward: 547.17 | allreduce: 0.00 | optimizer: 3.44 | batch generator: 14.01 | data loader: 0.10
[2024-06-17 08:08:06,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=8360, skipped=38, lr=[6.942907244199033e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:08:06,326] [INFO] [timer.py:258:stop] epoch=0/micro_step=8360/global_step=8360, RunningAvgSamplesPerSec=4.494822891239599, CurrSamplesPerSec=4.4786740497855995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:08:15,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=8370, skipped=38, lr=[6.936210111037022e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:08:15,385] [INFO] [timer.py:258:stop] epoch=0/micro_step=8370/global_step=8370, RunningAvgSamplesPerSec=4.494809433074575, CurrSamplesPerSec=4.483046968377517, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:08:24,448] [INFO] [logging.py:96:log_dist] [Rank 0] step=8380, skipped=38, lr=[6.929509434169328e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:08:24,449] [INFO] [timer.py:258:stop] epoch=0/micro_step=8380/global_step=8380, RunningAvgSamplesPerSec=4.494794689219954, CurrSamplesPerSec=4.4729879211951635, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:08:33,505] [INFO] [logging.py:96:log_dist] [Rank 0] step=8390, skipped=38, lr=[6.922805230129209e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:08:33,506] [INFO] [timer.py:258:stop] epoch=0/micro_step=8390/global_step=8390, RunningAvgSamplesPerSec=4.4947846783903955, CurrSamplesPerSec=4.479911818142007, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:08:42,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=8400, skipped=38, lr=[6.916097515458623e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:08:42,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=8400/global_step=8400, RunningAvgSamplesPerSec=4.494770581164093, CurrSamplesPerSec=4.485765491359725, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:08:42,587] [INFO] [RANK 0]  iteration     8400/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 6.915E-05 | total loss 3.494153E-01 | loss 3.494153E-01 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 08:08:42,588] [INFO] [RANK 0] time (ms) | forward: 355.42 | backward: 547.07 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 13.71 | data loader: 0.10
[2024-06-17 08:08:42,588] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:08:42,600] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/8400/mp_rank_00_model_states.pt
[2024-06-17 08:08:42,600] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/8400/mp_rank_00_model_states.pt...
[2024-06-17 08:09:08,787] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/8400/mp_rank_00_model_states.pt.
[2024-06-17 08:09:17,802] [INFO] [logging.py:96:log_dist] [Rank 0] step=8410, skipped=38, lr=[6.909386306708187e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:09:17,802] [INFO] [timer.py:258:stop] epoch=0/micro_step=8410/global_step=8410, RunningAvgSamplesPerSec=4.494816561514023, CurrSamplesPerSec=4.54096710500496, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:09:26,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=8420, skipped=38, lr=[6.902671620437142e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:09:26,789] [INFO] [timer.py:258:stop] epoch=0/micro_step=8420/global_step=8420, RunningAvgSamplesPerSec=4.494849425719507, CurrSamplesPerSec=4.517346202995514, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:09:35,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=8430, skipped=38, lr=[6.89595347321331e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:09:35,826] [INFO] [timer.py:258:stop] epoch=0/micro_step=8430/global_step=8430, RunningAvgSamplesPerSec=4.494872803337504, CurrSamplesPerSec=4.510546294138032, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:09:44,858] [INFO] [logging.py:96:log_dist] [Rank 0] step=8440, skipped=38, lr=[6.889231881613048e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:09:44,858] [INFO] [timer.py:258:stop] epoch=0/micro_step=8440/global_step=8440, RunningAvgSamplesPerSec=4.494886104696158, CurrSamplesPerSec=4.502223442335812, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:09:53,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=8450, skipped=38, lr=[6.882506862221221e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:09:53,929] [INFO] [timer.py:258:stop] epoch=0/micro_step=8450/global_step=8450, RunningAvgSamplesPerSec=4.4948758647657145, CurrSamplesPerSec=4.469365513842547, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:09:53,930] [INFO] [RANK 0]  iteration     8450/   20000 | elapsed time per iteration (ms): 1426.9 | learning rate 6.882E-05 | total loss 3.956110E-01 | loss 3.956110E-01 | loss scale 32768.0 |speed 168.20 samples/(min*GPU)
[2024-06-17 08:09:53,931] [INFO] [RANK 0] time (ms) | forward: 355.63 | backward: 543.02 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 15.69 | data loader: 0.18
[2024-06-17 08:10:02,986] [INFO] [logging.py:96:log_dist] [Rank 0] step=8460, skipped=38, lr=[6.87577843163114e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:10:02,986] [INFO] [timer.py:258:stop] epoch=0/micro_step=8460/global_step=8460, RunningAvgSamplesPerSec=4.494867230356781, CurrSamplesPerSec=4.4700978628960275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:10:12,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=8470, skipped=38, lr=[6.869046606444543e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:10:12,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=8470/global_step=8470, RunningAvgSamplesPerSec=4.4948479898699025, CurrSamplesPerSec=4.489069789594119, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:10:21,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=8480, skipped=38, lr=[6.862311403271534e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:10:21,120] [INFO] [timer.py:258:stop] epoch=0/micro_step=8480/global_step=8480, RunningAvgSamplesPerSec=4.494830319744494, CurrSamplesPerSec=4.48813669954857, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:10:30,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=8490, skipped=38, lr=[6.855572838730564e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:10:30,170] [INFO] [timer.py:258:stop] epoch=0/micro_step=8490/global_step=8490, RunningAvgSamplesPerSec=4.494823448326413, CurrSamplesPerSec=4.491397599889276, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:10:39,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=8500, skipped=38, lr=[6.848830929448366e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:10:39,255] [INFO] [timer.py:258:stop] epoch=0/micro_step=8500/global_step=8500, RunningAvgSamplesPerSec=4.494802463811613, CurrSamplesPerSec=4.476607843848792, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:10:39,255] [INFO] [RANK 0]  iteration     8500/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 6.848E-05 | total loss 3.761719E-01 | loss 3.761719E-01 | loss scale 32768.0 |speed 264.75 samples/(min*GPU)
[2024-06-17 08:10:39,256] [INFO] [RANK 0] time (ms) | forward: 355.76 | backward: 546.67 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 13.59 | data loader: 0.22
[2024-06-17 08:10:48,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=8510, skipped=38, lr=[6.842085692059935e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:10:48,348] [INFO] [timer.py:258:stop] epoch=0/micro_step=8510/global_step=8510, RunningAvgSamplesPerSec=4.494789104456831, CurrSamplesPerSec=4.490737588196875, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:10:57,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=8520, skipped=38, lr=[6.835337143208472e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:10:57,433] [INFO] [timer.py:258:stop] epoch=0/micro_step=8520/global_step=8520, RunningAvgSamplesPerSec=4.494773406192041, CurrSamplesPerSec=4.4665586137420314, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:11:06,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=8530, skipped=38, lr=[6.828585299545347e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:11:06,512] [INFO] [timer.py:258:stop] epoch=0/micro_step=8530/global_step=8530, RunningAvgSamplesPerSec=4.494757654623297, CurrSamplesPerSec=4.486508024373429, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:11:15,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=8540, skipped=38, lr=[6.821830177730069e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:11:15,605] [INFO] [timer.py:258:stop] epoch=0/micro_step=8540/global_step=8540, RunningAvgSamplesPerSec=4.494741092852213, CurrSamplesPerSec=4.47118075015837, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:11:24,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=8550, skipped=38, lr=[6.815071794430225e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:11:24,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=8550/global_step=8550, RunningAvgSamplesPerSec=4.494730617273466, CurrSamplesPerSec=4.489311231268131, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:11:24,668] [INFO] [RANK 0]  iteration     8550/   20000 | elapsed time per iteration (ms): 908.3 | learning rate 6.814E-05 | total loss 3.953711E-01 | loss 3.953711E-01 | loss scale 32768.0 |speed 264.24 samples/(min*GPU)
[2024-06-17 08:11:24,669] [INFO] [RANK 0] time (ms) | forward: 357.24 | backward: 546.97 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 15.32 | data loader: 0.23
[2024-06-17 08:11:33,736] [INFO] [logging.py:96:log_dist] [Rank 0] step=8560, skipped=38, lr=[6.808310166321457e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:11:33,736] [INFO] [timer.py:258:stop] epoch=0/micro_step=8560/global_step=8560, RunningAvgSamplesPerSec=4.494716182695927, CurrSamplesPerSec=4.4875052525630235, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:11:42,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=8570, skipped=38, lr=[6.801545310087407e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:11:42,799] [INFO] [timer.py:258:stop] epoch=0/micro_step=8570/global_step=8570, RunningAvgSamplesPerSec=4.494705463655194, CurrSamplesPerSec=4.490987624446162, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:11:51,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=8580, skipped=38, lr=[6.794777242419689e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:11:51,858] [INFO] [timer.py:258:stop] epoch=0/micro_step=8580/global_step=8580, RunningAvgSamplesPerSec=4.494693165294671, CurrSamplesPerSec=4.459632037911567, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:12:00,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=8590, skipped=38, lr=[6.788005980017835e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:12:00,922] [INFO] [timer.py:258:stop] epoch=0/micro_step=8590/global_step=8590, RunningAvgSamplesPerSec=4.494683683062233, CurrSamplesPerSec=4.492434293940178, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:12:09,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=8600, skipped=38, lr=[6.781231539589261e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:12:09,990] [INFO] [timer.py:258:stop] epoch=0/micro_step=8600/global_step=8600, RunningAvgSamplesPerSec=4.494673164018478, CurrSamplesPerSec=4.488675850983339, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:12:09,991] [INFO] [RANK 0]  iteration     8600/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 6.781E-05 | total loss 3.712366E-01 | loss 3.712366E-01 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 08:12:09,992] [INFO] [RANK 0] time (ms) | forward: 355.89 | backward: 546.65 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.08 | data loader: 0.16
[2024-06-17 08:12:19,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=8610, skipped=38, lr=[6.774453937849228e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:12:19,069] [INFO] [timer.py:258:stop] epoch=0/micro_step=8610/global_step=8610, RunningAvgSamplesPerSec=4.494659619267237, CurrSamplesPerSec=4.464906346488452, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:12:28,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=8620, skipped=38, lr=[6.76767319152079e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:12:28,152] [INFO] [timer.py:258:stop] epoch=0/micro_step=8620/global_step=8620, RunningAvgSamplesPerSec=4.494637749137327, CurrSamplesPerSec=4.4876516940219, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:12:37,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=8630, skipped=38, lr=[6.760889317334772e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:12:37,239] [INFO] [timer.py:258:stop] epoch=0/micro_step=8630/global_step=8630, RunningAvgSamplesPerSec=4.494621586771575, CurrSamplesPerSec=4.474853842971647, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:12:46,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=8640, skipped=38, lr=[6.754102332029702e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:12:46,296] [INFO] [timer.py:258:stop] epoch=0/micro_step=8640/global_step=8640, RunningAvgSamplesPerSec=4.494614071051558, CurrSamplesPerSec=4.481680561825666, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:12:55,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=8650, skipped=38, lr=[6.747312252351797e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:12:55,363] [INFO] [timer.py:258:stop] epoch=0/micro_step=8650/global_step=8650, RunningAvgSamplesPerSec=4.494598316686595, CurrSamplesPerSec=4.473694020547742, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:12:55,364] [INFO] [RANK 0]  iteration     8650/   20000 | elapsed time per iteration (ms): 907.5 | learning rate 6.747E-05 | total loss 4.245148E-01 | loss 4.245148E-01 | loss scale 32768.0 |speed 264.48 samples/(min*GPU)
[2024-06-17 08:12:55,365] [INFO] [RANK 0] time (ms) | forward: 356.63 | backward: 546.76 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 14.42 | data loader: 0.09
[2024-06-17 08:13:04,458] [INFO] [logging.py:96:log_dist] [Rank 0] step=8660, skipped=38, lr=[6.740519095054897e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:13:04,458] [INFO] [timer.py:258:stop] epoch=0/micro_step=8660/global_step=8660, RunningAvgSamplesPerSec=4.494582078832302, CurrSamplesPerSec=4.466458729781794, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:13:09,895] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 08:13:10,806] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 08:13:13,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=8670, skipped=40, lr=[6.73508236459514e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:13:13,525] [INFO] [timer.py:258:stop] epoch=0/micro_step=8670/global_step=8670, RunningAvgSamplesPerSec=4.494573808866387, CurrSamplesPerSec=4.484522089268025, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:13:22,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=8680, skipped=40, lr=[6.728283709827965e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:13:22,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=8680/global_step=8680, RunningAvgSamplesPerSec=4.494559911112231, CurrSamplesPerSec=4.48836603321514, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:13:31,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=8690, skipped=40, lr=[6.721482024392835e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:13:31,662] [INFO] [timer.py:258:stop] epoch=0/micro_step=8690/global_step=8690, RunningAvgSamplesPerSec=4.49454332657933, CurrSamplesPerSec=4.45893866559932, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:13:40,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=8700, skipped=40, lr=[6.714677325072236e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:13:40,741] [INFO] [timer.py:258:stop] epoch=0/micro_step=8700/global_step=8700, RunningAvgSamplesPerSec=4.4945227165698425, CurrSamplesPerSec=4.484945272182176, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:13:40,741] [INFO] [RANK 0]  iteration     8700/   20000 | elapsed time per iteration (ms): 907.5 | learning rate 6.714E-05 | total loss 3.966650E-01 | loss 3.966650E-01 | loss scale 32768.0 |speed 264.45 samples/(min*GPU)
[2024-06-17 08:13:40,742] [INFO] [RANK 0] time (ms) | forward: 356.67 | backward: 546.98 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 14.47 | data loader: 0.19
[2024-06-17 08:13:40,742] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:13:40,755] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/8700/mp_rank_00_model_states.pt
[2024-06-17 08:13:40,755] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/8700/mp_rank_00_model_states.pt...
[2024-06-17 08:14:07,422] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/8700/mp_rank_00_model_states.pt.
[2024-06-17 08:14:16,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=8710, skipped=40, lr=[6.707869628656081e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:14:16,425] [INFO] [timer.py:258:stop] epoch=0/micro_step=8710/global_step=8710, RunningAvgSamplesPerSec=4.494551979461679, CurrSamplesPerSec=4.539358821454004, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:14:25,424] [INFO] [logging.py:96:log_dist] [Rank 0] step=8720, skipped=40, lr=[6.701058951941691e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:14:25,425] [INFO] [timer.py:258:stop] epoch=0/micro_step=8720/global_step=8720, RunningAvgSamplesPerSec=4.494582092410484, CurrSamplesPerSec=4.519503763421018, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:14:34,440] [INFO] [logging.py:96:log_dist] [Rank 0] step=8730, skipped=40, lr=[6.694245311733731e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:14:34,440] [INFO] [timer.py:258:stop] epoch=0/micro_step=8730/global_step=8730, RunningAvgSamplesPerSec=4.494603491716769, CurrSamplesPerSec=4.507565126720406, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:14:43,476] [INFO] [logging.py:96:log_dist] [Rank 0] step=8740, skipped=40, lr=[6.687428724844179e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:14:43,476] [INFO] [timer.py:258:stop] epoch=0/micro_step=8740/global_step=8740, RunningAvgSamplesPerSec=4.494620951415181, CurrSamplesPerSec=4.499907331586893, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:14:52,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=8750, skipped=40, lr=[6.680609208092288e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:14:52,525] [INFO] [timer.py:258:stop] epoch=0/micro_step=8750/global_step=8750, RunningAvgSamplesPerSec=4.494622484112113, CurrSamplesPerSec=4.484122955917606, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:14:52,527] [INFO] [RANK 0]  iteration     8750/   20000 | elapsed time per iteration (ms): 1435.7 | learning rate 6.680E-05 | total loss 3.863214E-01 | loss 3.863214E-01 | loss scale 32768.0 |speed 167.16 samples/(min*GPU)
[2024-06-17 08:14:52,528] [INFO] [RANK 0] time (ms) | forward: 354.74 | backward: 543.13 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.80 | data loader: 0.10
[2024-06-17 08:15:01,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=8760, skipped=40, lr=[6.673786778304537e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:15:01,581] [INFO] [timer.py:258:stop] epoch=0/micro_step=8760/global_step=8760, RunningAvgSamplesPerSec=4.494617286077062, CurrSamplesPerSec=4.489403730730224, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:15:10,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=8770, skipped=40, lr=[6.666961452314595e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:15:10,660] [INFO] [timer.py:258:stop] epoch=0/micro_step=8770/global_step=8770, RunningAvgSamplesPerSec=4.494609102558073, CurrSamplesPerSec=4.493245221117472, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:15:19,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=8780, skipped=40, lr=[6.66013324696327e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:15:19,710] [INFO] [timer.py:258:stop] epoch=0/micro_step=8780/global_step=8780, RunningAvgSamplesPerSec=4.494602877881861, CurrSamplesPerSec=4.491698215953743, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:15:28,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=8790, skipped=40, lr=[6.653302179098486e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:15:28,794] [INFO] [timer.py:258:stop] epoch=0/micro_step=8790/global_step=8790, RunningAvgSamplesPerSec=4.4945923690621195, CurrSamplesPerSec=4.476131297805238, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:15:37,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=8800, skipped=40, lr=[6.64646826557522e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:15:37,881] [INFO] [timer.py:258:stop] epoch=0/micro_step=8800/global_step=8800, RunningAvgSamplesPerSec=4.494575727293527, CurrSamplesPerSec=4.465570672462047, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:15:37,882] [INFO] [RANK 0]  iteration     8800/   20000 | elapsed time per iteration (ms): 907.1 | learning rate 6.646E-05 | total loss 3.653772E-01 | loss 3.653772E-01 | loss scale 32768.0 |speed 264.58 samples/(min*GPU)
[2024-06-17 08:15:37,883] [INFO] [RANK 0] time (ms) | forward: 356.56 | backward: 546.54 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.99 | data loader: 0.10
[2024-06-17 08:15:46,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=8810, skipped=40, lr=[6.639631523255477e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:15:46,968] [INFO] [timer.py:258:stop] epoch=0/micro_step=8810/global_step=8810, RunningAvgSamplesPerSec=4.494561662552406, CurrSamplesPerSec=4.48647203164477, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:15:56,040] [INFO] [logging.py:96:log_dist] [Rank 0] step=8820, skipped=40, lr=[6.632791969008238e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:15:56,040] [INFO] [timer.py:258:stop] epoch=0/micro_step=8820/global_step=8820, RunningAvgSamplesPerSec=4.494550675480723, CurrSamplesPerSec=4.480964758495214, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:16:05,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=8830, skipped=40, lr=[6.625949619709421e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:16:05,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=8830/global_step=8830, RunningAvgSamplesPerSec=4.494536372439619, CurrSamplesPerSec=4.4616790398192485, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:16:14,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=8840, skipped=40, lr=[6.619104492241848e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:16:14,190] [INFO] [timer.py:258:stop] epoch=0/micro_step=8840/global_step=8840, RunningAvgSamplesPerSec=4.494525770978007, CurrSamplesPerSec=4.4840941922947914, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:16:23,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=8850, skipped=40, lr=[6.612256603495185e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:16:23,251] [INFO] [timer.py:258:stop] epoch=0/micro_step=8850/global_step=8850, RunningAvgSamplesPerSec=4.494511856393256, CurrSamplesPerSec=4.476384487581041, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:16:23,253] [INFO] [RANK 0]  iteration     8850/   20000 | elapsed time per iteration (ms): 907.4 | learning rate 6.612E-05 | total loss 3.448926E-01 | loss 3.448926E-01 | loss scale 32768.0 |speed 264.49 samples/(min*GPU)
[2024-06-17 08:16:23,254] [INFO] [RANK 0] time (ms) | forward: 356.96 | backward: 546.43 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 14.67 | data loader: 0.10
[2024-06-17 08:16:32,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=8860, skipped=40, lr=[6.60540597036592e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:16:32,337] [INFO] [timer.py:258:stop] epoch=0/micro_step=8860/global_step=8860, RunningAvgSamplesPerSec=4.494495770609956, CurrSamplesPerSec=4.485153895981164, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:16:41,450] [INFO] [logging.py:96:log_dist] [Rank 0] step=8870, skipped=40, lr=[6.598552609757307e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:16:41,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=8870/global_step=8870, RunningAvgSamplesPerSec=4.494477995817624, CurrSamplesPerSec=4.477034313169549, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:16:50,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=8880, skipped=40, lr=[6.591696538579334e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:16:50,522] [INFO] [timer.py:258:stop] epoch=0/micro_step=8880/global_step=8880, RunningAvgSamplesPerSec=4.49446447353313, CurrSamplesPerSec=4.470944829032599, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:16:59,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=8890, skipped=40, lr=[6.584837773748675e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:16:59,592] [INFO] [timer.py:258:stop] epoch=0/micro_step=8890/global_step=8890, RunningAvgSamplesPerSec=4.494454874639185, CurrSamplesPerSec=4.490559694741158, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:17:08,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=8900, skipped=40, lr=[6.57797633218865e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:17:08,685] [INFO] [timer.py:258:stop] epoch=0/micro_step=8900/global_step=8900, RunningAvgSamplesPerSec=4.494437872201748, CurrSamplesPerSec=4.484783422259765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:17:08,686] [INFO] [RANK 0]  iteration     8900/   20000 | elapsed time per iteration (ms): 908.7 | learning rate 6.577E-05 | total loss 3.689191E-01 | loss 3.689191E-01 | loss scale 32768.0 |speed 264.12 samples/(min*GPU)
[2024-06-17 08:17:08,687] [INFO] [RANK 0] time (ms) | forward: 357.55 | backward: 547.04 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.55 | data loader: 0.10
[2024-06-17 08:17:17,782] [INFO] [logging.py:96:log_dist] [Rank 0] step=8910, skipped=40, lr=[6.571112230829181e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:17:17,783] [INFO] [timer.py:258:stop] epoch=0/micro_step=8910/global_step=8910, RunningAvgSamplesPerSec=4.494424809725821, CurrSamplesPerSec=4.486985582565142, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:17:26,858] [INFO] [logging.py:96:log_dist] [Rank 0] step=8920, skipped=40, lr=[6.564245486606762e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:17:26,859] [INFO] [timer.py:258:stop] epoch=0/micro_step=8920/global_step=8920, RunningAvgSamplesPerSec=4.494407252383624, CurrSamplesPerSec=4.475117631368365, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:17:35,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=8930, skipped=40, lr=[6.557376116464397e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:17:35,925] [INFO] [timer.py:258:stop] epoch=0/micro_step=8930/global_step=8930, RunningAvgSamplesPerSec=4.494394974984483, CurrSamplesPerSec=4.478922744449473, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:17:45,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=8940, skipped=40, lr=[6.550504137351576e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:17:45,011] [INFO] [timer.py:258:stop] epoch=0/micro_step=8940/global_step=8940, RunningAvgSamplesPerSec=4.494378300782484, CurrSamplesPerSec=4.47351628198175, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:17:54,088] [INFO] [logging.py:96:log_dist] [Rank 0] step=8950, skipped=40, lr=[6.543629566224222e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:17:54,088] [INFO] [timer.py:258:stop] epoch=0/micro_step=8950/global_step=8950, RunningAvgSamplesPerSec=4.494361196001093, CurrSamplesPerSec=4.480404724059547, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:17:54,090] [INFO] [RANK 0]  iteration     8950/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 6.543E-05 | total loss 3.753613E-01 | loss 3.753613E-01 | loss scale 32768.0 |speed 264.30 samples/(min*GPU)
[2024-06-17 08:17:54,090] [INFO] [RANK 0] time (ms) | forward: 357.34 | backward: 546.62 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 14.82 | data loader: 0.09
[2024-06-17 08:18:03,162] [INFO] [logging.py:96:log_dist] [Rank 0] step=8960, skipped=40, lr=[6.536752420044659e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:18:03,163] [INFO] [timer.py:258:stop] epoch=0/micro_step=8960/global_step=8960, RunningAvgSamplesPerSec=4.494348899829182, CurrSamplesPerSec=4.476729683935266, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:18:12,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=8970, skipped=40, lr=[6.52987271578156e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:18:12,232] [INFO] [timer.py:258:stop] epoch=0/micro_step=8970/global_step=8970, RunningAvgSamplesPerSec=4.494339626275857, CurrSamplesPerSec=4.479280291420461, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:18:21,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=8980, skipped=40, lr=[6.522990470409909e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:18:21,306] [INFO] [timer.py:258:stop] epoch=0/micro_step=8980/global_step=8980, RunningAvgSamplesPerSec=4.494327517079619, CurrSamplesPerSec=4.492244237633635, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:18:30,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=8990, skipped=40, lr=[6.516105700910968e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:18:30,374] [INFO] [timer.py:258:stop] epoch=0/micro_step=8990/global_step=8990, RunningAvgSamplesPerSec=4.494316069550937, CurrSamplesPerSec=4.489283602297996, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:18:39,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=9000, skipped=40, lr=[6.509218424272216e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:18:39,454] [INFO] [timer.py:258:stop] epoch=0/micro_step=9000/global_step=9000, RunningAvgSamplesPerSec=4.494306661898881, CurrSamplesPerSec=4.481266373492997, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:18:39,454] [INFO] [RANK 0]  iteration     9000/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 6.509E-05 | total loss 4.161371E-01 | loss 4.161371E-01 | loss scale 32768.0 |speed 264.53 samples/(min*GPU)
[2024-06-17 08:18:39,455] [INFO] [RANK 0] time (ms) | forward: 356.70 | backward: 546.59 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.71 | data loader: 0.09
[2024-06-17 08:18:39,456] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:18:39,472] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/9000/mp_rank_00_model_states.pt
[2024-06-17 08:18:39,472] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/9000/mp_rank_00_model_states.pt...
[2024-06-17 08:19:05,569] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/9000/mp_rank_00_model_states.pt.
[2024-06-17 08:19:12,178] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 08:19:12,179] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 08:19:12,179] [INFO] [RANK 0]  validation loss at iteration 9000 | loss: 8.174316E-01 | PPL: 2.264676E+00 loss 8.178711E-01 |
[2024-06-17 08:19:12,179] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 08:19:21,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=9010, skipped=40, lr=[6.502328657487327e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:19:21,166] [INFO] [timer.py:258:stop] epoch=0/micro_step=9010/global_step=9010, RunningAvgSamplesPerSec=4.4943461999398675, CurrSamplesPerSec=4.519046037542319, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:19:30,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=9020, skipped=40, lr=[6.495436417556114e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:19:30,188] [INFO] [timer.py:258:stop] epoch=0/micro_step=9020/global_step=9020, RunningAvgSamplesPerSec=4.49436661174993, CurrSamplesPerSec=4.5022657292814445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:19:39,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=9030, skipped=40, lr=[6.488541721484493e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:19:39,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=9030/global_step=9030, RunningAvgSamplesPerSec=4.494385615441519, CurrSamplesPerSec=4.502504967532572, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:19:48,248] [INFO] [logging.py:96:log_dist] [Rank 0] step=9040, skipped=40, lr=[6.481644586284443e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:19:48,248] [INFO] [timer.py:258:stop] epoch=0/micro_step=9040/global_step=9040, RunningAvgSamplesPerSec=4.494388860227443, CurrSamplesPerSec=4.490012880821225, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:19:57,310] [INFO] [logging.py:96:log_dist] [Rank 0] step=9050, skipped=40, lr=[6.474745028973957e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:19:57,310] [INFO] [timer.py:258:stop] epoch=0/micro_step=9050/global_step=9050, RunningAvgSamplesPerSec=4.494381950467175, CurrSamplesPerSec=4.482803804442506, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:19:57,312] [INFO] [RANK 0]  iteration     9050/   20000 | elapsed time per iteration (ms): 1557.2 | learning rate 6.474E-05 | total loss 3.986755E-01 | loss 3.986755E-01 | loss scale 32768.0 |speed 154.13 samples/(min*GPU)
[2024-06-17 08:19:57,312] [INFO] [RANK 0] time (ms) | forward: 354.80 | backward: 543.91 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 18.25 | data loader: 0.15
[2024-06-17 08:20:06,373] [INFO] [logging.py:96:log_dist] [Rank 0] step=9060, skipped=40, lr=[6.467843066577012e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:20:06,374] [INFO] [timer.py:258:stop] epoch=0/micro_step=9060/global_step=9060, RunningAvgSamplesPerSec=4.494373805086309, CurrSamplesPerSec=4.49089385758988, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:20:13,622] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 08:20:14,523] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 08:20:15,430] [INFO] [logging.py:96:log_dist] [Rank 0] step=9070, skipped=42, lr=[6.462319776441099e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:20:15,430] [INFO] [timer.py:258:stop] epoch=0/micro_step=9070/global_step=9070, RunningAvgSamplesPerSec=4.494369353752089, CurrSamplesPerSec=4.4801092067635775, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:20:24,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=9080, skipped=42, lr=[6.455413527807843e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:20:24,502] [INFO] [timer.py:258:stop] epoch=0/micro_step=9080/global_step=9080, RunningAvgSamplesPerSec=4.49435626494381, CurrSamplesPerSec=4.4745423501166295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:20:33,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=9090, skipped=42, lr=[6.448504921786685e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:20:33,577] [INFO] [timer.py:258:stop] epoch=0/micro_step=9090/global_step=9090, RunningAvgSamplesPerSec=4.494348438571502, CurrSamplesPerSec=4.484677926377062, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:20:42,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=9100, skipped=42, lr=[6.441593975423919e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:20:42,651] [INFO] [timer.py:258:stop] epoch=0/micro_step=9100/global_step=9100, RunningAvgSamplesPerSec=4.494342071722094, CurrSamplesPerSec=4.483376419726495, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:20:42,653] [INFO] [RANK 0]  iteration     9100/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 6.441E-05 | total loss 3.846158E-01 | loss 3.846158E-01 | loss scale 32768.0 |speed 264.66 samples/(min*GPU)
[2024-06-17 08:20:42,653] [INFO] [RANK 0] time (ms) | forward: 356.59 | backward: 546.32 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 14.87 | data loader: 0.11
[2024-06-17 08:20:51,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=9110, skipped=42, lr=[6.434680705771619e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:20:51,715] [INFO] [timer.py:258:stop] epoch=0/micro_step=9110/global_step=9110, RunningAvgSamplesPerSec=4.494336699962123, CurrSamplesPerSec=4.485206654499171, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:21:00,783] [INFO] [logging.py:96:log_dist] [Rank 0] step=9120, skipped=42, lr=[6.427765129887592e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:21:00,784] [INFO] [timer.py:258:stop] epoch=0/micro_step=9120/global_step=9120, RunningAvgSamplesPerSec=4.494324457605322, CurrSamplesPerSec=4.481034174223101, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:21:09,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=9130, skipped=42, lr=[6.420847264835332e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:21:09,877] [INFO] [timer.py:258:stop] epoch=0/micro_step=9130/global_step=9130, RunningAvgSamplesPerSec=4.494312524395764, CurrSamplesPerSec=4.478108611353115, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:21:18,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=9140, skipped=42, lr=[6.413927127683986e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:21:18,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=9140/global_step=9140, RunningAvgSamplesPerSec=4.494303395597504, CurrSamplesPerSec=4.463853812465744, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:21:28,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=9150, skipped=42, lr=[6.407004735508303e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:21:28,021] [INFO] [timer.py:258:stop] epoch=0/micro_step=9150/global_step=9150, RunningAvgSamplesPerSec=4.494297489964324, CurrSamplesPerSec=4.489665632998042, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:21:28,023] [INFO] [RANK 0]  iteration     9150/   20000 | elapsed time per iteration (ms): 907.4 | learning rate 6.406E-05 | total loss 3.819659E-01 | loss 3.819659E-01 | loss scale 32768.0 |speed 264.49 samples/(min*GPU)
[2024-06-17 08:21:28,024] [INFO] [RANK 0] time (ms) | forward: 357.01 | backward: 546.45 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 15.29 | data loader: 0.09
[2024-06-17 08:21:37,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=9160, skipped=42, lr=[6.4000801053886e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:21:37,104] [INFO] [timer.py:258:stop] epoch=0/micro_step=9160/global_step=9160, RunningAvgSamplesPerSec=4.494285632402748, CurrSamplesPerSec=4.482055312611118, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:21:46,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=9170, skipped=42, lr=[6.393153254410707e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:21:46,177] [INFO] [timer.py:258:stop] epoch=0/micro_step=9170/global_step=9170, RunningAvgSamplesPerSec=4.494272472094787, CurrSamplesPerSec=4.477077322989337, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:21:55,236] [INFO] [logging.py:96:log_dist] [Rank 0] step=9180, skipped=42, lr=[6.386224199665948e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:21:55,237] [INFO] [timer.py:258:stop] epoch=0/micro_step=9180/global_step=9180, RunningAvgSamplesPerSec=4.494262374733261, CurrSamplesPerSec=4.49465360911189, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:22:04,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=9190, skipped=42, lr=[6.379292958251073e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:22:04,315] [INFO] [timer.py:258:stop] epoch=0/micro_step=9190/global_step=9190, RunningAvgSamplesPerSec=4.494248069327005, CurrSamplesPerSec=4.478381151588728, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:22:13,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=9200, skipped=42, lr=[6.37235954726823e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:22:13,382] [INFO] [timer.py:258:stop] epoch=0/micro_step=9200/global_step=9200, RunningAvgSamplesPerSec=4.494236213918452, CurrSamplesPerSec=4.495059436797229, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:22:13,382] [INFO] [RANK 0]  iteration     9200/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 6.372E-05 | total loss 3.871265E-01 | loss 3.871265E-01 | loss scale 32768.0 |speed 264.56 samples/(min*GPU)
[2024-06-17 08:22:13,383] [INFO] [RANK 0] time (ms) | forward: 356.72 | backward: 546.51 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.42 | data loader: 0.09
[2024-06-17 08:22:22,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=9210, skipped=42, lr=[6.365423983824923e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:22:22,437] [INFO] [timer.py:258:stop] epoch=0/micro_step=9210/global_step=9210, RunningAvgSamplesPerSec=4.494229288956065, CurrSamplesPerSec=4.486919582288864, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:22:31,497] [INFO] [logging.py:96:log_dist] [Rank 0] step=9220, skipped=42, lr=[6.358486285033965e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:22:31,497] [INFO] [timer.py:258:stop] epoch=0/micro_step=9220/global_step=9220, RunningAvgSamplesPerSec=4.494222180392956, CurrSamplesPerSec=4.484215241698682, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:22:40,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=9230, skipped=42, lr=[6.35154646801344e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:22:40,564] [INFO] [timer.py:258:stop] epoch=0/micro_step=9230/global_step=9230, RunningAvgSamplesPerSec=4.494215242507195, CurrSamplesPerSec=4.491458922299323, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:22:49,634] [INFO] [logging.py:96:log_dist] [Rank 0] step=9240, skipped=42, lr=[6.344604549886653e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:22:49,635] [INFO] [timer.py:258:stop] epoch=0/micro_step=9240/global_step=9240, RunningAvgSamplesPerSec=4.494208358889196, CurrSamplesPerSec=4.462573858809248, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:22:58,713] [INFO] [logging.py:96:log_dist] [Rank 0] step=9250, skipped=42, lr=[6.337660547782101e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:22:58,713] [INFO] [timer.py:258:stop] epoch=0/micro_step=9250/global_step=9250, RunningAvgSamplesPerSec=4.494198437638723, CurrSamplesPerSec=4.493518403448852, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:22:58,714] [INFO] [RANK 0]  iteration     9250/   20000 | elapsed time per iteration (ms): 906.6 | learning rate 6.337E-05 | total loss 3.369324E-01 | loss 3.369324E-01 | loss scale 32768.0 |speed 264.72 samples/(min*GPU)
[2024-06-17 08:22:58,715] [INFO] [RANK 0] time (ms) | forward: 356.29 | backward: 546.31 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.65 | data loader: 0.10
[2024-06-17 08:23:07,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=9260, skipped=42, lr=[6.330714478833414e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:23:07,763] [INFO] [timer.py:258:stop] epoch=0/micro_step=9260/global_step=9260, RunningAvgSamplesPerSec=4.494191283588567, CurrSamplesPerSec=4.478614271531815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:23:16,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=9270, skipped=42, lr=[6.32376636017933e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:23:16,839] [INFO] [timer.py:258:stop] epoch=0/micro_step=9270/global_step=9270, RunningAvgSamplesPerSec=4.4941863737561025, CurrSamplesPerSec=4.482930773452584, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:23:25,896] [INFO] [logging.py:96:log_dist] [Rank 0] step=9280, skipped=42, lr=[6.316816208963642e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:23:25,896] [INFO] [timer.py:258:stop] epoch=0/micro_step=9280/global_step=9280, RunningAvgSamplesPerSec=4.49417901110469, CurrSamplesPerSec=4.488113887533492, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:23:34,935] [INFO] [logging.py:96:log_dist] [Rank 0] step=9290, skipped=42, lr=[6.309864042335154e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:23:34,935] [INFO] [timer.py:258:stop] epoch=0/micro_step=9290/global_step=9290, RunningAvgSamplesPerSec=4.494174944644964, CurrSamplesPerSec=4.49280964223749, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:23:43,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=9300, skipped=42, lr=[6.30290987744765e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:23:43,998] [INFO] [timer.py:258:stop] epoch=0/micro_step=9300/global_step=9300, RunningAvgSamplesPerSec=4.494171263974065, CurrSamplesPerSec=4.485104735751949, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:23:43,998] [INFO] [RANK 0]  iteration     9300/   20000 | elapsed time per iteration (ms): 905.7 | learning rate 6.302E-05 | total loss 3.563409E-01 | loss 3.563409E-01 | loss scale 32768.0 |speed 264.99 samples/(min*GPU)
[2024-06-17 08:23:44,000] [INFO] [RANK 0] time (ms) | forward: 355.53 | backward: 546.32 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 14.20 | data loader: 0.10
[2024-06-17 08:23:44,000] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:23:44,013] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/9300/mp_rank_00_model_states.pt
[2024-06-17 08:23:44,013] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/9300/mp_rank_00_model_states.pt...
[2024-06-17 08:24:10,296] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/9300/mp_rank_00_model_states.pt.
[2024-06-17 08:24:19,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=9310, skipped=42, lr=[6.295953731459836e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:24:19,282] [INFO] [timer.py:258:stop] epoch=0/micro_step=9310/global_step=9310, RunningAvgSamplesPerSec=4.494218747237638, CurrSamplesPerSec=4.537746767400805, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:24:28,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=9320, skipped=42, lr=[6.288995621535314e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:24:28,275] [INFO] [timer.py:258:stop] epoch=0/micro_step=9320/global_step=9320, RunningAvgSamplesPerSec=4.494247083488147, CurrSamplesPerSec=4.496399067766993, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:24:30,077] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
[2024-06-17 08:24:37,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=9330, skipped=43, lr=[6.282731657626978e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:24:37,282] [INFO] [timer.py:258:stop] epoch=0/micro_step=9330/global_step=9330, RunningAvgSamplesPerSec=4.494271373148228, CurrSamplesPerSec=4.520836078485899, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:24:46,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=9340, skipped=43, lr=[6.275769863525746e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:24:46,304] [INFO] [timer.py:258:stop] epoch=0/micro_step=9340/global_step=9340, RunningAvgSamplesPerSec=4.494287978998152, CurrSamplesPerSec=4.510352277178374, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:24:55,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=9350, skipped=43, lr=[6.26880615528949e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:24:55,333] [INFO] [timer.py:258:stop] epoch=0/micro_step=9350/global_step=9350, RunningAvgSamplesPerSec=4.4942962174358385, CurrSamplesPerSec=4.485145502695009, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:24:55,334] [INFO] [RANK 0]  iteration     9350/   20000 | elapsed time per iteration (ms): 1426.7 | learning rate 6.268E-05 | total loss 3.885742E-01 | loss 3.885742E-01 | loss scale 16384.0 |speed 168.22 samples/(min*GPU)
[2024-06-17 08:24:55,335] [INFO] [RANK 0] time (ms) | forward: 353.94 | backward: 542.63 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.59 | data loader: 0.11
[2024-06-17 08:25:04,355] [INFO] [logging.py:96:log_dist] [Rank 0] step=9360, skipped=43, lr=[6.261840550100471e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:25:04,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=9360/global_step=9360, RunningAvgSamplesPerSec=4.494300419289272, CurrSamplesPerSec=4.495411133106614, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:25:13,371] [INFO] [logging.py:96:log_dist] [Rank 0] step=9370, skipped=43, lr=[6.254873065145627e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:25:13,371] [INFO] [timer.py:258:stop] epoch=0/micro_step=9370/global_step=9370, RunningAvgSamplesPerSec=4.494309737030426, CurrSamplesPerSec=4.496468962515524, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:25:22,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=9380, skipped=43, lr=[6.247903717616537e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:25:22,412] [INFO] [timer.py:258:stop] epoch=0/micro_step=9380/global_step=9380, RunningAvgSamplesPerSec=4.494310088918301, CurrSamplesPerSec=4.489954001111167, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:25:31,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=9390, skipped=43, lr=[6.240932524709368e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:25:31,485] [INFO] [timer.py:258:stop] epoch=0/micro_step=9390/global_step=9390, RunningAvgSamplesPerSec=4.494304245166041, CurrSamplesPerSec=4.494674079376578, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:25:40,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=9400, skipped=43, lr=[6.233959503624849e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:25:40,542] [INFO] [timer.py:258:stop] epoch=0/micro_step=9400/global_step=9400, RunningAvgSamplesPerSec=4.4942960852888785, CurrSamplesPerSec=4.487574871081179, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:25:40,543] [INFO] [RANK 0]  iteration     9400/   20000 | elapsed time per iteration (ms): 904.2 | learning rate 6.233E-05 | total loss 3.506775E-01 | loss 3.506775E-01 | loss scale 16384.0 |speed 265.43 samples/(min*GPU)
[2024-06-17 08:25:40,544] [INFO] [RANK 0] time (ms) | forward: 354.90 | backward: 545.38 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 13.63 | data loader: 0.09
[2024-06-17 08:25:49,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=9410, skipped=43, lr=[6.226984671568217e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:25:49,580] [INFO] [timer.py:258:stop] epoch=0/micro_step=9410/global_step=9410, RunningAvgSamplesPerSec=4.494292439365145, CurrSamplesPerSec=4.485771488218484, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:25:58,617] [INFO] [logging.py:96:log_dist] [Rank 0] step=9420, skipped=43, lr=[6.220008045749174e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:25:58,617] [INFO] [timer.py:258:stop] epoch=0/micro_step=9420/global_step=9420, RunningAvgSamplesPerSec=4.494287561336729, CurrSamplesPerSec=4.47829747342605, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:26:07,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=9430, skipped=43, lr=[6.213029643381852e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:26:07,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=9430/global_step=9430, RunningAvgSamplesPerSec=4.494289076619381, CurrSamplesPerSec=4.496430399626933, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:26:16,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=9440, skipped=43, lr=[6.206049481684765e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:26:16,716] [INFO] [timer.py:258:stop] epoch=0/micro_step=9440/global_step=9440, RunningAvgSamplesPerSec=4.49428882667431, CurrSamplesPerSec=4.494210533788115, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:26:25,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=9450, skipped=43, lr=[6.199067577880769e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:26:25,764] [INFO] [timer.py:258:stop] epoch=0/micro_step=9450/global_step=9450, RunningAvgSamplesPerSec=4.494287069157995, CurrSamplesPerSec=4.475646495438111, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:26:25,764] [INFO] [RANK 0]  iteration     9450/   20000 | elapsed time per iteration (ms): 904.4 | learning rate 6.198E-05 | total loss 3.828241E-01 | loss 3.828241E-01 | loss scale 16384.0 |speed 265.36 samples/(min*GPU)
[2024-06-17 08:26:25,765] [INFO] [RANK 0] time (ms) | forward: 355.02 | backward: 545.53 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 13.57 | data loader: 0.09
[2024-06-17 08:26:34,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=9460, skipped=43, lr=[6.192083949197018e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:26:34,818] [INFO] [timer.py:258:stop] epoch=0/micro_step=9460/global_step=9460, RunningAvgSamplesPerSec=4.494283427997636, CurrSamplesPerSec=4.5007825364267084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:26:43,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=9470, skipped=43, lr=[6.185098612864918e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:26:43,860] [INFO] [timer.py:258:stop] epoch=0/micro_step=9470/global_step=9470, RunningAvgSamplesPerSec=4.494279330536904, CurrSamplesPerSec=4.488989314807159, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:26:52,894] [INFO] [logging.py:96:log_dist] [Rank 0] step=9480, skipped=43, lr=[6.178111586120095e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:26:52,894] [INFO] [timer.py:258:stop] epoch=0/micro_step=9480/global_step=9480, RunningAvgSamplesPerSec=4.494276557054538, CurrSamplesPerSec=4.478340507519148, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:27:01,937] [INFO] [logging.py:96:log_dist] [Rank 0] step=9490, skipped=43, lr=[6.171122886202343e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:27:01,937] [INFO] [timer.py:258:stop] epoch=0/micro_step=9490/global_step=9490, RunningAvgSamplesPerSec=4.4942707102050425, CurrSamplesPerSec=4.489734117070912, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:27:11,010] [INFO] [logging.py:96:log_dist] [Rank 0] step=9500, skipped=43, lr=[6.164132530355582e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:27:11,010] [INFO] [timer.py:258:stop] epoch=0/micro_step=9500/global_step=9500, RunningAvgSamplesPerSec=4.4942697993609855, CurrSamplesPerSec=4.497081236982971, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:27:11,012] [INFO] [RANK 0]  iteration     9500/   20000 | elapsed time per iteration (ms): 904.9 | learning rate 6.163E-05 | total loss 3.560040E-01 | loss 3.560040E-01 | loss scale 16384.0 |speed 265.21 samples/(min*GPU)
[2024-06-17 08:27:11,012] [INFO] [RANK 0] time (ms) | forward: 355.17 | backward: 545.85 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 13.78 | data loader: 0.09
[2024-06-17 08:27:20,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=9510, skipped=43, lr=[6.157140535827825e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:27:20,072] [INFO] [timer.py:258:stop] epoch=0/micro_step=9510/global_step=9510, RunningAvgSamplesPerSec=4.494265527609717, CurrSamplesPerSec=4.491549105356084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:27:29,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=9520, skipped=43, lr=[6.150146919871117e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:27:29,120] [INFO] [timer.py:258:stop] epoch=0/micro_step=9520/global_step=9520, RunningAvgSamplesPerSec=4.494259488565425, CurrSamplesPerSec=4.488756314531563, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:27:38,184] [INFO] [logging.py:96:log_dist] [Rank 0] step=9530, skipped=43, lr=[6.143151699741515e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:27:38,185] [INFO] [timer.py:258:stop] epoch=0/micro_step=9530/global_step=9530, RunningAvgSamplesPerSec=4.4942534997412515, CurrSamplesPerSec=4.486317269491911, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:27:47,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=9540, skipped=43, lr=[6.136154892699027e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:27:47,229] [INFO] [timer.py:258:stop] epoch=0/micro_step=9540/global_step=9540, RunningAvgSamplesPerSec=4.494251977760861, CurrSamplesPerSec=4.494155155514732, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:27:56,283] [INFO] [logging.py:96:log_dist] [Rank 0] step=9550, skipped=43, lr=[6.129156516007581e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:27:56,283] [INFO] [timer.py:258:stop] epoch=0/micro_step=9550/global_step=9550, RunningAvgSamplesPerSec=4.494245344115781, CurrSamplesPerSec=4.492298365956544, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:27:56,284] [INFO] [RANK 0]  iteration     9550/   20000 | elapsed time per iteration (ms): 905.4 | learning rate 6.128E-05 | total loss 3.643823E-01 | loss 3.643823E-01 | loss scale 16384.0 |speed 265.06 samples/(min*GPU)
[2024-06-17 08:27:56,285] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 545.87 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 14.00 | data loader: 0.09
[2024-06-17 08:28:05,345] [INFO] [logging.py:96:log_dist] [Rank 0] step=9560, skipped=43, lr=[6.122156586934971e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:28:05,345] [INFO] [timer.py:258:stop] epoch=0/micro_step=9560/global_step=9560, RunningAvgSamplesPerSec=4.494242216556065, CurrSamplesPerSec=4.492531734105099, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:28:14,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=9570, skipped=43, lr=[6.115155122752833e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:28:14,380] [INFO] [timer.py:258:stop] epoch=0/micro_step=9570/global_step=9570, RunningAvgSamplesPerSec=4.494236722456241, CurrSamplesPerSec=4.491825689313812, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:28:23,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=9580, skipped=43, lr=[6.108152140736579e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:28:23,436] [INFO] [timer.py:258:stop] epoch=0/micro_step=9580/global_step=9580, RunningAvgSamplesPerSec=4.494235848685243, CurrSamplesPerSec=4.48649242745344, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:28:32,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=9590, skipped=43, lr=[6.1011476581653714e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:28:32,483] [INFO] [timer.py:258:stop] epoch=0/micro_step=9590/global_step=9590, RunningAvgSamplesPerSec=4.494226748446461, CurrSamplesPerSec=4.473339750272631, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:28:41,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=9600, skipped=43, lr=[6.094141692322077e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:28:41,531] [INFO] [timer.py:258:stop] epoch=0/micro_step=9600/global_step=9600, RunningAvgSamplesPerSec=4.494218752694031, CurrSamplesPerSec=4.485662347898648, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:28:41,532] [INFO] [RANK 0]  iteration     9600/   20000 | elapsed time per iteration (ms): 905.0 | learning rate 6.093E-05 | total loss 3.684155E-01 | loss 3.684155E-01 | loss scale 16384.0 |speed 265.20 samples/(min*GPU)
[2024-06-17 08:28:41,533] [INFO] [RANK 0] time (ms) | forward: 355.19 | backward: 545.89 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 13.43 | data loader: 0.10
[2024-06-17 08:28:41,534] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:28:41,548] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/9600/mp_rank_00_model_states.pt
[2024-06-17 08:28:41,548] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/9600/mp_rank_00_model_states.pt...
[2024-06-17 08:29:11,316] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/9600/mp_rank_00_model_states.pt.
[2024-06-17 08:29:20,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=9610, skipped=43, lr=[6.0871342604932184e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:29:20,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=9610/global_step=9610, RunningAvgSamplesPerSec=4.494260528622309, CurrSamplesPerSec=4.543095623390156, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:29:29,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=9620, skipped=43, lr=[6.0801253799689384e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:29:29,274] [INFO] [timer.py:258:stop] epoch=0/micro_step=9620/global_step=9620, RunningAvgSamplesPerSec=4.4942920325589215, CurrSamplesPerSec=4.530148850074714, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:29:38,272] [INFO] [logging.py:96:log_dist] [Rank 0] step=9630, skipped=43, lr=[6.073115068042949e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:29:38,272] [INFO] [timer.py:258:stop] epoch=0/micro_step=9630/global_step=9630, RunningAvgSamplesPerSec=4.494319948426966, CurrSamplesPerSec=4.5202502015320745, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:29:47,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=9640, skipped=43, lr=[6.066103342012504e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:29:47,305] [INFO] [timer.py:258:stop] epoch=0/micro_step=9640/global_step=9640, RunningAvgSamplesPerSec=4.494339255186854, CurrSamplesPerSec=4.517632055629411, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:29:56,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=9650, skipped=43, lr=[6.0590902191783365e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:29:56,335] [INFO] [timer.py:258:stop] epoch=0/micro_step=9650/global_step=9650, RunningAvgSamplesPerSec=4.4943500038461135, CurrSamplesPerSec=4.502311641721832, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:29:56,336] [INFO] [RANK 0]  iteration     9650/   20000 | elapsed time per iteration (ms): 1496.1 | learning rate 6.058E-05 | total loss 3.258878E-01 | loss 3.258878E-01 | loss scale 16384.0 |speed 160.42 samples/(min*GPU)
[2024-06-17 08:29:56,337] [INFO] [RANK 0] time (ms) | forward: 353.45 | backward: 542.84 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 14.65 | data loader: 0.10
[2024-06-17 08:30:05,393] [INFO] [logging.py:96:log_dist] [Rank 0] step=9660, skipped=43, lr=[6.05207571684463e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:30:05,394] [INFO] [timer.py:258:stop] epoch=0/micro_step=9660/global_step=9660, RunningAvgSamplesPerSec=4.494349392581645, CurrSamplesPerSec=4.490536858088603, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:30:14,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=9670, skipped=43, lr=[6.045059852318972e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:30:14,442] [INFO] [timer.py:258:stop] epoch=0/micro_step=9670/global_step=9670, RunningAvgSamplesPerSec=4.49435192150905, CurrSamplesPerSec=4.497329569031793, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:30:23,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=9680, skipped=43, lr=[6.038042642912311e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:30:23,520] [INFO] [timer.py:258:stop] epoch=0/micro_step=9680/global_step=9680, RunningAvgSamplesPerSec=4.494345464241049, CurrSamplesPerSec=4.484965654111669, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:30:32,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=9690, skipped=43, lr=[6.0310241059389156e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:30:32,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=9690/global_step=9690, RunningAvgSamplesPerSec=4.494342135978632, CurrSamplesPerSec=4.477009224489621, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:30:41,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=9700, skipped=43, lr=[6.024004258716325e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:30:41,651] [INFO] [timer.py:258:stop] epoch=0/micro_step=9700/global_step=9700, RunningAvgSamplesPerSec=4.494334267899813, CurrSamplesPerSec=4.483320110065335, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:30:41,651] [INFO] [RANK 0]  iteration     9700/   20000 | elapsed time per iteration (ms): 906.3 | learning rate 6.023E-05 | total loss 3.700644E-01 | loss 3.700644E-01 | loss scale 16384.0 |speed 264.81 samples/(min*GPU)
[2024-06-17 08:30:41,652] [INFO] [RANK 0] time (ms) | forward: 356.08 | backward: 546.29 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 15.17 | data loader: 0.12
[2024-06-17 08:30:50,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=9710, skipped=43, lr=[6.016983118565316e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:30:50,742] [INFO] [timer.py:258:stop] epoch=0/micro_step=9710/global_step=9710, RunningAvgSamplesPerSec=4.494325720573364, CurrSamplesPerSec=4.484498115289437, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:30:59,834] [INFO] [logging.py:96:log_dist] [Rank 0] step=9720, skipped=43, lr=[6.009960702809853e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:30:59,835] [INFO] [timer.py:258:stop] epoch=0/micro_step=9720/global_step=9720, RunningAvgSamplesPerSec=4.494311873586137, CurrSamplesPerSec=4.481594366037661, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:31:08,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=9730, skipped=43, lr=[6.0029370287770516e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:31:08,924] [INFO] [timer.py:258:stop] epoch=0/micro_step=9730/global_step=9730, RunningAvgSamplesPerSec=4.494296883640477, CurrSamplesPerSec=4.480420278681384, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:31:18,002] [INFO] [logging.py:96:log_dist] [Rank 0] step=9740, skipped=43, lr=[5.995912113797126e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:31:18,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=9740/global_step=9740, RunningAvgSamplesPerSec=4.494284974461318, CurrSamplesPerSec=4.487559266742738, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:31:27,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=9750, skipped=43, lr=[5.988885975203356e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:31:27,071] [INFO] [timer.py:258:stop] epoch=0/micro_step=9750/global_step=9750, RunningAvgSamplesPerSec=4.494270378235031, CurrSamplesPerSec=4.476226837752006, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:31:27,072] [INFO] [RANK 0]  iteration     9750/   20000 | elapsed time per iteration (ms): 908.4 | learning rate 5.988E-05 | total loss 3.689453E-01 | loss 3.689453E-01 | loss scale 32768.0 |speed 264.19 samples/(min*GPU)
[2024-06-17 08:31:27,073] [INFO] [RANK 0] time (ms) | forward: 357.59 | backward: 546.72 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 15.34 | data loader: 0.11
[2024-06-17 08:31:36,126] [INFO] [logging.py:96:log_dist] [Rank 0] step=9760, skipped=43, lr=[5.9818586303320423e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:31:36,127] [INFO] [timer.py:258:stop] epoch=0/micro_step=9760/global_step=9760, RunningAvgSamplesPerSec=4.494263587880421, CurrSamplesPerSec=4.478553299356882, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:31:45,189] [INFO] [logging.py:96:log_dist] [Rank 0] step=9770, skipped=43, lr=[5.974830096522457e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:31:45,190] [INFO] [timer.py:258:stop] epoch=0/micro_step=9770/global_step=9770, RunningAvgSamplesPerSec=4.494253140916425, CurrSamplesPerSec=4.480501643078706, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:31:54,244] [INFO] [logging.py:96:log_dist] [Rank 0] step=9780, skipped=43, lr=[5.967800391116811e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:31:54,245] [INFO] [timer.py:258:stop] epoch=0/micro_step=9780/global_step=9780, RunningAvgSamplesPerSec=4.494244588333951, CurrSamplesPerSec=4.4666680155864125, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:32:03,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=9790, skipped=43, lr=[5.960769531460202e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:32:03,312] [INFO] [timer.py:258:stop] epoch=0/micro_step=9790/global_step=9790, RunningAvgSamplesPerSec=4.494230322177023, CurrSamplesPerSec=4.47394335549165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:32:12,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=9800, skipped=43, lr=[5.9537375349005786e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:32:12,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=9800/global_step=9800, RunningAvgSamplesPerSec=4.49421641157722, CurrSamplesPerSec=4.4835273845206585, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:32:12,371] [INFO] [RANK 0]  iteration     9800/   20000 | elapsed time per iteration (ms): 906.0 | learning rate 5.953E-05 | total loss 3.530835E-01 | loss 3.530835E-01 | loss scale 32768.0 |speed 264.91 samples/(min*GPU)
[2024-06-17 08:32:12,372] [INFO] [RANK 0] time (ms) | forward: 355.23 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 13.32 | data loader: 0.09
[2024-06-17 08:32:21,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=9810, skipped=43, lr=[5.946704418788691e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:32:21,443] [INFO] [timer.py:258:stop] epoch=0/micro_step=9810/global_step=9810, RunningAvgSamplesPerSec=4.494202951182033, CurrSamplesPerSec=4.479661817522549, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:32:30,499] [INFO] [logging.py:96:log_dist] [Rank 0] step=9820, skipped=43, lr=[5.939670200478057e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:32:30,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=9820/global_step=9820, RunningAvgSamplesPerSec=4.494192398622953, CurrSamplesPerSec=4.479313777003157, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:32:39,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=9830, skipped=43, lr=[5.93263489732491e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:32:39,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=9830/global_step=9830, RunningAvgSamplesPerSec=4.494180959291949, CurrSamplesPerSec=4.484319517216845, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:32:48,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=9840, skipped=43, lr=[5.925598526688159e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:32:48,654] [INFO] [timer.py:258:stop] epoch=0/micro_step=9840/global_step=9840, RunningAvgSamplesPerSec=4.49416849652834, CurrSamplesPerSec=4.491068170897707, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:32:57,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=9850, skipped=43, lr=[5.9185611059293534e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:32:57,720] [INFO] [timer.py:258:stop] epoch=0/micro_step=9850/global_step=9850, RunningAvgSamplesPerSec=4.494159137500144, CurrSamplesPerSec=4.471612145080184, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:32:57,721] [INFO] [RANK 0]  iteration     9850/   20000 | elapsed time per iteration (ms): 907.0 | learning rate 5.918E-05 | total loss 4.085251E-01 | loss 4.085251E-01 | loss scale 32768.0 |speed 264.61 samples/(min*GPU)
[2024-06-17 08:32:57,723] [INFO] [RANK 0] time (ms) | forward: 356.40 | backward: 546.60 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 14.19 | data loader: 0.10
[2024-06-17 08:33:06,779] [INFO] [logging.py:96:log_dist] [Rank 0] step=9860, skipped=43, lr=[5.911522652412625e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:33:06,780] [INFO] [timer.py:258:stop] epoch=0/micro_step=9860/global_step=9860, RunningAvgSamplesPerSec=4.494147233837257, CurrSamplesPerSec=4.490208757092389, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:33:15,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=9870, skipped=43, lr=[5.904483183504662e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:33:15,863] [INFO] [timer.py:258:stop] epoch=0/micro_step=9870/global_step=9870, RunningAvgSamplesPerSec=4.494133532729267, CurrSamplesPerSec=4.484857751884728, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:33:24,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=9880, skipped=43, lr=[5.8974427165746495e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:33:24,926] [INFO] [timer.py:258:stop] epoch=0/micro_step=9880/global_step=9880, RunningAvgSamplesPerSec=4.494125861843855, CurrSamplesPerSec=4.4898999292683275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:33:33,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=9890, skipped=43, lr=[5.890401268994244e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:33:33,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=9890/global_step=9890, RunningAvgSamplesPerSec=4.494111523537388, CurrSamplesPerSec=4.483811369657519, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:33:43,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=9900, skipped=43, lr=[5.883358858137515e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:33:43,086] [INFO] [timer.py:258:stop] epoch=0/micro_step=9900/global_step=9900, RunningAvgSamplesPerSec=4.494095013152818, CurrSamplesPerSec=4.480335327831772, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:33:43,087] [INFO] [RANK 0]  iteration     9900/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 5.883E-05 | total loss 3.244821E-01 | loss 3.244821E-01 | loss scale 32768.0 |speed 264.52 samples/(min*GPU)
[2024-06-17 08:33:43,088] [INFO] [RANK 0] time (ms) | forward: 356.53 | backward: 546.75 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.21 | data loader: 0.09
[2024-06-17 08:33:43,089] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:33:43,101] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/9900/mp_rank_00_model_states.pt
[2024-06-17 08:33:43,101] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/9900/mp_rank_00_model_states.pt...
[2024-06-17 08:34:12,951] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/9900/mp_rank_00_model_states.pt.
[2024-06-17 08:34:21,954] [INFO] [logging.py:96:log_dist] [Rank 0] step=9910, skipped=43, lr=[5.876315501380912e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:34:21,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=9910/global_step=9910, RunningAvgSamplesPerSec=4.494137892427965, CurrSamplesPerSec=4.539115650859734, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:34:30,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=9920, skipped=43, lr=[5.86927121610322e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:34:30,970] [INFO] [timer.py:258:stop] epoch=0/micro_step=9920/global_step=9920, RunningAvgSamplesPerSec=4.494164827569232, CurrSamplesPerSec=4.519956711134651, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:34:39,984] [INFO] [logging.py:96:log_dist] [Rank 0] step=9930, skipped=43, lr=[5.8622260196855085e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:34:39,985] [INFO] [timer.py:258:stop] epoch=0/micro_step=9930/global_step=9930, RunningAvgSamplesPerSec=4.494183596296843, CurrSamplesPerSec=4.517949576917256, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:34:49,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=9940, skipped=43, lr=[5.855179929511101e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:34:49,017] [INFO] [timer.py:258:stop] epoch=0/micro_step=9940/global_step=9940, RunningAvgSamplesPerSec=4.4942024504870055, CurrSamplesPerSec=4.516446307555885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:34:58,051] [INFO] [logging.py:96:log_dist] [Rank 0] step=9950, skipped=43, lr=[5.848132962965526e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:34:58,051] [INFO] [timer.py:258:stop] epoch=0/micro_step=9950/global_step=9950, RunningAvgSamplesPerSec=4.494211547921946, CurrSamplesPerSec=4.48643124058375, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:34:58,053] [INFO] [RANK 0]  iteration     9950/   20000 | elapsed time per iteration (ms): 1499.3 | learning rate 5.847E-05 | total loss 3.204019E-01 | loss 3.204019E-01 | loss scale 32768.0 |speed 160.07 samples/(min*GPU)
[2024-06-17 08:34:58,054] [INFO] [RANK 0] time (ms) | forward: 355.17 | backward: 542.63 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 15.80 | data loader: 0.10
[2024-06-17 08:35:07,101] [INFO] [logging.py:96:log_dist] [Rank 0] step=9960, skipped=43, lr=[5.841085137436471e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:35:07,101] [INFO] [timer.py:258:stop] epoch=0/micro_step=9960/global_step=9960, RunningAvgSamplesPerSec=4.494213570717805, CurrSamplesPerSec=4.483776618489695, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:35:16,170] [INFO] [logging.py:96:log_dist] [Rank 0] step=9970, skipped=43, lr=[5.834036470313746e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:35:16,170] [INFO] [timer.py:258:stop] epoch=0/micro_step=9970/global_step=9970, RunningAvgSamplesPerSec=4.494204781016104, CurrSamplesPerSec=4.499130193663648, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:35:25,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=9980, skipped=43, lr=[5.826986978989236e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:35:25,224] [INFO] [timer.py:258:stop] epoch=0/micro_step=9980/global_step=9980, RunningAvgSamplesPerSec=4.494201462279134, CurrSamplesPerSec=4.490128241464464, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:35:34,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=9990, skipped=43, lr=[5.8199366808568596e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:35:34,289] [INFO] [timer.py:258:stop] epoch=0/micro_step=9990/global_step=9990, RunningAvgSamplesPerSec=4.494187335996824, CurrSamplesPerSec=4.484757047823783, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:35:43,375] [INFO] [logging.py:96:log_dist] [Rank 0] step=10000, skipped=43, lr=[5.812885593312528e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:35:43,376] [INFO] [timer.py:258:stop] epoch=0/micro_step=10000/global_step=10000, RunningAvgSamplesPerSec=4.494173084777921, CurrSamplesPerSec=4.473939776324558, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:35:43,377] [INFO] [RANK 0]  iteration    10000/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 5.812E-05 | total loss 3.280814E-01 | loss 3.280814E-01 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 08:35:43,377] [INFO] [RANK 0] time (ms) | forward: 355.97 | backward: 546.52 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.36 | data loader: 0.09
[2024-06-17 08:35:50,032] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 08:35:50,032] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 08:35:50,032] [INFO] [RANK 0]  validation loss at iteration 10000 | loss: 8.866211E-01 | PPL: 2.426915E+00 loss 8.857422E-01 |
[2024-06-17 08:35:50,032] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 08:35:59,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=10010, skipped=43, lr=[5.805833733754098e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:35:59,097] [INFO] [timer.py:258:stop] epoch=0/micro_step=10010/global_step=10010, RunningAvgSamplesPerSec=4.494167315286236, CurrSamplesPerSec=4.49537379287357, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:36:08,168] [INFO] [logging.py:96:log_dist] [Rank 0] step=10020, skipped=43, lr=[5.798781119581332e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:36:08,169] [INFO] [timer.py:258:stop] epoch=0/micro_step=10020/global_step=10020, RunningAvgSamplesPerSec=4.494159063919464, CurrSamplesPerSec=4.48863982346391, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:36:17,227] [INFO] [logging.py:96:log_dist] [Rank 0] step=10030, skipped=43, lr=[5.791727768195854e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:36:17,228] [INFO] [timer.py:258:stop] epoch=0/micro_step=10030/global_step=10030, RunningAvgSamplesPerSec=4.494151555220287, CurrSamplesPerSec=4.490593349178819, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:36:26,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=10040, skipped=43, lr=[5.784673697001107e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:36:26,281] [INFO] [timer.py:258:stop] epoch=0/micro_step=10040/global_step=10040, RunningAvgSamplesPerSec=4.494147729081047, CurrSamplesPerSec=4.490666669521755, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:36:35,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=10050, skipped=43, lr=[5.777618923402313e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:36:35,359] [INFO] [timer.py:258:stop] epoch=0/micro_step=10050/global_step=10050, RunningAvgSamplesPerSec=4.494137501676576, CurrSamplesPerSec=4.475117631368365, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:36:35,360] [INFO] [RANK 0]  iteration    10050/   20000 | elapsed time per iteration (ms): 1039.7 | learning rate 5.777E-05 | total loss 3.981042E-01 | loss 3.981042E-01 | loss scale 32768.0 |speed 230.84 samples/(min*GPU)
[2024-06-17 08:36:35,361] [INFO] [RANK 0] time (ms) | forward: 356.00 | backward: 546.60 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 17.94 | data loader: 0.13
[2024-06-17 08:36:44,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=10060, skipped=43, lr=[5.7705634648064215e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:36:44,453] [INFO] [timer.py:258:stop] epoch=0/micro_step=10060/global_step=10060, RunningAvgSamplesPerSec=4.4941187263971445, CurrSamplesPerSec=4.455226571790178, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:36:53,533] [INFO] [logging.py:96:log_dist] [Rank 0] step=10070, skipped=43, lr=[5.763507338622077e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:36:53,534] [INFO] [timer.py:258:stop] epoch=0/micro_step=10070/global_step=10070, RunningAvgSamplesPerSec=4.494104463484101, CurrSamplesPerSec=4.480049390192939, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:37:02,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=10080, skipped=43, lr=[5.756450562259567e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:37:02,628] [INFO] [timer.py:258:stop] epoch=0/micro_step=10080/global_step=10080, RunningAvgSamplesPerSec=4.4940894870571215, CurrSamplesPerSec=4.487880978124504, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:37:11,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=10090, skipped=43, lr=[5.749393153130791e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:37:11,705] [INFO] [timer.py:258:stop] epoch=0/micro_step=10090/global_step=10090, RunningAvgSamplesPerSec=4.494078191017426, CurrSamplesPerSec=4.485631165925577, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:37:20,779] [INFO] [logging.py:96:log_dist] [Rank 0] step=10100, skipped=43, lr=[5.742335128649199e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:37:20,780] [INFO] [timer.py:258:stop] epoch=0/micro_step=10100/global_step=10100, RunningAvgSamplesPerSec=4.494069129644872, CurrSamplesPerSec=4.479672582524562, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:37:20,780] [INFO] [RANK 0]  iteration    10100/   20000 | elapsed time per iteration (ms): 908.4 | learning rate 5.742E-05 | total loss 3.325702E-01 | loss 3.325702E-01 | loss scale 32768.0 |speed 264.20 samples/(min*GPU)
[2024-06-17 08:37:20,781] [INFO] [RANK 0] time (ms) | forward: 357.61 | backward: 546.74 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.08 | data loader: 0.09
[2024-06-17 08:37:29,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=10110, skipped=43, lr=[5.7352765062297676e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:37:29,871] [INFO] [timer.py:258:stop] epoch=0/micro_step=10110/global_step=10110, RunningAvgSamplesPerSec=4.494054785813131, CurrSamplesPerSec=4.474213002545764, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:37:38,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=10120, skipped=43, lr=[5.7282173032889454e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:37:38,933] [INFO] [timer.py:258:stop] epoch=0/micro_step=10120/global_step=10120, RunningAvgSamplesPerSec=4.49404781375587, CurrSamplesPerSec=4.484793013040671, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:37:41,655] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 08:37:42,562] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 08:37:48,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=10130, skipped=45, lr=[5.7225695346656544e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:37:48,001] [INFO] [timer.py:258:stop] epoch=0/micro_step=10130/global_step=10130, RunningAvgSamplesPerSec=4.494035047115732, CurrSamplesPerSec=4.465394767275202, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:37:57,074] [INFO] [logging.py:96:log_dist] [Rank 0] step=10140, skipped=45, lr=[5.715509330680325e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:37:57,074] [INFO] [timer.py:258:stop] epoch=0/micro_step=10140/global_step=10140, RunningAvgSamplesPerSec=4.494025415901341, CurrSamplesPerSec=4.4784564646088505, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:38:06,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=10150, skipped=45, lr=[5.708448594947145e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:38:06,171] [INFO] [timer.py:258:stop] epoch=0/micro_step=10150/global_step=10150, RunningAvgSamplesPerSec=4.494010302338324, CurrSamplesPerSec=4.470347988276046, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:38:06,173] [INFO] [RANK 0]  iteration    10150/   20000 | elapsed time per iteration (ms): 907.9 | learning rate 5.708E-05 | total loss 3.448636E-01 | loss 3.448636E-01 | loss scale 32768.0 |speed 264.36 samples/(min*GPU)
[2024-06-17 08:38:06,173] [INFO] [RANK 0] time (ms) | forward: 357.10 | backward: 546.79 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.85 | data loader: 0.11
[2024-06-17 08:38:15,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=10160, skipped=45, lr=[5.701387344887778e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:38:15,264] [INFO] [timer.py:258:stop] epoch=0/micro_step=10160/global_step=10160, RunningAvgSamplesPerSec=4.493995399472446, CurrSamplesPerSec=4.454669403636388, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:38:24,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=10170, skipped=45, lr=[5.694325597925157e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:38:24,340] [INFO] [timer.py:258:stop] epoch=0/micro_step=10170/global_step=10170, RunningAvgSamplesPerSec=4.493984259972603, CurrSamplesPerSec=4.480027856618523, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:38:33,400] [INFO] [logging.py:96:log_dist] [Rank 0] step=10180, skipped=45, lr=[5.68726337148344e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:38:33,400] [INFO] [timer.py:258:stop] epoch=0/micro_step=10180/global_step=10180, RunningAvgSamplesPerSec=4.493978928246405, CurrSamplesPerSec=4.492261077416537, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:38:42,450] [INFO] [logging.py:96:log_dist] [Rank 0] step=10190, skipped=45, lr=[5.6802006829879696e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:38:42,451] [INFO] [timer.py:258:stop] epoch=0/micro_step=10190/global_step=10190, RunningAvgSamplesPerSec=4.493971611007522, CurrSamplesPerSec=4.490041720426309, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:38:51,519] [INFO] [logging.py:96:log_dist] [Rank 0] step=10200, skipped=45, lr=[5.6731375498652276e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:38:51,519] [INFO] [timer.py:258:stop] epoch=0/micro_step=10200/global_step=10200, RunningAvgSamplesPerSec=4.493964270252322, CurrSamplesPerSec=4.493283729390871, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:38:51,521] [INFO] [RANK 0]  iteration    10200/   20000 | elapsed time per iteration (ms): 907.0 | learning rate 5.672E-05 | total loss 3.991510E-01 | loss 3.991510E-01 | loss scale 32768.0 |speed 264.62 samples/(min*GPU)
[2024-06-17 08:38:51,521] [INFO] [RANK 0] time (ms) | forward: 356.40 | backward: 546.59 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.50 | data loader: 0.10
[2024-06-17 08:38:51,522] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:38:51,535] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/10200/mp_rank_00_model_states.pt
[2024-06-17 08:38:51,535] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/10200/mp_rank_00_model_states.pt...
[2024-06-17 08:39:21,225] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/10200/mp_rank_00_model_states.pt.
[2024-06-17 08:39:30,196] [INFO] [logging.py:96:log_dist] [Rank 0] step=10210, skipped=45, lr=[5.6660739895427915e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:39:30,197] [INFO] [timer.py:258:stop] epoch=0/micro_step=10210/global_step=10210, RunningAvgSamplesPerSec=4.4940023155755435, CurrSamplesPerSec=4.5455783392989275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:39:39,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=10220, skipped=45, lr=[5.659010019449296e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:39:39,159] [INFO] [timer.py:258:stop] epoch=0/micro_step=10220/global_step=10220, RunningAvgSamplesPerSec=4.494042444087782, CurrSamplesPerSec=4.524009271713185, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:39:48,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=10230, skipped=45, lr=[5.651945657014383e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:39:48,154] [INFO] [timer.py:258:stop] epoch=0/micro_step=10230/global_step=10230, RunningAvgSamplesPerSec=4.494069527435757, CurrSamplesPerSec=4.501809072301713, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:39:57,166] [INFO] [logging.py:96:log_dist] [Rank 0] step=10240, skipped=45, lr=[5.644880919668667e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:39:57,167] [INFO] [timer.py:258:stop] epoch=0/micro_step=10240/global_step=10240, RunningAvgSamplesPerSec=4.494089910811593, CurrSamplesPerSec=4.517544471404018, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:40:06,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=10250, skipped=45, lr=[5.637815824843684e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:40:06,188] [INFO] [timer.py:258:stop] epoch=0/micro_step=10250/global_step=10250, RunningAvgSamplesPerSec=4.494103960771523, CurrSamplesPerSec=4.5136589087723715, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:40:06,189] [INFO] [RANK 0]  iteration    10250/   20000 | elapsed time per iteration (ms): 1493.4 | learning rate 5.637E-05 | total loss 3.900464E-01 | loss 3.900464E-01 | loss scale 32768.0 |speed 160.71 samples/(min*GPU)
[2024-06-17 08:40:06,190] [INFO] [RANK 0] time (ms) | forward: 353.02 | backward: 542.13 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.11 | data loader: 0.10
[2024-06-17 08:40:15,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=10260, skipped=45, lr=[5.630750389971852e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:40:15,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=10260/global_step=10260, RunningAvgSamplesPerSec=4.4941107355134715, CurrSamplesPerSec=4.483445910194344, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:40:24,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=10270, skipped=45, lr=[5.6236846324864304e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:40:24,223] [INFO] [timer.py:258:stop] epoch=0/micro_step=10270/global_step=10270, RunningAvgSamplesPerSec=4.494107978811163, CurrSamplesPerSec=4.494570525834138, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:40:33,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=10280, skipped=45, lr=[5.616618569821475e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:40:33,255] [INFO] [timer.py:258:stop] epoch=0/micro_step=10280/global_step=10280, RunningAvgSamplesPerSec=4.494106787494955, CurrSamplesPerSec=4.48867945376709, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:40:42,310] [INFO] [logging.py:96:log_dist] [Rank 0] step=10290, skipped=45, lr=[5.609552219411791e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:40:42,311] [INFO] [timer.py:258:stop] epoch=0/micro_step=10290/global_step=10290, RunningAvgSamplesPerSec=4.494103496233086, CurrSamplesPerSec=4.487754928990491, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:40:51,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=10300, skipped=45, lr=[5.6024855986928926e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:40:51,373] [INFO] [timer.py:258:stop] epoch=0/micro_step=10300/global_step=10300, RunningAvgSamplesPerSec=4.4940967149061954, CurrSamplesPerSec=4.4775612404102105, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:40:51,374] [INFO] [RANK 0]  iteration    10300/   20000 | elapsed time per iteration (ms): 903.7 | learning rate 5.602E-05 | total loss 3.282526E-01 | loss 3.282526E-01 | loss scale 32768.0 |speed 265.58 samples/(min*GPU)
[2024-06-17 08:40:51,375] [INFO] [RANK 0] time (ms) | forward: 353.72 | backward: 546.12 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 12.82 | data loader: 0.09
[2024-06-17 08:41:00,440] [INFO] [logging.py:96:log_dist] [Rank 0] step=10310, skipped=45, lr=[5.5954187251009694e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:41:00,440] [INFO] [timer.py:258:stop] epoch=0/micro_step=10310/global_step=10310, RunningAvgSamplesPerSec=4.4940899120718, CurrSamplesPerSec=4.490413063435602, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:41:09,537] [INFO] [logging.py:96:log_dist] [Rank 0] step=10320, skipped=45, lr=[5.5883516160728274e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:41:09,537] [INFO] [timer.py:258:stop] epoch=0/micro_step=10320/global_step=10320, RunningAvgSamplesPerSec=4.494078356396606, CurrSamplesPerSec=4.469798940231429, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:41:18,617] [INFO] [logging.py:96:log_dist] [Rank 0] step=10330, skipped=45, lr=[5.581284289045856e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:41:18,618] [INFO] [timer.py:258:stop] epoch=0/micro_step=10330/global_step=10330, RunningAvgSamplesPerSec=4.494069870108671, CurrSamplesPerSec=4.493795230001034, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:41:27,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=10340, skipped=45, lr=[5.5742167614579804e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:41:27,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=10340/global_step=10340, RunningAvgSamplesPerSec=4.494062998830584, CurrSamplesPerSec=4.478697961533934, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:41:36,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=10350, skipped=45, lr=[5.5671490507476246e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:41:36,752] [INFO] [timer.py:258:stop] epoch=0/micro_step=10350/global_step=10350, RunningAvgSamplesPerSec=4.49405419345039, CurrSamplesPerSec=4.491529866000089, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:41:36,753] [INFO] [RANK 0]  iteration    10350/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 5.566E-05 | total loss 2.648285E-01 | loss 2.648285E-01 | loss scale 32768.0 |speed 264.44 samples/(min*GPU)
[2024-06-17 08:41:36,754] [INFO] [RANK 0] time (ms) | forward: 356.93 | backward: 546.64 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.16 | data loader: 0.10
[2024-06-17 08:41:45,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=10360, skipped=45, lr=[5.560081174353661e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:41:45,819] [INFO] [timer.py:258:stop] epoch=0/micro_step=10360/global_step=10360, RunningAvgSamplesPerSec=4.494045593033673, CurrSamplesPerSec=4.486065353940571, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:41:54,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=10370, skipped=45, lr=[5.5530131497153713e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:41:54,878] [INFO] [timer.py:258:stop] epoch=0/micro_step=10370/global_step=10370, RunningAvgSamplesPerSec=4.494040132056138, CurrSamplesPerSec=4.489230747824449, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:42:03,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=10380, skipped=45, lr=[5.545944994272407e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:42:03,952] [INFO] [timer.py:258:stop] epoch=0/micro_step=10380/global_step=10380, RunningAvgSamplesPerSec=4.494032737888568, CurrSamplesPerSec=4.481690139340115, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:42:13,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=10390, skipped=45, lr=[5.5388767254647334e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:42:13,010] [INFO] [timer.py:258:stop] epoch=0/micro_step=10390/global_step=10390, RunningAvgSamplesPerSec=4.494024172731673, CurrSamplesPerSec=4.482809793385129, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:42:22,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=10400, skipped=45, lr=[5.531808360732606e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:42:22,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=10400/global_step=10400, RunningAvgSamplesPerSec=4.494020706314881, CurrSamplesPerSec=4.492223789495556, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:42:22,061] [INFO] [RANK 0]  iteration    10400/   20000 | elapsed time per iteration (ms): 906.1 | learning rate 5.531E-05 | total loss 3.761011E-01 | loss 3.761011E-01 | loss scale 32768.0 |speed 264.86 samples/(min*GPU)
[2024-06-17 08:42:22,061] [INFO] [RANK 0] time (ms) | forward: 355.63 | backward: 546.55 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.13 | data loader: 0.10
[2024-06-17 08:42:31,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=10410, skipped=45, lr=[5.52473991751651e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:42:31,142] [INFO] [timer.py:258:stop] epoch=0/micro_step=10410/global_step=10410, RunningAvgSamplesPerSec=4.494003682259988, CurrSamplesPerSec=4.480879786997363, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:42:40,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=10420, skipped=45, lr=[5.5176714132571276e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:42:40,230] [INFO] [timer.py:258:stop] epoch=0/micro_step=10420/global_step=10420, RunningAvgSamplesPerSec=4.493986774325219, CurrSamplesPerSec=4.467311454431054, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:42:49,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=10430, skipped=45, lr=[5.5106028653952885e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:42:49,313] [INFO] [timer.py:258:stop] epoch=0/micro_step=10430/global_step=10430, RunningAvgSamplesPerSec=4.493969773351437, CurrSamplesPerSec=4.469978765409731, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:42:58,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=10440, skipped=45, lr=[5.503534291371934e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:42:58,382] [INFO] [timer.py:258:stop] epoch=0/micro_step=10440/global_step=10440, RunningAvgSamplesPerSec=4.493959750712412, CurrSamplesPerSec=4.489752139542601, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:43:07,446] [INFO] [logging.py:96:log_dist] [Rank 0] step=10450, skipped=45, lr=[5.496465708628067e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:43:07,446] [INFO] [timer.py:258:stop] epoch=0/micro_step=10450/global_step=10450, RunningAvgSamplesPerSec=4.493955772632118, CurrSamplesPerSec=4.481171815215809, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:43:07,448] [INFO] [RANK 0]  iteration    10450/   20000 | elapsed time per iteration (ms): 907.7 | learning rate 5.496E-05 | total loss 3.255777E-01 | loss 3.255777E-01 | loss scale 32768.0 |speed 264.39 samples/(min*GPU)
[2024-06-17 08:43:07,449] [INFO] [RANK 0] time (ms) | forward: 356.87 | backward: 546.85 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.41 | data loader: 0.11
[2024-06-17 08:43:16,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=10460, skipped=45, lr=[5.489397134604712e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:43:16,511] [INFO] [timer.py:258:stop] epoch=0/micro_step=10460/global_step=10460, RunningAvgSamplesPerSec=4.493946862047645, CurrSamplesPerSec=4.476411958005462, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:43:25,565] [INFO] [logging.py:96:log_dist] [Rank 0] step=10470, skipped=45, lr=[5.482328586742874e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:43:25,566] [INFO] [timer.py:258:stop] epoch=0/micro_step=10470/global_step=10470, RunningAvgSamplesPerSec=4.493934123972831, CurrSamplesPerSec=4.47864296489448, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:43:34,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=10480, skipped=45, lr=[5.4752600824834905e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:43:34,604] [INFO] [timer.py:258:stop] epoch=0/micro_step=10480/global_step=10480, RunningAvgSamplesPerSec=4.493929501105604, CurrSamplesPerSec=4.492958836542975, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:43:43,675] [INFO] [logging.py:96:log_dist] [Rank 0] step=10490, skipped=45, lr=[5.468191639267395e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:43:43,675] [INFO] [timer.py:258:stop] epoch=0/micro_step=10490/global_step=10490, RunningAvgSamplesPerSec=4.493921156835145, CurrSamplesPerSec=4.485465668863697, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:43:52,726] [INFO] [logging.py:96:log_dist] [Rank 0] step=10500, skipped=45, lr=[5.461123274535267e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:43:52,727] [INFO] [timer.py:258:stop] epoch=0/micro_step=10500/global_step=10500, RunningAvgSamplesPerSec=4.493910192623859, CurrSamplesPerSec=4.482159487698731, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:43:52,728] [INFO] [RANK 0]  iteration    10500/   20000 | elapsed time per iteration (ms): 905.6 | learning rate 5.460E-05 | total loss 3.452582E-01 | loss 3.452582E-01 | loss scale 32768.0 |speed 265.02 samples/(min*GPU)
[2024-06-17 08:43:52,729] [INFO] [RANK 0] time (ms) | forward: 354.93 | backward: 546.67 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 13.07 | data loader: 0.10
[2024-06-17 08:43:52,729] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:43:52,743] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/10500/mp_rank_00_model_states.pt
[2024-06-17 08:43:52,743] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/10500/mp_rank_00_model_states.pt...
[2024-06-17 08:44:24,684] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/10500/mp_rank_00_model_states.pt.
[2024-06-17 08:44:33,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=10510, skipped=45, lr=[5.454055005727595e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:44:33,681] [INFO] [timer.py:258:stop] epoch=0/micro_step=10510/global_step=10510, RunningAvgSamplesPerSec=4.493943583066743, CurrSamplesPerSec=4.533798210338829, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:44:42,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=10520, skipped=45, lr=[5.446986850284628e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:44:42,663] [INFO] [timer.py:258:stop] epoch=0/micro_step=10520/global_step=10520, RunningAvgSamplesPerSec=4.493975200315008, CurrSamplesPerSec=4.526860772964275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:44:47,153] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 08:44:48,050] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 08:44:51,659] [INFO] [logging.py:96:log_dist] [Rank 0] step=10530, skipped=47, lr=[5.441332419272516e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:44:51,659] [INFO] [timer.py:258:stop] epoch=0/micro_step=10530/global_step=10530, RunningAvgSamplesPerSec=4.4939993402033425, CurrSamplesPerSec=4.501491400000268, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:45:00,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=10540, skipped=47, lr=[5.4342645118345316e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:45:00,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=10540/global_step=10540, RunningAvgSamplesPerSec=4.494009123780659, CurrSamplesPerSec=4.492291148771457, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:45:09,734] [INFO] [logging.py:96:log_dist] [Rank 0] step=10550, skipped=47, lr=[5.427196766592331e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:45:09,734] [INFO] [timer.py:258:stop] epoch=0/micro_step=10550/global_step=10550, RunningAvgSamplesPerSec=4.4940073775741585, CurrSamplesPerSec=4.4819535370298045, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:45:09,737] [INFO] [RANK 0]  iteration    10550/   20000 | elapsed time per iteration (ms): 1540.2 | learning rate 5.426E-05 | total loss 3.416623E-01 | loss 3.416623E-01 | loss scale 32768.0 |speed 155.83 samples/(min*GPU)
[2024-06-17 08:45:09,738] [INFO] [RANK 0] time (ms) | forward: 353.95 | backward: 542.87 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.24 | data loader: 0.12
[2024-06-17 08:45:18,829] [INFO] [logging.py:96:log_dist] [Rank 0] step=10560, skipped=47, lr=[5.42012920098487e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:45:18,830] [INFO] [timer.py:258:stop] epoch=0/micro_step=10560/global_step=10560, RunningAvgSamplesPerSec=4.493999809950736, CurrSamplesPerSec=4.481250812995861, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:45:27,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=10570, skipped=47, lr=[5.413061832450667e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:45:27,909] [INFO] [timer.py:258:stop] epoch=0/micro_step=10570/global_step=10570, RunningAvgSamplesPerSec=4.49398938005886, CurrSamplesPerSec=4.487366022006721, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:45:36,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=10580, skipped=47, lr=[5.4059946784277496e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:45:36,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=10580/global_step=10580, RunningAvgSamplesPerSec=4.493987526274024, CurrSamplesPerSec=4.493514792893069, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:45:46,032] [INFO] [logging.py:96:log_dist] [Rank 0] step=10590, skipped=47, lr=[5.3989277563536196e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:45:46,033] [INFO] [timer.py:258:stop] epoch=0/micro_step=10590/global_step=10590, RunningAvgSamplesPerSec=4.493977594331625, CurrSamplesPerSec=4.485575998881361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:45:55,101] [INFO] [logging.py:96:log_dist] [Rank 0] step=10600, skipped=47, lr=[5.391861083665202e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:45:55,101] [INFO] [timer.py:258:stop] epoch=0/micro_step=10600/global_step=10600, RunningAvgSamplesPerSec=4.493967190494447, CurrSamplesPerSec=4.470438516740547, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:45:55,103] [INFO] [RANK 0]  iteration    10600/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 5.391E-05 | total loss 3.100023E-01 | loss 3.100023E-01 | loss scale 32768.0 |speed 264.52 samples/(min*GPU)
[2024-06-17 08:45:55,104] [INFO] [RANK 0] time (ms) | forward: 356.64 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.99 | data loader: 0.10
[2024-06-17 08:46:04,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=10610, skipped=47, lr=[5.384794677798812e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:46:04,153] [INFO] [timer.py:258:stop] epoch=0/micro_step=10610/global_step=10610, RunningAvgSamplesPerSec=4.49396200682234, CurrSamplesPerSec=4.48166380127388, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:46:13,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=10620, skipped=47, lr=[5.3777285561901006e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:46:13,216] [INFO] [timer.py:258:stop] epoch=0/micro_step=10620/global_step=10620, RunningAvgSamplesPerSec=4.493955055524092, CurrSamplesPerSec=4.475962918577315, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:46:22,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=10630, skipped=47, lr=[5.3706627362740246e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:46:22,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=10630/global_step=10630, RunningAvgSamplesPerSec=4.493945950511915, CurrSamplesPerSec=4.481121545351374, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:46:31,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=10640, skipped=47, lr=[5.3635972354847875e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:46:31,359] [INFO] [timer.py:258:stop] epoch=0/micro_step=10640/global_step=10640, RunningAvgSamplesPerSec=4.493938458141608, CurrSamplesPerSec=4.49546895146553, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:46:40,447] [INFO] [logging.py:96:log_dist] [Rank 0] step=10650, skipped=47, lr=[5.356532071255815e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:46:40,448] [INFO] [timer.py:258:stop] epoch=0/micro_step=10650/global_step=10650, RunningAvgSamplesPerSec=4.49392651332669, CurrSamplesPerSec=4.482646899847516, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:46:40,449] [INFO] [RANK 0]  iteration    10650/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 5.356E-05 | total loss 3.658008E-01 | loss 3.658008E-01 | loss scale 32768.0 |speed 264.63 samples/(min*GPU)
[2024-06-17 08:46:40,450] [INFO] [RANK 0] time (ms) | forward: 356.07 | backward: 546.86 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.58 | data loader: 0.11
[2024-06-17 08:46:49,527] [INFO] [logging.py:96:log_dist] [Rank 0] step=10660, skipped=47, lr=[5.349467261019692e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:46:49,528] [INFO] [timer.py:258:stop] epoch=0/micro_step=10660/global_step=10660, RunningAvgSamplesPerSec=4.493916319562006, CurrSamplesPerSec=4.490737588196875, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:46:58,600] [INFO] [logging.py:96:log_dist] [Rank 0] step=10670, skipped=47, lr=[5.342402822208141e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:46:58,601] [INFO] [timer.py:258:stop] epoch=0/micro_step=10670/global_step=10670, RunningAvgSamplesPerSec=4.493906627663939, CurrSamplesPerSec=4.47872426475201, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:47:07,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=10680, skipped=47, lr=[5.335338772251957e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:47:07,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=10680/global_step=10680, RunningAvgSamplesPerSec=4.493897106708645, CurrSamplesPerSec=4.4836807559917045, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:47:16,752] [INFO] [logging.py:96:log_dist] [Rank 0] step=10690, skipped=47, lr=[5.3282751285809865e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:47:16,752] [INFO] [timer.py:258:stop] epoch=0/micro_step=10690/global_step=10690, RunningAvgSamplesPerSec=4.493890738142331, CurrSamplesPerSec=4.478207821721737, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:47:25,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=10700, skipped=47, lr=[5.321211908624064e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:47:25,817] [INFO] [timer.py:258:stop] epoch=0/micro_step=10700/global_step=10700, RunningAvgSamplesPerSec=4.493880114265925, CurrSamplesPerSec=4.4684679693781915, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:47:25,818] [INFO] [RANK 0]  iteration    10700/   20000 | elapsed time per iteration (ms): 907.4 | learning rate 5.321E-05 | total loss 3.784109E-01 | loss 3.784109E-01 | loss scale 32768.0 |speed 264.50 samples/(min*GPU)
[2024-06-17 08:47:25,819] [INFO] [RANK 0] time (ms) | forward: 356.76 | backward: 546.69 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.81 | data loader: 0.18
[2024-06-17 08:47:34,897] [INFO] [logging.py:96:log_dist] [Rank 0] step=10710, skipped=47, lr=[5.3141491298089856e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:47:34,898] [INFO] [timer.py:258:stop] epoch=0/micro_step=10710/global_step=10710, RunningAvgSamplesPerSec=4.493872999890766, CurrSamplesPerSec=4.4927807670647555, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:47:43,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=10720, skipped=47, lr=[5.307086809562453e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:47:43,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=10720/global_step=10720, RunningAvgSamplesPerSec=4.49386068890104, CurrSamplesPerSec=4.470063323971641, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:47:53,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=10730, skipped=47, lr=[5.3000249653100426e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:47:53,028] [INFO] [timer.py:258:stop] epoch=0/micro_step=10730/global_step=10730, RunningAvgSamplesPerSec=4.49385153123802, CurrSamplesPerSec=4.474457622015211, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:48:02,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=10740, skipped=47, lr=[5.2929636144761496e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:48:02,083] [INFO] [timer.py:258:stop] epoch=0/micro_step=10740/global_step=10740, RunningAvgSamplesPerSec=4.493841083959273, CurrSamplesPerSec=4.486215300265314, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:48:11,157] [INFO] [logging.py:96:log_dist] [Rank 0] step=10750, skipped=47, lr=[5.2859027744839585e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:48:11,157] [INFO] [timer.py:258:stop] epoch=0/micro_step=10750/global_step=10750, RunningAvgSamplesPerSec=4.493828615345491, CurrSamplesPerSec=4.48451010224669, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:48:11,158] [INFO] [RANK 0]  iteration    10750/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 5.285E-05 | total loss 3.410135E-01 | loss 3.410135E-01 | loss scale 32768.0 |speed 264.66 samples/(min*GPU)
[2024-06-17 08:48:11,159] [INFO] [RANK 0] time (ms) | forward: 356.32 | backward: 546.52 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 13.97 | data loader: 0.22
[2024-06-17 08:48:20,241] [INFO] [logging.py:96:log_dist] [Rank 0] step=10760, skipped=47, lr=[5.278842462755387e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:48:20,242] [INFO] [timer.py:258:stop] epoch=0/micro_step=10760/global_step=10760, RunningAvgSamplesPerSec=4.493819362451534, CurrSamplesPerSec=4.4812831310723045, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:48:29,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=10770, skipped=47, lr=[5.2717826967110564e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:48:29,299] [INFO] [timer.py:258:stop] epoch=0/micro_step=10770/global_step=10770, RunningAvgSamplesPerSec=4.4938048855215795, CurrSamplesPerSec=4.455666726687393, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:48:38,388] [INFO] [logging.py:96:log_dist] [Rank 0] step=10780, skipped=47, lr=[5.2647234937702335e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:48:38,389] [INFO] [timer.py:258:stop] epoch=0/micro_step=10780/global_step=10780, RunningAvgSamplesPerSec=4.493796191774069, CurrSamplesPerSec=4.479398689117927, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:48:47,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=10790, skipped=47, lr=[5.257664871350802e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:48:47,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=10790/global_step=10790, RunningAvgSamplesPerSec=4.493784817762669, CurrSamplesPerSec=4.483117646587268, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:48:56,547] [INFO] [logging.py:96:log_dist] [Rank 0] step=10800, skipped=47, lr=[5.2506068468692096e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:48:56,548] [INFO] [timer.py:258:stop] epoch=0/micro_step=10800/global_step=10800, RunningAvgSamplesPerSec=4.49377696749776, CurrSamplesPerSec=4.489225942934022, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:48:56,548] [INFO] [RANK 0]  iteration    10800/   20000 | elapsed time per iteration (ms): 907.8 | learning rate 5.250E-05 | total loss 3.671191E-01 | loss 3.671191E-01 | loss scale 32768.0 |speed 264.38 samples/(min*GPU)
[2024-06-17 08:48:56,549] [INFO] [RANK 0] time (ms) | forward: 357.14 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 14.96 | data loader: 0.20
[2024-06-17 08:48:56,549] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:48:56,561] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/10800/mp_rank_00_model_states.pt
[2024-06-17 08:48:56,561] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/10800/mp_rank_00_model_states.pt...
[2024-06-17 08:49:28,556] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/10800/mp_rank_00_model_states.pt.
[2024-06-17 08:49:37,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=10810, skipped=47, lr=[5.243549437740433e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:49:37,579] [INFO] [timer.py:258:stop] epoch=0/micro_step=10810/global_step=10810, RunningAvgSamplesPerSec=4.493811103148498, CurrSamplesPerSec=4.534582469443924, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:49:46,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=10820, skipped=47, lr=[5.236492661377924e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:49:46,558] [INFO] [timer.py:258:stop] epoch=0/micro_step=10820/global_step=10820, RunningAvgSamplesPerSec=4.4938434995141945, CurrSamplesPerSec=4.528883169707703, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:49:55,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=10830, skipped=47, lr=[5.22943653519358e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:49:55,585] [INFO] [timer.py:258:stop] epoch=0/micro_step=10830/global_step=10830, RunningAvgSamplesPerSec=4.493863081964721, CurrSamplesPerSec=4.517505546171694, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:50:04,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=10840, skipped=47, lr=[5.22238107659769e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:50:04,599] [INFO] [timer.py:258:stop] epoch=0/micro_step=10840/global_step=10840, RunningAvgSamplesPerSec=4.4938782042075305, CurrSamplesPerSec=4.492886644512721, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:50:13,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=10850, skipped=47, lr=[5.2153263029988944e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:50:13,661] [INFO] [timer.py:258:stop] epoch=0/micro_step=10850/global_step=10850, RunningAvgSamplesPerSec=4.4938778819379985, CurrSamplesPerSec=4.485901024281361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:50:13,662] [INFO] [RANK 0]  iteration    10850/   20000 | elapsed time per iteration (ms): 1542.3 | learning rate 5.215E-05 | total loss 3.489307E-01 | loss 3.489307E-01 | loss scale 32768.0 |speed 155.61 samples/(min*GPU)
[2024-06-17 08:50:13,664] [INFO] [RANK 0] time (ms) | forward: 355.04 | backward: 542.65 | allreduce: 0.00 | optimizer: 3.38 | batch generator: 15.48 | data loader: 0.09
[2024-06-17 08:50:22,748] [INFO] [logging.py:96:log_dist] [Rank 0] step=10860, skipped=47, lr=[5.208272231804148e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:50:22,748] [INFO] [timer.py:258:stop] epoch=0/micro_step=10860/global_step=10860, RunningAvgSamplesPerSec=4.493876008562869, CurrSamplesPerSec=4.497939666132079, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:50:31,804] [INFO] [logging.py:96:log_dist] [Rank 0] step=10870, skipped=47, lr=[5.20121888041867e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:50:31,805] [INFO] [timer.py:258:stop] epoch=0/micro_step=10870/global_step=10870, RunningAvgSamplesPerSec=4.493870473902893, CurrSamplesPerSec=4.496348455684858, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:50:40,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=10880, skipped=47, lr=[5.194166266245904e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:50:40,848] [INFO] [timer.py:258:stop] epoch=0/micro_step=10880/global_step=10880, RunningAvgSamplesPerSec=4.493865753783804, CurrSamplesPerSec=4.488010636049681, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:50:49,922] [INFO] [logging.py:96:log_dist] [Rank 0] step=10890, skipped=47, lr=[5.187114406687473e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:50:49,922] [INFO] [timer.py:258:stop] epoch=0/micro_step=10890/global_step=10890, RunningAvgSamplesPerSec=4.493855298782489, CurrSamplesPerSec=4.48588423214747, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:50:59,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=10900, skipped=47, lr=[5.1800633191431415e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:50:59,010] [INFO] [timer.py:258:stop] epoch=0/micro_step=10900/global_step=10900, RunningAvgSamplesPerSec=4.49384368450538, CurrSamplesPerSec=4.490100602437047, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:50:59,011] [INFO] [RANK 0]  iteration    10900/   20000 | elapsed time per iteration (ms): 907.0 | learning rate 5.179E-05 | total loss 3.768280E-01 | loss 3.768280E-01 | loss scale 32768.0 |speed 264.61 samples/(min*GPU)
[2024-06-17 08:50:59,012] [INFO] [RANK 0] time (ms) | forward: 356.57 | backward: 546.43 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.85 | data loader: 0.11
[2024-06-17 08:51:08,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=10910, skipped=47, lr=[5.173013021010765e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:51:08,076] [INFO] [timer.py:258:stop] epoch=0/micro_step=10910/global_step=10910, RunningAvgSamplesPerSec=4.493839599966733, CurrSamplesPerSec=4.488361230175568, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:51:17,137] [INFO] [logging.py:96:log_dist] [Rank 0] step=10920, skipped=47, lr=[5.165963529686257e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:51:17,138] [INFO] [timer.py:258:stop] epoch=0/micro_step=10920/global_step=10920, RunningAvgSamplesPerSec=4.493833430959789, CurrSamplesPerSec=4.4794596843138965, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:51:23,477] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 08:51:24,383] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 08:51:26,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=10930, skipped=49, lr=[5.160324529217092e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:51:26,195] [INFO] [timer.py:258:stop] epoch=0/micro_step=10930/global_step=10930, RunningAvgSamplesPerSec=4.493828696908787, CurrSamplesPerSec=4.485647956164899, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:51:35,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=10940, skipped=49, lr=[5.1532765339780524e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:51:35,277] [INFO] [timer.py:258:stop] epoch=0/micro_step=10940/global_step=10940, RunningAvgSamplesPerSec=4.493820296430363, CurrSamplesPerSec=4.489078197574158, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:51:44,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=10950, skipped=49, lr=[5.146229394244697e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:51:44,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=10950/global_step=10950, RunningAvgSamplesPerSec=4.493808840570382, CurrSamplesPerSec=4.487173994036257, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:51:44,358] [INFO] [RANK 0]  iteration    10950/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 5.146E-05 | total loss 3.399072E-01 | loss 3.399072E-01 | loss scale 32768.0 |speed 264.62 samples/(min*GPU)
[2024-06-17 08:51:44,359] [INFO] [RANK 0] time (ms) | forward: 356.42 | backward: 546.56 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.79 | data loader: 0.23
[2024-06-17 08:51:53,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=10960, skipped=49, lr=[5.139183127405145e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:51:53,433] [INFO] [timer.py:258:stop] epoch=0/micro_step=10960/global_step=10960, RunningAvgSamplesPerSec=4.493796154116724, CurrSamplesPerSec=4.476072781601836, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:52:02,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=10970, skipped=49, lr=[5.132137750845357e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:52:02,498] [INFO] [timer.py:258:stop] epoch=0/micro_step=10970/global_step=10970, RunningAvgSamplesPerSec=4.493786949093134, CurrSamplesPerSec=4.490236397451328, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:52:11,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=10980, skipped=49, lr=[5.1250932819491015e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:52:11,570] [INFO] [timer.py:258:stop] epoch=0/micro_step=10980/global_step=10980, RunningAvgSamplesPerSec=4.493774634305612, CurrSamplesPerSec=4.485133512340709, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:52:20,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=10990, skipped=49, lr=[5.118049738097904e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:52:20,658] [INFO] [timer.py:258:stop] epoch=0/micro_step=10990/global_step=10990, RunningAvgSamplesPerSec=4.493760890894668, CurrSamplesPerSec=4.471498925649394, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:52:29,747] [INFO] [logging.py:96:log_dist] [Rank 0] step=11000, skipped=49, lr=[5.11100713667101e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:52:29,747] [INFO] [timer.py:258:stop] epoch=0/micro_step=11000/global_step=11000, RunningAvgSamplesPerSec=4.493750305555821, CurrSamplesPerSec=4.494058848724646, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:52:29,749] [INFO] [RANK 0]  iteration    11000/   20000 | elapsed time per iteration (ms): 907.8 | learning rate 5.110E-05 | total loss 3.425208E-01 | loss 3.425208E-01 | loss scale 32768.0 |speed 264.37 samples/(min*GPU)
[2024-06-17 08:52:29,749] [INFO] [RANK 0] time (ms) | forward: 357.26 | backward: 546.55 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 14.58 | data loader: 0.21
[2024-06-17 08:52:36,401] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 08:52:36,401] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 08:52:36,401] [INFO] [RANK 0]  validation loss at iteration 11000 | loss: 8.383789E-01 | PPL: 2.312615E+00 loss 8.383789E-01 |
[2024-06-17 08:52:36,401] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 08:52:45,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=11010, skipped=49, lr=[5.103965495045337e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:52:45,473] [INFO] [timer.py:258:stop] epoch=0/micro_step=11010/global_step=11010, RunningAvgSamplesPerSec=4.49374077824923, CurrSamplesPerSec=4.495116041733817, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:52:54,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=11020, skipped=49, lr=[5.0969248305954383e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:52:54,566] [INFO] [timer.py:258:stop] epoch=0/micro_step=11020/global_step=11020, RunningAvgSamplesPerSec=4.49373183961522, CurrSamplesPerSec=4.488507727507186, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:53:03,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=11030, skipped=49, lr=[5.089885160693448e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:53:03,665] [INFO] [timer.py:258:stop] epoch=0/micro_step=11030/global_step=11030, RunningAvgSamplesPerSec=4.493720079947573, CurrSamplesPerSec=4.486846384253316, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:53:12,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=11040, skipped=49, lr=[5.082846502709059e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:53:12,764] [INFO] [timer.py:258:stop] epoch=0/micro_step=11040/global_step=11040, RunningAvgSamplesPerSec=4.493706784727451, CurrSamplesPerSec=4.4827690688908595, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:53:21,850] [INFO] [logging.py:96:log_dist] [Rank 0] step=11050, skipped=49, lr=[5.075808874009453e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:53:21,851] [INFO] [timer.py:258:stop] epoch=0/micro_step=11050/global_step=11050, RunningAvgSamplesPerSec=4.493695047150224, CurrSamplesPerSec=4.48705398490035, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:53:21,853] [INFO] [RANK 0]  iteration    11050/   20000 | elapsed time per iteration (ms): 1042.1 | learning rate 5.075E-05 | total loss 3.345410E-01 | loss 3.345410E-01 | loss scale 32768.0 |speed 230.31 samples/(min*GPU)
[2024-06-17 08:53:21,853] [INFO] [RANK 0] time (ms) | forward: 358.22 | backward: 546.73 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 19.30 | data loader: 0.24
[2024-06-17 08:53:30,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=11060, skipped=49, lr=[5.068772291959286e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:53:30,917] [INFO] [timer.py:258:stop] epoch=0/micro_step=11060/global_step=11060, RunningAvgSamplesPerSec=4.4936882731932, CurrSamplesPerSec=4.4841013831659, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:53:39,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=11070, skipped=49, lr=[5.06173677392062e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:53:39,980] [INFO] [timer.py:258:stop] epoch=0/micro_step=11070/global_step=11070, RunningAvgSamplesPerSec=4.4936777704010895, CurrSamplesPerSec=4.467793262898433, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:53:49,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=11080, skipped=49, lr=[5.054702337252898e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:53:49,041] [INFO] [timer.py:258:stop] epoch=0/micro_step=11080/global_step=11080, RunningAvgSamplesPerSec=4.493669443277522, CurrSamplesPerSec=4.4650299270519795, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:53:58,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=11090, skipped=49, lr=[5.047668999312892e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:53:58,141] [INFO] [timer.py:258:stop] epoch=0/micro_step=11090/global_step=11090, RunningAvgSamplesPerSec=4.493659138129698, CurrSamplesPerSec=4.489489025819916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:54:07,303] [INFO] [logging.py:96:log_dist] [Rank 0] step=11100, skipped=49, lr=[5.0406367774546675e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:54:07,303] [INFO] [timer.py:258:stop] epoch=0/micro_step=11100/global_step=11100, RunningAvgSamplesPerSec=4.493620008151584, CurrSamplesPerSec=4.227580341765119, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:54:07,305] [INFO] [RANK 0]  iteration    11100/   20000 | elapsed time per iteration (ms): 909.0 | learning rate 5.040E-05 | total loss 3.101129E-01 | loss 3.101129E-01 | loss scale 32768.0 |speed 264.02 samples/(min*GPU)
[2024-06-17 08:54:07,305] [INFO] [RANK 0] time (ms) | forward: 357.08 | backward: 547.86 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 14.94 | data loader: 0.16
[2024-06-17 08:54:07,305] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:54:07,318] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/11100/mp_rank_00_model_states.pt
[2024-06-17 08:54:07,318] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/11100/mp_rank_00_model_states.pt...
[2024-06-17 08:54:39,517] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/11100/mp_rank_00_model_states.pt.
[2024-06-17 08:54:48,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=11110, skipped=49, lr=[5.0336056890295284e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:54:48,525] [INFO] [timer.py:258:stop] epoch=0/micro_step=11110/global_step=11110, RunningAvgSamplesPerSec=4.493656827956137, CurrSamplesPerSec=4.543725584932478, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:54:57,529] [INFO] [logging.py:96:log_dist] [Rank 0] step=11120, skipped=49, lr=[5.026575751385991e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:54:57,530] [INFO] [timer.py:258:stop] epoch=0/micro_step=11120/global_step=11120, RunningAvgSamplesPerSec=4.49368868237224, CurrSamplesPerSec=4.522124079859193, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:55:06,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=11130, skipped=49, lr=[5.0195469818697235e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:55:06,532] [INFO] [timer.py:258:stop] epoch=0/micro_step=11130/global_step=11130, RunningAvgSamplesPerSec=4.493711012254971, CurrSamplesPerSec=4.516208016926477, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:55:15,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=11140, skipped=49, lr=[5.0125193978235186e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:55:15,547] [INFO] [timer.py:258:stop] epoch=0/micro_step=11140/global_step=11140, RunningAvgSamplesPerSec=4.493733204679034, CurrSamplesPerSec=4.5175408221349915, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:55:24,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=11150, skipped=49, lr=[5.005493016587241e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:55:24,589] [INFO] [timer.py:258:stop] epoch=0/micro_step=11150/global_step=11150, RunningAvgSamplesPerSec=4.49374565407336, CurrSamplesPerSec=4.496327970166014, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:55:24,590] [INFO] [RANK 0]  iteration    11150/   20000 | elapsed time per iteration (ms): 1545.7 | learning rate 5.005E-05 | total loss 3.339032E-01 | loss 3.339032E-01 | loss scale 32768.0 |speed 155.27 samples/(min*GPU)
[2024-06-17 08:55:24,591] [INFO] [RANK 0] time (ms) | forward: 354.78 | backward: 542.42 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 16.00 | data loader: 0.10
[2024-06-17 08:55:33,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=11160, skipped=49, lr=[4.9984678554977867e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:55:33,644] [INFO] [timer.py:258:stop] epoch=0/micro_step=11160/global_step=11160, RunningAvgSamplesPerSec=4.4937459103653, CurrSamplesPerSec=4.4907736493992125, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:55:42,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=11170, skipped=49, lr=[4.991443931889043e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:55:42,691] [INFO] [timer.py:258:stop] epoch=0/micro_step=11170/global_step=11170, RunningAvgSamplesPerSec=4.4937431275658195, CurrSamplesPerSec=4.494867954069723, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:55:51,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=11180, skipped=49, lr=[4.984421263091844e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:55:51,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=11180/global_step=11180, RunningAvgSamplesPerSec=4.493738891987873, CurrSamplesPerSec=4.49162365941739, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:56:00,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=11190, skipped=49, lr=[4.977399866433926e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:56:00,808] [INFO] [timer.py:258:stop] epoch=0/micro_step=11190/global_step=11190, RunningAvgSamplesPerSec=4.493735526265156, CurrSamplesPerSec=4.482548690346894, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:56:09,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=11200, skipped=49, lr=[4.970379759239889e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:56:09,853] [INFO] [timer.py:258:stop] epoch=0/micro_step=11200/global_step=11200, RunningAvgSamplesPerSec=4.493733014090142, CurrSamplesPerSec=4.487319213674098, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:56:09,854] [INFO] [RANK 0]  iteration    11200/   20000 | elapsed time per iteration (ms): 905.3 | learning rate 4.970E-05 | total loss 3.443411E-01 | loss 3.443411E-01 | loss scale 32768.0 |speed 265.11 samples/(min*GPU)
[2024-06-17 08:56:09,855] [INFO] [RANK 0] time (ms) | forward: 355.02 | backward: 546.31 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.04 | data loader: 0.11
[2024-06-17 08:56:18,898] [INFO] [logging.py:96:log_dist] [Rank 0] step=11210, skipped=49, lr=[4.9633609588311446e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:56:18,899] [INFO] [timer.py:258:stop] epoch=0/micro_step=11210/global_step=11210, RunningAvgSamplesPerSec=4.493728451591087, CurrSamplesPerSec=4.4921949218528265, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:56:27,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=11220, skipped=49, lr=[4.956343482525892e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:56:27,949] [INFO] [timer.py:258:stop] epoch=0/micro_step=11220/global_step=11220, RunningAvgSamplesPerSec=4.493721729887773, CurrSamplesPerSec=4.486316069827005, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:56:36,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=11230, skipped=49, lr=[4.949327347639049e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:56:36,999] [INFO] [timer.py:258:stop] epoch=0/micro_step=11230/global_step=11230, RunningAvgSamplesPerSec=4.493716666425765, CurrSamplesPerSec=4.487783739596872, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:56:46,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=11240, skipped=49, lr=[4.942312571482239e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:56:46,068] [INFO] [timer.py:258:stop] epoch=0/micro_step=11240/global_step=11240, RunningAvgSamplesPerSec=4.4937081670224055, CurrSamplesPerSec=4.489217534400525, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:56:55,129] [INFO] [logging.py:96:log_dist] [Rank 0] step=11250, skipped=49, lr=[4.9352991713637186e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:56:55,129] [INFO] [timer.py:258:stop] epoch=0/micro_step=11250/global_step=11250, RunningAvgSamplesPerSec=4.49370252690927, CurrSamplesPerSec=4.485504043906415, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:56:55,131] [INFO] [RANK 0]  iteration    11250/   20000 | elapsed time per iteration (ms): 905.5 | learning rate 4.935E-05 | total loss 3.265210E-01 | loss 3.265210E-01 | loss scale 32768.0 |speed 265.04 samples/(min*GPU)
[2024-06-17 08:56:55,131] [INFO] [RANK 0] time (ms) | forward: 354.81 | backward: 546.78 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 13.48 | data loader: 0.09
[2024-06-17 08:57:04,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=11260, skipped=49, lr=[4.9282871645883584e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:57:04,232] [INFO] [timer.py:258:stop] epoch=0/micro_step=11260/global_step=11260, RunningAvgSamplesPerSec=4.493686006052768, CurrSamplesPerSec=4.47994650942774, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:57:13,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=11270, skipped=49, lr=[4.921276568457586e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:57:13,327] [INFO] [timer.py:258:stop] epoch=0/micro_step=11270/global_step=11270, RunningAvgSamplesPerSec=4.493674578784008, CurrSamplesPerSec=4.458032273219096, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:57:22,391] [INFO] [logging.py:96:log_dist] [Rank 0] step=11280, skipped=49, lr=[4.9142674002693526e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:57:22,392] [INFO] [timer.py:258:stop] epoch=0/micro_step=11280/global_step=11280, RunningAvgSamplesPerSec=4.493661291631764, CurrSamplesPerSec=4.471214114751246, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:57:31,458] [INFO] [logging.py:96:log_dist] [Rank 0] step=11290, skipped=49, lr=[4.907259677318083e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:57:31,459] [INFO] [timer.py:258:stop] epoch=0/micro_step=11290/global_step=11290, RunningAvgSamplesPerSec=4.493648163194525, CurrSamplesPerSec=4.478384737865581, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:57:40,519] [INFO] [logging.py:96:log_dist] [Rank 0] step=11300, skipped=49, lr=[4.9002534168946376e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:57:40,519] [INFO] [timer.py:258:stop] epoch=0/micro_step=11300/global_step=11300, RunningAvgSamplesPerSec=4.493640838109067, CurrSamplesPerSec=4.481308267676259, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:57:40,521] [INFO] [RANK 0]  iteration    11300/   20000 | elapsed time per iteration (ms): 907.8 | learning rate 4.900E-05 | total loss 3.961285E-01 | loss 3.961285E-01 | loss scale 32768.0 |speed 264.37 samples/(min*GPU)
[2024-06-17 08:57:40,522] [INFO] [RANK 0] time (ms) | forward: 356.92 | backward: 546.83 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 14.35 | data loader: 0.10
[2024-06-17 08:57:49,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=11310, skipped=49, lr=[4.893248636286267e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:57:49,590] [INFO] [timer.py:258:stop] epoch=0/micro_step=11310/global_step=11310, RunningAvgSamplesPerSec=4.493631943934993, CurrSamplesPerSec=4.488122291933121, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:57:58,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=11320, skipped=49, lr=[4.88624535277657e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:57:58,640] [INFO] [timer.py:258:stop] epoch=0/micro_step=11320/global_step=11320, RunningAvgSamplesPerSec=4.4936211684836955, CurrSamplesPerSec=4.470281285437787, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:58:06,785] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 08:58:07,687] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 08:58:07,687] [INFO] [logging.py:96:log_dist] [Rank 0] step=11330, skipped=51, lr=[4.8799436919191295e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:58:07,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=11330/global_step=11330, RunningAvgSamplesPerSec=4.493611227981175, CurrSamplesPerSec=4.4753623497683925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:58:16,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=11340, skipped=51, lr=[4.873643270302852e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:58:16,733] [INFO] [timer.py:258:stop] epoch=0/micro_step=11340/global_step=11340, RunningAvgSamplesPerSec=4.493603363791734, CurrSamplesPerSec=4.485183872259587, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:58:25,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=11350, skipped=51, lr=[4.866644270586589e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:58:25,797] [INFO] [timer.py:258:stop] epoch=0/micro_step=11350/global_step=11350, RunningAvgSamplesPerSec=4.493595015223282, CurrSamplesPerSec=4.475640525620224, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:58:25,799] [INFO] [RANK 0]  iteration    11350/   20000 | elapsed time per iteration (ms): 905.6 | learning rate 4.866E-05 | total loss 3.686447E-01 | loss 3.686447E-01 | loss scale 32768.0 |speed 265.03 samples/(min*GPU)
[2024-06-17 08:58:25,799] [INFO] [RANK 0] time (ms) | forward: 355.15 | backward: 546.50 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 12.75 | data loader: 0.11
[2024-06-17 08:58:34,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=11360, skipped=51, lr=[4.859646833612629e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:58:34,881] [INFO] [timer.py:258:stop] epoch=0/micro_step=11360/global_step=11360, RunningAvgSamplesPerSec=4.493588291426909, CurrSamplesPerSec=4.4688417040352775, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:58:43,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=11370, skipped=51, lr=[4.85265097664645e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:58:43,935] [INFO] [timer.py:258:stop] epoch=0/micro_step=11370/global_step=11370, RunningAvgSamplesPerSec=4.4935810842105735, CurrSamplesPerSec=4.477821762728946, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:58:53,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=11380, skipped=51, lr=[4.845656716949638e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:58:53,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=11380/global_step=11380, RunningAvgSamplesPerSec=4.493569470682167, CurrSamplesPerSec=4.4831008752849835, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:59:02,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=11390, skipped=51, lr=[4.838664071779827e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:59:02,061] [INFO] [timer.py:258:stop] epoch=0/micro_step=11390/global_step=11390, RunningAvgSamplesPerSec=4.4935615113797835, CurrSamplesPerSec=4.484799007299567, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:59:11,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=11400, skipped=51, lr=[4.83167305839068e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:59:11,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=11400/global_step=11400, RunningAvgSamplesPerSec=4.493552046602309, CurrSamplesPerSec=4.49374949108815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 08:59:11,124] [INFO] [RANK 0]  iteration    11400/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 4.831E-05 | total loss 3.122986E-01 | loss 3.122986E-01 | loss scale 32768.0 |speed 264.75 samples/(min*GPU)
[2024-06-17 08:59:11,125] [INFO] [RANK 0] time (ms) | forward: 355.94 | backward: 546.60 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 13.93 | data loader: 0.10
[2024-06-17 08:59:11,125] [INFO] [RANK 0] Saving Model...
[2024-06-17 08:59:11,137] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/11400/mp_rank_00_model_states.pt
[2024-06-17 08:59:11,137] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/11400/mp_rank_00_model_states.pt...
[2024-06-17 08:59:44,148] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/11400/mp_rank_00_model_states.pt.
[2024-06-17 08:59:53,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=11410, skipped=51, lr=[4.824683694031823e-05], mom=[[0.9, 0.95]]
[2024-06-17 08:59:53,134] [INFO] [timer.py:258:stop] epoch=0/micro_step=11410/global_step=11410, RunningAvgSamplesPerSec=4.493585447177272, CurrSamplesPerSec=4.527700062151511, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:00:02,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=11420, skipped=51, lr=[4.817695995948821e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:00:02,113] [INFO] [timer.py:258:stop] epoch=0/micro_step=11420/global_step=11420, RunningAvgSamplesPerSec=4.493616567275391, CurrSamplesPerSec=4.525242935012608, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:00:11,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=11430, skipped=51, lr=[4.810709981383123e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:00:11,090] [INFO] [timer.py:258:stop] epoch=0/micro_step=11430/global_step=11430, RunningAvgSamplesPerSec=4.493638613499125, CurrSamplesPerSec=4.521441603626378, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:00:20,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=11440, skipped=51, lr=[4.8037256675720264e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:00:20,085] [INFO] [timer.py:258:stop] epoch=0/micro_step=11440/global_step=11440, RunningAvgSamplesPerSec=4.493656322206044, CurrSamplesPerSec=4.508379103124384, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:00:29,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=11450, skipped=51, lr=[4.796743071748629e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:00:29,103] [INFO] [timer.py:258:stop] epoch=0/micro_step=11450/global_step=11450, RunningAvgSamplesPerSec=4.493666732248746, CurrSamplesPerSec=4.504648371036265, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:00:29,104] [INFO] [RANK 0]  iteration    11450/   20000 | elapsed time per iteration (ms): 1559.6 | learning rate 4.796E-05 | total loss 3.632608E-01 | loss 3.632608E-01 | loss scale 32768.0 |speed 153.88 samples/(min*GPU)
[2024-06-17 09:00:29,105] [INFO] [RANK 0] time (ms) | forward: 352.49 | backward: 542.30 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 13.29 | data loader: 0.10
[2024-06-17 09:00:38,178] [INFO] [logging.py:96:log_dist] [Rank 0] step=11460, skipped=51, lr=[4.789762211141794e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:00:38,178] [INFO] [timer.py:258:stop] epoch=0/micro_step=11460/global_step=11460, RunningAvgSamplesPerSec=4.493662963109009, CurrSamplesPerSec=4.498490824961168, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:00:47,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=11470, skipped=51, lr=[4.782783102976101e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:00:47,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=11470/global_step=11470, RunningAvgSamplesPerSec=4.493658389161457, CurrSamplesPerSec=4.488285583658217, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:00:56,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=11480, skipped=51, lr=[4.775805764471805e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:00:56,306] [INFO] [timer.py:258:stop] epoch=0/micro_step=11480/global_step=11480, RunningAvgSamplesPerSec=4.493655721383882, CurrSamplesPerSec=4.488434477646001, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:01:05,360] [INFO] [logging.py:96:log_dist] [Rank 0] step=11490, skipped=51, lr=[4.768830212844793e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:01:05,361] [INFO] [timer.py:258:stop] epoch=0/micro_step=11490/global_step=11490, RunningAvgSamplesPerSec=4.493644868334465, CurrSamplesPerSec=4.467794452677593, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:01:14,434] [INFO] [logging.py:96:log_dist] [Rank 0] step=11500, skipped=51, lr=[4.7618564653065506e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:01:14,435] [INFO] [timer.py:258:stop] epoch=0/micro_step=11500/global_step=11500, RunningAvgSamplesPerSec=4.493638748474787, CurrSamplesPerSec=4.486298074930401, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:01:14,436] [INFO] [RANK 0]  iteration    11500/   20000 | elapsed time per iteration (ms): 906.6 | learning rate 4.761E-05 | total loss 2.921594E-01 | loss 2.921594E-01 | loss scale 32768.0 |speed 264.71 samples/(min*GPU)
[2024-06-17 09:01:14,437] [INFO] [RANK 0] time (ms) | forward: 356.40 | backward: 546.16 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 14.56 | data loader: 0.10
[2024-06-17 09:01:23,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=11510, skipped=51, lr=[4.7548845390641e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:01:23,496] [INFO] [timer.py:258:stop] epoch=0/micro_step=11510/global_step=11510, RunningAvgSamplesPerSec=4.493628559354237, CurrSamplesPerSec=4.469684621813389, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:01:32,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=11520, skipped=51, lr=[4.7479144513199825e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:01:32,556] [INFO] [timer.py:258:stop] epoch=0/micro_step=11520/global_step=11520, RunningAvgSamplesPerSec=4.493622308000197, CurrSamplesPerSec=4.486781587985197, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:01:41,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=11530, skipped=51, lr=[4.740946219272193e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:01:41,632] [INFO] [timer.py:258:stop] epoch=0/micro_step=11530/global_step=11530, RunningAvgSamplesPerSec=4.493608894115147, CurrSamplesPerSec=4.478947854580364, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:01:50,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=11540, skipped=51, lr=[4.7339798601141503e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:01:50,692] [INFO] [timer.py:258:stop] epoch=0/micro_step=11540/global_step=11540, RunningAvgSamplesPerSec=4.493603717477929, CurrSamplesPerSec=4.49070873965199, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:01:59,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=11550, skipped=51, lr=[4.727015391034657e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:01:59,772] [INFO] [timer.py:258:stop] epoch=0/micro_step=11550/global_step=11550, RunningAvgSamplesPerSec=4.49359425533023, CurrSamplesPerSec=4.490889049138693, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:01:59,772] [INFO] [RANK 0]  iteration    11550/   20000 | elapsed time per iteration (ms): 906.7 | learning rate 4.726E-05 | total loss 3.569727E-01 | loss 3.569727E-01 | loss scale 32768.0 |speed 264.69 samples/(min*GPU)
[2024-06-17 09:01:59,774] [INFO] [RANK 0] time (ms) | forward: 356.09 | backward: 546.58 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 13.98 | data loader: 0.10
[2024-06-17 09:02:08,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=11560, skipped=51, lr=[4.720052829217846e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:02:08,862] [INFO] [timer.py:258:stop] epoch=0/micro_step=11560/global_step=11560, RunningAvgSamplesPerSec=4.493582703635439, CurrSamplesPerSec=4.481396846528358, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:02:17,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=11570, skipped=51, lr=[4.713092191843145e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:02:17,934] [INFO] [timer.py:258:stop] epoch=0/micro_step=11570/global_step=11570, RunningAvgSamplesPerSec=4.493577539714232, CurrSamplesPerSec=4.488005833770706, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:02:27,005] [INFO] [logging.py:96:log_dist] [Rank 0] step=11580, skipped=51, lr=[4.7061334960852385e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:02:27,005] [INFO] [timer.py:258:stop] epoch=0/micro_step=11580/global_step=11580, RunningAvgSamplesPerSec=4.493567624071159, CurrSamplesPerSec=4.487185995302918, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:02:36,092] [INFO] [logging.py:96:log_dist] [Rank 0] step=11590, skipped=51, lr=[4.699176759114014e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:02:36,093] [INFO] [timer.py:258:stop] epoch=0/micro_step=11590/global_step=11590, RunningAvgSamplesPerSec=4.493555294201978, CurrSamplesPerSec=4.481782325009851, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:02:45,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=11600, skipped=51, lr=[4.692221998094527e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:02:45,157] [INFO] [timer.py:258:stop] epoch=0/micro_step=11600/global_step=11600, RunningAvgSamplesPerSec=4.493546508369502, CurrSamplesPerSec=4.492209355627814, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:02:45,158] [INFO] [RANK 0]  iteration    11600/   20000 | elapsed time per iteration (ms): 907.7 | learning rate 4.692E-05 | total loss 3.563016E-01 | loss 3.563016E-01 | loss scale 32768.0 |speed 264.40 samples/(min*GPU)
[2024-06-17 09:02:45,159] [INFO] [RANK 0] time (ms) | forward: 356.96 | backward: 546.67 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 14.70 | data loader: 0.10
[2024-06-17 09:02:54,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=11610, skipped=51, lr=[4.685269230186965e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:02:54,229] [INFO] [timer.py:258:stop] epoch=0/micro_step=11610/global_step=11610, RunningAvgSamplesPerSec=4.4935396373543, CurrSamplesPerSec=4.489207924686526, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:03:03,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=11620, skipped=51, lr=[4.678318472546583e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:03:03,287] [INFO] [timer.py:258:stop] epoch=0/micro_step=11620/global_step=11620, RunningAvgSamplesPerSec=4.493531217892074, CurrSamplesPerSec=4.47653617630767, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:03:12,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=11630, skipped=51, lr=[4.671369742323691e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:03:12,364] [INFO] [timer.py:258:stop] epoch=0/micro_step=11630/global_step=11630, RunningAvgSamplesPerSec=4.493515658788358, CurrSamplesPerSec=4.456457330707536, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:03:21,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=11640, skipped=51, lr=[4.6644230566635875e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:03:21,439] [INFO] [timer.py:258:stop] epoch=0/micro_step=11640/global_step=11640, RunningAvgSamplesPerSec=4.493504664463977, CurrSamplesPerSec=4.483726290167144, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:03:30,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=11650, skipped=51, lr=[4.6574784327065296e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:03:30,502] [INFO] [timer.py:258:stop] epoch=0/micro_step=11650/global_step=11650, RunningAvgSamplesPerSec=4.493494209302249, CurrSamplesPerSec=4.470152649870882, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:03:30,504] [INFO] [RANK 0]  iteration    11650/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 4.657E-05 | total loss 3.745004E-01 | loss 3.745004E-01 | loss scale 32768.0 |speed 264.63 samples/(min*GPU)
[2024-06-17 09:03:30,504] [INFO] [RANK 0] time (ms) | forward: 356.15 | backward: 546.75 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 13.80 | data loader: 0.10
[2024-06-17 09:03:39,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=11660, skipped=51, lr=[4.650535887587687e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:03:39,560] [INFO] [timer.py:258:stop] epoch=0/micro_step=11660/global_step=11660, RunningAvgSamplesPerSec=4.493484899233702, CurrSamplesPerSec=4.48862421171843, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:03:48,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=11670, skipped=51, lr=[4.6435954384370997e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:03:48,633] [INFO] [timer.py:258:stop] epoch=0/micro_step=11670/global_step=11670, RunningAvgSamplesPerSec=4.493473006836061, CurrSamplesPerSec=4.4863904502644685, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:03:57,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=11680, skipped=51, lr=[4.636657102379634e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:03:57,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=11680/global_step=11680, RunningAvgSamplesPerSec=4.493459701152681, CurrSamplesPerSec=4.486041363458793, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:04:06,745] [INFO] [logging.py:96:log_dist] [Rank 0] step=11690, skipped=51, lr=[4.629720896534946e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:04:06,745] [INFO] [timer.py:258:stop] epoch=0/micro_step=11690/global_step=11690, RunningAvgSamplesPerSec=4.493451260458255, CurrSamplesPerSec=4.4849464711140765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:04:15,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=11700, skipped=51, lr=[4.622786838017433e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:04:15,806] [INFO] [timer.py:258:stop] epoch=0/micro_step=11700/global_step=11700, RunningAvgSamplesPerSec=4.493436648735207, CurrSamplesPerSec=4.476944712032385, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:04:15,807] [INFO] [RANK 0]  iteration    11700/   20000 | elapsed time per iteration (ms): 906.1 | learning rate 4.622E-05 | total loss 2.986768E-01 | loss 2.986768E-01 | loss scale 32768.0 |speed 264.88 samples/(min*GPU)
[2024-06-17 09:04:15,808] [INFO] [RANK 0] time (ms) | forward: 355.34 | backward: 546.69 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 12.65 | data loader: 0.11
[2024-06-17 09:04:15,808] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:04:15,821] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/11700/mp_rank_00_model_states.pt
[2024-06-17 09:04:15,821] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/11700/mp_rank_00_model_states.pt...
[2024-06-17 09:04:47,364] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/11700/mp_rank_00_model_states.pt.
[2024-06-17 09:04:56,373] [INFO] [logging.py:96:log_dist] [Rank 0] step=11710, skipped=51, lr=[4.6158549439361976e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:04:56,373] [INFO] [timer.py:258:stop] epoch=0/micro_step=11710/global_step=11710, RunningAvgSamplesPerSec=4.4934694566728774, CurrSamplesPerSec=4.543751426928659, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:05:05,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=11720, skipped=51, lr=[4.608925231394997e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:05:05,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=11720/global_step=11720, RunningAvgSamplesPerSec=4.493496737633538, CurrSamplesPerSec=4.525791038849492, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:05:14,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=11730, skipped=51, lr=[4.60199771749221e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:05:14,365] [INFO] [timer.py:258:stop] epoch=0/micro_step=11730/global_step=11730, RunningAvgSamplesPerSec=4.493510940880582, CurrSamplesPerSec=4.513870212499199, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:05:15,264] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:05:16,163] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:05:23,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=11740, skipped=53, lr=[4.596457300876284e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:05:23,376] [INFO] [timer.py:258:stop] epoch=0/micro_step=11740/global_step=11740, RunningAvgSamplesPerSec=4.49352763677393, CurrSamplesPerSec=4.512889153335116, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:05:32,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=11750, skipped=53, lr=[4.5895337875932047e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:05:32,404] [INFO] [timer.py:258:stop] epoch=0/micro_step=11750/global_step=11750, RunningAvgSamplesPerSec=4.493538144514125, CurrSamplesPerSec=4.501823567924953, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:05:32,405] [INFO] [RANK 0]  iteration    11750/   20000 | elapsed time per iteration (ms): 1532.0 | learning rate 4.589E-05 | total loss 2.818033E-01 | loss 2.818033E-01 | loss scale 32768.0 |speed 156.66 samples/(min*GPU)
[2024-06-17 09:05:32,406] [INFO] [RANK 0] time (ms) | forward: 354.05 | backward: 542.35 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.35 | data loader: 0.11
[2024-06-17 09:05:41,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=11760, skipped=53, lr=[4.582612520794997e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:05:41,458] [INFO] [timer.py:258:stop] epoch=0/micro_step=11760/global_step=11760, RunningAvgSamplesPerSec=4.493536525406674, CurrSamplesPerSec=4.4927422674117965, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:05:50,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=11770, skipped=53, lr=[4.575693517559201e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:05:50,514] [INFO] [timer.py:258:stop] epoch=0/micro_step=11770/global_step=11770, RunningAvgSamplesPerSec=4.4935296526213575, CurrSamplesPerSec=4.4674101869593885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:05:59,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=11780, skipped=53, lr=[4.5687767949577666e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:05:59,558] [INFO] [timer.py:258:stop] epoch=0/micro_step=11780/global_step=11780, RunningAvgSamplesPerSec=4.493527339022027, CurrSamplesPerSec=4.492715799283135, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:06:08,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=11790, skipped=53, lr=[4.5618623700570204e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:06:08,620] [INFO] [timer.py:258:stop] epoch=0/micro_step=11790/global_step=11790, RunningAvgSamplesPerSec=4.4935161693631755, CurrSamplesPerSec=4.471564473042093, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:06:17,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=11800, skipped=53, lr=[4.5549502599176186e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:06:17,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=11800/global_step=11800, RunningAvgSamplesPerSec=4.493511091758081, CurrSamplesPerSec=4.491678975320313, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:06:17,674] [INFO] [RANK 0]  iteration    11800/   20000 | elapsed time per iteration (ms): 905.4 | learning rate 4.554E-05 | total loss 3.387518E-01 | loss 3.387518E-01 | loss scale 32768.0 |speed 265.09 samples/(min*GPU)
[2024-06-17 09:06:17,674] [INFO] [RANK 0] time (ms) | forward: 355.16 | backward: 546.17 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 13.35 | data loader: 0.10
[2024-06-17 09:06:26,750] [INFO] [logging.py:96:log_dist] [Rank 0] step=11810, skipped=53, lr=[4.548040481594507e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:06:26,751] [INFO] [timer.py:258:stop] epoch=0/micro_step=11810/global_step=11810, RunningAvgSamplesPerSec=4.49350480824437, CurrSamplesPerSec=4.486765989163117, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:06:35,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=11820, skipped=53, lr=[4.541133052136874e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:06:35,846] [INFO] [timer.py:258:stop] epoch=0/micro_step=11820/global_step=11820, RunningAvgSamplesPerSec=4.4934953498230294, CurrSamplesPerSec=4.484206851925255, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:06:44,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=11830, skipped=53, lr=[4.534227988588118e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:06:44,928] [INFO] [timer.py:258:stop] epoch=0/micro_step=11830/global_step=11830, RunningAvgSamplesPerSec=4.4934817785144, CurrSamplesPerSec=4.472840050238489, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:06:53,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=11840, skipped=53, lr=[4.527325307985795e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:06:53,991] [INFO] [timer.py:258:stop] epoch=0/micro_step=11840/global_step=11840, RunningAvgSamplesPerSec=4.4934693340786325, CurrSamplesPerSec=4.4825019824603025, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:07:03,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=11850, skipped=53, lr=[4.520425027361585e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:07:03,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=11850/global_step=11850, RunningAvgSamplesPerSec=4.493458802899241, CurrSamplesPerSec=4.488381643164743, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:07:03,058] [INFO] [RANK 0]  iteration    11850/   20000 | elapsed time per iteration (ms): 907.7 | learning rate 4.520E-05 | total loss 3.259088E-01 | loss 3.259088E-01 | loss scale 32768.0 |speed 264.41 samples/(min*GPU)
[2024-06-17 09:07:03,059] [INFO] [RANK 0] time (ms) | forward: 356.87 | backward: 546.73 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 14.43 | data loader: 0.12
[2024-06-17 09:07:12,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=11860, skipped=53, lr=[4.5135271637412414e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:07:12,128] [INFO] [timer.py:258:stop] epoch=0/micro_step=11860/global_step=11860, RunningAvgSamplesPerSec=4.493449488547952, CurrSamplesPerSec=4.48873589813427, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:07:21,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=11870, skipped=53, lr=[4.50663173414456e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:07:21,210] [INFO] [timer.py:258:stop] epoch=0/micro_step=11870/global_step=11870, RunningAvgSamplesPerSec=4.493440125438014, CurrSamplesPerSec=4.479963257137288, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:07:30,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=11880, skipped=53, lr=[4.499738755585326e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:07:30,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=11880/global_step=11880, RunningAvgSamplesPerSec=4.4934258471220785, CurrSamplesPerSec=4.476746407602019, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:07:39,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=11890, skipped=53, lr=[4.492848245071281e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:07:39,342] [INFO] [timer.py:258:stop] epoch=0/micro_step=11890/global_step=11890, RunningAvgSamplesPerSec=4.493412912394227, CurrSamplesPerSec=4.458744322994222, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:07:48,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=11900, skipped=53, lr=[4.485960219604072e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:07:48,413] [INFO] [timer.py:258:stop] epoch=0/micro_step=11900/global_step=11900, RunningAvgSamplesPerSec=4.4934046662438885, CurrSamplesPerSec=4.4824397067923165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:07:48,414] [INFO] [RANK 0]  iteration    11900/   20000 | elapsed time per iteration (ms): 907.1 | learning rate 4.485E-05 | total loss 3.639368E-01 | loss 3.639368E-01 | loss scale 32768.0 |speed 264.57 samples/(min*GPU)
[2024-06-17 09:07:48,415] [INFO] [RANK 0] time (ms) | forward: 356.23 | backward: 546.88 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 13.82 | data loader: 0.12
[2024-06-17 09:07:57,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=11910, skipped=53, lr=[4.47907469617922e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:07:57,486] [INFO] [timer.py:258:stop] epoch=0/micro_step=11910/global_step=11910, RunningAvgSamplesPerSec=4.493393414930512, CurrSamplesPerSec=4.479844829593457, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:08:06,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=11920, skipped=53, lr=[4.472191691786065e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:08:06,560] [INFO] [timer.py:258:stop] epoch=0/micro_step=11920/global_step=11920, RunningAvgSamplesPerSec=4.493381662824822, CurrSamplesPerSec=4.463206619836899, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:08:15,639] [INFO] [logging.py:96:log_dist] [Rank 0] step=11930, skipped=53, lr=[4.465311223407742e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:08:15,640] [INFO] [timer.py:258:stop] epoch=0/micro_step=11930/global_step=11930, RunningAvgSamplesPerSec=4.493378905554992, CurrSamplesPerSec=4.492008493928758, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:08:24,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=11940, skipped=53, lr=[4.4584333080211184e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:08:24,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=11940/global_step=11940, RunningAvgSamplesPerSec=4.493372530584556, CurrSamplesPerSec=4.492974478455317, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:08:33,752] [INFO] [logging.py:96:log_dist] [Rank 0] step=11950, skipped=53, lr=[4.451557962596769e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:08:33,753] [INFO] [timer.py:258:stop] epoch=0/micro_step=11950/global_step=11950, RunningAvgSamplesPerSec=4.493365172973671, CurrSamplesPerSec=4.483441117679127, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:08:33,754] [INFO] [RANK 0]  iteration    11950/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 4.451E-05 | total loss 3.055136E-01 | loss 3.055136E-01 | loss scale 32768.0 |speed 264.67 samples/(min*GPU)
[2024-06-17 09:08:33,755] [INFO] [RANK 0] time (ms) | forward: 356.18 | backward: 546.61 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 14.21 | data loader: 0.10
[2024-06-17 09:08:42,814] [INFO] [logging.py:96:log_dist] [Rank 0] step=11960, skipped=53, lr=[4.444685204098924e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:08:42,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=11960/global_step=11960, RunningAvgSamplesPerSec=4.493358472080109, CurrSamplesPerSec=4.465375751328324, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:08:51,879] [INFO] [logging.py:96:log_dist] [Rank 0] step=11970, skipped=53, lr=[4.437815049485432e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:08:51,880] [INFO] [timer.py:258:stop] epoch=0/micro_step=11970/global_step=11970, RunningAvgSamplesPerSec=4.493348887456615, CurrSamplesPerSec=4.489323243969916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:09:00,956] [INFO] [logging.py:96:log_dist] [Rank 0] step=11980, skipped=53, lr=[4.430947515707717e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:09:00,957] [INFO] [timer.py:258:stop] epoch=0/micro_step=11980/global_step=11980, RunningAvgSamplesPerSec=4.493341017315107, CurrSamplesPerSec=4.473937390216345, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:09:10,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=11990, skipped=53, lr=[4.424082619710735e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:09:10,023] [INFO] [timer.py:258:stop] epoch=0/micro_step=11990/global_step=11990, RunningAvgSamplesPerSec=4.493330994316112, CurrSamplesPerSec=4.475001847111451, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:09:19,093] [INFO] [logging.py:96:log_dist] [Rank 0] step=12000, skipped=53, lr=[4.417220378432935e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:09:19,094] [INFO] [timer.py:258:stop] epoch=0/micro_step=12000/global_step=12000, RunningAvgSamplesPerSec=4.493318823069116, CurrSamplesPerSec=4.481563240595704, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:09:19,095] [INFO] [RANK 0]  iteration    12000/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 4.417E-05 | total loss 3.486719E-01 | loss 3.486719E-01 | loss scale 32768.0 |speed 264.66 samples/(min*GPU)
[2024-06-17 09:09:19,096] [INFO] [RANK 0] time (ms) | forward: 356.03 | backward: 546.71 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 13.85 | data loader: 0.09
[2024-06-17 09:09:19,096] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:09:19,108] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/12000/mp_rank_00_model_states.pt
[2024-06-17 09:09:19,108] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/12000/mp_rank_00_model_states.pt...
[2024-06-17 09:09:50,773] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/12000/mp_rank_00_model_states.pt.
[2024-06-17 09:09:57,364] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 09:09:57,364] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 09:09:57,364] [INFO] [RANK 0]  validation loss at iteration 12000 | loss: 8.166504E-01 | PPL: 2.262907E+00 loss 8.164062E-01 |
[2024-06-17 09:09:57,364] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 09:10:06,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=12010, skipped=53, lr=[4.410360808806216e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:10:06,335] [INFO] [timer.py:258:stop] epoch=0/micro_step=12010/global_step=12010, RunningAvgSamplesPerSec=4.493350500001747, CurrSamplesPerSec=4.532764383310715, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:10:15,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=12020, skipped=53, lr=[4.403503927755883e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:10:15,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=12020/global_step=12020, RunningAvgSamplesPerSec=4.493371620817182, CurrSamplesPerSec=4.521247866670583, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:10:24,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=12030, skipped=53, lr=[4.3966497522006095e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:10:24,366] [INFO] [timer.py:258:stop] epoch=0/micro_step=12030/global_step=12030, RunningAvgSamplesPerSec=4.493387054655147, CurrSamplesPerSec=4.5098200288590355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:10:33,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=12040, skipped=53, lr=[4.38979829905239e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:10:33,416] [INFO] [timer.py:258:stop] epoch=0/micro_step=12040/global_step=12040, RunningAvgSamplesPerSec=4.493392139619095, CurrSamplesPerSec=4.495417155782942, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:10:42,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=12050, skipped=53, lr=[4.382949585216507e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:10:42,485] [INFO] [timer.py:258:stop] epoch=0/micro_step=12050/global_step=12050, RunningAvgSamplesPerSec=4.493384312815213, CurrSamplesPerSec=4.476519454211588, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:10:42,486] [INFO] [RANK 0]  iteration    12050/   20000 | elapsed time per iteration (ms): 1667.8 | learning rate 4.382E-05 | total loss 3.133687E-01 | loss 3.133687E-01 | loss scale 32768.0 |speed 143.90 samples/(min*GPU)
[2024-06-17 09:10:42,487] [INFO] [RANK 0] time (ms) | forward: 354.82 | backward: 543.54 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 17.82 | data loader: 0.13
[2024-06-17 09:10:51,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=12060, skipped=53, lr=[4.376103627591479e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:10:51,556] [INFO] [timer.py:258:stop] epoch=0/micro_step=12060/global_step=12060, RunningAvgSamplesPerSec=4.493373611875605, CurrSamplesPerSec=4.487535260280113, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:11:00,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=12070, skipped=53, lr=[4.3692604430690294e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:11:00,623] [INFO] [timer.py:258:stop] epoch=0/micro_step=12070/global_step=12070, RunningAvgSamplesPerSec=4.49336788337798, CurrSamplesPerSec=4.482366654848852, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:11:09,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=12080, skipped=53, lr=[4.362420048534029e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:11:09,697] [INFO] [timer.py:258:stop] epoch=0/micro_step=12080/global_step=12080, RunningAvgSamplesPerSec=4.493358733126464, CurrSamplesPerSec=4.479611581530578, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:11:18,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=12090, skipped=53, lr=[4.3555824608644773e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:11:18,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=12090/global_step=12090, RunningAvgSamplesPerSec=4.493343304249386, CurrSamplesPerSec=4.4769124565009655, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:11:27,863] [INFO] [logging.py:96:log_dist] [Rank 0] step=12100, skipped=53, lr=[4.348747696931439e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:11:27,864] [INFO] [timer.py:258:stop] epoch=0/micro_step=12100/global_step=12100, RunningAvgSamplesPerSec=4.493335423202085, CurrSamplesPerSec=4.479360418470523, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:11:27,866] [INFO] [RANK 0]  iteration    12100/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 4.348E-05 | total loss 2.881398E-01 | loss 2.881398E-01 | loss scale 32768.0 |speed 264.44 samples/(min*GPU)
[2024-06-17 09:11:27,866] [INFO] [RANK 0] time (ms) | forward: 356.63 | backward: 546.92 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.48 | data loader: 0.11
[2024-06-17 09:11:36,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=12110, skipped=53, lr=[4.341915773599019e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:11:36,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=12110/global_step=12110, RunningAvgSamplesPerSec=4.4933228555365, CurrSamplesPerSec=4.4851934647533085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:11:46,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=12120, skipped=53, lr=[4.335086707724303e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:11:46,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=12120/global_step=12120, RunningAvgSamplesPerSec=4.493315605849951, CurrSamplesPerSec=4.480183381529556, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:11:55,137] [INFO] [logging.py:96:log_dist] [Rank 0] step=12130, skipped=53, lr=[4.328260516157337e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:11:55,137] [INFO] [timer.py:258:stop] epoch=0/micro_step=12130/global_step=12130, RunningAvgSamplesPerSec=4.493302294357966, CurrSamplesPerSec=4.474972006779187, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:11:57,856] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:11:58,766] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:12:04,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=12140, skipped=55, lr=[4.322801643724042e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:12:04,210] [INFO] [timer.py:258:stop] epoch=0/micro_step=12140/global_step=12140, RunningAvgSamplesPerSec=4.493293635055355, CurrSamplesPerSec=4.475525908205016, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:12:13,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=12150, skipped=55, lr=[4.315980668350462e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:12:13,290] [INFO] [timer.py:258:stop] epoch=0/micro_step=12150/global_step=12150, RunningAvgSamplesPerSec=4.493283256473382, CurrSamplesPerSec=4.488716682871179, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:12:13,291] [INFO] [RANK 0]  iteration    12150/   20000 | elapsed time per iteration (ms): 908.5 | learning rate 4.315E-05 | total loss 2.881677E-01 | loss 2.881677E-01 | loss scale 32768.0 |speed 264.17 samples/(min*GPU)
[2024-06-17 09:12:13,292] [INFO] [RANK 0] time (ms) | forward: 357.56 | backward: 546.94 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 15.21 | data loader: 0.11
[2024-06-17 09:12:22,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=12160, skipped=55, lr=[4.3091626144268803e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:12:22,351] [INFO] [timer.py:258:stop] epoch=0/micro_step=12160/global_step=12160, RunningAvgSamplesPerSec=4.4932719147231595, CurrSamplesPerSec=4.477537340798201, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:12:31,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=12170, skipped=55, lr=[4.3023474987761726e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:12:31,428] [INFO] [timer.py:258:stop] epoch=0/micro_step=12170/global_step=12170, RunningAvgSamplesPerSec=4.493262577924776, CurrSamplesPerSec=4.490110215973207, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:12:40,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=12180, skipped=55, lr=[4.295535338213954e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:12:40,498] [INFO] [timer.py:258:stop] epoch=0/micro_step=12180/global_step=12180, RunningAvgSamplesPerSec=4.493254428749874, CurrSamplesPerSec=4.489558705904107, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:12:49,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=12190, skipped=55, lr=[4.2887261495485595e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:12:49,581] [INFO] [timer.py:258:stop] epoch=0/micro_step=12190/global_step=12190, RunningAvgSamplesPerSec=4.493243343784928, CurrSamplesPerSec=4.483243435354289, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:12:58,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=12200, skipped=55, lr=[4.281919949580979e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:12:58,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=12200/global_step=12200, RunningAvgSamplesPerSec=4.49323314026136, CurrSamplesPerSec=4.475528296007956, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:12:58,653] [INFO] [RANK 0]  iteration    12200/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 4.281E-05 | total loss 2.749002E-01 | loss 2.749002E-01 | loss scale 32768.0 |speed 264.54 samples/(min*GPU)
[2024-06-17 09:12:58,654] [INFO] [RANK 0] time (ms) | forward: 356.20 | backward: 546.99 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.02 | data loader: 0.10
[2024-06-17 09:13:07,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=12210, skipped=55, lr=[4.2751167551048385e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:13:07,710] [INFO] [timer.py:258:stop] epoch=0/micro_step=12210/global_step=12210, RunningAvgSamplesPerSec=4.493223163457526, CurrSamplesPerSec=4.482682831227842, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:13:16,757] [INFO] [logging.py:96:log_dist] [Rank 0] step=12220, skipped=55, lr=[4.268316582906341e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:13:16,757] [INFO] [timer.py:258:stop] epoch=0/micro_step=12220/global_step=12220, RunningAvgSamplesPerSec=4.493214288984959, CurrSamplesPerSec=4.484536473778215, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:13:25,810] [INFO] [logging.py:96:log_dist] [Rank 0] step=12230, skipped=55, lr=[4.261519449764238e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:13:25,811] [INFO] [timer.py:258:stop] epoch=0/micro_step=12230/global_step=12230, RunningAvgSamplesPerSec=4.493203830203055, CurrSamplesPerSec=4.480318577340246, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:13:34,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=12240, skipped=55, lr=[4.25472537244978e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:13:34,853] [INFO] [timer.py:258:stop] epoch=0/micro_step=12240/global_step=12240, RunningAvgSamplesPerSec=4.493194014325355, CurrSamplesPerSec=4.489480616300857, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:13:43,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=12250, skipped=55, lr=[4.247934367726675e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:13:43,886] [INFO] [timer.py:258:stop] epoch=0/micro_step=12250/global_step=12250, RunningAvgSamplesPerSec=4.49318739058181, CurrSamplesPerSec=4.47829508266735, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:13:43,887] [INFO] [RANK 0]  iteration    12250/   20000 | elapsed time per iteration (ms): 904.7 | learning rate 4.247E-05 | total loss 3.078412E-01 | loss 3.078412E-01 | loss scale 32768.0 |speed 265.29 samples/(min*GPU)
[2024-06-17 09:13:43,887] [INFO] [RANK 0] time (ms) | forward: 353.62 | backward: 546.92 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 11.60 | data loader: 0.09
[2024-06-17 09:13:52,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=12260, skipped=55, lr=[4.241146452351054e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:13:52,946] [INFO] [timer.py:258:stop] epoch=0/micro_step=12260/global_step=12260, RunningAvgSamplesPerSec=4.493173597009381, CurrSamplesPerSec=4.445046871497753, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:14:02,032] [INFO] [logging.py:96:log_dist] [Rank 0] step=12270, skipped=55, lr=[4.234361643071424e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:14:02,032] [INFO] [timer.py:258:stop] epoch=0/micro_step=12270/global_step=12270, RunningAvgSamplesPerSec=4.493156319902578, CurrSamplesPerSec=4.464423972453286, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:14:11,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=12280, skipped=55, lr=[4.2275799566286245e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:14:11,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=12280/global_step=12280, RunningAvgSamplesPerSec=4.493136641702711, CurrSamplesPerSec=4.466531264118298, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:14:20,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=12290, skipped=55, lr=[4.220801409755796e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:14:20,222] [INFO] [timer.py:258:stop] epoch=0/micro_step=12290/global_step=12290, RunningAvgSamplesPerSec=4.493124066695264, CurrSamplesPerSec=4.479194187935246, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:14:29,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=12300, skipped=55, lr=[4.214026019178325e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:14:29,299] [INFO] [timer.py:258:stop] epoch=0/micro_step=12300/global_step=12300, RunningAvgSamplesPerSec=4.4931127175652135, CurrSamplesPerSec=4.488130696364225, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:14:29,299] [INFO] [RANK 0]  iteration    12300/   20000 | elapsed time per iteration (ms): 908.2 | learning rate 4.213E-05 | total loss 3.387848E-01 | loss 3.387848E-01 | loss scale 32768.0 |speed 264.25 samples/(min*GPU)
[2024-06-17 09:14:29,300] [INFO] [RANK 0] time (ms) | forward: 356.82 | backward: 547.17 | allreduce: 0.00 | optimizer: 3.39 | batch generator: 13.79 | data loader: 0.10
[2024-06-17 09:14:29,300] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:14:29,312] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/12300/mp_rank_00_model_states.pt
[2024-06-17 09:14:29,312] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/12300/mp_rank_00_model_states.pt...
[2024-06-17 09:15:01,930] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/12300/mp_rank_00_model_states.pt.
[2024-06-17 09:15:10,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=12310, skipped=55, lr=[4.2072538016138205e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:15:10,928] [INFO] [timer.py:258:stop] epoch=0/micro_step=12310/global_step=12310, RunningAvgSamplesPerSec=4.493146001822268, CurrSamplesPerSec=4.542217413928565, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:15:19,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=12320, skipped=55, lr=[4.200484773772049e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:15:19,909] [INFO] [timer.py:258:stop] epoch=0/micro_step=12320/global_step=12320, RunningAvgSamplesPerSec=4.493175677810948, CurrSamplesPerSec=4.517498247765312, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:15:28,911] [INFO] [logging.py:96:log_dist] [Rank 0] step=12330, skipped=55, lr=[4.1937189523549214e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:15:28,911] [INFO] [timer.py:258:stop] epoch=0/micro_step=12330/global_step=12330, RunningAvgSamplesPerSec=4.493194743457327, CurrSamplesPerSec=4.503804305954088, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:15:37,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=12340, skipped=55, lr=[4.1869563540564225e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:15:37,930] [INFO] [timer.py:258:stop] epoch=0/micro_step=12340/global_step=12340, RunningAvgSamplesPerSec=4.493207490933621, CurrSamplesPerSec=4.510075831847871, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:15:47,007] [INFO] [logging.py:96:log_dist] [Rank 0] step=12350, skipped=55, lr=[4.180196995562593e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:15:47,007] [INFO] [timer.py:258:stop] epoch=0/micro_step=12350/global_step=12350, RunningAvgSamplesPerSec=4.493199730990335, CurrSamplesPerSec=4.4920782522434, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:15:47,008] [INFO] [RANK 0]  iteration    12350/   20000 | elapsed time per iteration (ms): 1554.2 | learning rate 4.180E-05 | total loss 3.400055E-01 | loss 3.400055E-01 | loss scale 32768.0 |speed 154.42 samples/(min*GPU)
[2024-06-17 09:15:47,008] [INFO] [RANK 0] time (ms) | forward: 354.20 | backward: 543.07 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.78 | data loader: 0.10
[2024-06-17 09:15:56,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=12360, skipped=55, lr=[4.1734408935514815e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:15:56,073] [INFO] [timer.py:258:stop] epoch=0/micro_step=12360/global_step=12360, RunningAvgSamplesPerSec=4.4931974599383375, CurrSamplesPerSec=4.488079069641774, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:16:05,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=12370, skipped=55, lr=[4.166688064693094e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:16:05,128] [INFO] [timer.py:258:stop] epoch=0/micro_step=12370/global_step=12370, RunningAvgSamplesPerSec=4.49319479044027, CurrSamplesPerSec=4.4928974731693625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:16:14,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=12380, skipped=55, lr=[4.1599385256493685e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:16:14,215] [INFO] [timer.py:258:stop] epoch=0/micro_step=12380/global_step=12380, RunningAvgSamplesPerSec=4.493181914836179, CurrSamplesPerSec=4.467332865934076, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:16:23,301] [INFO] [logging.py:96:log_dist] [Rank 0] step=12390, skipped=55, lr=[4.153192293074117e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:16:23,301] [INFO] [timer.py:258:stop] epoch=0/micro_step=12390/global_step=12390, RunningAvgSamplesPerSec=4.493168624045233, CurrSamplesPerSec=4.4831116568220475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:16:32,388] [INFO] [logging.py:96:log_dist] [Rank 0] step=12400, skipped=55, lr=[4.146449383613001e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:16:32,389] [INFO] [timer.py:258:stop] epoch=0/micro_step=12400/global_step=12400, RunningAvgSamplesPerSec=4.493153872503641, CurrSamplesPerSec=4.448441222840252, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:16:32,389] [INFO] [RANK 0]  iteration    12400/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 4.146E-05 | total loss 2.910532E-01 | loss 2.910532E-01 | loss scale 32768.0 |speed 264.42 samples/(min*GPU)
[2024-06-17 09:16:32,390] [INFO] [RANK 0] time (ms) | forward: 356.56 | backward: 546.85 | allreduce: 0.00 | optimizer: 3.43 | batch generator: 14.65 | data loader: 0.10
[2024-06-17 09:16:41,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=12410, skipped=55, lr=[4.139709813903477e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:16:41,462] [INFO] [timer.py:258:stop] epoch=0/micro_step=12410/global_step=12410, RunningAvgSamplesPerSec=4.493143749213579, CurrSamplesPerSec=4.480460960510654, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:16:50,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=12420, skipped=55, lr=[4.132973600574767e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:16:50,552] [INFO] [timer.py:258:stop] epoch=0/micro_step=12420/global_step=12420, RunningAvgSamplesPerSec=4.493134487441709, CurrSamplesPerSec=4.488602595634738, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:16:59,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=12430, skipped=55, lr=[4.126240760247805e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:16:59,636] [INFO] [timer.py:258:stop] epoch=0/micro_step=12430/global_step=12430, RunningAvgSamplesPerSec=4.4931249882934186, CurrSamplesPerSec=4.469912073589413, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:17:08,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=12440, skipped=55, lr=[4.119511309535206e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:17:08,722] [INFO] [timer.py:258:stop] epoch=0/micro_step=12440/global_step=12440, RunningAvgSamplesPerSec=4.4931147512097604, CurrSamplesPerSec=4.48578827950831, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:17:17,778] [INFO] [logging.py:96:log_dist] [Rank 0] step=12450, skipped=55, lr=[4.112785265041219e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:17:17,779] [INFO] [timer.py:258:stop] epoch=0/micro_step=12450/global_step=12450, RunningAvgSamplesPerSec=4.493106324837999, CurrSamplesPerSec=4.474868165525048, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:17:17,779] [INFO] [RANK 0]  iteration    12450/   20000 | elapsed time per iteration (ms): 907.8 | learning rate 4.112E-05 | total loss 3.198901E-01 | loss 3.198901E-01 | loss scale 32768.0 |speed 264.38 samples/(min*GPU)
[2024-06-17 09:17:17,779] [INFO] [RANK 0] time (ms) | forward: 356.75 | backward: 546.91 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 14.72 | data loader: 0.10
[2024-06-17 09:17:26,870] [INFO] [logging.py:96:log_dist] [Rank 0] step=12460, skipped=55, lr=[4.106062643361693e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:17:26,870] [INFO] [timer.py:258:stop] epoch=0/micro_step=12460/global_step=12460, RunningAvgSamplesPerSec=4.4930936665002745, CurrSamplesPerSec=4.47230827261083, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:17:35,944] [INFO] [logging.py:96:log_dist] [Rank 0] step=12470, skipped=55, lr=[4.0993434610840255e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:17:35,945] [INFO] [timer.py:258:stop] epoch=0/micro_step=12470/global_step=12470, RunningAvgSamplesPerSec=4.493086334465917, CurrSamplesPerSec=4.486875183195442, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:17:45,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=12480, skipped=55, lr=[4.0926277347871355e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:17:45,009] [INFO] [timer.py:258:stop] epoch=0/micro_step=12480/global_step=12480, RunningAvgSamplesPerSec=4.49308086995435, CurrSamplesPerSec=4.478438532707636, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:17:54,073] [INFO] [logging.py:96:log_dist] [Rank 0] step=12490, skipped=55, lr=[4.085915481041404e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:17:54,074] [INFO] [timer.py:258:stop] epoch=0/micro_step=12490/global_step=12490, RunningAvgSamplesPerSec=4.493071467603283, CurrSamplesPerSec=4.482460065954929, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:18:03,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=12500, skipped=55, lr=[4.0792067164086553e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:18:03,141] [INFO] [timer.py:258:stop] epoch=0/micro_step=12500/global_step=12500, RunningAvgSamplesPerSec=4.49306233191054, CurrSamplesPerSec=4.467598147689539, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:18:03,141] [INFO] [RANK 0]  iteration    12500/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 4.079E-05 | total loss 3.280981E-01 | loss 3.280981E-01 | loss scale 32768.0 |speed 264.54 samples/(min*GPU)
[2024-06-17 09:18:03,141] [INFO] [RANK 0] time (ms) | forward: 356.23 | backward: 546.99 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.32 | data loader: 0.09
[2024-06-17 09:18:12,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=12510, skipped=55, lr=[4.072501457442095e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:18:12,204] [INFO] [timer.py:258:stop] epoch=0/micro_step=12510/global_step=12510, RunningAvgSamplesPerSec=4.493054116105393, CurrSamplesPerSec=4.489708885853625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:18:21,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=12520, skipped=55, lr=[4.065799720686288e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:18:21,272] [INFO] [timer.py:258:stop] epoch=0/micro_step=12520/global_step=12520, RunningAvgSamplesPerSec=4.493044161905783, CurrSamplesPerSec=4.472510953205454, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:18:30,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=12530, skipped=55, lr=[4.0591015226770973e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:18:30,335] [INFO] [timer.py:258:stop] epoch=0/micro_step=12530/global_step=12530, RunningAvgSamplesPerSec=4.493038237681775, CurrSamplesPerSec=4.477953230453213, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:18:34,868] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:18:35,772] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:18:39,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=12540, skipped=57, lr=[4.0537455232738436e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:18:39,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=12540/global_step=12540, RunningAvgSamplesPerSec=4.493032170236725, CurrSamplesPerSec=4.490201546619934, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:18:48,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=12550, skipped=57, lr=[4.047053736651062e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:18:48,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=12550/global_step=12550, RunningAvgSamplesPerSec=4.493022468864179, CurrSamplesPerSec=4.475322954267307, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:18:48,465] [INFO] [RANK 0]  iteration    12550/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 4.046E-05 | total loss 3.288293E-01 | loss 3.288293E-01 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 09:18:48,465] [INFO] [RANK 0] time (ms) | forward: 355.70 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 13.76 | data loader: 0.10
[2024-06-17 09:18:57,533] [INFO] [logging.py:96:log_dist] [Rank 0] step=12560, skipped=57, lr=[4.0403655350287546e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:18:57,533] [INFO] [timer.py:258:stop] epoch=0/micro_step=12560/global_step=12560, RunningAvgSamplesPerSec=4.49301695162473, CurrSamplesPerSec=4.493130903569123, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:19:06,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=12570, skipped=57, lr=[4.0336809349093876e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:19:06,641] [INFO] [timer.py:258:stop] epoch=0/micro_step=12570/global_step=12570, RunningAvgSamplesPerSec=4.49299875875156, CurrSamplesPerSec=4.4714417222224885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:19:15,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=12580, skipped=57, lr=[4.0269999527865555e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:19:15,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=12580/global_step=12580, RunningAvgSamplesPerSec=4.4929817294045495, CurrSamplesPerSec=4.473775140828639, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:19:24,806] [INFO] [logging.py:96:log_dist] [Rank 0] step=12590, skipped=57, lr=[4.0203226051449106e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:19:24,807] [INFO] [timer.py:258:stop] epoch=0/micro_step=12590/global_step=12590, RunningAvgSamplesPerSec=4.492977472476806, CurrSamplesPerSec=4.4820193912899216, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:19:33,901] [INFO] [logging.py:96:log_dist] [Rank 0] step=12600, skipped=57, lr=[4.01364890846015e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:19:33,902] [INFO] [timer.py:258:stop] epoch=0/micro_step=12600/global_step=12600, RunningAvgSamplesPerSec=4.492970062866162, CurrSamplesPerSec=4.485872237843087, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:19:33,902] [INFO] [RANK 0]  iteration    12600/   20000 | elapsed time per iteration (ms): 908.7 | learning rate 4.013E-05 | total loss 2.639888E-01 | loss 2.639888E-01 | loss scale 32768.0 |speed 264.10 samples/(min*GPU)
[2024-06-17 09:19:33,903] [INFO] [RANK 0] time (ms) | forward: 357.60 | backward: 546.93 | allreduce: 0.00 | optimizer: 3.42 | batch generator: 15.37 | data loader: 0.11
[2024-06-17 09:19:33,903] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:19:33,915] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/12600/mp_rank_00_model_states.pt
[2024-06-17 09:19:33,915] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/12600/mp_rank_00_model_states.pt...
[2024-06-17 09:20:05,272] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/12600/mp_rank_00_model_states.pt.
[2024-06-17 09:20:14,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=12610, skipped=57, lr=[4.006978879198951e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:20:14,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=12610/global_step=12610, RunningAvgSamplesPerSec=4.493000341235023, CurrSamplesPerSec=4.5338239395361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:20:23,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=12620, skipped=57, lr=[4.000312533818951e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:20:23,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=12620/global_step=12620, RunningAvgSamplesPerSec=4.493021674333394, CurrSamplesPerSec=4.519910438118813, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:20:32,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=12630, skipped=57, lr=[3.993649888768695e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:20:32,299] [INFO] [timer.py:258:stop] epoch=0/micro_step=12630/global_step=12630, RunningAvgSamplesPerSec=4.493036692256416, CurrSamplesPerSec=4.514863848077339, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:20:41,330] [INFO] [logging.py:96:log_dist] [Rank 0] step=12640, skipped=57, lr=[3.986990960487597e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:20:41,330] [INFO] [timer.py:258:stop] epoch=0/micro_step=12640/global_step=12640, RunningAvgSamplesPerSec=4.493043297251267, CurrSamplesPerSec=4.499340139245235, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:20:50,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=12650, skipped=57, lr=[3.980335765405899e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:20:50,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=12650/global_step=12650, RunningAvgSamplesPerSec=4.493049043882272, CurrSamplesPerSec=4.4914505053988005, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:20:50,370] [INFO] [RANK 0]  iteration    12650/   20000 | elapsed time per iteration (ms): 1529.4 | learning rate 3.980E-05 | total loss 3.319995E-01 | loss 3.319995E-01 | loss scale 32768.0 |speed 156.93 samples/(min*GPU)
[2024-06-17 09:20:50,371] [INFO] [RANK 0] time (ms) | forward: 354.90 | backward: 542.59 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 14.77 | data loader: 0.14
[2024-06-17 09:20:59,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=12660, skipped=57, lr=[3.973684319944636e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:20:59,438] [INFO] [timer.py:258:stop] epoch=0/micro_step=12660/global_step=12660, RunningAvgSamplesPerSec=4.493046584712539, CurrSamplesPerSec=4.492119146055852, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:21:08,491] [INFO] [logging.py:96:log_dist] [Rank 0] step=12670, skipped=57, lr=[3.967036640515586e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:21:08,491] [INFO] [timer.py:258:stop] epoch=0/micro_step=12670/global_step=12670, RunningAvgSamplesPerSec=4.493044208740166, CurrSamplesPerSec=4.493769953118291, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:21:17,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=12680, skipped=57, lr=[3.9603927435212395e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:21:17,564] [INFO] [timer.py:258:stop] epoch=0/micro_step=12680/global_step=12680, RunningAvgSamplesPerSec=4.493040763565367, CurrSamplesPerSec=4.464812477362864, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:21:26,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=12690, skipped=57, lr=[3.953752645354749e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:21:26,641] [INFO] [timer.py:258:stop] epoch=0/micro_step=12690/global_step=12690, RunningAvgSamplesPerSec=4.493033066039775, CurrSamplesPerSec=4.489514254566123, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:21:35,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=12700, skipped=57, lr=[3.947116362399898e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:21:35,710] [INFO] [timer.py:258:stop] epoch=0/micro_step=12700/global_step=12700, RunningAvgSamplesPerSec=4.493024251700704, CurrSamplesPerSec=4.474622307746675, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:21:35,710] [INFO] [RANK 0]  iteration    12700/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 3.946E-05 | total loss 3.021307E-01 | loss 3.021307E-01 | loss scale 32768.0 |speed 264.67 samples/(min*GPU)
[2024-06-17 09:21:35,711] [INFO] [RANK 0] time (ms) | forward: 356.51 | backward: 546.32 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.74 | data loader: 0.10
[2024-06-17 09:21:44,759] [INFO] [logging.py:96:log_dist] [Rank 0] step=12710, skipped=57, lr=[3.940483911031055e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:21:44,759] [INFO] [timer.py:258:stop] epoch=0/micro_step=12710/global_step=12710, RunningAvgSamplesPerSec=4.4930174498687885, CurrSamplesPerSec=4.4940239385325516, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:21:53,802] [INFO] [logging.py:96:log_dist] [Rank 0] step=12720, skipped=57, lr=[3.933855307613136e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:21:53,802] [INFO] [timer.py:258:stop] epoch=0/micro_step=12720/global_step=12720, RunningAvgSamplesPerSec=4.493013114352825, CurrSamplesPerSec=4.47886893797419, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:22:02,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=12730, skipped=57, lr=[3.927230568501559e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:22:02,858] [INFO] [timer.py:258:stop] epoch=0/micro_step=12730/global_step=12730, RunningAvgSamplesPerSec=4.493009614071651, CurrSamplesPerSec=4.491101832957362, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:22:11,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=12740, skipped=57, lr=[3.9206097100422114e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:22:11,923] [INFO] [timer.py:258:stop] epoch=0/micro_step=12740/global_step=12740, RunningAvgSamplesPerSec=4.493004572964477, CurrSamplesPerSec=4.48736122110715, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:22:20,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=12750, skipped=57, lr=[3.913992748571398e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:22:20,989] [INFO] [timer.py:258:stop] epoch=0/micro_step=12750/global_step=12750, RunningAvgSamplesPerSec=4.492999867299315, CurrSamplesPerSec=4.494233407821049, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:22:20,990] [INFO] [RANK 0]  iteration    12750/   20000 | elapsed time per iteration (ms): 905.6 | learning rate 3.913E-05 | total loss 3.386481E-01 | loss 3.386481E-01 | loss scale 32768.0 |speed 265.02 samples/(min*GPU)
[2024-06-17 09:22:20,990] [INFO] [RANK 0] time (ms) | forward: 354.92 | backward: 546.70 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 13.58 | data loader: 0.09
[2024-06-17 09:22:30,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=12760, skipped=57, lr=[3.907379700415821e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:22:30,042] [INFO] [timer.py:258:stop] epoch=0/micro_step=12760/global_step=12760, RunningAvgSamplesPerSec=4.492993731886876, CurrSamplesPerSec=4.476808525172484, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:22:39,091] [INFO] [logging.py:96:log_dist] [Rank 0] step=12770, skipped=57, lr=[3.9007705818925124e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:22:39,092] [INFO] [timer.py:258:stop] epoch=0/micro_step=12770/global_step=12770, RunningAvgSamplesPerSec=4.492986339821416, CurrSamplesPerSec=4.471458406404149, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:22:48,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=12780, skipped=57, lr=[3.894165409308821e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:22:48,140] [INFO] [timer.py:258:stop] epoch=0/micro_step=12780/global_step=12780, RunningAvgSamplesPerSec=4.492979222915925, CurrSamplesPerSec=4.488133097636036, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:22:57,218] [INFO] [logging.py:96:log_dist] [Rank 0] step=12790, skipped=57, lr=[3.887564198962349e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:22:57,218] [INFO] [timer.py:258:stop] epoch=0/micro_step=12790/global_step=12790, RunningAvgSamplesPerSec=4.492970153969958, CurrSamplesPerSec=4.472980765923775, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:23:06,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=12800, skipped=57, lr=[3.8809669671409296e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:23:06,290] [INFO] [timer.py:258:stop] epoch=0/micro_step=12800/global_step=12800, RunningAvgSamplesPerSec=4.492959029182259, CurrSamplesPerSec=4.483230257152447, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:23:06,290] [INFO] [RANK 0]  iteration    12800/   20000 | elapsed time per iteration (ms): 906.0 | learning rate 3.880E-05 | total loss 2.823334E-01 | loss 2.823334E-01 | loss scale 32768.0 |speed 264.90 samples/(min*GPU)
[2024-06-17 09:23:06,291] [INFO] [RANK 0] time (ms) | forward: 355.25 | backward: 546.70 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 13.17 | data loader: 0.09
[2024-06-17 09:23:15,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=12810, skipped=57, lr=[3.874373730122574e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:23:15,381] [INFO] [timer.py:258:stop] epoch=0/micro_step=12810/global_step=12810, RunningAvgSamplesPerSec=4.4929466734212165, CurrSamplesPerSec=4.467290043133278, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:23:24,446] [INFO] [logging.py:96:log_dist] [Rank 0] step=12820, skipped=57, lr=[3.867784504175442e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:23:24,447] [INFO] [timer.py:258:stop] epoch=0/micro_step=12820/global_step=12820, RunningAvgSamplesPerSec=4.492939794341501, CurrSamplesPerSec=4.479462076316214, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:23:33,517] [INFO] [logging.py:96:log_dist] [Rank 0] step=12830, skipped=57, lr=[3.8611993055577914e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:23:33,517] [INFO] [timer.py:258:stop] epoch=0/micro_step=12830/global_step=12830, RunningAvgSamplesPerSec=4.4929281754691575, CurrSamplesPerSec=4.480216880616054, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:23:42,578] [INFO] [logging.py:96:log_dist] [Rank 0] step=12840, skipped=57, lr=[3.854618150517947e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:23:42,579] [INFO] [timer.py:258:stop] epoch=0/micro_step=12840/global_step=12840, RunningAvgSamplesPerSec=4.492919433266477, CurrSamplesPerSec=4.476360600529515, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:23:51,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=12850, skipped=57, lr=[3.8480410552942524e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:23:51,639] [INFO] [timer.py:258:stop] epoch=0/micro_step=12850/global_step=12850, RunningAvgSamplesPerSec=4.492909328450601, CurrSamplesPerSec=4.467467287280783, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:23:51,639] [INFO] [RANK 0]  iteration    12850/   20000 | elapsed time per iteration (ms): 907.0 | learning rate 3.847E-05 | total loss 4.003174E-01 | loss 4.003174E-01 | loss scale 32768.0 |speed 264.61 samples/(min*GPU)
[2024-06-17 09:23:51,640] [INFO] [RANK 0] time (ms) | forward: 356.15 | backward: 546.74 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 13.69 | data loader: 0.09
[2024-06-17 09:24:00,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=12860, skipped=57, lr=[3.841468036115038e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:24:00,709] [INFO] [timer.py:258:stop] epoch=0/micro_step=12860/global_step=12860, RunningAvgSamplesPerSec=4.492900469254767, CurrSamplesPerSec=4.485787080126297, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:24:09,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=12870, skipped=57, lr=[3.834899109198574e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:24:09,773] [INFO] [timer.py:258:stop] epoch=0/micro_step=12870/global_step=12870, RunningAvgSamplesPerSec=4.492896834455574, CurrSamplesPerSec=4.492818064232787, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:24:18,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=12880, skipped=57, lr=[3.8283342907530366e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:24:18,828] [INFO] [timer.py:258:stop] epoch=0/micro_step=12880/global_step=12880, RunningAvgSamplesPerSec=4.492888696592494, CurrSamplesPerSec=4.462177435827603, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:24:27,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=12890, skipped=57, lr=[3.82177359697646e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:24:27,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=12890/global_step=12890, RunningAvgSamplesPerSec=4.492882950297716, CurrSamplesPerSec=4.476410763632172, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:24:36,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=12900, skipped=57, lr=[3.8152170440567066e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:24:36,925] [INFO] [timer.py:258:stop] epoch=0/micro_step=12900/global_step=12900, RunningAvgSamplesPerSec=4.492875193145238, CurrSamplesPerSec=4.486493627212666, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:24:36,925] [INFO] [RANK 0]  iteration    12900/   20000 | elapsed time per iteration (ms): 905.7 | learning rate 3.815E-05 | total loss 3.154655E-01 | loss 3.154655E-01 | loss scale 32768.0 |speed 264.98 samples/(min*GPU)
[2024-06-17 09:24:36,926] [INFO] [RANK 0] time (ms) | forward: 354.96 | backward: 546.75 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 13.22 | data loader: 0.10
[2024-06-17 09:24:36,926] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:24:36,938] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/12900/mp_rank_00_model_states.pt
[2024-06-17 09:24:36,938] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/12900/mp_rank_00_model_states.pt...
[2024-06-17 09:25:08,636] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/12900/mp_rank_00_model_states.pt.
[2024-06-17 09:25:17,658] [INFO] [logging.py:96:log_dist] [Rank 0] step=12910, skipped=57, lr=[3.8086646481714164e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:25:17,659] [INFO] [timer.py:258:stop] epoch=0/micro_step=12910/global_step=12910, RunningAvgSamplesPerSec=4.4929018008435575, CurrSamplesPerSec=4.532665190109046, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:25:26,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=12920, skipped=57, lr=[3.802116425487977e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:25:26,662] [INFO] [timer.py:258:stop] epoch=0/micro_step=12920/global_step=12920, RunningAvgSamplesPerSec=4.49293053693104, CurrSamplesPerSec=4.513841065981353, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:25:35,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=12930, skipped=57, lr=[3.795572392163476e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:25:35,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=12930/global_step=12930, RunningAvgSamplesPerSec=4.4929465743069485, CurrSamplesPerSec=4.512251936246738, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:25:42,006] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:25:42,905] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:25:44,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=12940, skipped=59, lr=[3.790340192693276e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:25:44,711] [INFO] [timer.py:258:stop] epoch=0/micro_step=12940/global_step=12940, RunningAvgSamplesPerSec=4.492959128838554, CurrSamplesPerSec=4.507675335485268, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:25:53,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=12950, skipped=59, lr=[3.7838037408977065e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:25:53,749] [INFO] [timer.py:258:stop] epoch=0/micro_step=12950/global_step=12950, RunningAvgSamplesPerSec=4.492968548373144, CurrSamplesPerSec=4.516203154114223, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:25:53,750] [INFO] [RANK 0]  iteration    12950/   20000 | elapsed time per iteration (ms): 1536.5 | learning rate 3.783E-05 | total loss 3.132440E-01 | loss 3.132440E-01 | loss scale 32768.0 |speed 156.20 samples/(min*GPU)
[2024-06-17 09:25:53,750] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 542.28 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 15.82 | data loader: 0.11
[2024-06-17 09:26:02,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=12960, skipped=59, lr=[3.777271523645805e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:26:02,774] [INFO] [timer.py:258:stop] epoch=0/micro_step=12960/global_step=12960, RunningAvgSamplesPerSec=4.492977685704292, CurrSamplesPerSec=4.506120800192092, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:26:11,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=12970, skipped=59, lr=[3.770743557055166e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:26:11,803] [INFO] [timer.py:258:stop] epoch=0/micro_step=12970/global_step=12970, RunningAvgSamplesPerSec=4.492983374178138, CurrSamplesPerSec=4.4929949334281, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:26:20,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=12980, skipped=59, lr=[3.7642198572329014e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:26:20,852] [INFO] [timer.py:258:stop] epoch=0/micro_step=12980/global_step=12980, RunningAvgSamplesPerSec=4.492985080016775, CurrSamplesPerSec=4.49778170021305, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:26:29,889] [INFO] [logging.py:96:log_dist] [Rank 0] step=12990, skipped=59, lr=[3.757700440275589e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:26:29,889] [INFO] [timer.py:258:stop] epoch=0/micro_step=12990/global_step=12990, RunningAvgSamplesPerSec=4.492984226033159, CurrSamplesPerSec=4.50210383499064, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:26:38,937] [INFO] [logging.py:96:log_dist] [Rank 0] step=13000, skipped=59, lr=[3.751185322269244e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:26:38,938] [INFO] [timer.py:258:stop] epoch=0/micro_step=13000/global_step=13000, RunningAvgSamplesPerSec=4.492984975576833, CurrSamplesPerSec=4.502852995833499, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:26:38,938] [INFO] [RANK 0]  iteration    13000/   20000 | elapsed time per iteration (ms): 903.8 | learning rate 3.751E-05 | total loss 3.248981E-01 | loss 3.248981E-01 | loss scale 32768.0 |speed 265.56 samples/(min*GPU)
[2024-06-17 09:26:38,939] [INFO] [RANK 0] time (ms) | forward: 354.89 | backward: 544.88 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 13.93 | data loader: 0.10
[2024-06-17 09:26:45,601] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 09:26:45,601] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 09:26:45,601] [INFO] [RANK 0]  validation loss at iteration 13000 | loss: 8.500488E-01 | PPL: 2.339761E+00 loss 8.500977E-01 |
[2024-06-17 09:26:45,601] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 09:26:54,655] [INFO] [logging.py:96:log_dist] [Rank 0] step=13010, skipped=59, lr=[3.744674519289271e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:26:54,656] [INFO] [timer.py:258:stop] epoch=0/micro_step=13010/global_step=13010, RunningAvgSamplesPerSec=4.492978182214594, CurrSamplesPerSec=4.473191856053435, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:27:03,725] [INFO] [logging.py:96:log_dist] [Rank 0] step=13020, skipped=59, lr=[3.738168047400432e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:27:03,725] [INFO] [timer.py:258:stop] epoch=0/micro_step=13020/global_step=13020, RunningAvgSamplesPerSec=4.492973694018685, CurrSamplesPerSec=4.474264310754284, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:27:12,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=13030, skipped=59, lr=[3.7316659226567946e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:27:12,788] [INFO] [timer.py:258:stop] epoch=0/micro_step=13030/global_step=13030, RunningAvgSamplesPerSec=4.492966082195273, CurrSamplesPerSec=4.486972382354554, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:27:21,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=13040, skipped=59, lr=[3.725168161101711e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:27:21,827] [INFO] [timer.py:258:stop] epoch=0/micro_step=13040/global_step=13040, RunningAvgSamplesPerSec=4.492965490622468, CurrSamplesPerSec=4.498644015622913, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:27:30,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=13050, skipped=59, lr=[3.718674778767756e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:27:30,877] [INFO] [timer.py:258:stop] epoch=0/micro_step=13050/global_step=13050, RunningAvgSamplesPerSec=4.492963882178365, CurrSamplesPerSec=4.493814488769225, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:27:30,878] [INFO] [RANK 0]  iteration    13050/   20000 | elapsed time per iteration (ms): 1038.8 | learning rate 3.718E-05 | total loss 3.260773E-01 | loss 3.260773E-01 | loss scale 32768.0 |speed 231.04 samples/(min*GPU)
[2024-06-17 09:27:30,878] [INFO] [RANK 0] time (ms) | forward: 355.53 | backward: 546.01 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 16.83 | data loader: 0.16
[2024-06-17 09:27:39,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=13060, skipped=59, lr=[3.712185791676711e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:27:39,917] [INFO] [timer.py:258:stop] epoch=0/micro_step=13060/global_step=13060, RunningAvgSamplesPerSec=4.492962081682111, CurrSamplesPerSec=4.485496848535889, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:27:48,974] [INFO] [logging.py:96:log_dist] [Rank 0] step=13070, skipped=59, lr=[3.705701215839501e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:27:48,974] [INFO] [timer.py:258:stop] epoch=0/micro_step=13070/global_step=13070, RunningAvgSamplesPerSec=4.492954532375249, CurrSamplesPerSec=4.480233630347164, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:27:58,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=13080, skipped=59, lr=[3.6992210672561774e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:27:58,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=13080/global_step=13080, RunningAvgSamplesPerSec=4.492948477817454, CurrSamplesPerSec=4.476696236976602, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:28:07,114] [INFO] [logging.py:96:log_dist] [Rank 0] step=13090, skipped=59, lr=[3.6927453619158594e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:28:07,115] [INFO] [timer.py:258:stop] epoch=0/micro_step=13090/global_step=13090, RunningAvgSamplesPerSec=4.492944244424116, CurrSamplesPerSec=4.489507046323988, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:28:16,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=13100, skipped=59, lr=[3.686274115796706e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:28:16,182] [INFO] [timer.py:258:stop] epoch=0/micro_step=13100/global_step=13100, RunningAvgSamplesPerSec=4.492942618763451, CurrSamplesPerSec=4.495146151323475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:28:16,182] [INFO] [RANK 0]  iteration    13100/   20000 | elapsed time per iteration (ms): 906.1 | learning rate 3.686E-05 | total loss 3.017332E-01 | loss 3.017332E-01 | loss scale 32768.0 |speed 264.87 samples/(min*GPU)
[2024-06-17 09:28:16,183] [INFO] [RANK 0] time (ms) | forward: 356.04 | backward: 545.98 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 14.22 | data loader: 0.11
[2024-06-17 09:28:25,216] [INFO] [logging.py:96:log_dist] [Rank 0] step=13110, skipped=59, lr=[3.679807344865876e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:28:25,217] [INFO] [timer.py:258:stop] epoch=0/micro_step=13110/global_step=13110, RunningAvgSamplesPerSec=4.492940409400371, CurrSamplesPerSec=4.492763923385396, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:28:34,280] [INFO] [logging.py:96:log_dist] [Rank 0] step=13120, skipped=59, lr=[3.6733450650794814e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:28:34,281] [INFO] [timer.py:258:stop] epoch=0/micro_step=13120/global_step=13120, RunningAvgSamplesPerSec=4.492933225111844, CurrSamplesPerSec=4.488247161006872, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:28:43,336] [INFO] [logging.py:96:log_dist] [Rank 0] step=13130, skipped=59, lr=[3.666887292382558e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:28:43,337] [INFO] [timer.py:258:stop] epoch=0/micro_step=13130/global_step=13130, RunningAvgSamplesPerSec=4.492926144359348, CurrSamplesPerSec=4.483607663591314, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:28:52,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=13140, skipped=59, lr=[3.660434042709014e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:28:52,383] [INFO] [timer.py:258:stop] epoch=0/micro_step=13140/global_step=13140, RunningAvgSamplesPerSec=4.4929214634060175, CurrSamplesPerSec=4.492833705164965, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:29:01,440] [INFO] [logging.py:96:log_dist] [Rank 0] step=13150, skipped=59, lr=[3.6539853319816056e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:29:01,441] [INFO] [timer.py:258:stop] epoch=0/micro_step=13150/global_step=13150, RunningAvgSamplesPerSec=4.492918479715131, CurrSamplesPerSec=4.48761928402303, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:29:01,441] [INFO] [RANK 0]  iteration    13150/   20000 | elapsed time per iteration (ms): 905.2 | learning rate 3.653E-05 | total loss 3.065552E-01 | loss 3.065552E-01 | loss scale 32768.0 |speed 265.14 samples/(min*GPU)
[2024-06-17 09:29:01,441] [INFO] [RANK 0] time (ms) | forward: 355.10 | backward: 546.06 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 13.15 | data loader: 0.10
[2024-06-17 09:29:10,509] [INFO] [logging.py:96:log_dist] [Rank 0] step=13160, skipped=59, lr=[3.647541176111882e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:29:10,509] [INFO] [timer.py:258:stop] epoch=0/micro_step=13160/global_step=13160, RunningAvgSamplesPerSec=4.492916624388441, CurrSamplesPerSec=4.487667299003133, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:29:19,568] [INFO] [logging.py:96:log_dist] [Rank 0] step=13170, skipped=59, lr=[3.641101591000161e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:29:19,568] [INFO] [timer.py:258:stop] epoch=0/micro_step=13170/global_step=13170, RunningAvgSamplesPerSec=4.4929113329794115, CurrSamplesPerSec=4.487189595695434, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:29:28,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=13180, skipped=59, lr=[3.6346665925354736e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:29:28,625] [INFO] [timer.py:258:stop] epoch=0/micro_step=13180/global_step=13180, RunningAvgSamplesPerSec=4.4929068870452005, CurrSamplesPerSec=4.483920419922814, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:29:37,682] [INFO] [logging.py:96:log_dist] [Rank 0] step=13190, skipped=59, lr=[3.628236196595545e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:29:37,683] [INFO] [timer.py:258:stop] epoch=0/micro_step=13190/global_step=13190, RunningAvgSamplesPerSec=4.492907024056459, CurrSamplesPerSec=4.494895651819797, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:29:46,759] [INFO] [logging.py:96:log_dist] [Rank 0] step=13200, skipped=59, lr=[3.6218104190467314e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:29:46,760] [INFO] [timer.py:258:stop] epoch=0/micro_step=13200/global_step=13200, RunningAvgSamplesPerSec=4.492905053588263, CurrSamplesPerSec=4.481580000395342, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:29:46,760] [INFO] [RANK 0]  iteration    13200/   20000 | elapsed time per iteration (ms): 906.4 | learning rate 3.621E-05 | total loss 3.103973E-01 | loss 3.103973E-01 | loss scale 32768.0 |speed 264.79 samples/(min*GPU)
[2024-06-17 09:29:46,761] [INFO] [RANK 0] time (ms) | forward: 356.67 | backward: 545.80 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.95 | data loader: 0.10
[2024-06-17 09:29:46,761] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:29:46,773] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/13200/mp_rank_00_model_states.pt
[2024-06-17 09:29:46,773] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/13200/mp_rank_00_model_states.pt...
[2024-06-17 09:30:16,684] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/13200/mp_rank_00_model_states.pt.
[2024-06-17 09:30:25,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=13210, skipped=59, lr=[3.6153892757440054e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:30:25,693] [INFO] [timer.py:258:stop] epoch=0/micro_step=13210/global_step=13210, RunningAvgSamplesPerSec=4.492934034026518, CurrSamplesPerSec=4.538586415039011, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:30:34,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=13220, skipped=59, lr=[3.6089727825308986e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:30:34,670] [INFO] [timer.py:258:stop] epoch=0/micro_step=13220/global_step=13220, RunningAvgSamplesPerSec=4.49296259813285, CurrSamplesPerSec=4.525606695124994, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:30:43,682] [INFO] [logging.py:96:log_dist] [Rank 0] step=13230, skipped=59, lr=[3.60256095523947e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:30:43,683] [INFO] [timer.py:258:stop] epoch=0/micro_step=13230/global_step=13230, RunningAvgSamplesPerSec=4.492980020152188, CurrSamplesPerSec=4.5052761832743276, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:30:52,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=13240, skipped=59, lr=[3.596153809690262e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:30:52,692] [INFO] [timer.py:258:stop] epoch=0/micro_step=13240/global_step=13240, RunningAvgSamplesPerSec=4.492991535493431, CurrSamplesPerSec=4.509235791534453, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:31:01,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=13250, skipped=59, lr=[3.589751361692277e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:31:01,727] [INFO] [timer.py:258:stop] epoch=0/micro_step=13250/global_step=13250, RunningAvgSamplesPerSec=4.492999084098459, CurrSamplesPerSec=4.504673770446907, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:31:01,727] [INFO] [RANK 0]  iteration    13250/   20000 | elapsed time per iteration (ms): 1499.3 | learning rate 3.589E-05 | total loss 3.748187E-01 | loss 3.748187E-01 | loss scale 32768.0 |speed 160.07 samples/(min*GPU)
[2024-06-17 09:31:01,728] [INFO] [RANK 0] time (ms) | forward: 354.13 | backward: 542.50 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.75 | data loader: 0.09
[2024-06-17 09:31:10,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=13260, skipped=59, lr=[3.583353627042911e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:31:10,766] [INFO] [timer.py:258:stop] epoch=0/micro_step=13260/global_step=13260, RunningAvgSamplesPerSec=4.493001194673091, CurrSamplesPerSec=4.498662109697084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:31:19,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=13270, skipped=59, lr=[3.576960621527944e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:31:19,840] [INFO] [timer.py:258:stop] epoch=0/micro_step=13270/global_step=13270, RunningAvgSamplesPerSec=4.492999114298154, CurrSamplesPerSec=4.507471877359226, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:31:28,912] [INFO] [logging.py:96:log_dist] [Rank 0] step=13280, skipped=59, lr=[3.570572360921478e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:31:28,913] [INFO] [timer.py:258:stop] epoch=0/micro_step=13280/global_step=13280, RunningAvgSamplesPerSec=4.492995451950116, CurrSamplesPerSec=4.485321768301372, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:31:38,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=13290, skipped=59, lr=[3.564188860985917e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:31:38,288] [INFO] [timer.py:258:stop] epoch=0/micro_step=13290/global_step=13290, RunningAvgSamplesPerSec=4.4928756943955355, CurrSamplesPerSec=4.046743543432285, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:31:47,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=13300, skipped=59, lr=[3.557810137471904e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:31:47,443] [INFO] [timer.py:258:stop] epoch=0/micro_step=13300/global_step=13300, RunningAvgSamplesPerSec=4.492858850276725, CurrSamplesPerSec=4.445641687006159, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:31:47,443] [INFO] [RANK 0]  iteration    13300/   20000 | elapsed time per iteration (ms): 914.3 | learning rate 3.557E-05 | total loss 2.953168E-01 | loss 2.953168E-01 | loss scale 32768.0 |speed 262.49 samples/(min*GPU)
[2024-06-17 09:31:47,444] [INFO] [RANK 0] time (ms) | forward: 360.80 | backward: 549.52 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 16.17 | data loader: 0.23
[2024-06-17 09:31:56,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=13310, skipped=59, lr=[3.551436206118311e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:31:56,503] [INFO] [timer.py:258:stop] epoch=0/micro_step=13310/global_step=13310, RunningAvgSamplesPerSec=4.4928613566944255, CurrSamplesPerSec=4.486672398508295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:32:05,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=13320, skipped=59, lr=[3.545067082652179e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:32:05,582] [INFO] [timer.py:258:stop] epoch=0/micro_step=13320/global_step=13320, RunningAvgSamplesPerSec=4.492858529927657, CurrSamplesPerSec=4.490738790227623, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:32:14,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=13330, skipped=59, lr=[3.538702782788686e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:32:14,642] [INFO] [timer.py:258:stop] epoch=0/micro_step=13330/global_step=13330, RunningAvgSamplesPerSec=4.492858660072375, CurrSamplesPerSec=4.481366920848813, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:32:22,792] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:32:23,694] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:32:23,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=13340, skipped=61, lr=[3.532979050070804e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:32:23,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=13340/global_step=13340, RunningAvgSamplesPerSec=4.492861819228219, CurrSamplesPerSec=4.499081933081275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:32:32,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=13350, skipped=61, lr=[3.5272592486302875e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:32:32,730] [INFO] [timer.py:258:stop] epoch=0/micro_step=13350/global_step=13350, RunningAvgSamplesPerSec=4.492863770035033, CurrSamplesPerSec=4.486486428666934, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:32:32,730] [INFO] [RANK 0]  iteration    13350/   20000 | elapsed time per iteration (ms): 905.7 | learning rate 3.527E-05 | total loss 3.186029E-01 | loss 3.186029E-01 | loss scale 32768.0 |speed 264.98 samples/(min*GPU)
[2024-06-17 09:32:32,730] [INFO] [RANK 0] time (ms) | forward: 356.23 | backward: 545.74 | allreduce: 0.00 | optimizer: 3.05 | batch generator: 15.26 | data loader: 0.14
[2024-06-17 09:32:41,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=13360, skipped=61, lr=[3.520908538357479e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:32:41,767] [INFO] [timer.py:258:stop] epoch=0/micro_step=13360/global_step=13360, RunningAvgSamplesPerSec=4.492865039417118, CurrSamplesPerSec=4.484387838289342, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:32:50,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=13370, skipped=61, lr=[3.5145627112961207e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:32:50,819] [INFO] [timer.py:258:stop] epoch=0/micro_step=13370/global_step=13370, RunningAvgSamplesPerSec=4.492863778156535, CurrSamplesPerSec=4.469025023500904, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:32:59,859] [INFO] [logging.py:96:log_dist] [Rank 0] step=13380, skipped=61, lr=[3.5082217831039014e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:32:59,860] [INFO] [timer.py:258:stop] epoch=0/micro_step=13380/global_step=13380, RunningAvgSamplesPerSec=4.492862782205764, CurrSamplesPerSec=4.492452338096266, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:33:08,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=13390, skipped=61, lr=[3.5018857694264375e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:33:08,933] [INFO] [timer.py:258:stop] epoch=0/micro_step=13390/global_step=13390, RunningAvgSamplesPerSec=4.492857318735809, CurrSamplesPerSec=4.476806136003283, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:33:17,989] [INFO] [logging.py:96:log_dist] [Rank 0] step=13400, skipped=61, lr=[3.4955546858972114e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:33:17,989] [INFO] [timer.py:258:stop] epoch=0/micro_step=13400/global_step=13400, RunningAvgSamplesPerSec=4.492858546753103, CurrSamplesPerSec=4.500311694275662, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:33:17,990] [INFO] [RANK 0]  iteration    13400/   20000 | elapsed time per iteration (ms): 905.2 | learning rate 3.495E-05 | total loss 2.915277E-01 | loss 2.915277E-01 | loss scale 32768.0 |speed 265.14 samples/(min*GPU)
[2024-06-17 09:33:17,990] [INFO] [RANK 0] time (ms) | forward: 355.62 | backward: 545.81 | allreduce: 0.00 | optimizer: 3.08 | batch generator: 14.20 | data loader: 0.12
[2024-06-17 09:33:27,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=13410, skipped=61, lr=[3.4892285481375414e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:33:27,061] [INFO] [timer.py:258:stop] epoch=0/micro_step=13410/global_step=13410, RunningAvgSamplesPerSec=4.492857480570351, CurrSamplesPerSec=4.475687090622093, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:33:36,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=13420, skipped=61, lr=[3.482907371756541e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:33:36,114] [INFO] [timer.py:258:stop] epoch=0/micro_step=13420/global_step=13420, RunningAvgSamplesPerSec=4.49285894129808, CurrSamplesPerSec=4.4955460449243345, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:33:45,164] [INFO] [logging.py:96:log_dist] [Rank 0] step=13430, skipped=61, lr=[3.476591172351091e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:33:45,165] [INFO] [timer.py:258:stop] epoch=0/micro_step=13430/global_step=13430, RunningAvgSamplesPerSec=4.492857212016049, CurrSamplesPerSec=4.482134341544552, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:33:54,236] [INFO] [logging.py:96:log_dist] [Rank 0] step=13440, skipped=61, lr=[3.470279965505782e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:33:54,237] [INFO] [timer.py:258:stop] epoch=0/micro_step=13440/global_step=13440, RunningAvgSamplesPerSec=4.492853906010742, CurrSamplesPerSec=4.501379077938831, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:34:03,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=13450, skipped=61, lr=[3.463973766792889e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:34:03,292] [INFO] [timer.py:258:stop] epoch=0/micro_step=13450/global_step=13450, RunningAvgSamplesPerSec=4.492856754141143, CurrSamplesPerSec=4.499901296873257, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:34:03,293] [INFO] [RANK 0]  iteration    13450/   20000 | elapsed time per iteration (ms): 906.1 | learning rate 3.463E-05 | total loss 3.125916E-01 | loss 3.125916E-01 | loss scale 32768.0 |speed 264.88 samples/(min*GPU)
[2024-06-17 09:34:03,293] [INFO] [RANK 0] time (ms) | forward: 356.65 | backward: 545.55 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 15.21 | data loader: 0.11
[2024-06-17 09:34:12,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=13460, skipped=61, lr=[3.45767259177233e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:34:12,344] [INFO] [timer.py:258:stop] epoch=0/micro_step=13460/global_step=13460, RunningAvgSamplesPerSec=4.492856551238183, CurrSamplesPerSec=4.482518749281956, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:34:21,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=13470, skipped=61, lr=[3.45137645599163e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:34:21,394] [INFO] [timer.py:258:stop] epoch=0/micro_step=13470/global_step=13470, RunningAvgSamplesPerSec=4.492853516894765, CurrSamplesPerSec=4.496559346877603, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:34:30,445] [INFO] [logging.py:96:log_dist] [Rank 0] step=13480, skipped=61, lr=[3.445085374985877e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:34:30,445] [INFO] [timer.py:258:stop] epoch=0/micro_step=13480/global_step=13480, RunningAvgSamplesPerSec=4.492856236497068, CurrSamplesPerSec=4.493195883356776, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:34:39,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=13490, skipped=61, lr=[3.4387993642776886e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:34:39,490] [INFO] [timer.py:258:stop] epoch=0/micro_step=13490/global_step=13490, RunningAvgSamplesPerSec=4.492856864548857, CurrSamplesPerSec=4.495525566716443, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:34:48,532] [INFO] [logging.py:96:log_dist] [Rank 0] step=13500, skipped=61, lr=[3.432518439377169e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:34:48,533] [INFO] [timer.py:258:stop] epoch=0/micro_step=13500/global_step=13500, RunningAvgSamplesPerSec=4.4928567739426075, CurrSamplesPerSec=4.485929811089091, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:34:48,533] [INFO] [RANK 0]  iteration    13500/   20000 | elapsed time per iteration (ms): 904.8 | learning rate 3.432E-05 | total loss 2.996497E-01 | loss 2.996497E-01 | loss scale 32768.0 |speed 265.25 samples/(min*GPU)
[2024-06-17 09:34:48,534] [INFO] [RANK 0] time (ms) | forward: 355.56 | backward: 545.40 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 14.11 | data loader: 0.13
[2024-06-17 09:34:48,534] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:34:48,548] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/13500/mp_rank_00_model_states.pt
[2024-06-17 09:34:48,548] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/13500/mp_rank_00_model_states.pt...
[2024-06-17 09:35:22,527] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/13500/mp_rank_00_model_states.pt.
[2024-06-17 09:35:31,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=13510, skipped=61, lr=[3.426242615781882e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:35:31,546] [INFO] [timer.py:258:stop] epoch=0/micro_step=13510/global_step=13510, RunningAvgSamplesPerSec=4.492885795748195, CurrSamplesPerSec=4.54301689047942, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:35:40,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=13520, skipped=61, lr=[3.4199719089767904e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:35:40,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=13520/global_step=13520, RunningAvgSamplesPerSec=4.49291597284601, CurrSamplesPerSec=4.516127781863365, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:35:49,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=13530, skipped=61, lr=[3.4137063344342455e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:35:49,552] [INFO] [timer.py:258:stop] epoch=0/micro_step=13530/global_step=13530, RunningAvgSamplesPerSec=4.49293276547838, CurrSamplesPerSec=4.515925991124921, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:35:58,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=13540, skipped=61, lr=[3.407445907613927e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:35:58,565] [INFO] [timer.py:258:stop] epoch=0/micro_step=13540/global_step=13540, RunningAvgSamplesPerSec=4.492944931744558, CurrSamplesPerSec=4.506791394951771, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:36:07,594] [INFO] [logging.py:96:log_dist] [Rank 0] step=13550, skipped=61, lr=[3.40119064396282e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:36:07,594] [INFO] [timer.py:258:stop] epoch=0/micro_step=13550/global_step=13550, RunningAvgSamplesPerSec=4.492952874449166, CurrSamplesPerSec=4.487909790349339, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:36:07,595] [INFO] [RANK 0]  iteration    13550/   20000 | elapsed time per iteration (ms): 1581.2 | learning rate 3.401E-05 | total loss 3.409381E-01 | loss 3.409381E-01 | loss scale 32768.0 |speed 151.78 samples/(min*GPU)
[2024-06-17 09:36:07,595] [INFO] [RANK 0] time (ms) | forward: 354.60 | backward: 542.43 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 15.33 | data loader: 0.09
[2024-06-17 09:36:16,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=13560, skipped=61, lr=[3.394940558915159e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:36:16,646] [INFO] [timer.py:258:stop] epoch=0/micro_step=13560/global_step=13560, RunningAvgSamplesPerSec=4.492956600496956, CurrSamplesPerSec=4.504058217766814, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:36:25,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=13570, skipped=61, lr=[3.388695667892413e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:36:25,685] [INFO] [timer.py:258:stop] epoch=0/micro_step=13570/global_step=13570, RunningAvgSamplesPerSec=4.492961392411096, CurrSamplesPerSec=4.505826721408028, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:36:34,737] [INFO] [logging.py:96:log_dist] [Rank 0] step=13580, skipped=61, lr=[3.382455986303228e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:36:34,737] [INFO] [timer.py:258:stop] epoch=0/micro_step=13580/global_step=13580, RunningAvgSamplesPerSec=4.492961699087914, CurrSamplesPerSec=4.501114599740781, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:36:43,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=13590, skipped=61, lr=[3.376221529543397e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:36:43,803] [INFO] [timer.py:258:stop] epoch=0/micro_step=13590/global_step=13590, RunningAvgSamplesPerSec=4.492958169406023, CurrSamplesPerSec=4.494256282086828, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:36:52,898] [INFO] [logging.py:96:log_dist] [Rank 0] step=13600, skipped=61, lr=[3.369992312995822e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:36:52,898] [INFO] [timer.py:258:stop] epoch=0/micro_step=13600/global_step=13600, RunningAvgSamplesPerSec=4.492955319707043, CurrSamplesPerSec=4.471451256025334, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:36:52,899] [INFO] [RANK 0]  iteration    13600/   20000 | elapsed time per iteration (ms): 906.1 | learning rate 3.369E-05 | total loss 2.384958E-01 | loss 2.384958E-01 | loss scale 32768.0 |speed 264.88 samples/(min*GPU)
[2024-06-17 09:36:52,899] [INFO] [RANK 0] time (ms) | forward: 357.07 | backward: 545.00 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 15.44 | data loader: 0.12
[2024-06-17 09:37:01,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=13610, skipped=61, lr=[3.363768352030479e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:37:01,948] [INFO] [timer.py:258:stop] epoch=0/micro_step=13610/global_step=13610, RunningAvgSamplesPerSec=4.492953760177657, CurrSamplesPerSec=4.491222058718419, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:37:11,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=13620, skipped=61, lr=[3.357549662004371e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:37:11,020] [INFO] [timer.py:258:stop] epoch=0/micro_step=13620/global_step=13620, RunningAvgSamplesPerSec=4.492948959082294, CurrSamplesPerSec=4.49585805951971, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:37:20,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=13630, skipped=61, lr=[3.351336258261497e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:37:20,083] [INFO] [timer.py:258:stop] epoch=0/micro_step=13630/global_step=13630, RunningAvgSamplesPerSec=4.492944838163841, CurrSamplesPerSec=4.477212331402849, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:37:29,165] [INFO] [logging.py:96:log_dist] [Rank 0] step=13640, skipped=61, lr=[3.345128156132811e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:37:29,166] [INFO] [timer.py:258:stop] epoch=0/micro_step=13640/global_step=13640, RunningAvgSamplesPerSec=4.4929422500273, CurrSamplesPerSec=4.492543764048223, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:37:38,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=13650, skipped=61, lr=[3.338925370936193e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:37:38,209] [INFO] [timer.py:258:stop] epoch=0/micro_step=13650/global_step=13650, RunningAvgSamplesPerSec=4.49294163624271, CurrSamplesPerSec=4.483335684936486, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:37:38,210] [INFO] [RANK 0]  iteration    13650/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 3.338E-05 | total loss 3.797382E-01 | loss 3.797382E-01 | loss scale 32768.0 |speed 264.84 samples/(min*GPU)
[2024-06-17 09:37:38,210] [INFO] [RANK 0] time (ms) | forward: 356.73 | backward: 545.53 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.69 | data loader: 0.16
[2024-06-17 09:37:47,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=13660, skipped=61, lr=[3.332727917976396e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:37:47,277] [INFO] [timer.py:258:stop] epoch=0/micro_step=13660/global_step=13660, RunningAvgSamplesPerSec=4.492937112618685, CurrSamplesPerSec=4.48145430495347, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:37:56,357] [INFO] [logging.py:96:log_dist] [Rank 0] step=13670, skipped=61, lr=[3.326535812545019e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:37:56,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=13670/global_step=13670, RunningAvgSamplesPerSec=4.492931581859895, CurrSamplesPerSec=4.485766690730195, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:38:05,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=13680, skipped=61, lr=[3.3203490699204645e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:38:05,456] [INFO] [timer.py:258:stop] epoch=0/micro_step=13680/global_step=13680, RunningAvgSamplesPerSec=4.492925388547236, CurrSamplesPerSec=4.495150968895253, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:38:14,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=13690, skipped=61, lr=[3.31416770536791e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:38:14,517] [INFO] [timer.py:258:stop] epoch=0/micro_step=13690/global_step=13690, RunningAvgSamplesPerSec=4.4929208259122095, CurrSamplesPerSec=4.486943582164676, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:38:23,587] [INFO] [logging.py:96:log_dist] [Rank 0] step=13700, skipped=61, lr=[3.307991734139255e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:38:23,587] [INFO] [timer.py:258:stop] epoch=0/micro_step=13700/global_step=13700, RunningAvgSamplesPerSec=4.492915754957424, CurrSamplesPerSec=4.476200563860075, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:38:23,588] [INFO] [RANK 0]  iteration    13700/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 3.307E-05 | total loss 3.303506E-01 | loss 3.303506E-01 | loss scale 32768.0 |speed 264.45 samples/(min*GPU)
[2024-06-17 09:38:23,588] [INFO] [RANK 0] time (ms) | forward: 357.57 | backward: 546.01 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 15.39 | data loader: 0.12
[2024-06-17 09:38:32,662] [INFO] [logging.py:96:log_dist] [Rank 0] step=13710, skipped=61, lr=[3.3018211714730946e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:38:32,662] [INFO] [timer.py:258:stop] epoch=0/micro_step=13710/global_step=13710, RunningAvgSamplesPerSec=4.492907280288074, CurrSamplesPerSec=4.486088145135931, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:38:41,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=13720, skipped=61, lr=[3.2956560325946775e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:38:41,730] [INFO] [timer.py:258:stop] epoch=0/micro_step=13720/global_step=13720, RunningAvgSamplesPerSec=4.492903002678968, CurrSamplesPerSec=4.484734270151439, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:38:50,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=13730, skipped=61, lr=[3.289496332715876e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:38:50,781] [INFO] [timer.py:258:stop] epoch=0/micro_step=13730/global_step=13730, RunningAvgSamplesPerSec=4.492900669137028, CurrSamplesPerSec=4.488938869397026, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:38:59,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=13740, skipped=61, lr=[3.283342087035131e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:38:59,853] [INFO] [timer.py:258:stop] epoch=0/micro_step=13740/global_step=13740, RunningAvgSamplesPerSec=4.492896336369033, CurrSamplesPerSec=4.459368886620736, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:39:00,757] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:39:01,663] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:39:08,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=13750, skipped=63, lr=[3.2784226277179045e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:39:08,917] [INFO] [timer.py:258:stop] epoch=0/micro_step=13750/global_step=13750, RunningAvgSamplesPerSec=4.492896442129033, CurrSamplesPerSec=4.494037180265707, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:39:08,918] [INFO] [RANK 0]  iteration    13750/   20000 | elapsed time per iteration (ms): 906.6 | learning rate 3.278E-05 | total loss 3.138940E-01 | loss 3.138940E-01 | loss scale 32768.0 |speed 264.73 samples/(min*GPU)
[2024-06-17 09:39:08,918] [INFO] [RANK 0] time (ms) | forward: 356.75 | backward: 545.95 | allreduce: 0.00 | optimizer: 3.13 | batch generator: 14.76 | data loader: 0.13
[2024-06-17 09:39:17,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=13760, skipped=63, lr=[3.272278237850772e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:39:17,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=13760/global_step=13760, RunningAvgSamplesPerSec=4.492892061633026, CurrSamplesPerSec=4.481843385138648, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:39:27,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=13770, skipped=63, lr=[3.2661393446656377e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:39:27,048] [INFO] [timer.py:258:stop] epoch=0/micro_step=13770/global_step=13770, RunningAvgSamplesPerSec=4.492886223207093, CurrSamplesPerSec=4.48995640433441, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:39:36,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=13780, skipped=63, lr=[3.260005963309609e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:39:36,109] [INFO] [timer.py:258:stop] epoch=0/micro_step=13780/global_step=13780, RunningAvgSamplesPerSec=4.492880630972722, CurrSamplesPerSec=4.4833009411416995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:39:45,168] [INFO] [logging.py:96:log_dist] [Rank 0] step=13790, skipped=63, lr=[3.2538781089161936e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:39:45,168] [INFO] [timer.py:258:stop] epoch=0/micro_step=13790/global_step=13790, RunningAvgSamplesPerSec=4.49287729448459, CurrSamplesPerSec=4.49023279216782, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:39:54,246] [INFO] [logging.py:96:log_dist] [Rank 0] step=13800, skipped=63, lr=[3.247755796605264e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:39:54,246] [INFO] [timer.py:258:stop] epoch=0/micro_step=13800/global_step=13800, RunningAvgSamplesPerSec=4.492870708304704, CurrSamplesPerSec=4.490848177719341, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:39:54,247] [INFO] [RANK 0]  iteration    13800/   20000 | elapsed time per iteration (ms): 906.6 | learning rate 3.247E-05 | total loss 3.579041E-01 | loss 3.579041E-01 | loss scale 32768.0 |speed 264.73 samples/(min*GPU)
[2024-06-17 09:39:54,247] [INFO] [RANK 0] time (ms) | forward: 356.38 | backward: 546.20 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.39 | data loader: 0.12
[2024-06-17 09:39:54,248] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:39:54,260] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/13800/mp_rank_00_model_states.pt
[2024-06-17 09:39:54,261] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/13800/mp_rank_00_model_states.pt...
[2024-06-17 09:40:24,908] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/13800/mp_rank_00_model_states.pt.
[2024-06-17 09:40:33,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=13810, skipped=63, lr=[3.2416390414830194e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:40:33,914] [INFO] [timer.py:258:stop] epoch=0/micro_step=13810/global_step=13810, RunningAvgSamplesPerSec=4.492899325963041, CurrSamplesPerSec=4.528973639321038, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:40:42,906] [INFO] [logging.py:96:log_dist] [Rank 0] step=13820, skipped=63, lr=[3.23552785864194e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:40:42,906] [INFO] [timer.py:258:stop] epoch=0/micro_step=13820/global_step=13820, RunningAvgSamplesPerSec=4.49291807372646, CurrSamplesPerSec=4.5076244692318355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:40:51,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=13830, skipped=63, lr=[3.2294222631607675e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:40:51,929] [INFO] [timer.py:258:stop] epoch=0/micro_step=13830/global_step=13830, RunningAvgSamplesPerSec=4.492933341183247, CurrSamplesPerSec=4.516604371334025, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:41:00,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=13840, skipped=63, lr=[3.223322270104448e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:41:00,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=13840/global_step=13840, RunningAvgSamplesPerSec=4.492942590351503, CurrSamplesPerSec=4.497076415272868, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:41:10,031] [INFO] [logging.py:96:log_dist] [Rank 0] step=13850, skipped=63, lr=[3.217227894524109e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:41:10,031] [INFO] [timer.py:258:stop] epoch=0/micro_step=13850/global_step=13850, RunningAvgSamplesPerSec=4.492938212990863, CurrSamplesPerSec=4.4863940493804515, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:41:10,032] [INFO] [RANK 0]  iteration    13850/   20000 | elapsed time per iteration (ms): 1515.7 | learning rate 3.217E-05 | total loss 3.088757E-01 | loss 3.088757E-01 | loss scale 32768.0 |speed 158.34 samples/(min*GPU)
[2024-06-17 09:41:10,032] [INFO] [RANK 0] time (ms) | forward: 354.94 | backward: 543.17 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 15.09 | data loader: 0.10
[2024-06-17 09:41:19,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=13860, skipped=63, lr=[3.211139151457018e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:41:19,077] [INFO] [timer.py:258:stop] epoch=0/micro_step=13860/global_step=13860, RunningAvgSamplesPerSec=4.492937876756094, CurrSamplesPerSec=4.486849984100864, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:41:28,129] [INFO] [logging.py:96:log_dist] [Rank 0] step=13870, skipped=63, lr=[3.205056055926539e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:41:28,130] [INFO] [timer.py:258:stop] epoch=0/micro_step=13870/global_step=13870, RunningAvgSamplesPerSec=4.492933051363617, CurrSamplesPerSec=4.4903481641117216, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:41:37,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=13880, skipped=63, lr=[3.19897862294211e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:41:37,180] [INFO] [timer.py:258:stop] epoch=0/micro_step=13880/global_step=13880, RunningAvgSamplesPerSec=4.49292866140012, CurrSamplesPerSec=4.487877376622411, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:41:46,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=13890, skipped=63, lr=[3.1929068674991914e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:41:46,267] [INFO] [timer.py:258:stop] epoch=0/micro_step=13890/global_step=13890, RunningAvgSamplesPerSec=4.492919145973785, CurrSamplesPerSec=4.4838185596215645, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:41:55,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=13900, skipped=63, lr=[3.186840804579236e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:41:55,351] [INFO] [timer.py:258:stop] epoch=0/micro_step=13900/global_step=13900, RunningAvgSamplesPerSec=4.492911030057568, CurrSamplesPerSec=4.48684878415104, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:41:55,351] [INFO] [RANK 0]  iteration    13900/   20000 | elapsed time per iteration (ms): 906.4 | learning rate 3.186E-05 | total loss 3.002789E-01 | loss 3.002789E-01 | loss scale 32768.0 |speed 264.79 samples/(min*GPU)
[2024-06-17 09:41:55,351] [INFO] [RANK 0] time (ms) | forward: 355.75 | backward: 546.61 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 14.03 | data loader: 0.11
[2024-06-17 09:42:04,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=13910, skipped=63, lr=[3.180780449149649e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:42:04,435] [INFO] [timer.py:258:stop] epoch=0/micro_step=13910/global_step=13910, RunningAvgSamplesPerSec=4.492901918598387, CurrSamplesPerSec=4.486372454771172, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:42:13,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=13920, skipped=63, lr=[3.17472581616376e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:42:13,508] [INFO] [timer.py:258:stop] epoch=0/micro_step=13920/global_step=13920, RunningAvgSamplesPerSec=4.492895666660667, CurrSamplesPerSec=4.4896187766782605, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:42:22,565] [INFO] [logging.py:96:log_dist] [Rank 0] step=13930, skipped=63, lr=[3.168676920560768e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:42:22,565] [INFO] [timer.py:258:stop] epoch=0/micro_step=13930/global_step=13930, RunningAvgSamplesPerSec=4.492893245346406, CurrSamplesPerSec=4.4909191021275445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:42:31,634] [INFO] [logging.py:96:log_dist] [Rank 0] step=13940, skipped=63, lr=[3.162633777265726e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:42:31,635] [INFO] [timer.py:258:stop] epoch=0/micro_step=13940/global_step=13940, RunningAvgSamplesPerSec=4.4928910371037505, CurrSamplesPerSec=4.49687993938122, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:42:40,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=13950, skipped=63, lr=[3.156596401189487e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:42:40,698] [INFO] [timer.py:258:stop] epoch=0/micro_step=13950/global_step=13950, RunningAvgSamplesPerSec=4.492886967132301, CurrSamplesPerSec=4.483272188063592, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:42:40,698] [INFO] [RANK 0]  iteration    13950/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 3.156E-05 | total loss 3.173288E-01 | loss 3.173288E-01 | loss scale 32768.0 |speed 264.63 samples/(min*GPU)
[2024-06-17 09:42:40,698] [INFO] [RANK 0] time (ms) | forward: 356.41 | backward: 546.54 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.71 | data loader: 0.11
[2024-06-17 09:42:49,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=13960, skipped=63, lr=[3.150564807228679e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:42:49,762] [INFO] [timer.py:258:stop] epoch=0/micro_step=13960/global_step=13960, RunningAvgSamplesPerSec=4.492878672826653, CurrSamplesPerSec=4.48226366762908, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:42:58,823] [INFO] [logging.py:96:log_dist] [Rank 0] step=13970, skipped=63, lr=[3.144539010265657e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:42:58,823] [INFO] [timer.py:258:stop] epoch=0/micro_step=13970/global_step=13970, RunningAvgSamplesPerSec=4.492871434159401, CurrSamplesPerSec=4.491682582926525, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:43:07,896] [INFO] [logging.py:96:log_dist] [Rank 0] step=13980, skipped=63, lr=[3.138519025168478e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:43:07,896] [INFO] [timer.py:258:stop] epoch=0/micro_step=13980/global_step=13980, RunningAvgSamplesPerSec=4.49286727671913, CurrSamplesPerSec=4.486942382164788, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:43:16,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=13990, skipped=63, lr=[3.132504866790857e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:43:16,972] [INFO] [timer.py:258:stop] epoch=0/micro_step=13990/global_step=13990, RunningAvgSamplesPerSec=4.492861035943508, CurrSamplesPerSec=4.470842365995707, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:43:26,035] [INFO] [logging.py:96:log_dist] [Rank 0] step=14000, skipped=63, lr=[3.126496549972132e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:43:26,036] [INFO] [timer.py:258:stop] epoch=0/micro_step=14000/global_step=14000, RunningAvgSamplesPerSec=4.492855732131977, CurrSamplesPerSec=4.495118450486146, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:43:26,036] [INFO] [RANK 0]  iteration    14000/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 3.126E-05 | total loss 3.053290E-01 | loss 3.053290E-01 | loss scale 32768.0 |speed 264.68 samples/(min*GPU)
[2024-06-17 09:43:26,036] [INFO] [RANK 0] time (ms) | forward: 356.06 | backward: 546.66 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 14.23 | data loader: 0.10
[2024-06-17 09:43:32,701] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 09:43:32,702] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 09:43:32,702] [INFO] [RANK 0]  validation loss at iteration 14000 | loss: 8.333984E-01 | PPL: 2.301126E+00 loss 8.334961E-01 |
[2024-06-17 09:43:32,702] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 09:43:41,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=14010, skipped=63, lr=[3.120494089537225e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:43:41,781] [INFO] [timer.py:258:stop] epoch=0/micro_step=14010/global_step=14010, RunningAvgSamplesPerSec=4.492846416208111, CurrSamplesPerSec=4.476802552254263, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:43:50,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=14020, skipped=63, lr=[3.114497500296613e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:43:50,849] [INFO] [timer.py:258:stop] epoch=0/micro_step=14020/global_step=14020, RunningAvgSamplesPerSec=4.492842634674283, CurrSamplesPerSec=4.486770788789127, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:43:59,919] [INFO] [logging.py:96:log_dist] [Rank 0] step=14030, skipped=63, lr=[3.108506797046285e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:43:59,921] [INFO] [timer.py:258:stop] epoch=0/micro_step=14030/global_step=14030, RunningAvgSamplesPerSec=4.4928351961555215, CurrSamplesPerSec=4.480791228584179, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:44:08,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=14040, skipped=63, lr=[3.102521994567703e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:44:09,000] [INFO] [timer.py:258:stop] epoch=0/micro_step=14040/global_step=14040, RunningAvgSamplesPerSec=4.492825573999021, CurrSamplesPerSec=4.492880628614919, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:44:18,088] [INFO] [logging.py:96:log_dist] [Rank 0] step=14050, skipped=63, lr=[3.0965431076277714e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:44:18,089] [INFO] [timer.py:258:stop] epoch=0/micro_step=14050/global_step=14050, RunningAvgSamplesPerSec=4.492814420116096, CurrSamplesPerSec=4.467165147986753, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:44:18,089] [INFO] [RANK 0]  iteration    14050/   20000 | elapsed time per iteration (ms): 1041.1 | learning rate 3.096E-05 | total loss 2.964090E-01 | loss 2.964090E-01 | loss scale 32768.0 |speed 230.53 samples/(min*GPU)
[2024-06-17 09:44:18,090] [INFO] [RANK 0] time (ms) | forward: 357.08 | backward: 546.64 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 18.09 | data loader: 0.17
[2024-06-17 09:44:27,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=14060, skipped=63, lr=[3.0905701509788034e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:44:27,171] [INFO] [timer.py:258:stop] epoch=0/micro_step=14060/global_step=14060, RunningAvgSamplesPerSec=4.492806420772302, CurrSamplesPerSec=4.45325758884834, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:44:36,248] [INFO] [logging.py:96:log_dist] [Rank 0] step=14070, skipped=63, lr=[3.084603139358473e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:44:36,248] [INFO] [timer.py:258:stop] epoch=0/micro_step=14070/global_step=14070, RunningAvgSamplesPerSec=4.492797748476455, CurrSamplesPerSec=4.479756312084159, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:44:45,313] [INFO] [logging.py:96:log_dist] [Rank 0] step=14080, skipped=63, lr=[3.078642087489789e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:44:45,313] [INFO] [timer.py:258:stop] epoch=0/micro_step=14080/global_step=14080, RunningAvgSamplesPerSec=4.492793687657058, CurrSamplesPerSec=4.483659187494555, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:44:54,393] [INFO] [logging.py:96:log_dist] [Rank 0] step=14090, skipped=63, lr=[3.072687010081051e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:44:54,394] [INFO] [timer.py:258:stop] epoch=0/micro_step=14090/global_step=14090, RunningAvgSamplesPerSec=4.492787412014353, CurrSamplesPerSec=4.490322925992391, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:45:03,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=14100, skipped=63, lr=[3.0667379218258266e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:45:03,492] [INFO] [timer.py:258:stop] epoch=0/micro_step=14100/global_step=14100, RunningAvgSamplesPerSec=4.4927789622934435, CurrSamplesPerSec=4.488051455835916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:45:03,493] [INFO] [RANK 0]  iteration    14100/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 3.066E-05 | total loss 3.081747E-01 | loss 3.081747E-01 | loss scale 32768.0 |speed 264.30 samples/(min*GPU)
[2024-06-17 09:45:03,493] [INFO] [RANK 0] time (ms) | forward: 357.44 | backward: 546.56 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 15.27 | data loader: 0.11
[2024-06-17 09:45:03,493] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:45:03,506] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/14100/mp_rank_00_model_states.pt
[2024-06-17 09:45:03,506] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/14100/mp_rank_00_model_states.pt...
[2024-06-17 09:45:35,599] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/14100/mp_rank_00_model_states.pt.
[2024-06-17 09:45:44,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=14110, skipped=63, lr=[3.060794837402897e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:45:44,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=14110/global_step=14110, RunningAvgSamplesPerSec=4.492805764016324, CurrSamplesPerSec=4.5272626644744385, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:45:53,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=14120, skipped=63, lr=[3.0548577714762306e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:45:53,562] [INFO] [timer.py:258:stop] epoch=0/micro_step=14120/global_step=14120, RunningAvgSamplesPerSec=4.492832862924062, CurrSamplesPerSec=4.511747145335443, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:46:02,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=14130, skipped=63, lr=[3.0489267386949474e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:46:02,563] [INFO] [timer.py:258:stop] epoch=0/micro_step=14130/global_step=14130, RunningAvgSamplesPerSec=4.4928496594299405, CurrSamplesPerSec=4.515225941397821, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:46:11,610] [INFO] [logging.py:96:log_dist] [Rank 0] step=14140, skipped=63, lr=[3.0430017536932862e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:46:11,611] [INFO] [timer.py:258:stop] epoch=0/micro_step=14140/global_step=14140, RunningAvgSamplesPerSec=4.492856943971639, CurrSamplesPerSec=4.505340304969238, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:46:14,322] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:46:15,225] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:46:20,647] [INFO] [logging.py:96:log_dist] [Rank 0] step=14150, skipped=65, lr=[3.0382661299179596e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:46:20,648] [INFO] [timer.py:258:stop] epoch=0/micro_step=14150/global_step=14150, RunningAvgSamplesPerSec=4.49286631545221, CurrSamplesPerSec=4.501761962170875, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:46:20,648] [INFO] [RANK 0]  iteration    14150/   20000 | elapsed time per iteration (ms): 1543.1 | learning rate 3.038E-05 | total loss 3.251761E-01 | loss 3.251761E-01 | loss scale 32768.0 |speed 155.53 samples/(min*GPU)
[2024-06-17 09:46:20,649] [INFO] [RANK 0] time (ms) | forward: 354.26 | backward: 542.38 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.77 | data loader: 0.10
[2024-06-17 09:46:29,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=14160, skipped=65, lr=[3.0323520677502234e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:46:29,712] [INFO] [timer.py:258:stop] epoch=0/micro_step=14160/global_step=14160, RunningAvgSamplesPerSec=4.492867421400496, CurrSamplesPerSec=4.490532050401873, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:46:38,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=14170, skipped=65, lr=[3.026444094258457e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:46:38,774] [INFO] [timer.py:258:stop] epoch=0/micro_step=14170/global_step=14170, RunningAvgSamplesPerSec=4.49286577075815, CurrSamplesPerSec=4.4929937301892515, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:46:47,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=14180, skipped=65, lr=[3.0205422240200005e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:46:47,847] [INFO] [timer.py:258:stop] epoch=0/micro_step=14180/global_step=14180, RunningAvgSamplesPerSec=4.492860502163626, CurrSamplesPerSec=4.487038384184175, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:46:56,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=14190, skipped=65, lr=[3.0146464715971307e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:46:56,922] [INFO] [timer.py:258:stop] epoch=0/micro_step=14190/global_step=14190, RunningAvgSamplesPerSec=4.4928531739715005, CurrSamplesPerSec=4.482910410013886, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:47:05,973] [INFO] [logging.py:96:log_dist] [Rank 0] step=14200, skipped=65, lr=[3.0087568515370308e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:47:05,974] [INFO] [timer.py:258:stop] epoch=0/micro_step=14200/global_step=14200, RunningAvgSamplesPerSec=4.492850186758104, CurrSamplesPerSec=4.4918461338278215, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:47:05,974] [INFO] [RANK 0]  iteration    14200/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 3.008E-05 | total loss 2.672827E-01 | loss 2.672827E-01 | loss scale 32768.0 |speed 264.75 samples/(min*GPU)
[2024-06-17 09:47:05,974] [INFO] [RANK 0] time (ms) | forward: 356.20 | backward: 546.30 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.82 | data loader: 0.11
[2024-06-17 09:47:15,043] [INFO] [logging.py:96:log_dist] [Rank 0] step=14210, skipped=65, lr=[3.002873378371751e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:47:15,044] [INFO] [timer.py:258:stop] epoch=0/micro_step=14210/global_step=14210, RunningAvgSamplesPerSec=4.492844647294044, CurrSamplesPerSec=4.491029700590275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:47:24,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=14220, skipped=65, lr=[2.9969960666181808e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:47:24,103] [INFO] [timer.py:258:stop] epoch=0/micro_step=14220/global_step=14220, RunningAvgSamplesPerSec=4.492841272397964, CurrSamplesPerSec=4.4885089283445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:47:33,191] [INFO] [logging.py:96:log_dist] [Rank 0] step=14230, skipped=65, lr=[2.991124930777997e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:47:33,191] [INFO] [timer.py:258:stop] epoch=0/micro_step=14230/global_step=14230, RunningAvgSamplesPerSec=4.492835361995289, CurrSamplesPerSec=4.479678563103592, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:47:42,497] [INFO] [logging.py:96:log_dist] [Rank 0] step=14240, skipped=65, lr=[2.9852599853376482e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:47:42,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=14240/global_step=14240, RunningAvgSamplesPerSec=4.492807980843656, CurrSamplesPerSec=4.45670474797509, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:47:51,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=14250, skipped=65, lr=[2.9794012447683024e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:47:51,890] [INFO] [timer.py:258:stop] epoch=0/micro_step=14250/global_step=14250, RunningAvgSamplesPerSec=4.492772164420426, CurrSamplesPerSec=4.431549202320848, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:47:51,890] [INFO] [RANK 0]  iteration    14250/   20000 | elapsed time per iteration (ms): 918.3 | learning rate 2.979E-05 | total loss 2.978333E-01 | loss 2.978333E-01 | loss scale 32768.0 |speed 261.35 samples/(min*GPU)
[2024-06-17 09:47:51,896] [INFO] [RANK 0] time (ms) | forward: 366.07 | backward: 548.04 | allreduce: 0.00 | optimizer: 3.41 | batch generator: 22.85 | data loader: 1.98
[2024-06-17 09:48:01,283] [INFO] [logging.py:96:log_dist] [Rank 0] step=14260, skipped=65, lr=[2.9735487235258205e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:48:01,284] [INFO] [timer.py:258:stop] epoch=0/micro_step=14260/global_step=14260, RunningAvgSamplesPerSec=4.492729425340186, CurrSamplesPerSec=4.4470852179592395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:48:10,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=14270, skipped=65, lr=[2.9677024360507136e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:48:10,666] [INFO] [timer.py:258:stop] epoch=0/micro_step=14270/global_step=14270, RunningAvgSamplesPerSec=4.492694477259177, CurrSamplesPerSec=4.430689012523923, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:48:20,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=14280, skipped=65, lr=[2.9618623967681194e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:48:20,030] [INFO] [timer.py:258:stop] epoch=0/micro_step=14280/global_step=14280, RunningAvgSamplesPerSec=4.4926597573049865, CurrSamplesPerSec=4.420918048718274, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:48:29,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=14290, skipped=65, lr=[2.9560286200877527e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:48:29,140] [INFO] [timer.py:258:stop] epoch=0/micro_step=14290/global_step=14290, RunningAvgSamplesPerSec=4.492648209698445, CurrSamplesPerSec=4.4759259007294725, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:48:38,208] [INFO] [logging.py:96:log_dist] [Rank 0] step=14300, skipped=65, lr=[2.950201120403877e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:48:38,208] [INFO] [timer.py:258:stop] epoch=0/micro_step=14300/global_step=14300, RunningAvgSamplesPerSec=4.49264206577121, CurrSamplesPerSec=4.488632618029426, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:48:38,209] [INFO] [RANK 0]  iteration    14300/   20000 | elapsed time per iteration (ms): 926.4 | learning rate 2.950E-05 | total loss 3.542986E-01 | loss 3.542986E-01 | loss scale 32768.0 |speed 259.08 samples/(min*GPU)
[2024-06-17 09:48:38,209] [INFO] [RANK 0] time (ms) | forward: 373.27 | backward: 548.34 | allreduce: 0.00 | optimizer: 3.53 | batch generator: 27.51 | data loader: 2.75
[2024-06-17 09:48:47,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=14310, skipped=65, lr=[2.9443799120952678e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:48:47,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=14310/global_step=14310, RunningAvgSamplesPerSec=4.492636543155297, CurrSamplesPerSec=4.486960382230507, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:48:56,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=14320, skipped=65, lr=[2.9385650095251798e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:48:56,333] [INFO] [timer.py:258:stop] epoch=0/micro_step=14320/global_step=14320, RunningAvgSamplesPerSec=4.492630060151985, CurrSamplesPerSec=4.480550702452214, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:49:05,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=14330, skipped=65, lr=[2.932756427041305e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:49:05,415] [INFO] [timer.py:258:stop] epoch=0/micro_step=14330/global_step=14330, RunningAvgSamplesPerSec=4.492622579485205, CurrSamplesPerSec=4.484036666156182, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:49:14,505] [INFO] [logging.py:96:log_dist] [Rank 0] step=14340, skipped=65, lr=[2.9269541789757457e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:49:14,505] [INFO] [timer.py:258:stop] epoch=0/micro_step=14340/global_step=14340, RunningAvgSamplesPerSec=4.492615073534322, CurrSamplesPerSec=4.476280580764381, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:49:23,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=14350, skipped=65, lr=[2.921158279644969e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:49:23,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=14350/global_step=14350, RunningAvgSamplesPerSec=4.492607004476336, CurrSamplesPerSec=4.4914505053988005, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:49:23,586] [INFO] [RANK 0]  iteration    14350/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 2.921E-05 | total loss 2.910406E-01 | loss 2.910406E-01 | loss scale 32768.0 |speed 264.45 samples/(min*GPU)
[2024-06-17 09:49:23,587] [INFO] [RANK 0] time (ms) | forward: 356.72 | backward: 546.87 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 14.73 | data loader: 0.09
[2024-06-17 09:49:32,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=14360, skipped=65, lr=[2.915368743349783e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:49:32,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=14360/global_step=14360, RunningAvgSamplesPerSec=4.492599446063195, CurrSamplesPerSec=4.48670959432666, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:49:41,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=14370, skipped=65, lr=[2.9095855843752935e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:49:41,759] [INFO] [timer.py:258:stop] epoch=0/micro_step=14370/global_step=14370, RunningAvgSamplesPerSec=4.492593429523228, CurrSamplesPerSec=4.489547893335474, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:49:50,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=14380, skipped=65, lr=[2.9038088169908683e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:49:50,844] [INFO] [timer.py:258:stop] epoch=0/micro_step=14380/global_step=14380, RunningAvgSamplesPerSec=4.492582928828624, CurrSamplesPerSec=4.470909085579352, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:49:59,920] [INFO] [logging.py:96:log_dist] [Rank 0] step=14390, skipped=65, lr=[2.8980384554501056e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:49:59,920] [INFO] [timer.py:258:stop] epoch=0/micro_step=14390/global_step=14390, RunningAvgSamplesPerSec=4.492571982912201, CurrSamplesPerSec=4.470040695310581, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:50:08,986] [INFO] [logging.py:96:log_dist] [Rank 0] step=14400, skipped=65, lr=[2.8922745139908043e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:50:08,987] [INFO] [timer.py:258:stop] epoch=0/micro_step=14400/global_step=14400, RunningAvgSamplesPerSec=4.492559940320842, CurrSamplesPerSec=4.476763131393721, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:50:08,987] [INFO] [RANK 0]  iteration    14400/   20000 | elapsed time per iteration (ms): 908.0 | learning rate 2.892E-05 | total loss 3.730945E-01 | loss 3.730945E-01 | loss scale 32768.0 |speed 264.31 samples/(min*GPU)
[2024-06-17 09:50:08,988] [INFO] [RANK 0] time (ms) | forward: 357.07 | backward: 547.03 | allreduce: 0.00 | optimizer: 3.14 | batch generator: 14.50 | data loader: 0.09
[2024-06-17 09:50:08,988] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:50:09,002] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/14400/mp_rank_00_model_states.pt
[2024-06-17 09:50:09,002] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/14400/mp_rank_00_model_states.pt...
[2024-06-17 09:50:40,908] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/14400/mp_rank_00_model_states.pt.
[2024-06-17 09:50:49,894] [INFO] [logging.py:96:log_dist] [Rank 0] step=14410, skipped=65, lr=[2.8865170068349102e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:50:49,894] [INFO] [timer.py:258:stop] epoch=0/micro_step=14410/global_step=14410, RunningAvgSamplesPerSec=4.492587956690856, CurrSamplesPerSec=4.538437858259298, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:50:58,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=14420, skipped=65, lr=[2.8807659481885046e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:50:58,871] [INFO] [timer.py:258:stop] epoch=0/micro_step=14420/global_step=14420, RunningAvgSamplesPerSec=4.4926095204486955, CurrSamplesPerSec=4.521489126547513, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:51:07,882] [INFO] [logging.py:96:log_dist] [Rank 0] step=14430, skipped=65, lr=[2.8750213522417515e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:51:07,883] [INFO] [timer.py:258:stop] epoch=0/micro_step=14430/global_step=14430, RunningAvgSamplesPerSec=4.492623709776462, CurrSamplesPerSec=4.513952796343899, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:51:16,913] [INFO] [logging.py:96:log_dist] [Rank 0] step=14440, skipped=65, lr=[2.8692832331688705e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:51:16,914] [INFO] [timer.py:258:stop] epoch=0/micro_step=14440/global_step=14440, RunningAvgSamplesPerSec=4.492631897136511, CurrSamplesPerSec=4.50225727182877, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:51:25,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=14450, skipped=65, lr=[2.8635516051280975e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:51:25,947] [INFO] [timer.py:258:stop] epoch=0/micro_step=14450/global_step=14450, RunningAvgSamplesPerSec=4.492637215120285, CurrSamplesPerSec=4.4736952134717365, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:51:25,947] [INFO] [RANK 0]  iteration    14450/   20000 | elapsed time per iteration (ms): 1539.2 | learning rate 2.863E-05 | total loss 3.130313E-01 | loss 3.130313E-01 | loss scale 32768.0 |speed 155.93 samples/(min*GPU)
[2024-06-17 09:51:25,948] [INFO] [RANK 0] time (ms) | forward: 353.83 | backward: 542.73 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 14.01 | data loader: 0.09
[2024-06-17 09:51:35,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=14460, skipped=65, lr=[2.8578264822616594e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:51:35,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=14460/global_step=14460, RunningAvgSamplesPerSec=4.492636616275736, CurrSamplesPerSec=4.477122723140078, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:51:44,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=14470, skipped=65, lr=[2.8521078786957254e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:51:44,072] [INFO] [timer.py:258:stop] epoch=0/micro_step=14470/global_step=14470, RunningAvgSamplesPerSec=4.492632018472572, CurrSamplesPerSec=4.486961582240023, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:51:53,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=14480, skipped=65, lr=[2.8463958085403817e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:51:53,141] [INFO] [timer.py:258:stop] epoch=0/micro_step=14480/global_step=14480, RunningAvgSamplesPerSec=4.492625496496272, CurrSamplesPerSec=4.452275522167678, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:52:02,230] [INFO] [logging.py:96:log_dist] [Rank 0] step=14490, skipped=65, lr=[2.8406902858895918e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:52:02,231] [INFO] [timer.py:258:stop] epoch=0/micro_step=14490/global_step=14490, RunningAvgSamplesPerSec=4.49261663542746, CurrSamplesPerSec=4.485364937500584, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:52:11,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=14500, skipped=65, lr=[2.8349913248211685e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:52:11,338] [INFO] [timer.py:258:stop] epoch=0/micro_step=14500/global_step=14500, RunningAvgSamplesPerSec=4.492609200167767, CurrSamplesPerSec=4.4763737383763065, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:52:11,338] [INFO] [RANK 0]  iteration    14500/   20000 | elapsed time per iteration (ms): 907.8 | learning rate 2.834E-05 | total loss 2.792163E-01 | loss 2.792163E-01 | loss scale 32768.0 |speed 264.37 samples/(min*GPU)
[2024-06-17 09:52:11,339] [INFO] [RANK 0] time (ms) | forward: 357.25 | backward: 546.62 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 15.37 | data loader: 0.10
[2024-06-17 09:52:20,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=14510, skipped=65, lr=[2.829298939396731e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:52:20,431] [INFO] [timer.py:258:stop] epoch=0/micro_step=14510/global_step=14510, RunningAvgSamplesPerSec=4.492601646570894, CurrSamplesPerSec=4.490749608533305, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:52:29,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=14520, skipped=65, lr=[2.823613143661674e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:52:29,531] [INFO] [timer.py:258:stop] epoch=0/micro_step=14520/global_step=14520, RunningAvgSamplesPerSec=4.492591441555578, CurrSamplesPerSec=4.479500348700729, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:52:38,897] [INFO] [logging.py:96:log_dist] [Rank 0] step=14530, skipped=65, lr=[2.817933951645131e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:52:38,898] [INFO] [timer.py:258:stop] epoch=0/micro_step=14530/global_step=14530, RunningAvgSamplesPerSec=4.492557292263251, CurrSamplesPerSec=4.447208992805088, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:52:48,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=14540, skipped=65, lr=[2.8122613773599483e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:52:48,252] [INFO] [timer.py:258:stop] epoch=0/micro_step=14540/global_step=14540, RunningAvgSamplesPerSec=4.492530684777374, CurrSamplesPerSec=4.454000039821864, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:52:52,957] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:52:53,878] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:52:57,630] [INFO] [logging.py:96:log_dist] [Rank 0] step=14550, skipped=67, lr=[2.8077280921045865e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:52:57,631] [INFO] [timer.py:258:stop] epoch=0/micro_step=14550/global_step=14550, RunningAvgSamplesPerSec=4.492500450518118, CurrSamplesPerSec=4.455433623073097, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:52:57,631] [INFO] [RANK 0]  iteration    14550/   20000 | elapsed time per iteration (ms): 925.9 | learning rate 2.807E-05 | total loss 2.678908E-01 | loss 2.678908E-01 | loss scale 32768.0 |speed 259.22 samples/(min*GPU)
[2024-06-17 09:52:57,633] [INFO] [RANK 0] time (ms) | forward: 373.25 | backward: 548.26 | allreduce: 0.00 | optimizer: 3.48 | batch generator: 28.42 | data loader: 2.72
[2024-06-17 09:53:06,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=14560, skipped=67, lr=[2.802067464996066e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:53:06,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=14560/global_step=14560, RunningAvgSamplesPerSec=4.492452224312769, CurrSamplesPerSec=4.425322425574062, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:53:16,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=14570, skipped=67, lr=[2.796413494767881e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:53:16,359] [INFO] [timer.py:258:stop] epoch=0/micro_step=14570/global_step=14570, RunningAvgSamplesPerSec=4.492414860301777, CurrSamplesPerSec=4.451047071664198, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:53:25,445] [INFO] [logging.py:96:log_dist] [Rank 0] step=14580, skipped=67, lr=[2.790766195370643e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:53:25,446] [INFO] [timer.py:258:stop] epoch=0/micro_step=14580/global_step=14580, RunningAvgSamplesPerSec=4.492405805477665, CurrSamplesPerSec=4.488630216223071, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:53:34,537] [INFO] [logging.py:96:log_dist] [Rank 0] step=14590, skipped=67, lr=[2.7851255807385018e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:53:34,537] [INFO] [timer.py:258:stop] epoch=0/micro_step=14590/global_step=14590, RunningAvgSamplesPerSec=4.492399882630583, CurrSamplesPerSec=4.477722569464925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:53:43,605] [INFO] [logging.py:96:log_dist] [Rank 0] step=14600, skipped=67, lr=[2.779491664789111e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:53:43,606] [INFO] [timer.py:258:stop] epoch=0/micro_step=14600/global_step=14600, RunningAvgSamplesPerSec=4.492393784732081, CurrSamplesPerSec=4.488152307903027, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:53:43,606] [INFO] [RANK 0]  iteration    14600/   20000 | elapsed time per iteration (ms): 919.5 | learning rate 2.779E-05 | total loss 3.176202E-01 | loss 3.176202E-01 | loss scale 32768.0 |speed 261.01 samples/(min*GPU)
[2024-06-17 09:53:43,606] [INFO] [RANK 0] time (ms) | forward: 367.05 | backward: 548.11 | allreduce: 0.00 | optimizer: 3.45 | batch generator: 22.39 | data loader: 1.57
[2024-06-17 09:53:52,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=14610, skipped=67, lr=[2.773864461423601e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:53:52,690] [INFO] [timer.py:258:stop] epoch=0/micro_step=14610/global_step=14610, RunningAvgSamplesPerSec=4.492386649401738, CurrSamplesPerSec=4.480058960736902, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:54:01,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=14620, skipped=67, lr=[2.7682439845265333e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:54:01,746] [INFO] [timer.py:258:stop] epoch=0/micro_step=14620/global_step=14620, RunningAvgSamplesPerSec=4.492381241817331, CurrSamplesPerSec=4.485059173574928, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:54:10,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=14630, skipped=67, lr=[2.7626302479658812e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:54:10,815] [INFO] [timer.py:258:stop] epoch=0/micro_step=14630/global_step=14630, RunningAvgSamplesPerSec=4.492376240141626, CurrSamplesPerSec=4.493151359966234, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:54:19,881] [INFO] [logging.py:96:log_dist] [Rank 0] step=14640, skipped=67, lr=[2.757023265592975e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:54:19,881] [INFO] [timer.py:258:stop] epoch=0/micro_step=14640/global_step=14640, RunningAvgSamplesPerSec=4.492371273333175, CurrSamplesPerSec=4.474584118671367, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:54:28,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=14650, skipped=67, lr=[2.7514230512424908e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:54:28,964] [INFO] [timer.py:258:stop] epoch=0/micro_step=14650/global_step=14650, RunningAvgSamplesPerSec=4.4923626870388516, CurrSamplesPerSec=4.46992040995812, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:54:28,964] [INFO] [RANK 0]  iteration    14650/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 2.751E-05 | total loss 3.389630E-01 | loss 3.389630E-01 | loss scale 32768.0 |speed 264.56 samples/(min*GPU)
[2024-06-17 09:54:28,965] [INFO] [RANK 0] time (ms) | forward: 356.19 | backward: 547.04 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 14.47 | data loader: 0.10
[2024-06-17 09:54:38,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=14660, skipped=67, lr=[2.7458296187324006e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:54:38,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=14660/global_step=14660, RunningAvgSamplesPerSec=4.492351078337886, CurrSamplesPerSec=4.456080930333364, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:54:47,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=14670, skipped=67, lr=[2.7402429818639417e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:54:47,143] [INFO] [timer.py:258:stop] epoch=0/micro_step=14670/global_step=14670, RunningAvgSamplesPerSec=4.492341246230225, CurrSamplesPerSec=4.486421642794836, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:54:56,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=14680, skipped=67, lr=[2.7346631544215834e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:54:56,225] [INFO] [timer.py:258:stop] epoch=0/micro_step=14680/global_step=14680, RunningAvgSamplesPerSec=4.492329675850386, CurrSamplesPerSec=4.4650216089147055, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:55:05,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=14690, skipped=67, lr=[2.7290901501730008e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:55:05,312] [INFO] [timer.py:258:stop] epoch=0/micro_step=14690/global_step=14690, RunningAvgSamplesPerSec=4.492321061078809, CurrSamplesPerSec=4.47717290332532, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:55:14,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=14700, skipped=67, lr=[2.7235239828690235e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:55:14,380] [INFO] [timer.py:258:stop] epoch=0/micro_step=14700/global_step=14700, RunningAvgSamplesPerSec=4.492315745221291, CurrSamplesPerSec=4.483974347838288, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:55:14,380] [INFO] [RANK 0]  iteration    14700/   20000 | elapsed time per iteration (ms): 908.3 | learning rate 2.723E-05 | total loss 3.519525E-01 | loss 3.519525E-01 | loss scale 32768.0 |speed 264.23 samples/(min*GPU)
[2024-06-17 09:55:14,380] [INFO] [RANK 0] time (ms) | forward: 357.49 | backward: 546.85 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.69 | data loader: 0.14
[2024-06-17 09:55:14,381] [INFO] [RANK 0] Saving Model...
[2024-06-17 09:55:14,393] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/14700/mp_rank_00_model_states.pt
[2024-06-17 09:55:14,393] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/14700/mp_rank_00_model_states.pt...
[2024-06-17 09:55:46,739] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/14700/mp_rank_00_model_states.pt.
[2024-06-17 09:55:55,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=14710, skipped=67, lr=[2.7179646662436173e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:55:55,846] [INFO] [timer.py:258:stop] epoch=0/micro_step=14710/global_step=14710, RunningAvgSamplesPerSec=4.492328406978041, CurrSamplesPerSec=4.510545081480199, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:56:05,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=14720, skipped=67, lr=[2.712412214013841e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:56:05,098] [INFO] [timer.py:258:stop] epoch=0/micro_step=14720/global_step=14720, RunningAvgSamplesPerSec=4.49232878474882, CurrSamplesPerSec=4.463749298931396, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:56:14,330] [INFO] [logging.py:96:log_dist] [Rank 0] step=14730, skipped=67, lr=[2.7068666398798237e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:56:14,331] [INFO] [timer.py:258:stop] epoch=0/micro_step=14730/global_step=14730, RunningAvgSamplesPerSec=4.492327211570284, CurrSamplesPerSec=4.5134306258299315, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:56:23,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=14740, skipped=67, lr=[2.701327957524714e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:56:23,581] [INFO] [timer.py:258:stop] epoch=0/micro_step=14740/global_step=14740, RunningAvgSamplesPerSec=4.49232736437446, CurrSamplesPerSec=4.485908220948657, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:56:32,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=14750, skipped=67, lr=[2.695796180614662e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:56:32,858] [INFO] [timer.py:258:stop] epoch=0/micro_step=14750/global_step=14750, RunningAvgSamplesPerSec=4.49230969762336, CurrSamplesPerSec=4.458055965060898, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:56:32,858] [INFO] [RANK 0]  iteration    14750/   20000 | elapsed time per iteration (ms): 1569.6 | learning rate 2.695E-05 | total loss 3.038324E-01 | loss 3.038324E-01 | loss scale 32768.0 |speed 152.91 samples/(min*GPU)
[2024-06-17 09:56:32,859] [INFO] [RANK 0] time (ms) | forward: 373.26 | backward: 544.20 | allreduce: 0.00 | optimizer: 3.70 | batch generator: 30.71 | data loader: 2.07
[2024-06-17 09:56:42,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=14760, skipped=67, lr=[2.6902713227987745e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:56:42,096] [INFO] [timer.py:258:stop] epoch=0/micro_step=14760/global_step=14760, RunningAvgSamplesPerSec=4.492287718521969, CurrSamplesPerSec=4.475271621776263, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:56:51,164] [INFO] [logging.py:96:log_dist] [Rank 0] step=14770, skipped=67, lr=[2.6847533977090933e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:56:51,165] [INFO] [timer.py:258:stop] epoch=0/micro_step=14770/global_step=14770, RunningAvgSamplesPerSec=4.492283882169213, CurrSamplesPerSec=4.491063362073235, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:57:00,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=14780, skipped=67, lr=[2.6792424189605476e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:57:00,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=14780/global_step=14780, RunningAvgSamplesPerSec=4.492279079890636, CurrSamplesPerSec=4.4811897690121585, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:57:09,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=14790, skipped=67, lr=[2.6737384001509306e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:57:09,359] [INFO] [timer.py:258:stop] epoch=0/micro_step=14790/global_step=14790, RunningAvgSamplesPerSec=4.492270519062832, CurrSamplesPerSec=4.4868523840024395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:57:18,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=14800, skipped=67, lr=[2.668241354860858e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:57:18,452] [INFO] [timer.py:258:stop] epoch=0/micro_step=14800/global_step=14800, RunningAvgSamplesPerSec=4.492258941182959, CurrSamplesPerSec=4.477864787679825, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:57:18,453] [INFO] [RANK 0]  iteration    14800/   20000 | elapsed time per iteration (ms): 911.9 | learning rate 2.668E-05 | total loss 2.855009E-01 | loss 2.855009E-01 | loss scale 32768.0 |speed 263.19 samples/(min*GPU)
[2024-06-17 09:57:18,453] [INFO] [RANK 0] time (ms) | forward: 360.55 | backward: 547.15 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 17.97 | data loader: 0.14
[2024-06-17 09:57:27,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=14810, skipped=67, lr=[2.6627512966537493e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:57:27,515] [INFO] [timer.py:258:stop] epoch=0/micro_step=14810/global_step=14810, RunningAvgSamplesPerSec=4.492255143285919, CurrSamplesPerSec=4.490164292881159, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:57:36,594] [INFO] [logging.py:96:log_dist] [Rank 0] step=14820, skipped=67, lr=[2.6572682390757706e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:57:36,595] [INFO] [timer.py:258:stop] epoch=0/micro_step=14820/global_step=14820, RunningAvgSamplesPerSec=4.492246466755428, CurrSamplesPerSec=4.486089344678944, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:57:45,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=14830, skipped=67, lr=[2.6517921956558254e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:57:45,666] [INFO] [timer.py:258:stop] epoch=0/micro_step=14830/global_step=14830, RunningAvgSamplesPerSec=4.492243037636005, CurrSamplesPerSec=4.490238800976883, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:57:54,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=14840, skipped=67, lr=[2.6463231799055055e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:57:54,741] [INFO] [timer.py:258:stop] epoch=0/micro_step=14840/global_step=14840, RunningAvgSamplesPerSec=4.492235696517285, CurrSamplesPerSec=4.4823546793475835, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:58:03,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=14850, skipped=67, lr=[2.640861205319064e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:58:03,839] [INFO] [timer.py:258:stop] epoch=0/micro_step=14850/global_step=14850, RunningAvgSamplesPerSec=4.492227471614563, CurrSamplesPerSec=4.483389598787627, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:58:03,840] [INFO] [RANK 0]  iteration    14850/   20000 | elapsed time per iteration (ms): 907.7 | learning rate 2.640E-05 | total loss 3.061359E-01 | loss 3.061359E-01 | loss scale 32768.0 |speed 264.39 samples/(min*GPU)
[2024-06-17 09:58:03,840] [INFO] [RANK 0] time (ms) | forward: 356.77 | backward: 546.93 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.94 | data loader: 0.10
[2024-06-17 09:58:12,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=14860, skipped=67, lr=[2.6354062853733783e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:58:12,908] [INFO] [timer.py:258:stop] epoch=0/micro_step=14860/global_step=14860, RunningAvgSamplesPerSec=4.49222064181386, CurrSamplesPerSec=4.474166468211479, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:58:21,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=14870, skipped=67, lr=[2.629958433527923e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:58:21,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=14870/global_step=14870, RunningAvgSamplesPerSec=4.492211409513253, CurrSamplesPerSec=4.482691215299468, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:58:31,066] [INFO] [logging.py:96:log_dist] [Rank 0] step=14880, skipped=67, lr=[2.6245176632247315e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:58:31,067] [INFO] [timer.py:258:stop] epoch=0/micro_step=14880/global_step=14880, RunningAvgSamplesPerSec=4.492206048566706, CurrSamplesPerSec=4.4770056404154435, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:58:40,120] [INFO] [logging.py:96:log_dist] [Rank 0] step=14890, skipped=67, lr=[2.6190839878883626e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:58:40,121] [INFO] [timer.py:258:stop] epoch=0/micro_step=14890/global_step=14890, RunningAvgSamplesPerSec=4.492199484911554, CurrSamplesPerSec=4.48045378131063, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:58:49,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=14900, skipped=67, lr=[2.6136574209258685e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:58:49,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=14900/global_step=14900, RunningAvgSamplesPerSec=4.492191003557831, CurrSamplesPerSec=4.480597369682581, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:58:49,199] [INFO] [RANK 0]  iteration    14900/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 2.613E-05 | total loss 3.145531E-01 | loss 3.145531E-01 | loss scale 32768.0 |speed 264.56 samples/(min*GPU)
[2024-06-17 09:58:49,199] [INFO] [RANK 0] time (ms) | forward: 356.33 | backward: 546.87 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.11 | data loader: 0.11
[2024-06-17 09:58:58,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=14910, skipped=67, lr=[2.608237975726767e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:58:58,268] [INFO] [timer.py:258:stop] epoch=0/micro_step=14910/global_step=14910, RunningAvgSamplesPerSec=4.4921872437413235, CurrSamplesPerSec=4.492256266037111, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:59:07,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=14920, skipped=67, lr=[2.602825665662999e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:59:07,362] [INFO] [timer.py:258:stop] epoch=0/micro_step=14920/global_step=14920, RunningAvgSamplesPerSec=4.492181451832236, CurrSamplesPerSec=4.48078285161821, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:59:16,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=14930, skipped=67, lr=[2.597420504088901e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:59:16,467] [INFO] [timer.py:258:stop] epoch=0/micro_step=14930/global_step=14930, RunningAvgSamplesPerSec=4.492168221192854, CurrSamplesPerSec=4.461032477610702, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:59:25,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=14940, skipped=67, lr=[2.5920225043411707e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:59:25,541] [INFO] [timer.py:258:stop] epoch=0/micro_step=14940/global_step=14940, RunningAvgSamplesPerSec=4.4921628455726745, CurrSamplesPerSec=4.485851847672839, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:59:31,883] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 09:59:32,786] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 09:59:34,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=14950, skipped=69, lr=[2.587709270008955e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:59:34,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=14950/global_step=14950, RunningAvgSamplesPerSec=4.492160707266166, CurrSamplesPerSec=4.489064985048238, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:59:34,597] [INFO] [RANK 0]  iteration    14950/   20000 | elapsed time per iteration (ms): 908.0 | learning rate 2.587E-05 | total loss 3.286530E-01 | loss 3.286530E-01 | loss scale 32768.0 |speed 264.32 samples/(min*GPU)
[2024-06-17 09:59:34,598] [INFO] [RANK 0] time (ms) | forward: 357.30 | backward: 546.70 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 15.12 | data loader: 0.10
[2024-06-17 09:59:43,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=14960, skipped=69, lr=[2.5823241951007457e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:59:43,650] [INFO] [timer.py:258:stop] epoch=0/micro_step=14960/global_step=14960, RunningAvgSamplesPerSec=4.492157550598319, CurrSamplesPerSec=4.492893863611349, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 09:59:52,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=14970, skipped=69, lr=[2.5769463192675462e-05], mom=[[0.9, 0.95]]
[2024-06-17 09:59:52,699] [INFO] [timer.py:258:stop] epoch=0/micro_step=14970/global_step=14970, RunningAvgSamplesPerSec=4.492152330317704, CurrSamplesPerSec=4.4769590479733194, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:00:01,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=14980, skipped=69, lr=[2.571575655778731e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:00:01,757] [INFO] [timer.py:258:stop] epoch=0/micro_step=14980/global_step=14980, RunningAvgSamplesPerSec=4.492147335445198, CurrSamplesPerSec=4.489343665710494, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:00:10,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=14990, skipped=69, lr=[2.566212217885881e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:00:10,817] [INFO] [timer.py:258:stop] epoch=0/micro_step=14990/global_step=14990, RunningAvgSamplesPerSec=4.492140708791331, CurrSamplesPerSec=4.4677766060567325, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:00:19,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=15000, skipped=69, lr=[2.560856018822744e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:00:19,907] [INFO] [timer.py:258:stop] epoch=0/micro_step=15000/global_step=15000, RunningAvgSamplesPerSec=4.4921302825737195, CurrSamplesPerSec=4.474964845158661, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:00:19,908] [INFO] [RANK 0]  iteration    15000/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 2.560E-05 | total loss 3.148941E-01 | loss 3.148941E-01 | loss scale 32768.0 |speed 264.84 samples/(min*GPU)
[2024-06-17 10:00:19,908] [INFO] [RANK 0] time (ms) | forward: 355.46 | backward: 546.73 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 13.46 | data loader: 0.09
[2024-06-17 10:00:19,908] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:00:19,921] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/15000/mp_rank_00_model_states.pt
[2024-06-17 10:00:19,921] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/15000/mp_rank_00_model_states.pt...
[2024-06-17 10:00:52,355] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/15000/mp_rank_00_model_states.pt.
[2024-06-17 10:00:58,960] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 10:00:58,960] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 10:00:58,960] [INFO] [RANK 0]  validation loss at iteration 15000 | loss: 7.683105E-01 | PPL: 2.156121E+00 loss 7.685547E-01 |
[2024-06-17 10:00:58,960] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 10:01:07,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=15010, skipped=69, lr=[2.5555070718052076e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:01:07,951] [INFO] [timer.py:258:stop] epoch=0/micro_step=15010/global_step=15010, RunningAvgSamplesPerSec=4.4921572810371195, CurrSamplesPerSec=4.516356337730916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:01:16,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=15020, skipped=69, lr=[2.5501653900312676e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:01:16,972] [INFO] [timer.py:258:stop] epoch=0/micro_step=15020/global_step=15020, RunningAvgSamplesPerSec=4.492172143049581, CurrSamplesPerSec=4.504630228775455, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:01:25,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=15030, skipped=69, lr=[2.5448309866809946e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:01:25,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=15030/global_step=15030, RunningAvgSamplesPerSec=4.492184421695174, CurrSamplesPerSec=4.508019318375403, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:01:35,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=15040, skipped=69, lr=[2.5395038749164976e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:01:35,051] [INFO] [timer.py:258:stop] epoch=0/micro_step=15040/global_step=15040, RunningAvgSamplesPerSec=4.492189079294148, CurrSamplesPerSec=4.495966491720073, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:01:44,086] [INFO] [logging.py:96:log_dist] [Rank 0] step=15050, skipped=69, lr=[2.5341840678818948e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:01:44,087] [INFO] [timer.py:258:stop] epoch=0/micro_step=15050/global_step=15050, RunningAvgSamplesPerSec=4.492192441816441, CurrSamplesPerSec=4.496166502610648, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:01:44,087] [INFO] [RANK 0]  iteration    15050/   20000 | elapsed time per iteration (ms): 1683.6 | learning rate 2.534E-05 | total loss 3.320120E-01 | loss 3.320120E-01 | loss scale 32768.0 |speed 142.55 samples/(min*GPU)
[2024-06-17 10:01:44,088] [INFO] [RANK 0] time (ms) | forward: 355.37 | backward: 543.23 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 18.73 | data loader: 0.14
[2024-06-17 10:01:53,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=15060, skipped=69, lr=[2.5288715787032798e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:01:53,138] [INFO] [timer.py:258:stop] epoch=0/micro_step=15060/global_step=15060, RunningAvgSamplesPerSec=4.492194567192237, CurrSamplesPerSec=4.499390818700512, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:02:02,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=15070, skipped=69, lr=[2.523566420488696e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:02:02,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=15070/global_step=15070, RunningAvgSamplesPerSec=4.492198754677745, CurrSamplesPerSec=4.4895490947294165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:02:11,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=15080, skipped=69, lr=[2.5182686063280887e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:02:11,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=15080/global_step=15080, RunningAvgSamplesPerSec=4.492199858264274, CurrSamplesPerSec=4.497786523435668, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:02:20,317] [INFO] [logging.py:96:log_dist] [Rank 0] step=15090, skipped=69, lr=[2.5129781492932913e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:02:20,317] [INFO] [timer.py:258:stop] epoch=0/micro_step=15090/global_step=15090, RunningAvgSamplesPerSec=4.492199485092369, CurrSamplesPerSec=4.484179285747886, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:02:29,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=15100, skipped=69, lr=[2.507695062437978e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:02:29,382] [INFO] [timer.py:258:stop] epoch=0/micro_step=15100/global_step=15100, RunningAvgSamplesPerSec=4.492197596192277, CurrSamplesPerSec=4.491383171330262, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:02:29,382] [INFO] [RANK 0]  iteration    15100/   20000 | elapsed time per iteration (ms): 905.9 | learning rate 2.507E-05 | total loss 3.393750E-01 | loss 3.393750E-01 | loss scale 32768.0 |speed 264.93 samples/(min*GPU)
[2024-06-17 10:02:29,383] [INFO] [RANK 0] time (ms) | forward: 356.32 | backward: 545.68 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 15.36 | data loader: 0.10
[2024-06-17 10:02:38,423] [INFO] [logging.py:96:log_dist] [Rank 0] step=15110, skipped=69, lr=[2.5024193587976446e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:02:38,424] [INFO] [timer.py:258:stop] epoch=0/micro_step=15110/global_step=15110, RunningAvgSamplesPerSec=4.492199382718212, CurrSamplesPerSec=4.492465570569522, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:02:47,481] [INFO] [logging.py:96:log_dist] [Rank 0] step=15120, skipped=69, lr=[2.49715105138956e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:02:47,481] [INFO] [timer.py:258:stop] epoch=0/micro_step=15120/global_step=15120, RunningAvgSamplesPerSec=4.492197069616475, CurrSamplesPerSec=4.4840462537434504, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:02:56,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=15130, skipped=69, lr=[2.491890153212753e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:02:56,525] [INFO] [timer.py:258:stop] epoch=0/micro_step=15130/global_step=15130, RunningAvgSamplesPerSec=4.492194530112485, CurrSamplesPerSec=4.481782325009851, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:03:05,565] [INFO] [logging.py:96:log_dist] [Rank 0] step=15140, skipped=69, lr=[2.486636677247966e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:03:05,566] [INFO] [timer.py:258:stop] epoch=0/micro_step=15140/global_step=15140, RunningAvgSamplesPerSec=4.492191566412302, CurrSamplesPerSec=4.482658876910289, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:03:14,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=15150, skipped=69, lr=[2.4813906364576275e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:03:14,614] [INFO] [timer.py:258:stop] epoch=0/micro_step=15150/global_step=15150, RunningAvgSamplesPerSec=4.49218555379681, CurrSamplesPerSec=4.481511764852012, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:03:14,615] [INFO] [RANK 0]  iteration    15150/   20000 | elapsed time per iteration (ms): 904.7 | learning rate 2.481E-05 | total loss 3.554004E-01 | loss 3.554004E-01 | loss scale 32768.0 |speed 265.29 samples/(min*GPU)
[2024-06-17 10:03:14,615] [INFO] [RANK 0] time (ms) | forward: 354.76 | backward: 545.93 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 13.02 | data loader: 0.09
[2024-06-17 10:03:23,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=15160, skipped=69, lr=[2.4761520437858213e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:03:23,697] [INFO] [timer.py:258:stop] epoch=0/micro_step=15160/global_step=15160, RunningAvgSamplesPerSec=4.4921814217357126, CurrSamplesPerSec=4.485990984282255, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:03:32,778] [INFO] [logging.py:96:log_dist] [Rank 0] step=15170, skipped=69, lr=[2.4709209121582572e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:03:32,779] [INFO] [timer.py:258:stop] epoch=0/micro_step=15170/global_step=15170, RunningAvgSamplesPerSec=4.4921800697905825, CurrSamplesPerSec=4.489848261835309, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:03:41,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=15180, skipped=69, lr=[2.4656972544822296e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:03:41,838] [INFO] [timer.py:258:stop] epoch=0/micro_step=15180/global_step=15180, RunningAvgSamplesPerSec=4.4921768033710485, CurrSamplesPerSec=4.4934124962236215, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:03:50,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=15190, skipped=69, lr=[2.4604810836465963e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:03:50,889] [INFO] [timer.py:258:stop] epoch=0/micro_step=15190/global_step=15190, RunningAvgSamplesPerSec=4.4921742621611465, CurrSamplesPerSec=4.484781024570948, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:03:59,945] [INFO] [logging.py:96:log_dist] [Rank 0] step=15200, skipped=69, lr=[2.4552724125217377e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:03:59,946] [INFO] [timer.py:258:stop] epoch=0/micro_step=15200/global_step=15200, RunningAvgSamplesPerSec=4.492169073442538, CurrSamplesPerSec=4.484757047823783, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:03:59,947] [INFO] [RANK 0]  iteration    15200/   20000 | elapsed time per iteration (ms): 906.6 | learning rate 2.455E-05 | total loss 3.200500E-01 | loss 3.200500E-01 | loss scale 32768.0 |speed 264.72 samples/(min*GPU)
[2024-06-17 10:03:59,947] [INFO] [RANK 0] time (ms) | forward: 356.78 | backward: 545.86 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 14.73 | data loader: 0.10
[2024-06-17 10:04:08,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=15210, skipped=69, lr=[2.450071253959535e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:04:08,998] [INFO] [timer.py:258:stop] epoch=0/micro_step=15210/global_step=15210, RunningAvgSamplesPerSec=4.49216898691055, CurrSamplesPerSec=4.4823546793475835, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:04:18,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=15220, skipped=69, lr=[2.444877620793328e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:04:18,067] [INFO] [timer.py:258:stop] epoch=0/micro_step=15220/global_step=15220, RunningAvgSamplesPerSec=4.492164909957867, CurrSamplesPerSec=4.488238756139581, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:04:27,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=15230, skipped=69, lr=[2.4396915258378918e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:04:27,124] [INFO] [timer.py:258:stop] epoch=0/micro_step=15230/global_step=15230, RunningAvgSamplesPerSec=4.492158143143669, CurrSamplesPerSec=4.465275920264299, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:04:36,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=15240, skipped=69, lr=[2.434512981889398e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:04:36,204] [INFO] [timer.py:258:stop] epoch=0/micro_step=15240/global_step=15240, RunningAvgSamplesPerSec=4.49215381014612, CurrSamplesPerSec=4.471659818134763, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:04:45,257] [INFO] [logging.py:96:log_dist] [Rank 0] step=15250, skipped=69, lr=[2.429342001725393e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:04:45,258] [INFO] [timer.py:258:stop] epoch=0/micro_step=15250/global_step=15250, RunningAvgSamplesPerSec=4.492147828694082, CurrSamplesPerSec=4.483166763265816, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:04:45,258] [INFO] [RANK 0]  iteration    15250/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 2.429E-05 | total loss 3.213080E-01 | loss 3.213080E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 10:04:45,258] [INFO] [RANK 0] time (ms) | forward: 356.53 | backward: 545.73 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.00 | data loader: 0.13
[2024-06-17 10:04:54,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=15260, skipped=69, lr=[2.4241785981047506e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:04:54,315] [INFO] [timer.py:258:stop] epoch=0/micro_step=15260/global_step=15260, RunningAvgSamplesPerSec=4.492146496748675, CurrSamplesPerSec=4.476648456474046, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:05:03,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=15270, skipped=69, lr=[2.419022783767661e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:05:03,370] [INFO] [timer.py:258:stop] epoch=0/micro_step=15270/global_step=15270, RunningAvgSamplesPerSec=4.492140671238429, CurrSamplesPerSec=4.489988848099989, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:05:12,429] [INFO] [logging.py:96:log_dist] [Rank 0] step=15280, skipped=69, lr=[2.4138745714355793e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:05:12,429] [INFO] [timer.py:258:stop] epoch=0/micro_step=15280/global_step=15280, RunningAvgSamplesPerSec=4.492137779623225, CurrSamplesPerSec=4.484984837273361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:05:21,510] [INFO] [logging.py:96:log_dist] [Rank 0] step=15290, skipped=69, lr=[2.408733973811213e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:05:21,511] [INFO] [timer.py:258:stop] epoch=0/micro_step=15290/global_step=15290, RunningAvgSamplesPerSec=4.4921317370993235, CurrSamplesPerSec=4.46425172127058, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:05:30,569] [INFO] [logging.py:96:log_dist] [Rank 0] step=15300, skipped=69, lr=[2.40360100357847e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:05:30,569] [INFO] [timer.py:258:stop] epoch=0/micro_step=15300/global_step=15300, RunningAvgSamplesPerSec=4.492131165140903, CurrSamplesPerSec=4.49393726729703, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:05:30,569] [INFO] [RANK 0]  iteration    15300/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 2.403E-05 | total loss 3.058456E-01 | loss 3.058456E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 10:05:30,570] [INFO] [RANK 0] time (ms) | forward: 356.16 | backward: 546.14 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.33 | data loader: 0.10
[2024-06-17 10:05:30,570] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:05:30,583] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/15300/mp_rank_00_model_states.pt
[2024-06-17 10:05:30,583] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/15300/mp_rank_00_model_states.pt...
[2024-06-17 10:06:04,973] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/15300/mp_rank_00_model_states.pt.
[2024-06-17 10:06:13,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=15310, skipped=69, lr=[2.3984756734024482e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:06:13,991] [INFO] [timer.py:258:stop] epoch=0/micro_step=15310/global_step=15310, RunningAvgSamplesPerSec=4.492158203739286, CurrSamplesPerSec=4.5266360380019925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:06:22,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=15320, skipped=69, lr=[2.393357995929389e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:06:22,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=15320/global_step=15320, RunningAvgSamplesPerSec=4.492185883123024, CurrSamplesPerSec=4.524306948849049, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:06:31,984] [INFO] [logging.py:96:log_dist] [Rank 0] step=15330, skipped=69, lr=[2.3882479837866522e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:06:31,985] [INFO] [timer.py:258:stop] epoch=0/micro_step=15330/global_step=15330, RunningAvgSamplesPerSec=4.49220083005617, CurrSamplesPerSec=4.507083178080014, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:06:41,019] [INFO] [logging.py:96:log_dist] [Rank 0] step=15340, skipped=69, lr=[2.3831456495826836e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:06:41,020] [INFO] [timer.py:258:stop] epoch=0/micro_step=15340/global_step=15340, RunningAvgSamplesPerSec=4.492212129765827, CurrSamplesPerSec=4.509240639354088, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:06:49,174] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 10:06:50,079] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 10:06:50,079] [INFO] [logging.py:96:log_dist] [Rank 0] step=15350, skipped=71, lr=[2.3785601238423787e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:06:50,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=15350/global_step=15350, RunningAvgSamplesPerSec=4.4922176299179855, CurrSamplesPerSec=4.501813904165754, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:06:50,080] [INFO] [RANK 0]  iteration    15350/   20000 | elapsed time per iteration (ms): 1590.2 | learning rate 2.379E-05 | total loss 2.878201E-01 | loss 2.878201E-01 | loss scale 32768.0 |speed 150.92 samples/(min*GPU)
[2024-06-17 10:06:50,081] [INFO] [RANK 0] time (ms) | forward: 355.33 | backward: 542.54 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 16.18 | data loader: 0.13
[2024-06-17 10:06:59,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=15360, skipped=71, lr=[2.3739808365948226e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:06:59,155] [INFO] [timer.py:258:stop] epoch=0/micro_step=15360/global_step=15360, RunningAvgSamplesPerSec=4.4922157491048855, CurrSamplesPerSec=4.485814666074876, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:07:08,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=15370, skipped=71, lr=[2.3689000675349743e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:07:08,244] [INFO] [timer.py:258:stop] epoch=0/micro_step=15370/global_step=15370, RunningAvgSamplesPerSec=4.492211304416824, CurrSamplesPerSec=4.483926411849366, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:07:17,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=15380, skipped=71, lr=[2.3638270241529563e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:07:17,321] [INFO] [timer.py:258:stop] epoch=0/micro_step=15380/global_step=15380, RunningAvgSamplesPerSec=4.492204941074137, CurrSamplesPerSec=4.4740423813855354, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:07:26,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=15390, skipped=71, lr=[2.3587617189659965e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:07:26,397] [INFO] [timer.py:258:stop] epoch=0/micro_step=15390/global_step=15390, RunningAvgSamplesPerSec=4.4921977546505065, CurrSamplesPerSec=4.472535991494906, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:07:35,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=15400, skipped=71, lr=[2.3537041644722364e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:07:35,473] [INFO] [timer.py:258:stop] epoch=0/micro_step=15400/global_step=15400, RunningAvgSamplesPerSec=4.49219145035849, CurrSamplesPerSec=4.480035034453661, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:07:35,474] [INFO] [RANK 0]  iteration    15400/   20000 | elapsed time per iteration (ms): 907.9 | learning rate 2.353E-05 | total loss 3.331085E-01 | loss 3.331085E-01 | loss scale 32768.0 |speed 264.36 samples/(min*GPU)
[2024-06-17 10:07:35,474] [INFO] [RANK 0] time (ms) | forward: 357.20 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 15.32 | data loader: 0.14
[2024-06-17 10:07:44,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=15410, skipped=71, lr=[2.348654373150685e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:07:44,550] [INFO] [timer.py:258:stop] epoch=0/micro_step=15410/global_step=15410, RunningAvgSamplesPerSec=4.492183306578323, CurrSamplesPerSec=4.480768491177991, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:07:53,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=15420, skipped=71, lr=[2.3436123574612027e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:07:53,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=15420/global_step=15420, RunningAvgSamplesPerSec=4.492173267619649, CurrSamplesPerSec=4.46448218447864, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:08:02,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=15430, skipped=71, lr=[2.33857812984446e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:08:02,720] [INFO] [timer.py:258:stop] epoch=0/micro_step=15430/global_step=15430, RunningAvgSamplesPerSec=4.49216602534542, CurrSamplesPerSec=4.471249863081895, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:08:11,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=15440, skipped=71, lr=[2.3335517027219147e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:08:11,808] [INFO] [timer.py:258:stop] epoch=0/micro_step=15440/global_step=15440, RunningAvgSamplesPerSec=4.492154871526926, CurrSamplesPerSec=4.480609335795674, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:08:20,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=15450, skipped=71, lr=[2.3285330884957754e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:08:20,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=15450/global_step=15450, RunningAvgSamplesPerSec=4.492153797673042, CurrSamplesPerSec=4.485483657083214, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:08:20,879] [INFO] [RANK 0]  iteration    15450/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 2.328E-05 | total loss 3.005063E-01 | loss 3.005063E-01 | loss scale 32768.0 |speed 264.28 samples/(min*GPU)
[2024-06-17 10:08:20,880] [INFO] [RANK 0] time (ms) | forward: 357.15 | backward: 546.98 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 14.86 | data loader: 0.11
[2024-06-17 10:08:29,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=15460, skipped=71, lr=[2.3235222995489746e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:08:29,944] [INFO] [timer.py:258:stop] epoch=0/micro_step=15460/global_step=15460, RunningAvgSamplesPerSec=4.4921510849732975, CurrSamplesPerSec=4.491736697715126, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:08:39,021] [INFO] [logging.py:96:log_dist] [Rank 0] step=15470, skipped=71, lr=[2.3185193482451346e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:08:39,022] [INFO] [timer.py:258:stop] epoch=0/micro_step=15470/global_step=15470, RunningAvgSamplesPerSec=4.4921476128070665, CurrSamplesPerSec=4.481089229605524, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:08:48,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=15480, skipped=71, lr=[2.3135242469285428e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:08:48,069] [INFO] [timer.py:258:stop] epoch=0/micro_step=15480/global_step=15480, RunningAvgSamplesPerSec=4.492144806749292, CurrSamplesPerSec=4.4824397067923165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:08:57,133] [INFO] [logging.py:96:log_dist] [Rank 0] step=15490, skipped=71, lr=[2.3085370079241117e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:08:57,133] [INFO] [timer.py:258:stop] epoch=0/micro_step=15490/global_step=15490, RunningAvgSamplesPerSec=4.492142389274169, CurrSamplesPerSec=4.48353457357397, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:09:06,216] [INFO] [logging.py:96:log_dist] [Rank 0] step=15500, skipped=71, lr=[2.30355764353736e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:09:06,216] [INFO] [timer.py:258:stop] epoch=0/micro_step=15500/global_step=15500, RunningAvgSamplesPerSec=4.492135490766577, CurrSamplesPerSec=4.490103005817227, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:09:06,217] [INFO] [RANK 0]  iteration    15500/   20000 | elapsed time per iteration (ms): 906.7 | learning rate 2.303E-05 | total loss 3.299689E-01 | loss 3.299689E-01 | loss scale 32768.0 |speed 264.68 samples/(min*GPU)
[2024-06-17 10:09:06,217] [INFO] [RANK 0] time (ms) | forward: 356.16 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.78 | data loader: 0.10
[2024-06-17 10:09:15,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=15510, skipped=71, lr=[2.2985861660543732e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:09:15,288] [INFO] [timer.py:258:stop] epoch=0/micro_step=15510/global_step=15510, RunningAvgSamplesPerSec=4.492126777082276, CurrSamplesPerSec=4.473278921627573, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:09:24,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=15520, skipped=71, lr=[2.293622587741781e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:09:24,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=15520/global_step=15520, RunningAvgSamplesPerSec=4.492119167215553, CurrSamplesPerSec=4.473547295747879, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:09:33,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=15530, skipped=71, lr=[2.288666920846715e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:09:33,434] [INFO] [timer.py:258:stop] epoch=0/micro_step=15530/global_step=15530, RunningAvgSamplesPerSec=4.492113335850145, CurrSamplesPerSec=4.485592788707692, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:09:42,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=15540, skipped=71, lr=[2.283719177596793e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:09:42,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=15540/global_step=15540, RunningAvgSamplesPerSec=4.4921055941485415, CurrSamplesPerSec=4.476108607667208, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:09:51,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=15550, skipped=71, lr=[2.2787793702000794e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:09:51,560] [INFO] [timer.py:258:stop] epoch=0/micro_step=15550/global_step=15550, RunningAvgSamplesPerSec=4.49209850589412, CurrSamplesPerSec=4.459197025291139, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:09:51,560] [INFO] [RANK 0]  iteration    15550/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 2.278E-05 | total loss 3.022003E-01 | loss 3.022003E-01 | loss scale 32768.0 |speed 264.65 samples/(min*GPU)
[2024-06-17 10:09:51,560] [INFO] [RANK 0] time (ms) | forward: 356.11 | backward: 546.78 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 13.63 | data loader: 0.11
[2024-06-17 10:10:00,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=15560, skipped=71, lr=[2.2738475108450576e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:10:00,632] [INFO] [timer.py:258:stop] epoch=0/micro_step=15560/global_step=15560, RunningAvgSamplesPerSec=4.492090751180994, CurrSamplesPerSec=4.479655836988232, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:10:09,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=15570, skipped=71, lr=[2.2689236117005992e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:10:09,731] [INFO] [timer.py:258:stop] epoch=0/micro_step=15570/global_step=15570, RunningAvgSamplesPerSec=4.492083520840038, CurrSamplesPerSec=4.476714154928017, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:10:18,814] [INFO] [logging.py:96:log_dist] [Rank 0] step=15580, skipped=71, lr=[2.2640076849159388e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:10:18,815] [INFO] [timer.py:258:stop] epoch=0/micro_step=15580/global_step=15580, RunningAvgSamplesPerSec=4.49207665480777, CurrSamplesPerSec=4.48629087701218, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:10:27,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=15590, skipped=71, lr=[2.2590997426206355e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:10:27,885] [INFO] [timer.py:258:stop] epoch=0/micro_step=15590/global_step=15590, RunningAvgSamplesPerSec=4.492069324548292, CurrSamplesPerSec=4.481566831970787, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:10:36,956] [INFO] [logging.py:96:log_dist] [Rank 0] step=15600, skipped=71, lr=[2.2541997969245487e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:10:36,957] [INFO] [timer.py:258:stop] epoch=0/micro_step=15600/global_step=15600, RunningAvgSamplesPerSec=4.49206312008988, CurrSamplesPerSec=4.482088839697059, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:10:36,957] [INFO] [RANK 0]  iteration    15600/   20000 | elapsed time per iteration (ms): 907.9 | learning rate 2.254E-05 | total loss 3.066702E-01 | loss 3.066702E-01 | loss scale 32768.0 |speed 264.33 samples/(min*GPU)
[2024-06-17 10:10:36,958] [INFO] [RANK 0] time (ms) | forward: 357.15 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.81 | data loader: 0.10
[2024-06-17 10:10:36,958] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:10:36,970] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/15600/mp_rank_00_model_states.pt
[2024-06-17 10:10:36,970] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/15600/mp_rank_00_model_states.pt...
[2024-06-17 10:11:06,826] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/15600/mp_rank_00_model_states.pt.
[2024-06-17 10:11:15,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=15610, skipped=71, lr=[2.2493078599178055e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:11:15,811] [INFO] [timer.py:258:stop] epoch=0/micro_step=15610/global_step=15610, RunningAvgSamplesPerSec=4.492085141701922, CurrSamplesPerSec=4.529597244424742, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:11:24,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=15620, skipped=71, lr=[2.244423943670778e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:11:24,789] [INFO] [timer.py:258:stop] epoch=0/micro_step=15620/global_step=15620, RunningAvgSamplesPerSec=4.492107340949557, CurrSamplesPerSec=4.5212100959906, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:11:33,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=15630, skipped=71, lr=[2.2395480602340424e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:11:33,797] [INFO] [timer.py:258:stop] epoch=0/micro_step=15630/global_step=15630, RunningAvgSamplesPerSec=4.492123741107337, CurrSamplesPerSec=4.506378604525982, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:11:42,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=15640, skipped=71, lr=[2.2346802216383558e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:11:42,818] [INFO] [timer.py:258:stop] epoch=0/micro_step=15640/global_step=15640, RunningAvgSamplesPerSec=4.492133611340033, CurrSamplesPerSec=4.502448176353502, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:11:51,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=15650, skipped=71, lr=[2.229820439894626e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:11:51,839] [INFO] [timer.py:258:stop] epoch=0/micro_step=15650/global_step=15650, RunningAvgSamplesPerSec=4.492144860718401, CurrSamplesPerSec=4.490897463935027, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:11:51,840] [INFO] [RANK 0]  iteration    15650/   20000 | elapsed time per iteration (ms): 1497.6 | learning rate 2.229E-05 | total loss 2.882547E-01 | loss 2.882547E-01 | loss scale 32768.0 |speed 160.25 samples/(min*GPU)
[2024-06-17 10:11:51,840] [INFO] [RANK 0] time (ms) | forward: 353.47 | backward: 542.59 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.17 | data loader: 0.09
[2024-06-17 10:12:00,876] [INFO] [logging.py:96:log_dist] [Rank 0] step=15660, skipped=71, lr=[2.2249687269938832e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:12:00,876] [INFO] [timer.py:258:stop] epoch=0/micro_step=15660/global_step=15660, RunningAvgSamplesPerSec=4.492148584850647, CurrSamplesPerSec=4.488269974376768, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:12:09,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=15670, skipped=71, lr=[2.2201250949072435e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:12:09,916] [INFO] [timer.py:258:stop] epoch=0/micro_step=15670/global_step=15670, RunningAvgSamplesPerSec=4.492148951508716, CurrSamplesPerSec=4.488482510072002, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:12:18,951] [INFO] [logging.py:96:log_dist] [Rank 0] step=15680, skipped=71, lr=[2.2152895555858903e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:12:18,951] [INFO] [timer.py:258:stop] epoch=0/micro_step=15680/global_step=15680, RunningAvgSamplesPerSec=4.492145806391354, CurrSamplesPerSec=4.493310204211718, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:12:28,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=15690, skipped=71, lr=[2.2104621209610343e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:12:28,008] [INFO] [timer.py:258:stop] epoch=0/micro_step=15690/global_step=15690, RunningAvgSamplesPerSec=4.492141813495926, CurrSamplesPerSec=4.488935266196829, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:12:37,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=15700, skipped=71, lr=[2.205642802943894e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:12:37,085] [INFO] [timer.py:258:stop] epoch=0/micro_step=15700/global_step=15700, RunningAvgSamplesPerSec=4.492140242289579, CurrSamplesPerSec=4.491730684896446, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:12:37,085] [INFO] [RANK 0]  iteration    15700/   20000 | elapsed time per iteration (ms): 904.9 | learning rate 2.205E-05 | total loss 3.138220E-01 | loss 3.138220E-01 | loss scale 32768.0 |speed 265.22 samples/(min*GPU)
[2024-06-17 10:12:37,086] [INFO] [RANK 0] time (ms) | forward: 354.73 | backward: 546.25 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 13.75 | data loader: 0.10
[2024-06-17 10:12:46,167] [INFO] [logging.py:96:log_dist] [Rank 0] step=15710, skipped=71, lr=[2.2008316134256526e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:12:46,167] [INFO] [timer.py:258:stop] epoch=0/micro_step=15710/global_step=15710, RunningAvgSamplesPerSec=4.492132718838732, CurrSamplesPerSec=4.4745912790733335, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:12:55,235] [INFO] [logging.py:96:log_dist] [Rank 0] step=15720, skipped=71, lr=[2.196028564277445e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:12:55,235] [INFO] [timer.py:258:stop] epoch=0/micro_step=15720/global_step=15720, RunningAvgSamplesPerSec=4.492127322810983, CurrSamplesPerSec=4.491960386008568, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:13:04,319] [INFO] [logging.py:96:log_dist] [Rank 0] step=15730, skipped=71, lr=[2.191233667350318e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:13:04,320] [INFO] [timer.py:258:stop] epoch=0/micro_step=15730/global_step=15730, RunningAvgSamplesPerSec=4.492122485183165, CurrSamplesPerSec=4.489574324150746, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:13:13,393] [INFO] [logging.py:96:log_dist] [Rank 0] step=15740, skipped=71, lr=[2.186446934475201e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:13:13,395] [INFO] [timer.py:258:stop] epoch=0/micro_step=15740/global_step=15740, RunningAvgSamplesPerSec=4.49211969814713, CurrSamplesPerSec=4.491133091036025, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:13:22,450] [INFO] [logging.py:96:log_dist] [Rank 0] step=15750, skipped=71, lr=[2.1816683774628823e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:13:22,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=15750/global_step=15750, RunningAvgSamplesPerSec=4.492115706691904, CurrSamplesPerSec=4.4908253381325505, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:13:22,451] [INFO] [RANK 0]  iteration    15750/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 2.181E-05 | total loss 2.866116E-01 | loss 2.866116E-01 | loss scale 65536.0 |speed 264.52 samples/(min*GPU)
[2024-06-17 10:13:22,451] [INFO] [RANK 0] time (ms) | forward: 356.59 | backward: 546.80 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 14.85 | data loader: 0.12
[2024-06-17 10:13:23,360] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 10:13:24,265] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 10:13:31,524] [INFO] [logging.py:96:log_dist] [Rank 0] step=15760, skipped=73, lr=[2.177851426398214e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:13:31,524] [INFO] [timer.py:258:stop] epoch=0/micro_step=15760/global_step=15760, RunningAvgSamplesPerSec=4.492113178467602, CurrSamplesPerSec=4.48759527691827, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:13:40,583] [INFO] [logging.py:96:log_dist] [Rank 0] step=15770, skipped=73, lr=[2.173087615637706e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:13:40,584] [INFO] [timer.py:258:stop] epoch=0/micro_step=15770/global_step=15770, RunningAvgSamplesPerSec=4.492110554595475, CurrSamplesPerSec=4.491350707411423, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:13:49,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=15780, skipped=73, lr=[2.1683320137027895e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:13:49,641] [INFO] [timer.py:258:stop] epoch=0/micro_step=15780/global_step=15780, RunningAvgSamplesPerSec=4.492105062834105, CurrSamplesPerSec=4.485450079190153, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:13:58,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=15790, skipped=73, lr=[2.1635846323274362e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:13:58,700] [INFO] [timer.py:258:stop] epoch=0/micro_step=15790/global_step=15790, RunningAvgSamplesPerSec=4.49210146133628, CurrSamplesPerSec=4.4730737862374434, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:14:07,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=15800, skipped=73, lr=[2.1588454832253404e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:14:07,763] [INFO] [timer.py:258:stop] epoch=0/micro_step=15800/global_step=15800, RunningAvgSamplesPerSec=4.4920981487626985, CurrSamplesPerSec=4.4906270041209275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:14:07,763] [INFO] [RANK 0]  iteration    15800/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 2.158E-05 | total loss 2.975800E-01 | loss 2.975800E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 10:14:07,764] [INFO] [RANK 0] time (ms) | forward: 355.70 | backward: 546.71 | allreduce: 0.00 | optimizer: 3.07 | batch generator: 14.24 | data loader: 0.11
[2024-06-17 10:14:16,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=15810, skipped=73, lr=[2.15411457808988e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:14:16,813] [INFO] [timer.py:258:stop] epoch=0/micro_step=15810/global_step=15810, RunningAvgSamplesPerSec=4.492093187279335, CurrSamplesPerSec=4.48446814817666, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:14:25,867] [INFO] [logging.py:96:log_dist] [Rank 0] step=15820, skipped=73, lr=[2.1493919285940938e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:14:25,868] [INFO] [timer.py:258:stop] epoch=0/micro_step=15820/global_step=15820, RunningAvgSamplesPerSec=4.492090431832192, CurrSamplesPerSec=4.486726392640334, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:14:34,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=15830, skipped=73, lr=[2.1446775463906485e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:14:34,915] [INFO] [timer.py:258:stop] epoch=0/micro_step=15830/global_step=15830, RunningAvgSamplesPerSec=4.492085225883965, CurrSamplesPerSec=4.493164596557739, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:14:43,962] [INFO] [logging.py:96:log_dist] [Rank 0] step=15840, skipped=73, lr=[2.139971443111816e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:14:43,962] [INFO] [timer.py:258:stop] epoch=0/micro_step=15840/global_step=15840, RunningAvgSamplesPerSec=4.49208215992556, CurrSamplesPerSec=4.476545731847237, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:14:53,007] [INFO] [logging.py:96:log_dist] [Rank 0] step=15850, skipped=73, lr=[2.1352736303694364e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:14:53,007] [INFO] [timer.py:258:stop] epoch=0/micro_step=15850/global_step=15850, RunningAvgSamplesPerSec=4.4920784703591625, CurrSamplesPerSec=4.494026346114594, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:14:53,008] [INFO] [RANK 0]  iteration    15850/   20000 | elapsed time per iteration (ms): 904.9 | learning rate 2.135E-05 | total loss 3.189209E-01 | loss 3.189209E-01 | loss scale 32768.0 |speed 265.23 samples/(min*GPU)
[2024-06-17 10:14:53,008] [INFO] [RANK 0] time (ms) | forward: 354.21 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.12 | batch generator: 12.74 | data loader: 0.10
[2024-06-17 10:15:02,073] [INFO] [logging.py:96:log_dist] [Rank 0] step=15860, skipped=73, lr=[2.1305841197548972e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:15:02,074] [INFO] [timer.py:258:stop] epoch=0/micro_step=15860/global_step=15860, RunningAvgSamplesPerSec=4.4920738988268685, CurrSamplesPerSec=4.482328333470034, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:15:11,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=15870, skipped=73, lr=[2.125902922839097e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:15:11,139] [INFO] [timer.py:258:stop] epoch=0/micro_step=15870/global_step=15870, RunningAvgSamplesPerSec=4.492067852906585, CurrSamplesPerSec=4.486919582288864, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:15:20,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=15880, skipped=73, lr=[2.1212300511724266e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:15:20,226] [INFO] [timer.py:258:stop] epoch=0/micro_step=15880/global_step=15880, RunningAvgSamplesPerSec=4.492060127995877, CurrSamplesPerSec=4.483099677339622, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:15:29,313] [INFO] [logging.py:96:log_dist] [Rank 0] step=15890, skipped=73, lr=[2.1165655162847322e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:15:29,314] [INFO] [timer.py:258:stop] epoch=0/micro_step=15890/global_step=15890, RunningAvgSamplesPerSec=4.4920516846699625, CurrSamplesPerSec=4.490857794456966, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:15:38,377] [INFO] [logging.py:96:log_dist] [Rank 0] step=15900, skipped=73, lr=[2.111909329685288e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:15:38,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=15900/global_step=15900, RunningAvgSamplesPerSec=4.492046609399305, CurrSamplesPerSec=4.486439638682736, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:15:38,378] [INFO] [RANK 0]  iteration    15900/   20000 | elapsed time per iteration (ms): 907.4 | learning rate 2.111E-05 | total loss 3.182800E-01 | loss 3.182800E-01 | loss scale 32768.0 |speed 264.49 samples/(min*GPU)
[2024-06-17 10:15:38,378] [INFO] [RANK 0] time (ms) | forward: 356.54 | backward: 546.80 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 14.40 | data loader: 0.12
[2024-06-17 10:15:38,378] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:15:38,390] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/15900/mp_rank_00_model_states.pt
[2024-06-17 10:15:38,390] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/15900/mp_rank_00_model_states.pt...
[2024-06-17 10:16:07,547] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/15900/mp_rank_00_model_states.pt.
[2024-06-17 10:16:16,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=15910, skipped=73, lr=[2.1072615028627725e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:16:16,565] [INFO] [timer.py:258:stop] epoch=0/micro_step=15910/global_step=15910, RunningAvgSamplesPerSec=4.492068059527117, CurrSamplesPerSec=4.526401555743332, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:16:25,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=15920, skipped=73, lr=[2.1026220472852382e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:16:25,563] [INFO] [timer.py:258:stop] epoch=0/micro_step=15920/global_step=15920, RunningAvgSamplesPerSec=4.4920871958783835, CurrSamplesPerSec=4.514289235292962, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:16:34,575] [INFO] [logging.py:96:log_dist] [Rank 0] step=15930, skipped=73, lr=[2.0979909744000764e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:16:34,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=15930/global_step=15930, RunningAvgSamplesPerSec=4.4921029904975915, CurrSamplesPerSec=4.513535050267817, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:16:43,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=15940, skipped=73, lr=[2.0933682956340028e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:16:43,603] [INFO] [timer.py:258:stop] epoch=0/micro_step=15940/global_step=15940, RunningAvgSamplesPerSec=4.492114897046825, CurrSamplesPerSec=4.50088154654276, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:16:52,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=15950, skipped=73, lr=[2.0887540223930153e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:16:52,646] [INFO] [timer.py:258:stop] epoch=0/micro_step=15950/global_step=15950, RunningAvgSamplesPerSec=4.492121370819703, CurrSamplesPerSec=4.502579885747534, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:16:52,646] [INFO] [RANK 0]  iteration    15950/   20000 | elapsed time per iteration (ms): 1485.4 | learning rate 2.088E-05 | total loss 2.928113E-01 | loss 2.928113E-01 | loss scale 32768.0 |speed 161.58 samples/(min*GPU)
[2024-06-17 10:16:52,646] [INFO] [RANK 0] time (ms) | forward: 354.96 | backward: 542.73 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 15.50 | data loader: 0.12
[2024-06-17 10:17:01,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=15960, skipped=73, lr=[2.0841481660623786e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:17:01,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=15960/global_step=15960, RunningAvgSamplesPerSec=4.492123328169452, CurrSamplesPerSec=4.480650021058277, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:17:10,778] [INFO] [logging.py:96:log_dist] [Rank 0] step=15970, skipped=73, lr=[2.0795507380065788e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:17:10,778] [INFO] [timer.py:258:stop] epoch=0/micro_step=15970/global_step=15970, RunningAvgSamplesPerSec=4.492119129635267, CurrSamplesPerSec=4.472489492037621, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:17:19,854] [INFO] [logging.py:96:log_dist] [Rank 0] step=15980, skipped=73, lr=[2.0749617495693183e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:17:19,854] [INFO] [timer.py:258:stop] epoch=0/micro_step=15980/global_step=15980, RunningAvgSamplesPerSec=4.492116734268907, CurrSamplesPerSec=4.49206742753532, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:17:28,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=15990, skipped=73, lr=[2.0703812120734676e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:17:28,909] [INFO] [timer.py:258:stop] epoch=0/micro_step=15990/global_step=15990, RunningAvgSamplesPerSec=4.492114599035639, CurrSamplesPerSec=4.484378249241298, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:17:37,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=16000, skipped=73, lr=[2.0658091368210474e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:17:37,975] [INFO] [timer.py:258:stop] epoch=0/micro_step=16000/global_step=16000, RunningAvgSamplesPerSec=4.492108353027924, CurrSamplesPerSec=4.475808880592655, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:17:37,976] [INFO] [RANK 0]  iteration    16000/   20000 | elapsed time per iteration (ms): 906.6 | learning rate 2.065E-05 | total loss 3.326233E-01 | loss 3.326233E-01 | loss scale 32768.0 |speed 264.73 samples/(min*GPU)
[2024-06-17 10:17:37,976] [INFO] [RANK 0] time (ms) | forward: 356.23 | backward: 546.39 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.84 | data loader: 0.11
[2024-06-17 10:17:44,618] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 10:17:44,618] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 10:17:44,618] [INFO] [RANK 0]  validation loss at iteration 16000 | loss: 8.831543E-01 | PPL: 2.418516E+00 loss 8.828125E-01 |
[2024-06-17 10:17:44,618] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 10:17:53,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=16010, skipped=73, lr=[2.0612455350931984e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:17:53,685] [INFO] [timer.py:258:stop] epoch=0/micro_step=16010/global_step=16010, RunningAvgSamplesPerSec=4.492101837217361, CurrSamplesPerSec=4.474967232362956, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:18:02,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=16020, skipped=73, lr=[2.0566904181501558e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:18:02,747] [INFO] [timer.py:258:stop] epoch=0/micro_step=16020/global_step=16020, RunningAvgSamplesPerSec=4.492098119677813, CurrSamplesPerSec=4.483219475044926, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:18:11,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=16030, skipped=73, lr=[2.0521437972312174e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:18:11,831] [INFO] [timer.py:258:stop] epoch=0/micro_step=16030/global_step=16030, RunningAvgSamplesPerSec=4.492089021623535, CurrSamplesPerSec=4.477483567604008, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:18:20,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=16040, skipped=73, lr=[2.047605683554718e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:18:20,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=16040/global_step=16040, RunningAvgSamplesPerSec=4.49208357732418, CurrSamplesPerSec=4.465344850760073, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:18:29,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=16050, skipped=73, lr=[2.0430760883180012e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:18:29,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=16050/global_step=16050, RunningAvgSamplesPerSec=4.49207854925808, CurrSamplesPerSec=4.483816162964321, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:18:29,954] [INFO] [RANK 0]  iteration    16050/   20000 | elapsed time per iteration (ms): 1039.6 | learning rate 2.043E-05 | total loss 2.940271E-01 | loss 2.940271E-01 | loss scale 32768.0 |speed 230.86 samples/(min*GPU)
[2024-06-17 10:18:29,955] [INFO] [RANK 0] time (ms) | forward: 355.96 | backward: 546.79 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 16.85 | data loader: 0.16
[2024-06-17 10:18:39,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=16060, skipped=73, lr=[2.0385550226973944e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:18:39,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=16060/global_step=16060, RunningAvgSamplesPerSec=4.492073603638993, CurrSamplesPerSec=4.4741640818614545, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:18:48,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=16070, skipped=73, lr=[2.0340424978481773e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:18:48,095] [INFO] [timer.py:258:stop] epoch=0/micro_step=16070/global_step=16070, RunningAvgSamplesPerSec=4.4920688317083695, CurrSamplesPerSec=4.479484800465645, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:18:57,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=16080, skipped=73, lr=[2.029538524904556e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:18:57,152] [INFO] [timer.py:258:stop] epoch=0/micro_step=16080/global_step=16080, RunningAvgSamplesPerSec=4.492065903648144, CurrSamplesPerSec=4.4898170216387285, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:19:06,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=16090, skipped=73, lr=[2.025043114979635e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:19:06,238] [INFO] [timer.py:258:stop] epoch=0/micro_step=16090/global_step=16090, RunningAvgSamplesPerSec=4.492056210614452, CurrSamplesPerSec=4.478571232177174, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:19:15,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=16100, skipped=73, lr=[2.020556279165394e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:19:15,317] [INFO] [timer.py:258:stop] epoch=0/micro_step=16100/global_step=16100, RunningAvgSamplesPerSec=4.49204991521636, CurrSamplesPerSec=4.477145423560738, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:19:15,317] [INFO] [RANK 0]  iteration    16100/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 2.020E-05 | total loss 3.232854E-01 | loss 3.232854E-01 | loss scale 32768.0 |speed 264.53 samples/(min*GPU)
[2024-06-17 10:19:15,318] [INFO] [RANK 0] time (ms) | forward: 356.37 | backward: 546.95 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 14.51 | data loader: 0.10
[2024-06-17 10:19:24,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=16110, skipped=73, lr=[2.0160780285326525e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:19:24,398] [INFO] [timer.py:258:stop] epoch=0/micro_step=16110/global_step=16110, RunningAvgSamplesPerSec=4.4920426887199865, CurrSamplesPerSec=4.4818876847048505, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:19:33,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=16120, skipped=73, lr=[2.011608374131049e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:19:33,494] [INFO] [timer.py:258:stop] epoch=0/micro_step=16120/global_step=16120, RunningAvgSamplesPerSec=4.492036598200112, CurrSamplesPerSec=4.483526186347349, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:19:42,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=16130, skipped=73, lr=[2.0071473269890103e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:19:42,571] [INFO] [timer.py:258:stop] epoch=0/micro_step=16130/global_step=16130, RunningAvgSamplesPerSec=4.492030402270482, CurrSamplesPerSec=4.479996752932041, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:19:51,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=16140, skipped=73, lr=[2.0026948981137312e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:19:51,645] [INFO] [timer.py:258:stop] epoch=0/micro_step=16140/global_step=16140, RunningAvgSamplesPerSec=4.492025167164644, CurrSamplesPerSec=4.4825235398254675, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:20:00,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=16150, skipped=73, lr=[1.998251098491131e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:20:00,710] [INFO] [timer.py:258:stop] epoch=0/micro_step=16150/global_step=16150, RunningAvgSamplesPerSec=4.492017846760761, CurrSamplesPerSec=4.480140312011573, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:20:00,711] [INFO] [RANK 0]  iteration    16150/   20000 | elapsed time per iteration (ms): 907.9 | learning rate 1.998E-05 | total loss 2.841888E-01 | loss 2.841888E-01 | loss scale 32768.0 |speed 264.36 samples/(min*GPU)
[2024-06-17 10:20:00,711] [INFO] [RANK 0] time (ms) | forward: 357.04 | backward: 546.88 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.88 | data loader: 0.11
[2024-06-17 10:20:03,430] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 10:20:04,335] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 10:20:09,770] [INFO] [logging.py:96:log_dist] [Rank 0] step=16160, skipped=75, lr=[1.9947022792239335e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:20:09,771] [INFO] [timer.py:258:stop] epoch=0/micro_step=16160/global_step=16160, RunningAvgSamplesPerSec=4.492014138221265, CurrSamplesPerSec=4.494540423955321, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:20:18,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=16170, skipped=75, lr=[1.990274039872714e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:20:18,845] [INFO] [timer.py:258:stop] epoch=0/micro_step=16170/global_step=16170, RunningAvgSamplesPerSec=4.492008810674386, CurrSamplesPerSec=4.474131866385267, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:20:27,901] [INFO] [logging.py:96:log_dist] [Rank 0] step=16180, skipped=75, lr=[1.985854460421409e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:20:27,902] [INFO] [timer.py:258:stop] epoch=0/micro_step=16180/global_step=16180, RunningAvgSamplesPerSec=4.492005647138132, CurrSamplesPerSec=4.492092685268658, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:20:36,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=16190, skipped=75, lr=[1.981443551774894e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:20:36,960] [INFO] [timer.py:258:stop] epoch=0/micro_step=16190/global_step=16190, RunningAvgSamplesPerSec=4.492001636748642, CurrSamplesPerSec=4.471255821192579, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:20:46,029] [INFO] [logging.py:96:log_dist] [Rank 0] step=16200, skipped=75, lr=[1.9770413248166432e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:20:46,029] [INFO] [timer.py:258:stop] epoch=0/micro_step=16200/global_step=16200, RunningAvgSamplesPerSec=4.49199722487234, CurrSamplesPerSec=4.466823803548546, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:20:46,030] [INFO] [RANK 0]  iteration    16200/   20000 | elapsed time per iteration (ms): 906.4 | learning rate 1.977E-05 | total loss 3.446732E-01 | loss 3.446732E-01 | loss scale 32768.0 |speed 264.79 samples/(min*GPU)
[2024-06-17 10:20:46,030] [INFO] [RANK 0] time (ms) | forward: 355.63 | backward: 546.83 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.16 | data loader: 0.11
[2024-06-17 10:20:46,030] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:20:46,046] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/16200/mp_rank_00_model_states.pt
[2024-06-17 10:20:46,046] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/16200/mp_rank_00_model_states.pt...
[2024-06-17 10:21:09,646] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/16200/mp_rank_00_model_states.pt.
[2024-06-17 10:21:18,656] [INFO] [logging.py:96:log_dist] [Rank 0] step=16210, skipped=75, lr=[1.9726477904087178e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:21:18,656] [INFO] [timer.py:258:stop] epoch=0/micro_step=16210/global_step=16210, RunningAvgSamplesPerSec=4.4920218499363145, CurrSamplesPerSec=4.53610397026331, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:21:27,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=16220, skipped=75, lr=[1.9682629593917256e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:21:27,677] [INFO] [timer.py:258:stop] epoch=0/micro_step=16220/global_step=16220, RunningAvgSamplesPerSec=4.492037615249871, CurrSamplesPerSec=4.506168001596491, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:21:36,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=16230, skipped=75, lr=[1.9638868425848018e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:21:36,701] [INFO] [timer.py:258:stop] epoch=0/micro_step=16230/global_step=16230, RunningAvgSamplesPerSec=4.492051690326661, CurrSamplesPerSec=4.514722914702248, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:21:45,735] [INFO] [logging.py:96:log_dist] [Rank 0] step=16240, skipped=75, lr=[1.9595194507855777e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:21:45,735] [INFO] [timer.py:258:stop] epoch=0/micro_step=16240/global_step=16240, RunningAvgSamplesPerSec=4.492062567092299, CurrSamplesPerSec=4.507500941681314, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:21:54,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=16250, skipped=75, lr=[1.955160794770161e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:21:54,795] [INFO] [timer.py:258:stop] epoch=0/micro_step=16250/global_step=16250, RunningAvgSamplesPerSec=4.492062204479841, CurrSamplesPerSec=4.48583745472309, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:21:54,795] [INFO] [RANK 0]  iteration    16250/   20000 | elapsed time per iteration (ms): 1375.3 | learning rate 1.955E-05 | total loss 2.762094E-01 | loss 2.762094E-01 | loss scale 32768.0 |speed 174.51 samples/(min*GPU)
[2024-06-17 10:21:54,796] [INFO] [RANK 0] time (ms) | forward: 355.32 | backward: 543.44 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 15.95 | data loader: 0.09
[2024-06-17 10:22:04,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=16260, skipped=75, lr=[1.950810885293102e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:22:04,037] [INFO] [timer.py:258:stop] epoch=0/micro_step=16260/global_step=16260, RunningAvgSamplesPerSec=4.492044654183485, CurrSamplesPerSec=4.458431514382953, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:22:13,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=16270, skipped=75, lr=[1.9464697330873687e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:22:13,380] [INFO] [timer.py:258:stop] epoch=0/micro_step=16270/global_step=16270, RunningAvgSamplesPerSec=4.492014437700106, CurrSamplesPerSec=4.432051426667889, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:22:22,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=16280, skipped=75, lr=[1.9421373488643217e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:22:22,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=16280/global_step=16280, RunningAvgSamplesPerSec=4.49198323935872, CurrSamplesPerSec=4.403871009740522, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:22:32,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=16290, skipped=75, lr=[1.937813743313691e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:22:32,187] [INFO] [timer.py:258:stop] epoch=0/micro_step=16290/global_step=16290, RunningAvgSamplesPerSec=4.491956145750049, CurrSamplesPerSec=4.456012285548704, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:22:41,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=16300, skipped=75, lr=[1.933498927103542e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:22:41,574] [INFO] [timer.py:258:stop] epoch=0/micro_step=16300/global_step=16300, RunningAvgSamplesPerSec=4.491922128801053, CurrSamplesPerSec=4.441468384495909, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:22:41,575] [INFO] [RANK 0]  iteration    16300/   20000 | elapsed time per iteration (ms): 935.6 | learning rate 1.933E-05 | total loss 2.791247E-01 | loss 2.791247E-01 | loss scale 32768.0 |speed 256.52 samples/(min*GPU)
[2024-06-17 10:22:41,575] [INFO] [RANK 0] time (ms) | forward: 381.57 | backward: 549.21 | allreduce: 0.00 | optimizer: 3.89 | batch generator: 34.87 | data loader: 4.24
[2024-06-17 10:22:50,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=16310, skipped=75, lr=[1.929192910880255e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:22:50,752] [INFO] [timer.py:258:stop] epoch=0/micro_step=16310/global_step=16310, RunningAvgSamplesPerSec=4.491911021149854, CurrSamplesPerSec=4.488088674523462, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:22:59,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=16320, skipped=75, lr=[1.924895705268496e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:22:59,841] [INFO] [timer.py:258:stop] epoch=0/micro_step=16320/global_step=16320, RunningAvgSamplesPerSec=4.49190628322352, CurrSamplesPerSec=4.485903423167894, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:23:08,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=16330, skipped=75, lr=[1.9206073208711952e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:23:08,934] [INFO] [timer.py:258:stop] epoch=0/micro_step=16330/global_step=16330, RunningAvgSamplesPerSec=4.491897748701371, CurrSamplesPerSec=4.454227080619225, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:23:17,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=16340, skipped=75, lr=[1.9163277682695115e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:23:18,000] [INFO] [timer.py:258:stop] epoch=0/micro_step=16340/global_step=16340, RunningAvgSamplesPerSec=4.491892786964466, CurrSamplesPerSec=4.478417014615729, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:23:27,066] [INFO] [logging.py:96:log_dist] [Rank 0] step=16350, skipped=75, lr=[1.9120570580228186e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:23:27,066] [INFO] [timer.py:258:stop] epoch=0/micro_step=16350/global_step=16350, RunningAvgSamplesPerSec=4.49188698641081, CurrSamplesPerSec=4.478669267466572, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:23:27,067] [INFO] [RANK 0]  iteration    16350/   20000 | elapsed time per iteration (ms): 909.8 | learning rate 1.912E-05 | total loss 3.126282E-01 | loss 3.126282E-01 | loss scale 32768.0 |speed 263.78 samples/(min*GPU)
[2024-06-17 10:23:27,067] [INFO] [RANK 0] time (ms) | forward: 358.53 | backward: 547.24 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 16.57 | data loader: 0.55
[2024-06-17 10:23:36,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=16360, skipped=75, lr=[1.907795200668667e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:23:36,161] [INFO] [timer.py:258:stop] epoch=0/micro_step=16360/global_step=16360, RunningAvgSamplesPerSec=4.491877371830759, CurrSamplesPerSec=4.468304926391237, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:23:45,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=16370, skipped=75, lr=[1.903542206722769e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:23:45,233] [INFO] [timer.py:258:stop] epoch=0/micro_step=16370/global_step=16370, RunningAvgSamplesPerSec=4.491869474831421, CurrSamplesPerSec=4.486891982749076, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:23:54,289] [INFO] [logging.py:96:log_dist] [Rank 0] step=16380, skipped=75, lr=[1.899298086678961e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:23:54,289] [INFO] [timer.py:258:stop] epoch=0/micro_step=16380/global_step=16380, RunningAvgSamplesPerSec=4.491863813893928, CurrSamplesPerSec=4.482267260126849, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:24:03,363] [INFO] [logging.py:96:log_dist] [Rank 0] step=16390, skipped=75, lr=[1.8950628510091892e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:24:03,363] [INFO] [timer.py:258:stop] epoch=0/micro_step=16390/global_step=16390, RunningAvgSamplesPerSec=4.491856847318857, CurrSamplesPerSec=4.481436349037346, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:24:12,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=16400, skipped=75, lr=[1.8908365101634766e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:24:12,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=16400/global_step=16400, RunningAvgSamplesPerSec=4.491844909789026, CurrSamplesPerSec=4.456972321009451, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:24:12,464] [INFO] [RANK 0]  iteration    16400/   20000 | elapsed time per iteration (ms): 907.9 | learning rate 1.890E-05 | total loss 3.281944E-01 | loss 3.281944E-01 | loss scale 32768.0 |speed 264.33 samples/(min*GPU)
[2024-06-17 10:24:12,464] [INFO] [RANK 0] time (ms) | forward: 356.86 | backward: 547.08 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.13 | data loader: 0.21
[2024-06-17 10:24:21,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=16410, skipped=75, lr=[1.8866190745698992e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:24:21,561] [INFO] [timer.py:258:stop] epoch=0/micro_step=16410/global_step=16410, RunningAvgSamplesPerSec=4.4918353061339, CurrSamplesPerSec=4.46698792781236, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:24:30,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=16420, skipped=75, lr=[1.882410554634558e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:24:30,640] [INFO] [timer.py:258:stop] epoch=0/micro_step=16420/global_step=16420, RunningAvgSamplesPerSec=4.491827645520213, CurrSamplesPerSec=4.474135445859711, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:24:39,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=16430, skipped=75, lr=[1.878210960741561e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:24:39,722] [INFO] [timer.py:258:stop] epoch=0/micro_step=16430/global_step=16430, RunningAvgSamplesPerSec=4.491818938498209, CurrSamplesPerSec=4.475586797975888, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:24:48,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=16440, skipped=75, lr=[1.8740203032529862e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:24:48,796] [INFO] [timer.py:258:stop] epoch=0/micro_step=16440/global_step=16440, RunningAvgSamplesPerSec=4.491810777562063, CurrSamplesPerSec=4.474271470132749, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:24:57,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=16450, skipped=75, lr=[1.869838592508866e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:24:57,876] [INFO] [timer.py:258:stop] epoch=0/micro_step=16450/global_step=16450, RunningAvgSamplesPerSec=4.4918040142347655, CurrSamplesPerSec=4.48354056446934, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:24:57,876] [INFO] [RANK 0]  iteration    16450/   20000 | elapsed time per iteration (ms): 908.2 | learning rate 1.869E-05 | total loss 2.635873E-01 | loss 2.635873E-01 | loss scale 32768.0 |speed 264.25 samples/(min*GPU)
[2024-06-17 10:24:57,877] [INFO] [RANK 0] time (ms) | forward: 357.01 | backward: 547.25 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.58 | data loader: 0.22
[2024-06-17 10:25:06,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=16460, skipped=75, lr=[1.8656658388271537e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:25:06,943] [INFO] [timer.py:258:stop] epoch=0/micro_step=16460/global_step=16460, RunningAvgSamplesPerSec=4.491797667100513, CurrSamplesPerSec=4.475147473642796, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:25:16,029] [INFO] [logging.py:96:log_dist] [Rank 0] step=16470, skipped=75, lr=[1.861502052503706e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:25:16,030] [INFO] [timer.py:258:stop] epoch=0/micro_step=16470/global_step=16470, RunningAvgSamplesPerSec=4.49178795308384, CurrSamplesPerSec=4.48200023348738, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:25:25,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=16480, skipped=75, lr=[1.857347243812252e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:25:25,112] [INFO] [timer.py:258:stop] epoch=0/micro_step=16480/global_step=16480, RunningAvgSamplesPerSec=4.491780221763107, CurrSamplesPerSec=4.47915592078214, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:25:34,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=16490, skipped=75, lr=[1.8532014230043686e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:25:34,195] [INFO] [timer.py:258:stop] epoch=0/micro_step=16490/global_step=16490, RunningAvgSamplesPerSec=4.491771359040431, CurrSamplesPerSec=4.4765158709215385, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:25:43,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=16500, skipped=75, lr=[1.8490646003094548e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:25:43,278] [INFO] [timer.py:258:stop] epoch=0/micro_step=16500/global_step=16500, RunningAvgSamplesPerSec=4.491764182748268, CurrSamplesPerSec=4.478316599587542, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:25:43,279] [INFO] [RANK 0]  iteration    16500/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 1.849E-05 | total loss 2.937645E-01 | loss 2.937645E-01 | loss scale 32768.0 |speed 264.30 samples/(min*GPU)
[2024-06-17 10:25:43,279] [INFO] [RANK 0] time (ms) | forward: 357.02 | backward: 547.12 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.48 | data loader: 0.16
[2024-06-17 10:25:43,279] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:25:43,292] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/16500/mp_rank_00_model_states.pt
[2024-06-17 10:25:43,292] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/16500/mp_rank_00_model_states.pt...
[2024-06-17 10:26:11,692] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/16500/mp_rank_00_model_states.pt.
[2024-06-17 10:26:20,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=16510, skipped=75, lr=[1.8449367859347125e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:26:20,695] [INFO] [timer.py:258:stop] epoch=0/micro_step=16510/global_step=16510, RunningAvgSamplesPerSec=4.49178500919222, CurrSamplesPerSec=4.537896506348835, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:26:29,677] [INFO] [logging.py:96:log_dist] [Rank 0] step=16520, skipped=75, lr=[1.8408179900651112e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:26:29,678] [INFO] [timer.py:258:stop] epoch=0/micro_step=16520/global_step=16520, RunningAvgSamplesPerSec=4.4918053932908135, CurrSamplesPerSec=4.5113055459276294, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:26:38,682] [INFO] [logging.py:96:log_dist] [Rank 0] step=16530, skipped=75, lr=[1.8367082228633718e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:26:38,683] [INFO] [timer.py:258:stop] epoch=0/micro_step=16530/global_step=16530, RunningAvgSamplesPerSec=4.491817394806582, CurrSamplesPerSec=4.51481646432286, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:26:47,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=16540, skipped=75, lr=[1.8326074944699335e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:26:47,714] [INFO] [timer.py:258:stop] epoch=0/micro_step=16540/global_step=16540, RunningAvgSamplesPerSec=4.49182503019647, CurrSamplesPerSec=4.501534881012847, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:26:56,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=16550, skipped=75, lr=[1.8285158150029404e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:26:56,789] [INFO] [timer.py:258:stop] epoch=0/micro_step=16550/global_step=16550, RunningAvgSamplesPerSec=4.491818823136648, CurrSamplesPerSec=4.485038790795429, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:26:56,790] [INFO] [RANK 0]  iteration    16550/   20000 | elapsed time per iteration (ms): 1470.2 | learning rate 1.828E-05 | total loss 3.037149E-01 | loss 3.037149E-01 | loss scale 32768.0 |speed 163.24 samples/(min*GPU)
[2024-06-17 10:26:56,790] [INFO] [RANK 0] time (ms) | forward: 354.21 | backward: 543.55 | allreduce: 0.00 | optimizer: 3.14 | batch generator: 14.27 | data loader: 0.23
[2024-06-17 10:27:01,354] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 10:27:02,302] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 10:27:06,010] [INFO] [logging.py:96:log_dist] [Rank 0] step=16560, skipped=77, lr=[1.8252489934415192e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:27:06,011] [INFO] [timer.py:258:stop] epoch=0/micro_step=16560/global_step=16560, RunningAvgSamplesPerSec=4.49179893028089, CurrSamplesPerSec=4.446886013866091, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:27:15,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=16570, skipped=77, lr=[1.8211736274685492e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:27:15,340] [INFO] [timer.py:258:stop] epoch=0/micro_step=16570/global_step=16570, RunningAvgSamplesPerSec=4.491774837970882, CurrSamplesPerSec=4.4270658407068435, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:27:24,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=16580, skipped=77, lr=[1.817107338633951e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:27:24,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=16580/global_step=16580, RunningAvgSamplesPerSec=4.491741808877551, CurrSamplesPerSec=4.448949642950997, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:27:34,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=16590, skipped=77, lr=[1.81305013697089e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:27:34,156] [INFO] [timer.py:258:stop] epoch=0/micro_step=16590/global_step=16590, RunningAvgSamplesPerSec=4.491715179742597, CurrSamplesPerSec=4.44407548553224, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:27:43,549] [INFO] [logging.py:96:log_dist] [Rank 0] step=16600, skipped=77, lr=[1.809002032490107e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:27:43,550] [INFO] [timer.py:258:stop] epoch=0/micro_step=16600/global_step=16600, RunningAvgSamplesPerSec=4.491691091912639, CurrSamplesPerSec=4.451911641159897, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:27:43,551] [INFO] [RANK 0]  iteration    16600/   20000 | elapsed time per iteration (ms): 935.2 | learning rate 1.809E-05 | total loss 3.095105E-01 | loss 3.095105E-01 | loss scale 32768.0 |speed 256.62 samples/(min*GPU)
[2024-06-17 10:27:43,555] [INFO] [RANK 0] time (ms) | forward: 381.29 | backward: 549.21 | allreduce: 0.00 | optimizer: 3.58 | batch generator: 35.43 | data loader: 4.18
[2024-06-17 10:27:52,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=16610, skipped=77, lr=[1.8049630351798976e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:27:52,772] [INFO] [timer.py:258:stop] epoch=0/micro_step=16610/global_step=16610, RunningAvgSamplesPerSec=4.491678861206981, CurrSamplesPerSec=4.483733479858335, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:28:01,842] [INFO] [logging.py:96:log_dist] [Rank 0] step=16620, skipped=77, lr=[1.8009331550060853e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:28:01,842] [INFO] [timer.py:258:stop] epoch=0/micro_step=16620/global_step=16620, RunningAvgSamplesPerSec=4.491675538135358, CurrSamplesPerSec=4.489024146823475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:28:10,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=16630, skipped=77, lr=[1.7969124019120013e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:28:10,919] [INFO] [timer.py:258:stop] epoch=0/micro_step=16630/global_step=16630, RunningAvgSamplesPerSec=4.491671826370043, CurrSamplesPerSec=4.478599924988354, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:28:19,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=16640, skipped=77, lr=[1.7929007858184512e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:28:19,999] [INFO] [timer.py:258:stop] epoch=0/micro_step=16640/global_step=16640, RunningAvgSamplesPerSec=4.491667424138701, CurrSamplesPerSec=4.48969566961489, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:28:29,079] [INFO] [logging.py:96:log_dist] [Rank 0] step=16650, skipped=77, lr=[1.7888983166237007e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:28:29,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=16650/global_step=16650, RunningAvgSamplesPerSec=4.491658608749691, CurrSamplesPerSec=4.481899657710908, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:28:29,080] [INFO] [RANK 0]  iteration    16650/   20000 | elapsed time per iteration (ms): 910.6 | learning rate 1.788E-05 | total loss 2.839894E-01 | loss 2.839894E-01 | loss scale 32768.0 |speed 263.56 samples/(min*GPU)
[2024-06-17 10:28:29,081] [INFO] [RANK 0] time (ms) | forward: 359.33 | backward: 547.18 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 17.36 | data loader: 0.35
[2024-06-17 10:28:38,149] [INFO] [logging.py:96:log_dist] [Rank 0] step=16660, skipped=77, lr=[1.784905004203444e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:28:38,149] [INFO] [timer.py:258:stop] epoch=0/micro_step=16660/global_step=16660, RunningAvgSamplesPerSec=4.4916509955256485, CurrSamplesPerSec=4.4928673936964625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:28:47,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=16670, skipped=77, lr=[1.7809208584107833e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:28:47,215] [INFO] [timer.py:258:stop] epoch=0/micro_step=16670/global_step=16670, RunningAvgSamplesPerSec=4.491644949149013, CurrSamplesPerSec=4.482946345618769, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:28:56,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=16680, skipped=77, lr=[1.7769458890762004e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:28:56,292] [INFO] [timer.py:258:stop] epoch=0/micro_step=16680/global_step=16680, RunningAvgSamplesPerSec=4.4916371123992365, CurrSamplesPerSec=4.4567994604199495, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:29:05,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=16690, skipped=77, lr=[1.772980106007539e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:29:05,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=16690/global_step=16690, RunningAvgSamplesPerSec=4.491630936500082, CurrSamplesPerSec=4.46990492815527, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:29:14,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=16700, skipped=77, lr=[1.7690235189899746e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:29:14,438] [INFO] [timer.py:258:stop] epoch=0/micro_step=16700/global_step=16700, RunningAvgSamplesPerSec=4.491623767367729, CurrSamplesPerSec=4.472661187147416, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:29:14,438] [INFO] [RANK 0]  iteration    16700/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 1.769E-05 | total loss 2.972820E-01 | loss 2.972820E-01 | loss scale 32768.0 |speed 264.56 samples/(min*GPU)
[2024-06-17 10:29:14,439] [INFO] [RANK 0] time (ms) | forward: 356.04 | backward: 547.21 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 13.86 | data loader: 0.09
[2024-06-17 10:29:23,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=16710, skipped=77, lr=[1.7650761377859914e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:29:23,534] [INFO] [timer.py:258:stop] epoch=0/micro_step=16710/global_step=16710, RunningAvgSamplesPerSec=4.491610672791535, CurrSamplesPerSec=4.457682847800135, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:29:32,624] [INFO] [logging.py:96:log_dist] [Rank 0] step=16720, skipped=77, lr=[1.7611379721353588e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:29:32,625] [INFO] [timer.py:258:stop] epoch=0/micro_step=16720/global_step=16720, RunningAvgSamplesPerSec=4.491602084420944, CurrSamplesPerSec=4.476367766618204, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:29:41,704] [INFO] [logging.py:96:log_dist] [Rank 0] step=16730, skipped=77, lr=[1.7572090317551124e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:29:41,705] [INFO] [timer.py:258:stop] epoch=0/micro_step=16730/global_step=16730, RunningAvgSamplesPerSec=4.491597658779809, CurrSamplesPerSec=4.487008383111821, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:29:50,795] [INFO] [logging.py:96:log_dist] [Rank 0] step=16740, skipped=77, lr=[1.7532893263395202e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:29:50,795] [INFO] [timer.py:258:stop] epoch=0/micro_step=16740/global_step=16740, RunningAvgSamplesPerSec=4.491592945249031, CurrSamplesPerSec=4.472793544458628, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:29:59,867] [INFO] [logging.py:96:log_dist] [Rank 0] step=16750, skipped=77, lr=[1.7493788655600654e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:29:59,867] [INFO] [timer.py:258:stop] epoch=0/micro_step=16750/global_step=16750, RunningAvgSamplesPerSec=4.491589007686065, CurrSamplesPerSec=4.493293356562355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:29:59,868] [INFO] [RANK 0]  iteration    16750/   20000 | elapsed time per iteration (ms): 908.6 | learning rate 1.749E-05 | total loss 2.835388E-01 | loss 2.835388E-01 | loss scale 32768.0 |speed 264.15 samples/(min*GPU)
[2024-06-17 10:29:59,868] [INFO] [RANK 0] time (ms) | forward: 357.41 | backward: 547.26 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 15.28 | data loader: 0.10
[2024-06-17 10:30:08,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=16760, skipped=77, lr=[1.7454776590654206e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:30:08,935] [INFO] [timer.py:258:stop] epoch=0/micro_step=16760/global_step=16760, RunningAvgSamplesPerSec=4.491585234701304, CurrSamplesPerSec=4.490631812010981, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:30:18,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=16770, skipped=77, lr=[1.741585716481427e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:30:18,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=16770/global_step=16770, RunningAvgSamplesPerSec=4.491581069076981, CurrSamplesPerSec=4.471266545831824, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:30:27,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=16780, skipped=77, lr=[1.737703047411065e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:30:27,075] [INFO] [timer.py:258:stop] epoch=0/micro_step=16780/global_step=16780, RunningAvgSamplesPerSec=4.491573542373776, CurrSamplesPerSec=4.472742269976121, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:30:36,175] [INFO] [logging.py:96:log_dist] [Rank 0] step=16790, skipped=77, lr=[1.7338296614344356e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:30:36,176] [INFO] [timer.py:258:stop] epoch=0/micro_step=16790/global_step=16790, RunningAvgSamplesPerSec=4.4915657232561506, CurrSamplesPerSec=4.490542867711493, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:30:45,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=16800, skipped=77, lr=[1.7299655681087307e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:30:45,279] [INFO] [timer.py:258:stop] epoch=0/micro_step=16800/global_step=16800, RunningAvgSamplesPerSec=4.491556187869767, CurrSamplesPerSec=4.4753301170340976, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:30:45,279] [INFO] [RANK 0]  iteration    16800/   20000 | elapsed time per iteration (ms): 908.2 | learning rate 1.730E-05 | total loss 3.024139E-01 | loss 3.024139E-01 | loss scale 32768.0 |speed 264.25 samples/(min*GPU)
[2024-06-17 10:30:45,279] [INFO] [RANK 0] time (ms) | forward: 357.07 | backward: 547.21 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 15.04 | data loader: 0.13
[2024-06-17 10:30:45,279] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:30:45,292] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/16800/mp_rank_00_model_states.pt
[2024-06-17 10:30:45,292] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/16800/mp_rank_00_model_states.pt...
[2024-06-17 10:31:10,283] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/16800/mp_rank_00_model_states.pt.
[2024-06-17 10:31:19,329] [INFO] [logging.py:96:log_dist] [Rank 0] step=16810, skipped=77, lr=[1.7261107769682206e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:31:19,329] [INFO] [timer.py:258:stop] epoch=0/micro_step=16810/global_step=16810, RunningAvgSamplesPerSec=4.491576104246441, CurrSamplesPerSec=4.542303497883336, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:31:28,357] [INFO] [logging.py:96:log_dist] [Rank 0] step=16820, skipped=77, lr=[1.722265297524215e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:31:28,358] [INFO] [timer.py:258:stop] epoch=0/micro_step=16820/global_step=16820, RunningAvgSamplesPerSec=4.491590741500335, CurrSamplesPerSec=4.514184775955152, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:31:37,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=16830, skipped=77, lr=[1.7184291392650552e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:31:37,427] [INFO] [timer.py:258:stop] epoch=0/micro_step=16830/global_step=16830, RunningAvgSamplesPerSec=4.491598240747394, CurrSamplesPerSec=4.509850335754667, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:31:46,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=16840, skipped=77, lr=[1.7146023116560795e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:31:46,461] [INFO] [timer.py:258:stop] epoch=0/micro_step=16840/global_step=16840, RunningAvgSamplesPerSec=4.4916065383935715, CurrSamplesPerSec=4.508007205410077, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:31:55,601] [INFO] [logging.py:96:log_dist] [Rank 0] step=16850, skipped=77, lr=[1.7107848241396045e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:31:55,602] [INFO] [timer.py:258:stop] epoch=0/micro_step=16850/global_step=16850, RunningAvgSamplesPerSec=4.491600664913628, CurrSamplesPerSec=4.462747167627105, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:31:55,602] [INFO] [RANK 0]  iteration    16850/   20000 | elapsed time per iteration (ms): 1406.5 | learning rate 1.710E-05 | total loss 2.962360E-01 | loss 2.962360E-01 | loss scale 32768.0 |speed 170.64 samples/(min*GPU)
[2024-06-17 10:31:55,602] [INFO] [RANK 0] time (ms) | forward: 358.18 | backward: 543.93 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 18.06 | data loader: 0.32
[2024-06-17 10:32:04,688] [INFO] [logging.py:96:log_dist] [Rank 0] step=16860, skipped=77, lr=[1.7069766861349e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:32:04,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=16860/global_step=16860, RunningAvgSamplesPerSec=4.491597683237976, CurrSamplesPerSec=4.463197121159198, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:32:13,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=16870, skipped=77, lr=[1.7031779070381707e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:32:13,874] [INFO] [timer.py:258:stop] epoch=0/micro_step=16870/global_step=16870, RunningAvgSamplesPerSec=4.491580212614222, CurrSamplesPerSec=4.4706958281859395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:32:23,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=16880, skipped=77, lr=[1.699388496222524e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:32:23,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=16880/global_step=16880, RunningAvgSamplesPerSec=4.491567503970861, CurrSamplesPerSec=4.472811431182588, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:32:32,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=16890, skipped=77, lr=[1.6956084630379563e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:32:32,156] [INFO] [timer.py:258:stop] epoch=0/micro_step=16890/global_step=16890, RunningAvgSamplesPerSec=4.491553827570585, CurrSamplesPerSec=4.480968348911155, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:32:41,324] [INFO] [logging.py:96:log_dist] [Rank 0] step=16900, skipped=77, lr=[1.6918378168113208e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:32:41,324] [INFO] [timer.py:258:stop] epoch=0/micro_step=16900/global_step=16900, RunningAvgSamplesPerSec=4.491547152294342, CurrSamplesPerSec=4.468100246931466, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:32:41,325] [INFO] [RANK 0]  iteration    16900/   20000 | elapsed time per iteration (ms): 914.5 | learning rate 1.691E-05 | total loss 3.596454E-01 | loss 3.596454E-01 | loss scale 32768.0 |speed 262.45 samples/(min*GPU)
[2024-06-17 10:32:41,325] [INFO] [RANK 0] time (ms) | forward: 363.03 | backward: 547.37 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 19.84 | data loader: 0.51
[2024-06-17 10:32:50,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=16910, skipped=77, lr=[1.688076566846315e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:32:50,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=16910/global_step=16910, RunningAvgSamplesPerSec=4.491537152781527, CurrSamplesPerSec=4.4889977224857445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:32:59,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=16920, skipped=77, lr=[1.684324722423449e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:32:59,628] [INFO] [timer.py:258:stop] epoch=0/micro_step=16920/global_step=16920, RunningAvgSamplesPerSec=4.491523430339813, CurrSamplesPerSec=4.432939085061819, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:33:08,775] [INFO] [logging.py:96:log_dist] [Rank 0] step=16930, skipped=77, lr=[1.6805822928000252e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:33:08,775] [INFO] [timer.py:258:stop] epoch=0/micro_step=16930/global_step=16930, RunningAvgSamplesPerSec=4.491512140164563, CurrSamplesPerSec=4.480770884578303, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:33:17,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=16940, skipped=77, lr=[1.6768492872101154e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:33:17,918] [INFO] [timer.py:258:stop] epoch=0/micro_step=16940/global_step=16940, RunningAvgSamplesPerSec=4.491498336041619, CurrSamplesPerSec=4.477218305414571, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:33:27,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=16950, skipped=77, lr=[1.6731257148645425e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:33:27,053] [INFO] [timer.py:258:stop] epoch=0/micro_step=16950/global_step=16950, RunningAvgSamplesPerSec=4.4914881284849875, CurrSamplesPerSec=4.468370380175467, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:33:27,054] [INFO] [RANK 0]  iteration    16950/   20000 | elapsed time per iteration (ms): 914.6 | learning rate 1.673E-05 | total loss 2.749541E-01 | loss 2.749541E-01 | loss scale 32768.0 |speed 262.42 samples/(min*GPU)
[2024-06-17 10:33:27,054] [INFO] [RANK 0] time (ms) | forward: 362.49 | backward: 547.97 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 19.55 | data loader: 0.43
[2024-06-17 10:33:33,448] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 10:33:34,352] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 10:33:36,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=16960, skipped=79, lr=[1.6701536550988184e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:33:36,171] [INFO] [timer.py:258:stop] epoch=0/micro_step=16960/global_step=16960, RunningAvgSamplesPerSec=4.491475929773145, CurrSamplesPerSec=4.468448927247812, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:33:45,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=16970, skipped=79, lr=[1.6664470857300065e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:33:45,309] [INFO] [timer.py:258:stop] epoch=0/micro_step=16970/global_step=16970, RunningAvgSamplesPerSec=4.491464848148991, CurrSamplesPerSec=4.480500446522042, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:33:54,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=16980, skipped=79, lr=[1.662749975271928e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:33:54,439] [INFO] [timer.py:258:stop] epoch=0/micro_step=16980/global_step=16980, RunningAvgSamplesPerSec=4.491451358163963, CurrSamplesPerSec=4.468522716407074, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:34:03,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=16990, skipped=79, lr=[1.6590623328468348e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:34:03,573] [INFO] [timer.py:258:stop] epoch=0/micro_step=16990/global_step=16990, RunningAvgSamplesPerSec=4.4914430439160515, CurrSamplesPerSec=4.484140933369255, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:34:12,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=17000, skipped=79, lr=[1.6553841675536202e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:34:12,733] [INFO] [timer.py:258:stop] epoch=0/micro_step=17000/global_step=17000, RunningAvgSamplesPerSec=4.491431786456988, CurrSamplesPerSec=4.460956563334158, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:34:12,734] [INFO] [RANK 0]  iteration    17000/   20000 | elapsed time per iteration (ms): 913.6 | learning rate 1.655E-05 | total loss 3.072977E-01 | loss 3.072977E-01 | loss scale 32768.0 |speed 262.70 samples/(min*GPU)
[2024-06-17 10:34:12,734] [INFO] [RANK 0] time (ms) | forward: 361.80 | backward: 547.82 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 18.77 | data loader: 0.41
[2024-06-17 10:34:19,450] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 10:34:19,450] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 10:34:19,450] [INFO] [RANK 0]  validation loss at iteration 17000 | loss: 8.628418E-01 | PPL: 2.369886E+00 loss 8.632812E-01 |
[2024-06-17 10:34:19,450] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 10:34:28,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=17010, skipped=79, lr=[1.6517154884677903e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:34:28,580] [INFO] [timer.py:258:stop] epoch=0/micro_step=17010/global_step=17010, RunningAvgSamplesPerSec=4.491418548244099, CurrSamplesPerSec=4.488415264963443, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:34:37,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=17020, skipped=79, lr=[1.6480563046414456e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:34:37,782] [INFO] [timer.py:258:stop] epoch=0/micro_step=17020/global_step=17020, RunningAvgSamplesPerSec=4.4914030588793645, CurrSamplesPerSec=4.483080510300905, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:34:46,917] [INFO] [logging.py:96:log_dist] [Rank 0] step=17030, skipped=79, lr=[1.6444066251032574e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:34:46,918] [INFO] [timer.py:258:stop] epoch=0/micro_step=17030/global_step=17030, RunningAvgSamplesPerSec=4.491390999710206, CurrSamplesPerSec=4.473664197654643, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:34:56,097] [INFO] [logging.py:96:log_dist] [Rank 0] step=17040, skipped=79, lr=[1.6407664588584513e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:34:56,098] [INFO] [timer.py:258:stop] epoch=0/micro_step=17040/global_step=17040, RunningAvgSamplesPerSec=4.491379716777651, CurrSamplesPerSec=4.481350162642843, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:35:05,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=17050, skipped=79, lr=[1.6371358148887703e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:35:05,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=17050/global_step=17050, RunningAvgSamplesPerSec=4.491367255913978, CurrSamplesPerSec=4.437305257122091, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:35:05,251] [INFO] [RANK 0]  iteration    17050/   20000 | elapsed time per iteration (ms): 1050.3 | learning rate 1.637E-05 | total loss 3.126404E-01 | loss 3.126404E-01 | loss scale 32768.0 |speed 228.50 samples/(min*GPU)
[2024-06-17 10:35:05,252] [INFO] [RANK 0] time (ms) | forward: 363.97 | backward: 547.96 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 24.52 | data loader: 0.67
[2024-06-17 10:35:14,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=17060, skipped=79, lr=[1.6335147021524714e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:35:14,418] [INFO] [timer.py:258:stop] epoch=0/micro_step=17060/global_step=17060, RunningAvgSamplesPerSec=4.491354644367703, CurrSamplesPerSec=4.483155981463697, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:35:23,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=17070, skipped=79, lr=[1.6299031295842888e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:35:23,542] [INFO] [timer.py:258:stop] epoch=0/micro_step=17070/global_step=17070, RunningAvgSamplesPerSec=4.491343441423469, CurrSamplesPerSec=4.432638084528953, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:35:32,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=17080, skipped=79, lr=[1.6263011060954192e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:35:32,665] [INFO] [timer.py:258:stop] epoch=0/micro_step=17080/global_step=17080, RunningAvgSamplesPerSec=4.49133424280382, CurrSamplesPerSec=4.483155981463697, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:35:41,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=17090, skipped=79, lr=[1.622708640573496e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:35:41,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=17090/global_step=17090, RunningAvgSamplesPerSec=4.491322939134867, CurrSamplesPerSec=4.46870600970227, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:35:50,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=17100, skipped=79, lr=[1.619125741882573e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:35:50,900] [INFO] [timer.py:258:stop] epoch=0/micro_step=17100/global_step=17100, RunningAvgSamplesPerSec=4.491311516683265, CurrSamplesPerSec=4.482239717791113, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:35:50,900] [INFO] [RANK 0]  iteration    17100/   20000 | elapsed time per iteration (ms): 913.0 | learning rate 1.619E-05 | total loss 2.542191E-01 | loss 2.542191E-01 | loss scale 32768.0 |speed 262.87 samples/(min*GPU)
[2024-06-17 10:35:50,901] [INFO] [RANK 0] time (ms) | forward: 361.02 | backward: 547.94 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 18.14 | data loader: 0.33
[2024-06-17 10:35:50,901] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:35:50,913] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/17100/mp_rank_00_model_states.pt
[2024-06-17 10:35:50,913] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/17100/mp_rank_00_model_states.pt...
[2024-06-17 10:36:21,351] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/17100/mp_rank_00_model_states.pt.
[2024-06-17 10:36:30,402] [INFO] [logging.py:96:log_dist] [Rank 0] step=17110, skipped=79, lr=[1.6155524188630958e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:36:30,403] [INFO] [timer.py:258:stop] epoch=0/micro_step=17110/global_step=17110, RunningAvgSamplesPerSec=4.491331712361242, CurrSamplesPerSec=4.525881384966077, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:36:39,447] [INFO] [logging.py:96:log_dist] [Rank 0] step=17120, skipped=79, lr=[1.6119886803318833e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:36:39,447] [INFO] [timer.py:258:stop] epoch=0/micro_step=17120/global_step=17120, RunningAvgSamplesPerSec=4.491344736364867, CurrSamplesPerSec=4.496024324365608, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:36:48,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=17130, skipped=79, lr=[1.6084345350821054e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:36:48,521] [INFO] [timer.py:258:stop] epoch=0/micro_step=17130/global_step=17130, RunningAvgSamplesPerSec=4.491351231442749, CurrSamplesPerSec=4.50342107424684, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:36:57,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=17140, skipped=79, lr=[1.6048899918832642e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:36:57,615] [INFO] [timer.py:258:stop] epoch=0/micro_step=17140/global_step=17140, RunningAvgSamplesPerSec=4.4913559004731525, CurrSamplesPerSec=4.486281279823813, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:37:06,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=17150, skipped=79, lr=[1.6013550594811664e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:37:06,964] [INFO] [timer.py:258:stop] epoch=0/micro_step=17150/global_step=17150, RunningAvgSamplesPerSec=4.491335536554157, CurrSamplesPerSec=4.427515638083692, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:37:06,965] [INFO] [RANK 0]  iteration    17150/   20000 | elapsed time per iteration (ms): 1521.3 | learning rate 1.601E-05 | total loss 3.156519E-01 | loss 3.156519E-01 | loss scale 32768.0 |speed 157.76 samples/(min*GPU)
[2024-06-17 10:37:06,965] [INFO] [RANK 0] time (ms) | forward: 363.36 | backward: 544.49 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 22.51 | data loader: 1.47
[2024-06-17 10:37:16,300] [INFO] [logging.py:96:log_dist] [Rank 0] step=17160, skipped=79, lr=[1.5978297465979063e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:37:16,301] [INFO] [timer.py:258:stop] epoch=0/micro_step=17160/global_step=17160, RunningAvgSamplesPerSec=4.491309059573167, CurrSamplesPerSec=4.416550333468028, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:37:25,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=17170, skipped=79, lr=[1.594314061931843e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:37:25,604] [INFO] [timer.py:258:stop] epoch=0/micro_step=17170/global_step=17170, RunningAvgSamplesPerSec=4.491279106581129, CurrSamplesPerSec=4.431382989963022, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:37:34,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=17180, skipped=79, lr=[1.5908080141575794e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:37:34,943] [INFO] [timer.py:258:stop] epoch=0/micro_step=17180/global_step=17180, RunningAvgSamplesPerSec=4.491254495440727, CurrSamplesPerSec=4.442482154966674, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:37:44,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=17190, skipped=79, lr=[1.5873116119259396e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:37:44,259] [INFO] [timer.py:258:stop] epoch=0/micro_step=17190/global_step=17190, RunningAvgSamplesPerSec=4.491226647122069, CurrSamplesPerSec=4.476447789500535, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:37:53,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=17200, skipped=79, lr=[1.5838248638639483e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:37:53,359] [INFO] [timer.py:258:stop] epoch=0/micro_step=17200/global_step=17200, RunningAvgSamplesPerSec=4.491216269097208, CurrSamplesPerSec=4.480823540032039, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:37:53,360] [INFO] [RANK 0]  iteration    17200/   20000 | elapsed time per iteration (ms): 927.9 | learning rate 1.583E-05 | total loss 2.808777E-01 | loss 2.808777E-01 | loss scale 32768.0 |speed 258.65 samples/(min*GPU)
[2024-06-17 10:37:53,360] [INFO] [RANK 0] time (ms) | forward: 373.94 | backward: 549.33 | allreduce: 0.00 | optimizer: 3.66 | batch generator: 28.28 | data loader: 2.14
[2024-06-17 10:38:02,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=17210, skipped=79, lr=[1.5803477785748093e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:38:02,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=17210/global_step=17210, RunningAvgSamplesPerSec=4.49121052338951, CurrSamplesPerSec=4.472998654145169, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:38:11,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=17220, skipped=79, lr=[1.576880364637887e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:38:11,588] [INFO] [timer.py:258:stop] epoch=0/micro_step=17220/global_step=17220, RunningAvgSamplesPerSec=4.491201639785578, CurrSamplesPerSec=4.480876196723343, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:38:20,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=17230, skipped=79, lr=[1.5734226306086777e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:38:20,699] [INFO] [timer.py:258:stop] epoch=0/micro_step=17230/global_step=17230, RunningAvgSamplesPerSec=4.491193666281465, CurrSamplesPerSec=4.474193911419729, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:38:29,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=17240, skipped=79, lr=[1.5699745850187987e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:38:29,836] [INFO] [timer.py:258:stop] epoch=0/micro_step=17240/global_step=17240, RunningAvgSamplesPerSec=4.491184739919807, CurrSamplesPerSec=4.477525391087872, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:38:38,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=17250, skipped=79, lr=[1.566536236375959e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:38:38,980] [INFO] [timer.py:258:stop] epoch=0/micro_step=17250/global_step=17250, RunningAvgSamplesPerSec=4.491176474497355, CurrSamplesPerSec=4.4828121889666575, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:38:38,981] [INFO] [RANK 0]  iteration    17250/   20000 | elapsed time per iteration (ms): 912.4 | learning rate 1.566E-05 | total loss 3.053970E-01 | loss 3.053970E-01 | loss scale 32768.0 |speed 263.03 samples/(min*GPU)
[2024-06-17 10:38:38,981] [INFO] [RANK 0] time (ms) | forward: 361.04 | backward: 547.32 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 18.58 | data loader: 0.19
[2024-06-17 10:38:48,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=17260, skipped=79, lr=[1.5631075931639418e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:38:48,096] [INFO] [timer.py:258:stop] epoch=0/micro_step=17260/global_step=17260, RunningAvgSamplesPerSec=4.491165384267357, CurrSamplesPerSec=4.484700703477075, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:38:57,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=17270, skipped=79, lr=[1.5596886638425827e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:38:57,176] [INFO] [timer.py:258:stop] epoch=0/micro_step=17270/global_step=17270, RunningAvgSamplesPerSec=4.491157419653321, CurrSamplesPerSec=4.480695493696741, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:39:06,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=17280, skipped=79, lr=[1.5562794568477516e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:39:06,308] [INFO] [timer.py:258:stop] epoch=0/micro_step=17280/global_step=17280, RunningAvgSamplesPerSec=4.491148717594381, CurrSamplesPerSec=4.483118844542233, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:39:15,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=17290, skipped=79, lr=[1.552879980591327e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:39:15,412] [INFO] [timer.py:258:stop] epoch=0/micro_step=17290/global_step=17290, RunningAvgSamplesPerSec=4.491138836047396, CurrSamplesPerSec=4.463959518631875, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:39:24,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=17300, skipped=79, lr=[1.5494902434611784e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:39:24,556] [INFO] [timer.py:258:stop] epoch=0/micro_step=17300/global_step=17300, RunningAvgSamplesPerSec=4.491129779208125, CurrSamplesPerSec=4.474722557170866, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:39:24,556] [INFO] [RANK 0]  iteration    17300/   20000 | elapsed time per iteration (ms): 911.5 | learning rate 1.549E-05 | total loss 2.710416E-01 | loss 2.710416E-01 | loss scale 32768.0 |speed 263.30 samples/(min*GPU)
[2024-06-17 10:39:24,557] [INFO] [RANK 0] time (ms) | forward: 359.86 | backward: 547.53 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 17.19 | data loader: 0.26
[2024-06-17 10:39:33,674] [INFO] [logging.py:96:log_dist] [Rank 0] step=17310, skipped=79, lr=[1.5461102538211452e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:39:33,675] [INFO] [timer.py:258:stop] epoch=0/micro_step=17310/global_step=17310, RunningAvgSamplesPerSec=4.491124362988831, CurrSamplesPerSec=4.473575924221367, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:39:42,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=17320, skipped=79, lr=[1.5427400200110162e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:39:42,791] [INFO] [timer.py:258:stop] epoch=0/micro_step=17320/global_step=17320, RunningAvgSamplesPerSec=4.491118087564922, CurrSamplesPerSec=4.476075169988352, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:39:51,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=17330, skipped=79, lr=[1.5393795503465092e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:39:51,874] [INFO] [timer.py:258:stop] epoch=0/micro_step=17330/global_step=17330, RunningAvgSamplesPerSec=4.4911095310847235, CurrSamplesPerSec=4.461165333811964, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:40:00,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=17340, skipped=79, lr=[1.5360288531192477e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:40:00,977] [INFO] [timer.py:258:stop] epoch=0/micro_step=17340/global_step=17340, RunningAvgSamplesPerSec=4.491101717990832, CurrSamplesPerSec=4.4748204240369205, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:40:10,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=17350, skipped=79, lr=[1.532687936596743e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:40:10,099] [INFO] [timer.py:258:stop] epoch=0/micro_step=17350/global_step=17350, RunningAvgSamplesPerSec=4.491090485164427, CurrSamplesPerSec=4.44322807738644, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:40:10,099] [INFO] [RANK 0]  iteration    17350/   20000 | elapsed time per iteration (ms): 910.9 | learning rate 1.532E-05 | total loss 2.587454E-01 | loss 2.587454E-01 | loss scale 32768.0 |speed 263.49 samples/(min*GPU)
[2024-06-17 10:40:10,099] [INFO] [RANK 0] time (ms) | forward: 359.47 | backward: 547.45 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 17.02 | data loader: 0.47
[2024-06-17 10:40:18,283] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 10:40:19,195] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 10:40:19,195] [INFO] [logging.py:96:log_dist] [Rank 0] step=17360, skipped=81, lr=[1.529689481042711e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:40:19,196] [INFO] [timer.py:258:stop] epoch=0/micro_step=17360/global_step=17360, RunningAvgSamplesPerSec=4.491082602627412, CurrSamplesPerSec=4.491051340057108, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:40:28,352] [INFO] [logging.py:96:log_dist] [Rank 0] step=17370, skipped=81, lr=[1.526698960529676e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:40:28,352] [INFO] [timer.py:258:stop] epoch=0/micro_step=17370/global_step=17370, RunningAvgSamplesPerSec=4.491070395896209, CurrSamplesPerSec=4.4749147144568, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:40:37,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=17380, skipped=81, lr=[1.523385473758164e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:40:37,488] [INFO] [timer.py:258:stop] epoch=0/micro_step=17380/global_step=17380, RunningAvgSamplesPerSec=4.491060738572995, CurrSamplesPerSec=4.478564059031823, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:40:46,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=17390, skipped=81, lr=[1.5200817988876903e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:40:46,596] [INFO] [timer.py:258:stop] epoch=0/micro_step=17390/global_step=17390, RunningAvgSamplesPerSec=4.491050986615787, CurrSamplesPerSec=4.472863899731504, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:40:55,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=17400, skipped=81, lr=[1.5167879440697473e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:40:55,981] [INFO] [timer.py:258:stop] epoch=0/micro_step=17400/global_step=17400, RunningAvgSamplesPerSec=4.491025237135868, CurrSamplesPerSec=4.420305373116711, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:40:55,981] [INFO] [RANK 0]  iteration    17400/   20000 | elapsed time per iteration (ms): 917.6 | learning rate 1.516E-05 | total loss 3.214233E-01 | loss 3.214233E-01 | loss scale 32768.0 |speed 261.54 samples/(min*GPU)
[2024-06-17 10:40:55,982] [INFO] [RANK 0] time (ms) | forward: 365.50 | backward: 548.14 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 22.00 | data loader: 1.03
[2024-06-17 10:40:55,982] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:40:55,997] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/17400/mp_rank_00_model_states.pt
[2024-06-17 10:40:55,997] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/17400/mp_rank_00_model_states.pt...
[2024-06-17 10:41:30,067] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/17400/mp_rank_00_model_states.pt.
[2024-06-17 10:41:39,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=17410, skipped=81, lr=[1.5135039174315931e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:41:39,504] [INFO] [timer.py:258:stop] epoch=0/micro_step=17410/global_step=17410, RunningAvgSamplesPerSec=4.490996637934049, CurrSamplesPerSec=4.537136867406539, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:41:48,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=17420, skipped=81, lr=[1.5102297270762363e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:41:48,527] [INFO] [timer.py:258:stop] epoch=0/micro_step=17420/global_step=17420, RunningAvgSamplesPerSec=4.491009638005557, CurrSamplesPerSec=4.524365512896851, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:41:57,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=17430, skipped=81, lr=[1.5069653810824161e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:41:57,616] [INFO] [timer.py:258:stop] epoch=0/micro_step=17430/global_step=17430, RunningAvgSamplesPerSec=4.491012465610214, CurrSamplesPerSec=4.512509228913362, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:42:06,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=17440, skipped=81, lr=[1.5037108875045825e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:42:06,680] [INFO] [timer.py:258:stop] epoch=0/micro_step=17440/global_step=17440, RunningAvgSamplesPerSec=4.491018053375804, CurrSamplesPerSec=4.495818302356703, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:42:15,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=17450, skipped=81, lr=[1.5004662543728755e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:42:15,769] [INFO] [timer.py:258:stop] epoch=0/micro_step=17450/global_step=17450, RunningAvgSamplesPerSec=4.491019210211967, CurrSamplesPerSec=4.495665304077184, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:42:15,769] [INFO] [RANK 0]  iteration    17450/   20000 | elapsed time per iteration (ms): 1595.8 | learning rate 1.500E-05 | total loss 2.822968E-01 | loss 2.822968E-01 | loss scale 32768.0 |speed 150.40 samples/(min*GPU)
[2024-06-17 10:42:15,770] [INFO] [RANK 0] time (ms) | forward: 364.53 | backward: 544.97 | allreduce: 0.00 | optimizer: 3.49 | batch generator: 22.22 | data loader: 1.23
[2024-06-17 10:42:24,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=17460, skipped=81, lr=[1.497231489693103e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:42:24,832] [INFO] [timer.py:258:stop] epoch=0/micro_step=17460/global_step=17460, RunningAvgSamplesPerSec=4.491018079802543, CurrSamplesPerSec=4.490183520540111, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:42:33,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=17470, skipped=81, lr=[1.4940066014467258e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:42:33,929] [INFO] [timer.py:258:stop] epoch=0/micro_step=17470/global_step=17470, RunningAvgSamplesPerSec=4.491011353551939, CurrSamplesPerSec=4.483189525018371, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:42:42,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=17480, skipped=81, lr=[1.4907915975908371e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:42:42,998] [INFO] [timer.py:258:stop] epoch=0/micro_step=17480/global_step=17480, RunningAvgSamplesPerSec=4.49100566564936, CurrSamplesPerSec=4.479776646878149, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:42:52,108] [INFO] [logging.py:96:log_dist] [Rank 0] step=17490, skipped=81, lr=[1.4875864860581359e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:42:52,109] [INFO] [timer.py:258:stop] epoch=0/micro_step=17490/global_step=17490, RunningAvgSamplesPerSec=4.490999442918033, CurrSamplesPerSec=4.486756389941901, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:43:01,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=17500, skipped=81, lr=[1.4843912747569195e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:43:01,212] [INFO] [timer.py:258:stop] epoch=0/micro_step=17500/global_step=17500, RunningAvgSamplesPerSec=4.490991093054863, CurrSamplesPerSec=4.471179558574976, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:43:01,213] [INFO] [RANK 0]  iteration    17500/   20000 | elapsed time per iteration (ms): 908.9 | learning rate 1.484E-05 | total loss 3.149469E-01 | loss 3.149469E-01 | loss scale 32768.0 |speed 264.06 samples/(min*GPU)
[2024-06-17 10:43:01,213] [INFO] [RANK 0] time (ms) | forward: 357.40 | backward: 547.23 | allreduce: 0.00 | optimizer: 3.46 | batch generator: 15.62 | data loader: 0.36
[2024-06-17 10:43:10,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=17510, skipped=81, lr=[1.4812059715710512e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:43:10,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=17510/global_step=17510, RunningAvgSamplesPerSec=4.490986861661107, CurrSamplesPerSec=4.475888883493928, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:43:19,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=17520, skipped=81, lr=[1.4780305843599538e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:43:19,362] [INFO] [timer.py:258:stop] epoch=0/micro_step=17520/global_step=17520, RunningAvgSamplesPerSec=4.490980863225837, CurrSamplesPerSec=4.4739839197855975, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:43:28,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=17530, skipped=81, lr=[1.474865120958575e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:43:28,433] [INFO] [timer.py:258:stop] epoch=0/micro_step=17530/global_step=17530, RunningAvgSamplesPerSec=4.490972496074417, CurrSamplesPerSec=4.463583037485421, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:43:37,518] [INFO] [logging.py:96:log_dist] [Rank 0] step=17540, skipped=81, lr=[1.4717095891773846e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:43:37,519] [INFO] [timer.py:258:stop] epoch=0/micro_step=17540/global_step=17540, RunningAvgSamplesPerSec=4.490965800246042, CurrSamplesPerSec=4.4790985212784475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:43:46,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=17550, skipped=81, lr=[1.4685639968023422e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:43:46,618] [INFO] [timer.py:258:stop] epoch=0/micro_step=17550/global_step=17550, RunningAvgSamplesPerSec=4.490955604753381, CurrSamplesPerSec=4.479090150640405, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:43:46,619] [INFO] [RANK 0]  iteration    17550/   20000 | elapsed time per iteration (ms): 908.1 | learning rate 1.468E-05 | total loss 2.424836E-01 | loss 2.424836E-01 | loss scale 32768.0 |speed 264.28 samples/(min*GPU)
[2024-06-17 10:43:46,619] [INFO] [RANK 0] time (ms) | forward: 357.15 | backward: 547.03 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 14.46 | data loader: 0.11
[2024-06-17 10:43:55,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=17560, skipped=81, lr=[1.4654283515948849e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:43:55,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=17560/global_step=17560, RunningAvgSamplesPerSec=4.490950199572241, CurrSamplesPerSec=4.484450168101234, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:44:04,769] [INFO] [logging.py:96:log_dist] [Rank 0] step=17570, skipped=81, lr=[1.4623026612919041e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:44:04,770] [INFO] [timer.py:258:stop] epoch=0/micro_step=17570/global_step=17570, RunningAvgSamplesPerSec=4.490944091439309, CurrSamplesPerSec=4.480878590238717, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:44:13,867] [INFO] [logging.py:96:log_dist] [Rank 0] step=17580, skipped=81, lr=[1.4591869336057313e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:44:13,868] [INFO] [timer.py:258:stop] epoch=0/micro_step=17580/global_step=17580, RunningAvgSamplesPerSec=4.490938275932601, CurrSamplesPerSec=4.478705135108224, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:44:22,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=17590, skipped=81, lr=[1.4560811762241149e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:44:22,978] [INFO] [timer.py:258:stop] epoch=0/micro_step=17590/global_step=17590, RunningAvgSamplesPerSec=4.4909274296857635, CurrSamplesPerSec=4.4808367040888415, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:44:32,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=17600, skipped=81, lr=[1.4529853968102017e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:44:32,071] [INFO] [timer.py:258:stop] epoch=0/micro_step=17600/global_step=17600, RunningAvgSamplesPerSec=4.490921637813512, CurrSamplesPerSec=4.488953282255658, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:44:32,072] [INFO] [RANK 0]  iteration    17600/   20000 | elapsed time per iteration (ms): 909.1 | learning rate 1.453E-05 | total loss 3.369974E-01 | loss 3.369974E-01 | loss scale 32768.0 |speed 264.01 samples/(min*GPU)
[2024-06-17 10:44:32,072] [INFO] [RANK 0] time (ms) | forward: 357.98 | backward: 547.13 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 15.45 | data loader: 0.16
[2024-06-17 10:44:41,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=17610, skipped=81, lr=[1.4498996030025194e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:44:41,157] [INFO] [timer.py:258:stop] epoch=0/micro_step=17610/global_step=17610, RunningAvgSamplesPerSec=4.490914294782915, CurrSamplesPerSec=4.47870991750385, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:44:50,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=17620, skipped=81, lr=[1.446823802414959e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:44:50,229] [INFO] [timer.py:258:stop] epoch=0/micro_step=17620/global_step=17620, RunningAvgSamplesPerSec=4.490910609396652, CurrSamplesPerSec=4.487247202761479, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:44:59,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=17630, skipped=81, lr=[1.4437580026367516e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:44:59,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=17630/global_step=17630, RunningAvgSamplesPerSec=4.490906619552398, CurrSamplesPerSec=4.490518829316445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:45:08,357] [INFO] [logging.py:96:log_dist] [Rank 0] step=17640, skipped=81, lr=[1.4407022112324537e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:45:08,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=17640/global_step=17640, RunningAvgSamplesPerSec=4.490902365367709, CurrSamplesPerSec=4.471756359183734, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:45:17,433] [INFO] [logging.py:96:log_dist] [Rank 0] step=17650, skipped=81, lr=[1.4376564357419257e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:45:17,434] [INFO] [timer.py:258:stop] epoch=0/micro_step=17650/global_step=17650, RunningAvgSamplesPerSec=4.490896998973384, CurrSamplesPerSec=4.490304898937993, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:45:17,434] [INFO] [RANK 0]  iteration    17650/   20000 | elapsed time per iteration (ms): 907.2 | learning rate 1.437E-05 | total loss 3.005872E-01 | loss 3.005872E-01 | loss scale 32768.0 |speed 264.54 samples/(min*GPU)
[2024-06-17 10:45:17,435] [INFO] [RANK 0] time (ms) | forward: 356.31 | backward: 547.00 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 14.34 | data loader: 0.22
[2024-06-17 10:45:26,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=17660, skipped=81, lr=[1.434620683680319e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:45:26,504] [INFO] [timer.py:258:stop] epoch=0/micro_step=17660/global_step=17660, RunningAvgSamplesPerSec=4.490893828861137, CurrSamplesPerSec=4.472676688049146, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:45:35,571] [INFO] [logging.py:96:log_dist] [Rank 0] step=17670, skipped=81, lr=[1.4315949625380458e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:45:35,572] [INFO] [timer.py:258:stop] epoch=0/micro_step=17670/global_step=17670, RunningAvgSamplesPerSec=4.490889216582463, CurrSamplesPerSec=4.466264920079724, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:45:44,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=17680, skipped=81, lr=[1.4285792797807754e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:45:44,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=17680/global_step=17680, RunningAvgSamplesPerSec=4.490885083833423, CurrSamplesPerSec=4.480745754002561, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:45:53,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=17690, skipped=81, lr=[1.4255736428494029e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:45:53,712] [INFO] [timer.py:258:stop] epoch=0/micro_step=17690/global_step=17690, RunningAvgSamplesPerSec=4.49087967828854, CurrSamplesPerSec=4.483980339908969, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:46:02,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=17700, skipped=81, lr=[1.422578059160042e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:46:02,756] [INFO] [timer.py:258:stop] epoch=0/micro_step=17700/global_step=17700, RunningAvgSamplesPerSec=4.490876334288156, CurrSamplesPerSec=4.488531744375562, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:46:02,757] [INFO] [RANK 0]  iteration    17700/   20000 | elapsed time per iteration (ms): 906.5 | learning rate 1.422E-05 | total loss 2.936813E-01 | loss 2.936813E-01 | loss scale 32768.0 |speed 264.77 samples/(min*GPU)
[2024-06-17 10:46:02,757] [INFO] [RANK 0] time (ms) | forward: 355.47 | backward: 547.03 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 13.83 | data loader: 0.16
[2024-06-17 10:46:02,757] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:46:02,771] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/17700/mp_rank_00_model_states.pt
[2024-06-17 10:46:02,771] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/17700/mp_rank_00_model_states.pt...
[2024-06-17 10:46:32,806] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/17700/mp_rank_00_model_states.pt.
[2024-06-17 10:46:41,796] [INFO] [logging.py:96:log_dist] [Rank 0] step=17710, skipped=81, lr=[1.4195925361039936e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:46:41,796] [INFO] [timer.py:258:stop] epoch=0/micro_step=17710/global_step=17710, RunningAvgSamplesPerSec=4.490899334995305, CurrSamplesPerSec=4.510928313810517, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:46:50,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=17720, skipped=81, lr=[1.4166170810477417e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:46:50,800] [INFO] [timer.py:258:stop] epoch=0/micro_step=17720/global_step=17720, RunningAvgSamplesPerSec=4.490917684176492, CurrSamplesPerSec=4.520951810189836, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:46:59,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=17730, skipped=81, lr=[1.4136517013329259e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:46:59,819] [INFO] [timer.py:258:stop] epoch=0/micro_step=17730/global_step=17730, RunningAvgSamplesPerSec=4.490930680772679, CurrSamplesPerSec=4.505542360737377, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:47:08,847] [INFO] [logging.py:96:log_dist] [Rank 0] step=17740, skipped=81, lr=[1.4106964042763245e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:47:08,848] [INFO] [timer.py:258:stop] epoch=0/micro_step=17740/global_step=17740, RunningAvgSamplesPerSec=4.490936660863078, CurrSamplesPerSec=4.491971210200769, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:47:17,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=17750, skipped=81, lr=[1.4077511971698393e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:47:17,891] [INFO] [timer.py:258:stop] epoch=0/micro_step=17750/global_step=17750, RunningAvgSamplesPerSec=4.490939629491609, CurrSamplesPerSec=4.495741199559891, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:47:17,892] [INFO] [RANK 0]  iteration    17750/   20000 | elapsed time per iteration (ms): 1502.7 | learning rate 1.407E-05 | total loss 2.726379E-01 | loss 2.726379E-01 | loss scale 32768.0 |speed 159.71 samples/(min*GPU)
[2024-06-17 10:47:17,892] [INFO] [RANK 0] time (ms) | forward: 354.70 | backward: 542.59 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 14.70 | data loader: 0.14
[2024-06-17 10:47:26,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=17760, skipped=81, lr=[1.4048160872804774e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:47:26,964] [INFO] [timer.py:258:stop] epoch=0/micro_step=17760/global_step=17760, RunningAvgSamplesPerSec=4.490937355004457, CurrSamplesPerSec=4.483495034066053, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:47:27,870] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 10:47:28,773] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 10:47:36,014] [INFO] [logging.py:96:log_dist] [Rank 0] step=17770, skipped=83, lr=[1.4024752742328398e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:47:36,014] [INFO] [timer.py:258:stop] epoch=0/micro_step=17770/global_step=17770, RunningAvgSamplesPerSec=4.490936768696165, CurrSamplesPerSec=4.488698668711441, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:47:45,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=17780, skipped=83, lr=[1.3995583575676168e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:47:45,099] [INFO] [timer.py:258:stop] epoch=0/micro_step=17780/global_step=17780, RunningAvgSamplesPerSec=4.490932310964312, CurrSamplesPerSec=4.478915570178073, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:47:54,165] [INFO] [logging.py:96:log_dist] [Rank 0] step=17790, skipped=83, lr=[1.3966515583345333e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:47:54,165] [INFO] [timer.py:258:stop] epoch=0/micro_step=17790/global_step=17790, RunningAvgSamplesPerSec=4.490925791016594, CurrSamplesPerSec=4.485092745615615, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:48:03,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=17800, skipped=83, lr=[1.393754883705827e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:48:03,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=17800/global_step=17800, RunningAvgSamplesPerSec=4.490921556703505, CurrSamplesPerSec=4.481257994750342, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:48:03,263] [INFO] [RANK 0]  iteration    17800/   20000 | elapsed time per iteration (ms): 907.4 | learning rate 1.393E-05 | total loss 2.597470E-01 | loss 2.597470E-01 | loss scale 32768.0 |speed 264.49 samples/(min*GPU)
[2024-06-17 10:48:03,263] [INFO] [RANK 0] time (ms) | forward: 356.86 | backward: 546.69 | allreduce: 0.00 | optimizer: 3.13 | batch generator: 15.01 | data loader: 0.15
[2024-06-17 10:48:12,370] [INFO] [logging.py:96:log_dist] [Rank 0] step=17810, skipped=83, lr=[1.390868340828756e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:48:12,371] [INFO] [timer.py:258:stop] epoch=0/micro_step=17810/global_step=17810, RunningAvgSamplesPerSec=4.490916051177295, CurrSamplesPerSec=4.48684398435816, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:48:21,447] [INFO] [logging.py:96:log_dist] [Rank 0] step=17820, skipped=83, lr=[1.3879919368255774e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:48:21,447] [INFO] [timer.py:258:stop] epoch=0/micro_step=17820/global_step=17820, RunningAvgSamplesPerSec=4.490912041241346, CurrSamplesPerSec=4.4774632536223296, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:48:30,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=17830, skipped=83, lr=[1.3851256787935322e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:48:30,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=17830/global_step=17830, RunningAvgSamplesPerSec=4.490906175989034, CurrSamplesPerSec=4.482709181272846, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:48:39,610] [INFO] [logging.py:96:log_dist] [Rank 0] step=17840, skipped=83, lr=[1.3822695738048257e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:48:39,611] [INFO] [timer.py:258:stop] epoch=0/micro_step=17840/global_step=17840, RunningAvgSamplesPerSec=4.4909022046090055, CurrSamplesPerSec=4.479843633387583, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:48:48,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=17850, skipped=83, lr=[1.3794236289066159e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:48:48,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=17850/global_step=17850, RunningAvgSamplesPerSec=4.490895914076104, CurrSamplesPerSec=4.4914505053988005, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:48:48,694] [INFO] [RANK 0]  iteration    17850/   20000 | elapsed time per iteration (ms): 908.6 | learning rate 1.379E-05 | total loss 2.880588E-01 | loss 2.880588E-01 | loss scale 32768.0 |speed 264.13 samples/(min*GPU)
[2024-06-17 10:48:48,694] [INFO] [RANK 0] time (ms) | forward: 357.83 | backward: 546.82 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 15.65 | data loader: 0.22
[2024-06-17 10:48:57,770] [INFO] [logging.py:96:log_dist] [Rank 0] step=17860, skipped=83, lr=[1.3765878511209869e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:48:57,770] [INFO] [timer.py:258:stop] epoch=0/micro_step=17860/global_step=17860, RunningAvgSamplesPerSec=4.490890266867615, CurrSamplesPerSec=4.489401328098576, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:49:06,841] [INFO] [logging.py:96:log_dist] [Rank 0] step=17870, skipped=83, lr=[1.3737622474449389e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:49:06,842] [INFO] [timer.py:258:stop] epoch=0/micro_step=17870/global_step=17870, RunningAvgSamplesPerSec=4.490886259081863, CurrSamplesPerSec=4.483297346986767, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:49:15,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=17880, skipped=83, lr=[1.3709468248503675e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:49:15,903] [INFO] [timer.py:258:stop] epoch=0/micro_step=17880/global_step=17880, RunningAvgSamplesPerSec=4.49088275443496, CurrSamplesPerSec=4.49367607004334, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:49:24,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=17890, skipped=83, lr=[1.3681415902840503e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:49:24,966] [INFO] [timer.py:258:stop] epoch=0/micro_step=17890/global_step=17890, RunningAvgSamplesPerSec=4.490878138565125, CurrSamplesPerSec=4.488537748632815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:49:34,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=17900, skipped=83, lr=[1.3653465506676218e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:49:34,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=17900/global_step=17900, RunningAvgSamplesPerSec=4.490873103721436, CurrSamplesPerSec=4.483493835910033, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:49:34,049] [INFO] [RANK 0]  iteration    17900/   20000 | elapsed time per iteration (ms): 907.1 | learning rate 1.365E-05 | total loss 3.308817E-01 | loss 3.308817E-01 | loss scale 32768.0 |speed 264.58 samples/(min*GPU)
[2024-06-17 10:49:34,050] [INFO] [RANK 0] time (ms) | forward: 356.42 | backward: 546.79 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.38 | data loader: 0.23
[2024-06-17 10:49:43,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=17910, skipped=83, lr=[1.3625617128975659e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:49:43,155] [INFO] [timer.py:258:stop] epoch=0/micro_step=17910/global_step=17910, RunningAvgSamplesPerSec=4.490863091923323, CurrSamplesPerSec=4.4555531300010465, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:49:52,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=17920, skipped=83, lr=[1.3597870838451926e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:49:52,252] [INFO] [timer.py:258:stop] epoch=0/micro_step=17920/global_step=17920, RunningAvgSamplesPerSec=4.490855645071206, CurrSamplesPerSec=4.475087789491934, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:50:01,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=17930, skipped=83, lr=[1.3570226703566248e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:50:01,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=17930/global_step=17930, RunningAvgSamplesPerSec=4.490850647073491, CurrSamplesPerSec=4.491496197523698, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:50:10,422] [INFO] [logging.py:96:log_dist] [Rank 0] step=17940, skipped=83, lr=[1.3542684792527752e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:50:10,422] [INFO] [timer.py:258:stop] epoch=0/micro_step=17940/global_step=17940, RunningAvgSamplesPerSec=4.490842156289043, CurrSamplesPerSec=4.472385765963176, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:50:19,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=17950, skipped=83, lr=[1.351524517329339e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:50:19,495] [INFO] [timer.py:258:stop] epoch=0/micro_step=17950/global_step=17950, RunningAvgSamplesPerSec=4.490836368566014, CurrSamplesPerSec=4.474306074118325, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:50:19,496] [INFO] [RANK 0]  iteration    17950/   20000 | elapsed time per iteration (ms): 908.9 | learning rate 1.351E-05 | total loss 2.414282E-01 | loss 2.414282E-01 | loss scale 32768.0 |speed 264.05 samples/(min*GPU)
[2024-06-17 10:50:19,496] [INFO] [RANK 0] time (ms) | forward: 357.89 | backward: 547.04 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 15.13 | data loader: 0.16
[2024-06-17 10:50:28,582] [INFO] [logging.py:96:log_dist] [Rank 0] step=17960, skipped=83, lr=[1.348790791356768e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:50:28,583] [INFO] [timer.py:258:stop] epoch=0/micro_step=17960/global_step=17960, RunningAvgSamplesPerSec=4.490830532882783, CurrSamplesPerSec=4.480877393480711, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:50:37,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=17970, skipped=83, lr=[1.3460673080802604e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:50:37,660] [INFO] [timer.py:258:stop] epoch=0/micro_step=17970/global_step=17970, RunningAvgSamplesPerSec=4.4908270189542305, CurrSamplesPerSec=4.488480108426286, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:50:46,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=17980, skipped=83, lr=[1.343354074219739e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:50:46,728] [INFO] [timer.py:258:stop] epoch=0/micro_step=17980/global_step=17980, RunningAvgSamplesPerSec=4.490821097099431, CurrSamplesPerSec=4.471027041144005, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:50:55,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=17990, skipped=83, lr=[1.3406510964698395e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:50:55,781] [INFO] [timer.py:258:stop] epoch=0/micro_step=17990/global_step=17990, RunningAvgSamplesPerSec=4.490818420050098, CurrSamplesPerSec=4.482151105615988, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:51:04,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=18000, skipped=83, lr=[1.3379583814998915e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:51:04,844] [INFO] [timer.py:258:stop] epoch=0/micro_step=18000/global_step=18000, RunningAvgSamplesPerSec=4.490813852572163, CurrSamplesPerSec=4.478156423030192, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:51:04,845] [INFO] [RANK 0]  iteration    18000/   20000 | elapsed time per iteration (ms): 907.0 | learning rate 1.338E-05 | total loss 2.560529E-01 | loss 2.560529E-01 | loss scale 32768.0 |speed 264.61 samples/(min*GPU)
[2024-06-17 10:51:04,845] [INFO] [RANK 0] time (ms) | forward: 355.97 | backward: 547.10 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 14.25 | data loader: 0.11
[2024-06-17 10:51:04,845] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:51:04,857] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/18000/mp_rank_00_model_states.pt
[2024-06-17 10:51:04,857] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/18000/mp_rank_00_model_states.pt...
[2024-06-17 10:51:32,568] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/18000/mp_rank_00_model_states.pt.
[2024-06-17 10:51:39,176] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 10:51:39,177] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 10:51:39,177] [INFO] [RANK 0]  validation loss at iteration 18000 | loss: 8.789062E-01 | PPL: 2.408264E+00 loss 8.779297E-01 |
[2024-06-17 10:51:39,177] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 10:51:48,216] [INFO] [logging.py:96:log_dist] [Rank 0] step=18010, skipped=83, lr=[1.3352759359539008e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:51:48,217] [INFO] [timer.py:258:stop] epoch=0/micro_step=18010/global_step=18010, RunningAvgSamplesPerSec=4.4908322147093624, CurrSamplesPerSec=4.516181271588668, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:51:57,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=18020, skipped=83, lr=[1.3326037664505342e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:51:57,279] [INFO] [timer.py:258:stop] epoch=0/micro_step=18020/global_step=18020, RunningAvgSamplesPerSec=4.490841606332339, CurrSamplesPerSec=4.4728782095493935, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:52:06,371] [INFO] [logging.py:96:log_dist] [Rank 0] step=18030, skipped=83, lr=[1.329941879583106e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:52:06,372] [INFO] [timer.py:258:stop] epoch=0/micro_step=18030/global_step=18030, RunningAvgSamplesPerSec=4.4908495462402565, CurrSamplesPerSec=4.505757745522634, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:52:15,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=18040, skipped=83, lr=[1.3272902819195567e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:52:15,437] [INFO] [timer.py:258:stop] epoch=0/micro_step=18040/global_step=18040, RunningAvgSamplesPerSec=4.4908511135709395, CurrSamplesPerSec=4.475845896504899, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:52:24,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=18050, skipped=83, lr=[1.3246489800024398e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:52:24,535] [INFO] [timer.py:258:stop] epoch=0/micro_step=18050/global_step=18050, RunningAvgSamplesPerSec=4.49084891710316, CurrSamplesPerSec=4.484372256107095, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:52:24,535] [INFO] [RANK 0]  iteration    18050/   20000 | elapsed time per iteration (ms): 1593.8 | learning rate 1.324E-05 | total loss 2.870749E-01 | loss 2.870749E-01 | loss scale 32768.0 |speed 150.58 samples/(min*GPU)
[2024-06-17 10:52:24,535] [INFO] [RANK 0] time (ms) | forward: 358.74 | backward: 544.38 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 22.13 | data loader: 0.22
[2024-06-17 10:52:33,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=18060, skipped=83, lr=[1.3220179803489045e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:52:33,636] [INFO] [timer.py:258:stop] epoch=0/micro_step=18060/global_step=18060, RunningAvgSamplesPerSec=4.490845043954147, CurrSamplesPerSec=4.47209845793624, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:52:42,712] [INFO] [logging.py:96:log_dist] [Rank 0] step=18070, skipped=83, lr=[1.3193972894506836e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:52:42,712] [INFO] [timer.py:258:stop] epoch=0/micro_step=18070/global_step=18070, RunningAvgSamplesPerSec=4.490839595183046, CurrSamplesPerSec=4.481089229605524, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:52:51,795] [INFO] [logging.py:96:log_dist] [Rank 0] step=18080, skipped=83, lr=[1.316786913774068e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:52:51,796] [INFO] [timer.py:258:stop] epoch=0/micro_step=18080/global_step=18080, RunningAvgSamplesPerSec=4.490836346164389, CurrSamplesPerSec=4.474977974813803, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:53:00,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=18090, skipped=83, lr=[1.3141868597599025e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:53:00,926] [INFO] [timer.py:258:stop] epoch=0/micro_step=18090/global_step=18090, RunningAvgSamplesPerSec=4.490826405634424, CurrSamplesPerSec=4.473156076663101, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:53:10,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=18100, skipped=83, lr=[1.3115971338235597e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:53:10,048] [INFO] [timer.py:258:stop] epoch=0/micro_step=18100/global_step=18100, RunningAvgSamplesPerSec=4.490819365480304, CurrSamplesPerSec=4.448269023350129, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:53:10,049] [INFO] [RANK 0]  iteration    18100/   20000 | elapsed time per iteration (ms): 910.3 | learning rate 1.311E-05 | total loss 2.973442E-01 | loss 2.973442E-01 | loss scale 32768.0 |speed 263.66 samples/(min*GPU)
[2024-06-17 10:53:10,049] [INFO] [RANK 0] time (ms) | forward: 358.97 | backward: 547.30 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 17.00 | data loader: 0.20
[2024-06-17 10:53:19,142] [INFO] [logging.py:96:log_dist] [Rank 0] step=18110, skipped=83, lr=[1.3090177423549348e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:53:19,143] [INFO] [timer.py:258:stop] epoch=0/micro_step=18110/global_step=18110, RunningAvgSamplesPerSec=4.490814670550748, CurrSamplesPerSec=4.486641202491008, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:53:28,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=18120, skipped=83, lr=[1.3064486917184158e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:53:28,244] [INFO] [timer.py:258:stop] epoch=0/micro_step=18120/global_step=18120, RunningAvgSamplesPerSec=4.490808993044424, CurrSamplesPerSec=4.477613820454722, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:53:37,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=18130, skipped=83, lr=[1.3038899882528817e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:53:37,363] [INFO] [timer.py:258:stop] epoch=0/micro_step=18130/global_step=18130, RunningAvgSamplesPerSec=4.490803602174446, CurrSamplesPerSec=4.490355375055068, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:53:46,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=18140, skipped=83, lr=[1.3013416382716786e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:53:46,470] [INFO] [timer.py:258:stop] epoch=0/micro_step=18140/global_step=18140, RunningAvgSamplesPerSec=4.490794573499088, CurrSamplesPerSec=4.481383679180118, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:53:55,553] [INFO] [logging.py:96:log_dist] [Rank 0] step=18150, skipped=83, lr=[1.2988036480626068e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:53:55,553] [INFO] [timer.py:258:stop] epoch=0/micro_step=18150/global_step=18150, RunningAvgSamplesPerSec=4.490790870940569, CurrSamplesPerSec=4.482512761116967, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:53:55,554] [INFO] [RANK 0]  iteration    18150/   20000 | elapsed time per iteration (ms): 910.1 | learning rate 1.299E-05 | total loss 2.854691E-01 | loss 2.854691E-01 | loss scale 32768.0 |speed 263.71 samples/(min*GPU)
[2024-06-17 10:53:55,554] [INFO] [RANK 0] time (ms) | forward: 358.99 | backward: 547.19 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 16.88 | data loader: 0.41
[2024-06-17 10:54:04,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=18160, skipped=83, lr=[1.296276023887904e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:54:04,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=18160/global_step=18160, RunningAvgSamplesPerSec=4.490783251915703, CurrSamplesPerSec=4.460796440129794, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:54:07,386] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 10:54:08,294] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 10:54:13,760] [INFO] [logging.py:96:log_dist] [Rank 0] step=18170, skipped=85, lr=[1.2942613922847854e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:54:13,761] [INFO] [timer.py:258:stop] epoch=0/micro_step=18170/global_step=18170, RunningAvgSamplesPerSec=4.490770300295848, CurrSamplesPerSec=4.467618372254841, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:54:22,858] [INFO] [logging.py:96:log_dist] [Rank 0] step=18180, skipped=85, lr=[1.2917524426711374e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:54:22,858] [INFO] [timer.py:258:stop] epoch=0/micro_step=18180/global_step=18180, RunningAvgSamplesPerSec=4.490756022359345, CurrSamplesPerSec=4.460586518232283, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:54:31,962] [INFO] [logging.py:96:log_dist] [Rank 0] step=18190, skipped=85, lr=[1.2892538764900087e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:54:31,962] [INFO] [timer.py:258:stop] epoch=0/micro_step=18190/global_step=18190, RunningAvgSamplesPerSec=4.490740561816448, CurrSamplesPerSec=4.456501129849407, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:54:41,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=18200, skipped=85, lr=[1.2867656999063606e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:54:41,055] [INFO] [timer.py:258:stop] epoch=0/micro_step=18200/global_step=18200, RunningAvgSamplesPerSec=4.490731168195767, CurrSamplesPerSec=4.474822811087133, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:54:41,056] [INFO] [RANK 0]  iteration    18200/   20000 | elapsed time per iteration (ms): 910.0 | learning rate 1.287E-05 | total loss 3.077370E-01 | loss 3.077370E-01 | loss scale 32768.0 |speed 263.72 samples/(min*GPU)
[2024-06-17 10:54:41,056] [INFO] [RANK 0] time (ms) | forward: 358.28 | backward: 547.49 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 14.44 | data loader: 0.19
[2024-06-17 10:54:50,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=18210, skipped=85, lr=[1.2842879190595237e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:54:50,155] [INFO] [timer.py:258:stop] epoch=0/micro_step=18210/global_step=18210, RunningAvgSamplesPerSec=4.490720358720105, CurrSamplesPerSec=4.466511049394286, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:54:59,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=18220, skipped=85, lr=[1.2818205400631745e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:54:59,263] [INFO] [timer.py:258:stop] epoch=0/micro_step=18220/global_step=18220, RunningAvgSamplesPerSec=4.490713190041324, CurrSamplesPerSec=4.484061833660205, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:55:08,393] [INFO] [logging.py:96:log_dist] [Rank 0] step=18230, skipped=85, lr=[1.2793635690053266e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:55:08,394] [INFO] [timer.py:258:stop] epoch=0/micro_step=18230/global_step=18230, RunningAvgSamplesPerSec=4.490704104632139, CurrSamplesPerSec=4.455848966804525, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:55:17,554] [INFO] [logging.py:96:log_dist] [Rank 0] step=18240, skipped=85, lr=[1.2769170119483097e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:55:17,554] [INFO] [timer.py:258:stop] epoch=0/micro_step=18240/global_step=18240, RunningAvgSamplesPerSec=4.490695342016365, CurrSamplesPerSec=4.480358060842036, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:55:26,670] [INFO] [logging.py:96:log_dist] [Rank 0] step=18250, skipped=85, lr=[1.2744808749287621e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:55:26,670] [INFO] [timer.py:258:stop] epoch=0/micro_step=18250/global_step=18250, RunningAvgSamplesPerSec=4.490689141320627, CurrSamplesPerSec=4.46866554105795, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:55:26,671] [INFO] [RANK 0]  iteration    18250/   20000 | elapsed time per iteration (ms): 912.3 | learning rate 1.274E-05 | total loss 2.310330E-01 | loss 2.310330E-01 | loss scale 32768.0 |speed 263.07 samples/(min*GPU)
[2024-06-17 10:55:26,671] [INFO] [RANK 0] time (ms) | forward: 360.55 | backward: 547.59 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 18.02 | data loader: 0.27
[2024-06-17 10:55:35,761] [INFO] [logging.py:96:log_dist] [Rank 0] step=18260, skipped=85, lr=[1.2720551639576097e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:55:35,761] [INFO] [timer.py:258:stop] epoch=0/micro_step=18260/global_step=18260, RunningAvgSamplesPerSec=4.4906813460833135, CurrSamplesPerSec=4.471610953266843, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:55:44,895] [INFO] [logging.py:96:log_dist] [Rank 0] step=18270, skipped=85, lr=[1.2696398850200524e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:55:44,895] [INFO] [timer.py:258:stop] epoch=0/micro_step=18270/global_step=18270, RunningAvgSamplesPerSec=4.49066765227648, CurrSamplesPerSec=4.458448101616336, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:55:53,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=18280, skipped=85, lr=[1.2672350440755502e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:55:53,991] [INFO] [timer.py:258:stop] epoch=0/micro_step=18280/global_step=18280, RunningAvgSamplesPerSec=4.490659940662568, CurrSamplesPerSec=4.486274081959484, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:56:03,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=18290, skipped=85, lr=[1.2648406470578114e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:56:03,085] [INFO] [timer.py:258:stop] epoch=0/micro_step=18290/global_step=18290, RunningAvgSamplesPerSec=4.490650990699561, CurrSamplesPerSec=4.4784457054508895, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:56:12,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=18300, skipped=85, lr=[1.2624566998747703e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:56:12,204] [INFO] [timer.py:258:stop] epoch=0/micro_step=18300/global_step=18300, RunningAvgSamplesPerSec=4.490641985719472, CurrSamplesPerSec=4.476542148515119, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:56:12,205] [INFO] [RANK 0]  iteration    18300/   20000 | elapsed time per iteration (ms): 910.7 | learning rate 1.262E-05 | total loss 3.324146E-01 | loss 3.324146E-01 | loss scale 32768.0 |speed 263.54 samples/(min*GPU)
[2024-06-17 10:56:12,205] [INFO] [RANK 0] time (ms) | forward: 359.08 | backward: 547.45 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 15.91 | data loader: 0.39
[2024-06-17 10:56:12,205] [INFO] [RANK 0] Saving Model...
[2024-06-17 10:56:12,218] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/18300/mp_rank_00_model_states.pt
[2024-06-17 10:56:12,218] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/18300/mp_rank_00_model_states.pt...
[2024-06-17 10:56:37,898] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/18300/mp_rank_00_model_states.pt.
[2024-06-17 10:56:46,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=18310, skipped=85, lr=[1.260083208408581e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:56:46,943] [INFO] [timer.py:258:stop] epoch=0/micro_step=18310/global_step=18310, RunningAvgSamplesPerSec=4.490659910129825, CurrSamplesPerSec=4.510694243286137, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:56:55,957] [INFO] [logging.py:96:log_dist] [Rank 0] step=18320, skipped=85, lr=[1.2577201785155966e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:56:55,957] [INFO] [timer.py:258:stop] epoch=0/micro_step=18320/global_step=18320, RunningAvgSamplesPerSec=4.490672065764399, CurrSamplesPerSec=4.512457039821107, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:57:04,974] [INFO] [logging.py:96:log_dist] [Rank 0] step=18330, skipped=85, lr=[1.25536761602636e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:57:04,974] [INFO] [timer.py:258:stop] epoch=0/micro_step=18330/global_step=18330, RunningAvgSamplesPerSec=4.490682478913099, CurrSamplesPerSec=4.507614780551815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:57:14,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=18340, skipped=85, lr=[1.2530255267455842e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:57:14,008] [INFO] [timer.py:258:stop] epoch=0/micro_step=18340/global_step=18340, RunningAvgSamplesPerSec=4.490690263385168, CurrSamplesPerSec=4.497163207636689, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:57:23,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=18350, skipped=85, lr=[1.2506939164521419e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:57:23,059] [INFO] [timer.py:258:stop] epoch=0/micro_step=18350/global_step=18350, RunningAvgSamplesPerSec=4.490689846385573, CurrSamplesPerSec=4.480533950350224, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:57:23,060] [INFO] [RANK 0]  iteration    18350/   20000 | elapsed time per iteration (ms): 1417.1 | learning rate 1.250E-05 | total loss 2.701401E-01 | loss 2.701401E-01 | loss scale 32768.0 |speed 169.36 samples/(min*GPU)
[2024-06-17 10:57:23,060] [INFO] [RANK 0] time (ms) | forward: 355.32 | backward: 543.67 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 15.24 | data loader: 0.12
[2024-06-17 10:57:32,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=18360, skipped=85, lr=[1.2483727908990488e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:57:32,119] [INFO] [timer.py:258:stop] epoch=0/micro_step=18360/global_step=18360, RunningAvgSamplesPerSec=4.490689045890323, CurrSamplesPerSec=4.471307061599943, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:57:41,184] [INFO] [logging.py:96:log_dist] [Rank 0] step=18370, skipped=85, lr=[1.2460621558134535e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:57:41,185] [INFO] [timer.py:258:stop] epoch=0/micro_step=18370/global_step=18370, RunningAvgSamplesPerSec=4.4906852788215375, CurrSamplesPerSec=4.483069728913651, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:57:50,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=18380, skipped=85, lr=[1.2437620168966165e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:57:50,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=18380/global_step=18380, RunningAvgSamplesPerSec=4.490684314706982, CurrSamplesPerSec=4.489014537937397, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:57:59,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=18390, skipped=85, lr=[1.2414723798239033e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:57:59,313] [INFO] [timer.py:258:stop] epoch=0/micro_step=18390/global_step=18390, RunningAvgSamplesPerSec=4.490679452919226, CurrSamplesPerSec=4.469152403673518, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:58:08,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=18400, skipped=85, lr=[1.2391932502447647e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:58:08,378] [INFO] [timer.py:258:stop] epoch=0/micro_step=18400/global_step=18400, RunningAvgSamplesPerSec=4.490678633357375, CurrSamplesPerSec=4.4905885413711255, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:58:08,379] [INFO] [RANK 0]  iteration    18400/   20000 | elapsed time per iteration (ms): 906.4 | learning rate 1.239E-05 | total loss 2.472867E-01 | loss 2.472867E-01 | loss scale 32768.0 |speed 264.79 samples/(min*GPU)
[2024-06-17 10:58:08,379] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 546.77 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.40 | data loader: 0.09
[2024-06-17 10:58:17,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=18410, skipped=85, lr=[1.2369246337827269e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:58:17,436] [INFO] [timer.py:258:stop] epoch=0/micro_step=18410/global_step=18410, RunningAvgSamplesPerSec=4.4906746886959, CurrSamplesPerSec=4.491318243961882, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:58:26,497] [INFO] [logging.py:96:log_dist] [Rank 0] step=18420, skipped=85, lr=[1.2346665360353751e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:58:26,498] [INFO] [timer.py:258:stop] epoch=0/micro_step=18420/global_step=18420, RunningAvgSamplesPerSec=4.490669684881563, CurrSamplesPerSec=4.482384618220737, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:58:35,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=18430, skipped=85, lr=[1.2324189625743421e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:58:35,564] [INFO] [timer.py:258:stop] epoch=0/micro_step=18430/global_step=18430, RunningAvgSamplesPerSec=4.490665790074113, CurrSamplesPerSec=4.481885290111315, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:58:44,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=18440, skipped=85, lr=[1.230181918945291e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:58:44,623] [INFO] [timer.py:258:stop] epoch=0/micro_step=18440/global_step=18440, RunningAvgSamplesPerSec=4.490663087211582, CurrSamplesPerSec=4.482593003857059, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:58:53,696] [INFO] [logging.py:96:log_dist] [Rank 0] step=18450, skipped=85, lr=[1.2279554106679044e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:58:53,697] [INFO] [timer.py:258:stop] epoch=0/micro_step=18450/global_step=18450, RunningAvgSamplesPerSec=4.49065733956985, CurrSamplesPerSec=4.465224817994595, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:58:53,697] [INFO] [RANK 0]  iteration    18450/   20000 | elapsed time per iteration (ms): 906.4 | learning rate 1.228E-05 | total loss 3.480435E-01 | loss 3.480435E-01 | loss scale 32768.0 |speed 264.79 samples/(min*GPU)
[2024-06-17 10:58:53,698] [INFO] [RANK 0] time (ms) | forward: 355.59 | backward: 546.86 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 13.61 | data loader: 0.10
[2024-06-17 10:59:02,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=18460, skipped=85, lr=[1.2257394432358702e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:59:02,772] [INFO] [timer.py:258:stop] epoch=0/micro_step=18460/global_step=18460, RunningAvgSamplesPerSec=4.490652809011648, CurrSamplesPerSec=4.467988395150762, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:59:11,838] [INFO] [logging.py:96:log_dist] [Rank 0] step=18470, skipped=85, lr=[1.2235340221168692e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:59:11,839] [INFO] [timer.py:258:stop] epoch=0/micro_step=18470/global_step=18470, RunningAvgSamplesPerSec=4.490649392345941, CurrSamplesPerSec=4.487986624757574, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:59:20,896] [INFO] [logging.py:96:log_dist] [Rank 0] step=18480, skipped=85, lr=[1.2213391527525571e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:59:20,897] [INFO] [timer.py:258:stop] epoch=0/micro_step=18480/global_step=18480, RunningAvgSamplesPerSec=4.49064796579556, CurrSamplesPerSec=4.491692203238089, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:59:29,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=18490, skipped=85, lr=[1.2191548405585569e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:59:29,954] [INFO] [timer.py:258:stop] epoch=0/micro_step=18490/global_step=18490, RunningAvgSamplesPerSec=4.4906468447304935, CurrSamplesPerSec=4.494220164931497, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:59:39,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=18500, skipped=85, lr=[1.2169810909244406e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:59:39,012] [INFO] [timer.py:258:stop] epoch=0/micro_step=18500/global_step=18500, RunningAvgSamplesPerSec=4.490645225124768, CurrSamplesPerSec=4.495520748341701, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:59:39,013] [INFO] [RANK 0]  iteration    18500/   20000 | elapsed time per iteration (ms): 906.3 | learning rate 1.217E-05 | total loss 2.910770E-01 | loss 2.910770E-01 | loss scale 32768.0 |speed 264.81 samples/(min*GPU)
[2024-06-17 10:59:39,013] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 546.74 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 14.25 | data loader: 0.09
[2024-06-17 10:59:48,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=18510, skipped=85, lr=[1.2148179092137204e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:59:48,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=18510/global_step=18510, RunningAvgSamplesPerSec=4.490642601550695, CurrSamplesPerSec=4.489939581825734, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 10:59:57,161] [INFO] [logging.py:96:log_dist] [Rank 0] step=18520, skipped=85, lr=[1.2126653007638323e-05], mom=[[0.9, 0.95]]
[2024-06-17 10:59:57,161] [INFO] [timer.py:258:stop] epoch=0/micro_step=18520/global_step=18520, RunningAvgSamplesPerSec=4.490641005461227, CurrSamplesPerSec=4.47649795455734, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:00:06,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=18530, skipped=85, lr=[1.2105232708861228e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:00:06,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=18530/global_step=18530, RunningAvgSamplesPerSec=4.490634888113675, CurrSamplesPerSec=4.469328605039724, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:00:15,314] [INFO] [logging.py:96:log_dist] [Rank 0] step=18540, skipped=85, lr=[1.2083918248658377e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:00:15,314] [INFO] [timer.py:258:stop] epoch=0/micro_step=18540/global_step=18540, RunningAvgSamplesPerSec=4.490633998945604, CurrSamplesPerSec=4.482518749281956, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:00:24,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=18550, skipped=85, lr=[1.20627096796211e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:00:24,381] [INFO] [timer.py:258:stop] epoch=0/micro_step=18550/global_step=18550, RunningAvgSamplesPerSec=4.490630913706178, CurrSamplesPerSec=4.463123507777844, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:00:24,382] [INFO] [RANK 0]  iteration    18550/   20000 | elapsed time per iteration (ms): 907.4 | learning rate 1.206E-05 | total loss 3.103674E-01 | loss 3.103674E-01 | loss scale 32768.0 |speed 264.50 samples/(min*GPU)
[2024-06-17 11:00:24,382] [INFO] [RANK 0] time (ms) | forward: 356.80 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 15.12 | data loader: 0.11
[2024-06-17 11:00:33,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=18560, skipped=85, lr=[1.2041607054079402e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:00:33,431] [INFO] [timer.py:258:stop] epoch=0/micro_step=18560/global_step=18560, RunningAvgSamplesPerSec=4.490631401573041, CurrSamplesPerSec=4.492140796022698, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:00:37,966] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 11:00:38,867] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 11:00:42,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=18570, skipped=87, lr=[1.2024801267961788e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:00:42,499] [INFO] [timer.py:258:stop] epoch=0/micro_step=18570/global_step=18570, RunningAvgSamplesPerSec=4.490631256531882, CurrSamplesPerSec=4.492990120476572, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:00:51,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=18580, skipped=87, lr=[1.2003889471749373e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:00:51,588] [INFO] [timer.py:258:stop] epoch=0/micro_step=18580/global_step=18580, RunningAvgSamplesPerSec=4.49062909906368, CurrSamplesPerSec=4.487071985861506, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:01:00,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=18590, skipped=87, lr=[1.1983083764165562e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:01:00,676] [INFO] [timer.py:258:stop] epoch=0/micro_step=18590/global_step=18590, RunningAvgSamplesPerSec=4.490627773361952, CurrSamplesPerSec=4.484499313982279, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:01:09,761] [INFO] [logging.py:96:log_dist] [Rank 0] step=18600, skipped=87, lr=[1.1962384196546393e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:01:09,761] [INFO] [timer.py:258:stop] epoch=0/micro_step=18600/global_step=18600, RunningAvgSamplesPerSec=4.4906252304417515, CurrSamplesPerSec=4.4974682129301415, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:01:09,762] [INFO] [RANK 0]  iteration    18600/   20000 | elapsed time per iteration (ms): 907.6 | learning rate 1.196E-05 | total loss 3.268347E-01 | loss 3.268347E-01 | loss scale 32768.0 |speed 264.43 samples/(min*GPU)
[2024-06-17 11:01:09,762] [INFO] [RANK 0] time (ms) | forward: 357.05 | backward: 546.65 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 15.98 | data loader: 0.10
[2024-06-17 11:01:09,762] [INFO] [RANK 0] Saving Model...
[2024-06-17 11:01:09,775] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/18600/mp_rank_00_model_states.pt
[2024-06-17 11:01:09,775] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/18600/mp_rank_00_model_states.pt...
[2024-06-17 11:01:38,956] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/18600/mp_rank_00_model_states.pt.
[2024-06-17 11:01:47,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=18610, skipped=87, lr=[1.194179081996596e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:01:47,943] [INFO] [timer.py:258:stop] epoch=0/micro_step=18610/global_step=18610, RunningAvgSamplesPerSec=4.490649698677082, CurrSamplesPerSec=4.543710818209492, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:01:56,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=18620, skipped=87, lr=[1.1921303685236394e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:01:56,940] [INFO] [timer.py:258:stop] epoch=0/micro_step=18620/global_step=18620, RunningAvgSamplesPerSec=4.490668178372074, CurrSamplesPerSec=4.52015642659791, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:02:05,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=18630, skipped=87, lr=[1.1900922842907661e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:02:05,976] [INFO] [timer.py:258:stop] epoch=0/micro_step=18630/global_step=18630, RunningAvgSamplesPerSec=4.490679514062315, CurrSamplesPerSec=4.501932288074877, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:02:15,020] [INFO] [logging.py:96:log_dist] [Rank 0] step=18640, skipped=87, lr=[1.188064834326746e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:02:15,021] [INFO] [timer.py:258:stop] epoch=0/micro_step=18640/global_step=18640, RunningAvgSamplesPerSec=4.49068888972443, CurrSamplesPerSec=4.509502437094366, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:02:24,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=18650, skipped=87, lr=[1.1860480236341094e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:02:24,086] [INFO] [timer.py:258:stop] epoch=0/micro_step=18650/global_step=18650, RunningAvgSamplesPerSec=4.490687428739114, CurrSamplesPerSec=4.483902444239247, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:02:24,087] [INFO] [RANK 0]  iteration    18650/   20000 | elapsed time per iteration (ms): 1486.5 | learning rate 1.186E-05 | total loss 2.973831E-01 | loss 2.973831E-01 | loss scale 32768.0 |speed 161.45 samples/(min*GPU)
[2024-06-17 11:02:24,087] [INFO] [RANK 0] time (ms) | forward: 355.19 | backward: 543.11 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 15.69 | data loader: 0.12
[2024-06-17 11:02:33,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=18660, skipped=87, lr=[1.1840418571891381e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:02:33,153] [INFO] [timer.py:258:stop] epoch=0/micro_step=18660/global_step=18660, RunningAvgSamplesPerSec=4.49068768013646, CurrSamplesPerSec=4.490524838891079, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:02:42,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=18670, skipped=87, lr=[1.1820463399418476e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:02:42,214] [INFO] [timer.py:258:stop] epoch=0/micro_step=18670/global_step=18670, RunningAvgSamplesPerSec=4.490686727651267, CurrSamplesPerSec=4.481309464664434, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:02:51,283] [INFO] [logging.py:96:log_dist] [Rank 0] step=18680, skipped=87, lr=[1.1800614768159782e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:02:51,284] [INFO] [timer.py:258:stop] epoch=0/micro_step=18680/global_step=18680, RunningAvgSamplesPerSec=4.49068519301115, CurrSamplesPerSec=4.489086605585693, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:03:00,335] [INFO] [logging.py:96:log_dist] [Rank 0] step=18690, skipped=87, lr=[1.1780872727089812e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:03:00,335] [INFO] [timer.py:258:stop] epoch=0/micro_step=18690/global_step=18690, RunningAvgSamplesPerSec=4.490684457704203, CurrSamplesPerSec=4.4741843659178056, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:03:09,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=18700, skipped=87, lr=[1.1761237324920112e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:03:09,403] [INFO] [timer.py:258:stop] epoch=0/micro_step=18700/global_step=18700, RunningAvgSamplesPerSec=4.490680540884161, CurrSamplesPerSec=4.48325062349704, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:03:09,404] [INFO] [RANK 0]  iteration    18700/   20000 | elapsed time per iteration (ms): 906.3 | learning rate 1.176E-05 | total loss 3.105661E-01 | loss 3.105661E-01 | loss scale 32768.0 |speed 264.80 samples/(min*GPU)
[2024-06-17 11:03:09,404] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 546.69 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.64 | data loader: 0.11
[2024-06-17 11:03:18,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=18710, skipped=87, lr=[1.1741708610099073e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:03:18,502] [INFO] [timer.py:258:stop] epoch=0/micro_step=18710/global_step=18710, RunningAvgSamplesPerSec=4.4906726920851705, CurrSamplesPerSec=4.490383017219114, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:03:27,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=18720, skipped=87, lr=[1.1722286630811856e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:03:27,590] [INFO] [timer.py:258:stop] epoch=0/micro_step=18720/global_step=18720, RunningAvgSamplesPerSec=4.490669756508681, CurrSamplesPerSec=4.478729047188491, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:03:36,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=18730, skipped=87, lr=[1.1702971434980265e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:03:36,668] [INFO] [timer.py:258:stop] epoch=0/micro_step=18730/global_step=18730, RunningAvgSamplesPerSec=4.4906672933667116, CurrSamplesPerSec=4.470564786248627, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:03:45,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=18740, skipped=87, lr=[1.1683763070262637e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:03:45,730] [INFO] [timer.py:258:stop] epoch=0/micro_step=18740/global_step=18740, RunningAvgSamplesPerSec=4.49066594369496, CurrSamplesPerSec=4.487618083661691, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:03:54,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=18750, skipped=87, lr=[1.1664661584053683e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:03:54,800] [INFO] [timer.py:258:stop] epoch=0/micro_step=18750/global_step=18750, RunningAvgSamplesPerSec=4.490662575390939, CurrSamplesPerSec=4.472484722917184, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:03:54,801] [INFO] [RANK 0]  iteration    18750/   20000 | elapsed time per iteration (ms): 907.9 | learning rate 1.166E-05 | total loss 2.283301E-01 | loss 2.283301E-01 | loss scale 32768.0 |speed 264.33 samples/(min*GPU)
[2024-06-17 11:03:54,801] [INFO] [RANK 0] time (ms) | forward: 357.26 | backward: 546.71 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 15.42 | data loader: 0.13
[2024-06-17 11:04:03,874] [INFO] [logging.py:96:log_dist] [Rank 0] step=18760, skipped=87, lr=[1.1645667023484436e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:04:03,874] [INFO] [timer.py:258:stop] epoch=0/micro_step=18760/global_step=18760, RunningAvgSamplesPerSec=4.490659539278943, CurrSamplesPerSec=4.489908340358342, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:04:12,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=18770, skipped=87, lr=[1.1626779435422075e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:04:12,942] [INFO] [timer.py:258:stop] epoch=0/micro_step=18770/global_step=18770, RunningAvgSamplesPerSec=4.49065421796985, CurrSamplesPerSec=4.478621444838013, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:04:21,997] [INFO] [logging.py:96:log_dist] [Rank 0] step=18780, skipped=87, lr=[1.1607998866469869e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:04:21,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=18780/global_step=18780, RunningAvgSamplesPerSec=4.490650812405196, CurrSamplesPerSec=4.483187129033534, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:04:31,079] [INFO] [logging.py:96:log_dist] [Rank 0] step=18790, skipped=87, lr=[1.1589325362966972e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:04:31,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=18790/global_step=18790, RunningAvgSamplesPerSec=4.490646487808456, CurrSamplesPerSec=4.490732780080322, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:04:40,137] [INFO] [logging.py:96:log_dist] [Rank 0] step=18800, skipped=87, lr=[1.1570758970988423e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:04:40,137] [INFO] [timer.py:258:stop] epoch=0/micro_step=18800/global_step=18800, RunningAvgSamplesPerSec=4.490645917951245, CurrSamplesPerSec=4.494220164931497, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:04:40,138] [INFO] [RANK 0]  iteration    18800/   20000 | elapsed time per iteration (ms): 906.7 | learning rate 1.157E-05 | total loss 2.726016E-01 | loss 2.726016E-01 | loss scale 32768.0 |speed 264.69 samples/(min*GPU)
[2024-06-17 11:04:40,138] [INFO] [RANK 0] time (ms) | forward: 356.06 | backward: 546.76 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 14.32 | data loader: 0.09
[2024-06-17 11:04:49,191] [INFO] [logging.py:96:log_dist] [Rank 0] step=18810, skipped=87, lr=[1.1552299736344937e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:04:49,191] [INFO] [timer.py:258:stop] epoch=0/micro_step=18810/global_step=18810, RunningAvgSamplesPerSec=4.490645182858982, CurrSamplesPerSec=4.496171322369753, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:04:58,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=18820, skipped=87, lr=[1.1533947704582843e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:04:58,254] [INFO] [timer.py:258:stop] epoch=0/micro_step=18820/global_step=18820, RunningAvgSamplesPerSec=4.490644080123135, CurrSamplesPerSec=4.477997453150052, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:05:07,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=18830, skipped=87, lr=[1.151570292098395e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:05:07,296] [INFO] [timer.py:258:stop] epoch=0/micro_step=18830/global_step=18830, RunningAvgSamplesPerSec=4.4906423638438016, CurrSamplesPerSec=4.485403310819716, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:05:16,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=18840, skipped=87, lr=[1.149756543056546e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:05:16,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=18840/global_step=18840, RunningAvgSamplesPerSec=4.49063897160824, CurrSamplesPerSec=4.488261569424035, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:05:25,476] [INFO] [logging.py:96:log_dist] [Rank 0] step=18850, skipped=87, lr=[1.1479535278079819e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:05:25,477] [INFO] [timer.py:258:stop] epoch=0/micro_step=18850/global_step=18850, RunningAvgSamplesPerSec=4.490638665402084, CurrSamplesPerSec=4.487414031567429, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:05:25,477] [INFO] [RANK 0]  iteration    18850/   20000 | elapsed time per iteration (ms): 906.8 | learning rate 1.148E-05 | total loss 2.928162E-01 | loss 2.928162E-01 | loss scale 32768.0 |speed 264.67 samples/(min*GPU)
[2024-06-17 11:05:25,478] [INFO] [RANK 0] time (ms) | forward: 356.40 | backward: 546.57 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 15.09 | data loader: 0.09
[2024-06-17 11:05:34,575] [INFO] [logging.py:96:log_dist] [Rank 0] step=18860, skipped=87, lr=[1.1461612508014639e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:05:34,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=18860/global_step=18860, RunningAvgSamplesPerSec=4.4906347380395735, CurrSamplesPerSec=4.483363240742844, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:05:43,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=18870, skipped=87, lr=[1.1443797164592563e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:05:43,662] [INFO] [timer.py:258:stop] epoch=0/micro_step=18870/global_step=18870, RunningAvgSamplesPerSec=4.490637406088615, CurrSamplesPerSec=4.48885719827961, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:05:52,755] [INFO] [logging.py:96:log_dist] [Rank 0] step=18880, skipped=87, lr=[1.1426089291771199e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:05:52,756] [INFO] [timer.py:258:stop] epoch=0/micro_step=18880/global_step=18880, RunningAvgSamplesPerSec=4.490633319667892, CurrSamplesPerSec=4.477648476159238, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:06:01,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=18890, skipped=87, lr=[1.1408488933242949e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:06:01,908] [INFO] [timer.py:258:stop] epoch=0/micro_step=18890/global_step=18890, RunningAvgSamplesPerSec=4.4906283187932505, CurrSamplesPerSec=4.491290590282425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:06:11,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=18900, skipped=87, lr=[1.1390996132434957e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:06:11,000] [INFO] [timer.py:258:stop] epoch=0/micro_step=18900/global_step=18900, RunningAvgSamplesPerSec=4.490624357216225, CurrSamplesPerSec=4.464797030922918, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:06:11,001] [INFO] [RANK 0]  iteration    18900/   20000 | elapsed time per iteration (ms): 910.5 | learning rate 1.139E-05 | total loss 2.976736E-01 | loss 2.976736E-01 | loss scale 32768.0 |speed 263.60 samples/(min*GPU)
[2024-06-17 11:06:11,001] [INFO] [RANK 0] time (ms) | forward: 359.90 | backward: 546.57 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 18.09 | data loader: 0.40
[2024-06-17 11:06:11,002] [INFO] [RANK 0] Saving Model...
[2024-06-17 11:06:11,016] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/18900/mp_rank_00_model_states.pt
[2024-06-17 11:06:11,016] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/18900/mp_rank_00_model_states.pt...
[2024-06-17 11:06:43,262] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/18900/mp_rank_00_model_states.pt.
[2024-06-17 11:06:52,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=18910, skipped=87, lr=[1.1373610932508954e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:06:52,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=18910/global_step=18910, RunningAvgSamplesPerSec=4.490646913907751, CurrSamplesPerSec=4.535560722663373, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:07:01,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=18920, skipped=87, lr=[1.1356333376361213e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:07:01,306] [INFO] [timer.py:258:stop] epoch=0/micro_step=18920/global_step=18920, RunningAvgSamplesPerSec=4.4906647015284085, CurrSamplesPerSec=4.524266686945649, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:07:10,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=18930, skipped=87, lr=[1.1339163506622376e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:07:10,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=18930/global_step=18930, RunningAvgSamplesPerSec=4.49067912479675, CurrSamplesPerSec=4.517711127638709, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:07:19,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=18940, skipped=87, lr=[1.1322101365657392e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:07:19,398] [INFO] [timer.py:258:stop] epoch=0/micro_step=18940/global_step=18940, RunningAvgSamplesPerSec=4.490690553108218, CurrSamplesPerSec=4.5102128377978765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:07:28,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=18950, skipped=87, lr=[1.1305146995565388e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:07:28,428] [INFO] [timer.py:258:stop] epoch=0/micro_step=18950/global_step=18950, RunningAvgSamplesPerSec=4.490697936768157, CurrSamplesPerSec=4.493469059688689, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:07:28,428] [INFO] [RANK 0]  iteration    18950/   20000 | elapsed time per iteration (ms): 1548.5 | learning rate 1.130E-05 | total loss 2.900134E-01 | loss 2.900134E-01 | loss scale 32768.0 |speed 154.98 samples/(min*GPU)
[2024-06-17 11:07:28,429] [INFO] [RANK 0] time (ms) | forward: 356.41 | backward: 542.63 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 17.32 | data loader: 0.28
[2024-06-17 11:07:37,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=18960, skipped=87, lr=[1.1288300438179605e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:07:37,515] [INFO] [timer.py:258:stop] epoch=0/micro_step=18960/global_step=18960, RunningAvgSamplesPerSec=4.4906968806433145, CurrSamplesPerSec=4.490276055952021, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:07:43,896] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 11:07:44,796] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 11:07:46,610] [INFO] [logging.py:96:log_dist] [Rank 0] step=18970, skipped=89, lr=[1.1274900845361549e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:07:46,610] [INFO] [timer.py:258:stop] epoch=0/micro_step=18970/global_step=18970, RunningAvgSamplesPerSec=4.490696243623168, CurrSamplesPerSec=4.4821187750190745, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:07:55,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=18980, skipped=89, lr=[1.1258248455417474e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:07:55,705] [INFO] [timer.py:258:stop] epoch=0/micro_step=18980/global_step=18980, RunningAvgSamplesPerSec=4.490691066972445, CurrSamplesPerSec=4.48291400354845, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:08:04,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=18990, skipped=89, lr=[1.124170399389709e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:08:04,793] [INFO] [timer.py:258:stop] epoch=0/micro_step=18990/global_step=18990, RunningAvgSamplesPerSec=4.490684436645971, CurrSamplesPerSec=4.433420536643888, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:08:13,868] [INFO] [logging.py:96:log_dist] [Rank 0] step=19000, skipped=89, lr=[1.122526750162222e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:08:13,868] [INFO] [timer.py:258:stop] epoch=0/micro_step=19000/global_step=19000, RunningAvgSamplesPerSec=4.490681470312732, CurrSamplesPerSec=4.489201918636169, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:08:13,869] [INFO] [RANK 0]  iteration    19000/   20000 | elapsed time per iteration (ms): 908.8 | learning rate 1.122E-05 | total loss 3.476593E-01 | loss 3.476593E-01 | loss scale 32768.0 |speed 264.08 samples/(min*GPU)
[2024-06-17 11:08:13,869] [INFO] [RANK 0] time (ms) | forward: 358.12 | backward: 546.78 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 16.39 | data loader: 0.22
[2024-06-17 11:08:20,537] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 11:08:20,537] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 11:08:20,537] [INFO] [RANK 0]  validation loss at iteration 19000 | loss: 8.557617E-01 | PPL: 2.353166E+00 loss 8.564453E-01 |
[2024-06-17 11:08:20,537] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 11:08:29,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=19010, skipped=89, lr=[1.1208939019148275e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:08:29,647] [INFO] [timer.py:258:stop] epoch=0/micro_step=19010/global_step=19010, RunningAvgSamplesPerSec=4.490678965189574, CurrSamplesPerSec=4.488496920000268, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:08:38,741] [INFO] [logging.py:96:log_dist] [Rank 0] step=19020, skipped=89, lr=[1.1192718586764157e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:08:38,741] [INFO] [timer.py:258:stop] epoch=0/micro_step=19020/global_step=19020, RunningAvgSamplesPerSec=4.490673131141168, CurrSamplesPerSec=4.490355375055068, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:08:47,850] [INFO] [logging.py:96:log_dist] [Rank 0] step=19030, skipped=89, lr=[1.1176606244492174e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:08:47,851] [INFO] [timer.py:258:stop] epoch=0/micro_step=19030/global_step=19030, RunningAvgSamplesPerSec=4.490670123768249, CurrSamplesPerSec=4.485602382950599, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:08:56,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=19040, skipped=89, lr=[1.1160602032087929e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:08:56,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=19040/global_step=19040, RunningAvgSamplesPerSec=4.490665804362626, CurrSamplesPerSec=4.483865294949924, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:09:06,116] [INFO] [logging.py:96:log_dist] [Rank 0] step=19050, skipped=89, lr=[1.1144705989040219e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:09:06,117] [INFO] [timer.py:258:stop] epoch=0/micro_step=19050/global_step=19050, RunningAvgSamplesPerSec=4.49065986995763, CurrSamplesPerSec=4.4918052449859065, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:09:06,117] [INFO] [RANK 0]  iteration    19050/   20000 | elapsed time per iteration (ms): 1045.0 | learning rate 1.114E-05 | total loss 3.020758E-01 | loss 3.020758E-01 | loss scale 32768.0 |speed 229.67 samples/(min*GPU)
[2024-06-17 11:09:06,118] [INFO] [RANK 0] time (ms) | forward: 360.59 | backward: 547.03 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 22.14 | data loader: 0.36
[2024-06-17 11:09:15,208] [INFO] [logging.py:96:log_dist] [Rank 0] step=19060, skipped=89, lr=[1.112891815457096e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:09:15,208] [INFO] [timer.py:258:stop] epoch=0/micro_step=19060/global_step=19060, RunningAvgSamplesPerSec=4.490655239332905, CurrSamplesPerSec=4.468448927247812, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:09:24,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=19070, skipped=89, lr=[1.1113238567635057e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:09:24,325] [INFO] [timer.py:258:stop] epoch=0/micro_step=19070/global_step=19070, RunningAvgSamplesPerSec=4.490648954260137, CurrSamplesPerSec=4.477033118464128, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:09:33,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=19080, skipped=89, lr=[1.1097667266920336e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:09:33,438] [INFO] [timer.py:258:stop] epoch=0/micro_step=19080/global_step=19080, RunningAvgSamplesPerSec=4.490644949211007, CurrSamplesPerSec=4.475977248231189, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:09:42,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=19090, skipped=89, lr=[1.1082204290847422e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:09:42,560] [INFO] [timer.py:258:stop] epoch=0/micro_step=19090/global_step=19090, RunningAvgSamplesPerSec=4.49063733380531, CurrSamplesPerSec=4.477661621566801, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:09:51,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=19100, skipped=89, lr=[1.1066849677569693e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:09:51,698] [INFO] [timer.py:258:stop] epoch=0/micro_step=19100/global_step=19100, RunningAvgSamplesPerSec=4.490627496980793, CurrSamplesPerSec=4.473857457061975, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:09:51,699] [INFO] [RANK 0]  iteration    19100/   20000 | elapsed time per iteration (ms): 911.6 | learning rate 1.107E-05 | total loss 3.114211E-01 | loss 3.114211E-01 | loss scale 32768.0 |speed 263.27 samples/(min*GPU)
[2024-06-17 11:09:51,699] [INFO] [RANK 0] time (ms) | forward: 360.14 | backward: 547.39 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 17.96 | data loader: 0.39
[2024-06-17 11:10:00,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=19110, skipped=89, lr=[1.1051603464973115e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:10:00,809] [INFO] [timer.py:258:stop] epoch=0/micro_step=19110/global_step=19110, RunningAvgSamplesPerSec=4.490620156204135, CurrSamplesPerSec=4.4845232879736825, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:10:09,945] [INFO] [logging.py:96:log_dist] [Rank 0] step=19120, skipped=89, lr=[1.1036465690676206e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:10:09,945] [INFO] [timer.py:258:stop] epoch=0/micro_step=19120/global_step=19120, RunningAvgSamplesPerSec=4.490612592457987, CurrSamplesPerSec=4.473280114330203, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:10:19,065] [INFO] [logging.py:96:log_dist] [Rank 0] step=19130, skipped=89, lr=[1.1021436392029919e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:10:19,066] [INFO] [timer.py:258:stop] epoch=0/micro_step=19130/global_step=19130, RunningAvgSamplesPerSec=4.490604194935046, CurrSamplesPerSec=4.479951294474834, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:10:28,179] [INFO] [logging.py:96:log_dist] [Rank 0] step=19140, skipped=89, lr=[1.1006515606117554e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:10:28,179] [INFO] [timer.py:258:stop] epoch=0/micro_step=19140/global_step=19140, RunningAvgSamplesPerSec=4.4905985511589535, CurrSamplesPerSec=4.477058207411855, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:10:37,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=19150, skipped=89, lr=[1.0991703369754667e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:10:37,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=19150/global_step=19150, RunningAvgSamplesPerSec=4.49059406697374, CurrSamplesPerSec=4.483777816796859, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:10:37,254] [INFO] [RANK 0]  iteration    19150/   20000 | elapsed time per iteration (ms): 911.1 | learning rate 1.099E-05 | total loss 3.365831E-01 | loss 3.365831E-01 | loss scale 32768.0 |speed 263.42 samples/(min*GPU)
[2024-06-17 11:10:37,254] [INFO] [RANK 0] time (ms) | forward: 359.61 | backward: 547.43 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 17.29 | data loader: 0.57
[2024-06-17 11:10:46,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=19160, skipped=89, lr=[1.0976999719488983e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:10:46,354] [INFO] [timer.py:258:stop] epoch=0/micro_step=19160/global_step=19160, RunningAvgSamplesPerSec=4.4905871495104615, CurrSamplesPerSec=4.479414236755234, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:10:55,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=19170, skipped=89, lr=[1.096240469160029e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:10:55,417] [INFO] [timer.py:258:stop] epoch=0/micro_step=19170/global_step=19170, RunningAvgSamplesPerSec=4.490582844026991, CurrSamplesPerSec=4.486584810791412, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:11:04,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=19180, skipped=89, lr=[1.0947918322100373e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:11:04,493] [INFO] [timer.py:258:stop] epoch=0/micro_step=19180/global_step=19180, RunningAvgSamplesPerSec=4.490578653409171, CurrSamplesPerSec=4.477647281126013, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:11:13,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=19190, skipped=89, lr=[1.093354064673291e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:11:13,571] [INFO] [timer.py:258:stop] epoch=0/micro_step=19190/global_step=19190, RunningAvgSamplesPerSec=4.490574803420562, CurrSamplesPerSec=4.476836000801588, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:11:22,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=19200, skipped=89, lr=[1.0919271700973382e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:11:22,642] [INFO] [timer.py:258:stop] epoch=0/micro_step=19200/global_step=19200, RunningAvgSamplesPerSec=4.490570710149251, CurrSamplesPerSec=4.479726408310711, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:11:22,642] [INFO] [RANK 0]  iteration    19200/   20000 | elapsed time per iteration (ms): 907.8 | learning rate 1.092E-05 | total loss 3.106964E-01 | loss 3.106964E-01 | loss scale 32768.0 |speed 264.38 samples/(min*GPU)
[2024-06-17 11:11:22,643] [INFO] [RANK 0] time (ms) | forward: 356.68 | backward: 547.11 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 14.77 | data loader: 0.12
[2024-06-17 11:11:22,643] [INFO] [RANK 0] Saving Model...
[2024-06-17 11:11:22,655] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/19200/mp_rank_00_model_states.pt
[2024-06-17 11:11:22,655] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/19200/mp_rank_00_model_states.pt...
[2024-06-17 11:11:52,324] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/19200/mp_rank_00_model_states.pt.
[2024-06-17 11:12:01,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=19210, skipped=89, lr=[1.0905111520028995e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:12:01,328] [INFO] [timer.py:258:stop] epoch=0/micro_step=19210/global_step=19210, RunningAvgSamplesPerSec=4.4905914093343045, CurrSamplesPerSec=4.544484969967021, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:12:10,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=19220, skipped=89, lr=[1.0891060138838592e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:12:10,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=19220/global_step=19220, RunningAvgSamplesPerSec=4.490608003824445, CurrSamplesPerSec=4.5085620460121625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:12:19,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=19230, skipped=89, lr=[1.0877117592072555e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:12:19,338] [INFO] [timer.py:258:stop] epoch=0/micro_step=19230/global_step=19230, RunningAvgSamplesPerSec=4.490619408923353, CurrSamplesPerSec=4.507010531445376, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:12:28,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=19240, skipped=89, lr=[1.0863283914132734e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:12:28,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=19240/global_step=19240, RunningAvgSamplesPerSec=4.490626128352792, CurrSamplesPerSec=4.503633838371637, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:12:37,447] [INFO] [logging.py:96:log_dist] [Rank 0] step=19250, skipped=89, lr=[1.084955913915235e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:12:37,448] [INFO] [timer.py:258:stop] epoch=0/micro_step=19250/global_step=19250, RunningAvgSamplesPerSec=4.4906298938369655, CurrSamplesPerSec=4.484793013040671, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:12:37,448] [INFO] [RANK 0]  iteration    19250/   20000 | elapsed time per iteration (ms): 1496.1 | learning rate 1.085E-05 | total loss 3.109515E-01 | loss 3.109515E-01 | loss scale 32768.0 |speed 160.41 samples/(min*GPU)
[2024-06-17 11:12:37,449] [INFO] [RANK 0] time (ms) | forward: 355.28 | backward: 542.92 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 15.43 | data loader: 0.11
[2024-06-17 11:12:46,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=19260, skipped=89, lr=[1.0835943300995926e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:12:46,503] [INFO] [timer.py:258:stop] epoch=0/micro_step=19260/global_step=19260, RunningAvgSamplesPerSec=4.490631663714706, CurrSamplesPerSec=4.493481094652219, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:12:55,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=19270, skipped=89, lr=[1.0822436433259187e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:12:55,573] [INFO] [timer.py:258:stop] epoch=0/micro_step=19270/global_step=19270, RunningAvgSamplesPerSec=4.4906311206952445, CurrSamplesPerSec=4.487217198896678, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:13:04,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=19280, skipped=89, lr=[1.0809038569268989e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:13:04,630] [INFO] [timer.py:258:stop] epoch=0/micro_step=19280/global_step=19280, RunningAvgSamplesPerSec=4.490629965344035, CurrSamplesPerSec=4.479428588516235, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:13:13,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=19290, skipped=89, lr=[1.0795749742083225e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:13:13,690] [INFO] [timer.py:258:stop] epoch=0/micro_step=19290/global_step=19290, RunningAvgSamplesPerSec=4.490628087129171, CurrSamplesPerSec=4.481145483241394, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:13:22,750] [INFO] [logging.py:96:log_dist] [Rank 0] step=19300, skipped=89, lr=[1.0782569984490758e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:13:22,750] [INFO] [timer.py:258:stop] epoch=0/micro_step=19300/global_step=19300, RunningAvgSamplesPerSec=4.490623896113742, CurrSamplesPerSec=4.48914666372692, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:13:22,751] [INFO] [RANK 0]  iteration    19300/   20000 | elapsed time per iteration (ms): 906.0 | learning rate 1.078E-05 | total loss 2.422897E-01 | loss 2.422897E-01 | loss scale 32768.0 |speed 264.89 samples/(min*GPU)
[2024-06-17 11:13:22,751] [INFO] [RANK 0] time (ms) | forward: 355.60 | backward: 546.52 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 14.37 | data loader: 0.09
[2024-06-17 11:13:31,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=19310, skipped=89, lr=[1.0769499329011332e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:13:31,818] [INFO] [timer.py:258:stop] epoch=0/micro_step=19310/global_step=19310, RunningAvgSamplesPerSec=4.490622738957349, CurrSamplesPerSec=4.487910990866736, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:13:40,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=19320, skipped=89, lr=[1.0756537807895486e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:13:40,910] [INFO] [timer.py:258:stop] epoch=0/micro_step=19320/global_step=19320, RunningAvgSamplesPerSec=4.490622315890501, CurrSamplesPerSec=4.496068904712009, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:13:49,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=19330, skipped=89, lr=[1.0743685453124484e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:13:49,972] [INFO] [timer.py:258:stop] epoch=0/micro_step=19330/global_step=19330, RunningAvgSamplesPerSec=4.490620201812386, CurrSamplesPerSec=4.483177545119794, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:13:59,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=19340, skipped=89, lr=[1.0730942296410238e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:13:59,069] [INFO] [timer.py:258:stop] epoch=0/micro_step=19340/global_step=19340, RunningAvgSamplesPerSec=4.490613358824134, CurrSamplesPerSec=4.4756047070473395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:14:08,148] [INFO] [logging.py:96:log_dist] [Rank 0] step=19350, skipped=89, lr=[1.0718308369195216e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:14:08,148] [INFO] [timer.py:258:stop] epoch=0/micro_step=19350/global_step=19350, RunningAvgSamplesPerSec=4.490608858889218, CurrSamplesPerSec=4.480551899035721, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:14:08,149] [INFO] [RANK 0]  iteration    19350/   20000 | elapsed time per iteration (ms): 908.0 | learning rate 1.072E-05 | total loss 2.931812E-01 | loss 2.931812E-01 | loss scale 32768.0 |speed 264.33 samples/(min*GPU)
[2024-06-17 11:14:08,149] [INFO] [RANK 0] time (ms) | forward: 357.03 | backward: 546.96 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 15.57 | data loader: 0.11
[2024-06-17 11:14:17,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=19360, skipped=89, lr=[1.0705783702652382e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:14:17,264] [INFO] [timer.py:258:stop] epoch=0/micro_step=19360/global_step=19360, RunningAvgSamplesPerSec=4.490603365436517, CurrSamplesPerSec=4.481188572087926, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:14:25,429] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 11:14:26,331] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 11:14:26,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=19370, skipped=91, lr=[1.069460494618576e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:14:26,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=19370/global_step=19370, RunningAvgSamplesPerSec=4.490602908661711, CurrSamplesPerSec=4.499860261249774, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:14:35,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=19380, skipped=91, lr=[1.0683514738240595e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:14:35,401] [INFO] [timer.py:258:stop] epoch=0/micro_step=19380/global_step=19380, RunningAvgSamplesPerSec=4.490601206299542, CurrSamplesPerSec=4.486667599092783, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:14:44,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=19390, skipped=91, lr=[1.0671296165124985e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:14:44,489] [INFO] [timer.py:258:stop] epoch=0/micro_step=19390/global_step=19390, RunningAvgSamplesPerSec=4.490596388904922, CurrSamplesPerSec=4.48900012468541, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:14:53,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=19400, skipped=91, lr=[1.06591869686795e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:14:53,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=19400/global_step=19400, RunningAvgSamplesPerSec=4.490594805489544, CurrSamplesPerSec=4.49076042689111, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:14:53,587] [INFO] [RANK 0]  iteration    19400/   20000 | elapsed time per iteration (ms): 908.8 | learning rate 1.066E-05 | total loss 3.338431E-01 | loss 3.338431E-01 | loss scale 32768.0 |speed 264.10 samples/(min*GPU)
[2024-06-17 11:14:53,587] [INFO] [RANK 0] time (ms) | forward: 357.83 | backward: 547.01 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 16.44 | data loader: 0.11
[2024-06-17 11:15:02,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=19410, skipped=91, lr=[1.0647187178782382e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:15:02,662] [INFO] [timer.py:258:stop] epoch=0/micro_step=19410/global_step=19410, RunningAvgSamplesPerSec=4.490593592009548, CurrSamplesPerSec=4.4899503962811265, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:15:11,709] [INFO] [logging.py:96:log_dist] [Rank 0] step=19420, skipped=91, lr=[1.0635296825041919e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:15:11,710] [INFO] [timer.py:258:stop] epoch=0/micro_step=19420/global_step=19420, RunningAvgSamplesPerSec=4.49059436141207, CurrSamplesPerSec=4.478978943703935, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:15:20,780] [INFO] [logging.py:96:log_dist] [Rank 0] step=19430, skipped=91, lr=[1.0623515936796376e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:15:20,781] [INFO] [timer.py:258:stop] epoch=0/micro_step=19430/global_step=19430, RunningAvgSamplesPerSec=4.490591745275903, CurrSamplesPerSec=4.48102579634872, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:15:29,864] [INFO] [logging.py:96:log_dist] [Rank 0] step=19440, skipped=91, lr=[1.0611844543113913e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:15:29,864] [INFO] [timer.py:258:stop] epoch=0/micro_step=19440/global_step=19440, RunningAvgSamplesPerSec=4.490590316162812, CurrSamplesPerSec=4.488460895353083, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:15:38,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=19450, skipped=91, lr=[1.0600282672792558e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:15:38,930] [INFO] [timer.py:258:stop] epoch=0/micro_step=19450/global_step=19450, RunningAvgSamplesPerSec=4.490591152191374, CurrSamplesPerSec=4.49152144883367, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:15:38,930] [INFO] [RANK 0]  iteration    19450/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 1.060E-05 | total loss 3.372806E-01 | loss 3.372806E-01 | loss scale 32768.0 |speed 264.65 samples/(min*GPU)
[2024-06-17 11:15:38,930] [INFO] [RANK 0] time (ms) | forward: 356.08 | backward: 546.85 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 15.38 | data loader: 0.10
[2024-06-17 11:15:48,007] [INFO] [logging.py:96:log_dist] [Rank 0] step=19460, skipped=91, lr=[1.0588830354360052e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:15:48,008] [INFO] [timer.py:258:stop] epoch=0/micro_step=19460/global_step=19460, RunningAvgSamplesPerSec=4.4905872072915605, CurrSamplesPerSec=4.491198013051264, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:15:57,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=19470, skipped=91, lr=[1.0577487616073862e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:15:57,076] [INFO] [timer.py:258:stop] epoch=0/micro_step=19470/global_step=19470, RunningAvgSamplesPerSec=4.490584671399641, CurrSamplesPerSec=4.488208739013366, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:16:06,126] [INFO] [logging.py:96:log_dist] [Rank 0] step=19480, skipped=91, lr=[1.0566254485921072e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:16:06,126] [INFO] [timer.py:258:stop] epoch=0/micro_step=19480/global_step=19480, RunningAvgSamplesPerSec=4.490584932560127, CurrSamplesPerSec=4.49604360224475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:16:15,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=19490, skipped=91, lr=[1.0555130991618312e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:16:15,199] [INFO] [timer.py:258:stop] epoch=0/micro_step=19490/global_step=19490, RunningAvgSamplesPerSec=4.490579035446883, CurrSamplesPerSec=4.483026603883191, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:16:24,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=19500, skipped=91, lr=[1.0544117160611692e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:16:24,278] [INFO] [timer.py:258:stop] epoch=0/micro_step=19500/global_step=19500, RunningAvgSamplesPerSec=4.4905774949553665, CurrSamplesPerSec=4.4876576959249155, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:16:24,279] [INFO] [RANK 0]  iteration    19500/   20000 | elapsed time per iteration (ms): 907.0 | learning rate 1.054E-05 | total loss 2.885248E-01 | loss 2.885248E-01 | loss scale 32768.0 |speed 264.62 samples/(min*GPU)
[2024-06-17 11:16:24,279] [INFO] [RANK 0] time (ms) | forward: 356.14 | backward: 546.83 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 14.71 | data loader: 0.12
[2024-06-17 11:16:24,279] [INFO] [RANK 0] Saving Model...
[2024-06-17 11:16:24,291] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/19500/mp_rank_00_model_states.pt
[2024-06-17 11:16:24,292] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/19500/mp_rank_00_model_states.pt...
[2024-06-17 11:16:56,236] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/19500/mp_rank_00_model_states.pt.
[2024-06-17 11:17:05,260] [INFO] [logging.py:96:log_dist] [Rank 0] step=19510, skipped=91, lr=[1.053321302007675e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:17:05,261] [INFO] [timer.py:258:stop] epoch=0/micro_step=19510/global_step=19510, RunningAvgSamplesPerSec=4.490593704564643, CurrSamplesPerSec=4.5381149956572395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:17:14,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=19520, skipped=91, lr=[1.0522418596918367e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:17:14,250] [INFO] [timer.py:258:stop] epoch=0/micro_step=19520/global_step=19520, RunningAvgSamplesPerSec=4.490611748658865, CurrSamplesPerSec=4.516848784031071, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:17:23,301] [INFO] [logging.py:96:log_dist] [Rank 0] step=19530, skipped=91, lr=[1.0511733917770712e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:17:23,302] [INFO] [timer.py:258:stop] epoch=0/micro_step=19530/global_step=19530, RunningAvgSamplesPerSec=4.490622982248051, CurrSamplesPerSec=4.500289965477745, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:17:32,328] [INFO] [logging.py:96:log_dist] [Rank 0] step=19540, skipped=91, lr=[1.0501159008997165e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:17:32,329] [INFO] [timer.py:258:stop] epoch=0/micro_step=19540/global_step=19540, RunningAvgSamplesPerSec=4.490634638293768, CurrSamplesPerSec=4.509615164927973, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:17:41,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=19550, skipped=91, lr=[1.0490693896690264e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:17:41,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=19550/global_step=19550, RunningAvgSamplesPerSec=4.490636767914052, CurrSamplesPerSec=4.491467339231392, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:17:41,396] [INFO] [RANK 0]  iteration    19550/   20000 | elapsed time per iteration (ms): 1542.4 | learning rate 1.049E-05 | total loss 3.228967E-01 | loss 3.228967E-01 | loss scale 32768.0 |speed 155.61 samples/(min*GPU)
[2024-06-17 11:17:41,397] [INFO] [RANK 0] time (ms) | forward: 355.84 | backward: 542.93 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 16.18 | data loader: 0.10
[2024-06-17 11:17:50,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=19560, skipped=91, lr=[1.0480338606671634e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:17:50,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=19560/global_step=19560, RunningAvgSamplesPerSec=4.49063415259775, CurrSamplesPerSec=4.4712856119841815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:17:59,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=19570, skipped=91, lr=[1.0470093164491927e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:17:59,508] [INFO] [timer.py:258:stop] epoch=0/micro_step=19570/global_step=19570, RunningAvgSamplesPerSec=4.490631146097447, CurrSamplesPerSec=4.492274308763102, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:18:08,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=19580, skipped=91, lr=[1.045995759543074e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:18:08,591] [INFO] [timer.py:258:stop] epoch=0/micro_step=19580/global_step=19580, RunningAvgSamplesPerSec=4.490626774630264, CurrSamplesPerSec=4.486840384520239, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:18:17,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=19590, skipped=91, lr=[1.0449931924496602e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:18:17,660] [INFO] [timer.py:258:stop] epoch=0/micro_step=19590/global_step=19590, RunningAvgSamplesPerSec=4.490624709957395, CurrSamplesPerSec=4.487687705680809, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:18:26,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=19600, skipped=91, lr=[1.0440016176426843e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:18:26,708] [INFO] [timer.py:258:stop] epoch=0/micro_step=19600/global_step=19600, RunningAvgSamplesPerSec=4.490625125114037, CurrSamplesPerSec=4.488526940981326, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:18:26,708] [INFO] [RANK 0]  iteration    19600/   20000 | elapsed time per iteration (ms): 906.2 | learning rate 1.044E-05 | total loss 2.999187E-01 | loss 2.999187E-01 | loss scale 32768.0 |speed 264.83 samples/(min*GPU)
[2024-06-17 11:18:26,709] [INFO] [RANK 0] time (ms) | forward: 355.44 | backward: 546.87 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.14 | data loader: 0.11
[2024-06-17 11:18:35,807] [INFO] [logging.py:96:log_dist] [Rank 0] step=19610, skipped=91, lr=[1.043021037568759e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:18:35,807] [INFO] [timer.py:258:stop] epoch=0/micro_step=19610/global_step=19610, RunningAvgSamplesPerSec=4.4906208334832645, CurrSamplesPerSec=4.489398925469498, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:18:44,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=19620, skipped=91, lr=[1.0420514546473683e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:18:44,903] [INFO] [timer.py:258:stop] epoch=0/micro_step=19620/global_step=19620, RunningAvgSamplesPerSec=4.49061759999323, CurrSamplesPerSec=4.490730376025906, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:18:53,992] [INFO] [logging.py:96:log_dist] [Rank 0] step=19630, skipped=91, lr=[1.0410928712708625e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:18:53,992] [INFO] [timer.py:258:stop] epoch=0/micro_step=19630/global_step=19630, RunningAvgSamplesPerSec=4.4906160976118885, CurrSamplesPerSec=4.493635147879324, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:19:03,087] [INFO] [logging.py:96:log_dist] [Rank 0] step=19640, skipped=91, lr=[1.0401452898044492e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:19:03,088] [INFO] [timer.py:258:stop] epoch=0/micro_step=19640/global_step=19640, RunningAvgSamplesPerSec=4.490613141282017, CurrSamplesPerSec=4.487218399043567, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:19:12,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=19650, skipped=91, lr=[1.0392087125861928e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:19:12,153] [INFO] [timer.py:258:stop] epoch=0/micro_step=19650/global_step=19650, RunningAvgSamplesPerSec=4.490610520756195, CurrSamplesPerSec=4.502860246995224, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:19:12,153] [INFO] [RANK 0]  iteration    19650/   20000 | elapsed time per iteration (ms): 908.9 | learning rate 1.039E-05 | total loss 2.330219E-01 | loss 2.330219E-01 | loss scale 32768.0 |speed 264.06 samples/(min*GPU)
[2024-06-17 11:19:12,154] [INFO] [RANK 0] time (ms) | forward: 358.22 | backward: 546.70 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 16.51 | data loader: 0.10
[2024-06-17 11:19:21,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=19660, skipped=91, lr=[1.0382831419270031e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:19:21,232] [INFO] [timer.py:258:stop] epoch=0/micro_step=19660/global_step=19660, RunningAvgSamplesPerSec=4.490611514349518, CurrSamplesPerSec=4.486919582288864, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:19:30,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=19670, skipped=91, lr=[1.0373685801106351e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:19:30,288] [INFO] [timer.py:258:stop] epoch=0/micro_step=19670/global_step=19670, RunningAvgSamplesPerSec=4.490612199475229, CurrSamplesPerSec=4.495836373707266, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:19:39,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=19680, skipped=91, lr=[1.0364650293936783e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:19:39,356] [INFO] [timer.py:258:stop] epoch=0/micro_step=19680/global_step=19680, RunningAvgSamplesPerSec=4.490610367710911, CurrSamplesPerSec=4.49076042689111, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:19:48,420] [INFO] [logging.py:96:log_dist] [Rank 0] step=19690, skipped=91, lr=[1.0355724920055548e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:19:48,421] [INFO] [timer.py:258:stop] epoch=0/micro_step=19690/global_step=19690, RunningAvgSamplesPerSec=4.490609639525643, CurrSamplesPerSec=4.495694216339871, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:19:57,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=19700, skipped=91, lr=[1.0346909701485111e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:19:57,508] [INFO] [timer.py:258:stop] epoch=0/micro_step=19700/global_step=19700, RunningAvgSamplesPerSec=4.49060699881526, CurrSamplesPerSec=4.470318209977285, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:19:57,508] [INFO] [RANK 0]  iteration    19700/   20000 | elapsed time per iteration (ms): 907.1 | learning rate 1.035E-05 | total loss 2.710138E-01 | loss 2.710138E-01 | loss scale 32768.0 |speed 264.58 samples/(min*GPU)
[2024-06-17 11:19:57,509] [INFO] [RANK 0] time (ms) | forward: 356.49 | backward: 546.73 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 15.66 | data loader: 0.09
[2024-06-17 11:20:06,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=19710, skipped=91, lr=[1.033820465997616e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:20:06,589] [INFO] [timer.py:258:stop] epoch=0/micro_step=19710/global_step=19710, RunningAvgSamplesPerSec=4.490603770908226, CurrSamplesPerSec=4.484354276800602, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:20:15,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=19720, skipped=91, lr=[1.0329609817007504e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:20:15,645] [INFO] [timer.py:258:stop] epoch=0/micro_step=19720/global_step=19720, RunningAvgSamplesPerSec=4.490604944357137, CurrSamplesPerSec=4.490527242725437, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:20:24,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=19730, skipped=91, lr=[1.0321125193786078e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:20:24,699] [INFO] [timer.py:258:stop] epoch=0/micro_step=19730/global_step=19730, RunningAvgSamplesPerSec=4.490605764156655, CurrSamplesPerSec=4.488459694541469, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:20:33,791] [INFO] [logging.py:96:log_dist] [Rank 0] step=19740, skipped=91, lr=[1.031275081124684e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:20:33,792] [INFO] [timer.py:258:stop] epoch=0/micro_step=19740/global_step=19740, RunningAvgSamplesPerSec=4.490599014040526, CurrSamplesPerSec=4.480927657867403, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:20:42,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=19750, skipped=91, lr=[1.0304486690052749e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:20:42,853] [INFO] [timer.py:258:stop] epoch=0/micro_step=19750/global_step=19750, RunningAvgSamplesPerSec=4.490596965023147, CurrSamplesPerSec=4.483415957142334, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:20:42,853] [INFO] [RANK 0]  iteration    19750/   20000 | elapsed time per iteration (ms): 906.9 | learning rate 1.030E-05 | total loss 2.997845E-01 | loss 2.997845E-01 | loss scale 32768.0 |speed 264.64 samples/(min*GPU)
[2024-06-17 11:20:42,853] [INFO] [RANK 0] time (ms) | forward: 356.39 | backward: 546.55 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 14.87 | data loader: 0.09
[2024-06-17 11:20:51,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=19760, skipped=91, lr=[1.02963328505947e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:20:51,924] [INFO] [timer.py:258:stop] epoch=0/micro_step=19760/global_step=19760, RunningAvgSamplesPerSec=4.490593695505377, CurrSamplesPerSec=4.474187945476253, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:21:00,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=19770, skipped=91, lr=[1.0288289312991477e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:21:00,991] [INFO] [timer.py:258:stop] epoch=0/micro_step=19770/global_step=19770, RunningAvgSamplesPerSec=4.490592457077746, CurrSamplesPerSec=4.496347250649171, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:21:01,900] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 11:21:02,804] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 11:21:10,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=19780, skipped=93, lr=[1.0281933913590461e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:21:10,067] [INFO] [timer.py:258:stop] epoch=0/micro_step=19780/global_step=19780, RunningAvgSamplesPerSec=4.490589790724349, CurrSamplesPerSec=4.4651024149886265, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:21:19,146] [INFO] [logging.py:96:log_dist] [Rank 0] step=19790, skipped=93, lr=[1.0274088969156519e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:21:19,146] [INFO] [timer.py:258:stop] epoch=0/micro_step=19790/global_step=19790, RunningAvgSamplesPerSec=4.490586536298718, CurrSamplesPerSec=4.489821827794522, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:21:28,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=19800, skipped=93, lr=[1.0266354381461975e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:21:28,220] [INFO] [timer.py:258:stop] epoch=0/micro_step=19800/global_step=19800, RunningAvgSamplesPerSec=4.490583261124043, CurrSamplesPerSec=4.484940476460982, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:21:28,220] [INFO] [RANK 0]  iteration    19800/   20000 | elapsed time per iteration (ms): 907.3 | learning rate 1.027E-05 | total loss 2.482224E-01 | loss 2.482224E-01 | loss scale 32768.0 |speed 264.51 samples/(min*GPU)
[2024-06-17 11:21:28,221] [INFO] [RANK 0] time (ms) | forward: 356.83 | backward: 546.69 | allreduce: 0.00 | optimizer: 3.09 | batch generator: 15.07 | data loader: 0.09
[2024-06-17 11:21:28,221] [INFO] [RANK 0] Saving Model...
[2024-06-17 11:21:28,233] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/19800/mp_rank_00_model_states.pt
[2024-06-17 11:21:28,233] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/19800/mp_rank_00_model_states.pt...
[2024-06-17 11:21:57,499] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/19800/mp_rank_00_model_states.pt.
[2024-06-17 11:22:06,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=19810, skipped=93, lr=[1.0258730169591154e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:22:06,504] [INFO] [timer.py:258:stop] epoch=0/micro_step=19810/global_step=19810, RunningAvgSamplesPerSec=4.49060623028521, CurrSamplesPerSec=4.536046328342584, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:22:15,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=19820, skipped=93, lr=[1.0251216352356041e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:22:15,488] [INFO] [timer.py:258:stop] epoch=0/micro_step=19820/global_step=19820, RunningAvgSamplesPerSec=4.4906259827064146, CurrSamplesPerSec=4.52306525995226, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:22:24,479] [INFO] [logging.py:96:log_dist] [Rank 0] step=19830, skipped=93, lr=[1.0243812948296234e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:22:24,480] [INFO] [timer.py:258:stop] epoch=0/micro_step=19830/global_step=19830, RunningAvgSamplesPerSec=4.490641510023075, CurrSamplesPerSec=4.518528772830033, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:22:33,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=19840, skipped=93, lr=[1.0236519975678893e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:22:33,494] [INFO] [timer.py:258:stop] epoch=0/micro_step=19840/global_step=19840, RunningAvgSamplesPerSec=4.4906524405766515, CurrSamplesPerSec=4.510696668762867, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:22:42,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=19850, skipped=93, lr=[1.022933745249871e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:22:42,562] [INFO] [timer.py:258:stop] epoch=0/micro_step=19850/global_step=19850, RunningAvgSamplesPerSec=4.490654833790936, CurrSamplesPerSec=4.483097281450819, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:22:42,562] [INFO] [RANK 0]  iteration    19850/   20000 | elapsed time per iteration (ms): 1486.8 | learning rate 1.023E-05 | total loss 2.478671E-01 | loss 2.478671E-01 | loss scale 32768.0 |speed 161.42 samples/(min*GPU)
[2024-06-17 11:22:42,563] [INFO] [RANK 0] time (ms) | forward: 354.14 | backward: 542.96 | allreduce: 0.00 | optimizer: 3.11 | batch generator: 15.37 | data loader: 0.09
[2024-06-17 11:22:51,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=19860, skipped=93, lr=[1.0222265396477842e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:22:51,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=19860/global_step=19860, RunningAvgSamplesPerSec=4.490654804644247, CurrSamplesPerSec=4.485925013262146, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:23:00,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=19870, skipped=93, lr=[1.0215303825065885e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:23:00,650] [INFO] [timer.py:258:stop] epoch=0/micro_step=19870/global_step=19870, RunningAvgSamplesPerSec=4.490653817531846, CurrSamplesPerSec=4.483961165339162, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:23:09,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=19880, skipped=93, lr=[1.020845275543982e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:23:09,698] [INFO] [timer.py:258:stop] epoch=0/micro_step=19880/global_step=19880, RunningAvgSamplesPerSec=4.490653177169716, CurrSamplesPerSec=4.489856672731745, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:23:18,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=19890, skipped=93, lr=[1.0201712204503991e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:23:18,754] [INFO] [timer.py:258:stop] epoch=0/micro_step=19890/global_step=19890, RunningAvgSamplesPerSec=4.490651819572902, CurrSamplesPerSec=4.4816518295279275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:23:27,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=19900, skipped=93, lr=[1.0195082188890029e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:23:27,837] [INFO] [timer.py:258:stop] epoch=0/micro_step=19900/global_step=19900, RunningAvgSamplesPerSec=4.490649716284924, CurrSamplesPerSec=4.480577027437005, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:23:27,838] [INFO] [RANK 0]  iteration    19900/   20000 | elapsed time per iteration (ms): 905.5 | learning rate 1.019E-05 | total loss 2.757742E-01 | loss 2.757742E-01 | loss scale 32768.0 |speed 265.04 samples/(min*GPU)
[2024-06-17 11:23:27,838] [INFO] [RANK 0] time (ms) | forward: 354.76 | backward: 546.95 | allreduce: 0.00 | optimizer: 3.09 | batch generator: 13.92 | data loader: 0.09
[2024-06-17 11:23:36,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=19910, skipped=93, lr=[1.0188562724956841e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:23:36,922] [INFO] [timer.py:258:stop] epoch=0/micro_step=19910/global_step=19910, RunningAvgSamplesPerSec=4.49064860649996, CurrSamplesPerSec=4.495923118212287, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:23:46,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=19920, skipped=93, lr=[1.0182153828790548e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:23:46,011] [INFO] [timer.py:258:stop] epoch=0/micro_step=19920/global_step=19920, RunningAvgSamplesPerSec=4.49064535709809, CurrSamplesPerSec=4.483840129652054, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:23:55,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=19930, skipped=93, lr=[1.0175855516204482e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:23:55,113] [INFO] [timer.py:258:stop] epoch=0/micro_step=19930/global_step=19930, RunningAvgSamplesPerSec=4.490641304475581, CurrSamplesPerSec=4.488370836264991, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:24:04,190] [INFO] [logging.py:96:log_dist] [Rank 0] step=19940, skipped=93, lr=[1.0169667802739087e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:24:04,191] [INFO] [timer.py:258:stop] epoch=0/micro_step=19940/global_step=19940, RunningAvgSamplesPerSec=4.490641271741954, CurrSamplesPerSec=4.487388826419967, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:24:13,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=19950, skipped=93, lr=[1.0163590703661938e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:24:13,274] [INFO] [timer.py:258:stop] epoch=0/micro_step=19950/global_step=19950, RunningAvgSamplesPerSec=4.490638565260438, CurrSamplesPerSec=4.488442883246341, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:24:13,274] [INFO] [RANK 0]  iteration    19950/   20000 | elapsed time per iteration (ms): 908.7 | learning rate 1.016E-05 | total loss 2.413446E-01 | loss 2.413446E-01 | loss scale 32768.0 |speed 264.11 samples/(min*GPU)
[2024-06-17 11:24:13,274] [INFO] [RANK 0] time (ms) | forward: 357.92 | backward: 546.86 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 16.50 | data loader: 0.09
[2024-06-17 11:24:22,328] [INFO] [logging.py:96:log_dist] [Rank 0] step=19960, skipped=93, lr=[1.0157624233967676e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:24:22,328] [INFO] [timer.py:258:stop] epoch=0/micro_step=19960/global_step=19960, RunningAvgSamplesPerSec=4.4906393074665845, CurrSamplesPerSec=4.486797186915741, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:24:31,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=19970, skipped=93, lr=[1.0151768408377963e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:24:31,395] [INFO] [timer.py:258:stop] epoch=0/micro_step=19970/global_step=19970, RunningAvgSamplesPerSec=4.490637890450316, CurrSamplesPerSec=4.487203997323278, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:24:40,453] [INFO] [logging.py:96:log_dist] [Rank 0] step=19980, skipped=93, lr=[1.0146023241341474e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:24:40,454] [INFO] [timer.py:258:stop] epoch=0/micro_step=19980/global_step=19980, RunningAvgSamplesPerSec=4.490637315178179, CurrSamplesPerSec=4.491119866411182, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:24:49,547] [INFO] [logging.py:96:log_dist] [Rank 0] step=19990, skipped=93, lr=[1.0140388747033834e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:24:49,548] [INFO] [timer.py:258:stop] epoch=0/micro_step=19990/global_step=19990, RunningAvgSamplesPerSec=4.490635358221354, CurrSamplesPerSec=4.490476762744377, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:24:58,647] [INFO] [logging.py:96:log_dist] [Rank 0] step=20000, skipped=93, lr=[1.0134864939357595e-05], mom=[[0.9, 0.95]]
[2024-06-17 11:24:58,647] [INFO] [timer.py:258:stop] epoch=0/micro_step=20000/global_step=20000, RunningAvgSamplesPerSec=4.49063058605574, CurrSamplesPerSec=4.486903982507264, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 11:24:58,648] [INFO] [RANK 0]  iteration    20000/   20000 | elapsed time per iteration (ms): 907.5 | learning rate 1.013E-05 | total loss 3.168604E-01 | loss 3.168604E-01 | loss scale 32768.0 |speed 264.47 samples/(min*GPU)
[2024-06-17 11:24:58,648] [INFO] [RANK 0] time (ms) | forward: 356.97 | backward: 546.66 | allreduce: 0.00 | optimizer: 3.13 | batch generator: 15.67 | data loader: 0.10
[2024-06-17 11:25:05,306] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 11:25:05,306] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 11:25:05,306] [INFO] [RANK 0]  validation loss at iteration 20000 | loss: 9.357910E-01 | PPL: 2.549229E+00 loss 9.350586E-01 |
[2024-06-17 11:25:05,306] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 11:25:05,527] [INFO] [RANK 0] Saving Model...
[2024-06-17 11:25:05,545] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-05-47/20000/mp_rank_00_model_states.pt
[2024-06-17 11:25:05,545] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-05-47/20000/mp_rank_00_model_states.pt...
[2024-06-17 11:25:34,536] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-05-47/20000/mp_rank_00_model_states.pt.
discover-01:4104408:4106001 [0] NCCL INFO [Service thread] Connection closed by localRank 0
discover-01:4104408:40382 [0] NCCL INFO comm 0x55aad4a72d30 rank 0 nranks 1 cudaDev 0 busId 1000 - Abort COMPLETE
[2024-06-17 11:25:36,772] [INFO] [launch.py:351:main] Process 4104408 exits successfully.
