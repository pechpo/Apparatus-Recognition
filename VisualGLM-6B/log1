NCCL_DEBUG=info NCCL_IB_DISABLE=0 NCCL_NET_GDR_LEVEL=2 deepspeed --master_port 16666 --hostfile hostfile_single finetune_visualglm.py --experiment-name finetune-visualglm-6b --model-parallel-size 1 --mode finetune --train-iters 10000 --resume-dataloader --max_source_length 64 --max_target_length 256 --lora_rank 20 --layer_range 0 4 8 14 --pre_seq_len 4 --train-data ./finetune-data/train/dataset.json --valid-data ./finetune-data/test/dataset.json --distributed-backend nccl --lr-decay-style cosine --warmup .02 --checkpoint-activations --save-interval 300 --eval-interval 1000 --save ./checkpoints --split 1 --eval-iters 10 --eval-batch-size 8 --zero-stage 1 --lr 0.0001 --batch-size 4 --skip-init --fp16 --use_lora
[2024-06-17 18:37:05,503] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 18:37:07,511] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0: setting --include=localhost:0
[2024-06-17 18:37:07,512] [INFO] [runner.py:568:main] cmd = /DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/bin/python3.12 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=16666 --enable_each_rank_log=None finetune_visualglm.py --experiment-name finetune-visualglm-6b --model-parallel-size 1 --mode finetune --train-iters 10000 --resume-dataloader --max_source_length 64 --max_target_length 256 --lora_rank 20 --layer_range 0 4 8 14 --pre_seq_len 4 --train-data ./finetune-data/train/dataset.json --valid-data ./finetune-data/test/dataset.json --distributed-backend nccl --lr-decay-style cosine --warmup .02 --checkpoint-activations --save-interval 300 --eval-interval 1000 --save ./checkpoints --split 1 --eval-iters 10 --eval-batch-size 8 --zero-stage 1 --lr 0.0001 --batch-size 4 --skip-init --fp16 --use_lora
[2024-06-17 18:37:10,474] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 18:37:12,209] [INFO] [launch.py:139:main] 0 NCCL_IB_DISABLE=0
[2024-06-17 18:37:12,209] [INFO] [launch.py:139:main] 0 NCCL_DEBUG=info
[2024-06-17 18:37:12,209] [INFO] [launch.py:139:main] 0 NCCL_NET_GDR_LEVEL=2
[2024-06-17 18:37:12,209] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2024-06-17 18:37:12,210] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2024-06-17 18:37:12,210] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2024-06-17 18:37:12,210] [INFO] [launch.py:164:main] dist_world_size=1
[2024-06-17 18:37:12,211] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2024-06-17 18:37:12,212] [INFO] [launch.py:256:main] process 743524 spawned with command: ['/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/bin/python3.12', '-u', 'finetune_visualglm.py', '--local_rank=0', '--experiment-name', 'finetune-visualglm-6b', '--model-parallel-size', '1', '--mode', 'finetune', '--train-iters', '10000', '--resume-dataloader', '--max_source_length', '64', '--max_target_length', '256', '--lora_rank', '20', '--layer_range', '0', '4', '8', '14', '--pre_seq_len', '4', '--train-data', './finetune-data/train/dataset.json', '--valid-data', './finetune-data/test/dataset.json', '--distributed-backend', 'nccl', '--lr-decay-style', 'cosine', '--warmup', '.02', '--checkpoint-activations', '--save-interval', '300', '--eval-interval', '1000', '--save', './checkpoints', '--split', '1', '--eval-iters', '10', '--eval-batch-size', '8', '--zero-stage', '1', '--lr', '0.0001', '--batch-size', '4', '--skip-init', '--fp16', '--use_lora']
[2024-06-17 18:37:14,669] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.3
[93m [WARNING] [0m please install triton==1.0.0 if you want to use sparse attention
[2024-06-17 18:37:18,315] [INFO] using world size: 1 and model-parallel size: 1 
[2024-06-17 18:37:18,315] [INFO] > padded vocab (size: 100) with 28 dummy tokens (new size: 128)
[2024-06-17 18:37:18,319] [INFO] [RANK 0] > initializing model parallel with size 1
[2024-06-17 18:37:18,320] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-06-17 18:37:18,321] [WARNING] [config_utils.py:69:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
[2024-06-17 18:37:18,322] [INFO] [checkpointing.py:1048:_configure_using_config_file] {'partition_activations': False, 'contiguous_memory_optimization': False, 'cpu_checkpointing': False, 'number_checkpoints': None, 'synchronize_checkpoint_boundary': False, 'profile': False}
[2024-06-17 18:37:18,326] [INFO] [checkpointing.py:229:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
[2024-06-17 18:37:18,328] [INFO] [RANK 0] building FineTuneVisualGLMModel model ...
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
replacing layer 0 attention with lora
replacing layer 14 attention with lora
[2024-06-17 18:37:29,560] [INFO] [RANK 0]  > number of parameters on model parallel rank 0: 7802848768
[2024-06-17 18:37:31,822] [INFO] [RANK 0] global rank 0 is loading checkpoint ./checkpoints/finetune-visualglm-6b-06-17-05-47/20000/mp_rank_00_model_states.pt
[2024-06-17 18:37:40,525] [INFO] [RANK 0] > successfully loaded ./checkpoints/finetune-visualglm-6b-06-17-05-47/20000/mp_rank_00_model_states.pt
[2024-06-17 18:37:47,190] [INFO] [RANK 0] Try to load tokenizer from Huggingface transformers...
[2024-06-17 18:37:49,059] [INFO] [RANK 0] > Set tokenizer as a THUDM/chatglm-6b tokenizer! Now you can get_tokenizer() everywhere.
discover-01:743524:743524 [0] NCCL INFO Bootstrap : Using enp196s0f0:10.0.0.14<0>
discover-01:743524:743524 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
discover-01:743524:743524 [0] NCCL INFO cudaDriverVersion 12030
NCCL version 2.20.5+cuda12.4
discover-01:743524:743907 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
discover-01:743524:743907 [0] NCCL INFO NET/IB : No device found.
discover-01:743524:743907 [0] NCCL INFO NET/Socket : Using [0]enp196s0f0:10.0.0.14<0> [1]tun0:198.18.1.50<0>
discover-01:743524:743907 [0] NCCL INFO Using non-device net plugin version 0
discover-01:743524:743907 [0] NCCL INFO Using network Socket
discover-01:743524:743907 [0] NCCL INFO comm 0x55ea0f626490 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xc9a5e5c050330ea0 - Init START
discover-01:743524:743907 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:743524:743907 [0] NCCL INFO comm 0x55ea0f626490 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:743524:743907 [0] NCCL INFO Channel 00/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 01/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 02/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 03/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 04/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 05/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 06/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 07/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 08/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 09/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 10/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 11/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 12/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 13/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 14/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 15/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 16/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 17/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 18/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 19/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 20/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 21/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 22/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 23/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 24/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 25/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 26/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 27/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 28/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 29/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 30/32 :    0
discover-01:743524:743907 [0] NCCL INFO Channel 31/32 :    0
discover-01:743524:743907 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:743524:743907 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:743524:743907 [0] NCCL INFO Connected all rings
discover-01:743524:743907 [0] NCCL INFO Connected all trees
discover-01:743524:743907 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:743524:743907 [0] NCCL INFO comm 0x55ea0f626490 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xc9a5e5c050330ea0 - Init COMPLETE
transformer.layers.0.attention.query_key_value.matrix_A.0
transformer.layers.0.attention.query_key_value.matrix_A.1
transformer.layers.0.attention.query_key_value.matrix_A.2
transformer.layers.0.attention.query_key_value.matrix_B.0
transformer.layers.0.attention.query_key_value.matrix_B.1
transformer.layers.0.attention.query_key_value.matrix_B.2
transformer.layers.0.attention.dense.matrix_A.0
transformer.layers.0.attention.dense.matrix_B.0
transformer.layers.14.attention.query_key_value.matrix_A.0
transformer.layers.14.attention.query_key_value.matrix_A.1
transformer.layers.14.attention.query_key_value.matrix_A.2
transformer.layers.14.attention.query_key_value.matrix_B.0
transformer.layers.14.attention.query_key_value.matrix_B.1
transformer.layers.14.attention.query_key_value.matrix_B.2
transformer.layers.14.attention.dense.matrix_A.0
transformer.layers.14.attention.dense.matrix_B.0
[2024-06-17 18:38:44,167] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.3, git-hash=unknown, git-branch=unknown
[2024-06-17 18:38:44,168] [WARNING] [config_utils.py:69:_process_deprecated_field] Config parameter cpu_offload is deprecated use offload_optimizer instead
discover-01:743524:743912 [0] NCCL INFO Using non-device net plugin version 0
discover-01:743524:743912 [0] NCCL INFO Using network Socket
discover-01:743524:743912 [0] NCCL INFO bootstrapSplit: comm 0x55e9f2697160 parent 0x55ea0f626490 rank 0 nranks 1 color -1091263299 key 0 prev 0 next 0 - DONE
discover-01:743524:743912 [0] NCCL INFO comm 0x55e9f2697160 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xa80587eb82bdca45 - Init START
discover-01:743524:743912 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:743524:743912 [0] NCCL INFO comm 0x55e9f2697160 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:743524:743912 [0] NCCL INFO Channel 00/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 01/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 02/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 03/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 04/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 05/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 06/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 07/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 08/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 09/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 10/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 11/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 12/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 13/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 14/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 15/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 16/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 17/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 18/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 19/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 20/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 21/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 22/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 23/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 24/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 25/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 26/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 27/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 28/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 29/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 30/32 :    0
discover-01:743524:743912 [0] NCCL INFO Channel 31/32 :    0
discover-01:743524:743912 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:743524:743912 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:743524:743912 [0] NCCL INFO Connected all rings
discover-01:743524:743912 [0] NCCL INFO Connected all trees
discover-01:743524:743912 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:743524:743912 [0] NCCL INFO comm 0x55e9f2697160 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xa80587eb82bdca45 - Init COMPLETE
[2024-06-17 18:38:44,263] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /DATA_EDS2/AIGC/2311/dingkr2311/.cache/torch_extensions/py312_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /DATA_EDS2/AIGC/2311/dingkr2311/.cache/torch_extensions/py312_cu121/fused_adam/build.ninja...
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.051208734512329 seconds
[2024-06-17 18:38:45,325] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-06-17 18:38:45,326] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-06-17 18:38:45,330] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-06-17 18:38:45,330] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-06-17 18:38:45,330] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 1 optimizer
[2024-06-17 18:38:45,331] [INFO] [stage_1_and_2.py:148:__init__] Reduce bucket size 40000000
[2024-06-17 18:38:45,332] [INFO] [stage_1_and_2.py:149:__init__] Allgather bucket size 100000000
[2024-06-17 18:38:45,332] [INFO] [stage_1_and_2.py:150:__init__] CPU Offload: False
[2024-06-17 18:38:45,332] [INFO] [stage_1_and_2.py:151:__init__] Round robin gradient partitioning: False
[2024-06-17 18:38:45,836] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2024-06-17 18:38:45,837] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 18:38:45,838] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 30.51 GB, percent = 3.0%
[2024-06-17 18:38:46,031] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2024-06-17 18:38:46,032] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 18:38:46,032] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 30.51 GB, percent = 3.0%
[2024-06-17 18:38:46,033] [INFO] [stage_1_and_2.py:543:__init__] optimizer state initialized
[2024-06-17 18:38:46,222] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2024-06-17 18:38:46,223] [INFO] [utils.py:782:see_memory_usage] MA 14.56 GB         Max_MA 14.56 GB         CA 14.68 GB         Max_CA 15 GB 
[2024-06-17 18:38:46,223] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 30.51 GB, percent = 3.0%
[2024-06-17 18:38:46,225] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2024-06-17 18:38:46,225] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-06-17 18:38:46,226] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-06-17 18:38:46,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0001], mom=[[0.9, 0.95]]
[2024-06-17 18:38:46,230] [INFO] [config.py:1000:print] DeepSpeedEngine configuration:
[2024-06-17 18:38:46,230] [INFO] [config.py:1004:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-06-17 18:38:46,230] [INFO] [config.py:1004:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-06-17 18:38:46,230] [INFO] [config.py:1004:print]   amp_enabled .................. False
[2024-06-17 18:38:46,231] [INFO] [config.py:1004:print]   amp_params ................... False
[2024-06-17 18:38:46,231] [INFO] [config.py:1004:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-06-17 18:38:46,231] [INFO] [config.py:1004:print]   bfloat16_enabled ............. False
[2024-06-17 18:38:46,232] [INFO] [config.py:1004:print]   bfloat16_immediate_grad_update  False
[2024-06-17 18:38:46,233] [INFO] [config.py:1004:print]   checkpoint_parallel_write_pipeline  False
[2024-06-17 18:38:46,233] [INFO] [config.py:1004:print]   checkpoint_tag_validation_enabled  True
[2024-06-17 18:38:46,234] [INFO] [config.py:1004:print]   checkpoint_tag_validation_fail  False
[2024-06-17 18:38:46,234] [INFO] [config.py:1004:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9b19e55e80>
[2024-06-17 18:38:46,235] [INFO] [config.py:1004:print]   communication_data_type ...... None
[2024-06-17 18:38:46,235] [INFO] [config.py:1004:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-06-17 18:38:46,236] [INFO] [config.py:1004:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-06-17 18:38:46,236] [INFO] [config.py:1004:print]   curriculum_enabled_legacy .... False
[2024-06-17 18:38:46,237] [INFO] [config.py:1004:print]   curriculum_params_legacy ..... False
[2024-06-17 18:38:46,237] [INFO] [config.py:1004:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-06-17 18:38:46,237] [INFO] [config.py:1004:print]   data_efficiency_enabled ...... False
[2024-06-17 18:38:46,238] [INFO] [config.py:1004:print]   dataloader_drop_last ......... False
[2024-06-17 18:38:46,238] [INFO] [config.py:1004:print]   disable_allgather ............ False
[2024-06-17 18:38:46,239] [INFO] [config.py:1004:print]   dump_state ................... False
[2024-06-17 18:38:46,239] [INFO] [config.py:1004:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 400, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2024-06-17 18:38:46,240] [INFO] [config.py:1004:print]   eigenvalue_enabled ........... False
[2024-06-17 18:38:46,240] [INFO] [config.py:1004:print]   eigenvalue_gas_boundary_resolution  1
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   eigenvalue_layer_num ......... 0
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   eigenvalue_max_iter .......... 100
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   eigenvalue_stability ......... 1e-06
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   eigenvalue_tol ............... 0.01
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   eigenvalue_verbose ........... False
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   elasticity_enabled ........... False
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   fp16_auto_cast ............... False
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   fp16_enabled ................. True
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   fp16_master_weights_and_gradients  False
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   global_rank .................. 0
[2024-06-17 18:38:46,241] [INFO] [config.py:1004:print]   grad_accum_dtype ............. None
[2024-06-17 18:38:46,242] [INFO] [config.py:1004:print]   gradient_accumulation_steps .. 1
[2024-06-17 18:38:46,242] [INFO] [config.py:1004:print]   gradient_clipping ............ 0.1
[2024-06-17 18:38:46,242] [INFO] [config.py:1004:print]   gradient_predivide_factor .... 1.0
[2024-06-17 18:38:46,242] [INFO] [config.py:1004:print]   graph_harvesting ............. False
[2024-06-17 18:38:46,243] [INFO] [config.py:1004:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-06-17 18:38:46,243] [INFO] [config.py:1004:print]   initial_dynamic_scale ........ 65536
[2024-06-17 18:38:46,244] [INFO] [config.py:1004:print]   load_universal_checkpoint .... False
[2024-06-17 18:38:46,245] [INFO] [config.py:1004:print]   loss_scale ................... 0
[2024-06-17 18:38:46,245] [INFO] [config.py:1004:print]   memory_breakdown ............. False
[2024-06-17 18:38:46,246] [INFO] [config.py:1004:print]   mics_hierarchial_params_gather  False
[2024-06-17 18:38:46,246] [INFO] [config.py:1004:print]   mics_shard_size .............. -1
[2024-06-17 18:38:46,247] [INFO] [config.py:1004:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-06-17 18:38:46,247] [INFO] [config.py:1004:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-06-17 18:38:46,248] [INFO] [config.py:1004:print]   optimizer_legacy_fusion ...... False
[2024-06-17 18:38:46,248] [INFO] [config.py:1004:print]   optimizer_name ............... adam
[2024-06-17 18:38:46,249] [INFO] [config.py:1004:print]   optimizer_params ............. {'lr': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'weight_decay': 0.01}
[2024-06-17 18:38:46,249] [INFO] [config.py:1004:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-06-17 18:38:46,250] [INFO] [config.py:1004:print]   pld_enabled .................. False
[2024-06-17 18:38:46,250] [INFO] [config.py:1004:print]   pld_params ................... False
[2024-06-17 18:38:46,251] [INFO] [config.py:1004:print]   prescale_gradients ........... False
[2024-06-17 18:38:46,251] [INFO] [config.py:1004:print]   scheduler_name ............... None
[2024-06-17 18:38:46,252] [INFO] [config.py:1004:print]   scheduler_params ............. None
[2024-06-17 18:38:46,252] [INFO] [config.py:1004:print]   seq_parallel_communication_data_type  torch.float32
[2024-06-17 18:38:46,253] [INFO] [config.py:1004:print]   sparse_attention ............. None
[2024-06-17 18:38:46,253] [INFO] [config.py:1004:print]   sparse_gradients_enabled ..... False
[2024-06-17 18:38:46,253] [INFO] [config.py:1004:print]   steps_per_print .............. 10
[2024-06-17 18:38:46,254] [INFO] [config.py:1004:print]   timers_config ................ enabled=True synchronized=True
[2024-06-17 18:38:46,254] [INFO] [config.py:1004:print]   train_batch_size ............. 4
[2024-06-17 18:38:46,254] [INFO] [config.py:1004:print]   train_micro_batch_size_per_gpu  4
[2024-06-17 18:38:46,255] [INFO] [config.py:1004:print]   use_data_before_expert_parallel_  False
[2024-06-17 18:38:46,255] [INFO] [config.py:1004:print]   use_node_local_storage ....... False
[2024-06-17 18:38:46,256] [INFO] [config.py:1004:print]   wall_clock_breakdown ......... False
[2024-06-17 18:38:46,256] [INFO] [config.py:1004:print]   weight_quantization_config ... None
[2024-06-17 18:38:46,257] [INFO] [config.py:1004:print]   world_size ................... 1
[2024-06-17 18:38:46,257] [INFO] [config.py:1004:print]   zero_allow_untested_optimizer  True
[2024-06-17 18:38:46,257] [INFO] [config.py:1004:print]   zero_config .................. stage=1 contiguous_gradients=False reduce_scatter=True reduce_bucket_size=40000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=100000000 overlap_comm=True load_from_fp32_weights=False elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-06-17 18:38:46,258] [INFO] [config.py:1004:print]   zero_enabled ................. True
[2024-06-17 18:38:46,258] [INFO] [config.py:1004:print]   zero_force_ds_cpu_optimizer .. True
[2024-06-17 18:38:46,258] [INFO] [config.py:1004:print]   zero_optimization_stage ...... 1
[2024-06-17 18:38:46,259] [INFO] [config.py:990:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 4, 
    "gradient_accumulation_steps": 1, 
    "gradient_clipping": 0.1, 
    "zero_optimization": {
        "stage": 1, 
        "cpu_offload": false, 
        "contiguous_gradients": false, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 4.000000e+07, 
        "allgather_bucket_size": 1.000000e+08, 
        "load_from_fp32_weights": false
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 400, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "bf16": {
        "enabled": false
    }, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0001, 
            "betas": [0.9, 0.95], 
            "eps": 1e-08, 
            "weight_decay": 0.01
        }
    }, 
    "activation_checkpointing": {
        "partition_activations": false, 
        "contiguous_memory_optimization": false
    }, 
    "wall_clock_breakdown": false
}
[2024-06-17 18:38:46,259] [INFO] [RANK 0] learning rate decaying style cosine, ratio 10.0
[2024-06-17 18:38:46,260] [INFO] [RANK 0] Finetuning Model...
[2024-06-17 18:38:46,260] [INFO] [RANK 0] arguments:
[2024-06-17 18:38:46,261] [INFO] [RANK 0]   model_class .................. FineTuneVisualGLMModel
[2024-06-17 18:38:46,261] [INFO] [RANK 0]   tokenizer_type ............... THUDM/chatglm-6b
[2024-06-17 18:38:46,262] [INFO] [RANK 0]   num_layers ................... 28
[2024-06-17 18:38:46,262] [INFO] [RANK 0]   hidden_size .................. 4096
[2024-06-17 18:38:46,263] [INFO] [RANK 0]   num_attention_heads .......... 32
[2024-06-17 18:38:46,263] [INFO] [RANK 0]   vocab_size ................... 130528
[2024-06-17 18:38:46,264] [INFO] [RANK 0]   layernorm_order .............. post
[2024-06-17 18:38:46,264] [INFO] [RANK 0]   model_parallel_size .......... 1
[2024-06-17 18:38:46,265] [INFO] [RANK 0]   max_sequence_length .......... 2048
[2024-06-17 18:38:46,265] [INFO] [RANK 0]   pre_seq_len .................. 4
[2024-06-17 18:38:46,266] [INFO] [RANK 0]   lora_rank .................... 10
[2024-06-17 18:38:46,266] [INFO] [RANK 0]   use_ptuning .................. False
[2024-06-17 18:38:46,267] [INFO] [RANK 0]   use_lora ..................... True
[2024-06-17 18:38:46,267] [INFO] [RANK 0]   use_qlora .................... False
[2024-06-17 18:38:46,268] [INFO] [RANK 0]   layer_range .................. [0, 14]
[2024-06-17 18:38:46,268] [INFO] [RANK 0]   image_length ................. 32
[2024-06-17 18:38:46,269] [INFO] [RANK 0]   eva_args ..................... {'num_layers': 39, 'hidden_size': 1408, 'num_attention_heads': 16, 'vocab_size': 1, 'layernorm_order': 'pre', 'model_parallel_size': 1, 'max_sequence_length': 257, 'inner_hidden_size': 6144, 'use_final_layernorm': False, 'layernorm_epsilon': 1e-06, 'image_size': [224, 224], 'pre_len': 1, 'post_len': 0, 'in_channels': 3, 'num_classes': 0, 'patch_size': 14}
[2024-06-17 18:38:46,269] [INFO] [RANK 0]   qformer_args ................. {'num_layers': 12, 'hidden_size': 768, 'num_attention_heads': 12, 'vocab_size': 32, 'layernorm_order': 'post', 'model_parallel_size': 1, 'max_sequence_length': 0, 'is_decoder': [True, False, True, False, True, False, True, False, True, False, True, False], 'cross_attn_hidden_size': 1408, 'layernorm_epsilon': 1e-12}
[2024-06-17 18:38:46,270] [INFO] [RANK 0]   bos_token_id ................. 130004
[2024-06-17 18:38:46,270] [INFO] [RANK 0]   mask_token_id ................ 130000
[2024-06-17 18:38:46,271] [INFO] [RANK 0]   gmask_token_id ............... 130001
[2024-06-17 18:38:46,271] [INFO] [RANK 0]   pad_token_id ................. 3
[2024-06-17 18:38:46,272] [INFO] [RANK 0]   image_size ................... [224, 224]
[2024-06-17 18:38:46,272] [INFO] [RANK 0]   pre_len ...................... 1
[2024-06-17 18:38:46,273] [INFO] [RANK 0]   post_len ..................... 0
[2024-06-17 18:38:46,273] [INFO] [RANK 0]   in_channels .................. 3
[2024-06-17 18:38:46,274] [INFO] [RANK 0]   patch_size ................... 14
[2024-06-17 18:38:46,274] [INFO] [RANK 0]   inner_hidden_size ............ None
[2024-06-17 18:38:46,275] [INFO] [RANK 0]   hidden_size_per_attention_head  None
[2024-06-17 18:38:46,275] [INFO] [RANK 0]   skip_init .................... True
[2024-06-17 18:38:46,276] [INFO] [RANK 0]   use_gpu_initialization ....... False
[2024-06-17 18:38:46,276] [INFO] [RANK 0]   num_multi_query_heads ........ 0
[2024-06-17 18:38:46,277] [INFO] [RANK 0]   layernorm_epsilon ............ 1e-05
[2024-06-17 18:38:46,277] [INFO] [RANK 0]   hidden_dropout ............... 0.1
[2024-06-17 18:38:46,278] [INFO] [RANK 0]   attention_dropout ............ 0.1
[2024-06-17 18:38:46,278] [INFO] [RANK 0]   make_vocab_size_divisible_by . 128
[2024-06-17 18:38:46,279] [INFO] [RANK 0]   experiment_name .............. finetune-visualglm-6b-06-17-18-37
[2024-06-17 18:38:46,279] [INFO] [RANK 0]   train_iters .................. 10000
[2024-06-17 18:38:46,280] [INFO] [RANK 0]   batch_size ................... 4
[2024-06-17 18:38:46,280] [INFO] [RANK 0]   lr ........................... 0.0001
[2024-06-17 18:38:46,281] [INFO] [RANK 0]   mode ......................... finetune
[2024-06-17 18:38:46,281] [INFO] [RANK 0]   seed ......................... 1234
[2024-06-17 18:38:46,282] [INFO] [RANK 0]   zero_stage ................... 1
[2024-06-17 18:38:46,282] [INFO] [RANK 0]   checkpoint_activations ....... True
[2024-06-17 18:38:46,283] [INFO] [RANK 0]   checkpoint_num_layers ........ 1
[2024-06-17 18:38:46,283] [INFO] [RANK 0]   fp16 ......................... True
[2024-06-17 18:38:46,284] [INFO] [RANK 0]   bf16 ......................... False
[2024-06-17 18:38:46,284] [INFO] [RANK 0]   gradient_accumulation_steps .. 1
[2024-06-17 18:38:46,285] [INFO] [RANK 0]   epochs ....................... None
[2024-06-17 18:38:46,286] [INFO] [RANK 0]   log_interval ................. 50
[2024-06-17 18:38:46,287] [INFO] [RANK 0]   summary_dir .................. 
[2024-06-17 18:38:46,287] [INFO] [RANK 0]   save_args .................... False
[2024-06-17 18:38:46,288] [INFO] [RANK 0]   lr_decay_iters ............... None
[2024-06-17 18:38:46,288] [INFO] [RANK 0]   lr_decay_style ............... cosine
[2024-06-17 18:38:46,289] [INFO] [RANK 0]   lr_decay_ratio ............... 0.1
[2024-06-17 18:38:46,289] [INFO] [RANK 0]   warmup ....................... 0.02
[2024-06-17 18:38:46,289] [INFO] [RANK 0]   weight_decay ................. 0.01
[2024-06-17 18:38:46,289] [INFO] [RANK 0]   save ......................... ./checkpoints/finetune-visualglm-6b-06-17-18-37
[2024-06-17 18:38:46,290] [INFO] [RANK 0]   load ......................... None
[2024-06-17 18:38:46,290] [INFO] [RANK 0]   save_interval ................ 300
[2024-06-17 18:38:46,291] [INFO] [RANK 0]   no_save_rng .................. False
[2024-06-17 18:38:46,291] [INFO] [RANK 0]   no_load_rng .................. False
[2024-06-17 18:38:46,292] [INFO] [RANK 0]   resume_dataloader ............ True
[2024-06-17 18:38:46,292] [INFO] [RANK 0]   distributed_backend .......... nccl
[2024-06-17 18:38:46,293] [INFO] [RANK 0]   local_rank ................... 0
[2024-06-17 18:38:46,293] [INFO] [RANK 0]   exit_interval ................ None
[2024-06-17 18:38:46,294] [INFO] [RANK 0]   eval_batch_size .............. 8
[2024-06-17 18:38:46,295] [INFO] [RANK 0]   eval_iters ................... 10
[2024-06-17 18:38:46,295] [INFO] [RANK 0]   eval_interval ................ 1000
[2024-06-17 18:38:46,296] [INFO] [RANK 0]   strict_eval .................. False
[2024-06-17 18:38:46,296] [INFO] [RANK 0]   train_data ................... ['./finetune-data/train/dataset.json']
[2024-06-17 18:38:46,297] [INFO] [RANK 0]   train_data_weights ........... None
[2024-06-17 18:38:46,297] [INFO] [RANK 0]   iterable_dataset ............. False
[2024-06-17 18:38:46,298] [INFO] [RANK 0]   valid_data ................... ['./finetune-data/test/dataset.json']
[2024-06-17 18:38:46,298] [INFO] [RANK 0]   test_data .................... None
[2024-06-17 18:38:46,299] [INFO] [RANK 0]   split ........................ 1
[2024-06-17 18:38:46,300] [INFO] [RANK 0]   num_workers .................. 1
[2024-06-17 18:38:46,300] [INFO] [RANK 0]   block_size ................... 10000
[2024-06-17 18:38:46,301] [INFO] [RANK 0]   prefetch_factor .............. 4
[2024-06-17 18:38:46,301] [INFO] [RANK 0]   temperature .................. 1.0
[2024-06-17 18:38:46,302] [INFO] [RANK 0]   top_p ........................ 0.0
[2024-06-17 18:38:46,302] [INFO] [RANK 0]   top_k ........................ 0
[2024-06-17 18:38:46,303] [INFO] [RANK 0]   num_beams .................... 1
[2024-06-17 18:38:46,303] [INFO] [RANK 0]   length_penalty ............... 0.0
[2024-06-17 18:38:46,304] [INFO] [RANK 0]   no_repeat_ngram_size ......... 0
[2024-06-17 18:38:46,304] [INFO] [RANK 0]   min_tgt_length ............... 0
[2024-06-17 18:38:46,305] [INFO] [RANK 0]   out_seq_length ............... 256
[2024-06-17 18:38:46,306] [INFO] [RANK 0]   input_source ................. interactive
[2024-06-17 18:38:46,307] [INFO] [RANK 0]   output_path .................. ./samples
[2024-06-17 18:38:46,307] [INFO] [RANK 0]   with_id ...................... False
[2024-06-17 18:38:46,308] [INFO] [RANK 0]   max_inference_batch_size ..... 12
[2024-06-17 18:38:46,308] [INFO] [RANK 0]   device ....................... cpu
[2024-06-17 18:38:46,309] [INFO] [RANK 0]   deepspeed .................... True
[2024-06-17 18:38:46,309] [INFO] [RANK 0]   deepspeed_config ............. {'train_micro_batch_size_per_gpu': 4, 'gradient_accumulation_steps': 1, 'gradient_clipping': 0.1, 'zero_optimization': {'stage': 1, 'cpu_offload': False, 'contiguous_gradients': False, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 40000000.0, 'allgather_bucket_size': 100000000.0, 'load_from_fp32_weights': False}, 'zero_allow_untested_optimizer': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 400, 'hysteresis': 2, 'min_loss_scale': 1}, 'bf16': {'enabled': False}, 'optimizer': {'type': 'Adam', 'params': {'lr': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'weight_decay': 0.01}}, 'activation_checkpointing': {'partition_activations': False, 'contiguous_memory_optimization': False}, 'wall_clock_breakdown': False}
[2024-06-17 18:38:46,310] [INFO] [RANK 0]   deepscale .................... False
[2024-06-17 18:38:46,310] [INFO] [RANK 0]   deepscale_config ............. None
[2024-06-17 18:38:46,311] [INFO] [RANK 0]   cuda ......................... True
[2024-06-17 18:38:46,311] [INFO] [RANK 0]   rank ......................... 0
[2024-06-17 18:38:46,312] [INFO] [RANK 0]   world_size ................... 1
[2024-06-17 18:38:46,312] [INFO] [RANK 0]   deepspeed_activation_checkpointing  True
[2024-06-17 18:38:46,313] [INFO] [RANK 0]   master_ip .................... 127.0.0.1
[2024-06-17 18:38:46,313] [INFO] [RANK 0]   master_port .................. 16666
[2024-06-17 18:38:46,314] [INFO] [RANK 0]   max_source_length ............ 64
[2024-06-17 18:38:46,314] [INFO] [RANK 0]   max_target_length ............ 256
[2024-06-17 18:38:46,315] [INFO] [RANK 0]   ignore_pad_token_for_loss .... True
[2024-06-17 18:38:46,315] [INFO] [RANK 0]   source_prefix ................ 
[2024-06-17 18:38:46,316] [INFO] [RANK 0]   do_train ..................... True
[2024-06-17 18:38:46,316] [INFO] [RANK 0]   val_last_shape ............... []
[2024-06-17 18:38:46,317] [INFO] [RANK 0]   val_drop_number .............. 0
[2024-06-17 18:38:46,317] [INFO] [RANK 0]   do_valid ..................... True
[2024-06-17 18:38:46,318] [INFO] [RANK 0]   do_test ...................... False
[2024-06-17 18:38:46,318] [INFO] [RANK 0]   iteration .................... 0
/DATA_EDS2/AIGC/2311/dingkr2311/.conda/envs/visualglm/lib/python3.12/site-packages/sat/mpu/data.py:49: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  sizes_cuda = torch.cuda.LongTensor(sizes)
discover-01:743524:744060 [0] NCCL INFO Using non-device net plugin version 0
discover-01:743524:744060 [0] NCCL INFO Using network Socket
discover-01:743524:744060 [0] NCCL INFO bootstrapSplit: comm 0x55e9da909070 parent 0x55ea0f626490 rank 0 nranks 1 color -1091263299 key 0 prev 0 next 0 - DONE
discover-01:743524:744060 [0] NCCL INFO comm 0x55e9da909070 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xa80587eb82bdca45 - Init START
discover-01:743524:744060 [0] NCCL INFO Setting affinity for GPU 0 to ffff0000,00000000,00000000,00000000,ffff0000,00000000
discover-01:743524:744060 [0] NCCL INFO comm 0x55e9da909070 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
discover-01:743524:744060 [0] NCCL INFO Channel 00/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 01/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 02/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 03/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 04/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 05/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 06/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 07/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 08/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 09/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 10/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 11/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 12/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 13/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 14/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 15/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 16/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 17/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 18/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 19/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 20/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 21/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 22/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 23/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 24/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 25/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 26/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 27/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 28/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 29/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 30/32 :    0
discover-01:743524:744060 [0] NCCL INFO Channel 31/32 :    0
discover-01:743524:744060 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
discover-01:743524:744060 [0] NCCL INFO P2P Chunksize set to 131072
discover-01:743524:744060 [0] NCCL INFO Connected all rings
discover-01:743524:744060 [0] NCCL INFO Connected all trees
discover-01:743524:744060 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
discover-01:743524:744060 [0] NCCL INFO comm 0x55e9da909070 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xa80587eb82bdca45 - Init COMPLETE
[2024-06-17 18:38:47,785] [INFO] [checkpointing.py:541:forward] Activation Checkpointing Information
[2024-06-17 18:38:47,785] [INFO] [checkpointing.py:542:forward] ----Partition Activations False, CPU CHECKPOINTING False
[2024-06-17 18:38:47,785] [INFO] [checkpointing.py:543:forward] ----contiguous Memory Checkpointing False with 6 total layers
[2024-06-17 18:38:47,785] [INFO] [checkpointing.py:545:forward] ----Synchronization False
[2024-06-17 18:38:47,785] [INFO] [checkpointing.py:546:forward] ----Profiling time in checkpointing False
[2024-06-17 18:38:49,872] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 18:38:50,776] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 18:38:58,191] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:38:58,192] [INFO] [timer.py:258:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=4.3859239195648065, CurrSamplesPerSec=4.508748638819942, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:39:07,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:39:07,156] [INFO] [timer.py:258:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=4.468147316258007, CurrSamplesPerSec=4.565832651610526, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:39:16,128] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:39:16,129] [INFO] [timer.py:258:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=4.495194972729675, CurrSamplesPerSec=4.547697623880946, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:39:25,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:39:25,142] [INFO] [timer.py:258:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=4.501358896159109, CurrSamplesPerSec=4.521320973005283, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:39:34,146] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:39:34,147] [INFO] [timer.py:258:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=4.505113064297172, CurrSamplesPerSec=4.516373358774229, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:39:34,148] [INFO] [RANK 0]  iteration       50/   10000 | elapsed time per iteration (ms): 952.1 | learning rate 5.000E-06 | total loss 2.855963E-01 | loss 2.855963E-01 | loss scale 32768.0 |speed 252.08 samples/(min*GPU)
[2024-06-17 18:39:34,150] [INFO] [RANK 0] after 50 iterations memory (MB) | allocated: 14931.65234375 | max allocated: 17771.33740234375 | cached: 19278.0 | max cached: 19278.0
[2024-06-17 18:39:34,150] [INFO] [RANK 0] time (ms) | forward: 389.43 | backward: 552.53 | allreduce: 0.00 | optimizer: 9.19 | batch generator: 17.00 | data loader: 0.47
[2024-06-17 18:39:43,168] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:39:43,169] [INFO] [timer.py:258:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=4.504317996258876, CurrSamplesPerSec=4.4944826294782505, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:39:52,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:39:52,216] [INFO] [timer.py:258:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=4.502838351401617, CurrSamplesPerSec=4.4729843435566075, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:40:01,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:40:01,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=4.501209273852289, CurrSamplesPerSec=4.491945953833446, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:40:10,331] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:40:10,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=4.499387089004712, CurrSamplesPerSec=4.45047560082106, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:40:19,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=2, lr=[5e-06], mom=[[0.9, 0.95]]
[2024-06-17 18:40:19,397] [INFO] [timer.py:258:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=4.497546063934805, CurrSamplesPerSec=4.4777930798876895, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:40:19,400] [INFO] [RANK 0]  iteration      100/   10000 | elapsed time per iteration (ms): 905.0 | learning rate 5.000E-06 | total loss 2.756418E-01 | loss 2.756418E-01 | loss scale 32768.0 |speed 265.18 samples/(min*GPU)
[2024-06-17 18:40:19,402] [INFO] [RANK 0] time (ms) | forward: 354.75 | backward: 546.09 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 13.60 | data loader: 0.09
[2024-06-17 18:40:28,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=2, lr=[5.4000000000000005e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:40:28,460] [INFO] [timer.py:258:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=4.495938568812903, CurrSamplesPerSec=4.491033307153599, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:40:37,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=2, lr=[5.9e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:40:37,542] [INFO] [timer.py:258:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=4.4941735501730316, CurrSamplesPerSec=4.4793675941670985, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:40:46,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=2, lr=[6.4e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:40:46,624] [INFO] [timer.py:258:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=4.492614112310254, CurrSamplesPerSec=4.4858794344180195, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:40:55,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=2, lr=[6.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:40:55,695] [INFO] [timer.py:258:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=4.491347422709333, CurrSamplesPerSec=4.465444684906342, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:41:04,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=2, lr=[7.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:41:04,750] [INFO] [timer.py:258:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=4.4906094700280565, CurrSamplesPerSec=4.488544953762723, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:41:04,751] [INFO] [RANK 0]  iteration      150/   10000 | elapsed time per iteration (ms): 907.0 | learning rate 7.450E-05 | total loss 3.271649E-01 | loss 3.271649E-01 | loss scale 32768.0 |speed 264.61 samples/(min*GPU)
[2024-06-17 18:41:04,752] [INFO] [RANK 0] time (ms) | forward: 355.85 | backward: 546.97 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 13.00 | data loader: 0.09
[2024-06-17 18:41:13,838] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=2, lr=[7.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:41:13,838] [INFO] [timer.py:258:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=4.48982624612087, CurrSamplesPerSec=4.484342290676366, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:41:22,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=2, lr=[8.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:41:22,900] [INFO] [timer.py:258:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=4.489307934936798, CurrSamplesPerSec=4.480998269267751, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:41:31,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=2, lr=[8.9e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:41:31,961] [INFO] [timer.py:258:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=4.488691206708598, CurrSamplesPerSec=4.474170047741289, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:41:41,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=2, lr=[9.400000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:41:41,044] [INFO] [timer.py:258:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=4.4879897347162965, CurrSamplesPerSec=4.4855424196057685, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:41:50,110] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=2, lr=[9.900000000000001e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:41:50,111] [INFO] [timer.py:258:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=4.487605079788352, CurrSamplesPerSec=4.47916070414052, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:41:50,111] [INFO] [RANK 0]  iteration      200/   10000 | elapsed time per iteration (ms): 907.2 | learning rate 9.950E-05 | total loss 3.499103E-01 | loss 3.499103E-01 | loss scale 32768.0 |speed 264.55 samples/(min*GPU)
[2024-06-17 18:41:50,112] [INFO] [RANK 0] time (ms) | forward: 356.13 | backward: 546.96 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 13.53 | data loader: 0.10
[2024-06-17 18:41:59,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=2, lr=[9.999985787777144e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:41:59,181] [INFO] [timer.py:258:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=4.487401596300178, CurrSamplesPerSec=4.477763202318788, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:42:08,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=2, lr=[9.999928050775647e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:42:08,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=4.487235812256198, CurrSamplesPerSec=4.490737588196875, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:42:17,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=2, lr=[9.999825901300984e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:42:17,356] [INFO] [timer.py:258:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=4.487134158713072, CurrSamplesPerSec=4.478359634048228, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:42:26,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=2, lr=[9.999679340361326e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:42:26,427] [INFO] [timer.py:258:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=4.486831455535427, CurrSamplesPerSec=4.490045325402994, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:42:35,474] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=2, lr=[9.999488369403173e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:42:35,474] [INFO] [timer.py:258:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=4.486732895247139, CurrSamplesPerSec=4.479658229200043, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:42:35,476] [INFO] [RANK 0]  iteration      250/   10000 | elapsed time per iteration (ms): 907.3 | learning rate 9.999E-05 | total loss 2.742758E-01 | loss 2.742758E-01 | loss scale 32768.0 |speed 264.52 samples/(min*GPU)
[2024-06-17 18:42:35,477] [INFO] [RANK 0] time (ms) | forward: 356.41 | backward: 546.78 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 14.42 | data loader: 0.09
[2024-06-17 18:42:44,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=2, lr=[9.999252990311333e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:42:44,542] [INFO] [timer.py:258:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=4.486597269300723, CurrSamplesPerSec=4.488559364091934, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:42:53,600] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=2, lr=[9.998973205408901e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:42:53,600] [INFO] [timer.py:258:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=4.486315586380134, CurrSamplesPerSec=4.495302727692176, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:43:02,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=2, lr=[9.998649017457239e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:43:02,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=4.486190945711364, CurrSamplesPerSec=4.468421554469723, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:43:11,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=2, lr=[9.998280429655952e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:43:11,732] [INFO] [timer.py:258:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=4.485805666455027, CurrSamplesPerSec=4.488767123287671, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:43:20,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=2, lr=[9.997867445642854e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:43:20,791] [INFO] [timer.py:258:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=4.485647457124334, CurrSamplesPerSec=4.477752446491587, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:43:20,792] [INFO] [RANK 0]  iteration      300/   10000 | elapsed time per iteration (ms): 906.3 | learning rate 9.998E-05 | total loss 3.107614E-01 | loss 3.107614E-01 | loss scale 32768.0 |speed 264.80 samples/(min*GPU)
[2024-06-17 18:43:20,793] [INFO] [RANK 0] time (ms) | forward: 355.32 | backward: 546.96 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 12.98 | data loader: 0.09
[2024-06-17 18:43:20,793] [INFO] [RANK 0] Saving Model...
[2024-06-17 18:43:20,809] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/300/mp_rank_00_model_states.pt
[2024-06-17 18:43:20,809] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/300/mp_rank_00_model_states.pt...
[2024-06-17 18:43:40,942] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/300/mp_rank_00_model_states.pt.
[2024-06-17 18:43:49,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=2, lr=[9.99741006949393e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:43:49,981] [INFO] [timer.py:258:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=4.486777501270326, CurrSamplesPerSec=4.506464545859409, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:43:58,985] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=2, lr=[9.9969083057233e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:43:58,985] [INFO] [timer.py:258:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=4.48772743242028, CurrSamplesPerSec=4.512021368692509, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:44:08,001] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=2, lr=[9.996362159283164e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:44:08,002] [INFO] [timer.py:258:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=4.488354018313808, CurrSamplesPerSec=4.5034984406934715, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:44:16,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=2, lr=[9.995771635563776e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:44:16,999] [INFO] [timer.py:258:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=4.488900613229511, CurrSamplesPerSec=4.510717285420384, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:44:26,010] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=2, lr=[9.995136740393356e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:44:26,010] [INFO] [timer.py:258:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=4.489238466046406, CurrSamplesPerSec=4.498542691497309, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:44:26,011] [INFO] [RANK 0]  iteration      350/   10000 | elapsed time per iteration (ms): 1304.4 | learning rate 9.995E-05 | total loss 2.564783E-01 | loss 2.564783E-01 | loss scale 32768.0 |speed 184.00 samples/(min*GPU)
[2024-06-17 18:44:26,012] [INFO] [RANK 0] time (ms) | forward: 353.59 | backward: 543.29 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 13.65 | data loader: 0.09
[2024-06-17 18:44:35,065] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=2, lr=[9.994457480038073e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:44:35,065] [INFO] [timer.py:258:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=4.489152340814238, CurrSamplesPerSec=4.464698413864258, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:44:44,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=2, lr=[9.993733861201945e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:44:44,135] [INFO] [timer.py:258:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=4.4891355430574755, CurrSamplesPerSec=4.489086605585693, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:44:53,185] [INFO] [logging.py:96:log_dist] [Rank 0] step=380, skipped=2, lr=[9.992965891026802e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:44:53,185] [INFO] [timer.py:258:stop] epoch=0/micro_step=380/global_step=380, RunningAvgSamplesPerSec=4.489055935243714, CurrSamplesPerSec=4.485314573515624, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:45:02,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=390, skipped=2, lr=[9.992153577092197e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:45:02,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=390/global_step=390, RunningAvgSamplesPerSec=4.488979170532912, CurrSamplesPerSec=4.4915599275662625, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:45:11,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=2, lr=[9.991296927415344e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:45:11,318] [INFO] [timer.py:258:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=4.48867347930473, CurrSamplesPerSec=4.463617476339301, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:45:11,319] [INFO] [RANK 0]  iteration      400/   10000 | elapsed time per iteration (ms): 906.2 | learning rate 9.991E-05 | total loss 3.286615E-01 | loss 3.286615E-01 | loss scale 32768.0 |speed 264.85 samples/(min*GPU)
[2024-06-17 18:45:11,320] [INFO] [RANK 0] time (ms) | forward: 355.50 | backward: 546.60 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 13.75 | data loader: 0.09
[2024-06-17 18:45:14,030] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 18:45:14,932] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 18:45:20,363] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=4, lr=[9.990579691606356e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:45:20,363] [INFO] [timer.py:258:stop] epoch=0/micro_step=410/global_step=410, RunningAvgSamplesPerSec=4.488613015126214, CurrSamplesPerSec=4.491514234144707, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:45:29,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=4, lr=[9.98964325919351e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:45:29,428] [INFO] [timer.py:258:stop] epoch=0/micro_step=420/global_step=420, RunningAvgSamplesPerSec=4.488445195797412, CurrSamplesPerSec=4.472569376316934, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:45:38,500] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=4, lr=[9.98866251581424e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:45:38,501] [INFO] [timer.py:258:stop] epoch=0/micro_step=430/global_step=430, RunningAvgSamplesPerSec=4.488323992940098, CurrSamplesPerSec=4.477684327452573, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:45:47,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=4, lr=[9.987637471148084e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:45:47,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=440/global_step=440, RunningAvgSamplesPerSec=4.488169210223139, CurrSamplesPerSec=4.438744552838688, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:45:56,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=4, lr=[9.986568135311822e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:45:56,646] [INFO] [timer.py:258:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=4.487961782988048, CurrSamplesPerSec=4.462859944292776, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:45:56,647] [INFO] [RANK 0]  iteration      450/   10000 | elapsed time per iteration (ms): 906.6 | learning rate 9.986E-05 | total loss 2.861374E-01 | loss 2.861374E-01 | loss scale 32768.0 |speed 264.74 samples/(min*GPU)
[2024-06-17 18:45:56,648] [INFO] [RANK 0] time (ms) | forward: 355.67 | backward: 546.75 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 13.57 | data loader: 0.10
[2024-06-17 18:46:05,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=4, lr=[9.985454518859362e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:46:05,711] [INFO] [timer.py:258:stop] epoch=0/micro_step=460/global_step=460, RunningAvgSamplesPerSec=4.487693301430781, CurrSamplesPerSec=4.475263265435685, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:46:14,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=4, lr=[9.984296632781656e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:46:14,775] [INFO] [timer.py:258:stop] epoch=0/micro_step=470/global_step=470, RunningAvgSamplesPerSec=4.487540659147025, CurrSamplesPerSec=4.480176203219052, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:46:23,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=4, lr=[9.983094488506567e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:46:23,834] [INFO] [timer.py:258:stop] epoch=0/micro_step=480/global_step=480, RunningAvgSamplesPerSec=4.487422177224538, CurrSamplesPerSec=4.480037427070485, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:46:32,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=4, lr=[9.981848097898774e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:46:32,888] [INFO] [timer.py:258:stop] epoch=0/micro_step=490/global_step=490, RunningAvgSamplesPerSec=4.487378437495456, CurrSamplesPerSec=4.487513654683355, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:46:41,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=4, lr=[9.98055747325965e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:46:41,956] [INFO] [timer.py:258:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=4.487223700904972, CurrSamplesPerSec=4.4841433303736995, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:46:41,956] [INFO] [RANK 0]  iteration      500/   10000 | elapsed time per iteration (ms): 906.2 | learning rate 9.980E-05 | total loss 3.255283E-01 | loss 3.255283E-01 | loss scale 32768.0 |speed 264.85 samples/(min*GPU)
[2024-06-17 18:46:41,957] [INFO] [RANK 0] time (ms) | forward: 355.21 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 12.86 | data loader: 0.10
[2024-06-17 18:46:51,001] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=4, lr=[9.979222627327138e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:46:51,001] [INFO] [timer.py:258:stop] epoch=0/micro_step=510/global_step=510, RunningAvgSamplesPerSec=4.48713755593808, CurrSamplesPerSec=4.455142573614328, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:47:00,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=4, lr=[9.977843573275632e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:47:00,070] [INFO] [timer.py:258:stop] epoch=0/micro_step=520/global_step=520, RunningAvgSamplesPerSec=4.487011526834717, CurrSamplesPerSec=4.465996230158889, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:47:09,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=4, lr=[9.976420324715835e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:47:09,120] [INFO] [timer.py:258:stop] epoch=0/micro_step=530/global_step=530, RunningAvgSamplesPerSec=4.486967920937303, CurrSamplesPerSec=4.491083799648363, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:47:18,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=4, lr=[9.97495289569464e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:47:18,173] [INFO] [timer.py:258:stop] epoch=0/micro_step=540/global_step=540, RunningAvgSamplesPerSec=4.4869057066413625, CurrSamplesPerSec=4.484109772544676, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:47:27,234] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=4, lr=[9.973441300694973e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:47:27,234] [INFO] [timer.py:258:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=4.48675058532327, CurrSamplesPerSec=4.470163369218698, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:47:27,236] [INFO] [RANK 0]  iteration      550/   10000 | elapsed time per iteration (ms): 905.6 | learning rate 9.973E-05 | total loss 2.602286E-01 | loss 2.602286E-01 | loss scale 32768.0 |speed 265.02 samples/(min*GPU)
[2024-06-17 18:47:27,236] [INFO] [RANK 0] time (ms) | forward: 354.49 | backward: 547.00 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 12.49 | data loader: 0.09
[2024-06-17 18:47:36,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=4, lr=[9.971885554635668e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:47:36,326] [INFO] [timer.py:258:stop] epoch=0/micro_step=560/global_step=560, RunningAvgSamplesPerSec=4.486554792132243, CurrSamplesPerSec=4.4774632536223296, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:47:45,407] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=4, lr=[9.970285672871313e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:47:45,408] [INFO] [timer.py:258:stop] epoch=0/micro_step=570/global_step=570, RunningAvgSamplesPerSec=4.486321635179301, CurrSamplesPerSec=4.478121759462536, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:47:54,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=4, lr=[9.968641671192096e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:47:54,486] [INFO] [timer.py:258:stop] epoch=0/micro_step=580/global_step=580, RunningAvgSamplesPerSec=4.486214206502889, CurrSamplesPerSec=4.484727077250347, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:48:03,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=4, lr=[9.966953565823649e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:48:03,562] [INFO] [timer.py:258:stop] epoch=0/micro_step=590/global_step=590, RunningAvgSamplesPerSec=4.486039109264296, CurrSamplesPerSec=4.4767953847734345, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:48:12,628] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=4, lr=[9.965221373426886e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:48:12,628] [INFO] [timer.py:258:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=4.485887706095099, CurrSamplesPerSec=4.466336259118176, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:48:12,629] [INFO] [RANK 0]  iteration      600/   10000 | elapsed time per iteration (ms): 907.9 | learning rate 9.965E-05 | total loss 3.675235E-01 | loss 3.675235E-01 | loss scale 32768.0 |speed 264.36 samples/(min*GPU)
[2024-06-17 18:48:12,630] [INFO] [RANK 0] time (ms) | forward: 356.45 | backward: 547.18 | allreduce: 0.00 | optimizer: 3.41 | batch generator: 13.69 | data loader: 0.20
[2024-06-17 18:48:12,631] [INFO] [RANK 0] Saving Model...
[2024-06-17 18:48:12,643] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/600/mp_rank_00_model_states.pt
[2024-06-17 18:48:12,643] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/600/mp_rank_00_model_states.pt...
[2024-06-17 18:48:35,192] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/600/mp_rank_00_model_states.pt.
[2024-06-17 18:48:44,230] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=4, lr=[9.963445111097852e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:48:44,231] [INFO] [timer.py:258:stop] epoch=0/micro_step=610/global_step=610, RunningAvgSamplesPerSec=4.486369062873639, CurrSamplesPerSec=4.513389343082581, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:48:53,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=4, lr=[9.961624796367537e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:48:53,234] [INFO] [timer.py:258:stop] epoch=0/micro_step=620/global_step=620, RunningAvgSamplesPerSec=4.486756541385605, CurrSamplesPerSec=4.517394856208302, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:49:02,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=4, lr=[9.959760447201712e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:49:02,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=630/global_step=630, RunningAvgSamplesPerSec=4.487099472958126, CurrSamplesPerSec=4.507833997126652, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:49:11,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=4, lr=[9.957852082000752e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:49:11,268] [INFO] [timer.py:258:stop] epoch=0/micro_step=640/global_step=640, RunningAvgSamplesPerSec=4.487451696840416, CurrSamplesPerSec=4.4966931224021796, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:49:20,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=4, lr=[9.955899719599449e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:49:20,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=4.487628207099589, CurrSamplesPerSec=4.503093505155663, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:49:20,299] [INFO] [RANK 0]  iteration      650/   10000 | elapsed time per iteration (ms): 1353.4 | learning rate 9.956E-05 | total loss 3.352417E-01 | loss 3.352417E-01 | loss scale 32768.0 |speed 177.33 samples/(min*GPU)
[2024-06-17 18:49:20,299] [INFO] [RANK 0] time (ms) | forward: 354.41 | backward: 543.25 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 14.07 | data loader: 0.12
[2024-06-17 18:49:29,355] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=4, lr=[9.953903379266834e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:49:29,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=660/global_step=660, RunningAvgSamplesPerSec=4.487642153035866, CurrSamplesPerSec=4.474936198905779, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:49:38,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=4, lr=[9.951863080705979e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:49:38,406] [INFO] [timer.py:258:stop] epoch=0/micro_step=670/global_step=670, RunningAvgSamplesPerSec=4.487635927422613, CurrSamplesPerSec=4.4865200220779835, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:49:47,456] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=4, lr=[9.949778844053809e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:49:47,456] [INFO] [timer.py:258:stop] epoch=0/micro_step=680/global_step=680, RunningAvgSamplesPerSec=4.487657800382957, CurrSamplesPerSec=4.489809812424332, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:49:56,529] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=4, lr=[9.947650689880895e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:49:56,530] [INFO] [timer.py:258:stop] epoch=0/micro_step=690/global_step=690, RunningAvgSamplesPerSec=4.4874802382971914, CurrSamplesPerSec=4.457797737571229, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:50:05,567] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=4, lr=[9.945478639191261e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:50:05,567] [INFO] [timer.py:258:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=4.487443424174024, CurrSamplesPerSec=4.49269534685186, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:50:05,569] [INFO] [RANK 0]  iteration      700/   10000 | elapsed time per iteration (ms): 905.4 | learning rate 9.945E-05 | total loss 3.222855E-01 | loss 3.222855E-01 | loss scale 32768.0 |speed 265.07 samples/(min*GPU)
[2024-06-17 18:50:05,570] [INFO] [RANK 0] time (ms) | forward: 354.83 | backward: 546.41 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 13.04 | data loader: 0.13
[2024-06-17 18:50:14,621] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=4, lr=[9.943262713422169e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:50:14,621] [INFO] [timer.py:258:stop] epoch=0/micro_step=710/global_step=710, RunningAvgSamplesPerSec=4.487400047320636, CurrSamplesPerSec=4.4882507631024895, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:50:23,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=4, lr=[9.941002934443916e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:50:23,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=720/global_step=720, RunningAvgSamplesPerSec=4.4872885151461075, CurrSamplesPerSec=4.471913694269723, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:50:32,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=4, lr=[9.938699324559604e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:50:32,754] [INFO] [timer.py:258:stop] epoch=0/micro_step=730/global_step=730, RunningAvgSamplesPerSec=4.487236826654276, CurrSamplesPerSec=4.480121170269383, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:50:41,829] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=4, lr=[9.936351906504936e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:50:41,831] [INFO] [timer.py:258:stop] epoch=0/micro_step=740/global_step=740, RunningAvgSamplesPerSec=4.487137156402832, CurrSamplesPerSec=4.480386776553167, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:50:50,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=4, lr=[9.933960703447975e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:50:50,874] [INFO] [timer.py:258:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=4.487082326051117, CurrSamplesPerSec=4.48315118956829, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:50:50,875] [INFO] [RANK 0]  iteration      750/   10000 | elapsed time per iteration (ms): 906.1 | learning rate 9.934E-05 | total loss 3.443379E-01 | loss 3.443379E-01 | loss scale 32768.0 |speed 264.86 samples/(min*GPU)
[2024-06-17 18:50:50,876] [INFO] [RANK 0] time (ms) | forward: 355.10 | backward: 546.82 | allreduce: 0.00 | optimizer: 3.39 | batch generator: 13.08 | data loader: 0.10
[2024-06-17 18:50:59,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=4, lr=[9.931525738988936e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:50:59,928] [INFO] [timer.py:258:stop] epoch=0/micro_step=760/global_step=760, RunningAvgSamplesPerSec=4.487013699367585, CurrSamplesPerSec=4.482753497956241, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:51:08,985] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=4, lr=[9.929047037159932e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:51:08,986] [INFO] [timer.py:258:stop] epoch=0/micro_step=770/global_step=770, RunningAvgSamplesPerSec=4.486999803191412, CurrSamplesPerSec=4.491556320157075, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:51:18,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=4, lr=[9.92652462242475e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:51:18,039] [INFO] [timer.py:258:stop] epoch=0/micro_step=780/global_step=780, RunningAvgSamplesPerSec=4.4869679756177385, CurrSamplesPerSec=4.4693821825339635, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:51:27,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=4, lr=[9.923958519678604e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:51:27,105] [INFO] [timer.py:258:stop] epoch=0/micro_step=790/global_step=790, RunningAvgSamplesPerSec=4.486883802240058, CurrSamplesPerSec=4.4855496151225, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:51:36,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=4, lr=[9.921348754247894e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:51:36,155] [INFO] [timer.py:258:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=4.486831177442262, CurrSamplesPerSec=4.490741194291048, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:51:36,157] [INFO] [RANK 0]  iteration      800/   10000 | elapsed time per iteration (ms): 905.6 | learning rate 9.921E-05 | total loss 3.004199E-01 | loss 3.004199E-01 | loss scale 32768.0 |speed 265.01 samples/(min*GPU)
[2024-06-17 18:51:36,158] [INFO] [RANK 0] time (ms) | forward: 354.78 | backward: 546.74 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 12.83 | data loader: 0.09
[2024-06-17 18:51:40,683] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 18:51:41,588] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 18:51:45,208] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=6, lr=[9.91922952206489e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:51:45,209] [INFO] [timer.py:258:stop] epoch=0/micro_step=810/global_step=810, RunningAvgSamplesPerSec=4.4868114583095435, CurrSamplesPerSec=4.487534059963725, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:51:54,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=6, lr=[9.916541228999864e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:51:54,251] [INFO] [timer.py:258:stop] epoch=0/micro_step=820/global_step=820, RunningAvgSamplesPerSec=4.486782158604311, CurrSamplesPerSec=4.49308397489133, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:52:03,284] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=6, lr=[9.913809346455937e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:52:03,286] [INFO] [timer.py:258:stop] epoch=0/micro_step=830/global_step=830, RunningAvgSamplesPerSec=4.4867570261209, CurrSamplesPerSec=4.485291790179698, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:52:12,315] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=6, lr=[9.911033901395686e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:52:12,316] [INFO] [timer.py:258:stop] epoch=0/micro_step=840/global_step=840, RunningAvgSamplesPerSec=4.486763020903124, CurrSamplesPerSec=4.489975630212969, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:52:21,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=6, lr=[9.908214921211635e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:52:21,383] [INFO] [timer.py:258:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=4.48672611106379, CurrSamplesPerSec=4.492063819310887, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:52:21,384] [INFO] [RANK 0]  iteration      850/   10000 | elapsed time per iteration (ms): 904.6 | learning rate 9.908E-05 | total loss 3.391411E-01 | loss 3.391411E-01 | loss scale 32768.0 |speed 265.32 samples/(min*GPU)
[2024-06-17 18:52:21,385] [INFO] [RANK 0] time (ms) | forward: 353.70 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 12.12 | data loader: 0.09
[2024-06-17 18:52:30,430] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=6, lr=[9.90535243372598e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:52:30,430] [INFO] [timer.py:258:stop] epoch=0/micro_step=860/global_step=860, RunningAvgSamplesPerSec=4.48666768439699, CurrSamplesPerSec=4.459047694478501, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:52:39,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=6, lr=[9.902446467190317e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:52:39,488] [INFO] [timer.py:258:stop] epoch=0/micro_step=870/global_step=870, RunningAvgSamplesPerSec=4.48667489912949, CurrSamplesPerSec=4.471121171766714, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:52:48,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=6, lr=[9.899497050285361e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:52:48,556] [INFO] [timer.py:258:stop] epoch=0/micro_step=880/global_step=880, RunningAvgSamplesPerSec=4.486646433683538, CurrSamplesPerSec=4.491256925393144, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:52:57,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=6, lr=[9.896504212120668e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:52:57,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=890/global_step=890, RunningAvgSamplesPerSec=4.486632379371816, CurrSamplesPerSec=4.48489012200765, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:53:06,649] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=6, lr=[9.893467982234342e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:53:06,650] [INFO] [timer.py:258:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=4.486569201312816, CurrSamplesPerSec=4.480987497893346, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:53:06,651] [INFO] [RANK 0]  iteration      900/   10000 | elapsed time per iteration (ms): 905.3 | learning rate 9.893E-05 | total loss 2.756888E-01 | loss 2.756888E-01 | loss scale 32768.0 |speed 265.10 samples/(min*GPU)
[2024-06-17 18:53:06,652] [INFO] [RANK 0] time (ms) | forward: 354.34 | backward: 546.79 | allreduce: 0.00 | optimizer: 3.44 | batch generator: 12.63 | data loader: 0.09
[2024-06-17 18:53:06,653] [INFO] [RANK 0] Saving Model...
[2024-06-17 18:53:06,665] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/900/mp_rank_00_model_states.pt
[2024-06-17 18:53:06,665] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/900/mp_rank_00_model_states.pt...
[2024-06-17 18:53:27,210] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/900/mp_rank_00_model_states.pt.
[2024-06-17 18:53:36,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=6, lr=[9.890388390592748e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:53:36,233] [INFO] [timer.py:258:stop] epoch=0/micro_step=910/global_step=910, RunningAvgSamplesPerSec=4.486943574235159, CurrSamplesPerSec=4.525129424533508, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:53:45,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=6, lr=[9.887265467590208e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:53:45,252] [INFO] [timer.py:258:stop] epoch=0/micro_step=920/global_step=920, RunningAvgSamplesPerSec=4.487232957739301, CurrSamplesPerSec=4.505502432112859, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:53:54,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=6, lr=[9.884099244048715e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:53:54,249] [INFO] [timer.py:258:stop] epoch=0/micro_step=930/global_step=930, RunningAvgSamplesPerSec=4.487497341974792, CurrSamplesPerSec=4.517695313015411, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:54:03,269] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=6, lr=[9.880889751217614e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:54:03,269] [INFO] [timer.py:258:stop] epoch=0/micro_step=940/global_step=940, RunningAvgSamplesPerSec=4.4876990493450934, CurrSamplesPerSec=4.512140290067422, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:54:12,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=6, lr=[9.877637020773307e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:54:12,312] [INFO] [timer.py:258:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=4.487743822468827, CurrSamplesPerSec=4.49249203574989, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:54:12,312] [INFO] [RANK 0]  iteration      950/   10000 | elapsed time per iteration (ms): 1313.2 | learning rate 9.877E-05 | total loss 2.565002E-01 | loss 2.565002E-01 | loss scale 32768.0 |speed 182.76 samples/(min*GPU)
[2024-06-17 18:54:12,314] [INFO] [RANK 0] time (ms) | forward: 354.10 | backward: 543.60 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 14.16 | data loader: 0.09
[2024-06-17 18:54:21,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=6, lr=[9.874341084818929e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:54:21,349] [INFO] [timer.py:258:stop] epoch=0/micro_step=960/global_step=960, RunningAvgSamplesPerSec=4.487742165328436, CurrSamplesPerSec=4.485051979631598, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:54:30,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=6, lr=[9.871001975884035e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:54:30,412] [INFO] [timer.py:258:stop] epoch=0/micro_step=970/global_step=970, RunningAvgSamplesPerSec=4.487756795368861, CurrSamplesPerSec=4.487464442711809, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:54:39,454] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=6, lr=[9.867619726924284e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:54:39,454] [INFO] [timer.py:258:stop] epoch=0/micro_step=980/global_step=980, RunningAvgSamplesPerSec=4.487701941123771, CurrSamplesPerSec=4.4777572268528525, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:54:48,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=6, lr=[9.86419437132111e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:54:48,535] [INFO] [timer.py:258:stop] epoch=0/micro_step=990/global_step=990, RunningAvgSamplesPerSec=4.487607676507208, CurrSamplesPerSec=4.484332701823112, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:54:57,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=6, lr=[9.860725942881385e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:54:57,606] [INFO] [timer.py:258:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=4.487566531274034, CurrSamplesPerSec=4.485061571561167, MemAllocated=14.6GB, MaxMemAllocated=17.35GB
[2024-06-17 18:54:57,607] [INFO] [RANK 0]  iteration     1000/   10000 | elapsed time per iteration (ms): 905.9 | learning rate 9.860E-05 | total loss 2.987756E-01 | loss 2.987756E-01 | loss scale 32768.0 |speed 264.93 samples/(min*GPU)
[2024-06-17 18:54:57,607] [INFO] [RANK 0] time (ms) | forward: 355.00 | backward: 546.69 | allreduce: 0.00 | optimizer: 3.41 | batch generator: 13.36 | data loader: 0.09
[2024-06-17 18:55:05,023] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 18:55:05,023] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 18:55:05,023] [INFO] [RANK 0]  validation loss at iteration 1000 | loss: 9.339355E-01 | PPL: 2.544504E+00 loss 9.335938E-01 |
[2024-06-17 18:55:05,024] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 18:55:14,073] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=6, lr=[9.857214475837101e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:55:14,074] [INFO] [timer.py:258:stop] epoch=0/micro_step=1010/global_step=1010, RunningAvgSamplesPerSec=4.487488257894269, CurrSamplesPerSec=4.487051584783108, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:55:23,136] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=6, lr=[9.853660004845018e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:55:23,136] [INFO] [timer.py:258:stop] epoch=0/micro_step=1020/global_step=1020, RunningAvgSamplesPerSec=4.487424142945755, CurrSamplesPerSec=4.483171555194515, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:55:32,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=6, lr=[9.850062564986333e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:55:32,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=1030/global_step=1030, RunningAvgSamplesPerSec=4.487391618026719, CurrSamplesPerSec=4.488721486671529, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:55:41,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=6, lr=[9.846422191766323e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:55:41,257] [INFO] [timer.py:258:stop] epoch=0/micro_step=1040/global_step=1040, RunningAvgSamplesPerSec=4.48738900680262, CurrSamplesPerSec=4.480639251358035, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:55:50,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=6, lr=[9.842738921114001e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:55:50,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=4.487314720940941, CurrSamplesPerSec=4.476161153600493, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:55:50,324] [INFO] [RANK 0]  iteration     1050/   10000 | elapsed time per iteration (ms): 1054.3 | learning rate 9.842E-05 | total loss 2.525958E-01 | loss 2.525958E-01 | loss scale 32768.0 |speed 227.63 samples/(min*GPU)
[2024-06-17 18:55:50,325] [INFO] [RANK 0] time (ms) | forward: 354.99 | backward: 546.88 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 15.59 | data loader: 0.14
[2024-06-17 18:55:59,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=6, lr=[9.83901278938176e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:55:59,384] [INFO] [timer.py:258:stop] epoch=0/micro_step=1060/global_step=1060, RunningAvgSamplesPerSec=4.487233927277971, CurrSamplesPerSec=4.472336885228203, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:56:08,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=6, lr=[9.835243833345022e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:56:08,460] [INFO] [timer.py:258:stop] epoch=0/micro_step=1070/global_step=1070, RunningAvgSamplesPerSec=4.487150138900107, CurrSamplesPerSec=4.469609603529393, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:56:17,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=6, lr=[9.831432090201855e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:56:17,512] [INFO] [timer.py:258:stop] epoch=0/micro_step=1080/global_step=1080, RunningAvgSamplesPerSec=4.487121163620592, CurrSamplesPerSec=4.483716703948089, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:56:26,569] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=6, lr=[9.827577597572628e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:56:26,569] [INFO] [timer.py:258:stop] epoch=0/micro_step=1090/global_step=1090, RunningAvgSamplesPerSec=4.487096871986962, CurrSamplesPerSec=4.48353457357397, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:56:35,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=6, lr=[9.823680393499628e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:56:35,614] [INFO] [timer.py:258:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=4.487097491295782, CurrSamplesPerSec=4.481141892541587, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:56:35,615] [INFO] [RANK 0]  iteration     1100/   10000 | elapsed time per iteration (ms): 905.8 | learning rate 9.823E-05 | total loss 2.737299E-01 | loss 2.737299E-01 | loss scale 32768.0 |speed 264.96 samples/(min*GPU)
[2024-06-17 18:56:35,615] [INFO] [RANK 0] time (ms) | forward: 355.05 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 12.97 | data loader: 0.09
[2024-06-17 18:56:44,677] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=6, lr=[9.819740516446685e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:56:44,678] [INFO] [timer.py:258:stop] epoch=0/micro_step=1110/global_step=1110, RunningAvgSamplesPerSec=4.487029593936731, CurrSamplesPerSec=4.47959842467125, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:56:53,726] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=6, lr=[9.815758005298792e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:56:53,727] [INFO] [timer.py:258:stop] epoch=0/micro_step=1120/global_step=1120, RunningAvgSamplesPerSec=4.48698724520898, CurrSamplesPerSec=4.492125159914598, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:57:02,783] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=6, lr=[9.81173289936173e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:57:02,784] [INFO] [timer.py:258:stop] epoch=0/micro_step=1130/global_step=1130, RunningAvgSamplesPerSec=4.486958148171947, CurrSamplesPerSec=4.475056754362638, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:57:11,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=6, lr=[9.807665238361669e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:57:11,849] [INFO] [timer.py:258:stop] epoch=0/micro_step=1140/global_step=1140, RunningAvgSamplesPerSec=4.486907801775927, CurrSamplesPerSec=4.483847319708336, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:57:20,919] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=6, lr=[9.803555062444779e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:57:20,920] [INFO] [timer.py:258:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=4.486839784547814, CurrSamplesPerSec=4.4758793307583415, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:57:20,921] [INFO] [RANK 0]  iteration     1150/   10000 | elapsed time per iteration (ms): 906.1 | learning rate 9.803E-05 | total loss 2.840183E-01 | loss 2.840183E-01 | loss scale 32768.0 |speed 264.86 samples/(min*GPU)
[2024-06-17 18:57:20,922] [INFO] [RANK 0] time (ms) | forward: 355.35 | backward: 546.75 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 12.97 | data loader: 0.08
[2024-06-17 18:57:29,986] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=6, lr=[9.799402412176838e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:57:29,987] [INFO] [timer.py:258:stop] epoch=0/micro_step=1160/global_step=1160, RunningAvgSamplesPerSec=4.486781862576833, CurrSamplesPerSec=4.46463187951477, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:57:39,051] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=6, lr=[9.795207328542828e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:57:39,051] [INFO] [timer.py:258:stop] epoch=0/micro_step=1170/global_step=1170, RunningAvgSamplesPerSec=4.4867610960618105, CurrSamplesPerSec=4.484619186502639, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:57:48,132] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=6, lr=[9.790969852946531e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:57:48,133] [INFO] [timer.py:258:stop] epoch=0/micro_step=1180/global_step=1180, RunningAvgSamplesPerSec=4.486713762317567, CurrSamplesPerSec=4.485490852411418, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:57:57,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=6, lr=[9.78669002721012e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:57:57,215] [INFO] [timer.py:258:stop] epoch=0/micro_step=1190/global_step=1190, RunningAvgSamplesPerSec=4.486651536477173, CurrSamplesPerSec=4.476668763063008, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:58:06,285] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=6, lr=[9.782367893573747e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:58:06,286] [INFO] [timer.py:258:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=4.486625491472421, CurrSamplesPerSec=4.4836052671595175, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:58:06,286] [INFO] [RANK 0]  iteration     1200/   10000 | elapsed time per iteration (ms): 907.3 | learning rate 9.782E-05 | total loss 3.029912E-01 | loss 3.029912E-01 | loss scale 32768.0 |speed 264.52 samples/(min*GPU)
[2024-06-17 18:58:06,287] [INFO] [RANK 0] time (ms) | forward: 356.46 | backward: 546.79 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 14.28 | data loader: 0.09
[2024-06-17 18:58:06,288] [INFO] [RANK 0] Saving Model...
[2024-06-17 18:58:06,301] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/1200/mp_rank_00_model_states.pt
[2024-06-17 18:58:06,301] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/1200/mp_rank_00_model_states.pt...
[2024-06-17 18:58:26,568] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/1200/mp_rank_00_model_states.pt.
[2024-06-17 18:58:32,868] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 18:58:33,762] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 18:58:35,549] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=8, lr=[9.77887975362864e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:58:35,549] [INFO] [timer.py:258:stop] epoch=0/micro_step=1210/global_step=1210, RunningAvgSamplesPerSec=4.486912703232728, CurrSamplesPerSec=4.521602454467885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:58:44,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=8, lr=[9.77448157355011e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:58:44,552] [INFO] [timer.py:258:stop] epoch=0/micro_step=1220/global_step=1220, RunningAvgSamplesPerSec=4.487172549553153, CurrSamplesPerSec=4.517247683449402, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:58:53,584] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=8, lr=[9.770041206064124e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:58:53,584] [INFO] [timer.py:258:stop] epoch=0/micro_step=1230/global_step=1230, RunningAvgSamplesPerSec=4.4872788841507845, CurrSamplesPerSec=4.508574161959379, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:59:02,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=8, lr=[9.765558694995321e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:59:02,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=1240/global_step=1240, RunningAvgSamplesPerSec=4.487396627982973, CurrSamplesPerSec=4.506586806080658, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:59:11,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=1250, skipped=8, lr=[9.761034084584273e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:59:11,609] [INFO] [timer.py:258:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=4.48746841767718, CurrSamplesPerSec=4.486893182722007, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:59:11,609] [INFO] [RANK 0]  iteration     1250/   10000 | elapsed time per iteration (ms): 1306.5 | learning rate 9.761E-05 | total loss 3.308609E-01 | loss 3.308609E-01 | loss scale 32768.0 |speed 183.70 samples/(min*GPU)
[2024-06-17 18:59:11,610] [INFO] [RANK 0] time (ms) | forward: 352.96 | backward: 543.54 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 12.68 | data loader: 0.09
[2024-06-17 18:59:20,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=1260, skipped=8, lr=[9.75646741948706e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:59:20,643] [INFO] [timer.py:258:stop] epoch=0/micro_step=1260/global_step=1260, RunningAvgSamplesPerSec=4.487500526741963, CurrSamplesPerSec=4.494416408467193, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:59:29,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=1270, skipped=8, lr=[9.751858744774823e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:59:29,705] [INFO] [timer.py:258:stop] epoch=0/micro_step=1270/global_step=1270, RunningAvgSamplesPerSec=4.48751493545097, CurrSamplesPerSec=4.490727971974064, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:59:38,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=1280, skipped=8, lr=[9.747208105933319e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:59:38,768] [INFO] [timer.py:258:stop] epoch=0/micro_step=1280/global_step=1280, RunningAvgSamplesPerSec=4.487495597583204, CurrSamplesPerSec=4.4734948111647945, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:59:47,804] [INFO] [logging.py:96:log_dist] [Rank 0] step=1290, skipped=8, lr=[9.742515548862475e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:59:47,805] [INFO] [timer.py:258:stop] epoch=0/micro_step=1290/global_step=1290, RunningAvgSamplesPerSec=4.487482831841571, CurrSamplesPerSec=4.4729843435566075, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:59:56,855] [INFO] [logging.py:96:log_dist] [Rank 0] step=1300, skipped=8, lr=[9.73778111987594e-05], mom=[[0.9, 0.95]]
[2024-06-17 18:59:56,855] [INFO] [timer.py:258:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=4.4874538630834016, CurrSamplesPerSec=4.490916697873635, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 18:59:56,857] [INFO] [RANK 0]  iteration     1300/   10000 | elapsed time per iteration (ms): 905.0 | learning rate 9.737E-05 | total loss 2.883691E-01 | loss 2.883691E-01 | loss scale 32768.0 |speed 265.21 samples/(min*GPU)
[2024-06-17 18:59:56,858] [INFO] [RANK 0] time (ms) | forward: 354.56 | backward: 546.30 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.87 | data loader: 0.09
[2024-06-17 19:00:05,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=1310, skipped=8, lr=[9.733004865700612e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:00:05,902] [INFO] [timer.py:258:stop] epoch=0/micro_step=1310/global_step=1310, RunningAvgSamplesPerSec=4.48742748764238, CurrSamplesPerSec=4.488488514197535, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:00:14,959] [INFO] [logging.py:96:log_dist] [Rank 0] step=1320, skipped=8, lr=[9.728186833476192e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:00:14,960] [INFO] [timer.py:258:stop] epoch=0/micro_step=1320/global_step=1320, RunningAvgSamplesPerSec=4.487402732107972, CurrSamplesPerSec=4.474876520390206, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:00:24,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=1330, skipped=8, lr=[9.723327070754714e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:00:24,016] [INFO] [timer.py:258:stop] epoch=0/micro_step=1330/global_step=1330, RunningAvgSamplesPerSec=4.487384826231477, CurrSamplesPerSec=4.487742924680342, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:00:33,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=1340, skipped=8, lr=[9.718425625500074e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:00:33,083] [INFO] [timer.py:258:stop] epoch=0/micro_step=1340/global_step=1340, RunningAvgSamplesPerSec=4.487368670937955, CurrSamplesPerSec=4.476389265021939, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:00:42,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=1350, skipped=8, lr=[9.713482546087558e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:00:42,135] [INFO] [timer.py:258:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=4.487351373596779, CurrSamplesPerSec=4.500597809685402, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:00:42,137] [INFO] [RANK 0]  iteration     1350/   10000 | elapsed time per iteration (ms): 905.6 | learning rate 9.713E-05 | total loss 2.612106E-01 | loss 2.612106E-01 | loss scale 32768.0 |speed 265.01 samples/(min*GPU)
[2024-06-17 19:00:42,139] [INFO] [RANK 0] time (ms) | forward: 354.64 | backward: 546.76 | allreduce: 0.00 | optimizer: 3.41 | batch generator: 13.10 | data loader: 0.10
[2024-06-17 19:00:51,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=1360, skipped=8, lr=[9.708497881303363e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:00:51,181] [INFO] [timer.py:258:stop] epoch=0/micro_step=1360/global_step=1360, RunningAvgSamplesPerSec=4.487335294482605, CurrSamplesPerSec=4.48759527691827, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:01:00,233] [INFO] [logging.py:96:log_dist] [Rank 0] step=1370, skipped=8, lr=[9.703471680344118e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:01:00,233] [INFO] [timer.py:258:stop] epoch=0/micro_step=1370/global_step=1370, RunningAvgSamplesPerSec=4.487338862667061, CurrSamplesPerSec=4.483587294002701, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:01:09,264] [INFO] [logging.py:96:log_dist] [Rank 0] step=1380, skipped=8, lr=[9.6984039928164e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:01:09,265] [INFO] [timer.py:258:stop] epoch=0/micro_step=1380/global_step=1380, RunningAvgSamplesPerSec=4.487328839691098, CurrSamplesPerSec=4.469808467030226, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:01:18,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=1390, skipped=8, lr=[9.693294868736235e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:01:18,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=1390/global_step=1390, RunningAvgSamplesPerSec=4.487230838932447, CurrSamplesPerSec=4.475548592435815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:01:27,377] [INFO] [logging.py:96:log_dist] [Rank 0] step=1400, skipped=8, lr=[9.68814435852862e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:01:27,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=4.487231146566124, CurrSamplesPerSec=4.486981982500006, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:01:27,379] [INFO] [RANK 0]  iteration     1400/   10000 | elapsed time per iteration (ms): 904.8 | learning rate 9.688E-05 | total loss 2.810034E-01 | loss 2.810034E-01 | loss scale 32768.0 |speed 265.24 samples/(min*GPU)
[2024-06-17 19:01:27,379] [INFO] [RANK 0] time (ms) | forward: 353.97 | backward: 546.71 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 12.09 | data loader: 0.09
[2024-06-17 19:01:36,432] [INFO] [logging.py:96:log_dist] [Rank 0] step=1410, skipped=8, lr=[9.682952513027007e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:01:36,432] [INFO] [timer.py:258:stop] epoch=0/micro_step=1410/global_step=1410, RunningAvgSamplesPerSec=4.487209726121513, CurrSamplesPerSec=4.4872904090317025, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:01:45,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=1420, skipped=8, lr=[9.677719383472816e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:01:45,495] [INFO] [timer.py:258:stop] epoch=0/micro_step=1420/global_step=1420, RunningAvgSamplesPerSec=4.487191733589917, CurrSamplesPerSec=4.476809719758041, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:01:54,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=1430, skipped=8, lr=[9.672445021514925e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:01:54,565] [INFO] [timer.py:258:stop] epoch=0/micro_step=1430/global_step=1430, RunningAvgSamplesPerSec=4.487153552530761, CurrSamplesPerSec=4.484495717905676, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:02:03,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=1440, skipped=8, lr=[9.667129479209156e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:02:03,626] [INFO] [timer.py:258:stop] epoch=0/micro_step=1440/global_step=1440, RunningAvgSamplesPerSec=4.4871160550272, CurrSamplesPerSec=4.470655323494128, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:02:12,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=1450, skipped=8, lr=[9.661772809017767e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:02:12,682] [INFO] [timer.py:258:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=4.4870916263014715, CurrSamplesPerSec=4.491705431233777, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:02:12,683] [INFO] [RANK 0]  iteration     1450/   10000 | elapsed time per iteration (ms): 906.1 | learning rate 9.661E-05 | total loss 3.051547E-01 | loss 3.051547E-01 | loss scale 32768.0 |speed 264.88 samples/(min*GPU)
[2024-06-17 19:02:12,684] [INFO] [RANK 0] time (ms) | forward: 355.14 | backward: 546.85 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 13.30 | data loader: 0.09
[2024-06-17 19:02:21,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=1460, skipped=8, lr=[9.656375063808926e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:02:21,721] [INFO] [timer.py:258:stop] epoch=0/micro_step=1460/global_step=1460, RunningAvgSamplesPerSec=4.487050313940176, CurrSamplesPerSec=4.4689607409370655, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:02:30,775] [INFO] [logging.py:96:log_dist] [Rank 0] step=1470, skipped=8, lr=[9.6509362968562e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:02:30,776] [INFO] [timer.py:258:stop] epoch=0/micro_step=1470/global_step=1470, RunningAvgSamplesPerSec=4.487059037744121, CurrSamplesPerSec=4.491187192585046, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:02:39,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=1480, skipped=8, lr=[9.64545656183803e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:02:39,829] [INFO] [timer.py:258:stop] epoch=0/micro_step=1480/global_step=1480, RunningAvgSamplesPerSec=4.487039884654296, CurrSamplesPerSec=4.478432555439142, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:02:48,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=1490, skipped=8, lr=[9.639935912837179e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:02:48,861] [INFO] [timer.py:258:stop] epoch=0/micro_step=1490/global_step=1490, RunningAvgSamplesPerSec=4.487013034864717, CurrSamplesPerSec=4.487465642990956, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:02:57,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=1500, skipped=8, lr=[9.634374404340228e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:02:57,904] [INFO] [timer.py:258:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=4.486999768992869, CurrSamplesPerSec=4.488837981977991, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:02:57,906] [INFO] [RANK 0]  iteration     1500/   10000 | elapsed time per iteration (ms): 904.5 | learning rate 9.634E-05 | total loss 2.778818E-01 | loss 2.778818E-01 | loss scale 32768.0 |speed 265.35 samples/(min*GPU)
[2024-06-17 19:02:57,906] [INFO] [RANK 0] time (ms) | forward: 353.63 | backward: 546.78 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 11.94 | data loader: 0.09
[2024-06-17 19:02:57,907] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:02:57,920] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/1500/mp_rank_00_model_states.pt
[2024-06-17 19:02:57,920] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/1500/mp_rank_00_model_states.pt...
[2024-06-17 19:03:18,477] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/1500/mp_rank_00_model_states.pt.
[2024-06-17 19:03:27,486] [INFO] [logging.py:96:log_dist] [Rank 0] step=1510, skipped=8, lr=[9.628772091237021e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:03:27,487] [INFO] [timer.py:258:stop] epoch=0/micro_step=1510/global_step=1510, RunningAvgSamplesPerSec=4.487264887720773, CurrSamplesPerSec=4.524050748965201, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:03:36,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=1520, skipped=8, lr=[9.62312902882013e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:03:36,498] [INFO] [timer.py:258:stop] epoch=0/micro_step=1520/global_step=1520, RunningAvgSamplesPerSec=4.487449700205096, CurrSamplesPerSec=4.514741138350264, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:03:45,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=1530, skipped=8, lr=[9.617445272784296e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:03:45,515] [INFO] [timer.py:258:stop] epoch=0/micro_step=1530/global_step=1530, RunningAvgSamplesPerSec=4.487624322719579, CurrSamplesPerSec=4.502484425876889, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:03:54,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=1540, skipped=8, lr=[9.6117208792259e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:03:54,557] [INFO] [timer.py:258:stop] epoch=0/micro_step=1540/global_step=1540, RunningAvgSamplesPerSec=4.48771326307026, CurrSamplesPerSec=4.493514792893069, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:04:03,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=1550, skipped=8, lr=[9.605955904642394e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:04:03,592] [INFO] [timer.py:258:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=4.487756658298861, CurrSamplesPerSec=4.489215131968168, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:04:03,593] [INFO] [RANK 0]  iteration     1550/   10000 | elapsed time per iteration (ms): 1313.8 | learning rate 9.605E-05 | total loss 3.644745E-01 | loss 3.644745E-01 | loss scale 32768.0 |speed 182.68 samples/(min*GPU)
[2024-06-17 19:04:03,594] [INFO] [RANK 0] time (ms) | forward: 354.26 | backward: 543.67 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 14.67 | data loader: 0.19
[2024-06-17 19:04:12,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=1560, skipped=8, lr=[9.600150405931751e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:04:12,633] [INFO] [timer.py:258:stop] epoch=0/micro_step=1560/global_step=1560, RunningAvgSamplesPerSec=4.487739237875258, CurrSamplesPerSec=4.464504756896915, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:04:21,680] [INFO] [logging.py:96:log_dist] [Rank 0] step=1570, skipped=8, lr=[9.594304440391899e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:04:21,681] [INFO] [timer.py:258:stop] epoch=0/micro_step=1570/global_step=1570, RunningAvgSamplesPerSec=4.487730676216047, CurrSamplesPerSec=4.468051459827869, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:04:30,735] [INFO] [logging.py:96:log_dist] [Rank 0] step=1580, skipped=8, lr=[9.588418065720158e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:04:30,736] [INFO] [timer.py:258:stop] epoch=0/micro_step=1580/global_step=1580, RunningAvgSamplesPerSec=4.487715245024659, CurrSamplesPerSec=4.486786387644581, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:04:39,801] [INFO] [logging.py:96:log_dist] [Rank 0] step=1590, skipped=8, lr=[9.58249134001267e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:04:39,802] [INFO] [timer.py:258:stop] epoch=0/micro_step=1590/global_step=1590, RunningAvgSamplesPerSec=4.487691913881941, CurrSamplesPerSec=4.473778719732318, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:04:48,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=1600, skipped=8, lr=[9.576524321763824e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:04:48,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=4.487649885942374, CurrSamplesPerSec=4.476587537812496, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:04:48,880] [INFO] [RANK 0]  iteration     1600/   10000 | elapsed time per iteration (ms): 905.7 | learning rate 9.576E-05 | total loss 2.566612E-01 | loss 2.566612E-01 | loss scale 32768.0 |speed 264.98 samples/(min*GPU)
[2024-06-17 19:04:48,881] [INFO] [RANK 0] time (ms) | forward: 355.06 | backward: 546.57 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 13.19 | data loader: 0.15
[2024-06-17 19:04:57,030] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 19:04:57,934] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 19:04:57,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=1610, skipped=10, lr=[9.571119603883084e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:04:57,936] [INFO] [timer.py:258:stop] epoch=0/micro_step=1610/global_step=1610, RunningAvgSamplesPerSec=4.4876140167705865, CurrSamplesPerSec=4.474892036651126, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:05:06,993] [INFO] [logging.py:96:log_dist] [Rank 0] step=1620, skipped=10, lr=[9.565682339948657e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:05:06,994] [INFO] [timer.py:258:stop] epoch=0/micro_step=1620/global_step=1620, RunningAvgSamplesPerSec=4.487550915639755, CurrSamplesPerSec=4.473775140828639, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:05:16,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=1630, skipped=10, lr=[9.559602817156913e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:05:16,051] [INFO] [timer.py:258:stop] epoch=0/micro_step=1630/global_step=1630, RunningAvgSamplesPerSec=4.487506642346463, CurrSamplesPerSec=4.476815692695389, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:05:25,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=1640, skipped=10, lr=[9.553483227724292e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:05:25,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=1640/global_step=1640, RunningAvgSamplesPerSec=4.487471668577842, CurrSamplesPerSec=4.486098941046141, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:05:34,196] [INFO] [logging.py:96:log_dist] [Rank 0] step=1650, skipped=10, lr=[9.547323632048671e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:05:34,196] [INFO] [timer.py:258:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=4.4874239365803605, CurrSamplesPerSec=4.4831907230117505, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:05:34,197] [INFO] [RANK 0]  iteration     1650/   10000 | elapsed time per iteration (ms): 906.3 | learning rate 9.547E-05 | total loss 2.698492E-01 | loss 2.698492E-01 | loss scale 32768.0 |speed 264.80 samples/(min*GPU)
[2024-06-17 19:05:34,197] [INFO] [RANK 0] time (ms) | forward: 355.41 | backward: 546.85 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 12.98 | data loader: 0.20
[2024-06-17 19:05:43,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=1660, skipped=10, lr=[9.54112409092277e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:05:43,277] [INFO] [timer.py:258:stop] epoch=0/micro_step=1660/global_step=1660, RunningAvgSamplesPerSec=4.4873881329168395, CurrSamplesPerSec=4.489823029335078, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:05:52,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=1670, skipped=10, lr=[9.534884665533563e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:05:52,340] [INFO] [timer.py:258:stop] epoch=0/micro_step=1670/global_step=1670, RunningAvgSamplesPerSec=4.487331684863502, CurrSamplesPerSec=4.472726768619815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:06:01,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=1680, skipped=10, lr=[9.528605417461653e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:06:01,413] [INFO] [timer.py:258:stop] epoch=0/micro_step=1680/global_step=1680, RunningAvgSamplesPerSec=4.487262601086655, CurrSamplesPerSec=4.474432562205733, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:06:10,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=1690, skipped=10, lr=[9.522286408680687e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:06:10,490] [INFO] [timer.py:258:stop] epoch=0/micro_step=1690/global_step=1690, RunningAvgSamplesPerSec=4.487226491519971, CurrSamplesPerSec=4.488262770129641, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:06:19,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=1700, skipped=10, lr=[9.515927701556732e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:06:19,535] [INFO] [timer.py:258:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=4.487183197828779, CurrSamplesPerSec=4.474616340660689, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:06:19,537] [INFO] [RANK 0]  iteration     1700/   10000 | elapsed time per iteration (ms): 906.8 | learning rate 9.515E-05 | total loss 3.323051E-01 | loss 3.323051E-01 | loss scale 32768.0 |speed 264.67 samples/(min*GPU)
[2024-06-17 19:06:19,538] [INFO] [RANK 0] time (ms) | forward: 355.56 | backward: 547.15 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 13.22 | data loader: 0.21
[2024-06-17 19:06:28,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=1710, skipped=10, lr=[9.509529358847655e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:06:28,590] [INFO] [timer.py:258:stop] epoch=0/micro_step=1710/global_step=1710, RunningAvgSamplesPerSec=4.48716950973869, CurrSamplesPerSec=4.481496202650665, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:06:37,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=1720, skipped=10, lr=[9.503091443702522e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:06:37,673] [INFO] [timer.py:258:stop] epoch=0/micro_step=1720/global_step=1720, RunningAvgSamplesPerSec=4.487127109377122, CurrSamplesPerSec=4.475918736055453, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:06:46,750] [INFO] [logging.py:96:log_dist] [Rank 0] step=1730, skipped=10, lr=[9.496614019660951e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:06:46,751] [INFO] [timer.py:258:stop] epoch=0/micro_step=1730/global_step=1730, RunningAvgSamplesPerSec=4.487074951311478, CurrSamplesPerSec=4.473820474031669, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:06:55,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=1740, skipped=10, lr=[9.490097150652505e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:06:55,824] [INFO] [timer.py:258:stop] epoch=0/micro_step=1740/global_step=1740, RunningAvgSamplesPerSec=4.487025627637756, CurrSamplesPerSec=4.467532716526889, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:07:04,889] [INFO] [logging.py:96:log_dist] [Rank 0] step=1750, skipped=10, lr=[9.48354090099605e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:07:04,890] [INFO] [timer.py:258:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=4.4869789879422175, CurrSamplesPerSec=4.483372825450543, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:07:04,893] [INFO] [RANK 0]  iteration     1750/   10000 | elapsed time per iteration (ms): 907.1 | learning rate 9.483E-05 | total loss 3.796930E-01 | loss 3.796930E-01 | loss scale 32768.0 |speed 264.57 samples/(min*GPU)
[2024-06-17 19:07:04,895] [INFO] [RANK 0] time (ms) | forward: 355.99 | backward: 547.00 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 13.68 | data loader: 0.20
[2024-06-17 19:07:13,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=1760, skipped=10, lr=[9.476945335399122e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:07:13,967] [INFO] [timer.py:258:stop] epoch=0/micro_step=1760/global_step=1760, RunningAvgSamplesPerSec=4.486921453259716, CurrSamplesPerSec=4.486132528654646, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:07:23,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=1770, skipped=10, lr=[9.470310518957292e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:07:23,037] [INFO] [timer.py:258:stop] epoch=0/micro_step=1770/global_step=1770, RunningAvgSamplesPerSec=4.486848214718061, CurrSamplesPerSec=4.4683096866017955, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:07:32,116] [INFO] [logging.py:96:log_dist] [Rank 0] step=1780, skipped=10, lr=[9.463636517153516e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:07:32,116] [INFO] [timer.py:258:stop] epoch=0/micro_step=1780/global_step=1780, RunningAvgSamplesPerSec=4.486797062064476, CurrSamplesPerSec=4.485525630156504, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:07:41,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=1790, skipped=10, lr=[9.456923395857504e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:07:41,193] [INFO] [timer.py:258:stop] epoch=0/micro_step=1790/global_step=1790, RunningAvgSamplesPerSec=4.486740006802186, CurrSamplesPerSec=4.4696703324222895, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:07:50,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=1800, skipped=10, lr=[9.450171221325049e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:07:50,280] [INFO] [timer.py:258:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=4.486706192903677, CurrSamplesPerSec=4.482236125337493, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:07:50,281] [INFO] [RANK 0]  iteration     1800/   10000 | elapsed time per iteration (ms): 907.8 | learning rate 9.449E-05 | total loss 2.681265E-01 | loss 2.681265E-01 | loss scale 32768.0 |speed 264.38 samples/(min*GPU)
[2024-06-17 19:07:50,282] [INFO] [RANK 0] time (ms) | forward: 356.66 | backward: 546.91 | allreduce: 0.00 | optimizer: 3.38 | batch generator: 13.68 | data loader: 0.15
[2024-06-17 19:07:50,282] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:07:50,295] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/1800/mp_rank_00_model_states.pt
[2024-06-17 19:07:50,295] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/1800/mp_rank_00_model_states.pt...
[2024-06-17 19:08:11,157] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/1800/mp_rank_00_model_states.pt.
[2024-06-17 19:08:20,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=1810, skipped=10, lr=[9.443380060197387e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:08:20,180] [INFO] [timer.py:258:stop] epoch=0/micro_step=1810/global_step=1810, RunningAvgSamplesPerSec=4.486905171867323, CurrSamplesPerSec=4.510951358336253, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:08:29,163] [INFO] [logging.py:96:log_dist] [Rank 0] step=1820, skipped=10, lr=[9.436549979500537e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:08:29,163] [INFO] [timer.py:258:stop] epoch=0/micro_step=1820/global_step=1820, RunningAvgSamplesPerSec=4.487051236911543, CurrSamplesPerSec=4.513808276598692, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:08:38,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=1830, skipped=10, lr=[9.429681046644642e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:08:38,181] [INFO] [timer.py:258:stop] epoch=0/micro_step=1830/global_step=1830, RunningAvgSamplesPerSec=4.4871603128018736, CurrSamplesPerSec=4.5090939974214885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:08:47,191] [INFO] [logging.py:96:log_dist] [Rank 0] step=1840, skipped=10, lr=[9.42277332942329e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:08:47,191] [INFO] [timer.py:258:stop] epoch=0/micro_step=1840/global_step=1840, RunningAvgSamplesPerSec=4.487234166865463, CurrSamplesPerSec=4.486167316350809, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:08:56,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=1850, skipped=10, lr=[9.415826896012865e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:08:56,232] [INFO] [timer.py:258:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=4.487248997810613, CurrSamplesPerSec=4.486963982260981, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:08:56,234] [INFO] [RANK 0]  iteration     1850/   10000 | elapsed time per iteration (ms): 1319.0 | learning rate 9.415E-05 | total loss 3.302563E-01 | loss 3.302563E-01 | loss scale 32768.0 |speed 181.95 samples/(min*GPU)
[2024-06-17 19:08:56,235] [INFO] [RANK 0] time (ms) | forward: 352.59 | backward: 543.99 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 12.57 | data loader: 0.09
[2024-06-17 19:09:05,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=1860, skipped=10, lr=[9.408841814971862e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:09:05,287] [INFO] [timer.py:258:stop] epoch=0/micro_step=1860/global_step=1860, RunningAvgSamplesPerSec=4.487252404548754, CurrSamplesPerSec=4.489373698019451, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:09:14,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=1870, skipped=10, lr=[9.401818155240207e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:09:14,345] [INFO] [timer.py:258:stop] epoch=0/micro_step=1870/global_step=1870, RunningAvgSamplesPerSec=4.48723993626404, CurrSamplesPerSec=4.47187435946029, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:09:23,400] [INFO] [logging.py:96:log_dist] [Rank 0] step=1880, skipped=10, lr=[9.394755986138586e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:09:23,401] [INFO] [timer.py:258:stop] epoch=0/micro_step=1880/global_step=1880, RunningAvgSamplesPerSec=4.487213345394236, CurrSamplesPerSec=4.482383420658133, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:09:32,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=1890, skipped=10, lr=[9.38765537736776e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:09:32,462] [INFO] [timer.py:258:stop] epoch=0/micro_step=1890/global_step=1890, RunningAvgSamplesPerSec=4.48718031185608, CurrSamplesPerSec=4.481132317370234, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:09:41,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=1900, skipped=10, lr=[9.380516399007869e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:09:41,535] [INFO] [timer.py:258:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=4.487121562279455, CurrSamplesPerSec=4.474123514300503, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:09:41,536] [INFO] [RANK 0]  iteration     1900/   10000 | elapsed time per iteration (ms): 906.1 | learning rate 9.380E-05 | total loss 2.446523E-01 | loss 2.446523E-01 | loss scale 32768.0 |speed 264.88 samples/(min*GPU)
[2024-06-17 19:09:41,537] [INFO] [RANK 0] time (ms) | forward: 355.13 | backward: 546.73 | allreduce: 0.00 | optimizer: 3.39 | batch generator: 13.09 | data loader: 0.09
[2024-06-17 19:09:50,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=1910, skipped=10, lr=[9.373339121517747e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:09:50,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=1910/global_step=1910, RunningAvgSamplesPerSec=4.487097872402549, CurrSamplesPerSec=4.482432521249668, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:09:59,651] [INFO] [logging.py:96:log_dist] [Rank 0] step=1920, skipped=10, lr=[9.366123615734227e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:09:59,652] [INFO] [timer.py:258:stop] epoch=0/micro_step=1920/global_step=1920, RunningAvgSamplesPerSec=4.487074001827984, CurrSamplesPerSec=4.4707839879935, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:10:08,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=1930, skipped=10, lr=[9.358869952871436e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:10:08,719] [INFO] [timer.py:258:stop] epoch=0/micro_step=1930/global_step=1930, RunningAvgSamplesPerSec=4.4870146546721195, CurrSamplesPerSec=4.457384398956937, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:10:17,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=1940, skipped=10, lr=[9.351578204520099e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:10:17,777] [INFO] [timer.py:258:stop] epoch=0/micro_step=1940/global_step=1940, RunningAvgSamplesPerSec=4.486966060918979, CurrSamplesPerSec=4.4695250621321785, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:10:26,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=1950, skipped=10, lr=[9.344248442646829e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:10:26,825] [INFO] [timer.py:258:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=4.486941836374497, CurrSamplesPerSec=4.486474431142048, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:10:26,826] [INFO] [RANK 0]  iteration     1950/   10000 | elapsed time per iteration (ms): 905.8 | learning rate 9.344E-05 | total loss 2.732633E-01 | loss 2.732633E-01 | loss scale 32768.0 |speed 264.96 samples/(min*GPU)
[2024-06-17 19:10:26,827] [INFO] [RANK 0] time (ms) | forward: 354.63 | backward: 547.00 | allreduce: 0.00 | optimizer: 3.38 | batch generator: 12.43 | data loader: 0.10
[2024-06-17 19:10:35,866] [INFO] [logging.py:96:log_dist] [Rank 0] step=1960, skipped=10, lr=[9.336880739593416e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:10:35,866] [INFO] [timer.py:258:stop] epoch=0/micro_step=1960/global_step=1960, RunningAvgSamplesPerSec=4.486931001196737, CurrSamplesPerSec=4.487356420217852, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:10:44,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=1970, skipped=10, lr=[9.329475168076114e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:10:44,947] [INFO] [timer.py:258:stop] epoch=0/micro_step=1970/global_step=1970, RunningAvgSamplesPerSec=4.486888666973553, CurrSamplesPerSec=4.475870972148153, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:10:54,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=1980, skipped=10, lr=[9.322031801184924e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:10:54,018] [INFO] [timer.py:258:stop] epoch=0/micro_step=1980/global_step=1980, RunningAvgSamplesPerSec=4.4868456180579965, CurrSamplesPerSec=4.481284328047051, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:11:03,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=1990, skipped=10, lr=[9.314550712382876e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:11:03,084] [INFO] [timer.py:258:stop] epoch=0/micro_step=1990/global_step=1990, RunningAvgSamplesPerSec=4.486778086026919, CurrSamplesPerSec=4.469757260964179, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:11:12,147] [INFO] [logging.py:96:log_dist] [Rank 0] step=2000, skipped=10, lr=[9.30703197550529e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:11:12,147] [INFO] [timer.py:258:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=4.486725187351734, CurrSamplesPerSec=4.479163095823542, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:11:12,149] [INFO] [RANK 0]  iteration     2000/   10000 | elapsed time per iteration (ms): 906.5 | learning rate 9.306E-05 | total loss 2.487332E-01 | loss 2.487332E-01 | loss scale 32768.0 |speed 264.77 samples/(min*GPU)
[2024-06-17 19:11:12,150] [INFO] [RANK 0] time (ms) | forward: 355.09 | backward: 547.18 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 12.67 | data loader: 0.13
[2024-06-17 19:11:18,796] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 19:11:18,796] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 19:11:18,796] [INFO] [RANK 0]  validation loss at iteration 2000 | loss: 9.411621E-01 | PPL: 2.562958E+00 loss 9.404297E-01 |
[2024-06-17 19:11:18,796] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 19:11:27,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=2010, skipped=10, lr=[9.299475664759069e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:11:27,856] [INFO] [timer.py:258:stop] epoch=0/micro_step=2010/global_step=2010, RunningAvgSamplesPerSec=4.486689625578575, CurrSamplesPerSec=4.48933525673599, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:11:28,763] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 19:11:29,672] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 19:11:36,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=2020, skipped=12, lr=[9.29340361308047e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:11:36,944] [INFO] [timer.py:258:stop] epoch=0/micro_step=2020/global_step=2020, RunningAvgSamplesPerSec=4.486610694813391, CurrSamplesPerSec=4.4334779429582545, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:11:46,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=2030, skipped=12, lr=[9.285779857555331e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:11:46,025] [INFO] [timer.py:258:stop] epoch=0/micro_step=2030/global_step=2030, RunningAvgSamplesPerSec=4.486535036455554, CurrSamplesPerSec=4.471713451536227, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:11:55,081] [INFO] [logging.py:96:log_dist] [Rank 0] step=2040, skipped=12, lr=[9.278118737911378e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:11:55,081] [INFO] [timer.py:258:stop] epoch=0/micro_step=2040/global_step=2040, RunningAvgSamplesPerSec=4.486522542899237, CurrSamplesPerSec=4.48341715525673, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:12:04,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=2050, skipped=12, lr=[9.270420329760772e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:12:04,135] [INFO] [timer.py:258:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=4.486491512403133, CurrSamplesPerSec=4.474728524540144, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:12:04,137] [INFO] [RANK 0]  iteration     2050/   10000 | elapsed time per iteration (ms): 1039.8 | learning rate 9.270E-05 | total loss 3.627121E-01 | loss 3.627121E-01 | loss scale 32768.0 |speed 230.82 samples/(min*GPU)
[2024-06-17 19:12:04,138] [INFO] [RANK 0] time (ms) | forward: 355.62 | backward: 547.02 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 15.76 | data loader: 0.14
[2024-06-17 19:12:13,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=2060, skipped=12, lr=[9.26268470908369e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:12:13,219] [INFO] [timer.py:258:stop] epoch=0/micro_step=2060/global_step=2060, RunningAvgSamplesPerSec=4.48642720302493, CurrSamplesPerSec=4.471189091259907, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:12:22,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=2070, skipped=12, lr=[9.254911952227588e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:12:22,289] [INFO] [timer.py:258:stop] epoch=0/micro_step=2070/global_step=2070, RunningAvgSamplesPerSec=4.486375686059624, CurrSamplesPerSec=4.47911167520144, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:12:31,343] [INFO] [logging.py:96:log_dist] [Rank 0] step=2080, skipped=12, lr=[9.247102135906435e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:12:31,344] [INFO] [timer.py:258:stop] epoch=0/micro_step=2080/global_step=2080, RunningAvgSamplesPerSec=4.486361803031317, CurrSamplesPerSec=4.479234847501865, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:12:40,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=2090, skipped=12, lr=[9.239255337199968e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:12:40,401] [INFO] [timer.py:258:stop] epoch=0/micro_step=2090/global_step=2090, RunningAvgSamplesPerSec=4.486331905685252, CurrSamplesPerSec=4.483975546251143, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:12:49,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=2100, skipped=12, lr=[9.23137163355292e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:12:49,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=4.486301243897271, CurrSamplesPerSec=4.473547295747879, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:12:49,465] [INFO] [RANK 0]  iteration     2100/   10000 | elapsed time per iteration (ms): 906.6 | learning rate 9.231E-05 | total loss 2.628229E-01 | loss 2.628229E-01 | loss scale 32768.0 |speed 264.73 samples/(min*GPU)
[2024-06-17 19:12:49,466] [INFO] [RANK 0] time (ms) | forward: 355.29 | backward: 547.02 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 12.71 | data loader: 0.09
[2024-06-17 19:12:49,467] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:12:49,479] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/2100/mp_rank_00_model_states.pt
[2024-06-17 19:12:49,480] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/2100/mp_rank_00_model_states.pt...
[2024-06-17 19:13:10,828] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/2100/mp_rank_00_model_states.pt.
[2024-06-17 19:13:19,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=2110, skipped=12, lr=[9.223451102774268e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:13:19,845] [INFO] [timer.py:258:stop] epoch=0/micro_step=2110/global_step=2110, RunningAvgSamplesPerSec=4.486456644986394, CurrSamplesPerSec=4.509118235099501, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:13:28,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=2120, skipped=12, lr=[9.215493823036445e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:13:28,861] [INFO] [timer.py:258:stop] epoch=0/micro_step=2120/global_step=2120, RunningAvgSamplesPerSec=4.486570793244669, CurrSamplesPerSec=4.501701566009572, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:13:37,876] [INFO] [logging.py:96:log_dist] [Rank 0] step=2130, skipped=12, lr=[9.207499872874597e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:13:37,876] [INFO] [timer.py:258:stop] epoch=0/micro_step=2130/global_step=2130, RunningAvgSamplesPerSec=4.4866840841581945, CurrSamplesPerSec=4.5124849547668004, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:13:46,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=2140, skipped=12, lr=[9.199469331185782e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:13:46,905] [INFO] [timer.py:258:stop] epoch=0/micro_step=2140/global_step=2140, RunningAvgSamplesPerSec=4.48675682769782, CurrSamplesPerSec=4.505650050555982, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:13:55,973] [INFO] [logging.py:96:log_dist] [Rank 0] step=2150, skipped=12, lr=[9.191402277228204e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:13:55,974] [INFO] [timer.py:258:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=4.486749131898798, CurrSamplesPerSec=4.469467909196671, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:13:55,975] [INFO] [RANK 0]  iteration     2150/   10000 | elapsed time per iteration (ms): 1330.2 | learning rate 9.191E-05 | total loss 2.969275E-01 | loss 2.969275E-01 | loss scale 32768.0 |speed 180.43 samples/(min*GPU)
[2024-06-17 19:13:55,976] [INFO] [RANK 0] time (ms) | forward: 354.24 | backward: 543.72 | allreduce: 0.00 | optimizer: 3.38 | batch generator: 13.80 | data loader: 0.11
[2024-06-17 19:14:05,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=2160, skipped=12, lr=[9.183298790620427e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:14:05,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=2160/global_step=2160, RunningAvgSamplesPerSec=4.486743950048403, CurrSamplesPerSec=4.490522435059296, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:14:14,095] [INFO] [logging.py:96:log_dist] [Rank 0] step=2170, skipped=12, lr=[9.175158951340598e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:14:14,095] [INFO] [timer.py:258:stop] epoch=0/micro_step=2170/global_step=2170, RunningAvgSamplesPerSec=4.486737902258653, CurrSamplesPerSec=4.491603216928497, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:14:23,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=2180, skipped=12, lr=[9.166982839725638e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:14:23,156] [INFO] [timer.py:258:stop] epoch=0/micro_step=2180/global_step=2180, RunningAvgSamplesPerSec=4.486735266731404, CurrSamplesPerSec=4.490633013985103, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:14:32,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=12, lr=[9.158770536470473e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:14:32,221] [INFO] [timer.py:258:stop] epoch=0/micro_step=2190/global_step=2190, RunningAvgSamplesPerSec=4.486712172304666, CurrSamplesPerSec=4.464649701021079, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:14:41,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=12, lr=[9.150522122627216e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:14:41,296] [INFO] [timer.py:258:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=4.486663217833676, CurrSamplesPerSec=4.471456022942003, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:14:41,298] [INFO] [RANK 0]  iteration     2200/   10000 | elapsed time per iteration (ms): 906.5 | learning rate 9.150E-05 | total loss 2.485387E-01 | loss 2.485387E-01 | loss scale 32768.0 |speed 264.77 samples/(min*GPU)
[2024-06-17 19:14:41,299] [INFO] [RANK 0] time (ms) | forward: 355.47 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 13.59 | data loader: 0.10
[2024-06-17 19:14:50,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=12, lr=[9.142237679604388e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:14:50,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=2210/global_step=2210, RunningAvgSamplesPerSec=4.486636731358243, CurrSamplesPerSec=4.467428030653027, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:14:59,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=12, lr=[9.13391728916609e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:14:59,416] [INFO] [timer.py:258:stop] epoch=0/micro_step=2220/global_step=2220, RunningAvgSamplesPerSec=4.4866256262830975, CurrSamplesPerSec=4.468413223690781, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:15:08,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=12, lr=[9.12556103343122e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:15:08,460] [INFO] [timer.py:258:stop] epoch=0/micro_step=2230/global_step=2230, RunningAvgSamplesPerSec=4.486622094013749, CurrSamplesPerSec=4.486350860369776, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:15:17,529] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=12, lr=[9.117168994872649e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:15:17,530] [INFO] [timer.py:258:stop] epoch=0/micro_step=2240/global_step=2240, RunningAvgSamplesPerSec=4.486615208821892, CurrSamplesPerSec=4.471282037068229, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:15:26,583] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=12, lr=[9.108741256316407e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:15:26,584] [INFO] [timer.py:258:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=4.486598562729049, CurrSamplesPerSec=4.472165215015427, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:15:26,585] [INFO] [RANK 0]  iteration     2250/   10000 | elapsed time per iteration (ms): 905.7 | learning rate 9.108E-05 | total loss 3.523522E-01 | loss 3.523522E-01 | loss scale 32768.0 |speed 264.98 samples/(min*GPU)
[2024-06-17 19:15:26,585] [INFO] [RANK 0] time (ms) | forward: 354.77 | backward: 546.86 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 13.09 | data loader: 0.09
[2024-06-17 19:15:35,655] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=12, lr=[9.100277900940877e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:15:35,656] [INFO] [timer.py:258:stop] epoch=0/micro_step=2260/global_step=2260, RunningAvgSamplesPerSec=4.486561477882314, CurrSamplesPerSec=4.470957935108653, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:15:44,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=12, lr=[9.091779012275951e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:15:44,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=2270/global_step=2270, RunningAvgSamplesPerSec=4.486558916136093, CurrSamplesPerSec=4.4855484158681085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:15:53,734] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=12, lr=[9.083244674202236e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:15:53,735] [INFO] [timer.py:258:stop] epoch=0/micro_step=2280/global_step=2280, RunningAvgSamplesPerSec=4.4865461228371375, CurrSamplesPerSec=4.484136139368054, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:16:02,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=12, lr=[9.074674970950201e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:16:02,772] [INFO] [timer.py:258:stop] epoch=0/micro_step=2290/global_step=2290, RunningAvgSamplesPerSec=4.486546457106965, CurrSamplesPerSec=4.493026217864377, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:16:11,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=2300, skipped=12, lr=[9.066069987099359e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:16:11,826] [INFO] [timer.py:258:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=4.486531253929788, CurrSamplesPerSec=4.47509733884909, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:16:11,828] [INFO] [RANK 0]  iteration     2300/   10000 | elapsed time per iteration (ms): 904.9 | learning rate 9.065E-05 | total loss 3.149217E-01 | loss 3.149217E-01 | loss scale 32768.0 |speed 265.23 samples/(min*GPU)
[2024-06-17 19:16:11,828] [INFO] [RANK 0] time (ms) | forward: 353.91 | backward: 546.84 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.17 | data loader: 0.09
[2024-06-17 19:16:20,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=2310, skipped=12, lr=[9.057429807577423e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:16:20,902] [INFO] [timer.py:258:stop] epoch=0/micro_step=2310/global_step=2310, RunningAvgSamplesPerSec=4.48652796669383, CurrSamplesPerSec=4.484255992473325, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:16:29,964] [INFO] [logging.py:96:log_dist] [Rank 0] step=2320, skipped=12, lr=[9.048754517659479e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:16:29,964] [INFO] [timer.py:258:stop] epoch=0/micro_step=2320/global_step=2320, RunningAvgSamplesPerSec=4.48651832955926, CurrSamplesPerSec=4.490589743322084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:16:39,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=2330, skipped=12, lr=[9.040044202967136e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:16:39,017] [INFO] [timer.py:258:stop] epoch=0/micro_step=2330/global_step=2330, RunningAvgSamplesPerSec=4.4864979552154125, CurrSamplesPerSec=4.4663790636351655, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:16:48,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=2340, skipped=12, lr=[9.031298949467681e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:16:48,063] [INFO] [timer.py:258:stop] epoch=0/micro_step=2340/global_step=2340, RunningAvgSamplesPerSec=4.486474483483549, CurrSamplesPerSec=4.482444497166881, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:16:57,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=2350, skipped=12, lr=[9.022518843473241e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:16:57,124] [INFO] [timer.py:258:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=4.486468988333773, CurrSamplesPerSec=4.476040538633333, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:16:57,125] [INFO] [RANK 0]  iteration     2350/   10000 | elapsed time per iteration (ms): 905.9 | learning rate 9.022E-05 | total loss 2.420053E-01 | loss 2.420053E-01 | loss scale 32768.0 |speed 264.92 samples/(min*GPU)
[2024-06-17 19:16:57,126] [INFO] [RANK 0] time (ms) | forward: 355.13 | backward: 546.68 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 13.26 | data loader: 0.09
[2024-06-17 19:17:06,189] [INFO] [logging.py:96:log_dist] [Rank 0] step=2360, skipped=12, lr=[9.013703971639914e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:17:06,190] [INFO] [timer.py:258:stop] epoch=0/micro_step=2360/global_step=2360, RunningAvgSamplesPerSec=4.4864532249868745, CurrSamplesPerSec=4.4845772303915545, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:17:15,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=2370, skipped=12, lr=[9.004854420966926e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:17:15,249] [INFO] [timer.py:258:stop] epoch=0/micro_step=2370/global_step=2370, RunningAvgSamplesPerSec=4.486431173200481, CurrSamplesPerSec=4.492552185046745, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:17:24,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=2380, skipped=12, lr=[8.995970278795771e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:17:24,312] [INFO] [timer.py:258:stop] epoch=0/micro_step=2380/global_step=2380, RunningAvgSamplesPerSec=4.486388961481286, CurrSamplesPerSec=4.451799417136753, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:17:33,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=2390, skipped=12, lr=[8.987051632809343e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:17:33,351] [INFO] [timer.py:258:stop] epoch=0/micro_step=2390/global_step=2390, RunningAvgSamplesPerSec=4.486399494787596, CurrSamplesPerSec=4.4833081294688535, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:17:42,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=2400, skipped=12, lr=[8.97809857103108e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:17:42,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=4.4863933274555565, CurrSamplesPerSec=4.470101435918669, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:17:42,398] [INFO] [RANK 0]  iteration     2400/   10000 | elapsed time per iteration (ms): 905.5 | learning rate 8.977E-05 | total loss 3.302191E-01 | loss 3.302191E-01 | loss scale 32768.0 |speed 265.06 samples/(min*GPU)
[2024-06-17 19:17:42,398] [INFO] [RANK 0] time (ms) | forward: 354.58 | backward: 546.72 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 12.60 | data loader: 0.09
[2024-06-17 19:17:42,399] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:17:42,411] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/2400/mp_rank_00_model_states.pt
[2024-06-17 19:17:42,411] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/2400/mp_rank_00_model_states.pt...
[2024-06-17 19:18:03,212] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/2400/mp_rank_00_model_states.pt.
[2024-06-17 19:18:12,204] [INFO] [logging.py:96:log_dist] [Rank 0] step=2410, skipped=12, lr=[8.969111181824083e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:18:12,204] [INFO] [timer.py:258:stop] epoch=0/micro_step=2410/global_step=2410, RunningAvgSamplesPerSec=4.48654529618999, CurrSamplesPerSec=4.519776495255737, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:18:14,902] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 19:18:15,799] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 19:18:21,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=2420, skipped=14, lr=[8.96189661430612e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:18:21,194] [INFO] [timer.py:258:stop] epoch=0/micro_step=2420/global_step=2420, RunningAvgSamplesPerSec=4.486696214122144, CurrSamplesPerSec=4.524547315120132, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:18:30,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=2430, skipped=14, lr=[8.952847659483319e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:18:30,212] [INFO] [timer.py:258:stop] epoch=0/micro_step=2430/global_step=2430, RunningAvgSamplesPerSec=4.486813578660044, CurrSamplesPerSec=4.512168201094288, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:18:39,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=2440, skipped=14, lr=[8.94376462644809e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:18:39,226] [INFO] [timer.py:258:stop] epoch=0/micro_step=2440/global_step=2440, RunningAvgSamplesPerSec=4.486889638915367, CurrSamplesPerSec=4.493201900098851, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:18:48,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=2450, skipped=14, lr=[8.934647604846301e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:18:48,288] [INFO] [timer.py:258:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=4.486907476566566, CurrSamplesPerSec=4.494535607692129, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:18:48,288] [INFO] [RANK 0]  iteration     2450/   10000 | elapsed time per iteration (ms): 1317.8 | learning rate 8.934E-05 | total loss 3.205986E-01 | loss 3.205986E-01 | loss scale 32768.0 |speed 182.12 samples/(min*GPU)
[2024-06-17 19:18:48,292] [INFO] [RANK 0] time (ms) | forward: 353.86 | backward: 543.35 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 14.05 | data loader: 0.09
[2024-06-17 19:18:57,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=2460, skipped=14, lr=[8.925496684659279e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:18:57,350] [INFO] [timer.py:258:stop] epoch=0/micro_step=2460/global_step=2460, RunningAvgSamplesPerSec=4.486909212039538, CurrSamplesPerSec=4.4739660236828875, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:19:06,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=2470, skipped=14, lr=[8.916311956202905e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:19:06,425] [INFO] [timer.py:258:stop] epoch=0/micro_step=2470/global_step=2470, RunningAvgSamplesPerSec=4.486898158629573, CurrSamplesPerSec=4.489861478972427, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:19:15,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=2480, skipped=14, lr=[8.907093510126747e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:19:15,493] [INFO] [timer.py:258:stop] epoch=0/micro_step=2480/global_step=2480, RunningAvgSamplesPerSec=4.486867335020933, CurrSamplesPerSec=4.482753497956241, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:19:24,524] [INFO] [logging.py:96:log_dist] [Rank 0] step=2490, skipped=14, lr=[8.897841437413139e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:19:24,524] [INFO] [timer.py:258:stop] epoch=0/micro_step=2490/global_step=2490, RunningAvgSamplesPerSec=4.486866005035855, CurrSamplesPerSec=4.484650354407648, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:19:33,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=2500, skipped=14, lr=[8.888555829376311e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:19:33,604] [INFO] [timer.py:258:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=4.486811602837284, CurrSamplesPerSec=4.4726015692959065, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:19:33,613] [INFO] [RANK 0]  iteration     2500/   10000 | elapsed time per iteration (ms): 906.5 | learning rate 8.888E-05 | total loss 3.454352E-01 | loss 3.454352E-01 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 19:19:33,623] [INFO] [RANK 0] time (ms) | forward: 355.19 | backward: 546.92 | allreduce: 0.00 | optimizer: 3.48 | batch generator: 13.25 | data loader: 0.14
[2024-06-17 19:19:42,706] [INFO] [logging.py:96:log_dist] [Rank 0] step=2510, skipped=14, lr=[8.879236777661462e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:19:42,706] [INFO] [timer.py:258:stop] epoch=0/micro_step=2510/global_step=2510, RunningAvgSamplesPerSec=4.486765719806419, CurrSamplesPerSec=4.4401554047616525, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:19:51,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=2520, skipped=14, lr=[8.86988437424387e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:19:51,794] [INFO] [timer.py:258:stop] epoch=0/micro_step=2520/global_step=2520, RunningAvgSamplesPerSec=4.486720815426135, CurrSamplesPerSec=4.47902796973725, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:20:00,867] [INFO] [logging.py:96:log_dist] [Rank 0] step=2530, skipped=14, lr=[8.860498711427982e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:20:00,868] [INFO] [timer.py:258:stop] epoch=0/micro_step=2530/global_step=2530, RunningAvgSamplesPerSec=4.486690194690147, CurrSamplesPerSec=4.486893182722007, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:20:09,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=2540, skipped=14, lr=[8.8510798818465e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:20:09,925] [INFO] [timer.py:258:stop] epoch=0/micro_step=2540/global_step=2540, RunningAvgSamplesPerSec=4.486666439424677, CurrSamplesPerSec=4.488047854060204, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:20:18,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=2550, skipped=14, lr=[8.841627978459472e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:20:18,981] [INFO] [timer.py:258:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=4.486622344198493, CurrSamplesPerSec=4.472328539843651, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:20:18,983] [INFO] [RANK 0]  iteration     2550/   10000 | elapsed time per iteration (ms): 907.4 | learning rate 8.841E-05 | total loss 2.740410E-01 | loss 2.740410E-01 | loss scale 32768.0 |speed 264.49 samples/(min*GPU)
[2024-06-17 19:20:18,985] [INFO] [RANK 0] time (ms) | forward: 356.00 | backward: 546.82 | allreduce: 0.00 | optimizer: 3.49 | batch generator: 12.95 | data loader: 0.13
[2024-06-17 19:20:28,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=2560, skipped=14, lr=[8.832143094553364e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:20:28,037] [INFO] [timer.py:258:stop] epoch=0/micro_step=2560/global_step=2560, RunningAvgSamplesPerSec=4.486595231511996, CurrSamplesPerSec=4.470741099004176, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:20:37,095] [INFO] [logging.py:96:log_dist] [Rank 0] step=2570, skipped=14, lr=[8.822625323740153e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:20:37,096] [INFO] [timer.py:258:stop] epoch=0/micro_step=2570/global_step=2570, RunningAvgSamplesPerSec=4.486565173827713, CurrSamplesPerSec=4.482923586335449, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:20:46,137] [INFO] [logging.py:96:log_dist] [Rank 0] step=2580, skipped=14, lr=[8.813074759956396e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:20:46,138] [INFO] [timer.py:258:stop] epoch=0/micro_step=2580/global_step=2580, RunningAvgSamplesPerSec=4.486553804477615, CurrSamplesPerSec=4.4734912327153395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:20:55,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=2590, skipped=14, lr=[8.8034914974623e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:20:55,194] [INFO] [timer.py:258:stop] epoch=0/micro_step=2590/global_step=2590, RunningAvgSamplesPerSec=4.486545336147062, CurrSamplesPerSec=4.4875652683985265, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:21:04,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=2600, skipped=14, lr=[8.793875630840797e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:21:04,267] [INFO] [timer.py:258:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=4.486528335536612, CurrSamplesPerSec=4.485022005116126, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:21:04,268] [INFO] [RANK 0]  iteration     2600/   10000 | elapsed time per iteration (ms): 905.7 | learning rate 8.793E-05 | total loss 2.861145E-01 | loss 2.861145E-01 | loss scale 32768.0 |speed 264.99 samples/(min*GPU)
[2024-06-17 19:21:04,269] [INFO] [RANK 0] time (ms) | forward: 354.87 | backward: 546.65 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 12.56 | data loader: 0.09
[2024-06-17 19:21:13,324] [INFO] [logging.py:96:log_dist] [Rank 0] step=2610, skipped=14, lr=[8.784227254996609e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:21:13,325] [INFO] [timer.py:258:stop] epoch=0/micro_step=2610/global_step=2610, RunningAvgSamplesPerSec=4.4865114737069165, CurrSamplesPerSec=4.478016576748939, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:21:22,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=2620, skipped=14, lr=[8.774546465155311e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:21:22,366] [INFO] [timer.py:258:stop] epoch=0/micro_step=2620/global_step=2620, RunningAvgSamplesPerSec=4.486492507192956, CurrSamplesPerSec=4.480146293839551, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:21:31,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=2630, skipped=14, lr=[8.76483335686239e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:21:31,399] [INFO] [timer.py:258:stop] epoch=0/micro_step=2630/global_step=2630, RunningAvgSamplesPerSec=4.486484913450871, CurrSamplesPerSec=4.487941004010392, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:21:40,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=2640, skipped=14, lr=[8.755088025982304e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:21:40,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=2640/global_step=2640, RunningAvgSamplesPerSec=4.486448381543763, CurrSamplesPerSec=4.472590838251422, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:21:49,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=2650, skipped=14, lr=[8.745310568697534e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:21:49,522] [INFO] [timer.py:258:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=4.486431601226544, CurrSamplesPerSec=4.481935577112903, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:21:49,523] [INFO] [RANK 0]  iteration     2650/   10000 | elapsed time per iteration (ms): 905.1 | learning rate 8.744E-05 | total loss 2.574622E-01 | loss 2.574622E-01 | loss scale 32768.0 |speed 265.16 samples/(min*GPU)
[2024-06-17 19:21:49,524] [INFO] [RANK 0] time (ms) | forward: 354.25 | backward: 546.75 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 11.95 | data loader: 0.10
[2024-06-17 19:21:58,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=2660, skipped=14, lr=[8.735501081507633e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:21:58,562] [INFO] [timer.py:258:stop] epoch=0/micro_step=2660/global_step=2660, RunningAvgSamplesPerSec=4.486414913895455, CurrSamplesPerSec=4.4782903011576085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:22:07,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=2670, skipped=14, lr=[8.725659661228286e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:22:07,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=2670/global_step=2670, RunningAvgSamplesPerSec=4.486419079674122, CurrSamplesPerSec=4.477416651654957, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:22:16,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=2680, skipped=14, lr=[8.715786404990331e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:22:16,658] [INFO] [timer.py:258:stop] epoch=0/micro_step=2680/global_step=2680, RunningAvgSamplesPerSec=4.486383709889278, CurrSamplesPerSec=4.480915690054002, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:22:25,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=2690, skipped=14, lr=[8.705881410238825e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:22:25,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=2690/global_step=2690, RunningAvgSamplesPerSec=4.486356187987063, CurrSamplesPerSec=4.488842786037971, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:22:34,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=2700, skipped=14, lr=[8.695944774732068e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:22:34,745] [INFO] [timer.py:258:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=4.486337767497836, CurrSamplesPerSec=4.476884979933396, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:22:34,746] [INFO] [RANK 0]  iteration     2700/   10000 | elapsed time per iteration (ms): 904.5 | learning rate 8.695E-05 | total loss 2.387737E-01 | loss 2.387737E-01 | loss scale 32768.0 |speed 265.35 samples/(min*GPU)
[2024-06-17 19:22:34,747] [INFO] [RANK 0] time (ms) | forward: 353.40 | backward: 546.92 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 11.31 | data loader: 0.09
[2024-06-17 19:22:34,747] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:22:34,760] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/2700/mp_rank_00_model_states.pt
[2024-06-17 19:22:34,760] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/2700/mp_rank_00_model_states.pt...
[2024-06-17 19:22:55,400] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/2700/mp_rank_00_model_states.pt.
[2024-06-17 19:23:04,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=2710, skipped=14, lr=[8.685976596540638e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:23:04,369] [INFO] [timer.py:258:stop] epoch=0/micro_step=2710/global_step=2710, RunningAvgSamplesPerSec=4.4864705629729436, CurrSamplesPerSec=4.519632819918779, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:23:13,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=2720, skipped=14, lr=[8.675976974046432e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:23:13,384] [INFO] [timer.py:258:stop] epoch=0/micro_step=2720/global_step=2720, RunningAvgSamplesPerSec=4.486559734143207, CurrSamplesPerSec=4.518898757177434, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:23:22,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=2730, skipped=14, lr=[8.665946005941686e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:23:22,383] [INFO] [timer.py:258:stop] epoch=0/micro_step=2730/global_step=2730, RunningAvgSamplesPerSec=4.486654582841073, CurrSamplesPerSec=4.5149270279638225, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:23:31,387] [INFO] [logging.py:96:log_dist] [Rank 0] step=2740, skipped=14, lr=[8.655883791228004e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:23:31,387] [INFO] [timer.py:258:stop] epoch=0/micro_step=2740/global_step=2740, RunningAvgSamplesPerSec=4.486717176603248, CurrSamplesPerSec=4.507411327892019, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:23:40,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=2750, skipped=14, lr=[8.645790429215386e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:23:40,406] [INFO] [timer.py:258:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=4.486753566161346, CurrSamplesPerSec=4.498618684163602, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:23:40,409] [INFO] [RANK 0]  iteration     2750/   10000 | elapsed time per iteration (ms): 1313.3 | learning rate 8.645E-05 | total loss 3.500519E-01 | loss 3.500519E-01 | loss scale 32768.0 |speed 182.75 samples/(min*GPU)
[2024-06-17 19:23:40,409] [INFO] [RANK 0] time (ms) | forward: 352.60 | backward: 543.25 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.28 | data loader: 0.09
[2024-06-17 19:23:49,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=2760, skipped=14, lr=[8.635666019521238e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:23:49,437] [INFO] [timer.py:258:stop] epoch=0/micro_step=2760/global_step=2760, RunningAvgSamplesPerSec=4.4867543090429, CurrSamplesPerSec=4.484748656022844, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:23:58,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=2770, skipped=14, lr=[8.625510662069396e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:23:58,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=2770/global_step=2770, RunningAvgSamplesPerSec=4.486755341330041, CurrSamplesPerSec=4.490831348527603, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:24:07,512] [INFO] [logging.py:96:log_dist] [Rank 0] step=2780, skipped=14, lr=[8.61532445708914e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:24:07,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=2780/global_step=2780, RunningAvgSamplesPerSec=4.48675012654131, CurrSamplesPerSec=4.496926947387945, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:24:16,583] [INFO] [logging.py:96:log_dist] [Rank 0] step=2790, skipped=14, lr=[8.605107505114198e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:24:16,584] [INFO] [timer.py:258:stop] epoch=0/micro_step=2790/global_step=2790, RunningAvgSamplesPerSec=4.4867329300381575, CurrSamplesPerSec=4.491282174012792, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:24:25,656] [INFO] [logging.py:96:log_dist] [Rank 0] step=2800, skipped=14, lr=[8.594859906981766e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:24:25,657] [INFO] [timer.py:258:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=4.486713494138397, CurrSamplesPerSec=4.488424871284162, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:24:25,658] [INFO] [RANK 0]  iteration     2800/   10000 | elapsed time per iteration (ms): 905.0 | learning rate 8.594E-05 | total loss 2.648614E-01 | loss 2.648614E-01 | loss scale 32768.0 |speed 265.20 samples/(min*GPU)
[2024-06-17 19:24:25,659] [INFO] [RANK 0] time (ms) | forward: 354.19 | backward: 546.64 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.47 | data loader: 0.09
[2024-06-17 19:24:34,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=2810, skipped=14, lr=[8.584581763831497e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:24:34,716] [INFO] [timer.py:258:stop] epoch=0/micro_step=2810/global_step=2810, RunningAvgSamplesPerSec=4.486699190305964, CurrSamplesPerSec=4.470794710369408, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:24:39,234] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 19:24:40,142] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 19:24:43,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=2820, skipped=16, lr=[8.57633732505677e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:24:43,766] [INFO] [timer.py:258:stop] epoch=0/micro_step=2820/global_step=2820, RunningAvgSamplesPerSec=4.486669777392589, CurrSamplesPerSec=4.458811866978853, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:24:52,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=2830, skipped=16, lr=[8.566004456707973e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:24:52,819] [INFO] [timer.py:258:stop] epoch=0/micro_step=2830/global_step=2830, RunningAvgSamplesPerSec=4.486647996777589, CurrSamplesPerSec=4.469294078001857, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:25:01,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=2840, skipped=16, lr=[8.555641328132982e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:25:01,862] [INFO] [timer.py:258:stop] epoch=0/micro_step=2840/global_step=2840, RunningAvgSamplesPerSec=4.48664548352554, CurrSamplesPerSec=4.478572427703632, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:25:10,925] [INFO] [logging.py:96:log_dist] [Rank 0] step=2850, skipped=16, lr=[8.545248041611697e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:25:10,926] [INFO] [timer.py:258:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=4.486635582468106, CurrSamplesPerSec=4.480976726570725, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:25:10,927] [INFO] [RANK 0]  iteration     2850/   10000 | elapsed time per iteration (ms): 905.4 | learning rate 8.544E-05 | total loss 2.303243E-01 | loss 2.303243E-01 | loss scale 32768.0 |speed 265.08 samples/(min*GPU)
[2024-06-17 19:25:10,928] [INFO] [RANK 0] time (ms) | forward: 354.43 | backward: 546.83 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 12.36 | data loader: 0.09
[2024-06-17 19:25:19,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=2860, skipped=16, lr=[8.534824699721658e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:25:19,952] [INFO] [timer.py:258:stop] epoch=0/micro_step=2860/global_step=2860, RunningAvgSamplesPerSec=4.4866388070135095, CurrSamplesPerSec=4.484541268635452, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:25:28,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=2870, skipped=16, lr=[8.52437140533704e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:25:28,999] [INFO] [timer.py:258:stop] epoch=0/micro_step=2870/global_step=2870, RunningAvgSamplesPerSec=4.486623710771709, CurrSamplesPerSec=4.4812412373590265, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:25:38,047] [INFO] [logging.py:96:log_dist] [Rank 0] step=2880, skipped=16, lr=[8.513888261627641e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:25:38,047] [INFO] [timer.py:258:stop] epoch=0/micro_step=2880/global_step=2880, RunningAvgSamplesPerSec=4.486613444203656, CurrSamplesPerSec=4.473678512593708, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:25:47,087] [INFO] [logging.py:96:log_dist] [Rank 0] step=2890, skipped=16, lr=[8.503375372057854e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:25:47,088] [INFO] [timer.py:258:stop] epoch=0/micro_step=2890/global_step=2890, RunningAvgSamplesPerSec=4.486619620043235, CurrSamplesPerSec=4.4852186452445455, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:25:56,105] [INFO] [logging.py:96:log_dist] [Rank 0] step=2900, skipped=16, lr=[8.492832840385657e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:25:56,106] [INFO] [timer.py:258:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=4.4866231296344905, CurrSamplesPerSec=4.480222862648502, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:25:56,107] [INFO] [RANK 0]  iteration     2900/   10000 | elapsed time per iteration (ms): 903.6 | learning rate 8.492E-05 | total loss 2.683838E-01 | loss 2.683838E-01 | loss scale 32768.0 |speed 265.60 samples/(min*GPU)
[2024-06-17 19:25:56,109] [INFO] [RANK 0] time (ms) | forward: 352.65 | backward: 546.86 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 11.38 | data loader: 0.09
[2024-06-17 19:26:05,149] [INFO] [logging.py:96:log_dist] [Rank 0] step=2910, skipped=16, lr=[8.482260770661583e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:26:05,150] [INFO] [timer.py:258:stop] epoch=0/micro_step=2910/global_step=2910, RunningAvgSamplesPerSec=4.486604341593839, CurrSamplesPerSec=4.488016638912853, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:26:14,195] [INFO] [logging.py:96:log_dist] [Rank 0] step=2920, skipped=16, lr=[8.471659267227686e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:26:14,195] [INFO] [timer.py:258:stop] epoch=0/micro_step=2920/global_step=2920, RunningAvgSamplesPerSec=4.486589876882894, CurrSamplesPerSec=4.487476445532174, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:26:23,226] [INFO] [logging.py:96:log_dist] [Rank 0] step=2930, skipped=16, lr=[8.461028434716533e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:26:23,227] [INFO] [timer.py:258:stop] epoch=0/micro_step=2930/global_step=2930, RunningAvgSamplesPerSec=4.486583087296933, CurrSamplesPerSec=4.477570800326452, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:26:32,280] [INFO] [logging.py:96:log_dist] [Rank 0] step=2940, skipped=16, lr=[8.45036837805014e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:26:32,281] [INFO] [timer.py:258:stop] epoch=0/micro_step=2940/global_step=2940, RunningAvgSamplesPerSec=4.486562694896643, CurrSamplesPerSec=4.479999145507976, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:26:41,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=2950, skipped=16, lr=[8.439679202438971e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:26:41,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=4.486554464148905, CurrSamplesPerSec=4.478965790560522, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:26:41,334] [INFO] [RANK 0]  iteration     2950/   10000 | elapsed time per iteration (ms): 904.5 | learning rate 8.439E-05 | total loss 2.867053E-01 | loss 2.867053E-01 | loss scale 32768.0 |speed 265.33 samples/(min*GPU)
[2024-06-17 19:26:41,334] [INFO] [RANK 0] time (ms) | forward: 353.55 | backward: 546.84 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 11.58 | data loader: 0.10
[2024-06-17 19:26:50,367] [INFO] [logging.py:96:log_dist] [Rank 0] step=2960, skipped=16, lr=[8.42896101338087e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:26:50,368] [INFO] [timer.py:258:stop] epoch=0/micro_step=2960/global_step=2960, RunningAvgSamplesPerSec=4.4865405850273445, CurrSamplesPerSec=4.482418150233483, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:26:59,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=2970, skipped=16, lr=[8.418213916660038e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:26:59,408] [INFO] [timer.py:258:stop] epoch=0/micro_step=2970/global_step=2970, RunningAvgSamplesPerSec=4.4865308904044205, CurrSamplesPerSec=4.488579778883373, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:27:08,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=2980, skipped=16, lr=[8.407438018345975e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:27:08,461] [INFO] [timer.py:258:stop] epoch=0/micro_step=2980/global_step=2980, RunningAvgSamplesPerSec=4.48651811323809, CurrSamplesPerSec=4.483433928925513, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:27:17,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=2990, skipped=16, lr=[8.396633424792452e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:27:17,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=2990/global_step=2990, RunningAvgSamplesPerSec=4.4865087423065555, CurrSamplesPerSec=4.483339279152887, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:27:26,568] [INFO] [logging.py:96:log_dist] [Rank 0] step=3000, skipped=16, lr=[8.385800242636447e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:27:26,569] [INFO] [timer.py:258:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=4.486498541910176, CurrSamplesPerSec=4.484102581646661, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:27:26,569] [INFO] [RANK 0]  iteration     3000/   10000 | elapsed time per iteration (ms): 904.7 | learning rate 8.385E-05 | total loss 2.942815E-01 | loss 2.942815E-01 | loss scale 32768.0 |speed 265.28 samples/(min*GPU)
[2024-06-17 19:27:26,571] [INFO] [RANK 0] time (ms) | forward: 353.76 | backward: 546.86 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 11.88 | data loader: 0.09
[2024-06-17 19:27:26,572] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:27:26,584] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/3000/mp_rank_00_model_states.pt
[2024-06-17 19:27:26,584] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/3000/mp_rank_00_model_states.pt...
[2024-06-17 19:27:47,676] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/3000/mp_rank_00_model_states.pt.
[2024-06-17 19:27:54,271] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 19:27:54,271] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 19:27:54,271] [INFO] [RANK 0]  validation loss at iteration 3000 | loss: 9.216797E-01 | PPL: 2.513509E+00 loss 9.208984E-01 |
[2024-06-17 19:27:54,271] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 19:28:03,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=3010, skipped=16, lr=[8.37493857879709e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:28:03,257] [INFO] [timer.py:258:stop] epoch=0/micro_step=3010/global_step=3010, RunningAvgSamplesPerSec=4.486595114886955, CurrSamplesPerSec=4.510928313810517, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:28:12,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=3020, skipped=16, lr=[8.36404854047462e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:28:12,259] [INFO] [timer.py:258:stop] epoch=0/micro_step=3020/global_step=3020, RunningAvgSamplesPerSec=4.486657221862835, CurrSamplesPerSec=4.502357555098626, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:28:21,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=3030, skipped=16, lr=[8.353130235149319e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:28:21,263] [INFO] [timer.py:258:stop] epoch=0/micro_step=3030/global_step=3030, RunningAvgSamplesPerSec=4.48673062869466, CurrSamplesPerSec=4.5035903168015015, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:28:30,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=3040, skipped=16, lr=[8.342183770580452e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:28:30,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=3040/global_step=3040, RunningAvgSamplesPerSec=4.486798399872018, CurrSamplesPerSec=4.501214832112778, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:28:39,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=3050, skipped=16, lr=[8.331209254805206e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:28:39,316] [INFO] [timer.py:258:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=4.486822591705393, CurrSamplesPerSec=4.489738923049215, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:28:39,317] [INFO] [RANK 0]  iteration     3050/   10000 | elapsed time per iteration (ms): 1455.0 | learning rate 8.330E-05 | total loss 2.226454E-01 | loss 2.226454E-01 | loss scale 32768.0 |speed 164.95 samples/(min*GPU)
[2024-06-17 19:28:39,318] [INFO] [RANK 0] time (ms) | forward: 352.79 | backward: 544.02 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 15.48 | data loader: 0.20
[2024-06-17 19:28:48,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=3060, skipped=16, lr=[8.320206796137623e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:28:48,366] [INFO] [timer.py:258:stop] epoch=0/micro_step=3060/global_step=3060, RunningAvgSamplesPerSec=4.486836089757134, CurrSamplesPerSec=4.48961997811014, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:28:57,400] [INFO] [logging.py:96:log_dist] [Rank 0] step=3070, skipped=16, lr=[8.309176503167521e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:28:57,401] [INFO] [timer.py:258:stop] epoch=0/micro_step=3070/global_step=3070, RunningAvgSamplesPerSec=4.486830492426919, CurrSamplesPerSec=4.482088839697059, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:29:06,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=3080, skipped=16, lr=[8.298118484759446e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:29:06,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=3080/global_step=3080, RunningAvgSamplesPerSec=4.486826080737901, CurrSamplesPerSec=4.4882507631024895, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:29:15,491] [INFO] [logging.py:96:log_dist] [Rank 0] step=3090, skipped=16, lr=[8.287032850051573e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:29:15,492] [INFO] [timer.py:258:stop] epoch=0/micro_step=3090/global_step=3090, RunningAvgSamplesPerSec=4.486808508875842, CurrSamplesPerSec=4.4706231585264105, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:29:24,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=3100, skipped=16, lr=[8.275919708454638e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:29:24,556] [INFO] [timer.py:258:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=4.486794095317919, CurrSamplesPerSec=4.486254887767525, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:29:24,558] [INFO] [RANK 0]  iteration     3100/   10000 | elapsed time per iteration (ms): 904.8 | learning rate 8.275E-05 | total loss 2.789612E-01 | loss 2.789612E-01 | loss scale 32768.0 |speed 265.25 samples/(min*GPU)
[2024-06-17 19:29:24,559] [INFO] [RANK 0] time (ms) | forward: 354.08 | backward: 546.54 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 12.37 | data loader: 0.17
[2024-06-17 19:29:33,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=3110, skipped=16, lr=[8.264779169650865e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:29:33,605] [INFO] [timer.py:258:stop] epoch=0/micro_step=3110/global_step=3110, RunningAvgSamplesPerSec=4.486789791656339, CurrSamplesPerSec=4.483679557736419, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:29:42,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=3120, skipped=16, lr=[8.253611343592877e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:29:42,665] [INFO] [timer.py:258:stop] epoch=0/micro_step=3120/global_step=3120, RunningAvgSamplesPerSec=4.486777608801351, CurrSamplesPerSec=4.46906073683546, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:29:51,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=3130, skipped=16, lr=[8.242416340502605e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:29:51,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=3130/global_step=3130, RunningAvgSamplesPerSec=4.486749295658946, CurrSamplesPerSec=4.464905158247007, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:30:00,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=3140, skipped=16, lr=[8.23119427087021e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:30:00,789] [INFO] [timer.py:258:stop] epoch=0/micro_step=3140/global_step=3140, RunningAvgSamplesPerSec=4.486730801396414, CurrSamplesPerSec=4.47403402963486, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:30:09,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=3150, skipped=16, lr=[8.219945245452987e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:30:09,838] [INFO] [timer.py:258:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=4.486730045276332, CurrSamplesPerSec=4.493026217864377, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:30:09,839] [INFO] [RANK 0]  iteration     3150/   10000 | elapsed time per iteration (ms): 905.6 | learning rate 8.219E-05 | total loss 3.303412E-01 | loss 3.303412E-01 | loss scale 32768.0 |speed 265.01 samples/(min*GPU)
[2024-06-17 19:30:09,840] [INFO] [RANK 0] time (ms) | forward: 354.63 | backward: 546.82 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 12.79 | data loader: 0.09
[2024-06-17 19:30:18,912] [INFO] [logging.py:96:log_dist] [Rank 0] step=3160, skipped=16, lr=[8.208669375274278e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:30:18,913] [INFO] [timer.py:258:stop] epoch=0/micro_step=3160/global_step=3160, RunningAvgSamplesPerSec=4.486679241644543, CurrSamplesPerSec=4.47000734822766, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:30:27,981] [INFO] [logging.py:96:log_dist] [Rank 0] step=3170, skipped=16, lr=[8.197366771622371e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:30:27,982] [INFO] [timer.py:258:stop] epoch=0/micro_step=3170/global_step=3170, RunningAvgSamplesPerSec=4.4866662753921585, CurrSamplesPerSec=4.482984677565672, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:30:37,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=3180, skipped=16, lr=[8.186037546049399e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:30:37,045] [INFO] [timer.py:258:stop] epoch=0/micro_step=3180/global_step=3180, RunningAvgSamplesPerSec=4.486644470524177, CurrSamplesPerSec=4.482468449193289, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:30:46,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=3190, skipped=16, lr=[8.174681810370246e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:30:46,105] [INFO] [timer.py:258:stop] epoch=0/micro_step=3190/global_step=3190, RunningAvgSamplesPerSec=4.486611534159252, CurrSamplesPerSec=4.492824079963045, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:30:55,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=3200, skipped=16, lr=[8.163299676661434e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:30:55,154] [INFO] [timer.py:258:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=4.486601635933841, CurrSamplesPerSec=4.478139688827082, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:30:55,155] [INFO] [RANK 0]  iteration     3200/   10000 | elapsed time per iteration (ms): 906.3 | learning rate 8.162E-05 | total loss 2.436478E-01 | loss 2.436478E-01 | loss scale 32768.0 |speed 264.81 samples/(min*GPU)
[2024-06-17 19:30:55,156] [INFO] [RANK 0] time (ms) | forward: 354.99 | backward: 546.98 | allreduce: 0.00 | optimizer: 3.54 | batch generator: 12.38 | data loader: 0.15
[2024-06-17 19:31:04,218] [INFO] [logging.py:96:log_dist] [Rank 0] step=3210, skipped=16, lr=[8.151891257260032e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:31:04,219] [INFO] [timer.py:258:stop] epoch=0/micro_step=3210/global_step=3210, RunningAvgSamplesPerSec=4.486578834572106, CurrSamplesPerSec=4.491006859157071, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:31:10,566] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 19:31:11,465] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 19:31:13,288] [INFO] [logging.py:96:log_dist] [Rank 0] step=3220, skipped=18, lr=[8.1427456716964e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:31:13,289] [INFO] [timer.py:258:stop] epoch=0/micro_step=3220/global_step=3220, RunningAvgSamplesPerSec=4.486561242399671, CurrSamplesPerSec=4.477611430425908, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:31:22,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=3230, skipped=18, lr=[8.131290221965128e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:31:22,363] [INFO] [timer.py:258:stop] epoch=0/micro_step=3230/global_step=3230, RunningAvgSamplesPerSec=4.486529937701447, CurrSamplesPerSec=4.478730242799206, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:31:31,426] [INFO] [logging.py:96:log_dist] [Rank 0] step=3240, skipped=18, lr=[8.119808802461656e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:31:31,426] [INFO] [timer.py:258:stop] epoch=0/micro_step=3240/global_step=3240, RunningAvgSamplesPerSec=4.486520713856172, CurrSamplesPerSec=4.482930773452584, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:31:40,486] [INFO] [logging.py:96:log_dist] [Rank 0] step=3250, skipped=18, lr=[8.108301526502963e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:31:40,487] [INFO] [timer.py:258:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=4.486508921243952, CurrSamplesPerSec=4.485753497690309, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:31:40,487] [INFO] [RANK 0]  iteration     3250/   10000 | elapsed time per iteration (ms): 906.6 | learning rate 8.107E-05 | total loss 2.765788E-01 | loss 2.765788E-01 | loss scale 32768.0 |speed 264.71 samples/(min*GPU)
[2024-06-17 19:31:40,489] [INFO] [RANK 0] time (ms) | forward: 355.65 | backward: 546.89 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 13.29 | data loader: 0.18
[2024-06-17 19:31:49,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=3260, skipped=18, lr=[8.096768507661222e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:31:49,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=3260/global_step=3260, RunningAvgSamplesPerSec=4.486499504127242, CurrSamplesPerSec=4.489042163595747, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:31:58,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=3270, skipped=18, lr=[8.085209859762666e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:31:58,612] [INFO] [timer.py:258:stop] epoch=0/micro_step=3270/global_step=3270, RunningAvgSamplesPerSec=4.486490552188468, CurrSamplesPerSec=4.4887058743579855, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:32:07,671] [INFO] [logging.py:96:log_dist] [Rank 0] step=3280, skipped=18, lr=[8.073625696886485e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:32:07,671] [INFO] [timer.py:258:stop] epoch=0/micro_step=3280/global_step=3280, RunningAvgSamplesPerSec=4.486480850432083, CurrSamplesPerSec=4.47480968234248, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:32:16,730] [INFO] [logging.py:96:log_dist] [Rank 0] step=3290, skipped=18, lr=[8.062016133363692e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:32:16,730] [INFO] [timer.py:258:stop] epoch=0/micro_step=3290/global_step=3290, RunningAvgSamplesPerSec=4.486464261757422, CurrSamplesPerSec=4.478432555439142, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:32:25,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=3300, skipped=18, lr=[8.050381283775988e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:32:25,763] [INFO] [timer.py:258:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=4.4864582818764065, CurrSamplesPerSec=4.472129452046579, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:32:25,764] [INFO] [RANK 0]  iteration     3300/   10000 | elapsed time per iteration (ms): 905.5 | learning rate 8.049E-05 | total loss 2.664900E-01 | loss 2.664900E-01 | loss scale 32768.0 |speed 265.03 samples/(min*GPU)
[2024-06-17 19:32:25,766] [INFO] [RANK 0] time (ms) | forward: 354.64 | backward: 546.78 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 12.74 | data loader: 0.10
[2024-06-17 19:32:25,766] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:32:25,780] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/3300/mp_rank_00_model_states.pt
[2024-06-17 19:32:25,780] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/3300/mp_rank_00_model_states.pt...
[2024-06-17 19:32:47,281] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/3300/mp_rank_00_model_states.pt.
[2024-06-17 19:32:56,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=3310, skipped=18, lr=[8.038721262954646e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:32:56,266] [INFO] [timer.py:258:stop] epoch=0/micro_step=3310/global_step=3310, RunningAvgSamplesPerSec=4.486569934740962, CurrSamplesPerSec=4.506172842822084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:33:05,266] [INFO] [logging.py:96:log_dist] [Rank 0] step=3320, skipped=18, lr=[8.02703618597936e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:33:05,266] [INFO] [timer.py:258:stop] epoch=0/micro_step=3320/global_step=3320, RunningAvgSamplesPerSec=4.486660143963192, CurrSamplesPerSec=4.515520033072656, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:33:14,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=3330, skipped=18, lr=[8.015326168177127e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:33:14,274] [INFO] [timer.py:258:stop] epoch=0/micro_step=3330/global_step=3330, RunningAvgSamplesPerSec=4.486718852997038, CurrSamplesPerSec=4.514520034690614, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:33:23,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=3340, skipped=18, lr=[8.003591325121088e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:33:23,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=3340/global_step=3340, RunningAvgSamplesPerSec=4.486772807927854, CurrSamplesPerSec=4.499820433272119, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:33:32,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=3350, skipped=18, lr=[7.991831772629413e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:33:32,319] [INFO] [timer.py:258:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=4.486774307159491, CurrSamplesPerSec=4.497485091901441, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:33:32,320] [INFO] [RANK 0]  iteration     3350/   10000 | elapsed time per iteration (ms): 1331.1 | learning rate 7.991E-05 | total loss 2.702310E-01 | loss 2.702310E-01 | loss scale 32768.0 |speed 180.30 samples/(min*GPU)
[2024-06-17 19:33:32,321] [INFO] [RANK 0] time (ms) | forward: 353.06 | backward: 543.24 | allreduce: 0.00 | optimizer: 3.43 | batch generator: 12.61 | data loader: 0.19
[2024-06-17 19:33:41,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=3360, skipped=18, lr=[7.980047626764135e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:33:41,362] [INFO] [timer.py:258:stop] epoch=0/micro_step=3360/global_step=3360, RunningAvgSamplesPerSec=4.486767469213461, CurrSamplesPerSec=4.480064942347645, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:33:50,402] [INFO] [logging.py:96:log_dist] [Rank 0] step=3370, skipped=18, lr=[7.968239003830016e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:33:50,403] [INFO] [timer.py:258:stop] epoch=0/micro_step=3370/global_step=3370, RunningAvgSamplesPerSec=4.486761043478469, CurrSamplesPerSec=4.48358609579737, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:33:59,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=3380, skipped=18, lr=[7.9564060203734e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:33:59,465] [INFO] [timer.py:258:stop] epoch=0/micro_step=3380/global_step=3380, RunningAvgSamplesPerSec=4.486755431940172, CurrSamplesPerSec=4.495089545628577, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:34:08,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=3390, skipped=18, lr=[7.944548793181054e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:34:08,527] [INFO] [timer.py:258:stop] epoch=0/micro_step=3390/global_step=3390, RunningAvgSamplesPerSec=4.486749072617455, CurrSamplesPerSec=4.496472577820243, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:34:17,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=3400, skipped=18, lr=[7.932667439279021e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:34:17,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=4.486732963056766, CurrSamplesPerSec=4.482016996555648, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:34:17,575] [INFO] [RANK 0]  iteration     3400/   10000 | elapsed time per iteration (ms): 905.1 | learning rate 7.931E-05 | total loss 2.492494E-01 | loss 2.492494E-01 | loss scale 32768.0 |speed 265.16 samples/(min*GPU)
[2024-06-17 19:34:17,577] [INFO] [RANK 0] time (ms) | forward: 354.54 | backward: 546.45 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 12.51 | data loader: 0.10
[2024-06-17 19:34:26,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=3410, skipped=18, lr=[7.920762075931471e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:34:26,636] [INFO] [timer.py:258:stop] epoch=0/micro_step=3410/global_step=3410, RunningAvgSamplesPerSec=4.486709441877752, CurrSamplesPerSec=4.4745507037651935, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:34:35,695] [INFO] [logging.py:96:log_dist] [Rank 0] step=3420, skipped=18, lr=[7.908832820639534e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:34:35,696] [INFO] [timer.py:258:stop] epoch=0/micro_step=3420/global_step=3420, RunningAvgSamplesPerSec=4.4867124718521545, CurrSamplesPerSec=4.491788408620311, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:34:44,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=3430, skipped=18, lr=[7.89687979114014e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:34:44,733] [INFO] [timer.py:258:stop] epoch=0/micro_step=3430/global_step=3430, RunningAvgSamplesPerSec=4.486699964544956, CurrSamplesPerSec=4.4855640062252204, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:34:53,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=3440, skipped=18, lr=[7.884903105404869e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:34:53,777] [INFO] [timer.py:258:stop] epoch=0/micro_step=3440/global_step=3440, RunningAvgSamplesPerSec=4.486692075800443, CurrSamplesPerSec=4.486414444480099, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:35:02,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=3450, skipped=18, lr=[7.872902881638772e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:35:02,827] [INFO] [timer.py:258:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=4.486686622126434, CurrSamplesPerSec=4.492736251900625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:35:02,828] [INFO] [RANK 0]  iteration     3450/   10000 | elapsed time per iteration (ms): 905.0 | learning rate 7.872E-05 | total loss 2.648627E-01 | loss 2.648627E-01 | loss scale 32768.0 |speed 265.18 samples/(min*GPU)
[2024-06-17 19:35:02,829] [INFO] [RANK 0] time (ms) | forward: 354.13 | backward: 546.76 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 12.35 | data loader: 0.09
[2024-06-17 19:35:11,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=3460, skipped=18, lr=[7.860879238279212e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:35:11,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=3460/global_step=3460, RunningAvgSamplesPerSec=4.486667386394807, CurrSamplesPerSec=4.476612621766458, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:35:20,957] [INFO] [logging.py:96:log_dist] [Rank 0] step=3470, skipped=18, lr=[7.848832293994696e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:35:20,958] [INFO] [timer.py:258:stop] epoch=0/micro_step=3470/global_step=3470, RunningAvgSamplesPerSec=4.486664084648404, CurrSamplesPerSec=4.474637822244721, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:35:30,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=3480, skipped=18, lr=[7.8367621676837e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:35:30,013] [INFO] [timer.py:258:stop] epoch=0/micro_step=3480/global_step=3480, RunningAvgSamplesPerSec=4.486651390791807, CurrSamplesPerSec=4.477060596850113, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:35:39,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=3490, skipped=18, lr=[7.8246689784735e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:35:39,055] [INFO] [timer.py:258:stop] epoch=0/micro_step=3490/global_step=3490, RunningAvgSamplesPerSec=4.486642235150391, CurrSamplesPerSec=4.476512287637226, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:35:48,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=3500, skipped=18, lr=[7.812552845718985e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:35:48,113] [INFO] [timer.py:258:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=4.48663548560067, CurrSamplesPerSec=4.4825283303792185, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:35:48,113] [INFO] [RANK 0]  iteration     3500/   10000 | elapsed time per iteration (ms): 905.7 | learning rate 7.811E-05 | total loss 2.795291E-01 | loss 2.795291E-01 | loss scale 32768.0 |speed 264.98 samples/(min*GPU)
[2024-06-17 19:35:48,115] [INFO] [RANK 0] time (ms) | forward: 354.71 | backward: 546.89 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 12.92 | data loader: 0.09
[2024-06-17 19:35:57,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=3510, skipped=18, lr=[7.800413889001502e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:35:57,152] [INFO] [timer.py:258:stop] epoch=0/micro_step=3510/global_step=3510, RunningAvgSamplesPerSec=4.4866290091827326, CurrSamplesPerSec=4.4893544772954295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:36:06,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=3520, skipped=18, lr=[7.788252228127647e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:36:06,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=3520/global_step=3520, RunningAvgSamplesPerSec=4.486613871032773, CurrSamplesPerSec=4.475307435017916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:36:15,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=3530, skipped=18, lr=[7.776067983128106e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:36:15,273] [INFO] [timer.py:258:stop] epoch=0/micro_step=3530/global_step=3530, RunningAvgSamplesPerSec=4.486588259562806, CurrSamplesPerSec=4.460906745994289, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:36:24,320] [INFO] [logging.py:96:log_dist] [Rank 0] step=3540, skipped=18, lr=[7.763861274256458e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:36:24,320] [INFO] [timer.py:258:stop] epoch=0/micro_step=3540/global_step=3540, RunningAvgSamplesPerSec=4.486557829848755, CurrSamplesPerSec=4.463085514724641, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:36:33,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=3550, skipped=18, lr=[7.751632221987988e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:36:33,375] [INFO] [timer.py:258:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=4.486545026406746, CurrSamplesPerSec=4.481638660681253, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:36:33,376] [INFO] [RANK 0]  iteration     3550/   10000 | elapsed time per iteration (ms): 905.3 | learning rate 7.750E-05 | total loss 2.393651E-01 | loss 2.393651E-01 | loss scale 32768.0 |speed 265.12 samples/(min*GPU)
[2024-06-17 19:36:33,377] [INFO] [RANK 0] time (ms) | forward: 354.27 | backward: 546.78 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 11.87 | data loader: 0.09
[2024-06-17 19:36:42,430] [INFO] [logging.py:96:log_dist] [Rank 0] step=3560, skipped=18, lr=[7.739380947018512e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:36:42,430] [INFO] [timer.py:258:stop] epoch=0/micro_step=3560/global_step=3560, RunningAvgSamplesPerSec=4.486534922183364, CurrSamplesPerSec=4.479099717086436, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:36:51,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=3570, skipped=18, lr=[7.727107570263161e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:36:51,472] [INFO] [timer.py:258:stop] epoch=0/micro_step=3570/global_step=3570, RunningAvgSamplesPerSec=4.48652532590432, CurrSamplesPerSec=4.490530848481799, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:37:00,512] [INFO] [logging.py:96:log_dist] [Rank 0] step=3580, skipped=18, lr=[7.71481221285521e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:37:00,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=3580/global_step=3580, RunningAvgSamplesPerSec=4.486515245790148, CurrSamplesPerSec=4.487981822529983, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:37:09,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=3590, skipped=18, lr=[7.702494996144878e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:37:09,555] [INFO] [timer.py:258:stop] epoch=0/micro_step=3590/global_step=3590, RunningAvgSamplesPerSec=4.486491369137933, CurrSamplesPerSec=4.486145723924163, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:37:18,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=3600, skipped=18, lr=[7.690156041698113e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:37:18,628] [INFO] [timer.py:258:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=4.486469272359455, CurrSamplesPerSec=4.474344258447727, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:37:18,629] [INFO] [RANK 0]  iteration     3600/   10000 | elapsed time per iteration (ms): 905.1 | learning rate 7.689E-05 | total loss 2.701355E-01 | loss 2.701355E-01 | loss scale 32768.0 |speed 265.18 samples/(min*GPU)
[2024-06-17 19:37:18,630] [INFO] [RANK 0] time (ms) | forward: 353.85 | backward: 547.07 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 11.82 | data loader: 0.09
[2024-06-17 19:37:18,630] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:37:18,644] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/3600/mp_rank_00_model_states.pt
[2024-06-17 19:37:18,644] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/3600/mp_rank_00_model_states.pt...
[2024-06-17 19:37:39,783] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/3600/mp_rank_00_model_states.pt.
[2024-06-17 19:37:48,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=3610, skipped=18, lr=[7.67779547129542e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:37:48,791] [INFO] [timer.py:258:stop] epoch=0/micro_step=3610/global_step=3610, RunningAvgSamplesPerSec=4.486563231970202, CurrSamplesPerSec=4.526754509630393, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:37:56,877] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 19:37:57,773] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 19:37:57,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=3620, skipped=20, lr=[7.666652577114196e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:37:57,775] [INFO] [timer.py:258:stop] epoch=0/micro_step=3620/global_step=3620, RunningAvgSamplesPerSec=4.486642239499239, CurrSamplesPerSec=4.515027876446401, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:38:06,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=3630, skipped=20, lr=[7.655492361901425e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:38:06,788] [INFO] [timer.py:258:stop] epoch=0/micro_step=3630/global_step=3630, RunningAvgSamplesPerSec=4.486711884607532, CurrSamplesPerSec=4.510495363070442, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:38:15,834] [INFO] [logging.py:96:log_dist] [Rank 0] step=3640, skipped=20, lr=[7.643071916505727e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:38:15,835] [INFO] [timer.py:258:stop] epoch=0/micro_step=3640/global_step=3640, RunningAvgSamplesPerSec=4.486760597511922, CurrSamplesPerSec=4.5085475069614604, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:38:24,890] [INFO] [logging.py:96:log_dist] [Rank 0] step=3650, skipped=20, lr=[7.630630319855406e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:38:24,891] [INFO] [timer.py:258:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=4.486773951377257, CurrSamplesPerSec=4.4868571838132905, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:38:24,892] [INFO] [RANK 0]  iteration     3650/   10000 | elapsed time per iteration (ms): 1325.3 | learning rate 7.629E-05 | total loss 2.965091E-01 | loss 2.965091E-01 | loss scale 32768.0 |speed 181.10 samples/(min*GPU)
[2024-06-17 19:38:24,893] [INFO] [RANK 0] time (ms) | forward: 354.21 | backward: 543.66 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.25 | data loader: 0.10
[2024-06-17 19:38:33,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=3660, skipped=20, lr=[7.618167694743998e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:38:33,934] [INFO] [timer.py:258:stop] epoch=0/micro_step=3660/global_step=3660, RunningAvgSamplesPerSec=4.486786560185835, CurrSamplesPerSec=4.482282827683731, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:38:42,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=3670, skipped=20, lr=[7.605684164172581e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:38:42,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=3670/global_step=3670, RunningAvgSamplesPerSec=4.4867981755102875, CurrSamplesPerSec=4.493804859364495, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:38:52,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=3680, skipped=20, lr=[7.593179851348563e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:38:52,013] [INFO] [timer.py:258:stop] epoch=0/micro_step=3680/global_step=3680, RunningAvgSamplesPerSec=4.48680475609331, CurrSamplesPerSec=4.490006872616797, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:39:01,058] [INFO] [logging.py:96:log_dist] [Rank 0] step=3690, skipped=20, lr=[7.580654879684464e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:39:01,059] [INFO] [timer.py:258:stop] epoch=0/micro_step=3690/global_step=3690, RunningAvgSamplesPerSec=4.486791452480665, CurrSamplesPerSec=4.4846431617757325, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:39:10,133] [INFO] [logging.py:96:log_dist] [Rank 0] step=3700, skipped=20, lr=[7.568109372796697e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:39:10,134] [INFO] [timer.py:258:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=4.4867765407611655, CurrSamplesPerSec=4.489012135722305, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:39:10,134] [INFO] [RANK 0]  iteration     3700/   10000 | elapsed time per iteration (ms): 904.8 | learning rate 7.567E-05 | total loss 2.835751E-01 | loss 2.835751E-01 | loss scale 32768.0 |speed 265.24 samples/(min*GPU)
[2024-06-17 19:39:10,135] [INFO] [RANK 0] time (ms) | forward: 354.18 | backward: 546.63 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 12.86 | data loader: 0.09
[2024-06-17 19:39:19,184] [INFO] [logging.py:96:log_dist] [Rank 0] step=3710, skipped=20, lr=[7.555543454504348e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:39:19,185] [INFO] [timer.py:258:stop] epoch=0/micro_step=3710/global_step=3710, RunningAvgSamplesPerSec=4.4867683598508945, CurrSamplesPerSec=4.49119320394873, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:39:28,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=3720, skipped=20, lr=[7.542957248827961e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:39:28,269] [INFO] [timer.py:258:stop] epoch=0/micro_step=3720/global_step=3720, RunningAvgSamplesPerSec=4.486746044296842, CurrSamplesPerSec=4.486600408353736, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:39:37,329] [INFO] [logging.py:96:log_dist] [Rank 0] step=3730, skipped=20, lr=[7.530350879988304e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:39:37,329] [INFO] [timer.py:258:stop] epoch=0/micro_step=3730/global_step=3730, RunningAvgSamplesPerSec=4.48672539423919, CurrSamplesPerSec=4.481781127769055, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:39:46,365] [INFO] [logging.py:96:log_dist] [Rank 0] step=3740, skipped=20, lr=[7.517724472405146e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:39:46,366] [INFO] [timer.py:258:stop] epoch=0/micro_step=3740/global_step=3740, RunningAvgSamplesPerSec=4.486720961390096, CurrSamplesPerSec=4.481329813561237, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:39:55,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=3750, skipped=20, lr=[7.505078150696035e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:39:55,394] [INFO] [timer.py:258:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=4.4867173448670234, CurrSamplesPerSec=4.488430875255492, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:39:55,395] [INFO] [RANK 0]  iteration     3750/   10000 | elapsed time per iteration (ms): 905.2 | learning rate 7.504E-05 | total loss 2.988847E-01 | loss 2.988847E-01 | loss scale 32768.0 |speed 265.13 samples/(min*GPU)
[2024-06-17 19:39:55,397] [INFO] [RANK 0] time (ms) | forward: 354.16 | backward: 547.01 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 12.28 | data loader: 0.09
[2024-06-17 19:40:04,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=3760, skipped=20, lr=[7.492412039675058e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:40:04,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=3760/global_step=3760, RunningAvgSamplesPerSec=4.486703116670996, CurrSamplesPerSec=4.486791187314234, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:40:13,522] [INFO] [logging.py:96:log_dist] [Rank 0] step=3770, skipped=20, lr=[7.479726264351618e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:40:13,523] [INFO] [timer.py:258:stop] epoch=0/micro_step=3770/global_step=3770, RunningAvgSamplesPerSec=4.486677226911531, CurrSamplesPerSec=4.469754879315241, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:40:22,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=3780, skipped=20, lr=[7.4670209499292e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:40:22,590] [INFO] [timer.py:258:stop] epoch=0/micro_step=3780/global_step=3780, RunningAvgSamplesPerSec=4.486657248879483, CurrSamplesPerSec=4.469091688853786, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:40:31,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=3790, skipped=20, lr=[7.454296221804121e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:40:31,645] [INFO] [timer.py:258:stop] epoch=0/micro_step=3790/global_step=3790, RunningAvgSamplesPerSec=4.486645991080618, CurrSamplesPerSec=4.485877035557143, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:40:40,717] [INFO] [logging.py:96:log_dist] [Rank 0] step=3800, skipped=20, lr=[7.441552205564317e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:40:40,718] [INFO] [timer.py:258:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=4.486629828063726, CurrSamplesPerSec=4.488015438338934, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:40:40,719] [INFO] [RANK 0]  iteration     3800/   10000 | elapsed time per iteration (ms): 906.5 | learning rate 7.440E-05 | total loss 2.759101E-01 | loss 2.759101E-01 | loss scale 32768.0 |speed 264.76 samples/(min*GPU)
[2024-06-17 19:40:40,721] [INFO] [RANK 0] time (ms) | forward: 355.07 | backward: 547.28 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 13.05 | data loader: 0.12
[2024-06-17 19:40:49,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=3810, skipped=20, lr=[7.428789026988078e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:40:49,803] [INFO] [timer.py:258:stop] epoch=0/micro_step=3810/global_step=3810, RunningAvgSamplesPerSec=4.486606469515559, CurrSamplesPerSec=4.474112775951626, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:40:58,879] [INFO] [logging.py:96:log_dist] [Rank 0] step=3820, skipped=20, lr=[7.416006812042828e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:40:58,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=3820/global_step=3820, RunningAvgSamplesPerSec=4.486581513049346, CurrSamplesPerSec=4.476452567076551, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:41:07,938] [INFO] [logging.py:96:log_dist] [Rank 0] step=3830, skipped=20, lr=[7.403205686883864e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:41:07,939] [INFO] [timer.py:258:stop] epoch=0/micro_step=3830/global_step=3830, RunningAvgSamplesPerSec=4.486562808144944, CurrSamplesPerSec=4.4789490503079055, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:41:16,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=3840, skipped=20, lr=[7.39038577785313e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:41:17,000] [INFO] [timer.py:258:stop] epoch=0/micro_step=3840/global_step=3840, RunningAvgSamplesPerSec=4.486536112794836, CurrSamplesPerSec=4.46939408881824, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:41:26,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=3850, skipped=20, lr=[7.377547211477944e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:41:26,055] [INFO] [timer.py:258:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=4.4865059659379485, CurrSamplesPerSec=4.470294387623916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:41:26,067] [INFO] [RANK 0]  iteration     3850/   10000 | elapsed time per iteration (ms): 907.0 | learning rate 7.376E-05 | total loss 2.436959E-01 | loss 2.436959E-01 | loss scale 32768.0 |speed 264.62 samples/(min*GPU)
[2024-06-17 19:41:26,079] [INFO] [RANK 0] time (ms) | forward: 355.60 | backward: 547.05 | allreduce: 0.00 | optimizer: 3.51 | batch generator: 12.77 | data loader: 0.13
[2024-06-17 19:41:35,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=3860, skipped=20, lr=[7.36469011446978e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:41:35,160] [INFO] [timer.py:258:stop] epoch=0/micro_step=3860/global_step=3860, RunningAvgSamplesPerSec=4.486490977978465, CurrSamplesPerSec=4.4767846335952255, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:41:44,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=3870, skipped=20, lr=[7.35181461372299e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:41:44,209] [INFO] [timer.py:258:stop] epoch=0/micro_step=3870/global_step=3870, RunningAvgSamplesPerSec=4.486484145782384, CurrSamplesPerSec=4.482446892358003, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:41:53,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=3880, skipped=20, lr=[7.338920836313572e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:41:53,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=3880/global_step=3880, RunningAvgSamplesPerSec=4.486467426324928, CurrSamplesPerSec=4.480458567441423, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:42:02,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=3890, skipped=20, lr=[7.3260089094979e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:42:02,324] [INFO] [timer.py:258:stop] epoch=0/micro_step=3890/global_step=3890, RunningAvgSamplesPerSec=4.486457361934565, CurrSamplesPerSec=4.472165215015427, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:42:11,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=3900, skipped=20, lr=[7.313078960711483e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:42:11,387] [INFO] [timer.py:258:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=4.486444862964969, CurrSamplesPerSec=4.476513482064693, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:42:11,388] [INFO] [RANK 0]  iteration     3900/   10000 | elapsed time per iteration (ms): 906.4 | learning rate 7.312E-05 | total loss 2.542789E-01 | loss 2.542789E-01 | loss scale 32768.0 |speed 264.77 samples/(min*GPU)
[2024-06-17 19:42:11,389] [INFO] [RANK 0] time (ms) | forward: 355.11 | backward: 546.88 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 13.00 | data loader: 0.09
[2024-06-17 19:42:11,390] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:42:11,402] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/3900/mp_rank_00_model_states.pt
[2024-06-17 19:42:11,403] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/3900/mp_rank_00_model_states.pt...
[2024-06-17 19:42:32,621] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/3900/mp_rank_00_model_states.pt.
[2024-06-17 19:42:41,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=3910, skipped=20, lr=[7.300131117567692e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:42:41,624] [INFO] [timer.py:258:stop] epoch=0/micro_step=3910/global_step=3910, RunningAvgSamplesPerSec=4.4865373814087235, CurrSamplesPerSec=4.518722276822785, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:42:50,614] [INFO] [logging.py:96:log_dist] [Rank 0] step=3920, skipped=20, lr=[7.287165507856512e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:42:50,615] [INFO] [timer.py:258:stop] epoch=0/micro_step=3920/global_step=3920, RunningAvgSamplesPerSec=4.486623105459676, CurrSamplesPerSec=4.5158895248431286, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:42:59,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=3930, skipped=20, lr=[7.274182259543281e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:42:59,588] [INFO] [timer.py:258:stop] epoch=0/micro_step=3930/global_step=3930, RunningAvgSamplesPerSec=4.486688117337996, CurrSamplesPerSec=4.5066049641050325, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:43:08,565] [INFO] [logging.py:96:log_dist] [Rank 0] step=3940, skipped=20, lr=[7.261181500767411e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:43:08,566] [INFO] [timer.py:258:stop] epoch=0/micro_step=3940/global_step=3940, RunningAvgSamplesPerSec=4.486743442758741, CurrSamplesPerSec=4.513221791449173, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:43:17,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=3950, skipped=20, lr=[7.248163359841149e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:43:17,600] [INFO] [timer.py:258:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=4.486772207829459, CurrSamplesPerSec=4.492395800224978, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:43:17,601] [INFO] [RANK 0]  iteration     3950/   10000 | elapsed time per iteration (ms): 1324.3 | learning rate 7.247E-05 | total loss 2.744946E-01 | loss 2.744946E-01 | loss scale 32768.0 |speed 181.23 samples/(min*GPU)
[2024-06-17 19:43:17,602] [INFO] [RANK 0] time (ms) | forward: 351.84 | backward: 543.43 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 12.37 | data loader: 0.09
[2024-06-17 19:43:26,648] [INFO] [logging.py:96:log_dist] [Rank 0] step=3960, skipped=20, lr=[7.235127965248285e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:43:26,649] [INFO] [timer.py:258:stop] epoch=0/micro_step=3960/global_step=3960, RunningAvgSamplesPerSec=4.486766265341419, CurrSamplesPerSec=4.487516055294944, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:43:35,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=3970, skipped=20, lr=[7.222075445642905e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:43:35,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=3970/global_step=3970, RunningAvgSamplesPerSec=4.486750055397674, CurrSamplesPerSec=4.475543816789169, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:43:44,739] [INFO] [logging.py:96:log_dist] [Rank 0] step=3980, skipped=20, lr=[7.209005929848107e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:43:44,740] [INFO] [timer.py:258:stop] epoch=0/micro_step=3980/global_step=3980, RunningAvgSamplesPerSec=4.486731607527032, CurrSamplesPerSec=4.469227406610813, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:43:53,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=3990, skipped=20, lr=[7.195919546854733e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:43:53,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=3990/global_step=3990, RunningAvgSamplesPerSec=4.4867127327182, CurrSamplesPerSec=4.48102579634872, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:44:02,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=4000, skipped=20, lr=[7.182816425820103e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:44:02,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=4.486697965652751, CurrSamplesPerSec=4.4920758467482065, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:44:02,879] [INFO] [RANK 0]  iteration     4000/   10000 | elapsed time per iteration (ms): 905.6 | learning rate 7.182E-05 | total loss 2.892812E-01 | loss 2.892812E-01 | loss scale 32768.0 |speed 265.03 samples/(min*GPU)
[2024-06-17 19:44:02,881] [INFO] [RANK 0] time (ms) | forward: 354.69 | backward: 546.74 | allreduce: 0.00 | optimizer: 3.38 | batch generator: 12.29 | data loader: 0.19
[2024-06-17 19:44:09,510] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 19:44:09,510] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 19:44:09,510] [INFO] [RANK 0]  validation loss at iteration 4000 | loss: 8.881348E-01 | PPL: 2.430592E+00 loss 8.876953E-01 |
[2024-06-17 19:44:09,510] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 19:44:18,574] [INFO] [logging.py:96:log_dist] [Rank 0] step=4010, skipped=20, lr=[7.16969669606673e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:44:18,574] [INFO] [timer.py:258:stop] epoch=0/micro_step=4010/global_step=4010, RunningAvgSamplesPerSec=4.486666989586907, CurrSamplesPerSec=4.48240856960722, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:44:27,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=4020, skipped=20, lr=[7.156560487081053e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:44:27,642] [INFO] [timer.py:258:stop] epoch=0/micro_step=4020/global_step=4020, RunningAvgSamplesPerSec=4.486651761870851, CurrSamplesPerSec=4.484783422259765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:44:28,548] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 19:44:29,459] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 19:44:36,726] [INFO] [logging.py:96:log_dist] [Rank 0] step=4030, skipped=22, lr=[7.146039741963997e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:44:36,727] [INFO] [timer.py:258:stop] epoch=0/micro_step=4030/global_step=4030, RunningAvgSamplesPerSec=4.486638572856484, CurrSamplesPerSec=4.484932083973572, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:44:45,784] [INFO] [logging.py:96:log_dist] [Rank 0] step=4040, skipped=22, lr=[7.132874197184328e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:44:45,785] [INFO] [timer.py:258:stop] epoch=0/micro_step=4040/global_step=4040, RunningAvgSamplesPerSec=4.486622893292058, CurrSamplesPerSec=4.48647563089165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:44:54,853] [INFO] [logging.py:96:log_dist] [Rank 0] step=4050, skipped=22, lr=[7.11969253659555e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:44:54,854] [INFO] [timer.py:258:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=4.486613008538808, CurrSamplesPerSec=4.47492665023632, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:44:54,855] [INFO] [RANK 0]  iteration     4050/   10000 | elapsed time per iteration (ms): 1039.5 | learning rate 7.118E-05 | total loss 2.297783E-01 | loss 2.297783E-01 | loss scale 32768.0 |speed 230.88 samples/(min*GPU)
[2024-06-17 19:44:54,857] [INFO] [RANK 0] time (ms) | forward: 356.01 | backward: 546.84 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 15.99 | data loader: 0.26
[2024-06-17 19:45:03,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=4060, skipped=22, lr=[7.10649489029533e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:45:03,929] [INFO] [timer.py:258:stop] epoch=0/micro_step=4060/global_step=4060, RunningAvgSamplesPerSec=4.48658723820186, CurrSamplesPerSec=4.476808525172484, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:45:12,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=4070, skipped=22, lr=[7.093281388539112e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:45:12,998] [INFO] [timer.py:258:stop] epoch=0/micro_step=4070/global_step=4070, RunningAvgSamplesPerSec=4.486563033845302, CurrSamplesPerSec=4.479936939364219, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:45:22,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=4080, skipped=22, lr=[7.080052161738823e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:45:22,062] [INFO] [timer.py:258:stop] epoch=0/micro_step=4080/global_step=4080, RunningAvgSamplesPerSec=4.4865475940935955, CurrSamplesPerSec=4.4728615147707576, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:45:31,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=4090, skipped=22, lr=[7.06680734046159e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:45:31,102] [INFO] [timer.py:258:stop] epoch=0/micro_step=4090/global_step=4090, RunningAvgSamplesPerSec=4.486535600113066, CurrSamplesPerSec=4.478767307048021, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:45:40,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=4100, skipped=22, lr=[7.053547055428453e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:45:40,177] [INFO] [timer.py:258:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=4.486519338458882, CurrSamplesPerSec=4.486759989645043, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:45:40,178] [INFO] [RANK 0]  iteration     4100/   10000 | elapsed time per iteration (ms): 906.5 | learning rate 7.052E-05 | total loss 2.557498E-01 | loss 2.557498E-01 | loss scale 32768.0 |speed 264.77 samples/(min*GPU)
[2024-06-17 19:45:40,178] [INFO] [RANK 0] time (ms) | forward: 355.23 | backward: 547.02 | allreduce: 0.00 | optimizer: 3.41 | batch generator: 12.84 | data loader: 0.20
[2024-06-17 19:45:49,240] [INFO] [logging.py:96:log_dist] [Rank 0] step=4110, skipped=22, lr=[7.04027143751307e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:45:49,241] [INFO] [timer.py:258:stop] epoch=0/micro_step=4110/global_step=4110, RunningAvgSamplesPerSec=4.48650847530839, CurrSamplesPerSec=4.484043856842789, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:45:58,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=4120, skipped=22, lr=[7.026980617740433e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:45:58,283] [INFO] [timer.py:258:stop] epoch=0/micro_step=4120/global_step=4120, RunningAvgSamplesPerSec=4.4864956747876885, CurrSamplesPerSec=4.478737416476907, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:46:07,364] [INFO] [logging.py:96:log_dist] [Rank 0] step=4130, skipped=22, lr=[7.013674727285566e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:46:07,364] [INFO] [timer.py:258:stop] epoch=0/micro_step=4130/global_step=4130, RunningAvgSamplesPerSec=4.486478693627431, CurrSamplesPerSec=4.477776348399984, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:46:16,422] [INFO] [logging.py:96:log_dist] [Rank 0] step=4140, skipped=22, lr=[7.000353897472236e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:46:16,423] [INFO] [timer.py:258:stop] epoch=0/micro_step=4140/global_step=4140, RunningAvgSamplesPerSec=4.486466638873886, CurrSamplesPerSec=4.4761766787714246, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:46:25,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=4150, skipped=22, lr=[6.987018259771655e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:46:25,485] [INFO] [timer.py:258:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=4.486437992379824, CurrSamplesPerSec=4.463586600100833, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:46:25,487] [INFO] [RANK 0]  iteration     4150/   10000 | elapsed time per iteration (ms): 906.2 | learning rate 6.986E-05 | total loss 2.607298E-01 | loss 2.607298E-01 | loss scale 32768.0 |speed 264.85 samples/(min*GPU)
[2024-06-17 19:46:25,487] [INFO] [RANK 0] time (ms) | forward: 354.83 | backward: 546.98 | allreduce: 0.00 | optimizer: 3.60 | batch generator: 12.44 | data loader: 0.20
[2024-06-17 19:46:34,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=4160, skipped=22, lr=[6.973667945801184e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:46:34,564] [INFO] [timer.py:258:stop] epoch=0/micro_step=4160/global_step=4160, RunningAvgSamplesPerSec=4.486416422081181, CurrSamplesPerSec=4.471003211235327, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:46:43,640] [INFO] [logging.py:96:log_dist] [Rank 0] step=4170, skipped=22, lr=[6.96030308732303e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:46:43,640] [INFO] [timer.py:258:stop] epoch=0/micro_step=4170/global_step=4170, RunningAvgSamplesPerSec=4.486395021983243, CurrSamplesPerSec=4.483846121364021, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:46:52,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=4180, skipped=22, lr=[6.946923816242954e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:46:52,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=4180/global_step=4180, RunningAvgSamplesPerSec=4.4863756863112245, CurrSamplesPerSec=4.458848602285765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:47:01,784] [INFO] [logging.py:96:log_dist] [Rank 0] step=4190, skipped=22, lr=[6.933530264608959e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:47:01,784] [INFO] [timer.py:258:stop] epoch=0/micro_step=4190/global_step=4190, RunningAvgSamplesPerSec=4.486352051746023, CurrSamplesPerSec=4.481588380342169, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:47:10,858] [INFO] [logging.py:96:log_dist] [Rank 0] step=4200, skipped=22, lr=[6.92012256460999e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:47:10,858] [INFO] [timer.py:258:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=4.48633506935958, CurrSamplesPerSec=4.483342873375053, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:47:10,860] [INFO] [RANK 0]  iteration     4200/   10000 | elapsed time per iteration (ms): 907.5 | learning rate 6.919E-05 | total loss 2.055774E-01 | loss 2.055774E-01 | loss scale 32768.0 |speed 264.47 samples/(min*GPU)
[2024-06-17 19:47:10,861] [INFO] [RANK 0] time (ms) | forward: 356.14 | backward: 547.08 | allreduce: 0.00 | optimizer: 3.42 | batch generator: 13.52 | data loader: 0.22
[2024-06-17 19:47:10,861] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:47:10,874] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/4200/mp_rank_00_model_states.pt
[2024-06-17 19:47:10,874] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/4200/mp_rank_00_model_states.pt...
[2024-06-17 19:47:32,271] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/4200/mp_rank_00_model_states.pt.
[2024-06-17 19:47:41,277] [INFO] [logging.py:96:log_dist] [Rank 0] step=4210, skipped=22, lr=[6.906700848574636e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:47:41,277] [INFO] [timer.py:258:stop] epoch=0/micro_step=4210/global_step=4210, RunningAvgSamplesPerSec=4.4863992778593715, CurrSamplesPerSec=4.523345739099301, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:47:50,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=4220, skipped=22, lr=[6.893265248969816e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:47:50,268] [INFO] [timer.py:258:stop] epoch=0/micro_step=4220/global_step=4220, RunningAvgSamplesPerSec=4.48646293712967, CurrSamplesPerSec=4.513499836836001, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:47:59,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=4230, skipped=22, lr=[6.87981589839947e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:47:59,261] [INFO] [timer.py:258:stop] epoch=0/micro_step=4230/global_step=4230, RunningAvgSamplesPerSec=4.486507486067328, CurrSamplesPerSec=4.5053862801381275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:48:08,265] [INFO] [logging.py:96:log_dist] [Rank 0] step=4240, skipped=22, lr=[6.866352929603261e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:48:08,266] [INFO] [timer.py:258:stop] epoch=0/micro_step=4240/global_step=4240, RunningAvgSamplesPerSec=4.486542510161674, CurrSamplesPerSec=4.49622554537171, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:48:17,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=4250, skipped=22, lr=[6.852876475455258e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:48:17,326] [INFO] [timer.py:258:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=4.486552796643031, CurrSamplesPerSec=4.501089240450634, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:48:17,327] [INFO] [RANK 0]  iteration     4250/   10000 | elapsed time per iteration (ms): 1329.3 | learning rate 6.852E-05 | total loss 2.850838E-01 | loss 2.850838E-01 | loss scale 32768.0 |speed 180.54 samples/(min*GPU)
[2024-06-17 19:48:17,327] [INFO] [RANK 0] time (ms) | forward: 352.92 | backward: 543.81 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.39 | data loader: 0.13
[2024-06-17 19:48:26,377] [INFO] [logging.py:96:log_dist] [Rank 0] step=4260, skipped=22, lr=[6.839386668962619e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:48:26,377] [INFO] [timer.py:258:stop] epoch=0/micro_step=4260/global_step=4260, RunningAvgSamplesPerSec=4.4865516123015325, CurrSamplesPerSec=4.484747457196701, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:48:35,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=4270, skipped=22, lr=[6.82588364326429e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:48:35,453] [INFO] [timer.py:258:stop] epoch=0/micro_step=4270/global_step=4270, RunningAvgSamplesPerSec=4.48653389035748, CurrSamplesPerSec=4.488079069641774, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:48:44,522] [INFO] [logging.py:96:log_dist] [Rank 0] step=4280, skipped=22, lr=[6.812367531629683e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:48:44,522] [INFO] [timer.py:258:stop] epoch=0/micro_step=4280/global_step=4280, RunningAvgSamplesPerSec=4.4865292200811435, CurrSamplesPerSec=4.479006445980706, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:48:53,608] [INFO] [logging.py:96:log_dist] [Rank 0] step=4290, skipped=22, lr=[6.798838467457363e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:48:53,609] [INFO] [timer.py:258:stop] epoch=0/micro_step=4290/global_step=4290, RunningAvgSamplesPerSec=4.486511099058903, CurrSamplesPerSec=4.486467232657916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:49:02,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=4300, skipped=22, lr=[6.785296584273732e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:49:02,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=4.4864914451475615, CurrSamplesPerSec=4.4633894772631315, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:49:02,685] [INFO] [RANK 0]  iteration     4300/   10000 | elapsed time per iteration (ms): 907.2 | learning rate 6.784E-05 | total loss 2.752182E-01 | loss 2.752182E-01 | loss scale 32768.0 |speed 264.56 samples/(min*GPU)
[2024-06-17 19:49:02,686] [INFO] [RANK 0] time (ms) | forward: 356.23 | backward: 546.76 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 13.96 | data loader: 0.19
[2024-06-17 19:49:11,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=4310, skipped=22, lr=[6.771742015731709e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:49:11,743] [INFO] [timer.py:258:stop] epoch=0/micro_step=4310/global_step=4310, RunningAvgSamplesPerSec=4.486473099944309, CurrSamplesPerSec=4.490428687627084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:49:20,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=4320, skipped=22, lr=[6.758174895609414e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:49:20,792] [INFO] [timer.py:258:stop] epoch=0/micro_step=4320/global_step=4320, RunningAvgSamplesPerSec=4.48646436305095, CurrSamplesPerSec=4.4867347918443405, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:49:29,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=4330, skipped=22, lr=[6.744595357808844e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:49:29,880] [INFO] [timer.py:258:stop] epoch=0/micro_step=4330/global_step=4330, RunningAvgSamplesPerSec=4.486428999968714, CurrSamplesPerSec=4.484619186502639, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:49:38,945] [INFO] [logging.py:96:log_dist] [Rank 0] step=4340, skipped=22, lr=[6.731003536354558e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:49:38,945] [INFO] [timer.py:258:stop] epoch=0/micro_step=4340/global_step=4340, RunningAvgSamplesPerSec=4.486399339101352, CurrSamplesPerSec=4.468447737120052, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:49:48,020] [INFO] [logging.py:96:log_dist] [Rank 0] step=4350, skipped=22, lr=[6.717399565392343e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:49:48,020] [INFO] [timer.py:258:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=4.486376045580706, CurrSamplesPerSec=4.478825893724759, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:49:48,022] [INFO] [RANK 0]  iteration     4350/   10000 | elapsed time per iteration (ms): 906.7 | learning rate 6.716E-05 | total loss 2.348830E-01 | loss 2.348830E-01 | loss scale 32768.0 |speed 264.68 samples/(min*GPU)
[2024-06-17 19:49:48,023] [INFO] [RANK 0] time (ms) | forward: 355.53 | backward: 547.10 | allreduce: 0.00 | optimizer: 3.32 | batch generator: 12.64 | data loader: 0.16
[2024-06-17 19:49:57,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=4360, skipped=22, lr=[6.703783579187901e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:49:57,090] [INFO] [timer.py:258:stop] epoch=0/micro_step=4360/global_step=4360, RunningAvgSamplesPerSec=4.486356926788833, CurrSamplesPerSec=4.485007617491011, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:50:06,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=4370, skipped=22, lr=[6.69015571212552e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:50:06,174] [INFO] [timer.py:258:stop] epoch=0/micro_step=4370/global_step=4370, RunningAvgSamplesPerSec=4.486334547429279, CurrSamplesPerSec=4.473496003982552, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:50:15,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=4380, skipped=22, lr=[6.676516098706746e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:50:15,252] [INFO] [timer.py:258:stop] epoch=0/micro_step=4380/global_step=4380, RunningAvgSamplesPerSec=4.486307955801469, CurrSamplesPerSec=4.480555488790076, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:50:24,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=4390, skipped=22, lr=[6.662864873549055e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:50:24,328] [INFO] [timer.py:258:stop] epoch=0/micro_step=4390/global_step=4390, RunningAvgSamplesPerSec=4.486282935762368, CurrSamplesPerSec=4.469829902475999, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:50:33,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=4400, skipped=22, lr=[6.649202171384532e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:50:33,395] [INFO] [timer.py:258:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=4.486280067630704, CurrSamplesPerSec=4.484462154802165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:50:33,396] [INFO] [RANK 0]  iteration     4400/   10000 | elapsed time per iteration (ms): 907.5 | learning rate 6.648E-05 | total loss 2.594693E-01 | loss 2.594693E-01 | loss scale 32768.0 |speed 264.47 samples/(min*GPU)
[2024-06-17 19:50:33,397] [INFO] [RANK 0] time (ms) | forward: 356.21 | backward: 547.13 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 13.65 | data loader: 0.22
[2024-06-17 19:50:42,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=4410, skipped=22, lr=[6.63552812705853e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:50:42,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=4410/global_step=4410, RunningAvgSamplesPerSec=4.486263001898365, CurrSamplesPerSec=4.471058020405052, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:50:51,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=4420, skipped=22, lr=[6.621842875528342e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:50:51,559] [INFO] [timer.py:258:stop] epoch=0/micro_step=4420/global_step=4420, RunningAvgSamplesPerSec=4.486246487101808, CurrSamplesPerSec=4.472886556985446, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:50:54,285] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 19:50:55,184] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 19:51:00,616] [INFO] [logging.py:96:log_dist] [Rank 0] step=4430, skipped=24, lr=[6.610886695879134e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:51:00,617] [INFO] [timer.py:258:stop] epoch=0/micro_step=4430/global_step=4430, RunningAvgSamplesPerSec=4.486240689188612, CurrSamplesPerSec=4.466020006724099, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:51:09,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=4440, skipped=24, lr=[6.597181611826025e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:51:09,683] [INFO] [timer.py:258:stop] epoch=0/micro_step=4440/global_step=4440, RunningAvgSamplesPerSec=4.4862292209823975, CurrSamplesPerSec=4.4565023136219475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:51:18,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=4450, skipped=24, lr=[6.583465699033356e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:51:18,738] [INFO] [timer.py:258:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=4.486212282631541, CurrSamplesPerSec=4.472439416780295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:51:18,740] [INFO] [RANK 0]  iteration     4450/   10000 | elapsed time per iteration (ms): 906.9 | learning rate 6.582E-05 | total loss 3.070340E-01 | loss 3.070340E-01 | loss scale 32768.0 |speed 264.64 samples/(min*GPU)
[2024-06-17 19:51:18,740] [INFO] [RANK 0] time (ms) | forward: 355.63 | backward: 547.06 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 13.48 | data loader: 0.11
[2024-06-17 19:51:27,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=4460, skipped=24, lr=[6.569739092871651e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:51:27,818] [INFO] [timer.py:258:stop] epoch=0/micro_step=4460/global_step=4460, RunningAvgSamplesPerSec=4.486203779942046, CurrSamplesPerSec=4.489573122743301, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:51:36,894] [INFO] [logging.py:96:log_dist] [Rank 0] step=4470, skipped=24, lr=[6.556001928816972e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:51:36,895] [INFO] [timer.py:258:stop] epoch=0/micro_step=4470/global_step=4470, RunningAvgSamplesPerSec=4.486184804639713, CurrSamplesPerSec=4.47593664778351, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:51:45,941] [INFO] [logging.py:96:log_dist] [Rank 0] step=4480, skipped=24, lr=[6.54225434244958e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:51:45,942] [INFO] [timer.py:258:stop] epoch=0/micro_step=4480/global_step=4480, RunningAvgSamplesPerSec=4.486172374544224, CurrSamplesPerSec=4.482209780853567, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:51:55,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=4490, skipped=24, lr=[6.528496469452602e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:51:55,028] [INFO] [timer.py:258:stop] epoch=0/micro_step=4490/global_step=4490, RunningAvgSamplesPerSec=4.486147426795279, CurrSamplesPerSec=4.487249603087997, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:52:04,087] [INFO] [logging.py:96:log_dist] [Rank 0] step=4500, skipped=24, lr=[6.514728445610694e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:52:04,088] [INFO] [timer.py:258:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=4.486142384429278, CurrSamplesPerSec=4.489056577117692, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:52:04,089] [INFO] [RANK 0]  iteration     4500/   10000 | elapsed time per iteration (ms): 907.0 | learning rate 6.513E-05 | total loss 2.561394E-01 | loss 2.561394E-01 | loss scale 32768.0 |speed 264.61 samples/(min*GPU)
[2024-06-17 19:52:04,090] [INFO] [RANK 0] time (ms) | forward: 355.75 | backward: 547.06 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 13.57 | data loader: 0.09
[2024-06-17 19:52:04,090] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:52:04,103] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/4500/mp_rank_00_model_states.pt
[2024-06-17 19:52:04,103] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/4500/mp_rank_00_model_states.pt...
[2024-06-17 19:52:25,149] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/4500/mp_rank_00_model_states.pt.
[2024-06-17 19:52:34,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=4510, skipped=24, lr=[6.500950406808689e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:52:34,143] [INFO] [timer.py:258:stop] epoch=0/micro_step=4510/global_step=4510, RunningAvgSamplesPerSec=4.4862259443074555, CurrSamplesPerSec=4.513122237674953, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:52:43,129] [INFO] [logging.py:96:log_dist] [Rank 0] step=4520, skipped=24, lr=[6.487162489030268e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:52:43,129] [INFO] [timer.py:258:stop] epoch=0/micro_step=4520/global_step=4520, RunningAvgSamplesPerSec=4.486292848816756, CurrSamplesPerSec=4.512163346977855, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:52:52,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=4530, skipped=24, lr=[6.473364828356614e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:52:52,155] [INFO] [timer.py:258:stop] epoch=0/micro_step=4530/global_step=4530, RunningAvgSamplesPerSec=4.486335810595979, CurrSamplesPerSec=4.505792838253063, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:53:01,207] [INFO] [logging.py:96:log_dist] [Rank 0] step=4540, skipped=24, lr=[6.459557560965068e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:53:01,208] [INFO] [timer.py:258:stop] epoch=0/micro_step=4540/global_step=4540, RunningAvgSamplesPerSec=4.486343878002401, CurrSamplesPerSec=4.488708276245308, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:53:10,246] [INFO] [logging.py:96:log_dist] [Rank 0] step=4550, skipped=24, lr=[6.445740823127784e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:53:10,247] [INFO] [timer.py:258:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=4.486352088541824, CurrSamplesPerSec=4.489304023677917, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:53:10,247] [INFO] [RANK 0]  iteration     4550/   10000 | elapsed time per iteration (ms): 1323.2 | learning rate 6.444E-05 | total loss 2.538742E-01 | loss 2.538742E-01 | loss scale 32768.0 |speed 181.38 samples/(min*GPU)
[2024-06-17 19:53:10,248] [INFO] [RANK 0] time (ms) | forward: 353.52 | backward: 544.03 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 13.30 | data loader: 0.11
[2024-06-17 19:53:19,306] [INFO] [logging.py:96:log_dist] [Rank 0] step=4560, skipped=24, lr=[6.431914751210387e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:53:19,307] [INFO] [timer.py:258:stop] epoch=0/micro_step=4560/global_step=4560, RunningAvgSamplesPerSec=4.486350273951654, CurrSamplesPerSec=4.474787005601347, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:53:28,345] [INFO] [logging.py:96:log_dist] [Rank 0] step=4570, skipped=24, lr=[6.418079481670624e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:53:28,345] [INFO] [timer.py:258:stop] epoch=0/micro_step=4570/global_step=4570, RunningAvgSamplesPerSec=4.486344502950802, CurrSamplesPerSec=4.48228522270208, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:53:37,397] [INFO] [logging.py:96:log_dist] [Rank 0] step=4580, skipped=24, lr=[6.404235151057021e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:53:37,397] [INFO] [timer.py:258:stop] epoch=0/micro_step=4580/global_step=4580, RunningAvgSamplesPerSec=4.4863338688530545, CurrSamplesPerSec=4.483336883007979, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:53:46,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=4590, skipped=24, lr=[6.390381896007532e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:53:46,461] [INFO] [timer.py:258:stop] epoch=0/micro_step=4590/global_step=4590, RunningAvgSamplesPerSec=4.486322062666884, CurrSamplesPerSec=4.461651749919887, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:53:55,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=4600, skipped=24, lr=[6.376519853248191e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:53:55,535] [INFO] [timer.py:258:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=4.486310641338278, CurrSamplesPerSec=4.488898033466836, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:53:55,536] [INFO] [RANK 0]  iteration     4600/   10000 | elapsed time per iteration (ms): 905.8 | learning rate 6.375E-05 | total loss 2.684877E-01 | loss 2.684877E-01 | loss scale 32768.0 |speed 264.96 samples/(min*GPU)
[2024-06-17 19:53:55,537] [INFO] [RANK 0] time (ms) | forward: 354.78 | backward: 546.83 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 12.88 | data loader: 0.10
[2024-06-17 19:54:04,596] [INFO] [logging.py:96:log_dist] [Rank 0] step=4610, skipped=24, lr=[6.362649159591764e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:54:04,597] [INFO] [timer.py:258:stop] epoch=0/micro_step=4610/global_step=4610, RunningAvgSamplesPerSec=4.486298181149853, CurrSamplesPerSec=4.480055371778124, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:54:13,655] [INFO] [logging.py:96:log_dist] [Rank 0] step=4620, skipped=24, lr=[6.348769951936398e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:54:13,655] [INFO] [timer.py:258:stop] epoch=0/micro_step=4620/global_step=4620, RunningAvgSamplesPerSec=4.486281135648089, CurrSamplesPerSec=4.475795746061286, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:54:22,706] [INFO] [logging.py:96:log_dist] [Rank 0] step=4630, skipped=24, lr=[6.334882367264267e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:54:22,706] [INFO] [timer.py:258:stop] epoch=0/micro_step=4630/global_step=4630, RunningAvgSamplesPerSec=4.486265295401655, CurrSamplesPerSec=4.488818765840896, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:54:31,769] [INFO] [logging.py:96:log_dist] [Rank 0] step=4640, skipped=24, lr=[6.320986542640226e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:54:31,770] [INFO] [timer.py:258:stop] epoch=0/micro_step=4640/global_step=4640, RunningAvgSamplesPerSec=4.48624964177679, CurrSamplesPerSec=4.477905423114844, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:54:40,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=4650, skipped=24, lr=[6.307082615210458e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:54:40,838] [INFO] [timer.py:258:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=4.486238965085518, CurrSamplesPerSec=4.481959523700757, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:54:40,839] [INFO] [RANK 0]  iteration     4650/   10000 | elapsed time per iteration (ms): 906.1 | learning rate 6.306E-05 | total loss 2.500465E-01 | loss 2.500465E-01 | loss scale 32768.0 |speed 264.88 samples/(min*GPU)
[2024-06-17 19:54:40,841] [INFO] [RANK 0] time (ms) | forward: 354.85 | backward: 547.07 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 12.47 | data loader: 0.09
[2024-06-17 19:54:49,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=4660, skipped=24, lr=[6.293170722201108e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:54:49,910] [INFO] [timer.py:258:stop] epoch=0/micro_step=4660/global_step=4660, RunningAvgSamplesPerSec=4.486229134204067, CurrSamplesPerSec=4.458040565335082, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:54:58,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=4670, skipped=24, lr=[6.279251000916945e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:54:58,991] [INFO] [timer.py:258:stop] epoch=0/micro_step=4670/global_step=4670, RunningAvgSamplesPerSec=4.4862161426656115, CurrSamplesPerSec=4.4766532344784045, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:55:08,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=4680, skipped=24, lr=[6.265323588740001e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:55:08,050] [INFO] [timer.py:258:stop] epoch=0/micro_step=4680/global_step=4680, RunningAvgSamplesPerSec=4.486201760963423, CurrSamplesPerSec=4.486317269491911, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:55:17,116] [INFO] [logging.py:96:log_dist] [Rank 0] step=4690, skipped=24, lr=[6.25138862312821e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:55:17,117] [INFO] [timer.py:258:stop] epoch=0/micro_step=4690/global_step=4690, RunningAvgSamplesPerSec=4.486178823235977, CurrSamplesPerSec=4.481071276614782, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:55:26,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=4700, skipped=24, lr=[6.237446241614057e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:55:26,182] [INFO] [timer.py:258:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=4.486158743598383, CurrSamplesPerSec=4.477399922980212, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:55:26,183] [INFO] [RANK 0]  iteration     4700/   10000 | elapsed time per iteration (ms): 906.9 | learning rate 6.236E-05 | total loss 2.899376E-01 | loss 2.899376E-01 | loss scale 32768.0 |speed 264.65 samples/(min*GPU)
[2024-06-17 19:55:26,184] [INFO] [RANK 0] time (ms) | forward: 355.60 | backward: 547.07 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 13.17 | data loader: 0.10
[2024-06-17 19:55:35,248] [INFO] [logging.py:96:log_dist] [Rank 0] step=4710, skipped=24, lr=[6.223496581803217e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:55:35,248] [INFO] [timer.py:258:stop] epoch=0/micro_step=4710/global_step=4710, RunningAvgSamplesPerSec=4.48613388440972, CurrSamplesPerSec=4.47071250680178, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:55:44,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=4720, skipped=24, lr=[6.209539781373202e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:55:44,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=4720/global_step=4720, RunningAvgSamplesPerSec=4.486106038682415, CurrSamplesPerSec=4.484594012741782, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:55:53,387] [INFO] [logging.py:96:log_dist] [Rank 0] step=4730, skipped=24, lr=[6.195575978071999e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:55:53,389] [INFO] [timer.py:258:stop] epoch=0/micro_step=4730/global_step=4730, RunningAvgSamplesPerSec=4.486094297874875, CurrSamplesPerSec=4.47686706061451, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:56:02,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=4740, skipped=24, lr=[6.181605309716706e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:56:02,472] [INFO] [timer.py:258:stop] epoch=0/micro_step=4740/global_step=4740, RunningAvgSamplesPerSec=4.486066932470609, CurrSamplesPerSec=4.482097221546916, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:56:11,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=4750, skipped=24, lr=[6.167627914192183e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:56:11,539] [INFO] [timer.py:258:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=4.486046035974061, CurrSamplesPerSec=4.476717738535513, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:56:11,541] [INFO] [RANK 0]  iteration     4750/   10000 | elapsed time per iteration (ms): 907.1 | learning rate 6.166E-05 | total loss 2.642199E-01 | loss 2.642199E-01 | loss scale 32768.0 |speed 264.57 samples/(min*GPU)
[2024-06-17 19:56:11,541] [INFO] [RANK 0] time (ms) | forward: 355.61 | backward: 547.26 | allreduce: 0.00 | optimizer: 3.49 | batch generator: 12.73 | data loader: 0.10
[2024-06-17 19:56:20,606] [INFO] [logging.py:96:log_dist] [Rank 0] step=4760, skipped=24, lr=[6.153643929449678e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:56:20,607] [INFO] [timer.py:258:stop] epoch=0/micro_step=4760/global_step=4760, RunningAvgSamplesPerSec=4.486022964375177, CurrSamplesPerSec=4.4819140254026175, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:56:24,226] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
[2024-06-17 19:56:29,649] [INFO] [logging.py:96:log_dist] [Rank 0] step=4770, skipped=25, lr=[6.141052823469188e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:56:29,649] [INFO] [timer.py:258:stop] epoch=0/micro_step=4770/global_step=4770, RunningAvgSamplesPerSec=4.486020957411285, CurrSamplesPerSec=4.4820672865128035, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:56:38,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=4780, skipped=25, lr=[6.127056699500034e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:56:38,730] [INFO] [timer.py:258:stop] epoch=0/micro_step=4780/global_step=4780, RunningAvgSamplesPerSec=4.486005643321964, CurrSamplesPerSec=4.480210898599582, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:56:47,770] [INFO] [logging.py:96:log_dist] [Rank 0] step=4790, skipped=25, lr=[6.113054386734407e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:56:47,770] [INFO] [timer.py:258:stop] epoch=0/micro_step=4790/global_step=4790, RunningAvgSamplesPerSec=4.485991315971028, CurrSamplesPerSec=4.480210898599582, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:56:56,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=4800, skipped=25, lr=[6.099046023369486e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:56:56,812] [INFO] [timer.py:258:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=4.485976046197411, CurrSamplesPerSec=4.47290921446893, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:56:56,814] [INFO] [RANK 0]  iteration     4800/   10000 | elapsed time per iteration (ms): 905.5 | learning rate 6.098E-05 | total loss 2.612488E-01 | loss 2.612488E-01 | loss scale 16384.0 |speed 265.06 samples/(min*GPU)
[2024-06-17 19:56:56,814] [INFO] [RANK 0] time (ms) | forward: 354.14 | backward: 547.20 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 11.91 | data loader: 0.09
[2024-06-17 19:56:56,815] [INFO] [RANK 0] Saving Model...
[2024-06-17 19:56:56,828] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/4800/mp_rank_00_model_states.pt
[2024-06-17 19:56:56,828] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/4800/mp_rank_00_model_states.pt...
[2024-06-17 19:57:17,656] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/4800/mp_rank_00_model_states.pt.
[2024-06-17 19:57:26,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=4810, skipped=25, lr=[6.0850317476621586e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:57:26,672] [INFO] [timer.py:258:stop] epoch=0/micro_step=4810/global_step=4810, RunningAvgSamplesPerSec=4.486040084106697, CurrSamplesPerSec=4.511737438924791, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:57:35,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=4820, skipped=25, lr=[6.071011697927667e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:57:35,682] [INFO] [timer.py:258:stop] epoch=0/micro_step=4820/global_step=4820, RunningAvgSamplesPerSec=4.486088611458824, CurrSamplesPerSec=4.510073407038764, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:57:44,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=4830, skipped=25, lr=[6.0569860125382447e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:57:44,709] [INFO] [timer.py:258:stop] epoch=0/micro_step=4830/global_step=4830, RunningAvgSamplesPerSec=4.4861193779368875, CurrSamplesPerSec=4.4862272964043255, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:57:53,737] [INFO] [logging.py:96:log_dist] [Rank 0] step=4840, skipped=25, lr=[6.0429548299217444e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:57:53,738] [INFO] [timer.py:258:stop] epoch=0/micro_step=4840/global_step=4840, RunningAvgSamplesPerSec=4.486135166313836, CurrSamplesPerSec=4.482606178312823, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:58:02,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=4850, skipped=25, lr=[6.0289182885602704e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:58:02,775] [INFO] [timer.py:258:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=4.486129851406089, CurrSamplesPerSec=4.466704880458544, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:58:02,776] [INFO] [RANK 0]  iteration     4850/   10000 | elapsed time per iteration (ms): 1319.2 | learning rate 6.028E-05 | total loss 2.889012E-01 | loss 2.889012E-01 | loss scale 16384.0 |speed 181.92 samples/(min*GPU)
[2024-06-17 19:58:02,776] [INFO] [RANK 0] time (ms) | forward: 353.46 | backward: 544.48 | allreduce: 0.00 | optimizer: 3.38 | batch generator: 12.76 | data loader: 0.11
[2024-06-17 19:58:11,813] [INFO] [logging.py:96:log_dist] [Rank 0] step=4860, skipped=25, lr=[6.014876526988822e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:58:11,814] [INFO] [timer.py:258:stop] epoch=0/micro_step=4860/global_step=4860, RunningAvgSamplesPerSec=4.486126131058463, CurrSamplesPerSec=4.481450713758734, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:58:20,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=4870, skipped=25, lr=[6.0008296837939156e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:58:20,879] [INFO] [timer.py:258:stop] epoch=0/micro_step=4870/global_step=4870, RunningAvgSamplesPerSec=4.486109109879077, CurrSamplesPerSec=4.476658012492963, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:58:29,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=4880, skipped=25, lr=[5.986777897612224e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:58:29,927] [INFO] [timer.py:258:stop] epoch=0/micro_step=4880/global_step=4880, RunningAvgSamplesPerSec=4.486105847927982, CurrSamplesPerSec=4.48885119316768, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:58:38,974] [INFO] [logging.py:96:log_dist] [Rank 0] step=4890, skipped=25, lr=[5.972721307129203e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:58:38,975] [INFO] [timer.py:258:stop] epoch=0/micro_step=4890/global_step=4890, RunningAvgSamplesPerSec=4.486089493885649, CurrSamplesPerSec=4.467863460953102, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:58:48,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=4900, skipped=25, lr=[5.9586600510777255e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:58:48,058] [INFO] [timer.py:258:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=4.486065490351048, CurrSamplesPerSec=4.477411872020846, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:58:48,059] [INFO] [RANK 0]  iteration     4900/   10000 | elapsed time per iteration (ms): 905.7 | learning rate 5.957E-05 | total loss 2.393543E-01 | loss 2.393543E-01 | loss scale 16384.0 |speed 265.00 samples/(min*GPU)
[2024-06-17 19:58:48,060] [INFO] [RANK 0] time (ms) | forward: 354.35 | backward: 547.15 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 12.22 | data loader: 0.10
[2024-06-17 19:58:57,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=4910, skipped=25, lr=[5.944594268236713e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:58:57,132] [INFO] [timer.py:258:stop] epoch=0/micro_step=4910/global_step=4910, RunningAvgSamplesPerSec=4.486046365853889, CurrSamplesPerSec=4.471193857617615, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:59:06,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=4920, skipped=25, lr=[5.9305240974297634e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:59:06,200] [INFO] [timer.py:258:stop] epoch=0/micro_step=4920/global_step=4920, RunningAvgSamplesPerSec=4.486030603923258, CurrSamplesPerSec=4.473418472151415, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:59:15,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=4930, skipped=25, lr=[5.916449677523782e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:59:15,257] [INFO] [timer.py:258:stop] epoch=0/micro_step=4930/global_step=4930, RunningAvgSamplesPerSec=4.486019568270128, CurrSamplesPerSec=4.486667599092783, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:59:24,324] [INFO] [logging.py:96:log_dist] [Rank 0] step=4940, skipped=25, lr=[5.902371147427609e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:59:24,326] [INFO] [timer.py:258:stop] epoch=0/micro_step=4940/global_step=4940, RunningAvgSamplesPerSec=4.485998385283456, CurrSamplesPerSec=4.466166238166555, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:59:33,377] [INFO] [logging.py:96:log_dist] [Rank 0] step=4950, skipped=25, lr=[5.888288646090656e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:59:33,378] [INFO] [timer.py:258:stop] epoch=0/micro_step=4950/global_step=4950, RunningAvgSamplesPerSec=4.485988627967825, CurrSamplesPerSec=4.480986301077165, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:59:33,378] [INFO] [RANK 0]  iteration     4950/   10000 | elapsed time per iteration (ms): 906.4 | learning rate 5.887E-05 | total loss 2.336034E-01 | loss 2.336034E-01 | loss scale 16384.0 |speed 264.79 samples/(min*GPU)
[2024-06-17 19:59:33,379] [INFO] [RANK 0] time (ms) | forward: 355.01 | backward: 547.23 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.64 | data loader: 0.09
[2024-06-17 19:59:42,466] [INFO] [logging.py:96:log_dist] [Rank 0] step=4960, skipped=25, lr=[5.874202312501525e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:59:42,467] [INFO] [timer.py:258:stop] epoch=0/micro_step=4960/global_step=4960, RunningAvgSamplesPerSec=4.48596412702782, CurrSamplesPerSec=4.488355226390557, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 19:59:51,533] [INFO] [logging.py:96:log_dist] [Rank 0] step=4970, skipped=25, lr=[5.86011228568664e-05], mom=[[0.9, 0.95]]
[2024-06-17 19:59:51,533] [INFO] [timer.py:258:stop] epoch=0/micro_step=4970/global_step=4970, RunningAvgSamplesPerSec=4.485944944881603, CurrSamplesPerSec=4.482379827974157, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:00:00,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=4980, skipped=25, lr=[5.84601870470888e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:00:00,557] [INFO] [timer.py:258:stop] epoch=0/micro_step=4980/global_step=4980, RunningAvgSamplesPerSec=4.4859463363466965, CurrSamplesPerSec=4.4828373427273, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:00:09,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=4990, skipped=25, lr=[5.831921708666196e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:00:09,591] [INFO] [timer.py:258:stop] epoch=0/micro_step=4990/global_step=4990, RunningAvgSamplesPerSec=4.4859417354841105, CurrSamplesPerSec=4.485229436970198, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:00:18,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=5000, skipped=25, lr=[5.817821436690251e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:00:18,658] [INFO] [timer.py:258:stop] epoch=0/micro_step=5000/global_step=5000, RunningAvgSamplesPerSec=4.48592469287941, CurrSamplesPerSec=4.4791308083182555, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:00:18,659] [INFO] [RANK 0]  iteration     5000/   10000 | elapsed time per iteration (ms): 905.6 | learning rate 5.816E-05 | total loss 2.915845E-01 | loss 2.915845E-01 | loss scale 16384.0 |speed 265.01 samples/(min*GPU)
[2024-06-17 20:00:18,659] [INFO] [RANK 0] time (ms) | forward: 354.22 | backward: 547.25 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.09 | data loader: 0.09
[2024-06-17 20:00:25,300] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 20:00:25,300] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 20:00:25,300] [INFO] [RANK 0]  validation loss at iteration 5000 | loss: 9.004883E-01 | PPL: 2.460804E+00 loss 9.008789E-01 |
[2024-06-17 20:00:25,300] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 20:00:34,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=5010, skipped=25, lr=[5.803718027945035e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:00:34,384] [INFO] [timer.py:258:stop] epoch=0/micro_step=5010/global_step=5010, RunningAvgSamplesPerSec=4.485908224301742, CurrSamplesPerSec=4.48016423941933, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:00:43,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=5020, skipped=25, lr=[5.789611621625499e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:00:43,456] [INFO] [timer.py:258:stop] epoch=0/micro_step=5020/global_step=5020, RunningAvgSamplesPerSec=4.4858918090528785, CurrSamplesPerSec=4.472698151013535, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:00:52,509] [INFO] [logging.py:96:log_dist] [Rank 0] step=5030, skipped=25, lr=[5.7755023569561794e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:00:52,510] [INFO] [timer.py:258:stop] epoch=0/micro_step=5030/global_step=5030, RunningAvgSamplesPerSec=4.4858787748264435, CurrSamplesPerSec=4.482634922848747, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:01:01,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=5040, skipped=25, lr=[5.7613903731898214e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:01:01,591] [INFO] [timer.py:258:stop] epoch=0/micro_step=5040/global_step=5040, RunningAvgSamplesPerSec=4.485864285640356, CurrSamplesPerSec=4.47550919365578, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:01:10,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=5050, skipped=25, lr=[5.747275809606007e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:01:10,657] [INFO] [timer.py:258:stop] epoch=0/micro_step=5050/global_step=5050, RunningAvgSamplesPerSec=4.485851618149045, CurrSamplesPerSec=4.480378401099397, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:01:10,659] [INFO] [RANK 0]  iteration     5050/   10000 | elapsed time per iteration (ms): 1040.0 | learning rate 5.746E-05 | total loss 2.274553E-01 | loss 2.274553E-01 | loss scale 16384.0 |speed 230.77 samples/(min*GPU)
[2024-06-17 20:01:10,659] [INFO] [RANK 0] time (ms) | forward: 355.80 | backward: 547.28 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 16.23 | data loader: 0.15
[2024-06-17 20:01:19,739] [INFO] [logging.py:96:log_dist] [Rank 0] step=5060, skipped=25, lr=[5.733158805509782e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:01:19,740] [INFO] [timer.py:258:stop] epoch=0/micro_step=5060/global_step=5060, RunningAvgSamplesPerSec=4.485829138554109, CurrSamplesPerSec=4.47505317341388, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:01:28,821] [INFO] [logging.py:96:log_dist] [Rank 0] step=5070, skipped=25, lr=[5.719039500230275e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:01:28,822] [INFO] [timer.py:258:stop] epoch=0/micro_step=5070/global_step=5070, RunningAvgSamplesPerSec=4.4857990384764355, CurrSamplesPerSec=4.47876132890188, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:01:37,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=5080, skipped=25, lr=[5.704918033119332e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:01:37,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=5080/global_step=5080, RunningAvgSamplesPerSec=4.485783504186093, CurrSamplesPerSec=4.472655225290744, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:01:46,956] [INFO] [logging.py:96:log_dist] [Rank 0] step=5090, skipped=25, lr=[5.690794543550129e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:01:46,957] [INFO] [timer.py:258:stop] epoch=0/micro_step=5090/global_step=5090, RunningAvgSamplesPerSec=4.4857661763774495, CurrSamplesPerSec=4.468506054125838, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:01:56,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=5100, skipped=25, lr=[5.6766691709158096e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:01:56,009] [INFO] [timer.py:258:stop] epoch=0/micro_step=5100/global_step=5100, RunningAvgSamplesPerSec=4.485755052299628, CurrSamplesPerSec=4.4670402598235945, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:01:56,010] [INFO] [RANK 0]  iteration     5100/   10000 | elapsed time per iteration (ms): 907.0 | learning rate 5.675E-05 | total loss 2.218393E-01 | loss 2.218393E-01 | loss scale 16384.0 |speed 264.60 samples/(min*GPU)
[2024-06-17 20:01:56,011] [INFO] [RANK 0] time (ms) | forward: 355.64 | backward: 547.26 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.83 | data loader: 0.10
[2024-06-17 20:01:56,011] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:01:56,028] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/5100/mp_rank_00_model_states.pt
[2024-06-17 20:01:56,028] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/5100/mp_rank_00_model_states.pt...
[2024-06-17 20:02:17,270] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/5100/mp_rank_00_model_states.pt.
[2024-06-17 20:02:26,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=5110, skipped=25, lr=[5.6625420546280967e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:02:26,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=5110/global_step=5110, RunningAvgSamplesPerSec=4.4858056480781565, CurrSamplesPerSec=4.510124328577562, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:02:35,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=5120, skipped=25, lr=[5.6484133341159264e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:02:35,269] [INFO] [timer.py:258:stop] epoch=0/micro_step=5120/global_step=5120, RunningAvgSamplesPerSec=4.485860354452017, CurrSamplesPerSec=4.518965701607732, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:02:44,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=5130, skipped=25, lr=[5.634283148824064e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:02:44,276] [INFO] [timer.py:258:stop] epoch=0/micro_step=5130/global_step=5130, RunningAvgSamplesPerSec=4.485896521230223, CurrSamplesPerSec=4.492447526307136, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:02:53,306] [INFO] [logging.py:96:log_dist] [Rank 0] step=5140, skipped=25, lr=[5.620151638211737e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:02:53,306] [INFO] [timer.py:258:stop] epoch=0/micro_step=5140/global_step=5140, RunningAvgSamplesPerSec=4.485908548940564, CurrSamplesPerSec=4.501424972297422, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:03:02,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=5150, skipped=25, lr=[5.606018941751247e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:03:02,339] [INFO] [timer.py:258:stop] epoch=0/micro_step=5150/global_step=5150, RunningAvgSamplesPerSec=4.485910735873384, CurrSamplesPerSec=4.49169100069689, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:03:02,341] [INFO] [RANK 0]  iteration     5150/   10000 | elapsed time per iteration (ms): 1326.6 | learning rate 5.605E-05 | total loss 2.289214E-01 | loss 2.289214E-01 | loss scale 16384.0 |speed 180.91 samples/(min*GPU)
[2024-06-17 20:03:02,342] [INFO] [RANK 0] time (ms) | forward: 352.66 | backward: 544.38 | allreduce: 0.00 | optimizer: 3.39 | batch generator: 12.14 | data loader: 0.10
[2024-06-17 20:03:11,384] [INFO] [logging.py:96:log_dist] [Rank 0] step=5160, skipped=25, lr=[5.591885198926603e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:03:11,385] [INFO] [timer.py:258:stop] epoch=0/micro_step=5160/global_step=5160, RunningAvgSamplesPerSec=4.4859031134239675, CurrSamplesPerSec=4.451841943469208, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:03:20,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=5170, skipped=25, lr=[5.5777505492321413e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:03:20,437] [INFO] [timer.py:258:stop] epoch=0/micro_step=5170/global_step=5170, RunningAvgSamplesPerSec=4.4858841423292, CurrSamplesPerSec=4.486594409278469, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:03:29,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=5180, skipped=25, lr=[5.563615132171149e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:03:29,508] [INFO] [timer.py:258:stop] epoch=0/micro_step=5180/global_step=5180, RunningAvgSamplesPerSec=4.4858639535178115, CurrSamplesPerSec=4.479895070817052, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:03:38,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=5190, skipped=25, lr=[5.549479087254483e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:03:38,581] [INFO] [timer.py:258:stop] epoch=0/micro_step=5190/global_step=5190, RunningAvgSamplesPerSec=4.485839373592769, CurrSamplesPerSec=4.478364415706025, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:03:47,646] [INFO] [logging.py:96:log_dist] [Rank 0] step=5200, skipped=25, lr=[5.5353425539992014e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:03:47,646] [INFO] [timer.py:258:stop] epoch=0/micro_step=5200/global_step=5200, RunningAvgSamplesPerSec=4.48582517177861, CurrSamplesPerSec=4.47065055828452, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:03:47,647] [INFO] [RANK 0]  iteration     5200/   10000 | elapsed time per iteration (ms): 906.1 | learning rate 5.534E-05 | total loss 2.408832E-01 | loss 2.408832E-01 | loss scale 32768.0 |speed 264.87 samples/(min*GPU)
[2024-06-17 20:03:47,647] [INFO] [RANK 0] time (ms) | forward: 354.73 | backward: 547.20 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 12.09 | data loader: 0.10
[2024-06-17 20:03:56,696] [INFO] [logging.py:96:log_dist] [Rank 0] step=5210, skipped=25, lr=[5.52120567192718e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:03:56,697] [INFO] [timer.py:258:stop] epoch=0/micro_step=5210/global_step=5210, RunningAvgSamplesPerSec=4.485808909301748, CurrSamplesPerSec=4.468007433356254, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:04:05,791] [INFO] [logging.py:96:log_dist] [Rank 0] step=5220, skipped=25, lr=[5.507068580563739e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:04:05,792] [INFO] [timer.py:258:stop] epoch=0/micro_step=5220/global_step=5220, RunningAvgSamplesPerSec=4.485799051679272, CurrSamplesPerSec=4.472983151011694, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:04:14,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=5230, skipped=25, lr=[5.492931419436262e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:04:14,840] [INFO] [timer.py:258:stop] epoch=0/micro_step=5230/global_step=5230, RunningAvgSamplesPerSec=4.485785613706007, CurrSamplesPerSec=4.484867342983547, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:04:23,890] [INFO] [logging.py:96:log_dist] [Rank 0] step=5240, skipped=25, lr=[5.478794328072821e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:04:23,892] [INFO] [timer.py:258:stop] epoch=0/micro_step=5240/global_step=5240, RunningAvgSamplesPerSec=4.485775679846808, CurrSamplesPerSec=4.475865001731417, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:04:32,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=5250, skipped=25, lr=[5.464657446000801e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:04:32,972] [INFO] [timer.py:258:stop] epoch=0/micro_step=5250/global_step=5250, RunningAvgSamplesPerSec=4.4857502410361905, CurrSamplesPerSec=4.479893874584346, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:04:32,974] [INFO] [RANK 0]  iteration     5250/   10000 | elapsed time per iteration (ms): 906.5 | learning rate 5.463E-05 | total loss 2.313553E-01 | loss 2.313553E-01 | loss scale 32768.0 |speed 264.74 samples/(min*GPU)
[2024-06-17 20:04:32,974] [INFO] [RANK 0] time (ms) | forward: 355.28 | backward: 547.12 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.68 | data loader: 0.11
[2024-06-17 20:04:42,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=5260, skipped=25, lr=[5.4505209127455195e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:04:42,067] [INFO] [timer.py:258:stop] epoch=0/micro_step=5260/global_step=5260, RunningAvgSamplesPerSec=4.485726063039947, CurrSamplesPerSec=4.4773246454907625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:04:51,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=5270, skipped=25, lr=[5.436384867828854e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:04:51,155] [INFO] [timer.py:258:stop] epoch=0/micro_step=5270/global_step=5270, RunningAvgSamplesPerSec=4.485712494077509, CurrSamplesPerSec=4.478057214938907, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:05:00,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=5280, skipped=25, lr=[5.4222494507678604e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:05:00,252] [INFO] [timer.py:258:stop] epoch=0/micro_step=5280/global_step=5280, RunningAvgSamplesPerSec=4.485687931764747, CurrSamplesPerSec=4.4782472680294045, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:05:09,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=5290, skipped=25, lr=[5.408114801073399e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:05:09,299] [INFO] [timer.py:258:stop] epoch=0/micro_step=5290/global_step=5290, RunningAvgSamplesPerSec=4.485674493944238, CurrSamplesPerSec=4.47946566432448, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:05:18,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=5300, skipped=25, lr=[5.393981058248756e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:05:18,343] [INFO] [timer.py:258:stop] epoch=0/micro_step=5300/global_step=5300, RunningAvgSamplesPerSec=4.485664917440417, CurrSamplesPerSec=4.483217079028076, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:05:18,344] [INFO] [RANK 0]  iteration     5300/   10000 | elapsed time per iteration (ms): 907.4 | learning rate 5.393E-05 | total loss 2.634103E-01 | loss 2.634103E-01 | loss scale 32768.0 |speed 264.49 samples/(min*GPU)
[2024-06-17 20:05:18,344] [INFO] [RANK 0] time (ms) | forward: 355.81 | backward: 547.38 | allreduce: 0.00 | optimizer: 3.43 | batch generator: 13.34 | data loader: 0.10
[2024-06-17 20:05:27,399] [INFO] [logging.py:96:log_dist] [Rank 0] step=5310, skipped=25, lr=[5.3798483617882654e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:05:27,400] [INFO] [timer.py:258:stop] epoch=0/micro_step=5310/global_step=5310, RunningAvgSamplesPerSec=4.485652792487504, CurrSamplesPerSec=4.472491876601654, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:05:36,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=5320, skipped=25, lr=[5.3657168511759374e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:05:36,453] [INFO] [timer.py:258:stop] epoch=0/micro_step=5320/global_step=5320, RunningAvgSamplesPerSec=4.485643520446224, CurrSamplesPerSec=4.467400670381065, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:05:45,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=5330, skipped=25, lr=[5.351586665884075e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:05:45,532] [INFO] [timer.py:258:stop] epoch=0/micro_step=5330/global_step=5330, RunningAvgSamplesPerSec=4.485619960572628, CurrSamplesPerSec=4.480880983756649, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:05:54,575] [INFO] [logging.py:96:log_dist] [Rank 0] step=5340, skipped=25, lr=[5.337457945371905e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:05:54,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=5340/global_step=5340, RunningAvgSamplesPerSec=4.485605251525763, CurrSamplesPerSec=4.4741473774825575, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:06:03,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=5350, skipped=25, lr=[5.3233308290841935e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:06:03,639] [INFO] [timer.py:258:stop] epoch=0/micro_step=5350/global_step=5350, RunningAvgSamplesPerSec=4.485591052581079, CurrSamplesPerSec=4.479151137433976, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:06:03,640] [INFO] [RANK 0]  iteration     5350/   10000 | elapsed time per iteration (ms): 905.9 | learning rate 5.322E-05 | total loss 2.510284E-01 | loss 2.510284E-01 | loss scale 32768.0 |speed 264.92 samples/(min*GPU)
[2024-06-17 20:06:03,641] [INFO] [RANK 0] time (ms) | forward: 354.60 | backward: 547.18 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 12.05 | data loader: 0.09
[2024-06-17 20:06:12,702] [INFO] [logging.py:96:log_dist] [Rank 0] step=5360, skipped=25, lr=[5.3092054564498725e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:06:12,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=5360/global_step=5360, RunningAvgSamplesPerSec=4.48557765811672, CurrSamplesPerSec=4.476100248200659, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:06:21,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=5370, skipped=25, lr=[5.295081966880672e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:06:21,765] [INFO] [timer.py:258:stop] epoch=0/micro_step=5370/global_step=5370, RunningAvgSamplesPerSec=4.485558459866853, CurrSamplesPerSec=4.486071351601109, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:06:30,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=5380, skipped=25, lr=[5.2809604997697274e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:06:30,833] [INFO] [timer.py:258:stop] epoch=0/micro_step=5380/global_step=5380, RunningAvgSamplesPerSec=4.485533889286813, CurrSamplesPerSec=4.469466718526057, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:06:39,896] [INFO] [logging.py:96:log_dist] [Rank 0] step=5390, skipped=25, lr=[5.266841194490221e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:06:39,896] [INFO] [timer.py:258:stop] epoch=0/micro_step=5390/global_step=5390, RunningAvgSamplesPerSec=4.485524649262324, CurrSamplesPerSec=4.488683056556625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:06:48,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=5400, skipped=25, lr=[5.252724190393996e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:06:48,983] [INFO] [timer.py:258:stop] epoch=0/micro_step=5400/global_step=5400, RunningAvgSamplesPerSec=4.485505508842962, CurrSamplesPerSec=4.461851092523776, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:06:48,984] [INFO] [RANK 0]  iteration     5400/   10000 | elapsed time per iteration (ms): 906.9 | learning rate 5.251E-05 | total loss 2.478757E-01 | loss 2.478757E-01 | loss scale 32768.0 |speed 264.64 samples/(min*GPU)
[2024-06-17 20:06:48,985] [INFO] [RANK 0] time (ms) | forward: 355.54 | backward: 547.20 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.73 | data loader: 0.09
[2024-06-17 20:06:48,985] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:06:48,999] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/5400/mp_rank_00_model_states.pt
[2024-06-17 20:06:49,000] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/5400/mp_rank_00_model_states.pt...
[2024-06-17 20:07:11,744] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/5400/mp_rank_00_model_states.pt.
[2024-06-17 20:07:20,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=5410, skipped=25, lr=[5.2386096268101803e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:07:20,769] [INFO] [timer.py:258:stop] epoch=0/micro_step=5410/global_step=5410, RunningAvgSamplesPerSec=4.485557224238024, CurrSamplesPerSec=4.503801887883971, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:07:29,789] [INFO] [logging.py:96:log_dist] [Rank 0] step=5420, skipped=25, lr=[5.224497643043822e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:07:29,790] [INFO] [timer.py:258:stop] epoch=0/micro_step=5420/global_step=5420, RunningAvgSamplesPerSec=4.485590300285113, CurrSamplesPerSec=4.500334630456656, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:07:38,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=5430, skipped=25, lr=[5.210388378374502e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:07:38,812] [INFO] [timer.py:258:stop] epoch=0/micro_step=5430/global_step=5430, RunningAvgSamplesPerSec=4.4856286813820745, CurrSamplesPerSec=4.505019714745727, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:07:47,838] [INFO] [logging.py:96:log_dist] [Rank 0] step=5440, skipped=25, lr=[5.196281972054967e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:07:47,839] [INFO] [timer.py:258:stop] epoch=0/micro_step=5440/global_step=5440, RunningAvgSamplesPerSec=4.485660568775769, CurrSamplesPerSec=4.4955592956288575, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:07:56,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=5450, skipped=25, lr=[5.1821785633097515e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:07:56,905] [INFO] [timer.py:258:stop] epoch=0/micro_step=5450/global_step=5450, RunningAvgSamplesPerSec=4.485657224619286, CurrSamplesPerSec=4.487211198171867, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:07:56,905] [INFO] [RANK 0]  iteration     5450/   10000 | elapsed time per iteration (ms): 1358.4 | learning rate 5.181E-05 | total loss 2.362733E-01 | loss 2.362733E-01 | loss scale 32768.0 |speed 176.68 samples/(min*GPU)
[2024-06-17 20:07:56,906] [INFO] [RANK 0] time (ms) | forward: 354.91 | backward: 543.89 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 13.90 | data loader: 0.10
[2024-06-17 20:08:05,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=5460, skipped=25, lr=[5.168078291333806e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:08:05,977] [INFO] [timer.py:258:stop] epoch=0/micro_step=5460/global_step=5460, RunningAvgSamplesPerSec=4.485656364515776, CurrSamplesPerSec=4.4848553541164335, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:08:15,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=5470, skipped=25, lr=[5.1539812952911236e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:08:15,046] [INFO] [timer.py:258:stop] epoch=0/micro_step=5470/global_step=5470, RunningAvgSamplesPerSec=4.485632248101754, CurrSamplesPerSec=4.482018193922465, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:08:24,108] [INFO] [logging.py:96:log_dist] [Rank 0] step=5480, skipped=25, lr=[5.139887714313362e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:08:24,108] [INFO] [timer.py:258:stop] epoch=0/micro_step=5480/global_step=5480, RunningAvgSamplesPerSec=4.485610520925389, CurrSamplesPerSec=4.482367852402499, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:08:33,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=5490, skipped=25, lr=[5.1257976874984774e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:08:33,177] [INFO] [timer.py:258:stop] epoch=0/micro_step=5490/global_step=5490, RunningAvgSamplesPerSec=4.4855897382872465, CurrSamplesPerSec=4.474975587598046, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:08:42,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=5500, skipped=25, lr=[5.1117113539093456e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:08:42,263] [INFO] [timer.py:258:stop] epoch=0/micro_step=5500/global_step=5500, RunningAvgSamplesPerSec=4.485565353378159, CurrSamplesPerSec=4.4641091786192755, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:08:42,264] [INFO] [RANK 0]  iteration     5500/   10000 | elapsed time per iteration (ms): 907.2 | learning rate 5.110E-05 | total loss 2.307718E-01 | loss 2.307718E-01 | loss scale 32768.0 |speed 264.56 samples/(min*GPU)
[2024-06-17 20:08:42,266] [INFO] [RANK 0] time (ms) | forward: 355.91 | backward: 547.10 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 12.88 | data loader: 0.11
[2024-06-17 20:08:51,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=5510, skipped=25, lr=[5.0976288525723923e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:08:51,361] [INFO] [timer.py:258:stop] epoch=0/micro_step=5510/global_step=5510, RunningAvgSamplesPerSec=4.485539597187616, CurrSamplesPerSec=4.4702598456625156, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:09:00,423] [INFO] [logging.py:96:log_dist] [Rank 0] step=5520, skipped=25, lr=[5.083550322476221e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:09:00,424] [INFO] [timer.py:258:stop] epoch=0/micro_step=5520/global_step=5520, RunningAvgSamplesPerSec=4.485527810873964, CurrSamplesPerSec=4.4770223661440385, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:09:09,500] [INFO] [logging.py:96:log_dist] [Rank 0] step=5530, skipped=25, lr=[5.069475902570239e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:09:09,500] [INFO] [timer.py:258:stop] epoch=0/micro_step=5530/global_step=5530, RunningAvgSamplesPerSec=4.485507797795571, CurrSamplesPerSec=4.44967413591581, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:09:18,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=5540, skipped=25, lr=[5.055405731763289e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:09:18,565] [INFO] [timer.py:258:stop] epoch=0/micro_step=5540/global_step=5540, RunningAvgSamplesPerSec=4.4854978912005565, CurrSamplesPerSec=4.478933505899665, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:09:27,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=5550, skipped=25, lr=[5.041339948922276e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:09:27,618] [INFO] [timer.py:258:stop] epoch=0/micro_step=5550/global_step=5550, RunningAvgSamplesPerSec=4.485484696133178, CurrSamplesPerSec=4.477190825092654, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:09:27,620] [INFO] [RANK 0]  iteration     5550/   10000 | elapsed time per iteration (ms): 907.1 | learning rate 5.040E-05 | total loss 2.533566E-01 | loss 2.533566E-01 | loss scale 32768.0 |speed 264.58 samples/(min*GPU)
[2024-06-17 20:09:27,621] [INFO] [RANK 0] time (ms) | forward: 355.44 | backward: 547.41 | allreduce: 0.00 | optimizer: 3.43 | batch generator: 12.99 | data loader: 0.11
[2024-06-17 20:09:36,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=5560, skipped=25, lr=[5.027278692870799e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:09:36,682] [INFO] [timer.py:258:stop] epoch=0/micro_step=5560/global_step=5560, RunningAvgSamplesPerSec=4.485471196282762, CurrSamplesPerSec=4.472009054255698, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:09:41,214] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 20:09:42,118] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 20:09:45,741] [INFO] [logging.py:96:log_dist] [Rank 0] step=5570, skipped=27, lr=[5.016033040579054e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:09:45,742] [INFO] [timer.py:258:stop] epoch=0/micro_step=5570/global_step=5570, RunningAvgSamplesPerSec=4.48545103458867, CurrSamplesPerSec=4.481879303638672, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:09:54,820] [INFO] [logging.py:96:log_dist] [Rank 0] step=5580, skipped=27, lr=[5.001980282440722e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:09:54,821] [INFO] [timer.py:258:stop] epoch=0/micro_step=5580/global_step=5580, RunningAvgSamplesPerSec=4.485434493924701, CurrSamplesPerSec=4.471843368885678, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:10:03,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=5590, skipped=27, lr=[4.987932439555945e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:10:03,907] [INFO] [timer.py:258:stop] epoch=0/micro_step=5590/global_step=5590, RunningAvgSamplesPerSec=4.4854140937770435, CurrSamplesPerSec=4.470245552593252, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:10:12,993] [INFO] [logging.py:96:log_dist] [Rank 0] step=5600, skipped=27, lr=[4.973889650571257e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:10:12,993] [INFO] [timer.py:258:stop] epoch=0/micro_step=5600/global_step=5600, RunningAvgSamplesPerSec=4.4853977397328935, CurrSamplesPerSec=4.468472729936145, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:10:12,995] [INFO] [RANK 0]  iteration     5600/   10000 | elapsed time per iteration (ms): 907.5 | learning rate 4.972E-05 | total loss 2.151561E-01 | loss 2.151561E-01 | loss scale 32768.0 |speed 264.46 samples/(min*GPU)
[2024-06-17 20:10:12,996] [INFO] [RANK 0] time (ms) | forward: 355.80 | backward: 547.55 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 13.20 | data loader: 0.11
[2024-06-17 20:10:22,045] [INFO] [logging.py:96:log_dist] [Rank 0] step=5610, skipped=27, lr=[4.959852054083321e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:10:22,045] [INFO] [timer.py:258:stop] epoch=0/micro_step=5610/global_step=5610, RunningAvgSamplesPerSec=4.485391336193519, CurrSamplesPerSec=4.485581995233479, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:10:31,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=5620, skipped=27, lr=[4.945819788637545e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:10:31,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=5620/global_step=5620, RunningAvgSamplesPerSec=4.485376866551419, CurrSamplesPerSec=4.476196981080527, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:10:40,156] [INFO] [logging.py:96:log_dist] [Rank 0] step=5630, skipped=27, lr=[4.9317929927267225e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:10:40,157] [INFO] [timer.py:258:stop] epoch=0/micro_step=5630/global_step=5630, RunningAvgSamplesPerSec=4.485373740490258, CurrSamplesPerSec=4.484882928606619, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:10:49,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=5640, skipped=27, lr=[4.917771804789668e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:10:49,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=5640/global_step=5640, RunningAvgSamplesPerSec=4.485362305229301, CurrSamplesPerSec=4.476778660740755, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:10:58,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=5650, skipped=27, lr=[4.9037563632098444e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:10:58,259] [INFO] [timer.py:258:stop] epoch=0/micro_step=5650/global_step=5650, RunningAvgSamplesPerSec=4.485353357862231, CurrSamplesPerSec=4.486936382174974, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:10:58,260] [INFO] [RANK 0]  iteration     5650/   10000 | elapsed time per iteration (ms): 905.3 | learning rate 4.902E-05 | total loss 2.379227E-01 | loss 2.379227E-01 | loss scale 32768.0 |speed 265.10 samples/(min*GPU)
[2024-06-17 20:10:58,261] [INFO] [RANK 0] time (ms) | forward: 353.78 | backward: 547.38 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 11.97 | data loader: 0.09
[2024-06-17 20:11:07,312] [INFO] [logging.py:96:log_dist] [Rank 0] step=5660, skipped=27, lr=[4.8897468063140035e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:11:07,312] [INFO] [timer.py:258:stop] epoch=0/micro_step=5660/global_step=5660, RunningAvgSamplesPerSec=4.485350311575662, CurrSamplesPerSec=4.475431592026862, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:11:16,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=5670, skipped=27, lr=[4.8757432723708144e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:11:16,355] [INFO] [timer.py:258:stop] epoch=0/micro_step=5670/global_step=5670, RunningAvgSamplesPerSec=4.485341578834157, CurrSamplesPerSec=4.477268487742444, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:11:25,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=5680, skipped=27, lr=[4.8617458995895036e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:11:25,412] [INFO] [timer.py:258:stop] epoch=0/micro_step=5680/global_step=5680, RunningAvgSamplesPerSec=4.4853308391116125, CurrSamplesPerSec=4.487223199637539, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:11:34,480] [INFO] [logging.py:96:log_dist] [Rank 0] step=5690, skipped=27, lr=[4.8477548261184916e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:11:34,480] [INFO] [timer.py:258:stop] epoch=0/micro_step=5690/global_step=5690, RunningAvgSamplesPerSec=4.48532706194803, CurrSamplesPerSec=4.486246490360189, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:11:43,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=5700, skipped=27, lr=[4.833770190044023e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:11:43,521] [INFO] [timer.py:258:stop] epoch=0/micro_step=5700/global_step=5700, RunningAvgSamplesPerSec=4.4853183346339245, CurrSamplesPerSec=4.486292076663613, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:11:43,522] [INFO] [RANK 0]  iteration     5700/   10000 | elapsed time per iteration (ms): 905.2 | learning rate 4.832E-05 | total loss 2.335665E-01 | loss 2.335665E-01 | loss scale 32768.0 |speed 265.12 samples/(min*GPU)
[2024-06-17 20:11:43,523] [INFO] [RANK 0] time (ms) | forward: 353.73 | backward: 547.42 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 11.99 | data loader: 0.09
[2024-06-17 20:11:43,524] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:11:43,540] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/5700/mp_rank_00_model_states.pt
[2024-06-17 20:11:43,540] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/5700/mp_rank_00_model_states.pt...
[2024-06-17 20:12:04,273] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/5700/mp_rank_00_model_states.pt.
[2024-06-17 20:12:13,284] [INFO] [logging.py:96:log_dist] [Rank 0] step=5710, skipped=27, lr=[4.8197921293888116e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:12:13,285] [INFO] [timer.py:258:stop] epoch=0/micro_step=5710/global_step=5710, RunningAvgSamplesPerSec=4.4853706706835, CurrSamplesPerSec=4.508629896155312, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:12:22,272] [INFO] [logging.py:96:log_dist] [Rank 0] step=5720, skipped=27, lr=[4.8058207821106725e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:12:22,272] [INFO] [timer.py:258:stop] epoch=0/micro_step=5720/global_step=5720, RunningAvgSamplesPerSec=4.485417780258174, CurrSamplesPerSec=4.501850143476681, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:12:31,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=5730, skipped=27, lr=[4.791856286101161e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:12:31,280] [INFO] [timer.py:258:stop] epoch=0/micro_step=5730/global_step=5730, RunningAvgSamplesPerSec=4.48545071480053, CurrSamplesPerSec=4.510536592893624, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:12:40,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=5740, skipped=27, lr=[4.7778987791842166e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:12:40,277] [INFO] [timer.py:258:stop] epoch=0/micro_step=5740/global_step=5740, RunningAvgSamplesPerSec=4.485483396883123, CurrSamplesPerSec=4.502033764952694, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:12:49,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=5750, skipped=27, lr=[4.763948399114798e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:12:49,328] [INFO] [timer.py:258:stop] epoch=0/micro_step=5750/global_step=5750, RunningAvgSamplesPerSec=4.485496436901641, CurrSamplesPerSec=4.489837447871911, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:12:49,329] [INFO] [RANK 0]  iteration     5750/   10000 | elapsed time per iteration (ms): 1316.1 | learning rate 4.763E-05 | total loss 2.152211E-01 | loss 2.152211E-01 | loss scale 32768.0 |speed 182.35 samples/(min*GPU)
[2024-06-17 20:12:49,330] [INFO] [RANK 0] time (ms) | forward: 352.68 | backward: 544.01 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.51 | data loader: 0.10
[2024-06-17 20:12:58,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=5760, skipped=27, lr=[4.750005283577524e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:12:58,385] [INFO] [timer.py:258:stop] epoch=0/micro_step=5760/global_step=5760, RunningAvgSamplesPerSec=4.48549360950202, CurrSamplesPerSec=4.4733695688401305, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:13:07,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=5770, skipped=27, lr=[4.736069570185317e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:13:07,436] [INFO] [timer.py:258:stop] epoch=0/micro_step=5770/global_step=5770, RunningAvgSamplesPerSec=4.485492216507536, CurrSamplesPerSec=4.491290590282425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:13:16,479] [INFO] [logging.py:96:log_dist] [Rank 0] step=5780, skipped=27, lr=[4.72214139647804e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:13:16,480] [INFO] [timer.py:258:stop] epoch=0/micro_step=5780/global_step=5780, RunningAvgSamplesPerSec=4.48548600405112, CurrSamplesPerSec=4.469856101633367, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:13:25,528] [INFO] [logging.py:96:log_dist] [Rank 0] step=5790, skipped=27, lr=[4.708220899921145e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:13:25,529] [INFO] [timer.py:258:stop] epoch=0/micro_step=5790/global_step=5790, RunningAvgSamplesPerSec=4.48548771201496, CurrSamplesPerSec=4.48631487016274, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:13:34,601] [INFO] [logging.py:96:log_dist] [Rank 0] step=5800, skipped=27, lr=[4.6943082179043146e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:13:34,602] [INFO] [timer.py:258:stop] epoch=0/micro_step=5800/global_step=5800, RunningAvgSamplesPerSec=4.485475812737391, CurrSamplesPerSec=4.467827766751342, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:13:34,604] [INFO] [RANK 0]  iteration     5800/   10000 | elapsed time per iteration (ms): 905.5 | learning rate 4.693E-05 | total loss 2.290645E-01 | loss 2.290645E-01 | loss scale 32768.0 |speed 265.05 samples/(min*GPU)
[2024-06-17 20:13:34,605] [INFO] [RANK 0] time (ms) | forward: 354.34 | backward: 546.94 | allreduce: 0.00 | optimizer: 3.40 | batch generator: 12.66 | data loader: 0.09
[2024-06-17 20:13:43,691] [INFO] [logging.py:96:log_dist] [Rank 0] step=5810, skipped=27, lr=[4.680403487740103e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:13:43,692] [INFO] [timer.py:258:stop] epoch=0/micro_step=5810/global_step=5810, RunningAvgSamplesPerSec=4.485457196156703, CurrSamplesPerSec=4.47108661702706, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:13:52,757] [INFO] [logging.py:96:log_dist] [Rank 0] step=5820, skipped=27, lr=[4.666506846662582e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:13:52,758] [INFO] [timer.py:258:stop] epoch=0/micro_step=5820/global_step=5820, RunningAvgSamplesPerSec=4.485446220435983, CurrSamplesPerSec=4.479592444306196, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:14:01,809] [INFO] [logging.py:96:log_dist] [Rank 0] step=5830, skipped=27, lr=[4.65261843182599e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:14:01,809] [INFO] [timer.py:258:stop] epoch=0/micro_step=5830/global_step=5830, RunningAvgSamplesPerSec=4.485433975420558, CurrSamplesPerSec=4.474902778740951, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:14:10,854] [INFO] [logging.py:96:log_dist] [Rank 0] step=5840, skipped=27, lr=[4.6387383803033735e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:14:10,855] [INFO] [timer.py:258:stop] epoch=0/micro_step=5840/global_step=5840, RunningAvgSamplesPerSec=4.485415583001104, CurrSamplesPerSec=4.46465207723267, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:14:19,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=5850, skipped=27, lr=[4.624866829085239e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:14:19,907] [INFO] [timer.py:258:stop] epoch=0/micro_step=5850/global_step=5850, RunningAvgSamplesPerSec=4.485409078070387, CurrSamplesPerSec=4.4786405737668815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:14:19,909] [INFO] [RANK 0]  iteration     5850/   10000 | elapsed time per iteration (ms): 906.1 | learning rate 4.623E-05 | total loss 2.539169E-01 | loss 2.539169E-01 | loss scale 32768.0 |speed 264.87 samples/(min*GPU)
[2024-06-17 20:14:19,910] [INFO] [RANK 0] time (ms) | forward: 354.51 | backward: 547.47 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 12.22 | data loader: 0.09
[2024-06-17 20:14:28,985] [INFO] [logging.py:96:log_dist] [Rank 0] step=5860, skipped=27, lr=[4.611003915078195e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:14:28,986] [INFO] [timer.py:258:stop] epoch=0/micro_step=5860/global_step=5860, RunningAvgSamplesPerSec=4.485395171869352, CurrSamplesPerSec=4.4830577496552975, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:14:38,058] [INFO] [logging.py:96:log_dist] [Rank 0] step=5870, skipped=27, lr=[4.597149775103607e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:14:38,058] [INFO] [timer.py:258:stop] epoch=0/micro_step=5870/global_step=5870, RunningAvgSamplesPerSec=4.4853820692705035, CurrSamplesPerSec=4.484372256107095, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:14:47,120] [INFO] [logging.py:96:log_dist] [Rank 0] step=5880, skipped=27, lr=[4.583304545896244e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:14:47,121] [INFO] [timer.py:258:stop] epoch=0/micro_step=5880/global_step=5880, RunningAvgSamplesPerSec=4.485362920683551, CurrSamplesPerSec=4.4715358703071395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:14:56,184] [INFO] [logging.py:96:log_dist] [Rank 0] step=5890, skipped=27, lr=[4.569468364102927e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:14:56,185] [INFO] [timer.py:258:stop] epoch=0/micro_step=5890/global_step=5890, RunningAvgSamplesPerSec=4.485354921067686, CurrSamplesPerSec=4.484313524239625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:15:05,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=5900, skipped=27, lr=[4.5556413662811886e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:15:05,262] [INFO] [timer.py:258:stop] epoch=0/micro_step=5900/global_step=5900, RunningAvgSamplesPerSec=4.485334243546922, CurrSamplesPerSec=4.4598845501029425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:15:05,264] [INFO] [RANK 0]  iteration     5900/   10000 | elapsed time per iteration (ms): 907.1 | learning rate 4.554E-05 | total loss 2.468342E-01 | loss 2.468342E-01 | loss scale 32768.0 |speed 264.58 samples/(min*GPU)
[2024-06-17 20:15:05,264] [INFO] [RANK 0] time (ms) | forward: 355.38 | backward: 547.49 | allreduce: 0.00 | optimizer: 3.41 | batch generator: 12.98 | data loader: 0.10
[2024-06-17 20:15:14,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=5910, skipped=27, lr=[4.5418236888979086e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:15:14,342] [INFO] [timer.py:258:stop] epoch=0/micro_step=5910/global_step=5910, RunningAvgSamplesPerSec=4.485308336551362, CurrSamplesPerSec=4.475669180891323, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:15:23,420] [INFO] [logging.py:96:log_dist] [Rank 0] step=5920, skipped=27, lr=[4.528015468327989e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:15:23,420] [INFO] [timer.py:258:stop] epoch=0/micro_step=5920/global_step=5920, RunningAvgSamplesPerSec=4.485285260898657, CurrSamplesPerSec=4.469639372388337, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:15:32,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=5930, skipped=27, lr=[4.514216840852991e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:15:32,479] [INFO] [timer.py:258:stop] epoch=0/micro_step=5930/global_step=5930, RunningAvgSamplesPerSec=4.485275663855623, CurrSamplesPerSec=4.4786740497855995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:15:41,529] [INFO] [logging.py:96:log_dist] [Rank 0] step=5940, skipped=27, lr=[4.500427942659796e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:15:41,530] [INFO] [timer.py:258:stop] epoch=0/micro_step=5940/global_step=5940, RunningAvgSamplesPerSec=4.48526139707475, CurrSamplesPerSec=4.480809179331015, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:15:50,575] [INFO] [logging.py:96:log_dist] [Rank 0] step=5950, skipped=27, lr=[4.4866489098392646e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:15:50,575] [INFO] [timer.py:258:stop] epoch=0/micro_step=5950/global_step=5950, RunningAvgSamplesPerSec=4.485250049084727, CurrSamplesPerSec=4.474102037654296, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:15:50,577] [INFO] [RANK 0]  iteration     5950/   10000 | elapsed time per iteration (ms): 906.3 | learning rate 4.485E-05 | total loss 2.099448E-01 | loss 2.099448E-01 | loss scale 32768.0 |speed 264.82 samples/(min*GPU)
[2024-06-17 20:15:50,578] [INFO] [RANK 0] time (ms) | forward: 354.68 | backward: 547.31 | allreduce: 0.00 | optimizer: 3.45 | batch generator: 11.79 | data loader: 0.10
[2024-06-17 20:15:59,648] [INFO] [logging.py:96:log_dist] [Rank 0] step=5960, skipped=27, lr=[4.472879878384886e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:15:59,648] [INFO] [timer.py:258:stop] epoch=0/micro_step=5960/global_step=5960, RunningAvgSamplesPerSec=4.485238378592825, CurrSamplesPerSec=4.482135538974068, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:16:05,987] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 20:16:06,893] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 20:16:08,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=5970, skipped=29, lr=[4.461871945529657e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:16:08,708] [INFO] [timer.py:258:stop] epoch=0/micro_step=5970/global_step=5970, RunningAvgSamplesPerSec=4.485223008983627, CurrSamplesPerSec=4.471855288286619, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:16:17,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=5980, skipped=29, lr=[4.448121258922019e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:16:17,771] [INFO] [timer.py:258:stop] epoch=0/micro_step=5980/global_step=5980, RunningAvgSamplesPerSec=4.485214025249696, CurrSamplesPerSec=4.470886448354558, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:16:26,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=5990, skipped=29, lr=[4.43438095393289e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:16:26,816] [INFO] [timer.py:258:stop] epoch=0/micro_step=5990/global_step=5990, RunningAvgSamplesPerSec=4.485201521005938, CurrSamplesPerSec=4.478071558005587, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:16:35,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=6000, skipped=29, lr=[4.4206511661735404e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:16:35,891] [INFO] [timer.py:258:stop] epoch=0/micro_step=6000/global_step=6000, RunningAvgSamplesPerSec=4.48518560547847, CurrSamplesPerSec=4.4918124606097996, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:16:35,893] [INFO] [RANK 0]  iteration     6000/   10000 | elapsed time per iteration (ms): 906.3 | learning rate 4.419E-05 | total loss 2.415825E-01 | loss 2.415825E-01 | loss scale 32768.0 |speed 264.81 samples/(min*GPU)
[2024-06-17 20:16:35,894] [INFO] [RANK 0] time (ms) | forward: 354.86 | backward: 547.29 | allreduce: 0.00 | optimizer: 3.37 | batch generator: 12.26 | data loader: 0.11
[2024-06-17 20:16:35,895] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:16:35,908] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/6000/mp_rank_00_model_states.pt
[2024-06-17 20:16:35,908] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/6000/mp_rank_00_model_states.pt...
[2024-06-17 20:16:57,012] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/6000/mp_rank_00_model_states.pt.
[2024-06-17 20:17:03,591] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 20:17:03,591] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 20:17:03,591] [INFO] [RANK 0]  validation loss at iteration 6000 | loss: 8.566895E-01 | PPL: 2.355350E+00 loss 8.569336E-01 |
[2024-06-17 20:17:03,591] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 20:17:12,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=6010, skipped=29, lr=[4.4069320311514286e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:17:12,567] [INFO] [timer.py:258:stop] epoch=0/micro_step=6010/global_step=6010, RunningAvgSamplesPerSec=4.485231513014218, CurrSamplesPerSec=4.510783987662384, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:17:21,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=6020, skipped=29, lr=[4.393223684268881e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:17:21,543] [INFO] [timer.py:258:stop] epoch=0/micro_step=6020/global_step=6020, RunningAvgSamplesPerSec=4.485270999805561, CurrSamplesPerSec=4.510614204017371, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:17:30,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=6030, skipped=29, lr=[4.3795262608217456e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:17:30,581] [INFO] [timer.py:258:stop] epoch=0/micro_step=6030/global_step=6030, RunningAvgSamplesPerSec=4.485285218519728, CurrSamplesPerSec=4.488884822001433, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:17:39,605] [INFO] [logging.py:96:log_dist] [Rank 0] step=6040, skipped=29, lr=[4.365839895998061e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:17:39,606] [INFO] [timer.py:258:stop] epoch=0/micro_step=6040/global_step=6040, RunningAvgSamplesPerSec=4.485290372807345, CurrSamplesPerSec=4.482341506370095, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:17:48,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=6050, skipped=29, lr=[4.3521647248767256e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:17:48,690] [INFO] [timer.py:258:stop] epoch=0/micro_step=6050/global_step=6050, RunningAvgSamplesPerSec=4.485276973561728, CurrSamplesPerSec=4.488749108723076, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:17:48,691] [INFO] [RANK 0]  iteration     6050/   10000 | elapsed time per iteration (ms): 1456.0 | learning rate 4.351E-05 | total loss 2.573918E-01 | loss 2.573918E-01 | loss scale 32768.0 |speed 164.84 samples/(min*GPU)
[2024-06-17 20:17:48,691] [INFO] [RANK 0] time (ms) | forward: 352.56 | backward: 544.97 | allreduce: 0.00 | optimizer: 3.54 | batch generator: 14.00 | data loader: 0.17
[2024-06-17 20:17:57,755] [INFO] [logging.py:96:log_dist] [Rank 0] step=6060, skipped=29, lr=[4.338500882426155e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:17:57,756] [INFO] [timer.py:258:stop] epoch=0/micro_step=6060/global_step=6060, RunningAvgSamplesPerSec=4.485265876103878, CurrSamplesPerSec=4.471034190166144, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:18:06,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=6070, skipped=29, lr=[4.324848503502959e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:18:06,824] [INFO] [timer.py:258:stop] epoch=0/micro_step=6070/global_step=6070, RunningAvgSamplesPerSec=4.485265555600928, CurrSamplesPerSec=4.494707795513119, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:18:15,884] [INFO] [logging.py:96:log_dist] [Rank 0] step=6080, skipped=29, lr=[4.311207722850605e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:18:15,884] [INFO] [timer.py:258:stop] epoch=0/micro_step=6080/global_step=6080, RunningAvgSamplesPerSec=4.485271190243828, CurrSamplesPerSec=4.486130129523073, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:18:24,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=6090, skipped=29, lr=[4.2975786750980933e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:18:24,931] [INFO] [timer.py:258:stop] epoch=0/micro_step=6090/global_step=6090, RunningAvgSamplesPerSec=4.48526540602183, CurrSamplesPerSec=4.478922744449473, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:18:34,006] [INFO] [logging.py:96:log_dist] [Rank 0] step=6100, skipped=29, lr=[4.283961494758619e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:18:34,006] [INFO] [timer.py:258:stop] epoch=0/micro_step=6100/global_step=6100, RunningAvgSamplesPerSec=4.485262758879455, CurrSamplesPerSec=4.473783491612798, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:18:34,008] [INFO] [RANK 0]  iteration     6100/   10000 | elapsed time per iteration (ms): 906.3 | learning rate 4.283E-05 | total loss 2.525368E-01 | loss 2.525368E-01 | loss scale 32768.0 |speed 264.80 samples/(min*GPU)
[2024-06-17 20:18:34,009] [INFO] [RANK 0] time (ms) | forward: 355.26 | backward: 546.97 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 13.59 | data loader: 0.11
[2024-06-17 20:18:43,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=6110, skipped=29, lr=[4.2703563162282576e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:18:43,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=6110/global_step=6110, RunningAvgSamplesPerSec=4.4852553114492135, CurrSamplesPerSec=4.44870780450863, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:18:52,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=6120, skipped=29, lr=[4.2567632737846283e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:18:52,124] [INFO] [timer.py:258:stop] epoch=0/micro_step=6120/global_step=6120, RunningAvgSamplesPerSec=4.485240052157491, CurrSamplesPerSec=4.477042676125344, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:19:01,183] [INFO] [logging.py:96:log_dist] [Rank 0] step=6130, skipped=29, lr=[4.243182501585572e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:19:01,184] [INFO] [timer.py:258:stop] epoch=0/micro_step=6130/global_step=6130, RunningAvgSamplesPerSec=4.485230335108975, CurrSamplesPerSec=4.480538736652295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:19:10,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=6140, skipped=29, lr=[4.229614133667827e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:19:10,224] [INFO] [timer.py:258:stop] epoch=0/micro_step=6140/global_step=6140, RunningAvgSamplesPerSec=4.4852237384981155, CurrSamplesPerSec=4.494884813529116, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:19:19,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=6150, skipped=29, lr=[4.216058303945707e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:19:19,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=6150/global_step=6150, RunningAvgSamplesPerSec=4.485225336334574, CurrSamplesPerSec=4.486053358667609, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:19:19,255] [INFO] [RANK 0]  iteration     6150/   10000 | elapsed time per iteration (ms): 904.9 | learning rate 4.215E-05 | total loss 2.067618E-01 | loss 2.067618E-01 | loss scale 32768.0 |speed 265.21 samples/(min*GPU)
[2024-06-17 20:19:19,256] [INFO] [RANK 0] time (ms) | forward: 353.80 | backward: 547.06 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 11.62 | data loader: 0.09
[2024-06-17 20:19:28,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=6160, skipped=29, lr=[4.2025151462097786e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:19:28,288] [INFO] [timer.py:258:stop] epoch=0/micro_step=6160/global_step=6160, RunningAvgSamplesPerSec=4.4852332439370155, CurrSamplesPerSec=4.490450321302479, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:19:37,336] [INFO] [logging.py:96:log_dist] [Rank 0] step=6170, skipped=29, lr=[4.188984794125541e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:19:37,336] [INFO] [timer.py:258:stop] epoch=0/micro_step=6170/global_step=6170, RunningAvgSamplesPerSec=4.48523923009015, CurrSamplesPerSec=4.4868043864587275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:19:46,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=6180, skipped=29, lr=[4.175467381232108e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:19:46,404] [INFO] [timer.py:258:stop] epoch=0/micro_step=6180/global_step=6180, RunningAvgSamplesPerSec=4.4852342923126445, CurrSamplesPerSec=4.488544953762723, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:19:55,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=6190, skipped=29, lr=[4.161963040940887e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:19:55,495] [INFO] [timer.py:258:stop] epoch=0/micro_step=6190/global_step=6190, RunningAvgSamplesPerSec=4.485220430491418, CurrSamplesPerSec=4.473654654412828, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:20:04,543] [INFO] [logging.py:96:log_dist] [Rank 0] step=6200, skipped=29, lr=[4.148471906534263e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:20:04,544] [INFO] [timer.py:258:stop] epoch=0/micro_step=6200/global_step=6200, RunningAvgSamplesPerSec=4.4852208791518695, CurrSamplesPerSec=4.490922708513237, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:20:04,545] [INFO] [RANK 0]  iteration     6200/   10000 | elapsed time per iteration (ms): 905.8 | learning rate 4.147E-05 | total loss 2.347686E-01 | loss 2.347686E-01 | loss scale 32768.0 |speed 264.96 samples/(min*GPU)
[2024-06-17 20:20:04,546] [INFO] [RANK 0] time (ms) | forward: 354.81 | backward: 546.97 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 13.34 | data loader: 0.09
[2024-06-17 20:20:13,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=6210, skipped=29, lr=[4.1349941111642894e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:20:13,603] [INFO] [timer.py:258:stop] epoch=0/micro_step=6210/global_step=6210, RunningAvgSamplesPerSec=4.485212691197922, CurrSamplesPerSec=4.489622380975828, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:20:22,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=6220, skipped=29, lr=[4.121529787851363e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:20:22,644] [INFO] [timer.py:258:stop] epoch=0/micro_step=6220/global_step=6220, RunningAvgSamplesPerSec=4.485203958229424, CurrSamplesPerSec=4.480933641798076, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:20:31,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=6230, skipped=29, lr=[4.108079069482919e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:20:31,728] [INFO] [timer.py:258:stop] epoch=0/micro_step=6230/global_step=6230, RunningAvgSamplesPerSec=4.4851953952322265, CurrSamplesPerSec=4.483099677339622, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:20:40,797] [INFO] [logging.py:96:log_dist] [Rank 0] step=6240, skipped=29, lr=[4.094642088812117e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:20:40,798] [INFO] [timer.py:258:stop] epoch=0/micro_step=6240/global_step=6240, RunningAvgSamplesPerSec=4.485189999810056, CurrSamplesPerSec=4.485367335813795, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:20:49,883] [INFO] [logging.py:96:log_dist] [Rank 0] step=6250, skipped=29, lr=[4.081218978456534e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:20:49,883] [INFO] [timer.py:258:stop] epoch=0/micro_step=6250/global_step=6250, RunningAvgSamplesPerSec=4.485175959980055, CurrSamplesPerSec=4.487153592030263, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:20:49,894] [INFO] [RANK 0]  iteration     6250/   10000 | elapsed time per iteration (ms): 907.0 | learning rate 4.080E-05 | total loss 2.271426E-01 | loss 2.271426E-01 | loss scale 32768.0 |speed 264.62 samples/(min*GPU)
[2024-06-17 20:20:49,903] [INFO] [RANK 0] time (ms) | forward: 355.68 | backward: 547.04 | allreduce: 0.00 | optimizer: 3.45 | batch generator: 13.24 | data loader: 0.08
[2024-06-17 20:20:58,976] [INFO] [logging.py:96:log_dist] [Rank 0] step=6260, skipped=29, lr=[4.067809870896848e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:20:58,977] [INFO] [timer.py:258:stop] epoch=0/micro_step=6260/global_step=6260, RunningAvgSamplesPerSec=4.485173682962413, CurrSamplesPerSec=4.488568971029479, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:21:08,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=6270, skipped=29, lr=[4.054414898475538e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:21:08,009] [INFO] [timer.py:258:stop] epoch=0/micro_step=6270/global_step=6270, RunningAvgSamplesPerSec=4.485176510339259, CurrSamplesPerSec=4.4923091917776565, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:21:17,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=6280, skipped=29, lr=[4.041034193395573e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:21:17,072] [INFO] [timer.py:258:stop] epoch=0/micro_step=6280/global_step=6280, RunningAvgSamplesPerSec=4.485163857534378, CurrSamplesPerSec=4.484441777448709, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:21:26,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=6290, skipped=29, lr=[4.027667887719112e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:21:26,122] [INFO] [timer.py:258:stop] epoch=0/micro_step=6290/global_step=6290, RunningAvgSamplesPerSec=4.485160036699765, CurrSamplesPerSec=4.489347269566353, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:21:35,177] [INFO] [logging.py:96:log_dist] [Rank 0] step=6300, skipped=29, lr=[4.014316113366195e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:21:35,177] [INFO] [timer.py:258:stop] epoch=0/micro_step=6300/global_step=6300, RunningAvgSamplesPerSec=4.485160753079004, CurrSamplesPerSec=4.494807742747169, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:21:35,179] [INFO] [RANK 0]  iteration     6300/   10000 | elapsed time per iteration (ms): 905.7 | learning rate 4.013E-05 | total loss 2.434573E-01 | loss 2.434573E-01 | loss scale 32768.0 |speed 264.99 samples/(min*GPU)
[2024-06-17 20:21:35,179] [INFO] [RANK 0] time (ms) | forward: 353.93 | backward: 547.24 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 12.45 | data loader: 0.09
[2024-06-17 20:21:35,180] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:21:35,194] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/6300/mp_rank_00_model_states.pt
[2024-06-17 20:21:35,194] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/6300/mp_rank_00_model_states.pt...
[2024-06-17 20:21:56,271] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/6300/mp_rank_00_model_states.pt.
[2024-06-17 20:22:05,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=6310, skipped=29, lr=[4.000979002113443e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:22:05,277] [INFO] [timer.py:258:stop] epoch=0/micro_step=6310/global_step=6310, RunningAvgSamplesPerSec=4.485201564914758, CurrSamplesPerSec=4.507626891408349, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:22:14,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=6320, skipped=29, lr=[3.987656685592761e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:22:14,254] [INFO] [timer.py:258:stop] epoch=0/micro_step=6320/global_step=6320, RunningAvgSamplesPerSec=4.485256359574307, CurrSamplesPerSec=4.517495814968425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:22:23,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=6330, skipped=29, lr=[3.974349295290035e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:22:23,256] [INFO] [timer.py:258:stop] epoch=0/micro_step=6330/global_step=6330, RunningAvgSamplesPerSec=4.485294651348615, CurrSamplesPerSec=4.510404417596185, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:22:32,246] [INFO] [logging.py:96:log_dist] [Rank 0] step=6340, skipped=29, lr=[3.961056962543833e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:22:32,246] [INFO] [timer.py:258:stop] epoch=0/micro_step=6340/global_step=6340, RunningAvgSamplesPerSec=4.485330517182859, CurrSamplesPerSec=4.510123116146608, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:22:41,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=6350, skipped=29, lr=[3.947779818544116e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:22:41,287] [INFO] [timer.py:258:stop] epoch=0/micro_step=6350/global_step=6350, RunningAvgSamplesPerSec=4.485343881909257, CurrSamplesPerSec=4.474847875268122, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:22:41,287] [INFO] [RANK 0]  iteration     6350/   10000 | elapsed time per iteration (ms): 1322.2 | learning rate 3.946E-05 | total loss 2.493422E-01 | loss 2.493422E-01 | loss scale 32768.0 |speed 181.52 samples/(min*GPU)
[2024-06-17 20:22:41,288] [INFO] [RANK 0] time (ms) | forward: 352.35 | backward: 543.72 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 12.37 | data loader: 0.09
[2024-06-17 20:22:50,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=6360, skipped=29, lr=[3.934517994330933e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:22:50,292] [INFO] [timer.py:258:stop] epoch=0/micro_step=6360/global_step=6360, RunningAvgSamplesPerSec=4.485356100391119, CurrSamplesPerSec=4.498285782924108, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:22:58,397] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 20:22:59,296] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 20:22:59,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=6370, skipped=31, lr=[3.922595559139335e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:22:59,298] [INFO] [timer.py:258:stop] epoch=0/micro_step=6370/global_step=6370, RunningAvgSamplesPerSec=4.485360727088677, CurrSamplesPerSec=4.486611206729643, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:23:08,357] [INFO] [logging.py:96:log_dist] [Rank 0] step=6380, skipped=31, lr=[3.9106857343091636e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:23:08,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=6380/global_step=6380, RunningAvgSamplesPerSec=4.485360337544529, CurrSamplesPerSec=4.484082207560861, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:23:17,420] [INFO] [logging.py:96:log_dist] [Rank 0] step=6390, skipped=31, lr=[3.8974675013393864e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:23:17,420] [INFO] [timer.py:258:stop] epoch=0/micro_step=6390/global_step=6390, RunningAvgSamplesPerSec=4.485355167629546, CurrSamplesPerSec=4.464394273025182, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:23:26,482] [INFO] [logging.py:96:log_dist] [Rank 0] step=6400, skipped=31, lr=[3.8842650847184014e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:23:26,482] [INFO] [timer.py:258:stop] epoch=0/micro_step=6400/global_step=6400, RunningAvgSamplesPerSec=4.485351938560159, CurrSamplesPerSec=4.489481817658794, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:23:26,484] [INFO] [RANK 0]  iteration     6400/   10000 | elapsed time per iteration (ms): 903.9 | learning rate 3.883E-05 | total loss 2.218898E-01 | loss 2.218898E-01 | loss scale 32768.0 |speed 265.51 samples/(min*GPU)
[2024-06-17 20:23:26,484] [INFO] [RANK 0] time (ms) | forward: 353.15 | backward: 546.83 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 11.79 | data loader: 0.09
[2024-06-17 20:23:35,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=6410, skipped=31, lr=[3.871078614748732e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:23:35,537] [INFO] [timer.py:258:stop] epoch=0/micro_step=6410/global_step=6410, RunningAvgSamplesPerSec=4.48534799087845, CurrSamplesPerSec=4.485451278391964, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:23:44,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=6420, skipped=31, lr=[3.857908221575512e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:23:44,589] [INFO] [timer.py:258:stop] epoch=0/micro_step=6420/global_step=6420, RunningAvgSamplesPerSec=4.4853406964826545, CurrSamplesPerSec=4.484914100177742, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:23:53,627] [INFO] [logging.py:96:log_dist] [Rank 0] step=6430, skipped=31, lr=[3.844754035185207e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:23:53,628] [INFO] [timer.py:258:stop] epoch=0/micro_step=6430/global_step=6430, RunningAvgSamplesPerSec=4.485338441309898, CurrSamplesPerSec=4.488402056339596, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:24:02,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=6440, skipped=31, lr=[3.831616185404325e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:24:02,679] [INFO] [timer.py:258:stop] epoch=0/micro_step=6440/global_step=6440, RunningAvgSamplesPerSec=4.485332962471306, CurrSamplesPerSec=4.486674798219902, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:24:11,734] [INFO] [logging.py:96:log_dist] [Rank 0] step=6450, skipped=31, lr=[3.818494801898138e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:24:11,735] [INFO] [timer.py:258:stop] epoch=0/micro_step=6450/global_step=6450, RunningAvgSamplesPerSec=4.485317986609904, CurrSamplesPerSec=4.476126520914957, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:24:11,737] [INFO] [RANK 0]  iteration     6450/   10000 | elapsed time per iteration (ms): 905.1 | learning rate 3.817E-05 | total loss 2.106631E-01 | loss 2.106631E-01 | loss scale 32768.0 |speed 265.18 samples/(min*GPU)
[2024-06-17 20:24:11,739] [INFO] [RANK 0] time (ms) | forward: 354.00 | backward: 547.12 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 11.88 | data loader: 0.09
[2024-06-17 20:24:20,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=6460, skipped=31, lr=[3.8053900141694055e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:24:20,793] [INFO] [timer.py:258:stop] epoch=0/micro_step=6460/global_step=6460, RunningAvgSamplesPerSec=4.485315611287957, CurrSamplesPerSec=4.484963256227996, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:24:29,854] [INFO] [logging.py:96:log_dist] [Rank 0] step=6470, skipped=31, lr=[3.792301951557092e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:24:29,855] [INFO] [timer.py:258:stop] epoch=0/micro_step=6470/global_step=6470, RunningAvgSamplesPerSec=4.485310331331855, CurrSamplesPerSec=4.474753587664914, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:24:38,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=6480, skipped=31, lr=[3.779230743235092e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:24:38,919] [INFO] [timer.py:258:stop] epoch=0/micro_step=6480/global_step=6480, RunningAvgSamplesPerSec=4.4853072948993455, CurrSamplesPerSec=4.475499642540841, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:24:47,962] [INFO] [logging.py:96:log_dist] [Rank 0] step=6490, skipped=31, lr=[3.766176518210951e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:24:47,963] [INFO] [timer.py:258:stop] epoch=0/micro_step=6490/global_step=6490, RunningAvgSamplesPerSec=4.485307958539671, CurrSamplesPerSec=4.478427773635834, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:24:57,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=6500, skipped=31, lr=[3.7531394053246044e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:24:57,000] [INFO] [timer.py:258:stop] epoch=0/micro_step=6500/global_step=6500, RunningAvgSamplesPerSec=4.48530891484429, CurrSamplesPerSec=4.486812785954748, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:24:57,002] [INFO] [RANK 0]  iteration     6500/   10000 | elapsed time per iteration (ms): 905.3 | learning rate 3.752E-05 | total loss 2.221460E-01 | loss 2.221460E-01 | loss scale 32768.0 |speed 265.10 samples/(min*GPU)
[2024-06-17 20:24:57,003] [INFO] [RANK 0] time (ms) | forward: 353.99 | backward: 547.22 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 12.63 | data loader: 0.09
[2024-06-17 20:25:06,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=6510, skipped=31, lr=[3.7401195332470904e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:25:06,056] [INFO] [timer.py:258:stop] epoch=0/micro_step=6510/global_step=6510, RunningAvgSamplesPerSec=4.485304639634311, CurrSamplesPerSec=4.491856957469406, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:25:15,095] [INFO] [logging.py:96:log_dist] [Rank 0] step=6520, skipped=31, lr=[3.7271170304792915e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:25:15,096] [INFO] [timer.py:258:stop] epoch=0/micro_step=6520/global_step=6520, RunningAvgSamplesPerSec=4.485303487394572, CurrSamplesPerSec=4.483393193090474, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:25:24,136] [INFO] [logging.py:96:log_dist] [Rank 0] step=6530, skipped=31, lr=[3.7141320253506584e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:25:24,137] [INFO] [timer.py:258:stop] epoch=0/micro_step=6530/global_step=6530, RunningAvgSamplesPerSec=4.485298045140483, CurrSamplesPerSec=4.477680742297404, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:25:33,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=6540, skipped=31, lr=[3.7011646460179525e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:25:33,198] [INFO] [timer.py:258:stop] epoch=0/micro_step=6540/global_step=6540, RunningAvgSamplesPerSec=4.485300975418926, CurrSamplesPerSec=4.4838041797165324, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:25:42,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=6550, skipped=31, lr=[3.68821502046397e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:25:42,251] [INFO] [timer.py:258:stop] epoch=0/micro_step=6550/global_step=6550, RunningAvgSamplesPerSec=4.4852970706584925, CurrSamplesPerSec=4.47606919902684, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:25:42,252] [INFO] [RANK 0]  iteration     6550/   10000 | elapsed time per iteration (ms): 905.0 | learning rate 3.687E-05 | total loss 2.584732E-01 | loss 2.584732E-01 | loss scale 32768.0 |speed 265.19 samples/(min*GPU)
[2024-06-17 20:25:42,252] [INFO] [RANK 0] time (ms) | forward: 353.70 | backward: 547.30 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 12.34 | data loader: 0.08
[2024-06-17 20:25:51,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=6560, skipped=31, lr=[3.675283276496289e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:25:51,317] [INFO] [timer.py:258:stop] epoch=0/micro_step=6560/global_step=6560, RunningAvgSamplesPerSec=4.485297434885849, CurrSamplesPerSec=4.490411861579222, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:26:00,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=6570, skipped=31, lr=[3.662369541746001e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:26:00,369] [INFO] [timer.py:258:stop] epoch=0/micro_step=6570/global_step=6570, RunningAvgSamplesPerSec=4.485289154607117, CurrSamplesPerSec=4.487746525966644, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:26:09,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=6580, skipped=31, lr=[3.6494739436664554e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:26:09,404] [INFO] [timer.py:258:stop] epoch=0/micro_step=6580/global_step=6580, RunningAvgSamplesPerSec=4.485286282780205, CurrSamplesPerSec=4.475970083392783, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:26:18,441] [INFO] [logging.py:96:log_dist] [Rank 0] step=6590, skipped=31, lr=[3.636596609531997e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:26:18,441] [INFO] [timer.py:258:stop] epoch=0/micro_step=6590/global_step=6590, RunningAvgSamplesPerSec=4.48528488853385, CurrSamplesPerSec=4.487004783010097, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:26:27,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=6600, skipped=31, lr=[3.623737666436716e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:26:27,491] [INFO] [timer.py:258:stop] epoch=0/micro_step=6600/global_step=6600, RunningAvgSamplesPerSec=4.485290410959481, CurrSamplesPerSec=4.4776460860934275, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:26:27,492] [INFO] [RANK 0]  iteration     6600/   10000 | elapsed time per iteration (ms): 904.8 | learning rate 3.622E-05 | total loss 2.348969E-01 | loss 2.348969E-01 | loss scale 32768.0 |speed 265.25 samples/(min*GPU)
[2024-06-17 20:26:27,493] [INFO] [RANK 0] time (ms) | forward: 353.63 | backward: 547.21 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 12.29 | data loader: 0.08
[2024-06-17 20:26:27,493] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:26:27,505] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/6600/mp_rank_00_model_states.pt
[2024-06-17 20:26:27,505] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/6600/mp_rank_00_model_states.pt...
[2024-06-17 20:26:48,426] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/6600/mp_rank_00_model_states.pt.
[2024-06-17 20:26:57,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=6610, skipped=31, lr=[3.610897241293191e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:26:57,428] [INFO] [timer.py:258:stop] epoch=0/micro_step=6610/global_step=6610, RunningAvgSamplesPerSec=4.485343282387297, CurrSamplesPerSec=4.512431552563624, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:27:06,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=6620, skipped=31, lr=[3.5980754608312324e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:27:06,411] [INFO] [timer.py:258:stop] epoch=0/micro_step=6620/global_step=6620, RunningAvgSamplesPerSec=4.485392232869956, CurrSamplesPerSec=4.517343770362385, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:27:15,440] [INFO] [logging.py:96:log_dist] [Rank 0] step=6630, skipped=31, lr=[3.5852724515966354e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:27:15,440] [INFO] [timer.py:258:stop] epoch=0/micro_step=6630/global_step=6630, RunningAvgSamplesPerSec=4.48540320244514, CurrSamplesPerSec=4.477934107395369, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:27:24,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=6640, skipped=31, lr=[3.572488339949937e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:27:24,453] [INFO] [timer.py:258:stop] epoch=0/micro_step=6640/global_step=6640, RunningAvgSamplesPerSec=4.485434827812647, CurrSamplesPerSec=4.494971521318086, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:27:33,486] [INFO] [logging.py:96:log_dist] [Rank 0] step=6650, skipped=31, lr=[3.559723252065153e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:27:33,486] [INFO] [timer.py:258:stop] epoch=0/micro_step=6650/global_step=6650, RunningAvgSamplesPerSec=4.485442841421966, CurrSamplesPerSec=4.493221153781775, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:27:33,487] [INFO] [RANK 0]  iteration     6650/   10000 | elapsed time per iteration (ms): 1319.9 | learning rate 3.558E-05 | total loss 2.511195E-01 | loss 2.511195E-01 | loss scale 32768.0 |speed 181.83 samples/(min*GPU)
[2024-06-17 20:27:33,487] [INFO] [RANK 0] time (ms) | forward: 352.79 | backward: 544.05 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 12.64 | data loader: 0.09
[2024-06-17 20:27:42,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=6660, skipped=31, lr=[3.546977313928552e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:27:42,561] [INFO] [timer.py:258:stop] epoch=0/micro_step=6660/global_step=6660, RunningAvgSamplesPerSec=4.4854434068631654, CurrSamplesPerSec=4.496630451796056, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:27:51,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=6670, skipped=31, lr=[3.534250651337393e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:27:51,622] [INFO] [timer.py:258:stop] epoch=0/micro_step=6670/global_step=6670, RunningAvgSamplesPerSec=4.485452980439544, CurrSamplesPerSec=4.495417155782942, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:28:00,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=6680, skipped=31, lr=[3.5215433898987026e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:28:00,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=6680/global_step=6680, RunningAvgSamplesPerSec=4.485447628532205, CurrSamplesPerSec=4.470077615875619, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:28:09,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=6690, skipped=31, lr=[3.508855655028016e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:28:09,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=6690/global_step=6690, RunningAvgSamplesPerSec=4.485446753596025, CurrSamplesPerSec=4.488683056556625, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:28:18,806] [INFO] [logging.py:96:log_dist] [Rank 0] step=6700, skipped=31, lr=[3.496187571948159e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:28:18,806] [INFO] [timer.py:258:stop] epoch=0/micro_step=6700/global_step=6700, RunningAvgSamplesPerSec=4.485439987336128, CurrSamplesPerSec=4.486104938796487, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:28:18,808] [INFO] [RANK 0]  iteration     6700/   10000 | elapsed time per iteration (ms): 906.4 | learning rate 3.495E-05 | total loss 2.199118E-01 | loss 2.199118E-01 | loss scale 32768.0 |speed 264.78 samples/(min*GPU)
[2024-06-17 20:28:18,809] [INFO] [RANK 0] time (ms) | forward: 355.37 | backward: 546.99 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 14.05 | data loader: 0.11
[2024-06-17 20:28:27,841] [INFO] [logging.py:96:log_dist] [Rank 0] step=6710, skipped=31, lr=[3.483539265687995e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:28:27,842] [INFO] [timer.py:258:stop] epoch=0/micro_step=6710/global_step=6710, RunningAvgSamplesPerSec=4.485437940615204, CurrSamplesPerSec=4.489867486787751, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:28:36,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=6720, skipped=31, lr=[3.470910861081199e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:28:36,875] [INFO] [timer.py:258:stop] epoch=0/micro_step=6720/global_step=6720, RunningAvgSamplesPerSec=4.485435130634686, CurrSamplesPerSec=4.474394376369144, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:28:45,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=6730, skipped=31, lr=[3.4583024827650295e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:28:45,925] [INFO] [timer.py:258:stop] epoch=0/micro_step=6730/global_step=6730, RunningAvgSamplesPerSec=4.485410804615829, CurrSamplesPerSec=4.480994678803862, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:28:54,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=6740, skipped=31, lr=[3.4457142551790866e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:28:54,997] [INFO] [timer.py:258:stop] epoch=0/micro_step=6740/global_step=6740, RunningAvgSamplesPerSec=4.485394122491342, CurrSamplesPerSec=4.475087789491934, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:29:04,041] [INFO] [logging.py:96:log_dist] [Rank 0] step=6750, skipped=31, lr=[3.433146302564098e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:29:04,042] [INFO] [timer.py:258:stop] epoch=0/micro_step=6750/global_step=6750, RunningAvgSamplesPerSec=4.485382037266815, CurrSamplesPerSec=4.479189404505349, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:29:04,043] [INFO] [RANK 0]  iteration     6750/   10000 | elapsed time per iteration (ms): 904.7 | learning rate 3.432E-05 | total loss 1.945091E-01 | loss 1.945091E-01 | loss scale 32768.0 |speed 265.28 samples/(min*GPU)
[2024-06-17 20:29:04,044] [INFO] [RANK 0] time (ms) | forward: 353.25 | backward: 547.25 | allreduce: 0.00 | optimizer: 3.38 | batch generator: 10.77 | data loader: 0.09
[2024-06-17 20:29:13,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=6760, skipped=31, lr=[3.4205987489606784e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:29:13,085] [INFO] [timer.py:258:stop] epoch=0/micro_step=6760/global_step=6760, RunningAvgSamplesPerSec=4.485379234437886, CurrSamplesPerSec=4.484705498685507, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:29:22,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=6770, skipped=31, lr=[3.408071718208121e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:29:22,128] [INFO] [timer.py:258:stop] epoch=0/micro_step=6770/global_step=6770, RunningAvgSamplesPerSec=4.48537807102542, CurrSamplesPerSec=4.484647956861113, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:29:23,032] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 20:29:23,934] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 20:29:31,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=6780, skipped=33, lr=[3.398064953149418e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:29:31,172] [INFO] [timer.py:258:stop] epoch=0/micro_step=6780/global_step=6780, RunningAvgSamplesPerSec=4.4853761175613265, CurrSamplesPerSec=4.4835166009839185, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:29:40,208] [INFO] [logging.py:96:log_dist] [Rank 0] step=6790, skipped=33, lr=[3.385575174956086e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:29:40,208] [INFO] [timer.py:258:stop] epoch=0/micro_step=6790/global_step=6790, RunningAvgSamplesPerSec=4.485375784164561, CurrSamplesPerSec=4.483690342057046, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:29:49,270] [INFO] [logging.py:96:log_dist] [Rank 0] step=6800, skipped=33, lr=[3.3731062652821515e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:29:49,271] [INFO] [timer.py:258:stop] epoch=0/micro_step=6800/global_step=6800, RunningAvgSamplesPerSec=4.485373459144527, CurrSamplesPerSec=4.459140136183156, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:29:49,273] [INFO] [RANK 0]  iteration     6800/   10000 | elapsed time per iteration (ms): 904.6 | learning rate 3.372E-05 | total loss 2.589092E-01 | loss 2.589092E-01 | loss scale 32768.0 |speed 265.31 samples/(min*GPU)
[2024-06-17 20:29:49,274] [INFO] [RANK 0] time (ms) | forward: 353.47 | backward: 547.21 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 12.04 | data loader: 0.09
[2024-06-17 20:29:58,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=6810, skipped=33, lr=[3.360658347190715e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:29:58,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=6810/global_step=6810, RunningAvgSamplesPerSec=4.485372360196692, CurrSamplesPerSec=4.481615914673824, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:30:07,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=6820, skipped=33, lr=[3.348231543537707e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:30:07,383] [INFO] [timer.py:258:stop] epoch=0/micro_step=6820/global_step=6820, RunningAvgSamplesPerSec=4.485368898693672, CurrSamplesPerSec=4.4811071827401205, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:30:16,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=6830, skipped=33, lr=[3.335825976970658e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:30:16,419] [INFO] [timer.py:258:stop] epoch=0/micro_step=6830/global_step=6830, RunningAvgSamplesPerSec=4.485369437149936, CurrSamplesPerSec=4.480948003296901, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:30:25,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=6840, skipped=33, lr=[3.323441769927506e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:30:25,471] [INFO] [timer.py:258:stop] epoch=0/micro_step=6840/global_step=6840, RunningAvgSamplesPerSec=4.485364730392786, CurrSamplesPerSec=4.4826864243975555, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:30:34,529] [INFO] [logging.py:96:log_dist] [Rank 0] step=6850, skipped=33, lr=[3.311079044635372e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:30:34,529] [INFO] [timer.py:258:stop] epoch=0/micro_step=6850/global_step=6850, RunningAvgSamplesPerSec=4.485358378575336, CurrSamplesPerSec=4.483580104780321, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:30:34,531] [INFO] [RANK 0]  iteration     6850/   10000 | elapsed time per iteration (ms): 905.2 | learning rate 3.310E-05 | total loss 2.267152E-01 | loss 2.267152E-01 | loss scale 32768.0 |speed 265.15 samples/(min*GPU)
[2024-06-17 20:30:34,531] [INFO] [RANK 0] time (ms) | forward: 353.61 | backward: 547.21 | allreduce: 0.00 | optimizer: 3.56 | batch generator: 12.05 | data loader: 0.09
[2024-06-17 20:30:43,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=6860, skipped=33, lr=[3.298737923109363e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:30:43,602] [INFO] [timer.py:258:stop] epoch=0/micro_step=6860/global_step=6860, RunningAvgSamplesPerSec=4.485346401892275, CurrSamplesPerSec=4.472549106901265, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:30:52,636] [INFO] [logging.py:96:log_dist] [Rank 0] step=6870, skipped=33, lr=[3.286418527151369e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:30:52,636] [INFO] [timer.py:258:stop] epoch=0/micro_step=6870/global_step=6870, RunningAvgSamplesPerSec=4.485344350629359, CurrSamplesPerSec=4.487596477267408, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:31:01,667] [INFO] [logging.py:96:log_dist] [Rank 0] step=6880, skipped=33, lr=[3.274120978348852e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:31:01,667] [INFO] [timer.py:258:stop] epoch=0/micro_step=6880/global_step=6880, RunningAvgSamplesPerSec=4.485346324334048, CurrSamplesPerSec=4.474487455487731, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:31:10,717] [INFO] [logging.py:96:log_dist] [Rank 0] step=6890, skipped=33, lr=[3.2618453980736553e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:31:10,717] [INFO] [timer.py:258:stop] epoch=0/micro_step=6890/global_step=6890, RunningAvgSamplesPerSec=4.485343871764869, CurrSamplesPerSec=4.463756424698726, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:31:19,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=6900, skipped=33, lr=[3.249591907480799e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:31:19,757] [INFO] [timer.py:258:stop] epoch=0/micro_step=6900/global_step=6900, RunningAvgSamplesPerSec=4.4853374061056, CurrSamplesPerSec=4.486468432403667, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:31:19,759] [INFO] [RANK 0]  iteration     6900/   10000 | elapsed time per iteration (ms): 904.6 | learning rate 3.248E-05 | total loss 2.196559E-01 | loss 2.196559E-01 | loss scale 32768.0 |speed 265.32 samples/(min*GPU)
[2024-06-17 20:31:19,760] [INFO] [RANK 0] time (ms) | forward: 353.27 | backward: 547.27 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 11.61 | data loader: 0.08
[2024-06-17 20:31:19,761] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:31:19,779] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/6900/mp_rank_00_model_states.pt
[2024-06-17 20:31:19,780] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/6900/mp_rank_00_model_states.pt...
[2024-06-17 20:31:40,608] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/6900/mp_rank_00_model_states.pt.
[2024-06-17 20:31:49,598] [INFO] [logging.py:96:log_dist] [Rank 0] step=6910, skipped=33, lr=[3.2373606275072914e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:31:49,598] [INFO] [timer.py:258:stop] epoch=0/micro_step=6910/global_step=6910, RunningAvgSamplesPerSec=4.485400865250946, CurrSamplesPerSec=4.529122799818697, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:31:58,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=6920, skipped=33, lr=[3.225151678870924e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:31:58,570] [INFO] [timer.py:258:stop] epoch=0/micro_step=6920/global_step=6920, RunningAvgSamplesPerSec=4.485450136567387, CurrSamplesPerSec=4.5188427688134105, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:32:07,546] [INFO] [logging.py:96:log_dist] [Rank 0] step=6930, skipped=33, lr=[3.2129651820690945e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:32:07,547] [INFO] [timer.py:258:stop] epoch=0/micro_step=6930/global_step=6930, RunningAvgSamplesPerSec=4.48549675679368, CurrSamplesPerSec=4.50718246560151, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:32:16,541] [INFO] [logging.py:96:log_dist] [Rank 0] step=6940, skipped=33, lr=[3.200801257377604e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:32:16,541] [INFO] [timer.py:258:stop] epoch=0/micro_step=6940/global_step=6940, RunningAvgSamplesPerSec=4.485523830948692, CurrSamplesPerSec=4.483855708136475, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:32:25,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=6950, skipped=33, lr=[3.188660024849478e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:32:25,581] [INFO] [timer.py:258:stop] epoch=0/micro_step=6950/global_step=6950, RunningAvgSamplesPerSec=4.4855365709352775, CurrSamplesPerSec=4.4834866469873615, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:32:25,582] [INFO] [RANK 0]  iteration     6950/   10000 | elapsed time per iteration (ms): 1316.5 | learning rate 3.187E-05 | total loss 2.171380E-01 | loss 2.171380E-01 | loss scale 32768.0 |speed 182.31 samples/(min*GPU)
[2024-06-17 20:32:25,583] [INFO] [RANK 0] time (ms) | forward: 351.32 | backward: 543.96 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 12.38 | data loader: 0.09
[2024-06-17 20:32:34,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=6960, skipped=33, lr=[3.176541604313783e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:32:34,629] [INFO] [timer.py:258:stop] epoch=0/micro_step=6960/global_step=6960, RunningAvgSamplesPerSec=4.48553786821378, CurrSamplesPerSec=4.49657742418606, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:32:43,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=6970, skipped=33, lr=[3.164446115374433e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:32:43,670] [INFO] [timer.py:258:stop] epoch=0/micro_step=6970/global_step=6970, RunningAvgSamplesPerSec=4.4855419003549875, CurrSamplesPerSec=4.481920011968017, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:32:52,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=6980, skipped=33, lr=[3.152373677409025e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:32:52,719] [INFO] [timer.py:258:stop] epoch=0/micro_step=6980/global_step=6980, RunningAvgSamplesPerSec=4.485541821699033, CurrSamplesPerSec=4.491454112638019, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:33:01,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=6990, skipped=33, lr=[3.140324409567644e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:33:01,793] [INFO] [timer.py:258:stop] epoch=0/micro_step=6990/global_step=6990, RunningAvgSamplesPerSec=4.485540387676202, CurrSamplesPerSec=4.474239253110086, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:33:10,846] [INFO] [logging.py:96:log_dist] [Rank 0] step=7000, skipped=33, lr=[3.128298430771703e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:33:10,847] [INFO] [timer.py:258:stop] epoch=0/micro_step=7000/global_step=7000, RunningAvgSamplesPerSec=4.485537382003764, CurrSamplesPerSec=4.467449443273549, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:33:10,848] [INFO] [RANK 0]  iteration     7000/   10000 | elapsed time per iteration (ms): 905.3 | learning rate 3.127E-05 | total loss 2.283598E-01 | loss 2.283598E-01 | loss scale 32768.0 |speed 265.10 samples/(min*GPU)
[2024-06-17 20:33:10,849] [INFO] [RANK 0] time (ms) | forward: 353.94 | backward: 546.98 | allreduce: 0.00 | optimizer: 3.62 | batch generator: 12.61 | data loader: 0.08
[2024-06-17 20:33:17,488] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 20:33:17,488] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 20:33:17,488] [INFO] [RANK 0]  validation loss at iteration 7000 | loss: 9.312988E-01 | PPL: 2.537803E+00 loss 9.306641E-01 |
[2024-06-17 20:33:17,488] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 20:33:26,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=7010, skipped=33, lr=[3.116295859712754e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:33:26,545] [INFO] [timer.py:258:stop] epoch=0/micro_step=7010/global_step=7010, RunningAvgSamplesPerSec=4.485528935603615, CurrSamplesPerSec=4.450147425647925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:33:35,569] [INFO] [logging.py:96:log_dist] [Rank 0] step=7020, skipped=33, lr=[3.104316814851331e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:33:35,569] [INFO] [timer.py:258:stop] epoch=0/micro_step=7020/global_step=7020, RunningAvgSamplesPerSec=4.485528201060541, CurrSamplesPerSec=4.491804042384178, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:33:44,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=7030, skipped=33, lr=[3.0923614144157684e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:33:44,616] [INFO] [timer.py:258:stop] epoch=0/micro_step=7030/global_step=7030, RunningAvgSamplesPerSec=4.485526098215815, CurrSamplesPerSec=4.482457670749729, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:33:53,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=7040, skipped=33, lr=[3.0804297764010414e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:33:53,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=7040/global_step=7040, RunningAvgSamplesPerSec=4.48553119919192, CurrSamplesPerSec=4.482030167625823, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:34:02,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=7050, skipped=33, lr=[3.068522018567603e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:34:02,681] [INFO] [timer.py:258:stop] epoch=0/micro_step=7050/global_step=7050, RunningAvgSamplesPerSec=4.485527062509147, CurrSamplesPerSec=4.4842368155459384, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:34:02,681] [INFO] [RANK 0]  iteration     7050/   10000 | elapsed time per iteration (ms): 1036.7 | learning rate 3.067E-05 | total loss 2.531174E-01 | loss 2.531174E-01 | loss scale 32768.0 |speed 231.51 samples/(min*GPU)
[2024-06-17 20:34:02,682] [INFO] [RANK 0] time (ms) | forward: 352.56 | backward: 547.13 | allreduce: 0.00 | optimizer: 3.44 | batch generator: 13.91 | data loader: 0.12
[2024-06-17 20:34:11,717] [INFO] [logging.py:96:log_dist] [Rank 0] step=7060, skipped=33, lr=[3.056638258440212e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:34:11,717] [INFO] [timer.py:258:stop] epoch=0/micro_step=7060/global_step=7060, RunningAvgSamplesPerSec=4.485525898108412, CurrSamplesPerSec=4.493247627865222, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:34:20,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=7070, skipped=33, lr=[3.0447786133067868e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:34:20,749] [INFO] [timer.py:258:stop] epoch=0/micro_step=7070/global_step=7070, RunningAvgSamplesPerSec=4.485524848307939, CurrSamplesPerSec=4.483889262162897, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:34:29,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=7080, skipped=33, lr=[3.0329432002172337e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:34:29,803] [INFO] [timer.py:258:stop] epoch=0/micro_step=7080/global_step=7080, RunningAvgSamplesPerSec=4.485518577886569, CurrSamplesPerSec=4.4740089745699185, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:34:38,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=7090, skipped=33, lr=[3.0211321359823053e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:34:38,852] [INFO] [timer.py:258:stop] epoch=0/micro_step=7090/global_step=7090, RunningAvgSamplesPerSec=4.48551826281692, CurrSamplesPerSec=4.487579672437917, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:34:47,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=7100, skipped=33, lr=[3.0093455371724335e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:34:47,905] [INFO] [timer.py:258:stop] epoch=0/micro_step=7100/global_step=7100, RunningAvgSamplesPerSec=4.485518809457522, CurrSamplesPerSec=4.493454617817549, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:34:47,906] [INFO] [RANK 0]  iteration     7100/   10000 | elapsed time per iteration (ms): 904.5 | learning rate 3.008E-05 | total loss 2.371764E-01 | loss 2.371764E-01 | loss scale 32768.0 |speed 265.34 samples/(min*GPU)
[2024-06-17 20:34:47,906] [INFO] [RANK 0] time (ms) | forward: 353.46 | backward: 547.11 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 12.00 | data loader: 0.08
[2024-06-17 20:34:56,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=7110, skipped=33, lr=[2.997583520116593e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:34:56,966] [INFO] [timer.py:258:stop] epoch=0/micro_step=7110/global_step=7110, RunningAvgSamplesPerSec=4.485506264204552, CurrSamplesPerSec=4.4606730937960295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:35:06,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=7120, skipped=33, lr=[2.9858462009011436e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:35:06,027] [INFO] [timer.py:258:stop] epoch=0/micro_step=7120/global_step=7120, RunningAvgSamplesPerSec=4.485503520780568, CurrSamplesPerSec=4.48945178390326, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:35:15,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=7130, skipped=33, lr=[2.9741336953686834e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:35:15,091] [INFO] [timer.py:258:stop] epoch=0/micro_step=7130/global_step=7130, RunningAvgSamplesPerSec=4.48550033332794, CurrSamplesPerSec=4.474023291715524, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:35:24,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=7140, skipped=33, lr=[2.962446119116919e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:35:24,160] [INFO] [timer.py:258:stop] epoch=0/micro_step=7140/global_step=7140, RunningAvgSamplesPerSec=4.48549538722058, CurrSamplesPerSec=4.4886974677725995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:35:33,206] [INFO] [logging.py:96:log_dist] [Rank 0] step=7150, skipped=33, lr=[2.9507835874975054e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:35:33,207] [INFO] [timer.py:258:stop] epoch=0/micro_step=7150/global_step=7150, RunningAvgSamplesPerSec=4.485491094504214, CurrSamplesPerSec=4.463257675922236, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:35:33,208] [INFO] [RANK 0]  iteration     7150/   10000 | elapsed time per iteration (ms): 906.0 | learning rate 2.950E-05 | total loss 2.275896E-01 | loss 2.275896E-01 | loss scale 32768.0 |speed 264.89 samples/(min*GPU)
[2024-06-17 20:35:33,209] [INFO] [RANK 0] time (ms) | forward: 354.95 | backward: 547.12 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 12.87 | data loader: 0.10
[2024-06-17 20:35:42,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=7160, skipped=33, lr=[2.9391462156149244e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:35:42,263] [INFO] [timer.py:258:stop] epoch=0/micro_step=7160/global_step=7160, RunningAvgSamplesPerSec=4.4854885789479075, CurrSamplesPerSec=4.486508024373429, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:35:51,323] [INFO] [logging.py:96:log_dist] [Rank 0] step=7170, skipped=33, lr=[2.9275341183253348e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:35:51,323] [INFO] [timer.py:258:stop] epoch=0/micro_step=7170/global_step=7170, RunningAvgSamplesPerSec=4.485472497410397, CurrSamplesPerSec=4.479590052164644, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:35:54,050] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 20:35:54,957] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 20:36:00,399] [INFO] [logging.py:96:log_dist] [Rank 0] step=7180, skipped=35, lr=[2.9182627152247397e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:36:00,400] [INFO] [timer.py:258:stop] epoch=0/micro_step=7180/global_step=7180, RunningAvgSamplesPerSec=4.4854617170548075, CurrSamplesPerSec=4.481849371515338, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:36:09,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=7190, skipped=35, lr=[2.9066964008431023e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:36:09,460] [INFO] [timer.py:258:stop] epoch=0/micro_step=7190/global_step=7190, RunningAvgSamplesPerSec=4.4854589125577515, CurrSamplesPerSec=4.4878257557276084, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:36:18,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=7200, skipped=35, lr=[2.8951556813210283e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:36:18,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=7200/global_step=7200, RunningAvgSamplesPerSec=4.485461700878822, CurrSamplesPerSec=4.484133742371298, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:36:18,515] [INFO] [RANK 0]  iteration     7200/   10000 | elapsed time per iteration (ms): 906.1 | learning rate 2.894E-05 | total loss 2.761940E-01 | loss 2.761940E-01 | loss scale 32768.0 |speed 264.86 samples/(min*GPU)
[2024-06-17 20:36:18,515] [INFO] [RANK 0] time (ms) | forward: 355.04 | backward: 547.13 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 12.92 | data loader: 0.09
[2024-06-17 20:36:18,516] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:36:18,528] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/7200/mp_rank_00_model_states.pt
[2024-06-17 20:36:18,528] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/7200/mp_rank_00_model_states.pt...
[2024-06-17 20:36:39,488] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/7200/mp_rank_00_model_states.pt.
[2024-06-17 20:36:48,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=7210, skipped=35, lr=[2.8836406705607624e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:36:48,493] [INFO] [timer.py:258:stop] epoch=0/micro_step=7210/global_step=7210, RunningAvgSamplesPerSec=4.485520848999819, CurrSamplesPerSec=4.521968067128139, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:36:57,482] [INFO] [logging.py:96:log_dist] [Rank 0] step=7220, skipped=35, lr=[2.872151482210812e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:36:57,483] [INFO] [timer.py:258:stop] epoch=0/micro_step=7220/global_step=7220, RunningAvgSamplesPerSec=4.485562670056558, CurrSamplesPerSec=4.515466559009554, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:37:06,481] [INFO] [logging.py:96:log_dist] [Rank 0] step=7230, skipped=35, lr=[2.8606882296648244e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:37:06,482] [INFO] [timer.py:258:stop] epoch=0/micro_step=7230/global_step=7230, RunningAvgSamplesPerSec=4.485594688339308, CurrSamplesPerSec=4.5099158000394075, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:37:15,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=7240, skipped=35, lr=[2.849251026060479e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:37:15,483] [INFO] [timer.py:258:stop] epoch=0/micro_step=7240/global_step=7240, RunningAvgSamplesPerSec=4.485621816455291, CurrSamplesPerSec=4.484885326404399, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:37:24,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=7250, skipped=35, lr=[2.8378399842783535e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:37:24,526] [INFO] [timer.py:258:stop] epoch=0/micro_step=7250/global_step=7250, RunningAvgSamplesPerSec=4.485626010173178, CurrSamplesPerSec=4.486497226494194, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:37:24,526] [INFO] [RANK 0]  iteration     7250/   10000 | elapsed time per iteration (ms): 1320.2 | learning rate 2.837E-05 | total loss 3.172083E-01 | loss 3.172083E-01 | loss scale 32768.0 |speed 181.79 samples/(min*GPU)
[2024-06-17 20:37:24,526] [INFO] [RANK 0] time (ms) | forward: 352.67 | backward: 543.66 | allreduce: 0.00 | optimizer: 3.34 | batch generator: 12.75 | data loader: 0.08
[2024-06-17 20:37:33,554] [INFO] [logging.py:96:log_dist] [Rank 0] step=7260, skipped=35, lr=[2.826455216940827e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:37:33,555] [INFO] [timer.py:258:stop] epoch=0/micro_step=7260/global_step=7260, RunningAvgSamplesPerSec=4.485629215455584, CurrSamplesPerSec=4.482864892408085, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:37:42,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=7270, skipped=35, lr=[2.8150968364109545e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:37:42,580] [INFO] [timer.py:258:stop] epoch=0/micro_step=7270/global_step=7270, RunningAvgSamplesPerSec=4.485635531619925, CurrSamplesPerSec=4.489719699197738, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:37:51,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=7280, skipped=35, lr=[2.803764954791369e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:37:51,604] [INFO] [timer.py:258:stop] epoch=0/micro_step=7280/global_step=7280, RunningAvgSamplesPerSec=4.485634182464434, CurrSamplesPerSec=4.480108010416511, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:38:00,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=7290, skipped=35, lr=[2.792459683923164e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:38:00,669] [INFO] [timer.py:258:stop] epoch=0/micro_step=7290/global_step=7290, RunningAvgSamplesPerSec=4.485631693662976, CurrSamplesPerSec=4.487002382945492, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:38:09,716] [INFO] [logging.py:96:log_dist] [Rank 0] step=7300, skipped=35, lr=[2.7811811353848024e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:38:09,716] [INFO] [timer.py:258:stop] epoch=0/micro_step=7300/global_step=7300, RunningAvgSamplesPerSec=4.485626537013518, CurrSamplesPerSec=4.478572427703632, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:38:09,718] [INFO] [RANK 0]  iteration     7300/   10000 | elapsed time per iteration (ms): 903.8 | learning rate 2.780E-05 | total loss 2.069655E-01 | loss 2.069655E-01 | loss scale 32768.0 |speed 265.54 samples/(min*GPU)
[2024-06-17 20:38:09,719] [INFO] [RANK 0] time (ms) | forward: 352.83 | backward: 547.02 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 11.59 | data loader: 0.08
[2024-06-17 20:38:18,770] [INFO] [logging.py:96:log_dist] [Rank 0] step=7310, skipped=35, lr=[2.7699294204910024e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:38:18,771] [INFO] [timer.py:258:stop] epoch=0/micro_step=7310/global_step=7310, RunningAvgSamplesPerSec=4.4856287423858925, CurrSamplesPerSec=4.479408256881959, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:38:27,803] [INFO] [logging.py:96:log_dist] [Rank 0] step=7320, skipped=35, lr=[2.758704650291647e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:38:27,803] [INFO] [timer.py:258:stop] epoch=0/micro_step=7320/global_step=7320, RunningAvgSamplesPerSec=4.485624980648894, CurrSamplesPerSec=4.484526884094501, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:38:36,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=7330, skipped=35, lr=[2.7475069355706884e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:38:36,858] [INFO] [timer.py:258:stop] epoch=0/micro_step=7330/global_step=7330, RunningAvgSamplesPerSec=4.485622657600962, CurrSamplesPerSec=4.475182091179761, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:38:45,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=7340, skipped=35, lr=[2.7363363868450482e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:38:45,924] [INFO] [timer.py:258:stop] epoch=0/micro_step=7340/global_step=7340, RunningAvgSamplesPerSec=4.485621090894389, CurrSamplesPerSec=4.47149177514099, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:38:54,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=7350, skipped=35, lr=[2.725193114363535e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:38:54,972] [INFO] [timer.py:258:stop] epoch=0/micro_step=7350/global_step=7350, RunningAvgSamplesPerSec=4.485619589984667, CurrSamplesPerSec=4.4864636334245125, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:38:54,973] [INFO] [RANK 0]  iteration     7350/   10000 | elapsed time per iteration (ms): 905.1 | learning rate 2.724E-05 | total loss 2.397117E-01 | loss 2.397117E-01 | loss scale 32768.0 |speed 265.16 samples/(min*GPU)
[2024-06-17 20:38:54,974] [INFO] [RANK 0] time (ms) | forward: 353.95 | backward: 547.13 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 12.63 | data loader: 0.10
[2024-06-17 20:39:04,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=7360, skipped=35, lr=[2.7140772281057464e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:39:04,024] [INFO] [timer.py:258:stop] epoch=0/micro_step=7360/global_step=7360, RunningAvgSamplesPerSec=4.4856173476326955, CurrSamplesPerSec=4.488892028245649, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:39:13,048] [INFO] [logging.py:96:log_dist] [Rank 0] step=7370, skipped=35, lr=[2.7029888377809963e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:39:13,049] [INFO] [timer.py:258:stop] epoch=0/micro_step=7370/global_step=7370, RunningAvgSamplesPerSec=4.485617318695435, CurrSamplesPerSec=4.484242808318127, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:39:22,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=7380, skipped=35, lr=[2.6919280528272166e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:39:22,080] [INFO] [timer.py:258:stop] epoch=0/micro_step=7380/global_step=7380, RunningAvgSamplesPerSec=4.485612864265754, CurrSamplesPerSec=4.487411631064996, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:39:31,116] [INFO] [logging.py:96:log_dist] [Rank 0] step=7390, skipped=35, lr=[2.6808949824098918e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:39:31,116] [INFO] [timer.py:258:stop] epoch=0/micro_step=7390/global_step=7390, RunningAvgSamplesPerSec=4.485611122896183, CurrSamplesPerSec=4.488363631694068, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:39:40,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=7400, skipped=35, lr=[2.669889735420972e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:39:40,156] [INFO] [timer.py:258:stop] epoch=0/micro_step=7400/global_step=7400, RunningAvgSamplesPerSec=4.485611035376998, CurrSamplesPerSec=4.489892719787682, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:39:40,158] [INFO] [RANK 0]  iteration     7400/   10000 | elapsed time per iteration (ms): 903.7 | learning rate 2.669E-05 | total loss 2.236560E-01 | loss 2.236560E-01 | loss scale 32768.0 |speed 265.58 samples/(min*GPU)
[2024-06-17 20:39:40,158] [INFO] [RANK 0] time (ms) | forward: 352.53 | backward: 547.16 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 11.14 | data loader: 0.08
[2024-06-17 20:39:49,178] [INFO] [logging.py:96:log_dist] [Rank 0] step=7410, skipped=35, lr=[2.6589124204778003e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:39:49,179] [INFO] [timer.py:258:stop] epoch=0/micro_step=7410/global_step=7410, RunningAvgSamplesPerSec=4.485614767426578, CurrSamplesPerSec=4.494377880776891, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:39:58,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=7420, skipped=35, lr=[2.647963145922047e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:39:58,194] [INFO] [timer.py:258:stop] epoch=0/micro_step=7420/global_step=7420, RunningAvgSamplesPerSec=4.48561736320521, CurrSamplesPerSec=4.4898422540714344, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:40:07,200] [INFO] [logging.py:96:log_dist] [Rank 0] step=7430, skipped=35, lr=[2.637042019818628e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:40:07,201] [INFO] [timer.py:258:stop] epoch=0/micro_step=7430/global_step=7430, RunningAvgSamplesPerSec=4.485623354193005, CurrSamplesPerSec=4.487195596362469, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:40:16,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=7440, skipped=35, lr=[2.6261491499546515e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:40:16,244] [INFO] [timer.py:258:stop] epoch=0/micro_step=7440/global_step=7440, RunningAvgSamplesPerSec=4.485630096586432, CurrSamplesPerSec=4.4870659855250725, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:40:25,303] [INFO] [logging.py:96:log_dist] [Rank 0] step=7450, skipped=35, lr=[2.6152846438383427e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:40:25,303] [INFO] [timer.py:258:stop] epoch=0/micro_step=7450/global_step=7450, RunningAvgSamplesPerSec=4.485627847085704, CurrSamplesPerSec=4.474676012236722, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:40:25,305] [INFO] [RANK 0]  iteration     7450/   10000 | elapsed time per iteration (ms): 902.9 | learning rate 2.614E-05 | total loss 2.228528E-01 | loss 2.228528E-01 | loss scale 32768.0 |speed 265.80 samples/(min*GPU)
[2024-06-17 20:40:25,307] [INFO] [RANK 0] time (ms) | forward: 351.80 | backward: 547.03 | allreduce: 0.00 | optimizer: 3.36 | batch generator: 10.93 | data loader: 0.08
[2024-06-17 20:40:34,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=7460, skipped=35, lr=[2.604448608697995e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:40:34,332] [INFO] [timer.py:258:stop] epoch=0/micro_step=7460/global_step=7460, RunningAvgSamplesPerSec=4.4856233492736015, CurrSamplesPerSec=4.487011983219321, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:40:43,388] [INFO] [logging.py:96:log_dist] [Rank 0] step=7470, skipped=35, lr=[2.5936411514808964e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:40:43,389] [INFO] [timer.py:258:stop] epoch=0/micro_step=7470/global_step=7470, RunningAvgSamplesPerSec=4.485627431049064, CurrSamplesPerSec=4.481226873980505, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:40:52,431] [INFO] [logging.py:96:log_dist] [Rank 0] step=7480, skipped=35, lr=[2.5828623788522894e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:40:52,432] [INFO] [timer.py:258:stop] epoch=0/micro_step=7480/global_step=7480, RunningAvgSamplesPerSec=4.485626509066905, CurrSamplesPerSec=4.484359071268236, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:41:01,456] [INFO] [logging.py:96:log_dist] [Rank 0] step=7490, skipped=35, lr=[2.5721123971943066e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:41:01,456] [INFO] [timer.py:258:stop] epoch=0/micro_step=7490/global_step=7490, RunningAvgSamplesPerSec=4.485626939876479, CurrSamplesPerSec=4.487446438601653, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:41:10,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=7500, skipped=35, lr=[2.5613913126049264e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:41:10,489] [INFO] [timer.py:258:stop] epoch=0/micro_step=7500/global_step=7500, RunningAvgSamplesPerSec=4.4856319586334354, CurrSamplesPerSec=4.494998016031962, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:41:10,490] [INFO] [RANK 0]  iteration     7500/   10000 | elapsed time per iteration (ms): 903.7 | learning rate 2.560E-05 | total loss 2.665091E-01 | loss 2.665091E-01 | loss scale 32768.0 |speed 265.57 samples/(min*GPU)
[2024-06-17 20:41:10,491] [INFO] [RANK 0] time (ms) | forward: 352.81 | backward: 546.93 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 11.53 | data loader: 0.09
[2024-06-17 20:41:10,492] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:41:10,503] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/7500/mp_rank_00_model_states.pt
[2024-06-17 20:41:10,503] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/7500/mp_rank_00_model_states.pt...
[2024-06-17 20:41:31,311] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/7500/mp_rank_00_model_states.pt.
[2024-06-17 20:41:40,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=7510, skipped=35, lr=[2.5506992308969284e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:41:40,311] [INFO] [timer.py:258:stop] epoch=0/micro_step=7510/global_step=7510, RunningAvgSamplesPerSec=4.485675945021852, CurrSamplesPerSec=4.507614780551815, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:41:49,315] [INFO] [logging.py:96:log_dist] [Rank 0] step=7520, skipped=35, lr=[2.540036257596838e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:41:49,316] [INFO] [timer.py:258:stop] epoch=0/micro_step=7520/global_step=7520, RunningAvgSamplesPerSec=4.485716334154249, CurrSamplesPerSec=4.518362056265905, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:41:58,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=7530, skipped=35, lr=[2.5294024979439014e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:41:58,304] [INFO] [timer.py:258:stop] epoch=0/micro_step=7530/global_step=7530, RunningAvgSamplesPerSec=4.485751049415541, CurrSamplesPerSec=4.512460680881394, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:42:07,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=7540, skipped=35, lr=[2.5187980568890304e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:42:07,308] [INFO] [timer.py:258:stop] epoch=0/micro_step=7540/global_step=7540, RunningAvgSamplesPerSec=4.485783532899669, CurrSamplesPerSec=4.500753558680197, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:42:16,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=7550, skipped=35, lr=[2.508223039093779e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:42:16,359] [INFO] [timer.py:258:stop] epoch=0/micro_step=7550/global_step=7550, RunningAvgSamplesPerSec=4.485791969661842, CurrSamplesPerSec=4.485796675200364, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:42:16,360] [INFO] [RANK 0]  iteration     7550/   10000 | elapsed time per iteration (ms): 1317.4 | learning rate 2.507E-05 | total loss 2.091032E-01 | loss 2.091032E-01 | loss scale 32768.0 |speed 182.18 samples/(min*GPU)
[2024-06-17 20:42:16,360] [INFO] [RANK 0] time (ms) | forward: 352.78 | backward: 543.84 | allreduce: 0.00 | optimizer: 3.27 | batch generator: 13.13 | data loader: 0.08
[2024-06-17 20:42:25,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=7560, skipped=35, lr=[2.497677548929301e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:42:25,406] [INFO] [timer.py:258:stop] epoch=0/micro_step=7560/global_step=7560, RunningAvgSamplesPerSec=4.4857962545104755, CurrSamplesPerSec=4.4934762806590705, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:42:34,434] [INFO] [logging.py:96:log_dist] [Rank 0] step=7570, skipped=35, lr=[2.48716169047533e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:42:34,435] [INFO] [timer.py:258:stop] epoch=0/micro_step=7570/global_step=7570, RunningAvgSamplesPerSec=4.485799629611555, CurrSamplesPerSec=4.4899708237278935, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:42:38,945] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 20:42:39,847] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 20:42:43,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=7580, skipped=37, lr=[2.4787704082986207e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:42:43,461] [INFO] [timer.py:258:stop] epoch=0/micro_step=7580/global_step=7580, RunningAvgSamplesPerSec=4.485805245815301, CurrSamplesPerSec=4.489116634455433, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:42:52,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=7590, skipped=37, lr=[2.4683081482703147e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:42:52,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=7590/global_step=7590, RunningAvgSamplesPerSec=4.4858080812589645, CurrSamplesPerSec=4.4875388612331335, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:43:01,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=7600, skipped=37, lr=[2.4578758098166437e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:43:01,530] [INFO] [timer.py:258:stop] epoch=0/micro_step=7600/global_step=7600, RunningAvgSamplesPerSec=4.485804352362593, CurrSamplesPerSec=4.487655295161783, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:43:01,532] [INFO] [RANK 0]  iteration     7600/   10000 | elapsed time per iteration (ms): 903.4 | learning rate 2.457E-05 | total loss 2.628400E-01 | loss 2.628400E-01 | loss scale 32768.0 |speed 265.65 samples/(min*GPU)
[2024-06-17 20:43:01,532] [INFO] [RANK 0] time (ms) | forward: 352.54 | backward: 546.99 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 11.58 | data loader: 0.10
[2024-06-17 20:43:10,582] [INFO] [logging.py:96:log_dist] [Rank 0] step=7610, skipped=37, lr=[2.4474734959005747e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:43:10,583] [INFO] [timer.py:258:stop] epoch=0/micro_step=7610/global_step=7610, RunningAvgSamplesPerSec=4.485807237333333, CurrSamplesPerSec=4.491949561868533, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:43:19,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=7620, skipped=37, lr=[2.4371013091887442e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:43:19,630] [INFO] [timer.py:258:stop] epoch=0/micro_step=7620/global_step=7620, RunningAvgSamplesPerSec=4.485808866218077, CurrSamplesPerSec=4.497867313952297, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:43:28,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=7630, skipped=37, lr=[2.4267593520504516e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:43:28,657] [INFO] [timer.py:258:stop] epoch=0/micro_step=7630/global_step=7630, RunningAvgSamplesPerSec=4.485811119304529, CurrSamplesPerSec=4.489962412403773, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:43:37,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=7640, skipped=37, lr=[2.4164477265566353e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:43:37,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=7640/global_step=7640, RunningAvgSamplesPerSec=4.4858143876604, CurrSamplesPerSec=4.48420085924917, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:43:46,729] [INFO] [logging.py:96:log_dist] [Rank 0] step=7650, skipped=37, lr=[2.4061665344788798e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:43:46,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=7650/global_step=7650, RunningAvgSamplesPerSec=4.485815315957144, CurrSamplesPerSec=4.483013426956039, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:43:46,731] [INFO] [RANK 0]  iteration     7650/   10000 | elapsed time per iteration (ms): 904.0 | learning rate 2.405E-05 | total loss 1.873667E-01 | loss 1.873667E-01 | loss scale 32768.0 |speed 265.49 samples/(min*GPU)
[2024-06-17 20:43:46,731] [INFO] [RANK 0] time (ms) | forward: 353.01 | backward: 546.99 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 12.03 | data loader: 0.08
[2024-06-17 20:43:55,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=7660, skipped=37, lr=[2.3959158772883955e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:43:55,776] [INFO] [timer.py:258:stop] epoch=0/micro_step=7660/global_step=7660, RunningAvgSamplesPerSec=4.485813686886454, CurrSamplesPerSec=4.4887995498683235, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:44:04,823] [INFO] [logging.py:96:log_dist] [Rank 0] step=7670, skipped=37, lr=[2.3856958561550342e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:44:04,824] [INFO] [timer.py:258:stop] epoch=0/micro_step=7670/global_step=7670, RunningAvgSamplesPerSec=4.48580984424983, CurrSamplesPerSec=4.485902223724307, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:44:13,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=7680, skipped=37, lr=[2.3755065719462758e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:44:13,887] [INFO] [timer.py:258:stop] epoch=0/micro_step=7680/global_step=7680, RunningAvgSamplesPerSec=4.4858053044599355, CurrSamplesPerSec=4.4816913365322995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:44:22,941] [INFO] [logging.py:96:log_dist] [Rank 0] step=7690, skipped=37, lr=[2.3653481252262456e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:44:22,941] [INFO] [timer.py:258:stop] epoch=0/micro_step=7690/global_step=7690, RunningAvgSamplesPerSec=4.485808839617952, CurrSamplesPerSec=4.486478030392776, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:44:31,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=7700, skipped=37, lr=[2.355220616254707e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:44:31,977] [INFO] [timer.py:258:stop] epoch=0/micro_step=7700/global_step=7700, RunningAvgSamplesPerSec=4.485806776372312, CurrSamplesPerSec=4.483726290167144, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:44:31,978] [INFO] [RANK 0]  iteration     7700/   10000 | elapsed time per iteration (ms): 905.0 | learning rate 2.354E-05 | total loss 2.285953E-01 | loss 2.285953E-01 | loss scale 32768.0 |speed 265.21 samples/(min*GPU)
[2024-06-17 20:44:31,979] [INFO] [RANK 0] time (ms) | forward: 354.09 | backward: 546.90 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 12.45 | data loader: 0.09
[2024-06-17 20:44:41,033] [INFO] [logging.py:96:log_dist] [Rank 0] step=7710, skipped=37, lr=[2.3451241449860888e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:44:41,033] [INFO] [timer.py:258:stop] epoch=0/micro_step=7710/global_step=7710, RunningAvgSamplesPerSec=4.485809995622515, CurrSamplesPerSec=4.4857570957843995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:44:50,062] [INFO] [logging.py:96:log_dist] [Rank 0] step=7720, skipped=37, lr=[2.3350588110684848e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:44:50,063] [INFO] [timer.py:258:stop] epoch=0/micro_step=7720/global_step=7720, RunningAvgSamplesPerSec=4.4858085847173435, CurrSamplesPerSec=4.486368855689836, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:44:59,115] [INFO] [logging.py:96:log_dist] [Rank 0] step=7730, skipped=37, lr=[2.3250247138426754e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:44:59,116] [INFO] [timer.py:258:stop] epoch=0/micro_step=7730/global_step=7730, RunningAvgSamplesPerSec=4.485806437311569, CurrSamplesPerSec=4.493650794501087, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:45:08,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=7740, skipped=37, lr=[2.3150219523411527e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:45:08,131] [INFO] [timer.py:258:stop] epoch=0/micro_step=7740/global_step=7740, RunningAvgSamplesPerSec=4.485807061436907, CurrSamplesPerSec=4.4714357636163555, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:45:17,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=7750, skipped=37, lr=[2.3050506252871307e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:45:17,153] [INFO] [timer.py:258:stop] epoch=0/micro_step=7750/global_step=7750, RunningAvgSamplesPerSec=4.485807689369366, CurrSamplesPerSec=4.486247689987884, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:45:17,154] [INFO] [RANK 0]  iteration     7750/   10000 | elapsed time per iteration (ms): 903.5 | learning rate 2.304E-05 | total loss 2.019823E-01 | loss 2.019823E-01 | loss scale 32768.0 |speed 265.63 samples/(min*GPU)
[2024-06-17 20:45:17,155] [INFO] [RANK 0] time (ms) | forward: 352.56 | backward: 546.97 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 11.30 | data loader: 0.08
[2024-06-17 20:45:26,217] [INFO] [logging.py:96:log_dist] [Rank 0] step=7760, skipped=37, lr=[2.295110831093586e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:45:26,217] [INFO] [timer.py:258:stop] epoch=0/micro_step=7760/global_step=7760, RunningAvgSamplesPerSec=4.485800347881043, CurrSamplesPerSec=4.484914100177742, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:45:35,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=7770, skipped=37, lr=[2.2852026678622704e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:45:35,256] [INFO] [timer.py:258:stop] epoch=0/micro_step=7770/global_step=7770, RunningAvgSamplesPerSec=4.485797018279371, CurrSamplesPerSec=4.488868007521573, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:45:44,293] [INFO] [logging.py:96:log_dist] [Rank 0] step=7780, skipped=37, lr=[2.2753262333827588e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:45:44,294] [INFO] [timer.py:258:stop] epoch=0/micro_step=7780/global_step=7780, RunningAvgSamplesPerSec=4.485800081689749, CurrSamplesPerSec=4.468290645820416, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:45:53,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=7790, skipped=37, lr=[2.2654816251314688e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:45:53,339] [INFO] [timer.py:258:stop] epoch=0/micro_step=7790/global_step=7790, RunningAvgSamplesPerSec=4.485800537173819, CurrSamplesPerSec=4.474506549118925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:46:02,376] [INFO] [logging.py:96:log_dist] [Rank 0] step=7800, skipped=37, lr=[2.2556689402707117e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:46:02,376] [INFO] [timer.py:258:stop] epoch=0/micro_step=7800/global_step=7800, RunningAvgSamplesPerSec=4.485799852547191, CurrSamplesPerSec=4.486444437610558, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:46:02,378] [INFO] [RANK 0]  iteration     7800/   10000 | elapsed time per iteration (ms): 904.5 | learning rate 2.255E-05 | total loss 1.831818E-01 | loss 1.831818E-01 | loss scale 32768.0 |speed 265.34 samples/(min*GPU)
[2024-06-17 20:46:02,379] [INFO] [RANK 0] time (ms) | forward: 353.59 | backward: 546.93 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 11.99 | data loader: 0.11
[2024-06-17 20:46:02,380] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:46:02,391] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/7800/mp_rank_00_model_states.pt
[2024-06-17 20:46:02,391] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/7800/mp_rank_00_model_states.pt...
[2024-06-17 20:46:23,140] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/7800/mp_rank_00_model_states.pt.
[2024-06-17 20:46:32,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=7810, skipped=37, lr=[2.2458882756477248e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:46:32,090] [INFO] [timer.py:258:stop] epoch=0/micro_step=7810/global_step=7810, RunningAvgSamplesPerSec=4.4858564688406855, CurrSamplesPerSec=4.520140594850064, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:46:41,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=7820, skipped=37, lr=[2.2361397277937186e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:46:41,054] [INFO] [timer.py:258:stop] epoch=0/micro_step=7820/global_step=7820, RunningAvgSamplesPerSec=4.485892200463576, CurrSamplesPerSec=4.522561704258949, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:46:50,031] [INFO] [logging.py:96:log_dist] [Rank 0] step=7830, skipped=37, lr=[2.226423392922926e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:46:50,031] [INFO] [timer.py:258:stop] epoch=0/micro_step=7830/global_step=7830, RunningAvgSamplesPerSec=4.485926173951646, CurrSamplesPerSec=4.509793359127825, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:46:59,029] [INFO] [logging.py:96:log_dist] [Rank 0] step=7840, skipped=37, lr=[2.2167393669316475e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:46:59,029] [INFO] [timer.py:258:stop] epoch=0/micro_step=7840/global_step=7840, RunningAvgSamplesPerSec=4.4859553417243445, CurrSamplesPerSec=4.507699557914206, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:47:08,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=7850, skipped=37, lr=[2.207087745397313e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:47:08,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=7850/global_step=7850, RunningAvgSamplesPerSec=4.485973358807254, CurrSamplesPerSec=4.48967043882973, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:47:08,037] [INFO] [RANK 0]  iteration     7850/   10000 | elapsed time per iteration (ms): 1313.2 | learning rate 2.206E-05 | total loss 2.874854E-01 | loss 2.874854E-01 | loss scale 32768.0 |speed 182.77 samples/(min*GPU)
[2024-06-17 20:47:08,037] [INFO] [RANK 0] time (ms) | forward: 350.25 | backward: 543.47 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 10.87 | data loader: 0.08
[2024-06-17 20:47:17,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=7860, skipped=37, lr=[2.1974686235775273e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:47:17,084] [INFO] [timer.py:258:stop] epoch=0/micro_step=7860/global_step=7860, RunningAvgSamplesPerSec=4.485981539648271, CurrSamplesPerSec=4.48594540409754, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:47:26,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=7870, skipped=37, lr=[2.1878820964091426e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:47:26,123] [INFO] [timer.py:258:stop] epoch=0/micro_step=7870/global_step=7870, RunningAvgSamplesPerSec=4.4859820757792335, CurrSamplesPerSec=4.49415395165438, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:47:35,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=7880, skipped=37, lr=[2.1783282585073097e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:47:35,156] [INFO] [timer.py:258:stop] epoch=0/micro_step=7880/global_step=7880, RunningAvgSamplesPerSec=4.485982836347439, CurrSamplesPerSec=4.490633013985103, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:47:44,183] [INFO] [logging.py:96:log_dist] [Rank 0] step=7890, skipped=37, lr=[2.1688072041645523e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:47:44,184] [INFO] [timer.py:258:stop] epoch=0/micro_step=7890/global_step=7890, RunningAvgSamplesPerSec=4.485986862405236, CurrSamplesPerSec=4.491983237142175, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:47:53,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=7900, skipped=37, lr=[2.1593190273498337e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:47:53,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=7900/global_step=7900, RunningAvgSamplesPerSec=4.485991078443343, CurrSamplesPerSec=4.480429850810043, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:47:53,213] [INFO] [RANK 0]  iteration     7900/   10000 | elapsed time per iteration (ms): 903.5 | learning rate 2.158E-05 | total loss 2.437764E-01 | loss 2.437764E-01 | loss scale 32768.0 |speed 265.63 samples/(min*GPU)
[2024-06-17 20:47:53,214] [INFO] [RANK 0] time (ms) | forward: 352.93 | backward: 546.63 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 11.86 | data loader: 0.09
[2024-06-17 20:48:02,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=7910, skipped=37, lr=[2.149863821707626e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:48:02,256] [INFO] [timer.py:258:stop] epoch=0/micro_step=7910/global_step=7910, RunningAvgSamplesPerSec=4.485994958470991, CurrSamplesPerSec=4.48940733468252, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:48:11,293] [INFO] [logging.py:96:log_dist] [Rank 0] step=7920, skipped=37, lr=[2.140441680556995e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:48:11,294] [INFO] [timer.py:258:stop] epoch=0/micro_step=7920/global_step=7920, RunningAvgSamplesPerSec=4.48599698977288, CurrSamplesPerSec=4.486562014549249, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:48:20,355] [INFO] [logging.py:96:log_dist] [Rank 0] step=7930, skipped=37, lr=[2.1310526968906667e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:48:20,356] [INFO] [timer.py:258:stop] epoch=0/micro_step=7930/global_step=7930, RunningAvgSamplesPerSec=4.485998993408741, CurrSamplesPerSec=4.488386446248004, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:48:29,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=7940, skipped=37, lr=[2.121696963374122e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:48:29,405] [INFO] [timer.py:258:stop] epoch=0/micro_step=7940/global_step=7940, RunningAvgSamplesPerSec=4.485999567200365, CurrSamplesPerSec=4.484210447538594, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:48:38,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=7950, skipped=37, lr=[2.1123745723446722e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:48:38,439] [INFO] [timer.py:258:stop] epoch=0/micro_step=7950/global_step=7950, RunningAvgSamplesPerSec=4.4859994331016, CurrSamplesPerSec=4.487780138250845, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:48:38,439] [INFO] [RANK 0]  iteration     7950/   10000 | elapsed time per iteration (ms): 904.5 | learning rate 2.111E-05 | total loss 2.331996E-01 | loss 2.331996E-01 | loss scale 32768.0 |speed 265.33 samples/(min*GPU)
[2024-06-17 20:48:38,440] [INFO] [RANK 0] time (ms) | forward: 353.67 | backward: 546.89 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 12.60 | data loader: 0.08
[2024-06-17 20:48:47,502] [INFO] [logging.py:96:log_dist] [Rank 0] step=7960, skipped=37, lr=[2.103085615810555e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:48:47,502] [INFO] [timer.py:258:stop] epoch=0/micro_step=7960/global_step=7960, RunningAvgSamplesPerSec=4.48598847828555, CurrSamplesPerSec=4.478280738168757, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:48:56,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=7970, skipped=37, lr=[2.0938301854500178e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:48:56,539] [INFO] [timer.py:258:stop] epoch=0/micro_step=7970/global_step=7970, RunningAvgSamplesPerSec=4.48598990793227, CurrSamplesPerSec=4.47293306469953, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:49:02,857] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 20:49:03,756] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 20:49:05,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=7980, skipped=39, lr=[2.0864500414031365e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:49:05,562] [INFO] [timer.py:258:stop] epoch=0/micro_step=7980/global_step=7980, RunningAvgSamplesPerSec=4.485992858092639, CurrSamplesPerSec=4.481618308979523, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:49:14,598] [INFO] [logging.py:96:log_dist] [Rank 0] step=7990, skipped=39, lr=[2.0772551881274638e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:49:14,599] [INFO] [timer.py:258:stop] epoch=0/micro_step=7990/global_step=7990, RunningAvgSamplesPerSec=4.485984994194507, CurrSamplesPerSec=4.471961373754347, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:49:23,671] [INFO] [logging.py:96:log_dist] [Rank 0] step=8000, skipped=39, lr=[2.068094115961268e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:49:23,671] [INFO] [timer.py:258:stop] epoch=0/micro_step=8000/global_step=8000, RunningAvgSamplesPerSec=4.485980302271317, CurrSamplesPerSec=4.486821185482217, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:49:23,672] [INFO] [RANK 0]  iteration     8000/   10000 | elapsed time per iteration (ms): 904.7 | learning rate 2.067E-05 | total loss 2.849391E-01 | loss 2.849391E-01 | loss scale 32768.0 |speed 265.29 samples/(min*GPU)
[2024-06-17 20:49:23,673] [INFO] [RANK 0] time (ms) | forward: 353.75 | backward: 546.97 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 11.82 | data loader: 0.08
[2024-06-17 20:49:30,300] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 20:49:30,300] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 20:49:30,300] [INFO] [RANK 0]  validation loss at iteration 8000 | loss: 9.017090E-01 | PPL: 2.463810E+00 loss 9.008789E-01 |
[2024-06-17 20:49:30,300] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 20:49:39,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=8010, skipped=39, lr=[2.058966915320629e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:49:39,363] [INFO] [timer.py:258:stop] epoch=0/micro_step=8010/global_step=8010, RunningAvgSamplesPerSec=4.4859701892116455, CurrSamplesPerSec=4.4936544052754295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:49:48,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=8020, skipped=39, lr=[2.0498736762873362e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:49:48,425] [INFO] [timer.py:258:stop] epoch=0/micro_step=8020/global_step=8020, RunningAvgSamplesPerSec=4.485966658149696, CurrSamplesPerSec=4.484621584018412, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:49:57,479] [INFO] [logging.py:96:log_dist] [Rank 0] step=8030, skipped=39, lr=[2.0408144886079854e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:49:57,480] [INFO] [timer.py:258:stop] epoch=0/micro_step=8030/global_step=8030, RunningAvgSamplesPerSec=4.485967836830349, CurrSamplesPerSec=4.491965196754218, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:50:06,518] [INFO] [logging.py:96:log_dist] [Rank 0] step=8040, skipped=39, lr=[2.0317894416931034e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:50:06,519] [INFO] [timer.py:258:stop] epoch=0/micro_step=8040/global_step=8040, RunningAvgSamplesPerSec=4.485970385458919, CurrSamplesPerSec=4.475835149886659, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:50:15,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=8050, skipped=39, lr=[2.0227986246162576e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:50:15,586] [INFO] [timer.py:258:stop] epoch=0/micro_step=8050/global_step=8050, RunningAvgSamplesPerSec=4.485961082316289, CurrSamplesPerSec=4.479445332353637, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:50:15,588] [INFO] [RANK 0]  iteration     8050/   10000 | elapsed time per iteration (ms): 1038.3 | learning rate 2.022E-05 | total loss 2.061580E-01 | loss 2.061580E-01 | loss scale 32768.0 |speed 231.15 samples/(min*GPU)
[2024-06-17 20:50:15,589] [INFO] [RANK 0] time (ms) | forward: 354.79 | backward: 546.96 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 15.33 | data loader: 0.13
[2024-06-17 20:50:24,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=8060, skipped=39, lr=[2.0138421261131842e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:50:24,619] [INFO] [timer.py:258:stop] epoch=0/micro_step=8060/global_step=8060, RunningAvgSamplesPerSec=4.485962593388598, CurrSamplesPerSec=4.48847170268652, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:50:33,658] [INFO] [logging.py:96:log_dist] [Rank 0] step=8070, skipped=39, lr=[2.004920034580908e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:50:33,658] [INFO] [timer.py:258:stop] epoch=0/micro_step=8070/global_step=8070, RunningAvgSamplesPerSec=4.485955598841402, CurrSamplesPerSec=4.479633111103457, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:50:42,702] [INFO] [logging.py:96:log_dist] [Rank 0] step=8080, skipped=39, lr=[1.9960324380768677e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:50:42,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=8080/global_step=8080, RunningAvgSamplesPerSec=4.4859530490381365, CurrSamplesPerSec=4.486723992873536, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:50:51,728] [INFO] [logging.py:96:log_dist] [Rank 0] step=8090, skipped=39, lr=[1.9871794243180566e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:50:51,729] [INFO] [timer.py:258:stop] epoch=0/micro_step=8090/global_step=8090, RunningAvgSamplesPerSec=4.485957319154606, CurrSamplesPerSec=4.495846011820302, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:51:00,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=8100, skipped=39, lr=[1.9783610806801432e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:51:00,777] [INFO] [timer.py:258:stop] epoch=0/micro_step=8100/global_step=8100, RunningAvgSamplesPerSec=4.485955902489176, CurrSamplesPerSec=4.479673778639091, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:51:00,778] [INFO] [RANK 0]  iteration     8100/   10000 | elapsed time per iteration (ms): 903.8 | learning rate 1.977E-05 | total loss 2.279043E-01 | loss 2.279043E-01 | loss scale 32768.0 |speed 265.54 samples/(min*GPU)
[2024-06-17 20:51:00,779] [INFO] [RANK 0] time (ms) | forward: 352.81 | backward: 547.00 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 11.42 | data loader: 0.09
[2024-06-17 20:51:00,780] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:51:00,799] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/8100/mp_rank_00_model_states.pt
[2024-06-17 20:51:00,799] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/8100/mp_rank_00_model_states.pt...
[2024-06-17 20:51:21,712] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/8100/mp_rank_00_model_states.pt.
[2024-06-17 20:51:30,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=8110, skipped=39, lr=[1.969577494196621e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:51:30,678] [INFO] [timer.py:258:stop] epoch=0/micro_step=8110/global_step=8110, RunningAvgSamplesPerSec=4.486004988690949, CurrSamplesPerSec=4.5207447155365355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:51:39,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=8120, skipped=39, lr=[1.9608287515579412e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:51:39,665] [INFO] [timer.py:258:stop] epoch=0/micro_step=8120/global_step=8120, RunningAvgSamplesPerSec=4.486045002944356, CurrSamplesPerSec=4.5119218678691135, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:51:48,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=8130, skipped=39, lr=[1.952114939110663e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:51:48,666] [INFO] [timer.py:258:stop] epoch=0/micro_step=8130/global_step=8130, RunningAvgSamplesPerSec=4.486074782848663, CurrSamplesPerSec=4.500073896071814, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:51:57,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=8140, skipped=39, lr=[1.9434361428565957e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:51:57,661] [INFO] [timer.py:258:stop] epoch=0/micro_step=8140/global_step=8140, RunningAvgSamplesPerSec=4.486108329323452, CurrSamplesPerSec=4.513686838590086, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:52:06,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=8150, skipped=39, lr=[1.9347924484519567e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:52:06,684] [INFO] [timer.py:258:stop] epoch=0/micro_step=8150/global_step=8150, RunningAvgSamplesPerSec=4.486114889885845, CurrSamplesPerSec=4.486669998799256, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:52:06,684] [INFO] [RANK 0]  iteration     8150/   10000 | elapsed time per iteration (ms): 1318.1 | learning rate 1.934E-05 | total loss 2.166988E-01 | loss 2.166988E-01 | loss scale 32768.0 |speed 182.08 samples/(min*GPU)
[2024-06-17 20:52:06,687] [INFO] [RANK 0] time (ms) | forward: 351.88 | backward: 543.23 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 12.06 | data loader: 0.10
[2024-06-17 20:52:15,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=8160, skipped=39, lr=[1.9261839412065173e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:52:15,703] [INFO] [timer.py:258:stop] epoch=0/micro_step=8160/global_step=8160, RunningAvgSamplesPerSec=4.4861157053794, CurrSamplesPerSec=4.49037220067961, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:52:24,723] [INFO] [logging.py:96:log_dist] [Rank 0] step=8170, skipped=39, lr=[1.9176107060827723e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:52:24,723] [INFO] [timer.py:258:stop] epoch=0/micro_step=8170/global_step=8170, RunningAvgSamplesPerSec=4.48612128318816, CurrSamplesPerSec=4.49300576260674, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:52:33,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=8180, skipped=39, lr=[1.9090728276950886e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:52:33,743] [INFO] [timer.py:258:stop] epoch=0/micro_step=8180/global_step=8180, RunningAvgSamplesPerSec=4.486124937720779, CurrSamplesPerSec=4.48623329449789, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:52:42,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=8190, skipped=39, lr=[1.9005703903088783e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:52:42,762] [INFO] [timer.py:258:stop] epoch=0/micro_step=8190/global_step=8190, RunningAvgSamplesPerSec=4.486128398446341, CurrSamplesPerSec=4.483854509787676, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:52:51,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=8200, skipped=39, lr=[1.8921034778397688e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:52:51,831] [INFO] [timer.py:258:stop] epoch=0/micro_step=8200/global_step=8200, RunningAvgSamplesPerSec=4.4861258256958285, CurrSamplesPerSec=4.491272555457547, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:52:51,832] [INFO] [RANK 0]  iteration     8200/   10000 | elapsed time per iteration (ms): 902.9 | learning rate 1.891E-05 | total loss 1.963857E-01 | loss 1.963857E-01 | loss scale 32768.0 |speed 265.80 samples/(min*GPU)
[2024-06-17 20:52:51,832] [INFO] [RANK 0] time (ms) | forward: 352.11 | backward: 546.82 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 11.10 | data loader: 0.08
[2024-06-17 20:53:00,898] [INFO] [logging.py:96:log_dist] [Rank 0] step=8210, skipped=39, lr=[1.8836721738527647e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:53:00,899] [INFO] [timer.py:258:stop] epoch=0/micro_step=8210/global_step=8210, RunningAvgSamplesPerSec=4.486120447673634, CurrSamplesPerSec=4.46448693654773, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:53:09,936] [INFO] [logging.py:96:log_dist] [Rank 0] step=8220, skipped=39, lr=[1.8752765615614356e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:53:09,936] [INFO] [timer.py:258:stop] epoch=0/micro_step=8220/global_step=8220, RunningAvgSamplesPerSec=4.486117136217878, CurrSamplesPerSec=4.489056577117692, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:53:18,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=8230, skipped=39, lr=[1.8669167238270826e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:53:18,971] [INFO] [timer.py:258:stop] epoch=0/micro_step=8230/global_step=8230, RunningAvgSamplesPerSec=4.486118764153229, CurrSamplesPerSec=4.4886974677725995, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:53:28,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=8240, skipped=39, lr=[1.858592743157931e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:53:28,019] [INFO] [timer.py:258:stop] epoch=0/micro_step=8240/global_step=8240, RunningAvgSamplesPerSec=4.486117366087229, CurrSamplesPerSec=4.488876414745757, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:53:37,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=8250, skipped=39, lr=[1.8503047017083083e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:53:37,059] [INFO] [timer.py:258:stop] epoch=0/micro_step=8250/global_step=8250, RunningAvgSamplesPerSec=4.486117665598814, CurrSamplesPerSec=4.48850172333025, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:53:37,060] [INFO] [RANK 0]  iteration     8250/   10000 | elapsed time per iteration (ms): 904.6 | learning rate 1.849E-05 | total loss 2.315238E-01 | loss 2.315238E-01 | loss scale 32768.0 |speed 265.32 samples/(min*GPU)
[2024-06-17 20:53:37,062] [INFO] [RANK 0] time (ms) | forward: 353.62 | backward: 546.89 | allreduce: 0.00 | optimizer: 3.33 | batch generator: 12.10 | data loader: 0.09
[2024-06-17 20:53:46,114] [INFO] [logging.py:96:log_dist] [Rank 0] step=8260, skipped=39, lr=[1.842052681277839e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:53:46,115] [INFO] [timer.py:258:stop] epoch=0/micro_step=8260/global_step=8260, RunningAvgSamplesPerSec=4.486115547256816, CurrSamplesPerSec=4.480005126958992, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:53:55,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=8270, skipped=39, lr=[1.8338367633106327e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:53:55,172] [INFO] [timer.py:258:stop] epoch=0/micro_step=8270/global_step=8270, RunningAvgSamplesPerSec=4.486112425270747, CurrSamplesPerSec=4.44926702206598, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:54:04,211] [INFO] [logging.py:96:log_dist] [Rank 0] step=8280, skipped=39, lr=[1.8256570288944814e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:54:04,211] [INFO] [timer.py:258:stop] epoch=0/micro_step=8280/global_step=8280, RunningAvgSamplesPerSec=4.486109634268043, CurrSamplesPerSec=4.491944751156373, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:54:13,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=8290, skipped=39, lr=[1.8175135587600637e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:54:13,253] [INFO] [timer.py:258:stop] epoch=0/micro_step=8290/global_step=8290, RunningAvgSamplesPerSec=4.48610497150627, CurrSamplesPerSec=4.4685179557426125, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:54:22,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=8300, skipped=39, lr=[1.80940643328014e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:54:22,310] [INFO] [timer.py:258:stop] epoch=0/micro_step=8300/global_step=8300, RunningAvgSamplesPerSec=4.486106219879876, CurrSamplesPerSec=4.488152307903027, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:54:22,311] [INFO] [RANK 0]  iteration     8300/   10000 | elapsed time per iteration (ms): 905.0 | learning rate 1.809E-05 | total loss 2.272847E-01 | loss 2.272847E-01 | loss scale 32768.0 |speed 265.19 samples/(min*GPU)
[2024-06-17 20:54:22,312] [INFO] [RANK 0] time (ms) | forward: 353.98 | backward: 547.04 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 12.46 | data loader: 0.08
[2024-06-17 20:54:31,343] [INFO] [logging.py:96:log_dist] [Rank 0] step=8310, skipped=39, lr=[1.8013357324687676e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:54:31,344] [INFO] [timer.py:258:stop] epoch=0/micro_step=8310/global_step=8310, RunningAvgSamplesPerSec=4.486102128774816, CurrSamplesPerSec=4.4887058743579855, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:54:40,398] [INFO] [logging.py:96:log_dist] [Rank 0] step=8320, skipped=39, lr=[1.793301535980504e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:54:40,398] [INFO] [timer.py:258:stop] epoch=0/micro_step=8320/global_step=8320, RunningAvgSamplesPerSec=4.4860994707338095, CurrSamplesPerSec=4.4710055942147635, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:54:49,424] [INFO] [logging.py:96:log_dist] [Rank 0] step=8330, skipped=39, lr=[1.7853039231096267e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:54:49,425] [INFO] [timer.py:258:stop] epoch=0/micro_step=8330/global_step=8330, RunningAvgSamplesPerSec=4.486101983418844, CurrSamplesPerSec=4.491825689313812, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:54:58,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=8340, skipped=39, lr=[1.7773429727893434e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:54:58,462] [INFO] [timer.py:258:stop] epoch=0/micro_step=8340/global_step=8340, RunningAvgSamplesPerSec=4.486104657539186, CurrSamplesPerSec=4.484815791309722, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:55:07,488] [INFO] [logging.py:96:log_dist] [Rank 0] step=8350, skipped=39, lr=[1.769418763591022e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:55:07,489] [INFO] [timer.py:258:stop] epoch=0/micro_step=8350/global_step=8350, RunningAvgSamplesPerSec=4.486106708811262, CurrSamplesPerSec=4.484916498008853, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:55:07,490] [INFO] [RANK 0]  iteration     8350/   10000 | elapsed time per iteration (ms): 903.6 | learning rate 1.769E-05 | total loss 1.897691E-01 | loss 1.897691E-01 | loss scale 32768.0 |speed 265.61 samples/(min*GPU)
[2024-06-17 20:55:07,491] [INFO] [RANK 0] time (ms) | forward: 352.51 | backward: 547.13 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 11.47 | data loader: 0.08
[2024-06-17 20:55:16,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=8360, skipped=39, lr=[1.761531373723408e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:55:16,515] [INFO] [timer.py:258:stop] epoch=0/micro_step=8360/global_step=8360, RunningAvgSamplesPerSec=4.48610806498131, CurrSamplesPerSec=4.491644102092361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:55:25,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=8370, skipped=39, lr=[1.7536808810318534e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:55:25,551] [INFO] [timer.py:258:stop] epoch=0/micro_step=8370/global_step=8370, RunningAvgSamplesPerSec=4.4861085149484285, CurrSamplesPerSec=4.4888403840066955, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:55:33,709] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 20:55:34,611] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 20:55:34,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=8380, skipped=41, lr=[1.7466470487407302e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:55:34,613] [INFO] [timer.py:258:stop] epoch=0/micro_step=8380/global_step=8380, RunningAvgSamplesPerSec=4.486103045544508, CurrSamplesPerSec=4.475890077588744, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:55:43,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=8390, skipped=41, lr=[1.7396432221577506e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:55:43,638] [INFO] [timer.py:258:stop] epoch=0/micro_step=8390/global_step=8390, RunningAvgSamplesPerSec=4.486103477397518, CurrSamplesPerSec=4.490634215959868, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:55:52,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=8400, skipped=41, lr=[1.7318964525937885e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:55:52,685] [INFO] [timer.py:258:stop] epoch=0/micro_step=8400/global_step=8400, RunningAvgSamplesPerSec=4.486097873479684, CurrSamplesPerSec=4.487374423605687, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:55:52,686] [INFO] [RANK 0]  iteration     8400/   10000 | elapsed time per iteration (ms): 903.9 | learning rate 1.731E-05 | total loss 2.160631E-01 | loss 2.160631E-01 | loss scale 32768.0 |speed 265.51 samples/(min*GPU)
[2024-06-17 20:55:52,687] [INFO] [RANK 0] time (ms) | forward: 352.93 | backward: 547.00 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 11.43 | data loader: 0.09
[2024-06-17 20:55:52,688] [INFO] [RANK 0] Saving Model...
[2024-06-17 20:55:52,700] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/8400/mp_rank_00_model_states.pt
[2024-06-17 20:55:52,700] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/8400/mp_rank_00_model_states.pt...
[2024-06-17 20:56:14,055] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/8400/mp_rank_00_model_states.pt.
[2024-06-17 20:56:23,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=8410, skipped=41, lr=[1.724186872690595e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:56:23,027] [INFO] [timer.py:258:stop] epoch=0/micro_step=8410/global_step=8410, RunningAvgSamplesPerSec=4.486145057082389, CurrSamplesPerSec=4.503245800724343, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:56:31,995] [INFO] [logging.py:96:log_dist] [Rank 0] step=8420, skipped=41, lr=[1.7165145585386102e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:56:31,995] [INFO] [timer.py:258:stop] epoch=0/micro_step=8420/global_step=8420, RunningAvgSamplesPerSec=4.486183631222583, CurrSamplesPerSec=4.512771406338134, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:56:40,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=8430, skipped=41, lr=[1.7088795858604777e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:56:40,996] [INFO] [timer.py:258:stop] epoch=0/micro_step=8430/global_step=8430, RunningAvgSamplesPerSec=4.486220509923831, CurrSamplesPerSec=4.512181549968331, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:56:50,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=8440, skipped=41, lr=[1.7012820300102956e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:56:50,013] [INFO] [timer.py:258:stop] epoch=0/micro_step=8440/global_step=8440, RunningAvgSamplesPerSec=4.486249705386602, CurrSamplesPerSec=4.510488087297535, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:56:59,001] [INFO] [logging.py:96:log_dist] [Rank 0] step=8450, skipped=41, lr=[1.693721965972873e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:56:59,001] [INFO] [timer.py:258:stop] epoch=0/micro_step=8450/global_step=8450, RunningAvgSamplesPerSec=4.486274357019493, CurrSamplesPerSec=4.504157372056543, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:56:59,002] [INFO] [RANK 0]  iteration     8450/   10000 | elapsed time per iteration (ms): 1326.3 | learning rate 1.693E-05 | total loss 2.247382E-01 | loss 2.247382E-01 | loss scale 32768.0 |speed 180.95 samples/(min*GPU)
[2024-06-17 20:56:59,002] [INFO] [RANK 0] time (ms) | forward: 351.82 | backward: 542.86 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 12.29 | data loader: 0.09
[2024-06-17 20:57:08,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=8460, skipped=41, lr=[1.6861994683629893e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:57:08,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=8460/global_step=8460, RunningAvgSamplesPerSec=4.486266908797498, CurrSamplesPerSec=4.479905836940149, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:57:17,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=8470, skipped=41, lr=[1.6787146114246598e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:57:17,101] [INFO] [timer.py:258:stop] epoch=0/micro_step=8470/global_step=8470, RunningAvgSamplesPerSec=4.486261706469542, CurrSamplesPerSec=4.4819403664100035, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:57:26,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=8480, skipped=41, lr=[1.6712674690304004e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:57:26,138] [INFO] [timer.py:258:stop] epoch=0/micro_step=8480/global_step=8480, RunningAvgSamplesPerSec=4.486255431691263, CurrSamplesPerSec=4.484211646077655, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:57:35,171] [INFO] [logging.py:96:log_dist] [Rank 0] step=8490, skipped=41, lr=[1.6638581146804987e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:57:35,172] [INFO] [timer.py:258:stop] epoch=0/micro_step=8490/global_step=8490, RunningAvgSamplesPerSec=4.486261872722561, CurrSamplesPerSec=4.490136653409912, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:57:44,191] [INFO] [logging.py:96:log_dist] [Rank 0] step=8500, skipped=41, lr=[1.6564866215022934e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:57:44,191] [INFO] [timer.py:258:stop] epoch=0/micro_step=8500/global_step=8500, RunningAvgSamplesPerSec=4.486265615308437, CurrSamplesPerSec=4.486455235235695, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:57:44,191] [INFO] [RANK 0]  iteration     8500/   10000 | elapsed time per iteration (ms): 903.8 | learning rate 1.656E-05 | total loss 2.124414E-01 | loss 2.124414E-01 | loss scale 32768.0 |speed 265.55 samples/(min*GPU)
[2024-06-17 20:57:44,193] [INFO] [RANK 0] time (ms) | forward: 352.87 | backward: 546.88 | allreduce: 0.00 | optimizer: 3.31 | batch generator: 11.33 | data loader: 0.08
[2024-06-17 20:57:53,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=8510, skipped=41, lr=[1.649153062249443e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:57:53,245] [INFO] [timer.py:258:stop] epoch=0/micro_step=8510/global_step=8510, RunningAvgSamplesPerSec=4.4862624847438655, CurrSamplesPerSec=4.481933182468191, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:58:02,310] [INFO] [logging.py:96:log_dist] [Rank 0] step=8520, skipped=41, lr=[1.6418575093012204e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:58:02,311] [INFO] [timer.py:258:stop] epoch=0/micro_step=8520/global_step=8520, RunningAvgSamplesPerSec=4.486254343863123, CurrSamplesPerSec=4.492025331944269, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:58:11,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=8530, skipped=41, lr=[1.6346000346617845e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:58:11,357] [INFO] [timer.py:258:stop] epoch=0/micro_step=8530/global_step=8530, RunningAvgSamplesPerSec=4.486249282787233, CurrSamplesPerSec=4.484969250941987, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:58:20,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=8540, skipped=41, lr=[1.6273807099594817e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:58:20,407] [INFO] [timer.py:258:stop] epoch=0/micro_step=8540/global_step=8540, RunningAvgSamplesPerSec=4.486248395039926, CurrSamplesPerSec=4.478879699165824, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:58:29,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=8550, skipped=41, lr=[1.6201996064461315e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:58:29,450] [INFO] [timer.py:258:stop] epoch=0/micro_step=8550/global_step=8550, RunningAvgSamplesPerSec=4.4862505111083255, CurrSamplesPerSec=4.488768324263785, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:58:29,451] [INFO] [RANK 0]  iteration     8550/   10000 | elapsed time per iteration (ms): 905.2 | learning rate 1.619E-05 | total loss 2.694824E-01 | loss 2.694824E-01 | loss scale 32768.0 |speed 265.14 samples/(min*GPU)
[2024-06-17 20:58:29,452] [INFO] [RANK 0] time (ms) | forward: 354.28 | backward: 546.92 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 12.52 | data loader: 0.10
[2024-06-17 20:58:38,483] [INFO] [logging.py:96:log_dist] [Rank 0] step=8560, skipped=41, lr=[1.6130567949963277e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:58:38,483] [INFO] [timer.py:258:stop] epoch=0/micro_step=8560/global_step=8560, RunningAvgSamplesPerSec=4.486253573611713, CurrSamplesPerSec=4.47473210496935, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:58:47,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=8570, skipped=41, lr=[1.6059523461067356e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:58:47,517] [INFO] [timer.py:258:stop] epoch=0/micro_step=8570/global_step=8570, RunningAvgSamplesPerSec=4.486253805746888, CurrSamplesPerSec=4.482606178312823, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:58:56,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=8580, skipped=41, lr=[1.598886329895395e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:58:56,537] [INFO] [timer.py:258:stop] epoch=0/micro_step=8580/global_step=8580, RunningAvgSamplesPerSec=4.486255586737098, CurrSamplesPerSec=4.485616774391915, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:59:05,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=8590, skipped=41, lr=[1.591858816101036e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:59:05,555] [INFO] [timer.py:258:stop] epoch=0/micro_step=8590/global_step=8590, RunningAvgSamplesPerSec=4.486257200426514, CurrSamplesPerSec=4.490681093477608, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:59:14,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=8600, skipped=41, lr=[1.584869874082381e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:59:14,588] [INFO] [timer.py:258:stop] epoch=0/micro_step=8600/global_step=8600, RunningAvgSamplesPerSec=4.486248239991864, CurrSamplesPerSec=4.483370429269776, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:59:14,590] [INFO] [RANK 0]  iteration     8600/   10000 | elapsed time per iteration (ms): 902.8 | learning rate 1.584E-05 | total loss 2.107919E-01 | loss 2.107919E-01 | loss scale 32768.0 |speed 265.85 samples/(min*GPU)
[2024-06-17 20:59:14,591] [INFO] [RANK 0] time (ms) | forward: 351.71 | backward: 547.07 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 10.56 | data loader: 0.08
[2024-06-17 20:59:23,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=8610, skipped=41, lr=[1.5779195728174675e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:59:23,654] [INFO] [timer.py:258:stop] epoch=0/micro_step=8610/global_step=8610, RunningAvgSamplesPerSec=4.486242588369294, CurrSamplesPerSec=4.485971792512639, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:59:32,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=8620, skipped=41, lr=[1.5710079809029614e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:59:32,694] [INFO] [timer.py:258:stop] epoch=0/micro_step=8620/global_step=8620, RunningAvgSamplesPerSec=4.486238792880414, CurrSamplesPerSec=4.481036567907249, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:59:41,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=8630, skipped=41, lr=[1.564135166553487e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:59:41,744] [INFO] [timer.py:258:stop] epoch=0/micro_step=8630/global_step=8630, RunningAvgSamplesPerSec=4.486233646403228, CurrSamplesPerSec=4.491290590282425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:59:50,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=8640, skipped=41, lr=[1.5573011976009446e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:59:50,800] [INFO] [timer.py:258:stop] epoch=0/micro_step=8640/global_step=8640, RunningAvgSamplesPerSec=4.4862298507652945, CurrSamplesPerSec=4.483478259940048, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:59:59,836] [INFO] [logging.py:96:log_dist] [Rank 0] step=8650, skipped=41, lr=[1.5505061414938505e-05], mom=[[0.9, 0.95]]
[2024-06-17 20:59:59,836] [INFO] [timer.py:258:stop] epoch=0/micro_step=8650/global_step=8650, RunningAvgSamplesPerSec=4.486227886364112, CurrSamplesPerSec=4.462074187511087, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 20:59:59,838] [INFO] [RANK 0]  iteration     8650/   10000 | elapsed time per iteration (ms): 905.0 | learning rate 1.550E-05 | total loss 2.690947E-01 | loss 2.690947E-01 | loss scale 32768.0 |speed 265.21 samples/(min*GPU)
[2024-06-17 20:59:59,839] [INFO] [RANK 0] time (ms) | forward: 353.91 | backward: 547.05 | allreduce: 0.00 | optimizer: 3.24 | batch generator: 12.10 | data loader: 0.08
[2024-06-17 21:00:08,887] [INFO] [logging.py:96:log_dist] [Rank 0] step=8660, skipped=41, lr=[1.5437500652966643e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:00:08,887] [INFO] [timer.py:258:stop] epoch=0/micro_step=8660/global_step=8660, RunningAvgSamplesPerSec=4.486224310526353, CurrSamplesPerSec=4.476417929881473, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:00:17,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=8670, skipped=41, lr=[1.5370330356891318e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:00:17,969] [INFO] [timer.py:258:stop] epoch=0/micro_step=8670/global_step=8670, RunningAvgSamplesPerSec=4.486219654463315, CurrSamplesPerSec=4.484495717905676, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:00:27,004] [INFO] [logging.py:96:log_dist] [Rank 0] step=8680, skipped=41, lr=[1.5303551189656223e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:00:27,004] [INFO] [timer.py:258:stop] epoch=0/micro_step=8680/global_step=8680, RunningAvgSamplesPerSec=4.486221195755529, CurrSamplesPerSec=4.481563240595704, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:00:36,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=8690, skipped=41, lr=[1.523716381034477e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:00:36,057] [INFO] [timer.py:258:stop] epoch=0/micro_step=8690/global_step=8690, RunningAvgSamplesPerSec=4.486218657879847, CurrSamplesPerSec=4.4823546793475835, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:00:45,101] [INFO] [logging.py:96:log_dist] [Rank 0] step=8700, skipped=41, lr=[1.5171168874173615e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:00:45,101] [INFO] [timer.py:258:stop] epoch=0/micro_step=8700/global_step=8700, RunningAvgSamplesPerSec=4.486207453021137, CurrSamplesPerSec=4.4817440136216335, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:00:45,103] [INFO] [RANK 0]  iteration     8700/   10000 | elapsed time per iteration (ms): 905.3 | learning rate 1.516E-05 | total loss 2.411803E-01 | loss 2.411803E-01 | loss scale 32768.0 |speed 265.11 samples/(min*GPU)
[2024-06-17 21:00:45,103] [INFO] [RANK 0] time (ms) | forward: 354.26 | backward: 547.06 | allreduce: 0.00 | optimizer: 3.21 | batch generator: 12.42 | data loader: 0.08
[2024-06-17 21:00:45,104] [INFO] [RANK 0] Saving Model...
[2024-06-17 21:00:45,117] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/8700/mp_rank_00_model_states.pt
[2024-06-17 21:00:45,117] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/8700/mp_rank_00_model_states.pt...
[2024-06-17 21:01:05,883] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/8700/mp_rank_00_model_states.pt.
[2024-06-17 21:01:14,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=8710, skipped=41, lr=[1.5105567032486112e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:01:14,845] [INFO] [timer.py:258:stop] epoch=0/micro_step=8710/global_step=8710, RunningAvgSamplesPerSec=4.486254256266411, CurrSamplesPerSec=4.524132485776145, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:01:23,825] [INFO] [logging.py:96:log_dist] [Rank 0] step=8720, skipped=41, lr=[1.5040358932745976e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:01:23,825] [INFO] [timer.py:258:stop] epoch=0/micro_step=8720/global_step=8720, RunningAvgSamplesPerSec=4.486284917707098, CurrSamplesPerSec=4.512567487930644, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:01:32,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=8730, skipped=41, lr=[1.4975545218530803e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:01:32,816] [INFO] [timer.py:258:stop] epoch=0/micro_step=8730/global_step=8730, RunningAvgSamplesPerSec=4.486315867225548, CurrSamplesPerSec=4.5112594498738225, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:01:41,799] [INFO] [logging.py:96:log_dist] [Rank 0] step=8740, skipped=41, lr=[1.4911126529525808e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:01:41,800] [INFO] [timer.py:258:stop] epoch=0/micro_step=8740/global_step=8740, RunningAvgSamplesPerSec=4.48634186770648, CurrSamplesPerSec=4.508105322301063, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:01:50,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=8750, skipped=41, lr=[1.484710350151742e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:01:50,817] [INFO] [timer.py:258:stop] epoch=0/micro_step=8750/global_step=8750, RunningAvgSamplesPerSec=4.486359115269517, CurrSamplesPerSec=4.4955099070362925, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:01:50,818] [INFO] [RANK 0]  iteration     8750/   10000 | elapsed time per iteration (ms): 1314.3 | learning rate 1.484E-05 | total loss 2.321413E-01 | loss 2.321413E-01 | loss scale 32768.0 |speed 182.61 samples/(min*GPU)
[2024-06-17 21:01:50,819] [INFO] [RANK 0] time (ms) | forward: 350.99 | backward: 543.44 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 11.55 | data loader: 0.09
[2024-06-17 21:01:59,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=8760, skipped=41, lr=[1.4783476766387106e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:01:59,862] [INFO] [timer.py:258:stop] epoch=0/micro_step=8760/global_step=8760, RunningAvgSamplesPerSec=4.486361834251365, CurrSamplesPerSec=4.4982604554989765, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:02:08,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=8770, skipped=41, lr=[1.4720246952105037e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:02:08,908] [INFO] [timer.py:258:stop] epoch=0/micro_step=8770/global_step=8770, RunningAvgSamplesPerSec=4.486362477541898, CurrSamplesPerSec=4.4904358988290545, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:02:17,964] [INFO] [logging.py:96:log_dist] [Rank 0] step=8780, skipped=41, lr=[1.4657414682723949e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:02:17,965] [INFO] [timer.py:258:stop] epoch=0/micro_step=8780/global_step=8780, RunningAvgSamplesPerSec=4.486362816916115, CurrSamplesPerSec=4.48506396954997, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:02:18,866] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 21:02:19,771] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 21:02:27,001] [INFO] [logging.py:96:log_dist] [Rank 0] step=8790, skipped=43, lr=[1.4607435516406561e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:02:27,001] [INFO] [timer.py:258:stop] epoch=0/micro_step=8790/global_step=8790, RunningAvgSamplesPerSec=4.486362631165741, CurrSamplesPerSec=4.481636266353808, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:02:36,039] [INFO] [logging.py:96:log_dist] [Rank 0] step=8800, skipped=43, lr=[1.45453203879321e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:02:36,039] [INFO] [timer.py:258:stop] epoch=0/micro_step=8800/global_step=8800, RunningAvgSamplesPerSec=4.4863641407847545, CurrSamplesPerSec=4.485650354780778, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:02:36,040] [INFO] [RANK 0]  iteration     8800/   10000 | elapsed time per iteration (ms): 904.4 | learning rate 1.454E-05 | total loss 2.148528E-01 | loss 2.148528E-01 | loss scale 32768.0 |speed 265.35 samples/(min*GPU)
[2024-06-17 21:02:36,042] [INFO] [RANK 0] time (ms) | forward: 353.67 | backward: 546.82 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 12.46 | data loader: 0.09
[2024-06-17 21:02:45,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=8810, skipped=43, lr=[1.4483604530813187e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:02:45,084] [INFO] [timer.py:258:stop] epoch=0/micro_step=8810/global_step=8810, RunningAvgSamplesPerSec=4.486357387810846, CurrSamplesPerSec=4.470075233885276, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:02:54,136] [INFO] [logging.py:96:log_dist] [Rank 0] step=8820, skipped=43, lr=[1.4422288554160435e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:02:54,136] [INFO] [timer.py:258:stop] epoch=0/micro_step=8820/global_step=8820, RunningAvgSamplesPerSec=4.486357824338802, CurrSamplesPerSec=4.482967907258242, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:03:03,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=8830, skipped=43, lr=[1.436137306313776e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:03:03,181] [INFO] [timer.py:258:stop] epoch=0/micro_step=8830/global_step=8830, RunningAvgSamplesPerSec=4.486357668459916, CurrSamplesPerSec=4.493139326768905, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:03:12,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=8840, skipped=43, lr=[1.4300858658956487e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:03:12,230] [INFO] [timer.py:258:stop] epoch=0/micro_step=8840/global_step=8840, RunningAvgSamplesPerSec=4.486360376274867, CurrSamplesPerSec=4.493751898376142, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:03:21,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=8850, skipped=43, lr=[1.4240745938869334e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:03:21,279] [INFO] [timer.py:258:stop] epoch=0/micro_step=8850/global_step=8850, RunningAvgSamplesPerSec=4.48635953598884, CurrSamplesPerSec=4.491059755461639, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:03:21,279] [INFO] [RANK 0]  iteration     8850/   10000 | elapsed time per iteration (ms): 904.8 | learning rate 1.423E-05 | total loss 1.959582E-01 | loss 1.959582E-01 | loss scale 32768.0 |speed 265.26 samples/(min*GPU)
[2024-06-17 21:03:21,280] [INFO] [RANK 0] time (ms) | forward: 353.72 | backward: 546.98 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 12.39 | data loader: 0.08
[2024-06-17 21:03:30,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=8860, skipped=43, lr=[1.4181035496164586e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:03:30,322] [INFO] [timer.py:258:stop] epoch=0/micro_step=8860/global_step=8860, RunningAvgSamplesPerSec=4.4863608984278125, CurrSamplesPerSec=4.484234418441548, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:03:39,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=8870, skipped=43, lr=[1.4121727920160213e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:03:39,360] [INFO] [timer.py:258:stop] epoch=0/micro_step=8870/global_step=8870, RunningAvgSamplesPerSec=4.486354666675023, CurrSamplesPerSec=4.465733515967247, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:03:48,396] [INFO] [logging.py:96:log_dist] [Rank 0] step=8880, skipped=43, lr=[1.4062823796198031e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:03:48,396] [INFO] [timer.py:258:stop] epoch=0/micro_step=8880/global_step=8880, RunningAvgSamplesPerSec=4.486356476645429, CurrSamplesPerSec=4.472496645737348, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:03:57,432] [INFO] [logging.py:96:log_dist] [Rank 0] step=8890, skipped=43, lr=[1.4004323705637988e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:03:57,432] [INFO] [timer.py:258:stop] epoch=0/micro_step=8890/global_step=8890, RunningAvgSamplesPerSec=4.4863536168892635, CurrSamplesPerSec=4.482820573522174, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:04:06,486] [INFO] [logging.py:96:log_dist] [Rank 0] step=8900, skipped=43, lr=[1.3946228225852333e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:04:06,486] [INFO] [timer.py:258:stop] epoch=0/micro_step=8900/global_step=8900, RunningAvgSamplesPerSec=4.486344952429952, CurrSamplesPerSec=4.469140498676883, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:04:06,488] [INFO] [RANK 0]  iteration     8900/   10000 | elapsed time per iteration (ms): 904.2 | learning rate 1.394E-05 | total loss 2.153418E-01 | loss 2.153418E-01 | loss scale 32768.0 |speed 265.44 samples/(min*GPU)
[2024-06-17 21:04:06,489] [INFO] [RANK 0] time (ms) | forward: 353.16 | backward: 547.01 | allreduce: 0.00 | optimizer: 3.25 | batch generator: 11.51 | data loader: 0.08
[2024-06-17 21:04:15,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=8910, skipped=43, lr=[1.3888537930220021e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:04:15,538] [INFO] [timer.py:258:stop] epoch=0/micro_step=8910/global_step=8910, RunningAvgSamplesPerSec=4.486343474411427, CurrSamplesPerSec=4.484383043760194, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:04:24,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=8920, skipped=43, lr=[1.3831253388120965e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:04:24,589] [INFO] [timer.py:258:stop] epoch=0/micro_step=8920/global_step=8920, RunningAvgSamplesPerSec=4.4863431582231925, CurrSamplesPerSec=4.486156520111504, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:04:33,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=8930, skipped=43, lr=[1.3774375164930476e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:04:33,623] [INFO] [timer.py:258:stop] epoch=0/micro_step=8930/global_step=8930, RunningAvgSamplesPerSec=4.486342468784293, CurrSamplesPerSec=4.485766690730195, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:04:42,663] [INFO] [logging.py:96:log_dist] [Rank 0] step=8940, skipped=43, lr=[1.3717903822013652e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:04:42,663] [INFO] [timer.py:258:stop] epoch=0/micro_step=8940/global_step=8940, RunningAvgSamplesPerSec=4.4863431608275395, CurrSamplesPerSec=4.4923861768992515, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:04:51,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=8950, skipped=43, lr=[1.3661839916719839e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:04:51,685] [INFO] [timer.py:258:stop] epoch=0/micro_step=8950/global_step=8950, RunningAvgSamplesPerSec=4.48634852790692, CurrSamplesPerSec=4.4842607867308, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:04:51,686] [INFO] [RANK 0]  iteration     8950/   10000 | elapsed time per iteration (ms): 904.0 | learning rate 1.366E-05 | total loss 2.233380E-01 | loss 2.233380E-01 | loss scale 32768.0 |speed 265.50 samples/(min*GPU)
[2024-06-17 21:04:51,687] [INFO] [RANK 0] time (ms) | forward: 353.03 | backward: 546.99 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 11.99 | data loader: 0.08
[2024-06-17 21:05:00,723] [INFO] [logging.py:96:log_dist] [Rank 0] step=8960, skipped=43, lr=[1.3606184002377169e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:05:00,723] [INFO] [timer.py:258:stop] epoch=0/micro_step=8960/global_step=8960, RunningAvgSamplesPerSec=4.486350496232878, CurrSamplesPerSec=4.487372023145629, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:05:09,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=8970, skipped=43, lr=[1.3550936628287025e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:05:09,749] [INFO] [timer.py:258:stop] epoch=0/micro_step=8970/global_step=8970, RunningAvgSamplesPerSec=4.486351325768779, CurrSamplesPerSec=4.483882071972102, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:05:18,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=8980, skipped=43, lr=[1.3496098339718707e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:05:18,795] [INFO] [timer.py:258:stop] epoch=0/micro_step=8980/global_step=8980, RunningAvgSamplesPerSec=4.4863538164189025, CurrSamplesPerSec=4.480017089908943, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:05:27,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=8990, skipped=43, lr=[1.3441669677903963e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:05:27,841] [INFO] [timer.py:258:stop] epoch=0/micro_step=8990/global_step=8990, RunningAvgSamplesPerSec=4.486350983968649, CurrSamplesPerSec=4.4867347918443405, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:05:36,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=9000, skipped=43, lr=[1.3387651180031728e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:05:36,861] [INFO] [timer.py:258:stop] epoch=0/micro_step=9000/global_step=9000, RunningAvgSamplesPerSec=4.48634850446948, CurrSamplesPerSec=4.486127730394067, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:05:36,863] [INFO] [RANK 0]  iteration     9000/   10000 | elapsed time per iteration (ms): 903.5 | learning rate 1.338E-05 | total loss 2.561424E-01 | loss 2.561424E-01 | loss scale 32768.0 |speed 265.63 samples/(min*GPU)
[2024-06-17 21:05:36,864] [INFO] [RANK 0] time (ms) | forward: 352.48 | backward: 547.08 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 11.42 | data loader: 0.10
[2024-06-17 21:05:36,865] [INFO] [RANK 0] Saving Model...
[2024-06-17 21:05:36,877] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/9000/mp_rank_00_model_states.pt
[2024-06-17 21:05:36,877] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/9000/mp_rank_00_model_states.pt...
[2024-06-17 21:05:57,839] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/9000/mp_rank_00_model_states.pt.
[2024-06-17 21:06:04,447] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 21:06:04,447] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 21:06:04,447] [INFO] [RANK 0]  validation loss at iteration 9000 | loss: 9.145020E-01 | PPL: 2.495532E+00 loss 9.150391E-01 |
[2024-06-17 21:06:04,447] [INFO] [RANK 0] ------------------------------------------------------------------------------------------------
[2024-06-17 21:06:13,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=9010, skipped=43, lr=[1.3334043379242753e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:06:13,435] [INFO] [timer.py:258:stop] epoch=0/micro_step=9010/global_step=9010, RunningAvgSamplesPerSec=4.48638192396257, CurrSamplesPerSec=4.5131064551628635, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:06:22,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=9020, skipped=43, lr=[1.3280846804624407e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:06:22,444] [INFO] [timer.py:258:stop] epoch=0/micro_step=9020/global_step=9020, RunningAvgSamplesPerSec=4.486409292407071, CurrSamplesPerSec=4.508519640709713, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:06:31,462] [INFO] [logging.py:96:log_dist] [Rank 0] step=9030, skipped=43, lr=[1.3228061981205398e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:06:31,462] [INFO] [timer.py:258:stop] epoch=0/micro_step=9030/global_step=9030, RunningAvgSamplesPerSec=4.486427555428744, CurrSamplesPerSec=4.506450020333425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:06:40,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=9040, skipped=43, lr=[1.317568942995061e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:06:40,468] [INFO] [timer.py:258:stop] epoch=0/micro_step=9040/global_step=9040, RunningAvgSamplesPerSec=4.486438000635481, CurrSamplesPerSec=4.493478687654355, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:06:49,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=9050, skipped=43, lr=[1.3123729667756005e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:06:49,490] [INFO] [timer.py:258:stop] epoch=0/micro_step=9050/global_step=9050, RunningAvgSamplesPerSec=4.486441297992549, CurrSamplesPerSec=4.4901823188066015, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:06:49,491] [INFO] [RANK 0]  iteration     9050/   10000 | elapsed time per iteration (ms): 1452.6 | learning rate 1.312E-05 | total loss 2.341113E-01 | loss 2.341113E-01 | loss scale 32768.0 |speed 165.22 samples/(min*GPU)
[2024-06-17 21:06:49,492] [INFO] [RANK 0] time (ms) | forward: 352.37 | backward: 544.30 | allreduce: 0.00 | optimizer: 3.35 | batch generator: 14.41 | data loader: 0.12
[2024-06-17 21:06:58,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=9060, skipped=43, lr=[1.3072183207443429e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:06:58,522] [INFO] [timer.py:258:stop] epoch=0/micro_step=9060/global_step=9060, RunningAvgSamplesPerSec=4.486440763844429, CurrSamplesPerSec=4.490021292334438, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:07:07,573] [INFO] [logging.py:96:log_dist] [Rank 0] step=9070, skipped=43, lr=[1.302105055775566e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:07:07,573] [INFO] [timer.py:258:stop] epoch=0/micro_step=9070/global_step=9070, RunningAvgSamplesPerSec=4.486437344139462, CurrSamplesPerSec=4.484053444460807, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:07:16,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=9080, skipped=43, lr=[1.2970332223351298e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:07:16,623] [INFO] [timer.py:258:stop] epoch=0/micro_step=9080/global_step=9080, RunningAvgSamplesPerSec=4.486436554644873, CurrSamplesPerSec=4.491862970626159, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:07:25,689] [INFO] [logging.py:96:log_dist] [Rank 0] step=9090, skipped=43, lr=[1.2920028704799827e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:07:25,689] [INFO] [timer.py:258:stop] epoch=0/micro_step=9090/global_step=9090, RunningAvgSamplesPerSec=4.486432220773983, CurrSamplesPerSec=4.469570309242756, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:07:34,724] [INFO] [logging.py:96:log_dist] [Rank 0] step=9100, skipped=43, lr=[1.2870140498576666e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:07:34,725] [INFO] [timer.py:258:stop] epoch=0/micro_step=9100/global_step=9100, RunningAvgSamplesPerSec=4.486434075990283, CurrSamplesPerSec=4.483659187494555, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:07:34,725] [INFO] [RANK 0]  iteration     9100/   10000 | elapsed time per iteration (ms): 904.7 | learning rate 1.287E-05 | total loss 2.254637E-01 | loss 2.254637E-01 | loss scale 32768.0 |speed 265.29 samples/(min*GPU)
[2024-06-17 21:07:34,726] [INFO] [RANK 0] time (ms) | forward: 353.69 | backward: 546.90 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 12.25 | data loader: 0.09
[2024-06-17 21:07:43,782] [INFO] [logging.py:96:log_dist] [Rank 0] step=9110, skipped=43, lr=[1.2820668097058278e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:07:43,782] [INFO] [timer.py:258:stop] epoch=0/micro_step=9110/global_step=9110, RunningAvgSamplesPerSec=4.48643058039197, CurrSamplesPerSec=4.47836082946172, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:07:52,810] [INFO] [logging.py:96:log_dist] [Rank 0] step=9120, skipped=43, lr=[1.2771611988517277e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:07:52,810] [INFO] [timer.py:258:stop] epoch=0/micro_step=9120/global_step=9120, RunningAvgSamplesPerSec=4.486433911614236, CurrSamplesPerSec=4.4926147420240845, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:08:01,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=9130, skipped=43, lr=[1.2722972657117671e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:08:01,828] [INFO] [timer.py:258:stop] epoch=0/micro_step=9130/global_step=9130, RunningAvgSamplesPerSec=4.486437914267708, CurrSamplesPerSec=4.492523313183245, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:08:10,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=9140, skipped=43, lr=[1.2674750582910006e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:08:10,846] [INFO] [timer.py:258:stop] epoch=0/micro_step=9140/global_step=9140, RunningAvgSamplesPerSec=4.486436065357752, CurrSamplesPerSec=4.492222586669701, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:08:19,841] [INFO] [logging.py:96:log_dist] [Rank 0] step=9150, skipped=43, lr=[1.2626946241826692e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:08:19,842] [INFO] [timer.py:258:stop] epoch=0/micro_step=9150/global_step=9150, RunningAvgSamplesPerSec=4.486443196304047, CurrSamplesPerSec=4.489877099325711, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:08:19,844] [INFO] [RANK 0]  iteration     9150/   10000 | elapsed time per iteration (ms): 902.4 | learning rate 1.262E-05 | total loss 2.417679E-01 | loss 2.417679E-01 | loss scale 32768.0 |speed 265.96 samples/(min*GPU)
[2024-06-17 21:08:19,845] [INFO] [RANK 0] time (ms) | forward: 351.47 | backward: 546.94 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 10.55 | data loader: 0.08
[2024-06-17 21:08:28,884] [INFO] [logging.py:96:log_dist] [Rank 0] step=9160, skipped=43, lr=[1.2579560105677284e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:08:28,885] [INFO] [timer.py:258:stop] epoch=0/micro_step=9160/global_step=9160, RunningAvgSamplesPerSec=4.486445357650771, CurrSamplesPerSec=4.482147513304409, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:08:37,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=9170, skipped=43, lr=[1.2532592642143801e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:08:37,943] [INFO] [timer.py:258:stop] epoch=0/micro_step=9170/global_step=9170, RunningAvgSamplesPerSec=4.486438313064486, CurrSamplesPerSec=4.4885773771335655, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:08:46,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=9180, skipped=43, lr=[1.2486044314776158e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:08:46,999] [INFO] [timer.py:258:stop] epoch=0/micro_step=9180/global_step=9180, RunningAvgSamplesPerSec=4.486435649170036, CurrSamplesPerSec=4.475608288878829, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:08:49,715] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2024-06-17 21:08:50,614] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
[2024-06-17 21:08:56,035] [INFO] [logging.py:96:log_dist] [Rank 0] step=9190, skipped=45, lr=[1.244910773978623e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:08:56,035] [INFO] [timer.py:258:stop] epoch=0/micro_step=9190/global_step=9190, RunningAvgSamplesPerSec=4.486437096634032, CurrSamplesPerSec=4.490497194980943, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:09:05,070] [INFO] [logging.py:96:log_dist] [Rank 0] step=9200, skipped=45, lr=[1.2403315012455589e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:09:05,071] [INFO] [timer.py:258:stop] epoch=0/micro_step=9200/global_step=9200, RunningAvgSamplesPerSec=4.486438423169895, CurrSamplesPerSec=4.487173994036257, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:09:05,073] [INFO] [RANK 0]  iteration     9200/   10000 | elapsed time per iteration (ms): 904.6 | learning rate 1.240E-05 | total loss 2.391458E-01 | loss 2.391458E-01 | loss scale 32768.0 |speed 265.32 samples/(min*GPU)
[2024-06-17 21:09:05,073] [INFO] [RANK 0] time (ms) | forward: 353.73 | backward: 546.95 | allreduce: 0.00 | optimizer: 3.16 | batch generator: 12.30 | data loader: 0.09
[2024-06-17 21:09:14,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=9210, skipped=45, lr=[1.2357942697208805e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:09:14,101] [INFO] [timer.py:258:stop] epoch=0/micro_step=9210/global_step=9210, RunningAvgSamplesPerSec=4.486435938256724, CurrSamplesPerSec=4.486540418322991, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:09:23,129] [INFO] [logging.py:96:log_dist] [Rank 0] step=9220, skipped=45, lr=[1.2312991241852295e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:09:23,129] [INFO] [timer.py:258:stop] epoch=0/micro_step=9220/global_step=9220, RunningAvgSamplesPerSec=4.486436656668102, CurrSamplesPerSec=4.483109260920441, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:09:32,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=9230, skipped=45, lr=[1.226846109003879e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:09:32,141] [INFO] [timer.py:258:stop] epoch=0/micro_step=9230/global_step=9230, RunningAvgSamplesPerSec=4.486439370342472, CurrSamplesPerSec=4.488590586789314, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:09:41,167] [INFO] [logging.py:96:log_dist] [Rank 0] step=9240, skipped=45, lr=[1.22243526812629e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:09:41,167] [INFO] [timer.py:258:stop] epoch=0/micro_step=9240/global_step=9240, RunningAvgSamplesPerSec=4.486441169450246, CurrSamplesPerSec=4.490212362337299, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:09:50,221] [INFO] [logging.py:96:log_dist] [Rank 0] step=9250, skipped=45, lr=[1.218066645085683e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:09:50,222] [INFO] [timer.py:258:stop] epoch=0/micro_step=9250/global_step=9250, RunningAvgSamplesPerSec=4.4864369213878135, CurrSamplesPerSec=4.4900969973716, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:09:50,223] [INFO] [RANK 0]  iteration     9250/   10000 | elapsed time per iteration (ms): 903.0 | learning rate 1.218E-05 | total loss 2.073611E-01 | loss 2.073611E-01 | loss scale 32768.0 |speed 265.78 samples/(min*GPU)
[2024-06-17 21:09:50,224] [INFO] [RANK 0] time (ms) | forward: 352.09 | backward: 546.96 | allreduce: 0.00 | optimizer: 3.23 | batch generator: 10.86 | data loader: 0.09
[2024-06-17 21:09:59,269] [INFO] [logging.py:96:log_dist] [Rank 0] step=9260, skipped=45, lr=[1.2137402829986025e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:09:59,270] [INFO] [timer.py:258:stop] epoch=0/micro_step=9260/global_step=9260, RunningAvgSamplesPerSec=4.486432049213337, CurrSamplesPerSec=4.482499587210306, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:10:08,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=9270, skipped=45, lr=[1.2094562245644947e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:10:08,297] [INFO] [timer.py:258:stop] epoch=0/micro_step=9270/global_step=9270, RunningAvgSamplesPerSec=4.486433686121014, CurrSamplesPerSec=4.48407621521792, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:10:17,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=9280, skipped=45, lr=[1.2052145120652885e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:10:17,327] [INFO] [timer.py:258:stop] epoch=0/micro_step=9280/global_step=9280, RunningAvgSamplesPerSec=4.486436065484712, CurrSamplesPerSec=4.492436699819282, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:10:26,339] [INFO] [logging.py:96:log_dist] [Rank 0] step=9290, skipped=45, lr=[1.2010151873649731e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:10:26,339] [INFO] [timer.py:258:stop] epoch=0/micro_step=9290/global_step=9290, RunningAvgSamplesPerSec=4.4864377685607035, CurrSamplesPerSec=4.492398206062852, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:10:35,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=9300, skipped=45, lr=[1.196858291909188e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:10:35,369] [INFO] [timer.py:258:stop] epoch=0/micro_step=9300/global_step=9300, RunningAvgSamplesPerSec=4.486440351192289, CurrSamplesPerSec=4.480300630524028, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:10:35,370] [INFO] [RANK 0]  iteration     9300/   10000 | elapsed time per iteration (ms): 902.9 | learning rate 1.196E-05 | total loss 2.208858E-01 | loss 2.208858E-01 | loss scale 32768.0 |speed 265.80 samples/(min*GPU)
[2024-06-17 21:10:35,371] [INFO] [RANK 0] time (ms) | forward: 352.00 | backward: 547.00 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 10.94 | data loader: 0.08
[2024-06-17 21:10:35,371] [INFO] [RANK 0] Saving Model...
[2024-06-17 21:10:35,383] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/9300/mp_rank_00_model_states.pt
[2024-06-17 21:10:35,383] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/9300/mp_rank_00_model_states.pt...
[2024-06-17 21:10:56,082] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/9300/mp_rank_00_model_states.pt.
[2024-06-17 21:11:05,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=9310, skipped=45, lr=[1.192743866724813e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:11:05,081] [INFO] [timer.py:258:stop] epoch=0/micro_step=9310/global_step=9310, RunningAvgSamplesPerSec=4.486483845094809, CurrSamplesPerSec=4.514353613804268, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:11:14,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=9320, skipped=45, lr=[1.188671952419564e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:11:14,060] [INFO] [timer.py:258:stop] epoch=0/micro_step=9320/global_step=9320, RunningAvgSamplesPerSec=4.486516878049995, CurrSamplesPerSec=4.511140574924383, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:11:15,855] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
[2024-06-17 21:11:23,052] [INFO] [logging.py:96:log_dist] [Rank 0] step=9330, skipped=46, lr=[1.1850436095706742e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:11:23,052] [INFO] [timer.py:258:stop] epoch=0/micro_step=9330/global_step=9330, RunningAvgSamplesPerSec=4.486546401176101, CurrSamplesPerSec=4.52421422554065, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:11:32,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=9340, skipped=46, lr=[1.1810525763070284e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:11:32,070] [INFO] [timer.py:258:stop] epoch=0/micro_step=9340/global_step=9340, RunningAvgSamplesPerSec=4.486568951226614, CurrSamplesPerSec=4.505746854786405, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:11:41,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=9350, skipped=46, lr=[1.1771041693108238e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:11:41,113] [INFO] [timer.py:258:stop] epoch=0/micro_step=9350/global_step=9350, RunningAvgSamplesPerSec=4.48657877992734, CurrSamplesPerSec=4.488496920000268, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:11:41,113] [INFO] [RANK 0]  iteration     9350/   10000 | elapsed time per iteration (ms): 1314.9 | learning rate 1.177E-05 | total loss 2.381925E-01 | loss 2.381925E-01 | loss scale 16384.0 |speed 182.53 samples/(min*GPU)
[2024-06-17 21:11:41,115] [INFO] [RANK 0] time (ms) | forward: 352.45 | backward: 543.47 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 12.88 | data loader: 0.11
[2024-06-17 21:11:50,139] [INFO] [logging.py:96:log_dist] [Rank 0] step=9360, skipped=46, lr=[1.1731984275512448e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:11:50,139] [INFO] [timer.py:258:stop] epoch=0/micro_step=9360/global_step=9360, RunningAvgSamplesPerSec=4.486582028463553, CurrSamplesPerSec=4.492795204604728, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:11:59,167] [INFO] [logging.py:96:log_dist] [Rank 0] step=9370, skipped=46, lr=[1.1693353895763854e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:11:59,168] [INFO] [timer.py:258:stop] epoch=0/micro_step=9370/global_step=9370, RunningAvgSamplesPerSec=4.486587265097488, CurrSamplesPerSec=4.49158998953484, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:12:08,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=9380, skipped=46, lr=[1.1655150935128712e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:12:08,200] [INFO] [timer.py:258:stop] epoch=0/micro_step=9380/global_step=9380, RunningAvgSamplesPerSec=4.486587462448678, CurrSamplesPerSec=4.490139056828687, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:12:17,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=9390, skipped=46, lr=[1.1617375770654819e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:12:17,231] [INFO] [timer.py:258:stop] epoch=0/micro_step=9390/global_step=9390, RunningAvgSamplesPerSec=4.486588918106595, CurrSamplesPerSec=4.493595430021127, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:12:26,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=9400, skipped=46, lr=[1.1580028775167788e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:12:26,275] [INFO] [timer.py:258:stop] epoch=0/micro_step=9400/global_step=9400, RunningAvgSamplesPerSec=4.486591037343057, CurrSamplesPerSec=4.490158284271508, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:12:26,276] [INFO] [RANK 0]  iteration     9400/   10000 | elapsed time per iteration (ms): 903.3 | learning rate 1.158E-05 | total loss 1.900294E-01 | loss 1.900294E-01 | loss scale 16384.0 |speed 265.70 samples/(min*GPU)
[2024-06-17 21:12:26,277] [INFO] [RANK 0] time (ms) | forward: 352.58 | backward: 546.71 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 11.55 | data loader: 0.14
[2024-06-17 21:12:35,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=9410, skipped=46, lr=[1.1543110317267399e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:12:35,326] [INFO] [timer.py:258:stop] epoch=0/micro_step=9410/global_step=9410, RunningAvgSamplesPerSec=4.486588188698169, CurrSamplesPerSec=4.489436166509189, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:12:44,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=9420, skipped=46, lr=[1.1506620761323918e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:12:44,379] [INFO] [timer.py:258:stop] epoch=0/micro_step=9420/global_step=9420, RunningAvgSamplesPerSec=4.486583914056538, CurrSamplesPerSec=4.49506425418314, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:12:53,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=9430, skipped=46, lr=[1.1470560467474545e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:12:53,438] [INFO] [timer.py:258:stop] epoch=0/micro_step=9430/global_step=9430, RunningAvgSamplesPerSec=4.486577648222086, CurrSamplesPerSec=4.477275656738257, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:13:02,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=9440, skipped=46, lr=[1.14349297916198e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:13:02,484] [INFO] [timer.py:258:stop] epoch=0/micro_step=9440/global_step=9440, RunningAvgSamplesPerSec=4.486570255122138, CurrSamplesPerSec=4.488253164502781, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:13:11,512] [INFO] [logging.py:96:log_dist] [Rank 0] step=9450, skipped=46, lr=[1.1399729085420091e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:13:11,513] [INFO] [timer.py:258:stop] epoch=0/micro_step=9450/global_step=9450, RunningAvgSamplesPerSec=4.486571733579243, CurrSamplesPerSec=4.493004559362091, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:13:11,514] [INFO] [RANK 0]  iteration     9450/   10000 | elapsed time per iteration (ms): 904.8 | learning rate 1.140E-05 | total loss 2.171063E-01 | loss 2.171063E-01 | loss scale 16384.0 |speed 265.27 samples/(min*GPU)
[2024-06-17 21:13:11,515] [INFO] [RANK 0] time (ms) | forward: 354.01 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 11.97 | data loader: 0.09
[2024-06-17 21:13:20,549] [INFO] [logging.py:96:log_dist] [Rank 0] step=9460, skipped=46, lr=[1.1364958696292161e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:13:20,550] [INFO] [timer.py:258:stop] epoch=0/micro_step=9460/global_step=9460, RunningAvgSamplesPerSec=4.486574712913768, CurrSamplesPerSec=4.498847883943715, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:13:29,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=9470, skipped=46, lr=[1.1330618967405727e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:13:29,599] [INFO] [timer.py:258:stop] epoch=0/micro_step=9470/global_step=9470, RunningAvgSamplesPerSec=4.48657540838425, CurrSamplesPerSec=4.493327051987422, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:13:38,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=9480, skipped=46, lr=[1.1296710237680037e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:13:38,626] [INFO] [timer.py:258:stop] epoch=0/micro_step=9480/global_step=9480, RunningAvgSamplesPerSec=4.486572170305889, CurrSamplesPerSec=4.4908373589387445, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:13:47,658] [INFO] [logging.py:96:log_dist] [Rank 0] step=9490, skipped=46, lr=[1.1263232841780569e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:13:47,658] [INFO] [timer.py:258:stop] epoch=0/micro_step=9490/global_step=9490, RunningAvgSamplesPerSec=4.4865699104811165, CurrSamplesPerSec=4.483665178722948, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:13:56,695] [INFO] [logging.py:96:log_dist] [Rank 0] step=9500, skipped=46, lr=[1.1230187110115707e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:13:56,696] [INFO] [timer.py:258:stop] epoch=0/micro_step=9500/global_step=9500, RunningAvgSamplesPerSec=4.486572516895339, CurrSamplesPerSec=4.490046527063175, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:13:56,696] [INFO] [RANK 0]  iteration     9500/   10000 | elapsed time per iteration (ms): 903.6 | learning rate 1.123E-05 | total loss 2.112921E-01 | loss 2.112921E-01 | loss scale 16384.0 |speed 265.59 samples/(min*GPU)
[2024-06-17 21:13:56,697] [INFO] [RANK 0] time (ms) | forward: 352.92 | backward: 546.72 | allreduce: 0.00 | optimizer: 3.29 | batch generator: 11.52 | data loader: 0.10
[2024-06-17 21:14:05,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=9510, skipped=46, lr=[1.1197573368833477e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:14:05,728] [INFO] [timer.py:258:stop] epoch=0/micro_step=9510/global_step=9510, RunningAvgSamplesPerSec=4.486572726048728, CurrSamplesPerSec=4.490327733231343, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:14:14,778] [INFO] [logging.py:96:log_dist] [Rank 0] step=9520, skipped=46, lr=[1.1165391939818344e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:14:14,779] [INFO] [timer.py:258:stop] epoch=0/micro_step=9520/global_step=9520, RunningAvgSamplesPerSec=4.486575346343199, CurrSamplesPerSec=4.489006130195823, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:14:23,835] [INFO] [logging.py:96:log_dist] [Rank 0] step=9530, skipped=46, lr=[1.113364314068802e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:14:23,836] [INFO] [timer.py:258:stop] epoch=0/micro_step=9530/global_step=9530, RunningAvgSamplesPerSec=4.4865767610843434, CurrSamplesPerSec=4.491347100338299, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:14:32,890] [INFO] [logging.py:96:log_dist] [Rank 0] step=9540, skipped=46, lr=[1.1102327284790332e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:14:32,890] [INFO] [timer.py:258:stop] epoch=0/micro_step=9540/global_step=9540, RunningAvgSamplesPerSec=4.4865756045646155, CurrSamplesPerSec=4.48630407321323, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:14:41,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=9550, skipped=46, lr=[1.107144468120013e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:14:41,941] [INFO] [timer.py:258:stop] epoch=0/micro_step=9550/global_step=9550, RunningAvgSamplesPerSec=4.486576411269305, CurrSamplesPerSec=4.488191929598064, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:14:41,942] [INFO] [RANK 0]  iteration     9550/   10000 | elapsed time per iteration (ms): 904.9 | learning rate 1.107E-05 | total loss 2.307537E-01 | loss 2.307537E-01 | loss scale 16384.0 |speed 265.22 samples/(min*GPU)
[2024-06-17 21:14:41,943] [INFO] [RANK 0] time (ms) | forward: 354.08 | backward: 546.82 | allreduce: 0.00 | optimizer: 3.26 | batch generator: 12.91 | data loader: 0.16
[2024-06-17 21:14:50,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=9560, skipped=46, lr=[1.1040995634716256e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:14:50,964] [INFO] [timer.py:258:stop] epoch=0/micro_step=9560/global_step=9560, RunningAvgSamplesPerSec=4.486576538807442, CurrSamplesPerSec=4.491169158590545, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:14:59,993] [INFO] [logging.py:96:log_dist] [Rank 0] step=9570, skipped=46, lr=[1.1010980445858493e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:14:59,993] [INFO] [timer.py:258:stop] epoch=0/micro_step=9570/global_step=9570, RunningAvgSamplesPerSec=4.4865799488644065, CurrSamplesPerSec=4.4812149045687395, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:15:09,027] [INFO] [logging.py:96:log_dist] [Rank 0] step=9580, skipped=46, lr=[1.0981399410864651e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:15:09,028] [INFO] [timer.py:258:stop] epoch=0/micro_step=9580/global_step=9580, RunningAvgSamplesPerSec=4.486581868770154, CurrSamplesPerSec=4.493327051987422, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:15:18,073] [INFO] [logging.py:96:log_dist] [Rank 0] step=9590, skipped=46, lr=[1.0952252821687593e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:15:18,074] [INFO] [timer.py:258:stop] epoch=0/micro_step=9590/global_step=9590, RunningAvgSamplesPerSec=4.48658341001439, CurrSamplesPerSec=4.494664446287616, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:15:27,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=9600, skipped=46, lr=[1.092354096599239e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:15:27,124] [INFO] [timer.py:258:stop] epoch=0/micro_step=9600/global_step=9600, RunningAvgSamplesPerSec=4.486582410551035, CurrSamplesPerSec=4.4644453562862, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:15:27,127] [INFO] [RANK 0]  iteration     9600/   10000 | elapsed time per iteration (ms): 903.7 | learning rate 1.092E-05 | total loss 2.217223E-01 | loss 2.217223E-01 | loss scale 16384.0 |speed 265.58 samples/(min*GPU)
[2024-06-17 21:15:27,128] [INFO] [RANK 0] time (ms) | forward: 352.91 | backward: 546.85 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 11.84 | data loader: 0.14
[2024-06-17 21:15:27,129] [INFO] [RANK 0] Saving Model...
[2024-06-17 21:15:27,143] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/9600/mp_rank_00_model_states.pt
[2024-06-17 21:15:27,143] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/9600/mp_rank_00_model_states.pt...
[2024-06-17 21:15:47,655] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/9600/mp_rank_00_model_states.pt.
[2024-06-17 21:15:56,652] [INFO] [logging.py:96:log_dist] [Rank 0] step=9610, skipped=46, lr=[1.0895264127153466e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:15:56,653] [INFO] [timer.py:258:stop] epoch=0/micro_step=9610/global_step=9610, RunningAvgSamplesPerSec=4.486628023912499, CurrSamplesPerSec=4.525987607311087, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:16:05,639] [INFO] [logging.py:96:log_dist] [Rank 0] step=9620, skipped=46, lr=[1.0867422584251801e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:16:05,639] [INFO] [timer.py:258:stop] epoch=0/micro_step=9620/global_step=9620, RunningAvgSamplesPerSec=4.486664705002288, CurrSamplesPerSec=4.52808743735736, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:16:14,610] [INFO] [logging.py:96:log_dist] [Rank 0] step=9630, skipped=46, lr=[1.0840016612072194e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:16:14,611] [INFO] [timer.py:258:stop] epoch=0/micro_step=9630/global_step=9630, RunningAvgSamplesPerSec=4.4866968999636425, CurrSamplesPerSec=4.521642668966493, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:16:23,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=9640, skipped=46, lr=[1.0813046481100515e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:16:23,613] [INFO] [timer.py:258:stop] epoch=0/micro_step=9640/global_step=9640, RunningAvgSamplesPerSec=4.486723661094401, CurrSamplesPerSec=4.493104430861127, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:16:32,658] [INFO] [logging.py:96:log_dist] [Rank 0] step=9650, skipped=46, lr=[1.0786512457521072e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:16:32,659] [INFO] [timer.py:258:stop] epoch=0/micro_step=9650/global_step=9650, RunningAvgSamplesPerSec=4.486732723380734, CurrSamplesPerSec=4.496132764586248, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:16:32,660] [INFO] [RANK 0]  iteration     9650/   10000 | elapsed time per iteration (ms): 1310.7 | learning rate 1.078E-05 | total loss 1.917793E-01 | loss 1.917793E-01 | loss scale 16384.0 |speed 183.11 samples/(min*GPU)
[2024-06-17 21:16:32,661] [INFO] [RANK 0] time (ms) | forward: 352.07 | backward: 543.30 | allreduce: 0.00 | optimizer: 3.22 | batch generator: 13.06 | data loader: 0.13
[2024-06-17 21:16:41,695] [INFO] [logging.py:96:log_dist] [Rank 0] step=9660, skipped=46, lr=[1.0760414803213966e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:16:41,695] [INFO] [timer.py:258:stop] epoch=0/micro_step=9660/global_step=9660, RunningAvgSamplesPerSec=4.486742869551224, CurrSamplesPerSec=4.491436076499868, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:16:50,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=9670, skipped=46, lr=[1.0734753775752513e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:16:50,758] [INFO] [timer.py:258:stop] epoch=0/micro_step=9670/global_step=9670, RunningAvgSamplesPerSec=4.486746289605855, CurrSamplesPerSec=4.4773724404287885, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:16:59,800] [INFO] [logging.py:96:log_dist] [Rank 0] step=9680, skipped=46, lr=[1.070952962840069e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:16:59,801] [INFO] [timer.py:258:stop] epoch=0/micro_step=9680/global_step=9680, RunningAvgSamplesPerSec=4.4867404497263665, CurrSamplesPerSec=4.488769525240542, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:17:08,824] [INFO] [logging.py:96:log_dist] [Rank 0] step=9690, skipped=46, lr=[1.0684742610110645e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:17:08,825] [INFO] [timer.py:258:stop] epoch=0/micro_step=9690/global_step=9690, RunningAvgSamplesPerSec=4.486741518562312, CurrSamplesPerSec=4.483824551275884, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:17:17,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=9700, skipped=46, lr=[1.0660392965520251e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:17:17,838] [INFO] [timer.py:258:stop] epoch=0/micro_step=9700/global_step=9700, RunningAvgSamplesPerSec=4.486744868183943, CurrSamplesPerSec=4.498870805206256, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:17:17,839] [INFO] [RANK 0]  iteration     9700/   10000 | elapsed time per iteration (ms): 903.6 | learning rate 1.066E-05 | total loss 2.256902E-01 | loss 2.256902E-01 | loss scale 16384.0 |speed 265.61 samples/(min*GPU)
[2024-06-17 21:17:17,840] [INFO] [RANK 0] time (ms) | forward: 353.08 | backward: 546.44 | allreduce: 0.00 | optimizer: 3.30 | batch generator: 11.94 | data loader: 0.20
[2024-06-17 21:17:26,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=9710, skipped=46, lr=[1.063648093495066e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:17:26,870] [INFO] [timer.py:258:stop] epoch=0/micro_step=9710/global_step=9710, RunningAvgSamplesPerSec=4.486743981491542, CurrSamplesPerSec=4.481463881500904, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:17:35,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=9720, skipped=46, lr=[1.061300675440396e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:17:35,917] [INFO] [timer.py:258:stop] epoch=0/micro_step=9720/global_step=9720, RunningAvgSamplesPerSec=4.486742644843316, CurrSamplesPerSec=4.486672398508295, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:17:44,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=9730, skipped=46, lr=[1.0589970655560846e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:17:44,968] [INFO] [timer.py:258:stop] epoch=0/micro_step=9730/global_step=9730, RunningAvgSamplesPerSec=4.486740239083405, CurrSamplesPerSec=4.470567168760739, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:17:54,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=9740, skipped=46, lr=[1.0567372865778306e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:17:54,013] [INFO] [timer.py:258:stop] epoch=0/micro_step=9740/global_step=9740, RunningAvgSamplesPerSec=4.486736453304904, CurrSamplesPerSec=4.48662200515753, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:18:03,080] [INFO] [logging.py:96:log_dist] [Rank 0] step=9750, skipped=46, lr=[1.0545213608087402e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:18:03,081] [INFO] [timer.py:258:stop] epoch=0/micro_step=9750/global_step=9750, RunningAvgSamplesPerSec=4.486736805117387, CurrSamplesPerSec=4.4966702233243305, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:18:03,081] [INFO] [RANK 0]  iteration     9750/   10000 | elapsed time per iteration (ms): 904.9 | learning rate 1.054E-05 | total loss 2.392023E-01 | loss 2.392023E-01 | loss scale 32768.0 |speed 265.24 samples/(min*GPU)
[2024-06-17 21:18:03,086] [INFO] [RANK 0] time (ms) | forward: 354.00 | backward: 546.81 | allreduce: 0.00 | optimizer: 3.28 | batch generator: 12.43 | data loader: 0.21
[2024-06-17 21:18:12,110] [INFO] [logging.py:96:log_dist] [Rank 0] step=9760, skipped=46, lr=[1.0523493101191065e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:18:12,110] [INFO] [timer.py:258:stop] epoch=0/micro_step=9760/global_step=9760, RunningAvgSamplesPerSec=4.486742168379649, CurrSamplesPerSec=4.491988047936769, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:18:21,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=9770, skipped=46, lr=[1.0502211559461925e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:18:21,123] [INFO] [timer.py:258:stop] epoch=0/micro_step=9770/global_step=9770, RunningAvgSamplesPerSec=4.486746065395406, CurrSamplesPerSec=4.491551510287172, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:18:30,142] [INFO] [logging.py:96:log_dist] [Rank 0] step=9780, skipped=46, lr=[1.048136919294021e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:18:30,143] [INFO] [timer.py:258:stop] epoch=0/micro_step=9780/global_step=9780, RunningAvgSamplesPerSec=4.486751755642462, CurrSamplesPerSec=4.495661690070495, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:18:39,158] [INFO] [logging.py:96:log_dist] [Rank 0] step=9790, skipped=46, lr=[1.046096620733166e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:18:39,159] [INFO] [timer.py:258:stop] epoch=0/micro_step=9790/global_step=9790, RunningAvgSamplesPerSec=4.486752385579284, CurrSamplesPerSec=4.4882207458156715, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:18:48,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=9800, skipped=46, lr=[1.0441002804005511e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:18:48,186] [INFO] [timer.py:258:stop] epoch=0/micro_step=9800/global_step=9800, RunningAvgSamplesPerSec=4.486755694592684, CurrSamplesPerSec=4.490350567756931, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:18:48,188] [INFO] [RANK 0]  iteration     9800/   10000 | elapsed time per iteration (ms): 902.1 | learning rate 1.044E-05 | total loss 2.302731E-01 | loss 2.302731E-01 | loss scale 32768.0 |speed 266.04 samples/(min*GPU)
[2024-06-17 21:18:48,189] [INFO] [RANK 0] time (ms) | forward: 351.46 | backward: 546.63 | allreduce: 0.00 | optimizer: 3.15 | batch generator: 10.66 | data loader: 0.19
[2024-06-17 21:18:57,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=9810, skipped=46, lr=[1.0421479179992491e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:18:57,243] [INFO] [timer.py:258:stop] epoch=0/micro_step=9810/global_step=9810, RunningAvgSamplesPerSec=4.486760372566496, CurrSamplesPerSec=4.495211189413762, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:19:06,283] [INFO] [logging.py:96:log_dist] [Rank 0] step=9820, skipped=46, lr=[1.0402395527982887e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:19:06,284] [INFO] [timer.py:258:stop] epoch=0/micro_step=9820/global_step=9820, RunningAvgSamplesPerSec=4.486763776342462, CurrSamplesPerSec=4.501247438786425, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:19:15,313] [INFO] [logging.py:96:log_dist] [Rank 0] step=9830, skipped=46, lr=[1.0383752036324641e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:19:15,314] [INFO] [timer.py:258:stop] epoch=0/micro_step=9830/global_step=9830, RunningAvgSamplesPerSec=4.486768770508023, CurrSamplesPerSec=4.478910787343242, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:19:24,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=9840, skipped=46, lr=[1.0365548889021489e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:19:24,362] [INFO] [timer.py:258:stop] epoch=0/micro_step=9840/global_step=9840, RunningAvgSamplesPerSec=4.486771840995562, CurrSamplesPerSec=4.489654819914361, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:19:33,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=9850, skipped=46, lr=[1.0347786265731143e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:19:33,395] [INFO] [timer.py:258:stop] epoch=0/micro_step=9850/global_step=9850, RunningAvgSamplesPerSec=4.486780709129101, CurrSamplesPerSec=4.503179321233034, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:19:33,397] [INFO] [RANK 0]  iteration     9850/   10000 | elapsed time per iteration (ms): 904.2 | learning rate 1.035E-05 | total loss 2.482256E-01 | loss 2.482256E-01 | loss scale 32768.0 |speed 265.43 samples/(min*GPU)
[2024-06-17 21:19:33,398] [INFO] [RANK 0] time (ms) | forward: 353.71 | backward: 546.52 | allreduce: 0.00 | optimizer: 3.19 | batch generator: 13.00 | data loader: 0.19
[2024-06-17 21:19:42,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=9860, skipped=46, lr=[1.0330464341763529e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:19:42,426] [INFO] [timer.py:258:stop] epoch=0/micro_step=9860/global_step=9860, RunningAvgSamplesPerSec=4.486779751356233, CurrSamplesPerSec=4.493179036564692, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:19:51,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=9870, skipped=46, lr=[1.031358328807904e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:19:51,466] [INFO] [timer.py:258:stop] epoch=0/micro_step=9870/global_step=9870, RunningAvgSamplesPerSec=4.486783354295622, CurrSamplesPerSec=4.49154309303963, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:20:00,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=9880, skipped=46, lr=[1.0297143271286863e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:20:00,502] [INFO] [timer.py:258:stop] epoch=0/micro_step=9880/global_step=9880, RunningAvgSamplesPerSec=4.4867830121389805, CurrSamplesPerSec=4.483136813943533, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:20:09,537] [INFO] [logging.py:96:log_dist] [Rank 0] step=9890, skipped=46, lr=[1.028114445364332e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:20:09,538] [INFO] [timer.py:258:stop] epoch=0/micro_step=9890/global_step=9890, RunningAvgSamplesPerSec=4.486782603446257, CurrSamplesPerSec=4.482201398582716, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:20:18,583] [INFO] [logging.py:96:log_dist] [Rank 0] step=9900, skipped=46, lr=[1.026558699305029e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:20:18,584] [INFO] [timer.py:258:stop] epoch=0/micro_step=9900/global_step=9900, RunningAvgSamplesPerSec=4.4867835755171805, CurrSamplesPerSec=4.496017095203551, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:20:18,584] [INFO] [RANK 0]  iteration     9900/   10000 | elapsed time per iteration (ms): 903.8 | learning rate 1.026E-05 | total loss 2.119426E-01 | loss 2.119426E-01 | loss scale 32768.0 |speed 265.56 samples/(min*GPU)
[2024-06-17 21:20:18,585] [INFO] [RANK 0] time (ms) | forward: 353.34 | backward: 546.48 | allreduce: 0.00 | optimizer: 3.18 | batch generator: 11.82 | data loader: 0.20
[2024-06-17 21:20:18,585] [INFO] [RANK 0] Saving Model...
[2024-06-17 21:20:18,597] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/9900/mp_rank_00_model_states.pt
[2024-06-17 21:20:18,597] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/9900/mp_rank_00_model_states.pt...
[2024-06-17 21:20:39,433] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/9900/mp_rank_00_model_states.pt.
[2024-06-17 21:20:48,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=9910, skipped=46, lr=[1.0250471043053626e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:20:48,425] [INFO] [timer.py:258:stop] epoch=0/micro_step=9910/global_step=9910, RunningAvgSamplesPerSec=4.486830676346653, CurrSamplesPerSec=4.512503160352238, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:20:57,409] [INFO] [logging.py:96:log_dist] [Rank 0] step=9920, skipped=46, lr=[1.0235796752841654e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:20:57,409] [INFO] [timer.py:258:stop] epoch=0/micro_step=9920/global_step=9920, RunningAvgSamplesPerSec=4.48686874964289, CurrSamplesPerSec=4.5237140732424015, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:21:06,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=9930, skipped=46, lr=[1.0221564267243684e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:21:06,380] [INFO] [timer.py:258:stop] epoch=0/micro_step=9930/global_step=9930, RunningAvgSamplesPerSec=4.48690506149753, CurrSamplesPerSec=4.525000053942204, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:21:15,346] [INFO] [logging.py:96:log_dist] [Rank 0] step=9940, skipped=46, lr=[1.020777372672862e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:21:15,347] [INFO] [timer.py:258:stop] epoch=0/micro_step=9940/global_step=9940, RunningAvgSamplesPerSec=4.4869334428016385, CurrSamplesPerSec=4.514479946785953, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:21:24,328] [INFO] [logging.py:96:log_dist] [Rank 0] step=9950, skipped=46, lr=[1.0194425267403516e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:21:24,329] [INFO] [timer.py:258:stop] epoch=0/micro_step=9950/global_step=9950, RunningAvgSamplesPerSec=4.486960007197507, CurrSamplesPerSec=4.509538800295884, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:21:24,329] [INFO] [RANK 0]  iteration     9950/   10000 | elapsed time per iteration (ms): 1314.9 | learning rate 1.019E-05 | total loss 1.958133E-01 | loss 1.958133E-01 | loss scale 32768.0 |speed 182.52 samples/(min*GPU)
[2024-06-17 21:21:24,330] [INFO] [RANK 0] time (ms) | forward: 350.59 | backward: 542.64 | allreduce: 0.00 | optimizer: 3.17 | batch generator: 12.08 | data loader: 0.19
[2024-06-17 21:21:33,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=9960, skipped=46, lr=[1.0181519021012276e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:21:33,349] [INFO] [timer.py:258:stop] epoch=0/micro_step=9960/global_step=9960, RunningAvgSamplesPerSec=4.48698107724252, CurrSamplesPerSec=4.499044531842055, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:21:42,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=9970, skipped=46, lr=[1.016905511493435e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:21:42,363] [INFO] [timer.py:258:stop] epoch=0/micro_step=9970/global_step=9970, RunningAvgSamplesPerSec=4.486989808892961, CurrSamplesPerSec=4.495696625711881, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:21:51,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=9980, skipped=46, lr=[1.0157033672183456e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:21:51,410] [INFO] [timer.py:258:stop] epoch=0/micro_step=9980/global_step=9980, RunningAvgSamplesPerSec=4.486992327862086, CurrSamplesPerSec=4.464372889681623, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:22:00,435] [INFO] [logging.py:96:log_dist] [Rank 0] step=9990, skipped=46, lr=[1.0145454811406376e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:22:00,436] [INFO] [timer.py:258:stop] epoch=0/micro_step=9990/global_step=9990, RunningAvgSamplesPerSec=4.486997417141157, CurrSamplesPerSec=4.4911751699059534, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:22:09,464] [INFO] [logging.py:96:log_dist] [Rank 0] step=10000, skipped=46, lr=[1.01343186468818e-05], mom=[[0.9, 0.95]]
[2024-06-17 21:22:09,464] [INFO] [timer.py:258:stop] epoch=0/micro_step=10000/global_step=10000, RunningAvgSamplesPerSec=4.486998939968718, CurrSamplesPerSec=4.490413063435602, MemAllocated=14.6GB, MaxMemAllocated=18.93GB
[2024-06-17 21:22:09,465] [INFO] [RANK 0]  iteration    10000/   10000 | elapsed time per iteration (ms): 902.7 | learning rate 1.013E-05 | total loss 1.970749E-01 | loss 1.970749E-01 | loss scale 32768.0 |speed 265.86 samples/(min*GPU)
[2024-06-17 21:22:09,467] [INFO] [RANK 0] time (ms) | forward: 352.56 | backward: 546.21 | allreduce: 0.00 | optimizer: 3.20 | batch generator: 12.23 | data loader: 0.20
[2024-06-17 21:22:16,070] [INFO] [RANK 0] ----------------------------------------------------------------------------------------------------
[2024-06-17 21:22:16,071] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 21:22:16,071] [INFO] [RANK 0]  validation loss at iteration 10000 | loss: 9.351074E-01 | PPL: 2.547487E+00 loss 9.350586E-01 |
[2024-06-17 21:22:16,071] [INFO] [RANK 0] -------------------------------------------------------------------------------------------------
[2024-06-17 21:22:16,224] [INFO] [RANK 0] Saving Model...
[2024-06-17 21:22:16,236] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: ./checkpoints/finetune-visualglm-6b-06-17-18-37/10000/mp_rank_00_model_states.pt
[2024-06-17 21:22:16,236] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving ./checkpoints/finetune-visualglm-6b-06-17-18-37/10000/mp_rank_00_model_states.pt...
[2024-06-17 21:22:37,251] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved ./checkpoints/finetune-visualglm-6b-06-17-18-37/10000/mp_rank_00_model_states.pt.
discover-01:743524:743908 [0] NCCL INFO [Service thread] Connection closed by localRank 0
discover-01:743524:751335 [0] NCCL INFO comm 0x55ea0f626490 rank 0 nranks 1 cudaDev 0 busId 1000 - Abort COMPLETE
[2024-06-17 21:22:39,530] [INFO] [launch.py:351:main] Process 743524 exits successfully.
